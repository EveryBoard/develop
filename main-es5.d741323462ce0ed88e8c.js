!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,b,E,S,P,O,T,I,A,R,x,M,N,D,L,F,U,V,B,z,G,H,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,be,Ee,Se,Pe,Oe,Te,Ie,Ae,Re,xe,Me,Ne,De,Le,Fe,Ue,Ve,Be,ze,Ge,He,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,bt,Et,St,Pt,Ot,Tt,It,At,Rt,xt,Mt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Gt,Ht,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,bn,En,Sn,Pn,On,Tn,In,An,Rn,xn,Mn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Gn,Hn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,br,Er,Sr,Pr,Or,Tr,Ir,Ar,Rr,xr,Mr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Gr,Hr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,bi,Ei,Si,Pi,Oi,Ti,Ii,Ai,Ri,xi,Mi,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Gi,Hi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,ba,Ea,Sa,Pa,Oa,Ta,Ia,Aa,Ra,xa,Ma,Na,Da,La,Fa,Ua,Va,Ba,za,Ga,Ha,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,bo,Eo,So,Po,Oo,To,Io,Ao,Ro,xo,Mo,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Go,Ho,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,bs,Es,Ss,Ps,Os,Ts,Is,As,Rs,xs,Ms,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Gs,Hs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,bu,Eu,Su,Pu,Ou,Tu,Iu,Au,Ru,xu,Mu,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Gu,Hu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,bc,Ec,Sc,Pc,Oc,Tc,Ic,Ac,Rc,xc,Mc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Gc,Hc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,bl,El,Sl,Pl,Ol,Tl,Il,Al,Rl,xl,Ml,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Gl,Hl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,bf,Ef,Sf,Pf,Of,Tf,If,Af,Rf,xf,Mf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Gf,Hf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,bh,Eh,Sh,Ph,Oh,Th,Ih,Ah,Rh,xh,Mh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Gh,Hh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,bd,Ed,Sd,Pd,Od,Td,Id,Ad,Rd,xd,Md,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Gd,Hd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,bv,Ev,Sv,Pv,Ov,Tv,Iv,Av,Rv,xv,Mv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Gv,Hv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,bp,Ep,Sp,Pp,Op,Tp,Ip,Ap,Rp,xp,Mp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Gp,Hp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg;function wg(e){return Tg(e)||zg(e)||Hg(e)||Og()}function _g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Eg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bg(Object(n),!0).forEach(function(t){Sg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pg(e,t){return Tg(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||Hg(e,t)||Og()}function Og(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tg(e){if(Array.isArray(e))return e}function Ig(e){var t="function"==typeof Map?new Map:void 0;return Ig=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ag(e,arguments,Vg(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ng(r,e)},Ig(e)}function Ag(e,t,n){return Ag=Ug()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Ng(i,n.prototype),i},Ag.apply(null,arguments)}function Rg(){return Rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=xg(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Rg.apply(this,arguments)}function xg(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vg(e)););return e}function Mg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ng(e,t)}function Ng(e,t){return Ng=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ng(e,t)}function Dg(e){var t=Ug();return function(){var n,r=Vg(e);if(t){var i=Vg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lg(this,n)}}function Lg(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fg(e)}function Fg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ug(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vg(e)}function Bg(e){return function(e){if(Array.isArray(e))return $g(e)}(e)||zg(e)||Hg(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zg(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Gg(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Hg(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Hg(e,t){if(e){if("string"==typeof e)return $g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$g(e,t):void 0}}function $g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wg(e,t,n){return t&&qg(e.prototype,t),n&&qg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6607:function(bg,Og,Tg){"use strict";var xg,Ng;function Ug(e){return"function"==typeof e}function zg(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Hg=zg(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function $g(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var qg=function(){function e(t){Zg(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return Wg(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Gg(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(Ug(a))try{a()}catch(i){e=i instanceof Hg?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Gg(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{Kg(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof Hg?e=[].concat(Bg(e),Bg(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new Hg(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)Kg(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$g(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&$g(n,t),t instanceof e&&t._removeParent(this)}}]),e}();qg.EMPTY=function(){var e=new qg;return e.closed=!0,e}();var jg=qg.EMPTY;function Yg(e){return e instanceof qg||e&&"closed"in e&&Ug(e.remove)&&Ug(e.add)&&Ug(e.unsubscribe)}function Kg(e){Ug(e)?e():e.unsubscribe()}var Qg=null,Xg=null,Jg=void 0,ey=!1,ty=!1,ny={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=ny.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=ny.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function ry(e){ny.setTimeout(function(){if(!Qg)throw e;Qg(e)})}function iy(){}var ay=oy("C",void 0,void 0);function oy(e,t,n){return{kind:e,value:t,error:n}}var sy=null;function uy(e){if(ey){var t=!sy;if(t&&(sy={errorThrown:!1,error:null}),e(),t){var n=sy,r=n.errorThrown,i=n.error;if(sy=null,r)throw i}}else e()}var cy=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,Yg(e)&&e.add(Fg(r))):r.destination=vy,r}return Wg(n,[{key:"next",value:function(e){this.isStopped?dy(oy("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?dy(oy("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?dy(ay,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,Rg(Vg(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new ly(e,t,n)}}]),n}(qg),ly=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a,o,s;if(Zg(this,n),o=t.call(this),Ug(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,Fg(o)&&ty?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?fy(s):iy,error:fy(null!==(a=r)&&void 0!==a?a:hy),complete:i?fy(i):iy},Lg(o)}return Wg(n)}(cy);function fy(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){ey?function(e){ey&&sy&&(sy.errorThrown=!0,sy.error=e)}(t):ry(t)}}}function hy(e){throw e}function dy(e,t){var n=Xg;n&&ny.setTimeout(function(){return n(e,t)})}var vy={closed:!0,next:iy,error:hy,complete:iy},py="function"==typeof Symbol&&Symbol.observable||"@@observable";function gy(e){return e}var yy=function(){var e=function(){function e(t){Zg(this,e),t&&(this._subscribe=t)}return Wg(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof cy||function(e){return e&&Ug(e.next)&&Ug(e.error)&&Ug(e.complete)}(e)&&Yg(e)}(e)?e:new ly(e,t,n);return uy(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=my(t))(function(t,r){var i=new ly({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:py,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?gy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=my(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function my(e){var t;return null!==(t=null!=e?e:Jg)&&void 0!==t?t:Promise}var ky=zg(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Cy=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Wg(n,[{key:"lift",value:function(e){var t=new wy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new ky}},{key:"next",value:function(e){var t=this;uy(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Gg(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;uy(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;uy(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),Rg(Vg(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?jg:(r.push(e),new qg(function(){return $g(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new yy;return e.source=this,e}}]),n}(yy);return e.create=function(e,t){return new wy(e,t)},e}(),wy=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).destination=e,i.source=r,i}return Wg(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:jg}}]),n}(Cy);function _y(e){return Ug(null==e?void 0:e.lift)}function by(e){return function(t){if(_y(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Ey=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s,u,c,l;return Zg(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:Rg((s=Fg(l),Vg(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:Rg((u=Fg(l),Vg(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:Rg((c=Fg(l),Vg(n.prototype)),"_complete",c),l}return Wg(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;Rg(Vg(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(cy);function Sy(e,t){return by(function(n,r){var i=0;n.subscribe(new Ey(r,function(n){r.next(e.call(t,n,i++))}))})}function Py(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Oy(e){return this instanceof Oy?(this.v=e,this):new Oy(e)}function Ty(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Oy?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Iy(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Ay=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ry(e){return Ug(null==e?void 0:e.then)}function xy(e){return Ug(e[py])}function My(e){return Symbol.asyncIterator&&Ug(null==e?void 0:e[Symbol.asyncIterator])}function Ny(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var Dy="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ly(e){return Ug(null==e?void 0:e[Dy])}function Fy(e){return Ty(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Oy(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Oy(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Oy(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function Uy(e){return Ug(null==e?void 0:e.getReader)}function Vy(e){if(e instanceof yy)return e;if(null!=e){if(xy(e))return function(e){return new yy(function(t){var n=e[py]();if(Ug(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Ay(e))return function(e){return new yy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Ry(e))return function(e){return new yy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,ry)})}(e);if(My(e))return By(e);if(Ly(e))return function(e){return new yy(function(t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(Uy(e))return function(e){return By(Fy(e))}(e)}throw Ny(e)}function By(e){return new yy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Iy(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function zy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Gy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Ug(t)?Gy(function(n,r){return Sy(function(e,i){return t(n,e,r,i)})(Vy(e(n,r)))},n):("number"==typeof t&&(n=t),by(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;Vy(n(i,l++)).subscribe(new Ey(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new Ey(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function Hy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Gy(gy,e)}var $y=new yy(function(e){return e.complete()});function Zy(e){return e[e.length-1]}function qy(e){return Ug(Zy(e))?e.pop():void 0}function Wy(e){return function(e){return e&&Ug(e.schedule)}(Zy(e))?e.pop():void 0}function jy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return by(function(n,r){n.subscribe(new Ey(r,function(n){return zy(r,e,function(){return r.next(n)},t)},function(){return zy(r,e,function(){return r.complete()},t)},function(n){return zy(r,e,function(){return r.error(n)},t)}))})}function Yy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return by(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Ky(e,t){if(!e)throw new Error("Iterable cannot be null");return new yy(function(n){zy(n,t,function(){var r=e[Symbol.asyncIterator]();zy(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Qy(e,t){return t?function(e,t){if(null!=e){if(xy(e))return function(e,t){return Vy(e).pipe(Yy(t),jy(t))}(e,t);if(Ay(e))return function(e,t){return new yy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Ry(e))return function(e,t){return Vy(e).pipe(Yy(t),jy(t))}(e,t);if(My(e))return Ky(e,t);if(Ly(e))return function(e,t){return new yy(function(n){var r;return zy(n,t,function(){r=e[Dy](),zy(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return Ug(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Uy(e))return function(e,t){return Ky(Fy(e),t)}(e,t)}throw Ny(e)}(e,t):Vy(e)}function Xy(e){return e<=0?function(){return $y}:by(function(t,n){var r=0;t.subscribe(new Ey(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function Jy(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(Xy(1)).subscribe(function(){return e()})}function em(e){for(var t in e)if(e[t]===em)return t;throw Error("Could not find renamed property on target object.")}function tm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function nm(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(nm).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function rm(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var im=em({__forward_ref__:em});function am(e){return e.__forward_ref__=am,e.toString=function(){return nm(this())},e}function om(e){return sm(e)?e():e}function sm(e){return"function"==typeof e&&e.hasOwnProperty(im)&&e.__forward_ref__===am}var um=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return Wg(n)}(Ig(Error));function cm(e){return"string"==typeof e?e:null==e?"":String(e)}function lm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():cm(e)}function fm(e,t){var n=t?" in ".concat(t):"";throw new um("201","No provider for ".concat(lm(e)," found").concat(n))}function hm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function dm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function vm(e){return{providers:e.providers||[],imports:e.imports||[]}}function pm(e){return gm(e,km)||gm(e,wm)}function gm(e,t){return e.hasOwnProperty(t)?e[t]:null}function ym(e){return e&&(e.hasOwnProperty(Cm)||e.hasOwnProperty(_m))?e[Cm]:null}var mm,km=em({"\u0275prov":em}),Cm=em({"\u0275inj":em}),wm=em({ngInjectableDef:em}),_m=em({ngInjectorDef:em}),bm=((bm=bm||{})[bm.Default=0]="Default",bm[bm.Host=1]="Host",bm[bm.Self=2]="Self",bm[bm.SkipSelf=4]="SkipSelf",bm[bm.Optional=8]="Optional",bm);function Em(e){var t=mm;return mm=e,t}function Sm(e,t,n){var r=pm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&bm.Optional?null:void 0!==t?t:void fm(nm(e),"Injector")}function Pm(e){return{toString:e}.toString()}var Om=((Om=Om||{})[Om.OnPush=0]="OnPush",Om[Om.Default=1]="Default",Om),Tm=((Tm=Tm||{})[Tm.Emulated=0]="Emulated",Tm[Tm.None=2]="None",Tm[Tm.ShadowDom=3]="ShadowDom",Tm),Im="undefined"!=typeof globalThis&&globalThis,Am="undefined"!=typeof window&&window,Rm="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,xm=Im||"undefined"!=typeof global&&global||Am||Rm,Mm={},Nm=[],Dm=em({"\u0275cmp":em}),Lm=em({"\u0275dir":em}),Fm=em({"\u0275pipe":em}),Um=em({"\u0275mod":em}),Vm=em({"\u0275loc":em}),Bm=em({"\u0275fac":em}),zm=em({__NG_ELEMENT_ID__:em}),Gm=0;function Hm(e){return Pm(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Om.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Nm,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Tm.Emulated,id:"c",styles:e.styles||Nm,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=Gm++,n.inputs=jm(e.inputs,t),n.outputs=jm(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map($m)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(Zm)}:null,n})}function $m(e){return Qm(e)||function(e){return e[Lm]||null}(e)}function Zm(e){return function(e){return e[Fm]||null}(e)}var qm={};function Wm(e){return Pm(function(){var t={type:e.type,bootstrap:e.bootstrap||Nm,declarations:e.declarations||Nm,imports:e.imports||Nm,exports:e.exports||Nm,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(qm[e.id]=e.type),t})}function jm(e,t){if(null==e)return Mm;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var Ym=Hm;function Km(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Qm(e){return e[Dm]||null}function Xm(e,t){var n=e[Um]||null;if(!n&&!0===t)throw new Error("Type ".concat(nm(e)," does not have '\u0275mod' property."));return n}function Jm(e){return Array.isArray(e)&&"object"==typeof e[1]}function ek(e){return Array.isArray(e)&&!0===e[1]}function tk(e){return 0!=(8&e.flags)}function nk(e){return 2==(2&e.flags)}function rk(e){return 1==(1&e.flags)}function ik(e){return null!==e.template}function ak(e){return 0!=(512&e[2])}function ok(e,t){return e.hasOwnProperty(Bm)?e[Bm]:null}var sk=function(){function e(t,n,r){Zg(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return Wg(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function uk(){return ck}function ck(e){return e.type.prototype.ngOnChanges&&(e.setInput=fk),lk}function lk(){var e=dk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===Mm)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function fk(e,t,n,r){var i=dk(e)||function(e,t){return e[hk]=t}(e,{previous:Mm,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new sk(u&&u.currentValue,t,o===Mm),e[r]=t}uk.ngInherit=!0;var hk="__ngSimpleChanges__";function dk(e){return e[hk]||null}var vk,pk="http://www.w3.org/2000/svg";function gk(){return void 0!==vk?vk:"undefined"!=typeof document?document:void 0}function yk(e){return!!e.listen}var mk={createRenderer:function(e,t){return gk()}};function kk(e){for(;Array.isArray(e);)e=e[0];return e}function Ck(e,t){return kk(t[e])}function wk(e,t){return kk(t[e.index])}function _k(e,t){return e.data[t]}function bk(e,t){return e[t]}function Ek(e,t){var n=t[e];return Jm(n)?n:n[0]}function Sk(e){return 4==(4&e[2])}function Pk(e){return 128==(128&e[2])}function Ok(e,t){return null==t?null:e[t]}function Tk(e){e[18]=0}function Ik(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Ak={lFrame:nC(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Rk(){return Ak.bindingsEnabled}function xk(){return Ak.lFrame.lView}function Mk(){return Ak.lFrame.tView}function Nk(e){return Ak.lFrame.contextLView=e,e[8]}function Dk(){for(var e=Lk();null!==e&&64===e.type;)e=e.parent;return e}function Lk(){return Ak.lFrame.currentTNode}function Fk(){var e=Ak.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Uk(e,t){var n=Ak.lFrame;n.currentTNode=e,n.isParent=t}function Vk(){return Ak.lFrame.isParent}function Bk(){Ak.lFrame.isParent=!1}function zk(){return Ak.isInCheckNoChangesMode}function Gk(e){Ak.isInCheckNoChangesMode=e}function Hk(){var e=Ak.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function $k(){return Ak.lFrame.bindingIndex}function Zk(){return Ak.lFrame.bindingIndex++}function qk(e){var t=Ak.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Wk(e){Ak.lFrame.inI18n=e}function jk(e,t){var n=Ak.lFrame;n.bindingIndex=n.bindingRootIndex=e,Yk(t)}function Yk(e){Ak.lFrame.currentDirectiveIndex=e}function Kk(){return Ak.lFrame.currentQueryIndex}function Qk(e){Ak.lFrame.currentQueryIndex=e}function Xk(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Jk(e,t,n){if(n&bm.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&bm.Host||(r=Xk(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Ak.lFrame=tC();return a.currentTNode=t,a.lView=e,!0}function eC(e){var t=tC(),n=e[1];Ak.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function tC(){var e=Ak.lFrame,t=null===e?null:e.child;return null===t?nC(e):t}function nC(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function rC(){var e=Ak.lFrame;return Ak.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var iC=rC;function aC(){var e=rC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function oC(){return Ak.lFrame.selectedIndex}function sC(e){Ak.lFrame.selectedIndex=e}function uC(){var e=Ak.lFrame;return _k(e.tView,e.selectedIndex)}function cC(){Ak.lFrame.currentNamespace=pk}function lC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function fC(e,t,n){vC(e,t,3,n)}function hC(e,t,n,r){(3&e[2])===n&&vC(e,t,n,r)}function dC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function vC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(pC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function pC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var gC=Wg(function e(t,n,r){Zg(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function yC(e,t,n){for(var r=yk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];kC(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function mC(e){return 3===e||4===e||6===e}function kC(e){return 64===e.charCodeAt(0)}function CC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||wC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function wC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function _C(e){return-1!==e}function bC(e){return 32767&e}function EC(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var SC=!0;function PC(e){var t=SC;return SC=e,t}var OC=0;function TC(e,t){var n=AC(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,IC(r.data,e),IC(t,null),IC(r.blueprint,null));var i=RC(e,t),a=e.injectorIndex;if(_C(i))for(var o=bC(i),s=EC(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function IC(e,t){e.push(0,0,0,0,0,0,0,0,t)}function AC(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function RC(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function xC(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(zm)&&(r=n[zm]),null==r&&(r=n[zm]=OC++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function MC(e,t,n){if(n&bm.Optional)return e;fm(t,"NodeInjector")}function NC(e,t,n,r){if(n&bm.Optional&&void 0===r&&(r=null),0==(n&(bm.Self|bm.Host))){var i=e[9],a=Em(void 0);try{return i?i.get(t,r,n&bm.Optional):Sm(t,r,n&bm.Optional)}finally{Em(a)}}return MC(r,t,n)}function DC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bm.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(zm)?e[zm]:void 0;return"number"==typeof t?t>=0?255&t:FC:t}(n);if("function"==typeof a){if(!Jk(t,e,r))return r&bm.Host?MC(i,n,r):NC(t,n,r,i);try{var o=a(r);if(null!=o||r&bm.Optional)return o;fm(n)}finally{iC()}}else if("number"==typeof a){var s=null,u=AC(e,t),c=-1,l=r&bm.Host?t[16][6]:null;for((-1===u||r&bm.SkipSelf)&&(-1!==(c=-1===u?RC(e,t):t[u+8])&&GC(r,!1)?(s=t[1],u=bC(c),t=EC(c,t)):u=-1);-1!==u;){var f=t[1];if(zC(a,u,f.data)){var h=UC(u,t,n,s,r,l);if(h!==LC)return h}-1!==(c=t[u+8])&&GC(r,t[1].data[u+8]===l)&&zC(a,u,t)?(s=f,u=bC(c),t=EC(c,t)):u=-1}}}return NC(t,n,r,i)}var LC={};function FC(){return new HC(Dk(),xk())}function UC(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=VC(s,o,n,null==r?nk(s)&&SC:r!=o&&0!=(3&s.type),i&bm.Host&&a===s);return null!==u?BC(t,o,u,s):LC}function VC(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&ik(d)&&d.type===n)return u}return null}function BC(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof gC}(i)){var o=i;o.resolving&&function(e,t){throw new um("200","Circular dependency in DI detected for ".concat(e))}(lm(a[n]));var s=PC(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Em(o.injectImpl):null;Jk(e,r,bm.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=ck(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Em(u),PC(s),o.resolving=!1,iC()}}return i}function zC(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function GC(e,t){return!(e&bm.Self||e&bm.Host&&t)}var HC=function(){function e(t,n){Zg(this,e),this._tNode=t,this._lView=n}return Wg(e,[{key:"get",value:function(e,t,n){return DC(this._tNode,this._lView,e,n,t)}}]),e}();function $C(e){return Pm(function(){for(var t=e.prototype.constructor,n=t[Bm]||ZC(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[Bm]||ZC(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function ZC(e){return sm(e)?function(){var t=ZC(om(e));return t&&t()}:ok(e)}function qC(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(mC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(Dk(),e)}var WC="__parameters__";function jC(e,t,n){return Pm(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Ag(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(WC)?e[WC]:Object.defineProperty(e,WC,{value:[]})[WC];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var YC=function(){function e(t,n){Zg(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=dm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return Wg(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),KC=new YC("AnalyzeForEntryComponents"),QC=Function;function XC(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),XC(r,t)):t!==e&&t.push(r)}return t}function JC(e,t){e.forEach(function(e){return Array.isArray(e)?JC(e,t):t(e)})}function ew(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function tw(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function nw(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function rw(e,t,n){var r=aw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function iw(e,t){var n=aw(e,t);if(n>=0)return e[1|n]}function aw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var ow,sw={},uw="__NG_DI_FLAG__",cw="ngTempTokenPath",lw=/\n/gm,fw="__source",hw=em({provide:String,useValue:em});function dw(e){var t=ow;return ow=e,t}function vw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bm.Default;if(void 0===ow)throw new Error("inject() must be called from an injection context");return null===ow?Sm(e,void 0,t):ow.get(e,t&bm.Optional?null:void 0,t)}function pw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bm.Default;return(mm||vw)(om(e),t)}function gw(e){for(var t=[],n=0;n<e.length;n++){var r=om(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=bm.Default,o=0;o<r.length;o++){var s=r[o],u=mw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(pw(i,a))}else t.push(pw(r))}return t}function yw(e,t){return e[uw]=t,e.prototype[uw]=t,e}function mw(e){return e[uw]}function kw(e,t,n,r){var i=e[cw];throw t[fw]&&i.unshift(t[fw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=nm(t);if(Array.isArray(t))i=t.map(nm).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):nm(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(lw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[cw]=null,e}var Cw,ww,_w=yw(jC("Inject",function(e){return{token:e}}),-1),bw=yw(jC("Optional"),8),Ew=yw(jC("SkipSelf"),4);function Sw(e){var t;return(null===(t=function(){if(void 0===Cw&&(Cw=null,xm.trustedTypes))try{Cw=xm.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Cw}())||void 0===t?void 0:t.createHTML(e))||e}function Pw(e){var t;return(null===(t=function(){if(void 0===ww&&(ww=null,xm.trustedTypes))try{ww=xm.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return ww}())||void 0===t?void 0:t.createHTML(e))||e}var Ow=function(){function e(t){Zg(this,e),this.changingThisBreaksApplicationSecurity=t}return Wg(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Tw=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Ow),Iw=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Ow),Aw=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Ow),Rw=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Ow),xw=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Ow);function Mw(e){return e instanceof Ow?e.changingThisBreaksApplicationSecurity:e}function Nw(e,t){var n=Dw(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function Dw(e){return e instanceof Ow&&e.getTypeName()||null}function Lw(e){var t=new Uw(e);return function(){try{return!!(new window.DOMParser).parseFromString(Sw(""),"text/html")}catch(e){return!1}}()?new Fw(t):t}var Fw=function(){function e(t){Zg(this,e),this.inertDocumentHelper=t}return Wg(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Sw(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Uw=function(){function e(t){if(Zg(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return Wg(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Sw(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Sw(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),Vw=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Bw=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function zw(e){return(e=String(e)).match(Vw)||e.match(Bw)?e:"unsafe:"+e}function Gw(e){return(e=String(e)).split(",").map(function(e){return zw(e.trim())}).join(", ")}function Hw(e){var t,n={},r=Gg(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function $w(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var Zw,qw=Hw("area,br,col,hr,img,wbr"),Ww=Hw("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jw=Hw("rp,rt"),Yw=$w(qw,$w(Ww,Hw("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$w(jw,Hw("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$w(jw,Ww)),Kw=Hw("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Qw=Hw("srcset"),Xw=$w(Kw,Qw,Hw("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Hw("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Jw=Hw("script,style,template"),e_=function(){function e(){Zg(this,e),this.sanitizedSomething=!1,this.buf=[]}return Wg(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!Yw.hasOwnProperty(t))return this.sanitizedSomething=!0,!Jw.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(Xw.hasOwnProperty(o)){var s=i.value;Kw[o]&&(s=zw(s)),Qw[o]&&(s=Gw(s)),this.buf.push(" ",a,'="',r_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();Yw.hasOwnProperty(t)&&!qw.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(r_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),t_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n_=/([^\#-~ |!])/g;function r_(e){return e.replace(/&/g,"&amp;").replace(t_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(n_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i_(e,t){var n=null;try{Zw=Zw||Lw(e);var r=t?String(t):"";n=Zw.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=Zw.getInertBodyElement(r)}while(r!==a);return Sw((new e_).sanitizeChildren(a_(n)||n))}finally{if(n)for(var o=a_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function a_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var o_=((o_=o_||{})[o_.NONE=0]="NONE",o_[o_.HTML=1]="HTML",o_[o_.STYLE=2]="STYLE",o_[o_.SCRIPT=3]="SCRIPT",o_[o_.URL=4]="URL",o_[o_.RESOURCE_URL=5]="RESOURCE_URL",o_);function s_(e){var t=c_();return t?Pw(t.sanitize(o_.HTML,e)||""):Nw(e,"HTML")?Pw(Mw(e)):i_(gk(),cm(e))}function u_(e){var t=c_();return t?t.sanitize(o_.URL,e)||"":Nw(e,"URL")?Mw(e):zw(cm(e))}function c_(){var e=xk();return e&&e[12]}var l_="__ngContext__";function f_(e,t){e[l_]=t}function h_(e){var t=function(e){return e[l_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function d_(e){return e.ngOriginalError}function v_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var p_=function(){function e(){Zg(this,e),this._console=console}return Wg(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||v_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(d_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&d_(e);t&&d_(t);)t=d_(t);return t||null}}]),e}(),g_=/^>|^->|<!--|-->|--!>|<!-$/g,y_=/(<|>)/,m_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(xm);function k_(e){return e instanceof Function?e():e}var C_,w_=((w_=w_||{})[w_.Important=1]="Important",w_[w_.DashCase=2]="DashCase",w_);function __(e,t){return C_(e,t)}function b_(e){var t=e[3];return ek(t)?t[3]:t}function E_(e){return P_(e[13])}function S_(e){return P_(e[4])}function P_(e){for(;null!==e&&!ek(e);)e=e[4];return e}function O_(e,t,n,r,i){if(null!=r){var a,o=!1;ek(r)?a=r:Jm(r)&&(o=!0,r=r[0]);var s=kk(r);0===e&&null!==n?null==i?V_(t,n,s):U_(t,n,s,i||null,!0):1===e&&null!==n?U_(t,n,s,i||null,!0):2===e?Q_(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==kk(n)&&O_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];J_(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function T_(e,t){return yk(e)?e.createText(t):e.createTextNode(t)}function I_(e,t,n){yk(e)?e.setValue(t,n):t.textContent=n}function A_(e,t){return e.createComment(function(e){return e.replace(g_,function(e){return e.replace(y_,"\u200b$1\u200b")})}(t))}function R_(e,t,n){return yk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function x_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Ik(i,-1)),n.splice(r,1)}function M_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&x_(i,r),t>0&&(e[n-1][4]=r[4]);var a=tw(e,10+t);!function(e,t){J_(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function N_(e,t){if(!(256&t[2])){var n=t[11];yk(n)&&n.destroyNode&&J_(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return D_(e[1],e);for(;t;){var n=null;if(Jm(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)Jm(t)&&D_(t[1],t),t=t[3];null===t&&(t=e),Jm(t)&&D_(t[1],t),n=t&&t[4]}t=n}}(t)}}function D_(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof gC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):kk(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&yk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&ek(t[3])){n!==t[3]&&x_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function L_(e,t,n){return F_(e,t.parent,n)}function F_(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Tm.None||i===Tm.Emulated)return null}return wk(r,n)}function U_(e,t,n,r,i){yk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function V_(e,t,n){yk(e)?e.appendChild(t,n):t.appendChild(n)}function B_(e,t,n,r,i){null!==r?U_(e,t,n,r,i):V_(e,t,n)}function z_(e,t){return yk(e)?e.parentNode(t):t.parentNode}function G_(e,t,n){return Z_(e,t,n)}function H_(e,t,n){return 40&e.type?wk(e,n):null}var $_,Z_=H_;function q_(e,t){Z_=e,$_=t}function W_(e,t,n,r){var i=L_(e,r,t),a=t[11],o=G_(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)B_(a,i,n[s],o,!1);else B_(a,i,n,o,!1);void 0!==$_&&$_(a,r,t,n,i)}function j_(e,t){if(null!==t){var n=t.type;if(3&n)return wk(t,e);if(4&n)return K_(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return j_(e,r);var i=e[t.index];return ek(i)?K_(-1,i):kk(i)}if(32&n)return __(t,e)()||kk(e[t.index]);var a=Y_(e,t);return null!==a?Array.isArray(a)?a[0]:j_(b_(e[16]),a):j_(e,t.next)}return null}function Y_(e,t){return null!==t?e[16][6].projection[t.projection]:null}function K_(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return j_(r,i)}return t[7]}function Q_(e,t,n){var r=z_(e,t);r&&function(e,t,n,r){yk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function X_(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&f_(kk(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)X_(e,t,n.child,r,i,a,!1),O_(t,e,i,s,a);else if(32&u){for(var c=__(n,r),l=void 0;l=c();)O_(t,e,i,l,a);O_(t,e,i,s,a)}else 16&u?eb(e,t,r,n,i,a):O_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function J_(e,t,n,r,i,a){X_(n,r,e.firstChild,t,i,a,!1)}function eb(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)O_(t,e,i,s[u],a);else X_(e,t,s,o[3],i,a,!0)}function tb(e,t,n){yk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function nb(e,t,n){yk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function rb(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var ib="ng-template";function ab(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==rb((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function ob(e){return 4===e.type&&e.value!==ib}function sb(e,t,n){return t===(4!==e.type||n?e.value:ib)}function ub(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(mC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!sb(e,u,n)||""===u&&1===t.length){if(cb(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!ab(e.attrs,c,n)){if(cb(r))return!1;o=!0}continue}var l=lb(8&r?"class":u,i,ob(e),n);if(-1===l){if(cb(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==rb(h,c,0)||2&r&&c!==f){if(cb(r))return!1;o=!0}}}}else{if(!o&&!cb(r)&&!cb(u))return!1;if(o&&cb(u))continue;o=!1,r=u|1&r}}return cb(r)||o}function cb(e){return 0==(1&e)}function lb(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function fb(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(ub(e,t[r],n))return!0;return!1}function hb(e,t){return e?":not("+t.trim()+")":t}function db(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!cb(o)&&(t+=hb(a,i),i=""),r=o,a=a||!cb(r);n++}return""!==i&&(t+=hb(a,i)),t}var vb={};function pb(e){gb(Mk(),xk(),oC()+e,zk())}function gb(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&fC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&hC(t,a,0,n)}sC(n)}function yb(e,t){return e<<17|t<<2}function mb(e){return e>>17&32767}function kb(e){return 2|e}function Cb(e){return(131068&e)>>2}function wb(e,t){return-131069&e|t<<2}function _b(e){return 1|e}function bb(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];Qk(i),o.contentQueries(2,t[a],a)}}}function Eb(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Tk(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function Sb(e,t,n,r,i){var a=e.data[t];if(null===a)a=Pb(e,t,n,r,i),Ak.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=Fk();a.injectorIndex=null===o?-1:o.injectorIndex}return Uk(a,!0),a}function Pb(e,t,n,r,i){var a=Lk(),o=Vk(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function Ob(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Tb(e,t,n){eC(t);try{var r=e.viewQuery;null!==r&&oE(1,r,n);var i=e.template;null!==i&&Rb(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&bb(e,t),e.staticViewQueries&&oE(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)tE(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,aC()}}function Ib(e,t,n,r){var i=t[2];if(256!=(256&i)){eC(t);var a=zk();try{Tk(t),function(e){Ak.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Rb(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&fC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&hC(t,u,0,null),dC(t,0)}if(function(e){for(var t=E_(e);null!==t;t=S_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Ik(a,1),i[2]|=1024}}(t),function(e){for(var t=E_(e);null!==t;t=S_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Pk(r)&&Ib(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&bb(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&fC(t,c)}else{var l=e.contentHooks;null!==l&&hC(t,l,1),dC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)sC(~i);else{var a=i,o=n[++r],s=n[++r];jk(o,a),s(2,t[a])}}}finally{sC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)Jb(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&oE(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&fC(t,d)}else{var v=e.viewHooks;null!==v&&hC(t,v,2),dC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Ik(t[3],-1))}finally{aC()}}}function Ab(e,t,n,r){var i=t[10],a=!zk(),o=Sk(t);try{a&&!o&&i.begin&&i.begin(),o&&Tb(e,t,r),Ib(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function Rb(e,t,n,r,i){var a=oC(),o=2&r;try{sC(-1),o&&t.length>20&&gb(e,t,20,zk()),n(r,i)}finally{sC(a)}}function xb(e,t,n){if(tk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function Mb(e,t,n){!Rk()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||TC(n,t),f_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=ik(u);c&&Wb(t,n,u);var l=BC(t,e,s,n);f_(l,t),null!==o&&Kb(0,s-i,l,u,0,o),c&&(Ek(n.index,t)[8]=l)}}(e,t,n,wk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Ak.lFrame.currentDirectiveIndex;try{sC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];Yk(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Gb(u,c)}}finally{sC(-1),Yk(o)}}(e,t,n))}function Nb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function Db(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Lb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Lb(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:vb);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function Fb(e,t,n,r){var i=uE(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&cE(e).push(r,i.length-1))}function Ub(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Vb(e,t,n,r,i,a,o,s){var u,c=wk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(fE(e,n,u,r,i),nk(t)&&function(e,t){var n=Ek(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,yk(a)?a.setProperty(c,r,i):kC(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function Bb(e,t,n,r){var i=!1;if(Rk()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];fb(n,o.selectors,!1)&&(i||(i=[]),xC(TC(n,t),e,o.type),ik(o)?(Hb(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,Zb(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=Ob(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=CC(n.mergedAttrs,d.hostAttrs),qb(e,n,t,f,d),$b(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||ob(t)?null:Qb(l,i);a.push(f),o=Ub(l,u,o),s=Ub(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new um("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=CC(n.mergedAttrs,n.attrs),i}function zb(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function Gb(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Hb(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function $b(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ik(t)&&(n[""]=e)}}function Zb(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function qb(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=ok(i.type)),o=new gC(a,ik(i),null);e.blueprint[r]=o,n[r]=o,zb(e,t,0,r,Ob(e,n,i.hostVars,vb),i)}function Wb(e,t,n){var r=wk(t,e),i=Db(n),a=e[10],o=nE(e,Eb(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function jb(e,t,n,r,i,a){var o=wk(e,t);Yb(t[11],o,a,e.value,n,r,i)}function Yb(e,t,n,r,i,a,o){if(null==a)yk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?cm(a):o(a,r||"",i);yk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function Kb(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function Qb(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Xb(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function Jb(e,t){var n=Ek(t,e);if(Pk(n)){var r=n[1];80&n[2]?Ib(r,n,r.template,n[8]):n[5]>0&&eE(n)}}function eE(e){for(var t=E_(e);null!==t;t=S_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];Ib(i,r,i.template,r[8])}else r[5]>0&&eE(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Ek(a[o],e);Pk(s)&&s[5]>0&&eE(s)}}function tE(e,t){var n=Ek(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Tb(r,n,n[8])}function nE(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function rE(e){for(;e;){e[2]|=64;var t=b_(e);if(ak(e)&&!t)return e;e=t}return null}function iE(e,t,n){var r=t[10];r.begin&&r.begin();try{Ib(e,t,e.template,n)}catch(i){throw lE(t,i),i}finally{r.end&&r.end()}}function aE(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=h_(n),i=r[1];Ab(i,r,i.template,n)}}(e[8])}function oE(e,t,n){Qk(0),t(e,n)}var sE=Promise.resolve(null);function uE(e){return e[7]||(e[7]=[])}function cE(e){return e.cleanup||(e.cleanup=[])}function lE(e,t){var n=e[9],r=n?n.get(p_,null):null;r&&r.handleError(t)}function fE(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function hE(e,t,n){var r=Ck(t,e);I_(e[11],r,n)}function dE(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=rm(i,s):2==a&&(r=rm(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var vE,pE=new YC("INJECTOR",-1),gE=function(){function e(){Zg(this,e)}return Wg(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sw;if(t===sw){var n=new Error("NullInjectorError: No provider for ".concat(nm(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),yE=new YC("Set Injector scope."),mE={},kE={};function CE(){return void 0===vE&&(vE=new gE),vE}function wE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new _E(e,n,t||CE(),r)}var _E=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Zg(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&JC(n,function(e){return i.processProvider(e,t,n)}),JC([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(pE,SE(void 0,this));var s=this.records.get(yE);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:nm(t))}return Wg(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bm.Default;this.assertNotDestroyed();var r,i=dw(this),a=Em(void 0);try{if(!(n&bm.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof YC)&&pm(e);o=s&&this.injectableDefInScope(s)?SE(bE(e),mE):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&bm.Self?CE():this.parent).get(e,t=n&bm.Optional&&t===sw?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[cw]=u[cw]||[]).unshift(nm(e)),i)throw u;return kw(u,e,"R3InjectorError",this.source)}throw u}finally{Em(a),dw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(nm(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=om(e)))return!1;var i=ym(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=ym(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{JC(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;JC(i,function(e){return r.processProvider(e,n,i||Nm)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=ok(o)||function(){return new o};this.records.set(o,SE(f,mE));var h=i.providers;if(null!=h&&!s){var d=e;JC(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=OE(e=om(e))?e:om(e&&e.provide),a=PE(r=e)?SE(void 0,r.useValue):SE(EE(r),mE);if(OE(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=SE(void 0,mE,!0)).factory=function(){return gw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===mE&&(t.value=kE,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=om(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function bE(e){var t=pm(e),n=null!==t?t.factory:ok(e);if(null!==n)return n;if(e instanceof YC)throw new Error("Token ".concat(nm(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=nw(t,"?");throw new Error("Can't resolve all parameters for ".concat(nm(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[km]||e[wm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function EE(e,t,n){var r;if(OE(e)){var i=om(e);return ok(i)||bE(i)}if(PE(e))r=function(){return om(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,Bg(gw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return pw(om(e.useExisting))};else{var a=om(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return ok(a)||bE(a);r=function(){return Ag(a,Bg(gw(e.deps)))}}return r}function SE(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function PE(e){return null!==e&&"object"==typeof e&&hw in e}function OE(e){return"function"==typeof e}var TE=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=wE(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},IE=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?TE(e,t,""):TE(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=sw,e.NULL=new gE,e.\u0275prov=dm({token:e,providedIn:"any",factory:function(){return pw(pE)}}),e.__NG_ELEMENT_ID__=-1,e}();function AE(e,t){lC(h_(e)[1],Dk())}function RE(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(ik(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=xE(e.inputs),a.declaredInputs=xE(e.declaredInputs),a.outputs=xE(e.outputs);var o=i.hostBindings;o&&DE(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&ME(e,s),u&&NE(e,u),tm(e.inputs,i.inputs),tm(e.declaredInputs,i.declaredInputs),tm(e.outputs,i.outputs),ik(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===RE&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=CC(i.hostAttrs,n=CC(n,i.hostAttrs))}}(r)}function xE(e){return e===Mm?{}:e===Nm?[]:e}function ME(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function NE(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function DE(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var LE=null;function FE(){if(!LE){var e=xm.Symbol;if(e&&e.iterator)LE=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(LE=r)}}return LE}var UE=function(){function e(t){Zg(this,e),this.wrapped=t}return Wg(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function VE(e){return!!BE(e)&&(Array.isArray(e)||!(e instanceof Map)&&FE()in e)}function BE(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function zE(e,t,n){return e[t]=n}function GE(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function HE(e,t,n,r){var i=GE(e,t,n);return GE(e,t+1,r)||i}function $E(e,t,n,r){var i=xk();return GE(i,Zk(),t)&&(Mk(),jb(uC(),i,e,t,n,r)),$E}function ZE(e,t,n,r){return GE(e,Zk(),n)?t+cm(n)+r:vb}function qE(e,t,n,r,i,a){var o=HE(e,$k(),n,i);return qk(2),o?t+cm(n)+r+cm(i)+a:vb}function WE(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=HE(e,t,n,r);return GE(e,t+2,i)||a}(e,$k(),n,i,o);return qk(3),u?t+cm(n)+r+cm(i)+a+cm(o)+s:vb}function jE(e,t,n,r,i,a){var o=xk(),s=ZE(o,t,n,r);return s!==vb&&jb(uC(),o,e,s,i,a),jE}function YE(e,t,n,r,i,a,o,s){var u=xk(),c=Mk(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=Sb(t,e,4,o||null,Ok(c,s));Bb(t,n,l,Ok(c,u)),lC(t,l);var f=l.tViews=Lb(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];Uk(f,!1);var h=u[11].createComment("");W_(c,u,h,f),f_(h,u),nE(u,u[l]=Xb(h,u,h,f)),rk(f)&&Mb(c,u,f),null!=o&&Nb(u,f,s)}function KE(e){return bk(Ak.lFrame.contextLView,20+e)}function QE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bm.Default,n=xk();return null===n?pw(e,t):DC(Dk(),n,om(e),t)}function XE(e,t,n){var r=xk();return GE(r,Zk(),t)&&Vb(Mk(),uC(),r,e,t,r[11],n,!1),XE}function JE(e,t,n,r,i){var a=i?"class":"style";fE(e,n,t.inputs[a],a,r)}function eS(e,t,n,r){var i=xk(),a=Mk(),o=20+e,s=i[11],u=i[o]=R_(s,t,Ak.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=Sb(t,e,2,i,Ok(s,a));return Bb(t,n,u,Ok(s,o)),null!==u.attrs&&dE(u,u.attrs,!1),null!==u.mergedAttrs&&dE(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];Uk(c,!0);var l=c.mergedAttrs;null!==l&&yC(s,u,l);var f=c.classes;null!==f&&nb(s,u,f);var h=c.styles;null!==h&&tb(s,u,h),64!=(64&c.flags)&&W_(a,i,u,c),0===Ak.lFrame.elementDepthCount&&f_(u,i),Ak.lFrame.elementDepthCount++,rk(c)&&(Mb(a,i,c),xb(a,c,i)),null!==r&&Nb(i,c)}function tS(){var e=Dk();Vk()?Bk():Uk(e=e.parent,!1);var t=e;Ak.lFrame.elementDepthCount--;var n=Mk();n.firstCreatePass&&(lC(n,e),tk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&JE(n,t,xk(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&JE(n,t,xk(),t.stylesWithoutHost,!1)}function nS(e,t,n,r){eS(e,t,n,r),tS()}function rS(e,t,n){var r=xk(),i=Mk(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Ok(a,r),s=Sb(t,e,8,"ng-container",o);return null!==o&&dE(s,o,!0),Bb(t,n,s,Ok(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];Uk(o,!0);var s=r[a]=r[11].createComment("");W_(i,r,s,o),f_(s,r),rk(o)&&(Mb(i,r,o),xb(i,o,r)),null!=n&&Nb(r,o)}function iS(){var e=Dk(),t=Mk();Vk()?Bk():Uk(e=e.parent,!1),t.firstCreatePass&&(lC(t,e),tk(e)&&t.queries.elementEnd(e))}function aS(){return xk()}function oS(e){return!!e&&"function"==typeof e.then}var sS=function(e){return!!e&&"function"==typeof e.subscribe};function uS(e,t,n,r){var i=xk(),a=Mk(),o=Dk();return function(e,t,n,r,i,a,o,s){var u=rk(r),c=e.firstCreatePass&&cE(e),l=t[8],f=uE(t),h=!0;if(3&r.type||s){var d=wk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s(kk(e[r.index]))}:r.index;if(yk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=lS(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=lS(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=lS(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var b=t[k[_]][k[_+1]].subscribe(a),E=f.length;f.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),uS}function cS(e,t,n,r){try{return!1!==n(r)}catch(i){return lE(e,i),!1}}function lS(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Ek(e.index,t):t;0==(32&t[2])&&rE(o);for(var s=cS(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=cS(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function fS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Ak.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ak.lFrame.contextLView))[8]}(e)}function hS(e,t,n){return dS(e,"",t,"",n),hS}function dS(e,t,n,r,i){var a=xk(),o=ZE(a,t,n,r);return o!==vb&&Vb(Mk(),uC(),a,e,o,a[11],i,!1),dS}function vS(e,t,n,r,i,a,o){var s=xk(),u=qE(s,t,n,r,i,a);return u!==vb&&Vb(Mk(),uC(),s,e,u,s[11],o,!1),vS}function pS(e,t,n,r,i,a,o,s,u){var c=xk(),l=WE(c,t,n,r,i,a,o,s);return l!==vb&&Vb(Mk(),uC(),c,e,l,c[11],u,!1),pS}function gS(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?mb(a):Cb(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];yS(e[s],t)&&(u=!0,e[s+1]=r?_b(c):kb(c)),s=r?mb(c):Cb(c)}u&&(e[n+1]=r?kb(a):_b(a))}function yS(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&aw(e,t)>=0}var mS={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function kS(e){return e.substring(mS.key,mS.keyEnd)}function CS(e){return e.substring(mS.value,mS.valueEnd)}function wS(e,t){var n=mS.textEnd,r=mS.key=_S(e,t,n);return n===r?-1:(r=mS.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=bS(e,r,n),r=mS.value=_S(e,r,n),r=mS.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=ES(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=ES(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),bS(e,r,n))}function _S(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function bS(e,t,n,r){return(t=_S(e,t,n))<n&&t++,t}function ES(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function SS(e,t){return function(e,t,n,r){var i=xk(),a=Mk(),o=qk(2);a.firstUpdatePass&&IS(a,e,o,true),t!==vb&&GE(i,o,t)&&MS(a,a.data[oC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=nm(Mw(e))),e}(t),true,o)}(e,t),SS}function PS(e){!function(e,t,n,r){var i=Mk(),a=qk(2);i.firstUpdatePass&&IS(i,null,a,r);var o=xk();if(n!==vb&&GE(o,a,n)){var s=i.data[oC()];if(LS(s,r)&&!TS(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=rm(u,n||"")),JE(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===vb&&(i=Nm);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&MS(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return Nm;var r=[],i=Mw(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(xS,OS,e,!1)}function OS(e,t){for(var n=function(e){return function(e){mS.key=0,mS.keyEnd=0,mS.value=0,mS.valueEnd=0,mS.textEnd=e.length}(e),wS(e,_S(e,0,mS.textEnd))}(t);n>=0;n=wS(t,n))xS(e,kS(t),CS(t))}function TS(e,t){return t>=e.expandoStartIndex}function IS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[oC()],o=TS(e,n);LS(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Ak.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=RS(n=AS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=AS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==Cb(r))return e[mb(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[mb(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=RS(s=AS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=RS(r,e[a].hostAttrs,n);return RS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=mb(o),u=Cb(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||aw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=mb(e[s+1]);e[r+1]=yb(h,s),0!==h&&(e[h+1]=wb(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=yb(s,0),0!==s&&(e[s+1]=wb(e[s+1],r)),s=r;else e[r+1]=yb(u,0),0===s?s=r:e[u+1]=wb(e[u+1],r),u=r;l&&(e[r+1]=kb(e[r+1])),gS(e,c,r,!0),gS(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&aw(a,t)>=0&&(n[r+1]=_b(n[r+1]))}(t,c,e,r,a),o=yb(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function AS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=RS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function RS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),rw(e,o,!!n||t[++a]))}return void 0===e?null:e}function xS(e,t,n){rw(e,t,Mw(n))}function MS(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];DS(function(e){return 1==(1&e)}(c)?NS(u,t,n,i,Cb(c),o):void 0)||(DS(a)||function(e){return 2==(2&e)}(c)&&(a=NS(u,null,n,i,s,o)),function(e,t,n,r,i){var a=yk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:w_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=w_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Ck(oC(),n),i,a))}}function NS(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===vb&&(h=f?Nm:void 0);var d=f?iw(h,r):l===r?h:void 0;if(c&&!DS(d)&&(d=iw(u,r)),DS(d)&&(o=d,s))return o;var v=e[i+1];i=s?mb(v):Cb(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=iw(p,r))}return o}function DS(e){return void 0!==e}function LS(e,t){return 0!=(e.flags&(t?16:32))}function FS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=xk(),r=Mk(),i=e+20,a=r.firstCreatePass?Sb(r,i,1,t,null):r.data[i],o=n[i]=T_(n[11],t);W_(r,n,o,a),Uk(a,!1)}function US(e){return VS("",e,""),US}function VS(e,t,n){var r=xk(),i=ZE(r,e,t,n);return i!==vb&&hE(r,oC(),i),VS}function BS(e,t,n,r,i){var a=xk(),o=qE(a,e,t,n,r,i);return o!==vb&&hE(a,oC(),o),BS}function zS(e,t,n,r,i,a,o){var s=xk(),u=WE(s,e,t,n,r,i,a,o);return u!==vb&&hE(s,oC(),u),zS}function GS(e,t,n){var r=xk();return GE(r,Zk(),t)&&Vb(Mk(),uC(),r,e,t,r[11],n,!0),GS}var HS=void 0,$S=["en",[["a","p"],["AM","PM"],HS],[["AM","PM"],HS,HS],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],HS,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],HS,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",HS,"{1} 'at' {0}",HS],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],ZS={};function qS(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=jS(t);if(n)return n;var r=t.split("-")[0];if(n=jS(r))return n;if("en"===r)return $S;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function WS(e){return qS(e)[YS.PluralCase]}function jS(e){return e in ZS||(ZS[e]=xm.ng&&xm.ng.common&&xm.ng.common.locales&&xm.ng.common.locales[e]),ZS[e]}var YS=((YS=YS||{})[YS.LocaleId=0]="LocaleId",YS[YS.DayPeriodsFormat=1]="DayPeriodsFormat",YS[YS.DayPeriodsStandalone=2]="DayPeriodsStandalone",YS[YS.DaysFormat=3]="DaysFormat",YS[YS.DaysStandalone=4]="DaysStandalone",YS[YS.MonthsFormat=5]="MonthsFormat",YS[YS.MonthsStandalone=6]="MonthsStandalone",YS[YS.Eras=7]="Eras",YS[YS.FirstDayOfWeek=8]="FirstDayOfWeek",YS[YS.WeekendRange=9]="WeekendRange",YS[YS.DateFormat=10]="DateFormat",YS[YS.TimeFormat=11]="TimeFormat",YS[YS.DateTimeFormat=12]="DateTimeFormat",YS[YS.NumberSymbols=13]="NumberSymbols",YS[YS.NumberFormats=14]="NumberFormats",YS[YS.CurrencyCode=15]="CurrencyCode",YS[YS.CurrencySymbol=16]="CurrencySymbol",YS[YS.CurrencyName=17]="CurrencyName",YS[YS.Currencies=18]="Currencies",YS[YS.Directionality=19]="Directionality",YS[YS.PluralCase=20]="PluralCase",YS[YS.ExtraData=21]="ExtraData",YS),KS=["zero","one","two","few","many"],QS="en-US",XS={marker:"element"},JS={marker:"ICU"},eP=((eP=eP||{})[eP.SHIFT=2]="SHIFT",eP[eP.APPEND_EAGERLY=1]="APPEND_EAGERLY",eP[eP.COMMENT=2]="COMMENT",eP),tP=QS;function nP(e){(function(e,t){null==e&&hm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(tP=e.toLowerCase().replace(/_/g,"-"))}function rP(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?H_(e,0,n):kk(n[i])}function iP(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)U_(e,o,n[a[u]],s,!1)}}function aP(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];oP(r)||sP(r,t)&&null===uP(r)&&cP(r,t.index)}}function oP(e){return!(64&e.type)}function sP(e,t){return oP(t)||e.index>t.index}function uP(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function cP(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(q_(rP,iP),e.insertBeforeIndex=t)}function lP(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function fP(e,t,n){var r=Pb(e,n,64,null,null);return aP(t,r),r}function hP(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function dP(e){return e>>>17}function vP(e){return(131070&e)>>>1}var pP=0,gP=0;function yP(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=T_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=dP(u),f=void 0,h=void 0;if(null===o&&(o=l,i=z_(a,r)),l===o?(f=r,h=i):(f=null,h=kk(n[l])),null!==h){var d=vP(u);U_(a,h,n[d],f,!1);var v=lP(e,d);if(null!==v&&"object"==typeof v){var p=hP(v,n);null!==p&&yP(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];Yb(a,Ck(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case JS:var m=t[++s],k=t[++s];null===n[k]&&f_(n[k]=A_(a,m),n);break;case XS:var C=t[++s],w=t[++s];null===n[w]&&f_(n[w]=R_(a,C,null),n)}}}function mP(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=cm(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?Yb(t[11],t[f],null,v,h,u,d):Vb(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&I_(t[11],p,u);break;case 2:CP(e,lP(e,f),t,u);break;case 3:kP(e,lP(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=lP(e,g>>>2);t[y.currentCaseLViewIndex]<0&&kP(e,y,r,t)}}a+=s}}function kP(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=pP;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),mP(e,r,t.update[i],n,a)}}function CP(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=WS(t)(parseInt(e,10)),r=KS[n];return void 0!==r?r:"other"}(t,tP);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(hP(t,n)!==i&&(wP(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&yP(e,t.create[i],n,a)}}function wP(e,t,n){var r=hP(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Ck(o,n);null!==s&&Q_(n[11],s)}else wP(e,lP(e,~o),n)}}function _P(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=hP(e,n);t=null!==i?e.remove[i]:Nm}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var bP=/\ufffd(\d+):?\d*\ufffd/gi,EP=/\ufffd(\d+)\ufffd/,SP=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,PP=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,OP=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,TP=/\uE500/g;function IP(e,t,n,r,i,a,o){var s=Ob(e,r,1,null),u=s<<eP.SHIFT,c=Fk();t===c&&(c=null),null===c&&(u|=eP.APPEND_EAGERLY),o&&(u|=eP.COMMENT,function(e){void 0===C_&&(C_=e())}(_P)),i.push(u,null===a?"":a);var l=Pb(e,s,o?32:1,null===a?"":a,null);aP(n,l);var f=l.index;return Uk(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(q_(rP,iP),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&hm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function AP(e,t,n,r,i,a,o){var s=o.match(bP),u=IP(e,t,n,a,r,s?null:o,!1);s&&RP(i,o,u.index,null,0,null)}function RP(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(bP),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=xP(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function xP(e){return 1<<Math.min(e,31)}function MP(e){for(var t,n,r="",i=0,a=!1;null!==(t=PP.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function NP(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:Ob(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(xP(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=FP(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function DP(e){for(var t=[],n=[],r=1,i=0,a=LP(e=e.replace(SP,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=LP(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function LP(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);SP.test(s)?i.push(DP(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function FP(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=Lw(gk()).getInertBodyElement(o),h=a_(f)||f;return h?UP(e,t,n,r,u,c,l,h,i,s,0):0}function UP(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=Ob(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(Yw.hasOwnProperty(p)){zP(i,XS,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(bP)?Xw.hasOwnProperty(k)&&RP(o,m.value,d,m.name,0,Kw[k]?zw:Qw[k]?Gw:null):GP(i,d,m)}f=UP(e,t,n,r,i,a,o,h,d,c,l+1)|f,VP(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match(bP);zP(i,null,w?"":C,u,d),VP(a,d,l),w&&(f=RP(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=EP.exec(h.textContent||"");if(_){var b=c[parseInt(_[1],10)];zP(i,JS,"",u,d),NP(e,n,r,u,b,d),BP(a,d,l)}}h=h.nextSibling}return f}function VP(e,t,n){0===n&&e.push(t)}function BP(e,t,n){0===n&&(e.push(~t),e.push(t))}function zP(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function GP(e,t,n){e.push(t<<1|1,n.name,n.value)}function HP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=Mk(),i=xk(),a=20+e,o=Ok(r.consts,t),s=Fk();r.firstCreatePass&&function(e,t,n,r,i,a){var o=Fk(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return MP(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return MP(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(TP," ")}(i).split(OP),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=LP(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&AP(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));NP(e,n,u,t,y,IP(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),Uk(Fk(),!1);else{var C=fP(e,c[0],k);c.unshift([]),Uk(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=F_(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&eP.COMMENT)===eP.COMMENT,c=(o&eP.APPEND_EAGERLY)===eP.APPEND_EAGERLY,l=o>>>eP.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):T_(i,s)),c&&null!==n&&U_(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),Wk(!0)}function $P(){Wk(!1)}function ZP(e,t,n){HP(e,t,n),$P()}function qP(e){return function(e){e&&(pP|=1<<Math.min(gP,31)),gP++}(GE(xk(),Zk(),e)),qP}function WP(e){!function(e,t,n){if(gP>0){var r=e.data[n];mP(e,t,Array.isArray(r)?r:r.update,$k()-gP-1,pP)}pP=0,gP=0}(Mk(),xk(),e+20)}function jP(e,t,n,r,i){if(e=om(e),Array.isArray(e))for(var a=0;a<e.length;a++)jP(e[a],t,n,r,i);else{var o=Mk(),s=xk(),u=OE(e)?e:om(e.provide),c=EE(e),l=Dk(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(OE(e)||!e.multi){var v=new gC(c,i,QE),p=QP(u,t,i?f:f+d,h);-1===p?(xC(TC(l,s),o,u),YP(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=QP(u,t,f+d,h),y=QP(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){xC(TC(l,s),o,u);var C=function(e,t,n,r,i){var a=new gC(e,n,QE);return a.multi=[],a.index=t,a.componentProviders=0,KP(a,i,r&&!n),a}(i?JP:XP,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),YP(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else YP(o,e,g>-1?g:y,KP(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function YP(e,t,n,r){var i=OE(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function KP(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function QP(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function XP(e,t,n,r){return eO(this.multi,[])}function JP(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=BC(n,n[1],this.providerFactory.index,r);eO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else eO(a,i=[]);return i}function eO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function tO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=Mk();if(r.firstCreatePass){var i=ik(e);jP(n,r.data,r.blueprint,i,!0),jP(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var nO=Wg(function e(){Zg(this,e)}),rO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(nm(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),iO=function(){var e=Wg(function e(){Zg(this,e)});return e.NULL=new rO,e}();function aO(){}function oO(e,t){return new uO(wk(e,t))}var sO=function(){return oO(Dk(),xk())},uO=function(){var e=Wg(function e(t){Zg(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=sO,e}();function cO(e){return e instanceof uO?e.nativeElement:e}var lO=Wg(function e(){Zg(this,e)}),fO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=function(){return hO()},e}(),hO=function(){var e=xk(),t=Ek(Dk().index,e);return function(e){return e[11]}(Jm(t)?t:e)},dO=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275prov=dm({token:e,providedIn:"root",factory:function(){return null}}),e}(),vO=Wg(function e(t){Zg(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),pO=new vO("12.2.16"),gO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"supports",value:function(e){return VE(e)}},{key:"create",value:function(e){return new mO(e)}}]),e}(),yO=function(e,t){return t},mO=function(){function e(t){Zg(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||yO}return Wg(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<_O(n,r,i)?t:n,o=_O(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!VE(e))throw new Error("Error trying to diff '".concat(nm(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[FE()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new kO(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new wO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),kO=Wg(function e(t,n){Zg(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),CO=function(){function e(){Zg(this,e),this._head=null,this._tail=null}return Wg(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),wO=function(){function e(){Zg(this,e),this.map=new Map}return Wg(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new CO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function _O(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var bO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"supports",value:function(e){return e instanceof Map||BE(e)}},{key:"create",value:function(){return new EO}}]),e}(),EO=function(){function e(){Zg(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Wg(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||BE(e)))throw new Error("Error trying to diff '".concat(nm(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new SO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),SO=Wg(function e(t){Zg(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function PO(){return new OO([new gO])}var OO=function(){var e=function(){function e(t){Zg(this,e),this.factories=t}return Wg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||PO())},deps:[[e,new Ew,new bw]]}}}]),e}();return e.\u0275prov=dm({token:e,providedIn:"root",factory:PO}),e}();function TO(){return new IO([new bO])}var IO=function(){var e=function(){function e(t){Zg(this,e),this.factories=t}return Wg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||TO())},deps:[[e,new Ew,new bw]]}}}]),e}();return e.\u0275prov=dm({token:e,providedIn:"root",factory:TO}),e}();function AO(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(kk(a)),ek(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&AO(s[1],s,u,r)}var c=n.type;if(8&c)AO(e,t,n.child,r);else if(32&c)for(var l=__(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=Y_(t,n);if(Array.isArray(h))r.push.apply(r,Bg(h));else{var d=b_(t[16]);AO(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var RO=function(){function e(t,n){Zg(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return Wg(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return AO(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(ek(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(M_(e,n),tw(t,n))}this._attachedToViewContainer=!1}N_(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Fb(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){rE(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){iE(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Gk(!0);try{iE(e,t,n)}finally{Gk(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,J_(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),xO=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e))._view=e,r}return Wg(n,[{key:"detectChanges",value:function(){aE(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Gk(!0);try{aE(e)}finally{Gk(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(RO),MO=function(e){return function(e,t,n){if(nk(e)&&!n){var r=Ek(e.index,t);return new RO(r,r)}return 47&e.type?new RO(t[16],t):null}(Dk(),xk(),16==(16&e))},NO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=MO,e}(),DO=[new bO],LO=new OO([new gO]),FO=new IO(DO),UO=function(){return zO(Dk(),xk())},VO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=UO,e}(),BO=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return Wg(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Eb(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Tb(t,n,e),new RO(n)}}]),n}(VO);function zO(e,t){return 4&e.type?new BO(t,e,oO(e,t)):null}var GO=Wg(function e(){Zg(this,e)}),HO=Wg(function e(){Zg(this,e)}),$O=function(){return YO(Dk(),xk())},ZO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=$O,e}(),qO=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return Wg(n,[{key:"element",get:function(){return oO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new HC(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=RC(this._hostTNode,this._hostLView);if(_C(e)){var t=EC(e,this._hostLView),n=bC(e);return new HC(t[1].data[n+8],t)}return new HC(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=WO(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(GO,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(ek(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],ew(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=K_(u,c),f=r[11],h=z_(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,J_(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),ew(jO(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=WO(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=M_(this._lContainer,t);n&&(tw(jO(this._lContainer),t),N_(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=M_(this._lContainer,t);return n&&null!=tw(jO(this._lContainer),t)?new RO(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(ZO);function WO(e){return e[8]}function jO(e){return e[8]||(e[8]=[])}function YO(e,t){var n,r=t[e.index];if(ek(r))n=r;else{var i;if(8&e.type)i=kk(r);else{var a=t[11];i=a.createComment("");var o=wk(e,t);U_(a,z_(a,o),i,function(e,t){return yk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=Xb(r,t,i,e),nE(t,n)}return new qO(n,e,t)}var KO={},QO=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).ngModule=e,r}return Wg(n,[{key:"resolveComponentFactory",value:function(e){var t=Qm(e);return new eT(t,this.ngModule)}}]),n}(iO);function XO(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var JO=new YC("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return m_}}),eT=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(db).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return Wg(n,[{key:"inputs",get:function(){return XO(this.componentDef.inputs)}},{key:"outputs",get:function(){return XO(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,KO,i);return a!==KO||r===KO?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(lO,mk),u=o.get(dO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(yk(e))return e.selectRootElement(t,n===Tm.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):R_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?pk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:m_,clean:sE,playerHandler:null,flags:0},v=Lb(0,null,null,1,0,null,null,null,null,null),p=Eb(null,v,d,h,null,null,s,c,u,o);eC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=Sb(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(dE(s,u,!0),null!==e&&(yC(i,e,u),null!==s.classes&&nb(i,e,s.classes),null!==s.styles&&tb(i,e,s.styles)));var c=r.createRenderer(e,t),l=Eb(n,Db(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(xC(TC(s,n),o,t.type),Hb(o,s),Zb(s,n.length,1)),nE(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)yC(c,f,["ng-version",pO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!cb(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&yC(c,f,m),k&&k.length>0&&nb(c,f,k.join(" "))}if(a=_k(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=Dk();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),qb(e,r,t,Ob(e,t,1,null),n));var i=BC(t,e,r.directiveStart,r);f_(i,t);var a=wk(r,t);return a&&f_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=Dk();t.contentQueries(1,o,s.directiveStart)}var u=Dk();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(sC(u.index),zb(n[1],u,0,u.directiveStart,u.directiveEnd,t),Gb(t,o)),o}(g,this.componentDef,p,d,[AE]),Tb(v,p,null)}finally{aC()}return new tT(this.componentType,i,oO(a,p),p,a)}}]),n}(nO),tT=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new xO(a),s.componentType=e,s}return Wg(n,[{key:"injector",get:function(){return new HC(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),nT=new Map,rT=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;Zg(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=Fg(i),i.destroyCbs=[],i.componentFactoryResolver=new QO(Fg(i));var a=Xm(e),o=e[Vm]||null;return o&&nP(o),i._bootstrapComponents=k_(a.bootstrap),i._r3Injector=wE(e,r,[{provide:GO,useValue:Fg(i)},{provide:iO,useValue:i.componentFactoryResolver}],nm(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return Wg(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IE.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bm.Default;return e===IE||e===GO||e===pE?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(GO),iT=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).moduleType=e,null!==Xm(e)&&function(e){var t=new Set;!function e(n){var r=Xm(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(nm(t)," vs ").concat(nm(t.name)))}(i,nT.get(i),n),nT.set(i,n));var a,o=Gg(k_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return Wg(n,[{key:"create",value:function(e){return new rT(this.moduleType,e)}}]),n}(HO);function aT(e,t,n){var r=Hk()+e,i=xk();return i[r]===vb?zE(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function oT(e,t,n,r){return cT(xk(),Hk(),e,t,n,r)}function sT(e,t,n,r,i){return lT(xk(),Hk(),e,t,n,r,i)}function uT(e,t){var n=e[t];return n===vb?void 0:n}function cT(e,t,n,r,i,a){var o=t+n;return GE(e,o,i)?zE(e,o+1,a?r.call(a,i):r(i)):uT(e,o+1)}function lT(e,t,n,r,i,a,o){var s=t+n;return HE(e,s,i,a)?zE(e,s+2,o?r.call(o,i,a):r(i,a)):uT(e,s+2)}function fT(e,t){var n,r=Mk(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new um("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=ok(n.type)),o=Em(QE);try{var s=PC(!1),u=a();return PC(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,xk(),i,u),u}finally{Em(o)}}function hT(e,t,n){var r=e+20,i=xk(),a=bk(i,r);return vT(i,dT(i,r)?cT(i,Hk(),t,a.transform,n,a):a.transform(n))}function dT(e,t){return e[1].data[t].pure}function vT(e,t){return UE.isWrapped(t)&&(t=UE.unwrap(t),e[$k()]=vb),t}function pT(e){return function(t){setTimeout(e,void 0,t)}}var gT=function(e){Mg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Zg(this,n),(e=t.call(this)).__isAsync=r,e}return Wg(n,[{key:"emit",value:function(e){Rg(Vg(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=pT(u),s&&(s=pT(s)),c&&(c=pT(c)));var f=Rg(Vg(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof qg&&e.add(f),f}}]),n}(Cy);function yT(){return this._results[FE()]()}var mT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Zg(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=FE(),r=e.prototype;r[n]||(r[n]=yT)}return Wg(e,[{key:"changes",get:function(){return this._changes||(this._changes=new gT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=XC(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var kT=function(){function e(t){Zg(this,e),this.queryList=t,this.matches=null}return Wg(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),CT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Zg(this,e),this.queries=t}return Wg(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==RT(e,t).matches&&this.queries[t].setDirty()}}]),e}(),wT=Wg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Zg(this,e),this.predicate=t,this.flags=n,this.read=r}),_T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Zg(this,e),this.queries=t}return Wg(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),bT=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Zg(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return Wg(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,ET(t,i)),this.matchTNodeWithReadOption(e,t,VC(t,e,i,!1,!1))}else n===VO?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,VC(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===uO||r===ZO||r===VO&&4&t.type)this.addMatch(t.index,-2);else{var i=VC(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function ET(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function ST(e,t,n,r){return-1===n?function(e,t){return 11&e.type?oO(e,t):4&e.type?zO(e,t):null}(t,e):-2===n?function(e,t,n){return n===uO?oO(t,e):n===VO?zO(t,e):n===ZO?YO(t,e):void 0}(e,t,r):BC(e,e[1],n,t)}function PT(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:ST(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function OT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=PT(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&OT(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];OT(p[1],p,c,r)}}}return r}function TT(e){var t=xk(),n=Mk(),r=Kk();Qk(r+1);var i=RT(n,r);if(e.dirty&&Sk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?OT(n,t,r,[]):PT(n,t,i,r);e.reset(a,cO),e.notifyOnChanges()}return!0}return!1}function IT(e,t,n){var r=Mk();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new _T),e.queries.track(new bT(t,-1))}(r,new wT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new mT(4==(4&n));Fb(e,t,r,r.destroy),null===t[19]&&(t[19]=new CT),t[19].queries.push(new kT(r))}(r,xk(),t)}function AT(){return e=xk(),t=Kk(),e[19].queries[t].queryList;var e,t}function RT(e,t){return e.queries.getByIndex(t)}function xT(e,t){return zO(e,t)}var MT=new YC("Application Initializer"),NT=function(){var e=function(){function e(t){var n=this;Zg(this,e),this.appInits=t,this.resolve=aO,this.reject=aO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return Wg(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(oS(r))t.push(r);else if(sS(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(MT,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),DT=new YC("AppId"),LT={provide:DT,useFactory:function(){return"".concat(FT()).concat(FT()).concat(FT())},deps:[]};function FT(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var UT=new YC("Platform Initializer"),VT=new YC("Platform ID"),BT=new YC("appBootstrapListener"),zT=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),GT=new YC("LocaleId"),HT=new YC("DefaultCurrencyCode"),$T=Wg(function e(t,n){Zg(this,e),this.ngModuleFactory=t,this.componentFactories=n}),ZT=function(e){return new iT(e)},qT=ZT,WT=function(e){return Promise.resolve(ZT(e))},jT=function(e){var t=ZT(e),n=k_(Xm(e).declarations).reduce(function(e,t){var n=Qm(t);return n&&e.push(new eT(n)),e},[]);return new $T(t,n)},YT=jT,KT=function(e){return Promise.resolve(jT(e))},QT=function(){var e=function(){function e(){Zg(this,e),this.compileModuleSync=qT,this.compileModuleAsync=WT,this.compileModuleAndAllComponentsSync=YT,this.compileModuleAndAllComponentsAsync=KT}return Wg(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),XT=Promise.resolve(0);function JT(e){"undefined"==typeof Zone?XT.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var eI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(Zg(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gT(!1),this.onMicrotaskEmpty=new gT(!1),this.onStable=new gT(!1),this.onError=new gT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=xm.requestAnimationFrame,t=xm.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(xm,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,rI(e),e.isCheckStableRunning=!0,nI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),rI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return iI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),aI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return iI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),aI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,rI(e),nI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return Wg(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,tI,aO,aO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),tI={};function nI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function rI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function iI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function aI(e){e._nesting--,nI(e)}var oI,sI=function(){function e(){Zg(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gT,this.onMicrotaskEmpty=new gT,this.onStable=new gT,this.onError=new gT}return Wg(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),uI=function(){var e=function(){function e(t){var n=this;Zg(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return Wg(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){eI.assertNotInAngularZone(),JT(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())JT(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),cI=function(){var e=function(){function e(){Zg(this,e),this._applications=new Map,lI.addToWindow(this)}return Wg(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return lI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),lI=new(function(){function e(){Zg(this,e)}return Wg(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),fI=!0,hI=!1,dI=new YC("AllowMultipleToken"),vI=Wg(function e(t,n){Zg(this,e),this.name=t,this.token=n});function pI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new YC(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=gI();if(!a||a.injector.get(dI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:yE,useValue:"platform"});!function(e){if(oI&&!oI.destroyed&&!oI.injector.get(dI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");oI=e.get(yI);var t=e.get(UT,null);t&&t.forEach(function(e){return e()})}(IE.create({providers:o,name:r}))}return function(e){var t=gI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function gI(){return oI&&!oI.destroyed?oI:null}var yI=function(){var e=function(){function e(t){Zg(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return Wg(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new sI:("zone.js"===e?void 0:e)||new eI({enableLongStackTrace:(hI=!0,fI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:eI,useValue:r}];return r.run(function(){var a=IE.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(p_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){CI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(NT)).runInitializers(),s.donePromise.then(function(){return nP(o.injector.get(GT,QS)||QS),n._moduleDoBootstrap(o),o}));return oS(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=mI({},n);return function(e,t,n){var r=new iT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(kI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(nm(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(IE))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function mI(e,t){return Array.isArray(t)?t.reduce(mI,e):Object.assign(Object.assign({},e),t)}var kI=function(){var e=function(){function e(t,n,r,i,a){var o=this;Zg(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new yy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new yy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){eI.assertNotInAngularZone(),JT(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){eI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t),i=function(e,t){return"number"==typeof Zy(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?Vy(a[0]):Hy(i)(Qy(a,r)):$y}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Cy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return by(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=Jy(d,u))}),g.subscribe(v),t||(t=new ly({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=Jy(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=Jy(h,o),g.complete()}}),Qy(e).subscribe(t))})(e)}}()))}return Wg(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof nO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(GO),a=n.create(IE.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(uI,null),u=s&&a.injector.get(cI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),CI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Gg(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;CI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(BT,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eI),pw(IE),pw(p_),pw(iO),pw(NT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function CI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var wI=Wg(function e(){Zg(this,e)}),_I=Wg(function e(){Zg(this,e)}),bI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},EI=function(){var e=function(){function e(t,n){Zg(this,e),this._compiler=t,this._config=n||bI}return Wg(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Pg(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Tg(8255)(r).then(function(e){return e[i]}).then(function(e){return SI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Pg(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Tg(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return SI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(QT),pw(_I,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function SI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var PI=pI(null,"core",[{provide:VT,useValue:"unknown"},{provide:yI,deps:[IE]},{provide:cI,deps:[]},{provide:zT,deps:[]}]),OI=[{provide:kI,useClass:kI,deps:[eI,IE,p_,iO,NT]},{provide:JO,deps:[eI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:NT,useClass:NT,deps:[[new bw,MT]]},{provide:QT,useClass:QT,deps:[]},LT,{provide:OO,useFactory:function(){return LO},deps:[]},{provide:IO,useFactory:function(){return FO},deps:[]},{provide:GT,useFactory:function(e){return nP(e=e||"undefined"!=typeof $localize&&$localize.locale||QS),e},deps:[[new _w(GT),new bw,new Ew]]},{provide:HT,useValue:"USD"}],TI=function(){var e=Wg(function e(t){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)(pw(kI))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:OI}),e}(),II=null;function AI(){return II}var RI=new YC("DocumentToken"),xI=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:MI,token:e,providedIn:"platform"}),e}();function MI(){return pw(DI)}var NI=new YC("Location Initialized"),DI=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r._init(),r}return Wg(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return AI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=AI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=AI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){LI()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){LI()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(xI);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({factory:FI,token:e,providedIn:"platform"}),e}();function LI(){return!!window.history.pushState}function FI(){return new DI(pw(RI))}function UI(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function VI(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function BI(e){return e&&"?"!==e[0]?"?"+e:e}var zI=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:GI,token:e,providedIn:"root"}),e}();function GI(e){var t=pw(RI).location;return new $I(pw(xI),t&&t.origin||"")}var HI=new YC("appBaseHref"),$I=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,Lg(i)}return Wg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return UI(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+BI(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(zI);return e.\u0275fac=function(t){return new(t||e)(pw(xI),pw(HI,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),ZI=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return Wg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=UI(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(zI);return e.\u0275fac=function(t){return new(t||e)(pw(xI),pw(HI,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qI=function(){var e=function(){function e(t,n){var r=this;Zg(this,e),this._subject=new gT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=VI(jI(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return Wg(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+BI(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,jI(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+BI(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+BI(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(zI),pw(xI))},e.normalizeQueryParams=BI,e.joinWithSlash=UI,e.stripTrailingSlash=VI,e.\u0275prov=dm({factory:WI,token:e,providedIn:"root"}),e}();function WI(){return new qI(pw(zI),pw(xI))}function jI(e){return e.replace(/\/index.html$/,"")}var YI=((YI=YI||{})[YI.Decimal=0]="Decimal",YI[YI.Percent=1]="Percent",YI[YI.Currency=2]="Currency",YI[YI.Scientific=3]="Scientific",YI),KI=((KI=KI||{})[KI.Zero=0]="Zero",KI[KI.One=1]="One",KI[KI.Two=2]="Two",KI[KI.Few=3]="Few",KI[KI.Many=4]="Many",KI[KI.Other=5]="Other",KI),QI=((QI=QI||{})[QI.Format=0]="Format",QI[QI.Standalone=1]="Standalone",QI),XI=((XI=XI||{})[XI.Narrow=0]="Narrow",XI[XI.Abbreviated=1]="Abbreviated",XI[XI.Wide=2]="Wide",XI[XI.Short=3]="Short",XI),JI=((JI=JI||{})[JI.Short=0]="Short",JI[JI.Medium=1]="Medium",JI[JI.Long=2]="Long",JI[JI.Full=3]="Full",JI),eA=((eA=eA||{})[eA.Decimal=0]="Decimal",eA[eA.Group=1]="Group",eA[eA.List=2]="List",eA[eA.PercentSign=3]="PercentSign",eA[eA.PlusSign=4]="PlusSign",eA[eA.MinusSign=5]="MinusSign",eA[eA.Exponential=6]="Exponential",eA[eA.SuperscriptingExponent=7]="SuperscriptingExponent",eA[eA.PerMille=8]="PerMille",eA[eA.Infinity=9]="Infinity",eA[eA.NaN=10]="NaN",eA[eA.TimeSeparator=11]="TimeSeparator",eA[eA.CurrencyDecimal=12]="CurrencyDecimal",eA[eA.CurrencyGroup=13]="CurrencyGroup",eA);function tA(e,t){return sA(qS(e)[YS.DateFormat],t)}function nA(e,t){return sA(qS(e)[YS.TimeFormat],t)}function rA(e,t){return sA(qS(e)[YS.DateTimeFormat],t)}function iA(e,t){var n=qS(e),r=n[YS.NumberSymbols][t];if(void 0===r){if(t===eA.CurrencyDecimal)return n[YS.NumberSymbols][eA.Decimal];if(t===eA.CurrencyGroup)return n[YS.NumberSymbols][eA.Group]}return r}var aA=WS;function oA(e){if(!e[YS.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[YS.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function sA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function uA(e){var t=Pg(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var cA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,lA={},fA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,hA=((hA=hA||{})[hA.Short=0]="Short",hA[hA.ShortGMT=1]="ShortGMT",hA[hA.Long=2]="Long",hA[hA.Extended=3]="Extended",hA),dA=((dA=dA||{})[dA.FullYear=0]="FullYear",dA[dA.Month=1]="Month",dA[dA.Date=2]="Date",dA[dA.Hours=3]="Hours",dA[dA.Minutes=4]="Minutes",dA[dA.Seconds=5]="Seconds",dA[dA.FractionalSeconds=6]="FractionalSeconds",dA[dA.Day=7]="Day",dA),vA=((vA=vA||{})[vA.DayPeriods=0]="DayPeriods",vA[vA.Days=1]="Days",vA[vA.Months=2]="Months",vA[vA.Eras=3]="Eras",vA);function pA(e,t,n,r){var i=function(e){if(TA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=Pg(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return gA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(cA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!TA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=yA(n,t)||t;for(var a,o=[];t;){if(!(a=fA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=OA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(OA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(PA[e])return PA[e];var t;switch(e){case"G":case"GG":case"GGG":t=wA(vA.Eras,XI.Abbreviated);break;case"GGGG":t=wA(vA.Eras,XI.Wide);break;case"GGGGG":t=wA(vA.Eras,XI.Narrow);break;case"y":t=CA(dA.FullYear,1,0,!1,!0);break;case"yy":t=CA(dA.FullYear,2,0,!0,!0);break;case"yyy":t=CA(dA.FullYear,3,0,!1,!0);break;case"yyyy":t=CA(dA.FullYear,4,0,!1,!0);break;case"Y":t=SA(1);break;case"YY":t=SA(2,!0);break;case"YYY":t=SA(3);break;case"YYYY":t=SA(4);break;case"M":case"L":t=CA(dA.Month,1,1);break;case"MM":case"LL":t=CA(dA.Month,2,1);break;case"MMM":t=wA(vA.Months,XI.Abbreviated);break;case"MMMM":t=wA(vA.Months,XI.Wide);break;case"MMMMM":t=wA(vA.Months,XI.Narrow);break;case"LLL":t=wA(vA.Months,XI.Abbreviated,QI.Standalone);break;case"LLLL":t=wA(vA.Months,XI.Wide,QI.Standalone);break;case"LLLLL":t=wA(vA.Months,XI.Narrow,QI.Standalone);break;case"w":t=EA(1);break;case"ww":t=EA(2);break;case"W":t=EA(1,!0);break;case"d":t=CA(dA.Date,1);break;case"dd":t=CA(dA.Date,2);break;case"c":case"cc":t=CA(dA.Day,1);break;case"ccc":t=wA(vA.Days,XI.Abbreviated,QI.Standalone);break;case"cccc":t=wA(vA.Days,XI.Wide,QI.Standalone);break;case"ccccc":t=wA(vA.Days,XI.Narrow,QI.Standalone);break;case"cccccc":t=wA(vA.Days,XI.Short,QI.Standalone);break;case"E":case"EE":case"EEE":t=wA(vA.Days,XI.Abbreviated);break;case"EEEE":t=wA(vA.Days,XI.Wide);break;case"EEEEE":t=wA(vA.Days,XI.Narrow);break;case"EEEEEE":t=wA(vA.Days,XI.Short);break;case"a":case"aa":case"aaa":t=wA(vA.DayPeriods,XI.Abbreviated);break;case"aaaa":t=wA(vA.DayPeriods,XI.Wide);break;case"aaaaa":t=wA(vA.DayPeriods,XI.Narrow);break;case"b":case"bb":case"bbb":t=wA(vA.DayPeriods,XI.Abbreviated,QI.Standalone,!0);break;case"bbbb":t=wA(vA.DayPeriods,XI.Wide,QI.Standalone,!0);break;case"bbbbb":t=wA(vA.DayPeriods,XI.Narrow,QI.Standalone,!0);break;case"B":case"BB":case"BBB":t=wA(vA.DayPeriods,XI.Abbreviated,QI.Format,!0);break;case"BBBB":t=wA(vA.DayPeriods,XI.Wide,QI.Format,!0);break;case"BBBBB":t=wA(vA.DayPeriods,XI.Narrow,QI.Format,!0);break;case"h":t=CA(dA.Hours,1,-12);break;case"hh":t=CA(dA.Hours,2,-12);break;case"H":t=CA(dA.Hours,1);break;case"HH":t=CA(dA.Hours,2);break;case"m":t=CA(dA.Minutes,1);break;case"mm":t=CA(dA.Minutes,2);break;case"s":t=CA(dA.Seconds,1);break;case"ss":t=CA(dA.Seconds,2);break;case"S":t=CA(dA.FractionalSeconds,1);break;case"SS":t=CA(dA.FractionalSeconds,2);break;case"SSS":t=CA(dA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=_A(hA.Short);break;case"ZZZZZ":t=_A(hA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=_A(hA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=_A(hA.Long);break;default:return null}return PA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function gA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function yA(e,t){var n=function(e){return qS(e)[YS.LocaleId]}(e);if(lA[n]=lA[n]||{},lA[n][t])return lA[n][t];var r="";switch(t){case"shortDate":r=tA(e,JI.Short);break;case"mediumDate":r=tA(e,JI.Medium);break;case"longDate":r=tA(e,JI.Long);break;case"fullDate":r=tA(e,JI.Full);break;case"shortTime":r=nA(e,JI.Short);break;case"mediumTime":r=nA(e,JI.Medium);break;case"longTime":r=nA(e,JI.Long);break;case"fullTime":r=nA(e,JI.Full);break;case"short":var i=yA(e,"shortTime"),a=yA(e,"shortDate");r=mA(rA(e,JI.Short),[i,a]);break;case"medium":var o=yA(e,"mediumTime"),s=yA(e,"mediumDate");r=mA(rA(e,JI.Medium),[o,s]);break;case"long":var u=yA(e,"longTime"),c=yA(e,"longDate");r=mA(rA(e,JI.Long),[u,c]);break;case"full":var l=yA(e,"fullTime"),f=yA(e,"fullDate");r=mA(rA(e,JI.Full),[l,f])}return r&&(lA[n][t]=r),r}function mA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function kA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function CA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case dA.FullYear:return t.getFullYear();case dA.Month:return t.getMonth();case dA.Date:return t.getDate();case dA.Hours:return t.getHours();case dA.Minutes:return t.getMinutes();case dA.Seconds:return t.getSeconds();case dA.FractionalSeconds:return t.getMilliseconds();case dA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===dA.Hours)0===s&&-12===n&&(s=12);else if(e===dA.FractionalSeconds)return function(e,t){return kA(e,3).substr(0,t)}(s,t);var u=iA(o,eA.MinusSign);return kA(s,t,u,r,i)}}function wA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:QI.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case vA.Months:return function(e,t,n){var r=qS(e),i=sA([r[YS.MonthsFormat],r[YS.MonthsStandalone]],t);return sA(i,n)}(t,i,r)[e.getMonth()];case vA.Days:return function(e,t,n){var r=qS(e),i=sA([r[YS.DaysFormat],r[YS.DaysStandalone]],t);return sA(i,n)}(t,i,r)[e.getDay()];case vA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=qS(e);return oA(t),(t[YS.ExtraData][2]||[]).map(function(e){return"string"==typeof e?uA(e):[uA(e[0]),uA(e[1])]})}(t),c=function(e,t,n){var r=qS(e);oA(r);var i=sA([r[YS.ExtraData][0],r[YS.ExtraData][1]],t)||[];return sA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Pg(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=qS(e),i=sA([r[YS.DayPeriodsFormat],r[YS.DayPeriodsStandalone]],t);return sA(i,n)}(t,i,r)[o<12?0:1];case vA.Eras:return function(e,t){return sA(qS(e)[YS.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function _A(e){return function(t,n,r){var i=-1*r,a=iA(n,eA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case hA.Short:return(i>=0?"+":"")+kA(o,2,a)+kA(Math.abs(i%60),2,a);case hA.ShortGMT:return"GMT"+(i>=0?"+":"")+kA(o,1,a);case hA.Long:return"GMT"+(i>=0?"+":"")+kA(o,2,a)+":"+kA(Math.abs(i%60),2,a);case hA.Extended:return 0===r?"Z":(i>=0?"+":"")+kA(o,2,a)+":"+kA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function bA(e){return gA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function EA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=bA(n),u=function(e){var t=gA(e,0,1).getDay();return gA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return kA(i,e,iA(r,eA.MinusSign))}}function SA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return kA(bA(n).getFullYear(),e,iA(r,eA.MinusSign),t)}}var PA={};function OA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function TA(e){return e instanceof Date&&!isNaN(e.valueOf())}var IA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function AA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var RA=Wg(function e(){Zg(this,e)}),xA=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).locale=e,r}return Wg(n,[{key:"getPluralCategory",value:function(e,t){switch(aA(t||this.locale)(e)){case KI.Zero:return"zero";case KI.One:return"one";case KI.Two:return"two";case KI.Few:return"few";case KI.Many:return"many";default:return"other"}}}]),n}(RA);return e.\u0275fac=function(t){return new(t||e)(pw(GT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function MA(e,t){t=encodeURIComponent(t);var n,r=Gg(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Pg(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var NA=function(){var e=function(){function e(t,n,r,i){Zg(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return Wg(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(VE(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(nm(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(OO),QE(IO),QE(uO),QE(fO))},e.\u0275dir=Ym({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),DA=function(){function e(t,n,r,i){Zg(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return Wg(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),LA=function(){var e=function(){function e(t,n,r){Zg(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return Wg(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new DA(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new FA(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new FA(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(ZO),QE(VO),QE(OO))},e.\u0275dir=Ym({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),FA=Wg(function e(t,n){Zg(this,e),this.record=t,this.view=n}),UA=function(){var e=function(){function e(t,n){Zg(this,e),this._viewContainer=t,this._context=new VA,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return Wg(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){BA("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){BA("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(ZO),QE(VO))},e.\u0275dir=Ym({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),VA=Wg(function e(){Zg(this,e),this.$implicit=null,this.ngIf=null});function BA(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(nm(t),"'."))}var zA=function(){var e=function(){function e(t){Zg(this,e),this._locale=t}return Wg(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(IA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=AA(v)),null!=p&&(f=AA(p)),null!=g?h=AA(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(iA(n,r)),C.length&&(s+=iA(n,i)+C.join("")),k&&(s+=iA(n,eA.Exponential)+"+"+k)}else s=iA(n,eA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return qS(e)[YS.NumberFormats][t]}(t,YI.Decimal),iA(t,eA.MinusSign)),t,eA.Group,eA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(nm(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(GT,16))},e.\u0275pipe=Km({name:"number",type:e,pure:!0}),e}(),GA=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[{provide:RA,useClass:xA}]}),e}(),HA=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275prov=dm({token:e,providedIn:"root",factory:function(){return new $A(pw(RI),window)}}),e}(),$A=function(){function e(t,n){Zg(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return Wg(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=ZA(this.window.history)||ZA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function ZA(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var qA,WA=Wg(function e(){Zg(this,e)}),jA=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(YA=YA||document.querySelector("base"))?YA.getAttribute("href"):null;return null==t?null:function(e){(qA=qA||document.createElement("a")).setAttribute("href",e);var t=qA.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){YA=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return MA(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,II||(II=e)}}]),n}(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return Wg(n)}(function(){return Wg(function e(){Zg(this,e)})}())),YA=null,KA=new YC("TRANSITION_ID"),QA=[{provide:MT,useFactory:function(e,t,n){return function(){n.get(NT).donePromise.then(function(){for(var n=AI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[KA,RI,IE],multi:!0}],XA=function(){function e(){Zg(this,e)}return Wg(e,[{key:"addToWindow",value:function(e){xm.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},xm.getAllAngularTestabilities=function(){return e.getAllTestabilities()},xm.getAllAngularRootElements=function(){return e.getAllRootElements()},xm.frameworkStabilizers||(xm.frameworkStabilizers=[]),xm.frameworkStabilizers.push(function(e){var t=xm.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?AI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,lI=t}}]),e}(),JA=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),eR=new YC("EventManagerPlugins"),tR=function(){var e=function(){function e(t,n){var r=this;Zg(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return Wg(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eR),pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),nR=function(){function e(t){Zg(this,e),this._doc=t}return Wg(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=AI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),rR=function(){var e=function(){function e(){Zg(this,e),this._stylesSet=new Set}return Wg(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),iR=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return Wg(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(aR),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(aR)})}}]),n}(rR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function aR(e){AI().remove(e)}var oR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},sR=/%COMP%/g;function uR(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?uR(e,i,n):(i=i.replace(sR,e),n.push(i))}return n}function cR(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var lR=function(){var e=function(){function e(t,n,r){Zg(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new fR(t)}return Wg(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Tm.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new hR(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Tm.ShadowDom:return new dR(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=uR(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(tR),pw(iR),pw(DT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),fR=function(){function e(t){Zg(this,e),this.eventManager=t,this.data=Object.create(null)}return Wg(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(oR[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=oR[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=oR[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(w_.DashCase|w_.Important)?e.style.setProperty(t,n,r&w_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&w_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,cR(n)):this.eventManager.addEventListener(e,t,cR(n))}}]),e}(),hR=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;Zg(this,n),(o=t.call(this,e)).component=i;var s=uR(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(sR,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(sR,a+"-"+i.id),o}return Wg(n,[{key:"applyToHost",value:function(e){Rg(Vg(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=Rg(Vg(n.prototype),"createElement",this).call(this,e,t);return Rg(Vg(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(fR),dR=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;Zg(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=uR(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return Wg(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return Rg(Vg(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return Rg(Vg(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return Rg(Vg(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(Rg(Vg(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(fR),vR=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(nR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),pR=["alt","control","meta","shift"],gR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yR={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},mR={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},kR=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return AI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(pR.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&yR.hasOwnProperty(t)&&(t=yR[t]))}return gR[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),pR.forEach(function(r){r!=n&&mR[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(nR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),CR=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:function(){return pw(wR)},token:e,providedIn:"root"}),e}(),wR=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r}return Wg(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case o_.NONE:return t;case o_.HTML:return Nw(t,"HTML")?Mw(t):i_(this._doc,String(t)).toString();case o_.STYLE:return Nw(t,"Style")?Mw(t):t;case o_.SCRIPT:if(Nw(t,"Script"))return Mw(t);throw new Error("unsafe value used in a script context");case o_.URL:return Dw(t),Nw(t,"URL")?Mw(t):zw(String(t));case o_.RESOURCE_URL:if(Nw(t,"ResourceURL"))return Mw(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Tw(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Iw(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new Aw(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Rw(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new xw(e)}(e)}}]),n}(CR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({factory:function(){return function(e){return new wR(e.get(RI))}(pw(pE))},token:e,providedIn:"root"}),e}(),_R=[{provide:VT,useValue:"browser"},{provide:UT,useValue:function(){jA.makeCurrent(),XA.init()},multi:!0},{provide:RI,useFactory:function(){return e=document,vk=e,document;var e},deps:[]}],bR=pI(PI,"browser",_R),ER=[[],{provide:yE,useValue:"root"},{provide:p_,useFactory:function(){return new p_},deps:[]},{provide:eR,useClass:vR,multi:!0,deps:[RI,eI,VT]},{provide:eR,useClass:kR,multi:!0,deps:[RI]},[],{provide:lR,useClass:lR,deps:[tR,iR,DT]},{provide:lO,useExisting:lR},{provide:rR,useExisting:iR},{provide:iR,useClass:iR,deps:[RI]},{provide:uI,useClass:uI,deps:[eI]},{provide:tR,useClass:tR,deps:[eR,eI]},{provide:WA,useClass:JA,deps:[]},[]],SR=function(){var e=function(){function e(t){if(Zg(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return Wg(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:DT,useValue:t.appId},{provide:KA,useExisting:DT},QA]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(e,12))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:ER,imports:[GA,TI]}),e}();"undefined"!=typeof window&&window;var PR=Array.isArray,OR=Object.getPrototypeOf,TR=Object.prototype,IR=Object.keys;function AR(e){if(1===e.length){var t=e[0];if(PR(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&OR(e)===TR}(t)){var n=IR(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var RR=Array.isArray;function xR(e){return Sy(function(t){return function(e,t){return RR(t)?e.apply(void 0,Bg(t)):e(t)}(e,t)})}function MR(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var NR=function(){var e=function(){function e(t,n){Zg(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return Wg(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(fO),QE(uO))},e.\u0275dir=Ym({type:e}),e}(),DR=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(NR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,features:[RE]}),t}(),LR=new YC("NgValueAccessor"),FR={provide:LR,useExisting:am(function(){return VR}),multi:!0},UR=new YC("CompositionEventMode"),VR=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=AI()?AI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return Wg(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(NR);return e.\u0275fac=function(t){return new(t||e)(QE(fO),QE(uO),QE(UR,8))},e.\u0275dir=Ym({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&uS("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[tO([FR]),RE]}),e}();function BR(e){return null==e||0===e.length}function zR(e){return null!=e&&"number"==typeof e.length}var GR=new YC("NgValidators"),HR=new YC("NgAsyncValidators"),$R=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ZR=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"min",value:function(e){return t=e,function(e){if(BR(e.value)||BR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(BR(e.value)||BR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return qR(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return BR((t=e).value)||$R.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return BR(e.value)||!zR(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return WR(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(BR(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):jR;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return ex(e)}},{key:"composeAsync",value:function(e){return nx(e)}}]),e}();function qR(e){return BR(e.value)?{required:!0}:null}function WR(e){return function(t){return zR(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function jR(e){return null}function YR(e){return null!=e}function KR(e){var t=oS(e)?Qy(e):e;return sS(t),t}function QR(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function XR(e,t){return t.map(function(t){return t(e)})}function JR(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function ex(e){if(!e)return null;var t=e.filter(YR);return 0==t.length?null:function(e){return QR(XR(e,t))}}function tx(e){return null!=e?ex(JR(e)):null}function nx(e){if(!e)return null;var t=e.filter(YR);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=qy(t),i=AR(t),a=i.args,o=i.keys,s=new yy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;Vy(a[t]).subscribe(new Ey(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?MR(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(xR(r)):s}(XR(e,t).map(KR)).pipe(Sy(QR))}}function rx(e){return null!=e?nx(JR(e)):null}function ix(e,t){return null===e?[t]:Array.isArray(e)?[].concat(Bg(e),[t]):[e,t]}function ax(e){return e._rawValidators}function ox(e){return e._rawAsyncValidators}function sx(e){return e?Array.isArray(e)?e:[e]:[]}function ux(e,t){return Array.isArray(e)?e.includes(t):e===t}function cx(e,t){var n=sx(t);return sx(e).forEach(function(e){ux(n,e)||n.push(e)}),n}function lx(e,t){return sx(t).filter(function(t){return!ux(e,t)})}var fx=function(){var e=function(){function e(){Zg(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return Wg(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=tx(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=rx(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e}),e}(),hx=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(fx);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,features:[RE]}),t}(),dx=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return Wg(n)}(fx),vx=function(){function e(t){Zg(this,e),this._cd=t}return Wg(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),px=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n)}(vx);return e.\u0275fac=function(t){return new(t||e)(QE(dx,2))},e.\u0275dir=Ym({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&SS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[RE]}),e}(),gx=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n)}(vx);return e.\u0275fac=function(t){return new(t||e)(QE(hx,10))},e.\u0275dir=Ym({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&SS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[RE]}),e}();function yx(e,t){return[].concat(Bg(t.path),[e])}function mx(e,t){wx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&bx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&bx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function kx(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),_x(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function Cx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function wx(e,t){var n=ax(e);null!==t.validator?e.setValidators(ix(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=ox(e);null!==t.asyncValidator?e.setAsyncValidators(ix(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};Cx(t._rawValidators,i),Cx(t._rawAsyncValidators,i)}function _x(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=ax(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=ox(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return Cx(t._rawValidators,s),Cx(t._rawAsyncValidators,s),n}function bx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Ex(e,t){wx(e,t)}function Sx(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Px(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Ox(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===VR?n=e:function(e){return Object.getPrototypeOf(e.constructor)===DR}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Tx(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Ix="VALID",Ax="INVALID",Rx="PENDING",xx="DISABLED";function Mx(e){return(Fx(e)?e.validators:e)||null}function Nx(e){return Array.isArray(e)?tx(e):e||null}function Dx(e,t){return(Fx(t)?t.asyncValidators:e)||null}function Lx(e){return Array.isArray(e)?rx(e):e||null}function Fx(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Ux=function(){function e(t,n){Zg(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=Nx(this._rawValidators),this._composedAsyncValidatorFn=Lx(this._rawAsyncValidators)}return Wg(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Ix}},{key:"invalid",get:function(){return this.status===Ax}},{key:"pending",get:function(){return this.status==Rx}},{key:"disabled",get:function(){return this.status===xx}},{key:"enabled",get:function(){return this.status!==xx}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=Nx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Lx(e)}},{key:"addValidators",value:function(e){this.setValidators(cx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(cx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(lx(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(lx(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return ux(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return ux(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=Rx,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=xx,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Ix,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ix||this.status===Rx)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?xx:Ix}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=Rx,this._hasOwnPendingAsyncValidator=!0;var n=KR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof Bx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof zx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new gT,this.statusChanges=new gT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?xx:this.errors?Ax:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Rx)?Rx:this._anyControlsHaveStatus(Ax)?Ax:Ix}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Fx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Vx=function(e){Mg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return Zg(this,n),(e=t.call(this,Mx(i),Dx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return Wg(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Tx(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Tx(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Ux),Bx=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,Mx(r),Dx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Wg(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Vx?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Ux),zx=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,Mx(r),Dx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Wg(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Vx?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Gg(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Ux),Gx={provide:hx,useExisting:am(function(){return $x})},Hx=Promise.resolve(null),$x=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new gT,i.form=new Bx({},tx(e),rx(r)),i}return Wg(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;Hx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),mx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Hx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Tx(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;Hx.then(function(){var n=t._findContainer(e.path),r=new Bx({});Ex(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;Hx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Hx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Px(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(hx);return e.\u0275fac=function(t){return new(t||e)(QE(GR,10),QE(HR,10))},e.\u0275dir=Ym({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&uS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[tO([Gx]),RE]}),e}(),Zx={provide:dx,useExisting:am(function(){return Wx})},qx=Promise.resolve(null),Wx=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).control=new Vx,o._registered=!1,o.update=new gT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=Ox(0,a),o}return Wg(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Sx(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?yx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){mx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;qx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;qx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(QE(hx,9),QE(GR,10),QE(HR,10),QE(LR,10))},e.\u0275dir=Ym({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[tO([Zx]),RE,uk]}),e}(),jx=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),Yx=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}(),Kx={provide:LR,useExisting:am(function(){return Qx}),multi:!0},Qx=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&uS("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[tO([Kx]),RE]}),t}(),Xx=new YC("NgModelWithFormControlWarning"),Jx={provide:hx,useExisting:am(function(){return eM})},eM=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new gT,i._setValidators(e),i._setAsyncValidators(r),i}return Wg(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(_x(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return mx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){kx(e.control||null,e,!1),Tx(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Px(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(kx(n||null,t),r instanceof Vx&&(mx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);Ex(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return _x(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){wx(this.form,this),this._oldForm&&_x(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(hx);return e.\u0275fac=function(t){return new(t||e)(QE(GR,10),QE(HR,10))},e.\u0275dir=Ym({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&uS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[tO([Jx]),RE,uk]}),e}(),tM={provide:dx,useExisting:am(function(){return nM})},nM=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new gT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=Ox(0,a),s}return Wg(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),Sx(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return yx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(QE(hx,13),QE(GR,10),QE(HR,10),QE(LR,10),QE(Xx,8))},e.\u0275dir=Ym({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[tO([tM]),RE,uk]}),e._ngModelWarningSentOnce=!1,e}(),rM={provide:LR,useExisting:am(function(){return aM}),multi:!0};function iM(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var aM=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Wg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=iM(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&uS("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tO([rM]),RE]}),t}(),oM=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return Wg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(iM(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(uO),QE(fO),QE(aM,9))},e.\u0275dir=Ym({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),sM={provide:LR,useExisting:am(function(){return cM}),multi:!0};function uM(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var cM=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Wg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&uS("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tO([sM]),RE]}),t}(),lM=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return Wg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(uM(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(uM(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(uO),QE(fO),QE(cM,9))},e.\u0275dir=Ym({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),fM={provide:GR,useExisting:am(function(){return hM}),multi:!0},hM=function(){var e=function(){function e(){Zg(this,e),this._required=!1}return Wg(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?qR(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&$E("required",t.required?"":null)},inputs:{required:"required"},features:[tO([fM])]}),e}(),dM={provide:GR,useExisting:am(function(){return vM}),multi:!0},vM=function(){var e=function(){function e(){Zg(this,e),this._validator=jR}return Wg(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?WR(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):jR}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&$E("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[tO([dM]),uk]}),e}(),pM=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[[Yx]]}),e}(),gM=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[pM]}),e}(),yM=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Xx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[pM]}),e}(),mM=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new Bx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Vx(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new zx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Vx||e instanceof Bx||e instanceof zx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:function(){return new e},token:e,providedIn:yM}),e}();function kM(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qy(t,Wy(t))}function CM(e,t){return Ug(t)?Gy(e,t,1):Gy(e,1)}function wM(e,t){return by(function(n,r){var i=0;n.subscribe(new Ey(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var _M=Wg(function e(){Zg(this,e)}),bM=Wg(function e(){Zg(this,e)}),EM=function(){function e(t){var n=this;Zg(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return Wg(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,Bg(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),SM=function(){function e(){Zg(this,e)}return Wg(e,[{key:"encodeKey",value:function(e){return TM(e)}},{key:"encodeValue",value:function(e){return TM(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),PM=/%(\d[a-f0-9])/gi,OM={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function TM(e){return encodeURIComponent(e).replace(PM,function(e,t){var n;return null!==(n=OM[t])&&void 0!==n?n:e})}function IM(e){return"".concat(e)}var AM=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Zg(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new SM,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Pg(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return Wg(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(IM(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(IM(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),RM=function(){function e(){Zg(this,e),this.map=new Map}return Wg(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function xM(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function MM(e){return"undefined"!=typeof Blob&&e instanceof Blob}function NM(e){return"undefined"!=typeof FormData&&e instanceof FormData}var DM=function(){function e(t,n,r,i){var a;if(Zg(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new EM),this.context||(this.context=new RM),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new AM,this.urlWithParams=n}return Wg(e,[{key:"serializeBody",value:function(){return null===this.body?null:xM(this.body)||MM(this.body)||NM(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof AM?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||NM(this.body)?null:MM(this.body)?this.body.type||null:xM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof AM?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),LM=((LM=LM||{})[LM.Sent=0]="Sent",LM[LM.UploadProgress=1]="UploadProgress",LM[LM.ResponseHeader=2]="ResponseHeader",LM[LM.DownloadProgress=3]="DownloadProgress",LM[LM.Response=4]="Response",LM[LM.User=5]="User",LM),FM=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";Zg(this,e),this.headers=t.headers||new EM,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),UM=function(e){Mg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Zg(this,n),(e=t.call(this,r)).type=LM.ResponseHeader,e}return Wg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(FM),VM=function(e){Mg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Zg(this,n),(e=t.call(this,r)).type=LM.Response,e.body=void 0!==r.body?r.body:null,e}return Wg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(FM),BM=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return Wg(n)}(FM);function zM(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var GM=function(){var e=function(){function e(t){Zg(this,e),this.handler=t}return Wg(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof DM?n=e:(r=o.headers instanceof EM?o.headers:new EM(o.headers),o.params&&(i=o.params instanceof AM?o.params:new AM({fromObject:o.params})),n=new DM(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=kM(n).pipe(CM(function(e){return a.handler.handle(e)}));if(e instanceof DM||"events"===o.observe)return s;var u=s.pipe(wM(function(e){return e instanceof VM}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Sy(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Sy(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Sy(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(Sy(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new AM).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,zM(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,zM(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,zM(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(_M))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),HM=function(){function e(t,n){Zg(this,e),this.next=t,this.interceptor=n}return Wg(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),$M=new YC("HTTP_INTERCEPTORS"),ZM=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qM=/^\)\]\}',?\n/,WM=function(){var e=function(){function e(t){Zg(this,e),this.xhrFactory=t}return Wg(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new yy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new EM(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new UM({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(qM,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new VM({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new BM({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new BM({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:LM.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:LM.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:LM.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(WA))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),jM=new YC("XSRF_COOKIE_NAME"),YM=new YC("XSRF_HEADER_NAME"),KM=Wg(function e(){Zg(this,e)}),QM=function(){var e=function(){function e(t,n,r){Zg(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return Wg(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=MA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(VT),pw(jM))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),XM=function(){var e=function(){function e(t,n){Zg(this,e),this.tokenService=t,this.headerName=n}return Wg(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(KM),pw(YM))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),JM=function(){var e=function(){function e(t,n){Zg(this,e),this.backend=t,this.injector=n,this.chain=null}return Wg(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get($M,[]);this.chain=t.reduceRight(function(e,t){return new HM(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(bM),pw(IE))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),eN=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:XM,useClass:ZM}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:jM,useValue:t.cookieName}:[],t.headerName?{provide:YM,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[XM,{provide:$M,useExisting:XM,multi:!0},{provide:KM,useClass:QM},{provide:jM,useValue:"XSRF-TOKEN"},{provide:YM,useValue:"X-XSRF-TOKEN"}]}),e}(),tN=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[GM,{provide:_M,useClass:JM},WM,{provide:bM,useExisting:WM}],imports:[[eN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),nN=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._value=e,r}return Wg(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=Rg(Vg(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){Rg(Vg(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Cy);function rN(e,t,n){e?zy(n,e,t):t()}var iN=zg(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function aN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Hy(1)(Qy(t,Wy(t)))}function oN(e){return new yy(function(t){Vy(e()).subscribe(t)})}function sN(){return by(function(e,t){var n=null;e._refCount++;var r=new Ey(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var uN=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,_y(e)&&(i.lift=e.lift),i}return Wg(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new qg;var n=this.getSubject();t.add(this.source.subscribe(new Ey(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=qg.EMPTY)}return t}},{key:"refCount",value:function(){return sN()(this)}}]),n}(yy);function cN(e,t){return by(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Ey(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;Vy(e(n,u)).subscribe(i=new Ey(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function lN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Ey(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function fN(e,t){return by(lN(e,t,arguments.length>=2,!0))}function hN(e){return by(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Ey(n,void 0,void 0,function(o){r=Vy(e(o,hN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function dN(e){return e<=0?function(){return $y}:by(function(t,n){var r=[];t.subscribe(new Ey(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Gg(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function vN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pN;return by(function(t,n){var r=!1;t.subscribe(new Ey(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function pN(){return new iN}function gN(e){return by(function(t,n){var r=!1;t.subscribe(new Ey(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function yN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wM(function(t,n){return e(t,n,r)}):gy,Xy(1),n?gN(t):vN(function(){return new iN}))}}function mN(e,t,n){var r=Ug(e)||t||n?{next:e,error:t,complete:n}:e;return r?by(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Ey(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):gy}var kN=Wg(function e(t,n){Zg(this,e),this.id=t,this.url=n}),CN=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zg(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return Wg(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kN),wN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(kN),_N=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).reason=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kN),bN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).error=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(kN),EN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),SN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),PN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return Wg(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(kN),ON=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),TN=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),IN=function(){function e(t){Zg(this,e),this.route=t}return Wg(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),AN=function(){function e(t){Zg(this,e),this.route=t}return Wg(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),RN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),xN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),MN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),NN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),DN=function(){function e(t,n,r){Zg(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return Wg(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),LN="primary",FN=function(){function e(t){Zg(this,e),this.params=t||{}}return Wg(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function UN(e){return new FN(e)}var VN="ngNavigationCancelingError";function BN(e){var t=Error("NavigationCancelingError: "+e);return t[VN]=!0,t}function zN(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function GN(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!HN(e[n=r[a]],t[n]))return!1;return!0}function HN(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=Bg(e).sort(),r=Bg(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function $N(e){return Array.prototype.concat.apply([],e)}function ZN(e){return e.length>0?e[e.length-1]:null}function qN(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function WN(e){return sS(e)?e:oS(e)?Qy(Promise.resolve(e)):kM(e)}var jN={exact:function e(t,n,r){if(!rD(t.segments,n.segments)||!JN(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:QN},YN={exact:function(e,t){return GN(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return HN(e[n],t[n])})},ignored:function(){return!0}};function KN(e,t,n){return jN[n.paths](e.root,t.root,n.matrixParams)&&YN[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function QN(e,t,n){return XN(e,t,t.segments,n)}function XN(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!rD(i,n)||t.hasChildren()||!JN(i,n,r))}if(e.segments.length===n.length){if(!rD(e.segments,n)||!JN(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!QN(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(rD(e.segments,o)&&JN(e.segments,o,r)&&e.children[LN])&&XN(e.children[LN],t,s,r)}function JN(e,t,n){return t.every(function(t,r){return YN[n](e[r].parameters,t.parameters)})}var eD=function(){function e(t,n,r){Zg(this,e),this.root=t,this.queryParams=n,this.fragment=r}return Wg(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=UN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return oD.serialize(this)}}]),e}(),tD=function(){function e(t,n){var r=this;Zg(this,e),this.segments=t,this.children=n,this.parent=null,qN(n,function(e,t){return e.parent=r})}return Wg(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return sD(this)}}]),e}(),nD=function(){function e(t,n){Zg(this,e),this.path=t,this.parameters=n}return Wg(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=UN(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return vD(this)}}]),e}();function rD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var iD=Wg(function e(){Zg(this,e)}),aD=function(){function e(){Zg(this,e)}return Wg(e,[{key:"parse",value:function(e){var t=new kD(e);return new eD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(uD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(lD(t),"=").concat(lD(e))}).join("&"):"".concat(lD(t),"=").concat(lD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),oD=new aD;function sD(e){return e.segments.map(function(e){return vD(e)}).join("/")}function uD(e,t){if(!e.hasChildren())return sD(e);if(t){var n=e.children[LN]?uD(e.children[LN],!1):"",r=[];return qN(e.children,function(e,t){t!==LN&&r.push("".concat(t,":").concat(uD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return qN(e.children,function(e,r){r===LN&&(n=n.concat(t(e,r)))}),qN(e.children,function(e,r){r!==LN&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===LN?[uD(e.children[LN],!1)]:["".concat(n,":").concat(uD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[LN]?"".concat(sD(e),"/").concat(i[0]):"".concat(sD(e),"/(").concat(i.join("//"),")")}function cD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lD(e){return cD(e).replace(/%3B/gi,";")}function fD(e){return cD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hD(e){return decodeURIComponent(e)}function dD(e){return hD(e.replace(/\+/g,"%20"))}function vD(e){return"".concat(fD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(fD(t),"=").concat(fD(e[t]))}).join("")}(e.parameters))}var pD=/^[^\/()?;=#]+/;function gD(e){var t=e.match(pD);return t?t[0]:""}var yD=/^[^=?&#]+/,mD=/^[^?&#]+/,kD=function(){function e(t){Zg(this,e),this.url=t,this.remaining=t}return Wg(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tD([],{}):new tD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[LN]=new tD(e,t)),n}},{key:"parseSegment",value:function(){var e=gD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new nD(hD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=gD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=gD(this.remaining);r&&(n=r,this.capture(n))}e[hD(t)]=hD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(yD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(mD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=dD(t),a=dD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=gD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=LN);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[LN]:new tD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),CD=function(){function e(t){Zg(this,e),this._root=t}return Wg(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=wD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=wD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=_D(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return _D(e,this._root).map(function(e){return e.value})}}]),e}();function wD(e,t){if(e===t.value)return t;var n,r=Gg(t.children);try{for(r.s();!(n=r.n()).done;){var i=wD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function _D(e,t){if(e===t.value)return[t];var n,r=Gg(t.children);try{for(r.s();!(n=r.n()).done;){var i=_D(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var bD=function(){function e(t,n){Zg(this,e),this.value=t,this.children=n}return Wg(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function ED(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var SD=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).snapshot=r,RD(Fg(i),e),i}return Wg(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(CD);function PD(e,t){var n=function(e,t){var n=new ID([],{},{},"",{},LN,t,null,e.root,-1,{});return new AD("",new bD(n,[]))}(e,t),r=new nN([new nD("",{})]),i=new nN({}),a=new nN({}),o=new nN({}),s=new nN(""),u=new OD(r,i,o,s,a,LN,t,n.root);return u.snapshot=n.root,new SD(new bD(u,[]),n)}var OD=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return Wg(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Sy(function(e){return UN(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Sy(function(e){return UN(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function TD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var ID=function(){function e(t,n,r,i,a,o,s,u,c,l,f){Zg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return Wg(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=UN(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=UN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),AD=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).url=e,RD(Fg(i),r),i}return Wg(n,[{key:"toString",value:function(){return xD(this._root)}}]),n}(CD);function RD(e,t){t.value._routerState=e,t.children.forEach(function(t){return RD(e,t)})}function xD(e){var t=e.children.length>0?" { ".concat(e.children.map(xD).join(", ")," } "):"";return"".concat(e.value).concat(t)}function MD(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,GN(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),GN(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!GN(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),GN(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function ND(e,t){var n=GN(e.params,t.params)&&function(e,t){return rD(e,t)&&e.every(function(e,n){return GN(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||ND(e.parent,t.parent))}function DD(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Gg(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return DD(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return DD(e,t)})}(e,t,n);return new bD(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return LD(t,o),o}}var s=function(e){return new OD(new nN(e.url),new nN(e.params),new nN(e.queryParams),new nN(e.fragment),new nN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return DD(e,t)});return new bD(s,u)}function LD(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)LD(e.children[n],t.children[n])}function FD(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function UD(e){return"object"==typeof e&&null!=e&&e.outlets}function VD(e,t,n,r,i){var a={};return r&&qN(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new eD(n.root===e?t:BD(n.root,e,t),a,i)}function BD(e,t,n){var r={};return qN(e.children,function(e,i){r[i]=e===t?n:BD(e,t,n)}),new tD(e.segments,r)}var zD=function(){function e(t,n,r){if(Zg(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&FD(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(UD);if(i&&i!==ZN(r))throw new Error("{outlets:{}} has to be the last command")}return Wg(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),GD=Wg(function e(t,n,r){Zg(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function HD(e,t,n){if(e||(e=new tD([],{})),0===e.segments.length&&e.hasChildren())return $D(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(UD(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!jD(u,c,o))return a;r+=2}else{if(!jD(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new tD(e.segments.slice(0,r.pathIndex),{});return a.children[LN]=new tD(e.segments.slice(r.pathIndex),e.children),$D(a,0,i)}return r.match&&0===i.length?new tD(e.segments,{}):r.match&&!e.hasChildren()?ZD(e,t,n):r.match?$D(e,0,i):ZD(e,t,n)}function $D(e,t,n){if(0===n.length)return new tD(e.segments,{});var r=function(e){return UD(e[0])?e[0].outlets:Sg({},LN,e)}(n),i={};return qN(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=HD(e.children[r],t,n))}),qN(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new tD(e.segments,i)}function ZD(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(UD(a)){var o=qD(a.outlets);return new tD(r,o)}if(0===i&&FD(n[0]))r.push(new nD(e.segments[t].path,WD(n[0]))),i++;else{var s=UD(a)?a.outlets[LN]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&FD(u)?(r.push(new nD(s,WD(u))),i+=2):(r.push(new nD(s,{})),i++)}}return new tD(r,{})}function qD(e){var t={};return qN(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=ZD(new tD([],{}),0,e))}),t}function WD(e){var t={};return qN(e,function(e,n){return t[n]="".concat(e)}),t}function jD(e,t,n){return e==n.path&&GN(t,n.parameters)}var YD=function(){function e(t,n,r,i){Zg(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return Wg(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),MD(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=ED(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),qN(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=ED(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=ED(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new NN(e.value.snapshot))}),e.children.length&&this.forwardEvent(new xN(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(MD(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),KD(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function KD(e){MD(e.value),e.children.forEach(KD)}var QD=Wg(function e(t,n){Zg(this,e),this.routes=t,this.module=n});function XD(e){return"function"==typeof e}function JD(e){return e instanceof eD}var eL=Symbol("INITIAL_VALUE");function tL(){return cN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t),i=qy(t),a=AR(t),o=a.args,s=a.keys;if(0===o.length)return Qy([],r);var u=new yy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gy;return function(r){rN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){rN(t,function(){var u=Qy(e[i],t),c=!1;u.subscribe(new Ey(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return MR(s,e)}:gy));return i?u.pipe(xR(i)):u}(e.map(function(e){return e.pipe(Xy(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t);return by(function(e,n){(r?aN(t,e,r):aN(t,e)).subscribe(n)})}(eL))})).pipe(fN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==eL?e:(r===eL&&(n=!0),n||!1!==r&&i!==t.length-1&&!JD(r)?e:r)},e)},eL),wM(function(e){return e!==eL}),Sy(function(e){return JD(e)?e:!0===e}),Xy(1))})}var nL=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Hm({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&nS(0,"router-outlet")},directives:function(){return[JL]},encapsulation:2}),e}();function rL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];iL(r,aL(t,r))}}function iL(e,t){e.children&&rL(e.children,t)}function aL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function oL(e){var t=e.children&&e.children.map(oL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==LN&&(n.component=nL),n}function sL(e){return e.outlet||LN}function uL(e,t){var n=e.filter(function(e){return sL(e)===t});return n.push.apply(n,Bg(e.filter(function(e){return sL(e)!==t}))),n}var cL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function lL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},cL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||zN)(n,e,t);if(!i)return Object.assign({},cL);var a={};qN(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function fL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return hL(e,t,n)&&sL(n)!==LN})}(e,n,r)){var a=new tD(t,function(e,t,n,r){var i={};i[LN]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Gg(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&sL(s)!==LN){var u=new tD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[sL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new tD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return hL(e,t,n)})}(e,n,r)){var o=new tD(e.segments,function(e,t,n,r,i,a){var o,s={},u=Gg(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(hL(e,n,c)&&!i[sL(c)]){var l=new tD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[sL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new tD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function hL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function dL(e,t,n,r){return!!(sL(e)===r||r!==LN&&hL(t,n,e))&&("**"===e.path||lL(t,e,n).matched)}function vL(e,t,n){return 0===t.length&&!e.children[n]}var pL=Wg(function e(t){Zg(this,e),this.segmentGroup=t||null}),gL=Wg(function e(t){Zg(this,e),this.urlTree=t});function yL(e){return new yy(function(t){return t.error(new pL(e))})}function mL(e){return new yy(function(t){return t.error(new gL(e))})}function kL(e){return new yy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var CL=function(){function e(t,n,r,i,a){Zg(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(GO)}return Wg(e,[{key:"apply",value:function(){var e=this,t=fL(this.urlTree.root,[],[],this.config).segmentGroup,n=new tD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,LN).pipe(Sy(function(t){return e.createUrlTree(wL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(hN(function(t){if(t instanceof gL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof pL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,LN).pipe(Sy(function(n){return t.createUrlTree(wL(n),e.queryParams,e.fragment)})).pipe(hN(function(e){throw e instanceof pL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new tD([],Sg({},LN,e)):e;return new eD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Sy(function(e){return new tD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return Qy(i).pipe(CM(function(i){var a=n.children[i],o=uL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Sy(function(e){return{segment:e,outlet:i}}))}),fN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wM(function(t,n){return e(t,n,r)}):gy,dN(1),n?gN(t):vN(function(){return new iN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return Qy(n).pipe(CM(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(hN(function(e){if(e instanceof pL)return kM(null);throw e}))}),yN(function(e){return!!e}),hN(function(e,n){if(e instanceof iN||"EmptyError"===e.name){if(vL(t,r,i))return kM(new tD([],{}));throw new pL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return dL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):yL(t):yL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?mL(a):this.lineralizeSegments(n,a).pipe(Gy(function(n){var a=new tD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=lL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return yL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?mL(h):this.lineralizeSegments(r,h).pipe(Gy(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?kM(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Sy(function(e){return n._loadedConfig=e,new tD(r,{})})):kM(new tD(r,{}));var o=lL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return yL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Gy(function(e){var r=e.module,o=e.routes,s=fL(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new tD(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(Sy(function(e){return new tD(u,e)}));if(0===o.length&&0===f.length)return kM(new tD(u,{}));var d=sL(n)===i;return a.expandSegment(r,h,o,f,d?LN:i,!0).pipe(Sy(function(e){return new tD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?kM(new QD(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?kM(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Gy(function(n){return n?r.configLoader.load(e.injector,t).pipe(Sy(function(e){return t._loadedConfig=e,e})):(i=t,new yy(function(e){return e.error(BN("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):kM(new QD([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?kM(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&XD(a.canLoad))i=o.canLoad(t,n);else{if(!XD(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return WN(i)})).pipe(tL(),mN(function(e){if(JD(e)){var t=BN('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Sy(function(e){return!0===e})):kM(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return kM(n);if(r.numberOfChildren>1||!r.children[LN])return kL(e.redirectTo);r=r.children[LN]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new eD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return qN(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return qN(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new tD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function wL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=wL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[LN]){var t=e.children[LN];return new tD(e.segments.concat(t.segments),t.children)}return e}(new tD(e.segments,t))}var _L=Wg(function e(t){Zg(this,e),this.path=t,this.route=this.path[this.path.length-1]}),bL=Wg(function e(t,n){Zg(this,e),this.component=t,this.route=n});function EL(e,t,n){var r=e._root;return PL(r,t?t._root:null,n,[r.value])}function SL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function PL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=ED(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!rD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!rD(e.url,t.url)||!GN(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ND(e,t)||!GN(e.queryParams,t.queryParams);default:return!ND(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new _L(r)):(a.data=o.data,a._resolvedData=o._resolvedData),PL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new bL(s.outlet.component,o))}else o&&OL(t,s,i),i.canActivateChecks.push(new _L(r)),PL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),qN(a,function(e,t){return OL(e,n.getContext(t),i)}),i}function OL(e,t,n){var r=ED(e),i=e.value;qN(r,function(e,r){OL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new bL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var TL=Wg(function e(){Zg(this,e)});function IL(e){return new yy(function(t){return t.error(e)})}var AL=function(){function e(t,n,r,i,a,o){Zg(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return Wg(e,[{key:"recognize",value:function(){var e=fL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,LN);if(null===t)return null;var n=new ID([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},LN,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new bD(n,t),i=new AD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=TD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=uL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,Bg(u))}var c=RL(n);return c.sort(function(e,t){return e.value.outlet===LN?-1:t.value.outlet===LN?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return vL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!dL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?ZN(n).parameters:{};i=new ID(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,NL(e),sL(e),e.component,e,xL(t),ML(t)+n.length,DL(e))}else{var u=lL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new ID(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,NL(e),sL(e),e.component,e,xL(t),ML(t)+a.length,DL(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=fL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new bD(i,v)]}if(0===l.length&&0===d.length)return[new bD(i,[])];var p=sL(e)===r,g=this.processSegment(l,h,d,p?LN:r);return null===g?null:[new bD(i,g)]}}]),e}();function RL(e){var t,n=[],r=new Set,i=Gg(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,Bg(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Gg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=RL(u.children);n.push(new bD(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function xL(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function ML(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function NL(e){return e.data||{}}function DL(e){return e.resolve||{}}function LL(e){return cN(function(t){var n=e(t);return n?Qy(n).pipe(Sy(function(){return t})):kM(t)})}var FL=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),UL=new YC("ROUTES"),VL=function(){function e(t,n,r,i){Zg(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return Wg(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Sy(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new QD($N(i.injector.get(UL,void 0,bm.Self|bm.Optional)).map(oL),i)}),hN(function(e){throw t._loader$=void 0,e}));return t._loader$=new uN(r,function(){return new Cy}).pipe(sN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Qy(this.loader.load(e)):WN(e()).pipe(Gy(function(e){return e instanceof HO?kM(e):Qy(t.compiler.compileModuleAsync(e))}))}}]),e}(),BL=Wg(function e(){Zg(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new zL,this.attachRef=null}),zL=function(){function e(){Zg(this,e),this.contexts=new Map}return Wg(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new BL,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),GL=function(){function e(){Zg(this,e)}return Wg(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function HL(e){throw e}function $L(e,t,n){return t.parse("/")}function ZL(e,t){return kM(null)}var qL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},jL=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;Zg(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Cy,this.errorHandler=HL,this.malformedUriErrorHandler=$L,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:ZL,afterPreactivation:ZL},this.urlHandlingStrategy=new GL,this.routeReuseStrategy=new FL,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(GO),this.console=a.get(zT);var l=a.get(eI);this.isNgZoneEnabled=l instanceof eI&&eI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new eD(new tD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new VL(o,s,function(e){return c.triggerEvent(new IN(e))},function(e){return c.triggerEvent(new AN(e))}),this.routerState=PD(this.currentUrlTree,this.rootComponentType),this.transitions=new nN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return Wg(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(wM(function(e){return 0!==e.id}),Sy(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),cN(function(e){var r=!1,i=!1;return kM(e).pipe(mN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),cN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return YL(e.source)&&(t.browserUrlTree=e.extractedUrl),kM(e).pipe(cN(function(e){var r=t.transitions.getValue();return n.next(new CN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?$y:Promise.resolve(e)}),function(e,t,n,r){return cN(function(i){return function(e,t,n,r,i){return new CL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Sy(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),mN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return Gy(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new AL(e,t,n,r,a,o).recognize();return null===s?IL(new TL):kM(s)}catch(i){return IL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Sy(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),mN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new EN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new CN(o,t.serializeUrl(s),u,c);n.next(f);var h=PD(s,t.rootComponentType).snapshot;return kM(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),$y}),LL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),mN(function(e){var n=new SN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Sy(function(e){return Object.assign(Object.assign({},e),{guards:EL(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Gy(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?kM(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Qy(e).pipe(Gy(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?kM(a.map(function(a){var o,s=SL(a,t,i);if(function(e){return e&&XD(e.canDeactivate)}(s))o=WN(s.canDeactivate(e,t,n,r));else{if(!XD(s))throw new Error("Invalid CanDeactivate guard");o=WN(s(e,t,n,r))}return o.pipe(yN())})).pipe(tL()):kM(!0)}(e.component,e.route,n,t,r)}),yN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Gy(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return Qy(t).pipe(CM(function(t){return aN(function(e,t){return null!==e&&t&&t(new RN(e)),kM(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new MN(e)),kM(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return oN(function(){return kM(t.guards.map(function(i){var a,o=SL(i,t.node,n);if(function(e){return e&&XD(e.canActivateChild)}(o))a=WN(o.canActivateChild(r,e));else{if(!XD(o))throw new Error("Invalid CanActivateChild guard");a=WN(o(r,e))}return a.pipe(yN())})).pipe(tL())})});return kM(i).pipe(tL())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return kM(!0);var i=r.map(function(r){return oN(function(){var i,a=SL(r,t,n);if(function(e){return e&&XD(e.canActivate)}(a))i=WN(a.canActivate(t,e));else{if(!XD(a))throw new Error("Invalid CanActivate guard");i=WN(a(t,e))}return i.pipe(yN())})});return kM(i).pipe(tL())}(e,t.route,n))}),yN(function(e){return!0!==e},!0))}(r,o,e,t):kM(n)}),Sy(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),mN(function(e){if(JD(e.guardsResult)){var n=BN('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new PN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),wM(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),LL(function(e){if(e.guards.canActivateChecks.length)return kM(e).pipe(mN(function(e){var n=new ON(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),cN(function(e){var n=!1;return kM(e).pipe(function(e,t){return Gy(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return kM(n);var a=0;return Qy(i).pipe(CM(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return kM({});var a={};return Qy(i).pipe(Gy(function(i){return function(e,t,n,r){var i=SL(e,t,r);return WN(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(mN(function(e){a[i]=e}))}),dN(1),Gy(function(){return Object.keys(a).length===i.length?kM(a):$y}))}(e._resolve,e,t,r).pipe(Sy(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),TD(e,n).resolve),null}))}(n.route,r,e,t)}),mN(function(){return a++}),dN(1),Gy(function(e){return a===i.length?kM(n):$y}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),mN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),mN(function(e){var n=new TN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),LL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Sy(function(e){var n=function(e,t,n){var r=DD(e,t._root,n?n._root:void 0);return new SD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),mN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Sy(function(r){return new YD(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),mN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return by(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),hN(function(r){if(i=!0,function(e){return e&&e[VN]}(r)){var a=JD(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new _N(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||YL(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new bN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return $y}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){rL(e),this.config=e.map(oL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return VD(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new zD(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return qN(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(Bg(e),[{outlets:a}])}if(r.segmentPath)return[].concat(Bg(e),[r.segmentPath])}return"string"!=typeof r?[].concat(Bg(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(Bg(e),[r])},[]);return new zD(n,t,r)}(n);if(a.toRoot())return VD(t.root,new tD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new GD(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new GD(r,r===t.root,0)}var i=FD(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new GD(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?$D(o.segmentGroup,o.index,a.commands):HD(o.segmentGroup,o.index,a.commands);return VD(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=JD(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},qL):!1===t?Object.assign({},WL):t,JD(e))return KN(this.currentUrlTree,e,n);var r=this.parseUrl(e);return KN(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new wN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=YL(t)&&l&&!YL(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new _N(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(QC),pw(iD),pw(zL),pw(qI),pw(IE),pw(wI),pw(QT),pw(void 0))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function YL(e){return"imperative"!==e}var KL=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Cy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return Wg(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:XL(this.skipLocationChange),replaceUrl:XL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:XL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(OD),qC("tabindex"),QE(fO),QE(uO))},e.\u0275dir=Ym({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&uS("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[uk]}),e}(),QL=function(){var e=function(){function e(t,n,r){var i=this;Zg(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Cy,this.subscription=t.events.subscribe(function(e){e instanceof wN&&i.updateTargetUrlAndHref()})}return Wg(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:XL(this.skipLocationChange),replaceUrl:XL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:XL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(OD),QE(zI))},e.\u0275dir=Ym({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&uS("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(GS("href",t.href,u_),$E("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[uk]}),e}();function XL(e){return""===e||!!e}var JL=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new gT,this.deactivateEvents=new gT,this.name=i||LN,t.onChildOutletCreated(this.name,this)}return Wg(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new eF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(zL),QE(ZO),QE(iO),qC("name"),QE(NO))},e.\u0275dir=Ym({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),eF=function(){function e(t,n,r){Zg(this,e),this.route=t,this.childContexts=n,this.parent=r}return Wg(e,[{key:"get",value:function(e,t){return e===OD?this.route:e===zL?this.childContexts:this.parent.get(e,t)}}]),e}(),tF=Wg(function e(){Zg(this,e)}),nF=function(){function e(){Zg(this,e)}return Wg(e,[{key:"preload",value:function(e,t){return kM(null)}}]),e}(),rF=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new VL(n,r,function(e){return t.triggerEvent(new IN(e))},function(e){return t.triggerEvent(new AN(e))})}return Wg(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(wM(function(e){return e instanceof wN}),CM(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(GO);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return Qy(r).pipe(Hy(),Sy(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?kM(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Gy(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(jL),pw(wI),pw(QT),pw(IE),pw(tF))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),iF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Zg(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return Wg(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof CN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof wN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof DN&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new DN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(jL),pw(HA),pw(void 0))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),aF=new YC("ROUTER_CONFIGURATION"),oF=new YC("ROUTER_FORROOT_GUARD"),sF=[qI,{provide:iD,useClass:aD},{provide:jL,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new jL(null,e,t,n,r,i,a,$N(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[iD,zL,qI,IE,wI,QT,UL,aF,[function(){return Wg(function e(){Zg(this,e)})}(),new bw],[function(){return Wg(function e(){Zg(this,e)})}(),new bw]]},zL,{provide:OD,useFactory:function(e){return e.routerState.root},deps:[jL]},{provide:wI,useClass:EI},rF,nF,function(){function e(){Zg(this,e)}return Wg(e,[{key:"preload",value:function(e,t){return t().pipe(hN(function(){return kM(null)}))}}]),e}(),{provide:aF,useValue:{enableTracing:!1}}];function uF(){return new vI("Router",jL)}var cF=function(){var e=function(){function e(t,n){Zg(this,e)}return Wg(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[sF,dF(t),{provide:oF,useFactory:hF,deps:[[jL,new bw,new Ew]]},{provide:aF,useValue:n||{}},{provide:zI,useFactory:fF,deps:[xI,[new _w(HI),new bw],aF]},{provide:iF,useFactory:lF,deps:[jL,HA,aF]},{provide:tF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:nF},{provide:vI,multi:!0,useFactory:uF},[vF,{provide:MT,multi:!0,useFactory:pF,deps:[vF]},{provide:yF,useFactory:gF,deps:[vF]},{provide:BT,multi:!0,useExisting:yF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[dF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(oF,8),pw(jL,8))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}();function lF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new iF(e,t,n)}function fF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new ZI(e,t):new $I(e,t)}function hF(e){return"guarded"}function dF(e){return[{provide:KC,multi:!0,useValue:e},{provide:UL,multi:!0,useValue:e}]}var vF=function(){var e=function(){function e(t){Zg(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Cy}return Wg(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(NI,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(jL),i=e.injector.get(aF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?kM(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(aF),n=this.injector.get(rF),r=this.injector.get(iF),i=this.injector.get(jL),a=this.injector.get(kI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(IE))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function pF(e){return e.appInitializer.bind(e)}function gF(e){return e.bootstrapListener.bind(e)}var yF=new YC("Router Initializer"),mF=Wg(function e(){Zg(this,e)}),kF="*";function CF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function wF(e){return{type:6,styles:e,offset:null}}function _F(e){Promise.resolve(null).then(e)}var bF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Zg(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;_F(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),EF=function(){function e(t){var n=this;Zg(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?_F(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function SF(){return"undefined"!=typeof window&&void 0!==window.document}function PF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function OF(e){switch(e.length){case 0:return new bF;case 1:return e[0];default:return new EF(e)}}function TF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case kF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function IF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&AF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&AF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&AF(n,"destroy",e))})}}function AF(e,t,n){var r,i=RF(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function RF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function xF(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function MF(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var NF=function(e,t){return!1},DF=function(e,t){return!1},LF=function(e,t,n){return[]},FF=PF();(FF||"undefined"!=typeof Element)&&(NF=SF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},DF=function(){if(FF||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:DF}(),LF=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var UF=null,VF=!1;function BF(e){UF||(UF=("undefined"!=typeof document?document.body:null)||{},VF=!!UF.style&&"WebkitAppearance"in UF.style);var t=!0;return UF.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in UF.style)&&VF&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in UF.style)),t}var zF=DF,GF=NF,HF=LF;function $F(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var ZF=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return HF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new bF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qF=function(){var e=Wg(function e(){Zg(this,e)});return e.NOOP=new ZF,e}(),WF="ng-enter",jF="ng-leave",YF="ng-trigger",KF=".ng-trigger",QF="ng-animating",XF=".ng-animating";function JF(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:eU(parseFloat(t[1]),t[2])}function eU(e,t){return"s"===t?1e3*e:e}function tU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=eU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=eU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function nU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function rU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else nU(e,n);return n}function iU(e,t,n){return n?t+":"+n+";":""}function aU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=iU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=iU(0,pU(i),e.style[i]));e.setAttribute("style",t)}function oU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=vU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),PF()&&aU(e))}function sU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=vU(t);e.style[n]=""}),PF()&&aU(e))}function uU(e){return Array.isArray(e)?1==e.length?e[0]:CF(e):e}var cU=new RegExp("{{\\s*(.+?)\\s*}}","g");function lU(e){var t=[];if("string"==typeof e){for(var n;n=cU.exec(e);)t.push(n[1]);cU.lastIndex=0}return t}function fU(e,t,n){var r=e.toString(),i=r.replace(cU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function hU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var dU=/-+([a-z0-9])/g;function vU(e){return e.replace(dU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function pU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function gU(e,t){return 0===e||0===t}function yU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=kU(e,t)})},s=1;s<t.length;s++)o()}return t}function mU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function kU(e,t){return window.getComputedStyle(e)[t]}function CU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(bU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(bU(s,a))}(e,n,t)}):n.push(e),n}var wU=new Set(["true","1"]),_U=new Set(["false","0"]);function bU(e,t){var n=wU.has(e)||_U.has(e),r=wU.has(t)||_U.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?wU.has(e):_U.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?wU.has(t):_U.has(t)),o&&s}}var EU=new RegExp("s*:selfs*,?","g");function SU(e,t,n){return new PU(e).build(t,n)}var PU=function(){function e(t){Zg(this,e),this._driver=t}return Wg(e,[{key:"build",value:function(e,t){var n=new OU(t);return this._resetContextStyleTimingState(n),mU(this,uU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(TU(e)){var t=e;Object.keys(t).forEach(function(e){lU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=hU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=mU(this,uU(e.animation),t);return{type:1,matchers:CU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:IU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return mU(n,e,t)}),options:IU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=mU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:IU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return AU(tU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=AU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return AU((n=n||tU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:wF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=wF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==kF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(TU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=lU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(TU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(TU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:mU(this,uU(e.animation),t),options:IU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:IU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:IU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(EU,"")),e=e.replace(/@\*/g,KF).replace(/@\w+/g,function(e){return KF+"-"+e.substr(1)}).replace(/:animating/g,XF),[e,t]}(e.selector),a=Pg(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,xF(t.collectedStyles,t.currentQuerySelector,{});var u=mU(this,uU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:IU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:tU(e.timings,t.errors,!0);return{type:12,animation:mU(this,uU(e.animation),t),timings:n,options:null}}}]),e}(),OU=Wg(function e(t){Zg(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function TU(e){return!Array.isArray(e)&&"object"==typeof e}function IU(e){return e?(e=nU(e)).params&&(e.params=function(e){return e?nU(e):null}(e.params)):e={},e}function AU(e,t,n){return{duration:e,delay:t,easing:n}}function RU(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var xU=function(){function e(){Zg(this,e),this._map=new Map}return Wg(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,Bg(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),MU=new RegExp(":enter","g"),NU=new RegExp(":leave","g");function DU(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new LU).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var LU=function(){function e(){Zg(this,e)}return Wg(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new xU;var l=new UU(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),mU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[RU(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?JF(n.duration):null,a=null!=n.delay?JF(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),mU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=FU);var o=JF(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return mU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?JF(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),mU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return tU(t.params?fU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?JF(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=FU);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),mU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;mU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),FU={},UU=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=FU,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new VU(this._driver,n,0),s.push(this.currentTimeline)}return Wg(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=JF(r.duration)),null!=r.delay&&(i.delay=JF(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=fU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=FU,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new BU(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(MU,"."+this._enterClassName)).replace(NU,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,Bg(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),VU=function(){function e(t,n,r,i){Zg(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return Wg(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||kF,t._currentKeyframe[e]=kF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=kF}):rU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=fU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:kF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=rU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==kF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?hU(t.values()):[],o=n.size?hU(n.values()):[];if(r){var s=i[0],u=nU(s);s.offset=0,u.offset=1,i=[s,u]}return RU(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),BU=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return Zg(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return Wg(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=rU(e[0],!1);u.offset=0,a.push(u);var c=rU(e[0],!1);c.offset=zU(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=rU(e[f],!1);h.offset=zU((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return RU(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(VU);function zU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var GU=Wg(function e(){Zg(this,e)}),HU=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"normalizePropertyName",value:function(e,t){return vU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if($U[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(GU),$U=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function ZU(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var qU={},WU=function(){function e(t,n,r){Zg(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return Wg(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||qU,h=this.buildStyles(n,o&&o.params||qU,l),d=s&&s.params||qU,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:DU(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return ZU(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=xF(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=xF(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=hU(p.values());return ZU(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),jU=function(){function e(t,n,r){Zg(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return Wg(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=nU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=fU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),YU=function(){function e(t,n,r){var i=this;Zg(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new jU(e.style,e.options&&e.options.params||{},r)}),KU(this.states,"true","1"),KU(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new WU(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new WU(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return Wg(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function KU(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var QU=new xU,XU=function(){function e(t,n,r){Zg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return Wg(e,[{key:"register",value:function(e,t){var n=[],r=SU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=TF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=DU(this._driver,t,o,WF,jF,{},{},i,QU,a)).forEach(function(e){var t=xF(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,kF)})});var u=OF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=RF(t,"","","");return IF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),JU="ng-animate-queued",eV="ng-animate-disabled",tV=".ng-animate-disabled",nV=[],rV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},iV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},aV="__ng_removed",oV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Zg(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=nU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return Wg(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),sV="void",uV=new oV(sV),cV=function(){function e(t,n,r){Zg(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,yV(n,this._hostClassName)}return Wg(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=xF(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=xF(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(yV(e,YF),yV(e,YF+"-"+t),u[t]=uV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new fV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(yV(e,YF),yV(e,YF+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new oV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=uV),c.value===sV||u.value!==c.value){var l=xF(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(yV(e,JU),o.onStart(function(){mV(e,JU)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){sU(e,v),oU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,KF,!0);r.forEach(function(e){if(!e[aV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,sV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&OF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||uV,u=new oV(sV),c=new fV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[aV];(!s||s===rV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){yV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=RF(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,IF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),lV=function(){function e(t,n,r){Zg(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return Wg(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new cV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(hV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(hV(t)){var i=t[aV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),yV(e,eV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),mV(e,eV))}},{key:"removeNode",value:function(e,t,n,r){if(hV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[aV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return hV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,KF,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,XF,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return OF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[aV];if(n&&n.setForRemoval){if(e[aV]=rV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,tV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,tV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)yV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?OF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new xU,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=pV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=WF+p++;v.set(t,n),e.forEach(function(e){return yV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[aV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,b=pV(h,Array.from(y));b.forEach(function(e,t){var n=jF+p++;_.set(t,n),e.forEach(function(e){return yV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return mV(e,n)})}),b.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return mV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[aV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)S.push(g);else{if(h)return t.onStart(function(){return sU(a,g.fromStyles)}),t.onDestroy(function(){return oU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return sU(a,g.fromStyles)}),t.onDestroy(function(){return oU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return xF(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){xF(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return wV(e,u,c)}),R=new Map;vV(R,this.driver,m,c,kF).forEach(function(e){wV(e,u,c)&&A.push(e)});var x=new Map;d.forEach(function(e,t){vV(x,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=R.get(e),n=x.get(e);R.set(e,Object.assign(Object.assign({},t),n))});var M=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return oU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,x,R);if(o.setRealPlayer(d),u===D)M.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=OF(v)),i.push(o)}}else sU(t,s.fromStyles),o.onDestroy(function(){return oU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=OF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[aV];if(mV(F,jF),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,Bg(B));for(var z=this.driver.query(F,XF,!0),G=0;G<z.length;G++){var H=s.get(z[G]);H&&H.length&&V.push.apply(V,Bg(H))}}var $=V.filter(function(e){return!e.destroyed});$.length?kV(this,F,$):this.processLeaveNode(F)}}return g.length=0,M.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),M}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[aV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==sV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Gg(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=xF(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}sU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[aV];if(d&&d.removedBeforeQueried)return new bF(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return CV(e,t),t}((n.get(h)||nV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=TF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new fV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){xF(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return yV(e,QF)});var d=OF(h);return d.onDestroy(function(){l.forEach(function(e){return mV(e,QF)}),oU(u,t.toStyles)}),f.forEach(function(e){xF(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new bF(e.duration,e.delay)}}]),e}(),fV=function(){function e(t,n,r){Zg(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new bF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return Wg(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return IF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){xF(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function hV(e){return e&&1===e.nodeType}function dV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function vV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(dV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[aV]=iV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return dV(e,a[s++])}),o}function pV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var gV="$$classes";function yV(e,t){if(e.classList)e.classList.add(t);else{var n=e[gV];n||(n=e[gV]={}),n[t]=!0}}function mV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[gV];n&&delete n[t]}}function kV(e,t,n){OF(n).onDone(function(){return e.processLeaveNode(t)})}function CV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof EF?CV(r.players,t):t.push(r)}}function wV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var _V=function(){function e(t,n,r){var i=this;Zg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new lV(t,n,r),this._timelineEngine=new XU(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return Wg(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=SU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new YU(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Pg(MF(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Pg(MF(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function bV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=SV(t[0]),t.length>1&&(r=SV(t[t.length-1]))):t&&(n=SV(t)),n||r?new EV(e,n,r):null}var EV=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return Wg(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&oU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(oU(this._element,this._initialStyles),this._endStyles&&(oU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(sU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(sU(this._element,this._endStyles),this._endStyles=null),oU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function SV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];PV(i)&&((t=t||{})[i]=e[i])}return t}function PV(e){return"display"===e||"position"===e}var OV="animation",TV="animationend",IV=function(){function e(t,n,r,i,a,o,s){var u=this;Zg(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return Wg(e,[{key:"apply",value:function(){(function(e,t){var n=DV(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),NV(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),MV(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){AV(this._element,this._name,"paused")}},{key:"resume",value:function(){AV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=RV(this._element,this._name);this._position=e*this._duration,NV(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),MV(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=DV(e,"").split(","),r=xV(n,t);r>=0&&(n.splice(r,1),NV(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function AV(e,t,n){NV(e,"PlayState",n,RV(e,t))}function RV(e,t){var n=DV(e,"");return n.indexOf(",")>0?xV(n.split(","),t):xV([n],t)}function xV(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function MV(e,t,n){n?e.removeEventListener(TV,t):e.addEventListener(TV,t)}function NV(e,t,n,r){var i=OV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function DV(e,t){return e.style[OV+t]||""}var LV=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return Wg(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new IV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:kU(e.element,r))})}this.currentSnapshot=t}}]),e}(),FV=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=$F(r),i}return Wg(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),Rg(Vg(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),Rg(Vg(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,Rg(Vg(n.prototype),"destroy",this).call(this))}}]),n}(bF),UV=function(){function e(){Zg(this,e),this._count=0}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return HF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return $F(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof LV}),s={};gU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=yU(e,t,s));if(0==n)return new FV(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=bV(e,t),h=new LV(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),VV=function(){function e(t,n,r,i){Zg(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:kU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),BV=function(){function e(){Zg(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(zV().toString()),this._cssKeyframesDriver=new UV}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return HF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof VV});gU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=bV(e,t=yU(e,t=t.map(function(e){return rU(e,!1)}),u));return new VV(e,t,s,l)}}]),e}();function zV(){return SF()&&Element.prototype.animate||{}}var GV=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Tm.None,styles:[],data:{animation:[]}}),i}return Wg(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?CF(e):e;return ZV(this._renderer,null,t,"register",[n]),new HV(t,this._renderer)}}]),n}(mF);return e.\u0275fac=function(t){return new(t||e)(pw(lO),pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),HV=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return Wg(n,[{key:"create",value:function(e,t){return new $V(this._id,e,t||{},this._renderer)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),$V=function(){function e(t,n,r,i){Zg(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return Wg(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ZV(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function ZV(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var qV="@.disabled",WV=function(){var e=function(){function e(t,n,r){Zg(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return Wg(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new jV("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new YV(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Pg(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(lO),pw(_V),pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),jV=function(){function e(t,n,r){Zg(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return Wg(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==qV?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),YV=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return Wg(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==qV?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=Pg(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(jV),KV=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){return Zg(this,n),t.call(this,e.body,r,i)}return Wg(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(_V);return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(qF),pw(GU))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),QV=new YC("AnimationModuleType"),XV=[{provide:mF,useClass:GV},{provide:GU,useFactory:function(){return new HU}},{provide:_V,useClass:KV},{provide:lO,useFactory:function(e,t,n){return new WV(e,t,n)},deps:[lR,_V,eI]}],JV=[{provide:qF,useFactory:function(){return"function"==typeof zV()?new BV:new UV}},{provide:QV,useValue:"BrowserAnimations"}].concat(XV),eB=[{provide:qF,useClass:ZF},{provide:QV,useValue:"NoopAnimations"}].concat(XV),tB=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?eB:JV}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:JV,imports:[SR]}),e}(),nB=Tg(9575),rB=Tg.n(nB);function iB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function aB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){iB(a,r,i,o,s,"next",e)}function s(e){iB(a,r,i,o,s,"throw",e)}o(void 0)})}}var oB=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Gg(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function sB(e,t){e&&console.log(t)}function uB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===uB(n[o],r[o]))return!1}return!0}return e===t}function cB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===cB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function lB(e,t){if(cB(e)&&cB(t))return uB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var fB=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&lB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),hB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},dB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(hB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},vB=function(e){return function(e){var t=hB(e);return dB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},pB=function(){function e(){var t=this;Zg(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return Wg(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function gB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function yB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gB())}function mB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function kB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function CB(){var e=gB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function wB(){return"object"==typeof indexedDB}function _B(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function bB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var EB=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(Fg(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Fg(a),SB.prototype.create),a}return Wg(n)}(Ig(Error)),SB=function(){function e(t,n,r){Zg(this,e),this.service=t,this.serviceName=n,this.errors=r}return Wg(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(PB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new EB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),PB=/\{\$([^}]+)}/g;function OB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(TB(s)&&TB(u)){if(!OB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function TB(e){return null!==e&&"object"==typeof e}function IB(e){for(var t=[],n=function(){var e=Pg(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function AB(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Pg(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function RB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var xB=function(){function e(t,n){var r=this;Zg(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return Wg(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=MB),void 0===r.error&&(r.error=MB),void 0===r.complete&&(r.complete=MB);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function MB(){}function NB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function DB(e){return e&&e._delegate?e._delegate:e}var LB,FB,UB=function(){function e(t,n,r){Zg(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return Wg(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),VB="[DEFAULT]",BB=function(){function e(t,n){Zg(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return Wg(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new pB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:VB})}catch(u){}var t,n=Gg(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Pg(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VB;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(Bg(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),Bg(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VB;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VB;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Gg(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Pg(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===VB?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VB;return this.component?this.component.multipleInstances?e:VB:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),zB=function(){function e(t){Zg(this,e),this.name=t,this.providers=new Map}return Wg(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new BB(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),GB=[],HB=function(){return(e=HB||(HB={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",HB;var e}(),$B={debug:HB.DEBUG,verbose:HB.VERBOSE,info:HB.INFO,warn:HB.WARN,error:HB.ERROR,silent:HB.SILENT},ZB=HB.INFO,qB=(Sg(xg={},HB.DEBUG,"log"),Sg(xg,HB.VERBOSE,"log"),Sg(xg,HB.INFO,"info"),Sg(xg,HB.WARN,"warn"),Sg(xg,HB.ERROR,"error"),xg),WB=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=qB[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},jB=function(){function e(t){Zg(this,e),this.name=t,this._logLevel=ZB,this._logHandler=WB,this._userLogHandler=null,GB.push(this)}return Wg(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in HB))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?$B[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,HB.DEBUG].concat(t)),this._logHandler.apply(this,[this,HB.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,HB.VERBOSE].concat(t)),this._logHandler.apply(this,[this,HB.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,HB.INFO].concat(t)),this._logHandler.apply(this,[this,HB.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,HB.WARN].concat(t)),this._logHandler.apply(this,[this,HB.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,HB.ERROR].concat(t)),this._logHandler.apply(this,[this,HB.ERROR].concat(t))}}]),e}(),YB=new WeakMap,KB=new WeakMap,QB=new WeakMap,XB=new WeakMap,JB=new WeakMap,ez={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return KB.get(e);if("objectStoreNames"===t)return e.objectStoreNames||QB.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tz(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function tz(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(tz(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&YB.set(t,e)}).catch(function(){}),JB.set(t,e),t}(e);if(XB.has(e))return XB.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(FB||(FB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(nz(this),n),tz(YB.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tz(e.apply(nz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[nz(this),t].concat(r));return QB.set(a,t.sort?t.sort():[t]),tz(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!KB.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});KB.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,LB||(LB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ez):e)}(e);return t!==e&&(XB.set(e,t),JB.set(t,e)),t}var nz=function(e){return JB.get(e)};function rz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=tz(s);return i&&s.addEventListener("upgradeneeded",function(e){i(tz(s.result),e.oldVersion,e.newVersion,tz(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function iz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),tz(r).then(function(){})}var az,oz=["get","getKey","getAll","getAllKeys","count"],sz=["put","add","delete","clear"],uz=new Map;function cz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(uz.get(t))return uz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=sz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||oz.includes(n))){var a,o=(a=aB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return uz.set(t,o),o}}}ez=Eg(Eg({},az=ez),{},{get:function(e,t,n){return cz(e,t)||az.get(e,t,n)},has:function(e,t){return!!cz(e,t)||az.has(e,t)}});var lz=function(){function e(t){Zg(this,e),this.container=t}return Wg(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),fz="@firebase/app",hz=new jB("@firebase/app"),dz="[DEFAULT]",vz=(Sg(Ng={},fz,"fire-core"),Sg(Ng,"@firebase/app-compat","fire-core-compat"),Sg(Ng,"@firebase/analytics","fire-analytics"),Sg(Ng,"@firebase/analytics-compat","fire-analytics-compat"),Sg(Ng,"@firebase/app-check","fire-app-check"),Sg(Ng,"@firebase/app-check-compat","fire-app-check-compat"),Sg(Ng,"@firebase/auth","fire-auth"),Sg(Ng,"@firebase/auth-compat","fire-auth-compat"),Sg(Ng,"@firebase/database","fire-rtdb"),Sg(Ng,"@firebase/database-compat","fire-rtdb-compat"),Sg(Ng,"@firebase/functions","fire-fn"),Sg(Ng,"@firebase/functions-compat","fire-fn-compat"),Sg(Ng,"@firebase/installations","fire-iid"),Sg(Ng,"@firebase/installations-compat","fire-iid-compat"),Sg(Ng,"@firebase/messaging","fire-fcm"),Sg(Ng,"@firebase/messaging-compat","fire-fcm-compat"),Sg(Ng,"@firebase/performance","fire-perf"),Sg(Ng,"@firebase/performance-compat","fire-perf-compat"),Sg(Ng,"@firebase/remote-config","fire-rc"),Sg(Ng,"@firebase/remote-config-compat","fire-rc-compat"),Sg(Ng,"@firebase/storage","fire-gcs"),Sg(Ng,"@firebase/storage-compat","fire-gcs-compat"),Sg(Ng,"@firebase/firestore","fire-fst"),Sg(Ng,"@firebase/firestore-compat","fire-fst-compat"),Sg(Ng,"fire-js","fire-js"),Sg(Ng,"firebase","fire-js-all"),Ng),pz=new Map,gz=new Map;function yz(e,t){try{e.container.addComponent(t)}catch(n){hz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function mz(e){var t=e.name;if(gz.has(t))return hz.debug("There were multiple attempts to register component ".concat(t,".")),!1;gz.set(t,e);var n,r=Gg(pz.values());try{for(r.s();!(n=r.n()).done;){yz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function kz(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Cz=new SB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),wz=function(){function e(t,n,r){var i=this;Zg(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new UB("app",function(){return i},"PUBLIC"))}return Wg(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Cz.create("app-deleted",{appName:this._name})}}]),e}(),_z="9.9.0";function bz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dz,t=pz.get(e);if(!t)throw Cz.create("no-app",{appName:e});return t}function Ez(){return Array.from(pz.values())}function Sz(e,t,n){var r,i=null!==(r=vz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void hz.warn(s.join(" "))}mz(new UB("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var Pz="firebase-heartbeat-store",Oz=null;function Tz(){return Oz||(Oz=rz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(Pz)}}).catch(function(e){throw Cz.create("storage-open",{originalErrorMessage:e.message})})),Oz}function Iz(){return Iz=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Tz();case 3:return e.abrupt("return",e.sent.transaction(Pz).objectStore(Pz).get(xz(t)));case 6:throw e.prev=6,e.t0=e.catch(0),Cz.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),Iz.apply(this,arguments)}function Az(e,t){return Rz.apply(this,arguments)}function Rz(){return Rz=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Tz();case 3:return i=e.sent.transaction(Pz,"readwrite"),e.next=6,i.objectStore(Pz).put(n,xz(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),Cz.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),Rz.apply(this,arguments)}function xz(e){return"".concat(e.name,"!").concat(e.options.appId)}var Mz=function(){function e(t){var n=this;Zg(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Dz(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return Wg(e,[{key:"triggerHeartbeat",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Nz(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=Nz(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=Gg(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),Lz(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),Lz(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=vB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function Nz(){return(new Date).toISOString().substring(0,10)}var Dz=function(){function e(t){Zg(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return Wg(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!wB()&&_B().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return Iz.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Az(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Az(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(Bg(i.heartbeats),Bg(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function Lz(e){return vB(JSON.stringify({version:2,heartbeats:e})).length}mz(new UB("platform-logger",function(e){return new lz(e)},"PRIVATE")),mz(new UB("heartbeat",function(e){return new Mz(e)},"PRIVATE")),Sz(fz,"0.7.28",""),Sz(fz,"0.7.28","esm2017"),Sz("fire-js",""),Sz("firebase","9.9.0","app");var Fz="@firebase/installations",Uz="0.5.12",Vz="w:".concat(Uz),Bz="FIS_v2",zz=new SB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Gz(e){return e instanceof EB&&e.code.includes("request-failed")}function Hz(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function $z(e){return{token:e.token,requestStatus:2,expiresIn:Qz(e.expiresIn),creationTime:Date.now()}}function Zz(e,t){return qz.apply(this,arguments)}function qz(){return qz=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",zz.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),qz.apply(this,arguments)}function Wz(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function jz(e,t){var n=t.refreshToken,r=Wz(e);return r.append("Authorization",function(e){return"".concat(Bz," ").concat(e)}(n)),r}function Yz(e){return Kz.apply(this,arguments)}function Kz(){return Kz=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),Kz.apply(this,arguments)}function Qz(e){return Number(e.replace("s","000"))}function Xz(e,t){return Jz.apply(this,arguments)}function Jz(){return Jz=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=Hz(r),s=Wz(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:Bz,appId:r.appId,sdkVersion:Vz})},e.next=11,Yz(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:$z(h.authToken)});case 17:return e.next=19,Zz("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),Jz.apply(this,arguments)}function eG(e){return new Promise(function(t){setTimeout(t,e)})}var tG=/^[cdef][\w-]{21}$/;function nG(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,Bg(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return tG.test(t)?t:""}catch(n){return""}}function rG(e){return"".concat(e.appName,"!").concat(e.appId)}var iG=new Map;function aG(e,t){var n=rG(e);oG(n,t),function(e,t){var n=(!sG&&"BroadcastChannel"in self&&((sG=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){oG(e.data.key,e.data.fid)}),sG);n&&n.postMessage({key:e,fid:t}),0===iG.size&&sG&&(sG.close(),sG=null)}(n,t)}function oG(e,t){var n=iG.get(e);if(n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var sG=null,uG="firebase-installations-store",cG=null;function lG(){return cG||(cG=rz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(uG)}})),cG}function fG(e,t){return hG.apply(this,arguments)}function hG(){return hG=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=rG(t),e.next=3,lG();case 3:return i=e.sent.transaction(uG,"readwrite"),a=i.objectStore(uG),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&aG(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),hG.apply(this,arguments)}function dG(e){return vG.apply(this,arguments)}function vG(){return vG=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=rG(t),e.next=3,lG();case 3:return r=e.sent.transaction(uG,"readwrite"),e.next=6,r.objectStore(uG).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),vG.apply(this,arguments)}function pG(e,t){return gG.apply(this,arguments)}function gG(){return gG=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=rG(t),e.next=3,lG();case 3:return i=e.sent.transaction(uG,"readwrite"),a=i.objectStore(uG),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&aG(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),gG.apply(this,arguments)}function yG(e){return mG.apply(this,arguments)}function mG(){return mG=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pG(t.appConfig,function(e){var r=kG(e),i=CG(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),mG.apply(this,arguments)}function kG(e){return SG(e||{fid:nG(),registrationStatus:0})}function CG(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(zz.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return wG.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:_G(e)}:{installationEntry:t}}function wG(){return wG=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xz(t,n);case 3:return r=e.sent,e.abrupt("return",fG(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!Gz(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,dG(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,fG(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),wG.apply(this,arguments)}function _G(e){return bG.apply(this,arguments)}function bG(){return bG=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,EG(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,eG(100);case 6:return e.next=8,EG(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,yG(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),bG.apply(this,arguments)}function EG(e){return pG(e,function(e){if(!e)throw zz.create("installation-not-found");return SG(e)})}function SG(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function PG(e,t){return OG.apply(this,arguments)}function OG(){return OG=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=TG(r,n),o=jz(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:Vz,appId:r.appId}})},e.next=10,Yz(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=$z,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,Zz("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),OG.apply(this,arguments)}function TG(e,t){var n=t.fid;return"".concat(Hz(e),"/").concat(n,"/authTokens:generate")}function IG(e){return AG.apply(this,arguments)}function AG(){return AG=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,pG(t.appConfig,function(e){if(!LG(e))throw zz.create("not-registered");var i=e.authToken;if(!n&&FG(i))return e;if(1===i.requestStatus)return r=RG(t,n),e;if(!navigator.onLine)throw zz.create("app-offline");var a=UG(e);return r=NG(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),AG.apply(this,arguments)}function RG(e,t){return xG.apply(this,arguments)}function xG(){return xG=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MG(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,eG(100);case 6:return e.next=8,MG(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?IG(t,n):i);case 13:case"end":return e.stop()}},e)})),xG.apply(this,arguments)}function MG(e){return pG(e,function(e){if(!LG(e))throw zz.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function NG(e,t){return DG.apply(this,arguments)}function DG(){return DG=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PG(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,fG(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),Gz(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,fG(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,dG(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),DG.apply(this,arguments)}function LG(e){return void 0!==e&&2===e.registrationStatus}function FG(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function UG(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function VG(){return VG=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,yG(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):IG(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),VG.apply(this,arguments)}function BG(){return BG=aB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,zG(r);case 4:return e.next=6,IG(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),BG.apply(this,arguments)}function zG(e){return GG.apply(this,arguments)}function GG(){return GG=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yG(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),GG.apply(this,arguments)}function HG(e){return zz.create("missing-app-config-values",{valueName:e})}var $G="installations";mz(new UB($G,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw HG("App Configuration");if(!e.name)throw HG("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw HG(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:kz(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),mz(new UB("installations-internal",function(e){var t=kz(e.getProvider("app").getImmediate(),$G).getImmediate();return{getId:function(){return function(e){return VG.apply(this,arguments)}(t)},getToken:function(e){return function(e){return BG.apply(this,arguments)}(t,e)}}},"PRIVATE")),Sz(Fz,Uz),Sz(Fz,Uz,"esm2017");var ZG="@firebase/remote-config",qG=new SB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),WG=function(){function e(t,n,r,i){Zg(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return Wg(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Pg(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function jG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var YG=function(){function e(t,n,r,i,a,o){Zg(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return Wg(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=Pg(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:jG()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),qG.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),qG.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw qG.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),KG=function(){function e(t,n){Zg(this,e),this.client=t,this.storage=n}return Wg(e,[{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return aB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(qG.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof EB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+NB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),QG=function(){function e(t,n,r,i,a){Zg(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return Wg(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function XG(e,t){var n,r=e.target.error||void 0;return qG.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var JG="app_namespace_store",eH=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(XG(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(JG,{keyPath:"compositeKey"})}}catch(r){t(qG.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});Zg(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return Wg(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([JG],"readonly").objectStore(JG),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(XG(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(qG.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([JG],"readwrite").objectStore(JG),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(XG(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(qG.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([JG],"readwrite").objectStore(JG),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(XG(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(qG.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),tH=function(){function e(t){Zg(this,e),this.storage=t}return Wg(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function nH(){return(nH=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(wB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,_B();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}mz(new UB("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw qG.create("registration-window");if(!wB())throw qG.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw qG.create("registration-project-id");if(!s)throw qG.create("registration-api-key");if(!u)throw qG.create("registration-app-id");var c=new eH(u,r.name,n=n||"firebase"),l=new tH(c),f=new jB(ZG);f.logLevel=HB.ERROR;var h=new YG(i,_z,n,o,s,u),d=new KG(h,c),v=new WG(d,c,l,f),p=new QG(r,v,l,c,f);return function(e){var t=DB(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),Sz(ZG,"0.3.11"),Sz(ZG,"0.3.11","esm2017");var rH="/firebase-messaging-sw.js",iH="/firebase-cloud-messaging-push-scope",aH="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",oH="google.c.a.c_id",sH="google.c.a.c_l",uH="google.c.a.ts",cH="google.c.a.e",lH=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(lH||(lH={})),lH);function fH(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Bg(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function hH(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var dH="fcm_token_details_db",vH="fcm_token_object_Store";function pH(e){return gH.apply(this,arguments)}function gH(){return gH=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(dH);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,rz(dH,5,{upgrade:(r=aB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(vH)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(vH),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:fH(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:fH(f.auth),p256dh:fH(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:fH(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:fH(h.auth),p256dh:fH(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:fH(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,iz(dH);case 13:return e.next=15,iz("fcm_vapid_details_db");case 15:return e.next=17,iz("undefined");case 17:return e.abrupt("return",yH(n)?n:null);case 18:case"end":return e.stop()}},e)})),gH.apply(this,arguments)}function yH(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var mH="firebase-messaging-store",kH=null;function CH(){return kH||(kH=rz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(mH)}})),kH}function wH(e){return _H.apply(this,arguments)}function _H(){return _H=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=OH(t),e.next=3,CH();case 3:return e.next=5,e.sent.transaction(mH).objectStore(mH).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,pH(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,bH(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),_H.apply(this,arguments)}function bH(e,t){return EH.apply(this,arguments)}function EH(){return EH=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=OH(t),e.next=3,CH();case 3:return i=e.sent.transaction(mH,"readwrite"),e.next=6,i.objectStore(mH).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),EH.apply(this,arguments)}function SH(e){return PH.apply(this,arguments)}function PH(){return PH=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=OH(t),e.next=3,CH();case 3:return r=e.sent.transaction(mH,"readwrite"),e.next=6,r.objectStore(mH).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),PH.apply(this,arguments)}function OH(e){return e.appConfig.appId}var TH=new SB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function IH(e,t){return AH.apply(this,arguments)}function AH(){return AH=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LH(t);case 2:return i=e.sent,a=UH(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(DH(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),TH.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw TH.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw TH.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),AH.apply(this,arguments)}function RH(e,t){return xH.apply(this,arguments)}function xH(){return xH=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LH(t);case 2:return i=e.sent,a=UH(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(DH(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),TH.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw TH.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw TH.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),xH.apply(this,arguments)}function MH(e,t){return NH.apply(this,arguments)}function NH(){return NH=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LH(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(DH(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw TH.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),TH.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),NH.apply(this,arguments)}function DH(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function LH(e){return FH.apply(this,arguments)}function FH(){return FH=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),FH.apply(this,arguments)}function UH(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==aH&&(a.web.applicationPubKey=i),a}function VH(e){return BH.apply(this,arguments)}function BH(){return BH=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WH(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:fH(n.getKey("auth")),p256dh:fH(n.getKey("p256dh"))},e.next=6,wH(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!YH(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?HH(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,MH(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",ZH(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),BH.apply(this,arguments)}function zH(e){return GH.apply(this,arguments)}function GH(){return GH=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wH(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,MH(t.firebaseDependencies,n.token);case 7:return e.next=9,SH(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),GH.apply(this,arguments)}function HH(e,t){return $H.apply(this,arguments)}function $H(){return $H=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,RH(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,bH(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,zH(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),$H.apply(this,arguments)}function ZH(e,t){return qH.apply(this,arguments)}function qH(){return qH=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,IH(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,bH(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),qH.apply(this,arguments)}function WH(e,t){return jH.apply(this,arguments)}function jH(){return jH=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:hH(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),jH.apply(this,arguments)}function YH(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function KH(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function QH(e){return"object"==typeof e&&!!e&&oH in e}function XH(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function JH(e){return TH.create("missing-app-config-values",{valueName:e})}XH("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),XH("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var e$=function(){function e(t,n,r){Zg(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw JH("App Configuration Object");if(!e.name)throw JH("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw JH(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return Wg(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function t$(e){return n$.apply(this,arguments)}function n$(){return n$=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(rH,{scope:iH});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),TH.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n$.apply(this,arguments)}function r$(e,t){return i$.apply(this,arguments)}function i$(){return i$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,t$(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw TH.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),i$.apply(this,arguments)}function a$(e,t){return o$.apply(this,arguments)}function o$(){return o$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=aH);case 1:case"end":return e.stop()}},e)})),o$.apply(this,arguments)}function s$(){return s$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw TH.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw TH.create("permission-blocked");case 8:return e.next=10,a$(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,r$(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",VH(t));case 13:case"end":return e.stop()}},e)})),s$.apply(this,arguments)}function u$(e,t,n){return c$.apply(this,arguments)}function c$(){return c$=aB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=l$(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[oH],message_name:r[sH],message_time:r[uH],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),c$.apply(this,arguments)}function l$(e){switch(e){case lH.NOTIFICATION_CLICKED:return"notification_open";case lH.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function f$(){return f$=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===lH.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(KH(r)):t.onMessageHandler.next(KH(r))),i=r.data,e.t0=QH(i)&&"1"===i[cH],!e.t0){e.next=9;break}return e.next=9,u$(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),f$.apply(this,arguments)}var h$="@firebase/messaging";function d$(){return(d$=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_B();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&wB()&&bB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}mz(new UB("messaging",function(e){var t=new e$(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return f$.apply(this,arguments)}(t,e)}),t},"PUBLIC")),mz(new UB("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return s$.apply(this,arguments)}(t,e)}}},"PRIVATE")),Sz(h$,"0.9.16"),Sz(h$,"0.9.16","esm2017");var v$="analytics",p$="firebase_id",g$="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",y$="https://www.googletagmanager.com/gtag/js",m$=new jB("@firebase/analytics");function k$(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function C$(e,t){var n=document.createElement("script");n.src="".concat(y$,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function w$(e,t,n,r,i,a){return _$.apply(this,arguments)}function _$(){return _$=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,k$(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),m$.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),_$.apply(this,arguments)}function b$(e,t,n,r,i){return E$.apply(this,arguments)}function E$(){return E$=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,k$(r);case 7:u=e.sent,c=Gg(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),m$.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),E$.apply(this,arguments)}function S$(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(y$))return r}return null}var P$=new SB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),O$=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Zg(this,e),this.throttleMetadata=t,this.intervalMillis=n}return Wg(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function T$(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function I$(e){return A$.apply(this,arguments)}function A$(){return A$=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:T$(i)},o=g$.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw P$.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),A$.apply(this,arguments)}function R$(e){return x$.apply(this,arguments)}function x$(){return x$=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:O$,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw P$.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw P$.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new V$,e.abrupt("return",(setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),M$({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),x$.apply(this,arguments)}function M$(e,t,n){return N$.apply(this,arguments)}function N$(){return N$=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:O$,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,D$(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(m$.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,I$(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),L$(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(m$.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?NB(a,o.intervalMillis,30):NB(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),m$.debug("Calling attemptFetch again in ".concat(d," millis")),M$(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),N$.apply(this,arguments)}function D$(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(P$.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function L$(e){if(!(e instanceof EB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var F$,U$,V$=function(){function e(){Zg(this,e),this.listeners=[]}return Wg(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function B$(){return B$=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),B$.apply(this,arguments)}function z$(e){U$=e}function G$(e){F$=e}function H$(){return $$.apply(this,arguments)}function $$(){return $$=aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(wB()){e.next=2;break}return e.abrupt("return",(m$.warn(P$.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,_B();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(m$.warn(P$.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),$$.apply(this,arguments)}function Z$(){return Z$=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=R$(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&m$.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return m$.error(e)}),n.push(c),l=H$().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=Pg(f,2),d=h[0],v=h[1],S$()||C$(o,d.measurementId),U$&&(a("consent","default",U$),z$(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[p$]=v),a("config",d.measurementId,p),F$&&(a("set",F$),G$(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),Z$.apply(this,arguments)}var q$,W$,j$=function(){function e(t){Zg(this,e),this.app=t}return Wg(e,[{key:"_delete",value:function(){return delete Y$[this.app.options.appId],Promise.resolve()}}]),e}(),Y$={},K$=[],Q$={},X$="dataLayer",J$=!1;function eZ(){return(eZ=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!mB()&&bB()&&wB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,_B();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var tZ="@firebase/analytics";mz(new UB(v$,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(mB()&&e.push("This is a browser extension environment."),bB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=P$.create("invalid-analytics-context",{errorInfo:t});m$.warn(n.message)}}();var r=e.options.appId;if(!r)throw P$.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw P$.create("no-api-key");m$.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=Y$[r])throw P$.create("already-exists",{id:r});if(!J$){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(X$);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=aB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,b$(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,w$(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),m$.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(Y$,K$,Q$,X$,"gtag"),a=i.wrappedGtag,o=i.gtagCore;W$=a,q$=o,J$=!0}return Y$[r]=function(e,t,n,r,i,a,o){return Z$.apply(this,arguments)}(e,K$,Q$,t,q$,X$,n),new j$(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),mz(new UB("analytics-internal",function(e){try{var t=e.getProvider(v$).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=DB(e),function(e,t,n,r,i){return B$.apply(this,arguments)}(W$,Y$[e.app.options.appId],t,n,r).catch(function(e){return m$.error(e)})}(t,e,n,r)}}}catch(t){throw P$.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Sz(tZ,"0.8.0"),Sz(tZ,"0.8.0","esm2017");var nZ=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this)}return Wg(n,[{key:"schedule",value:function(e){return this}}]),n}(qg),rZ={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=rZ.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=rZ.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},iZ=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return Wg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rZ.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;rZ.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,$g(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,Rg(Vg(n.prototype),"unsubscribe",this).call(this)}}}]),n}(nZ),aZ={now:function(){return(aZ.delegate||Date).now()},delegate:void 0},oZ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;Zg(this,e),this.schedulerActionCtor=t,this.now=n}return Wg(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();oZ.now=aZ.now;var sZ=function(e){Mg(n,e);var t=Dg(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oZ.now;return Zg(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return Wg(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(oZ),uZ=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(sZ))(function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Wg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?Rg(Vg(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?Rg(Vg(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?Rg(Vg(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(iZ)),cZ=new sZ(iZ),lZ=new vO("7.4.1"),fZ="__angularfire_symbol__analyticsIsSupportedValue",hZ="__angularfire_symbol__analyticsIsSupported",dZ="__angularfire_symbol__remoteConfigIsSupportedValue",vZ="__angularfire_symbol__remoteConfigIsSupported",pZ="__angularfire_symbol__messagingIsSupportedValue",gZ="__angularfire_symbol__messagingIsSupported";function yZ(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[hZ]||(globalThis[hZ]=function(){return eZ.apply(this,arguments)}().then(function(e){return globalThis[fZ]=e}).catch(function(){return globalThis[fZ]=!1})),globalThis[gZ]||(globalThis[gZ]=function(){return d$.apply(this,arguments)}().then(function(e){return globalThis[pZ]=e}).catch(function(){return globalThis[pZ]=!1})),globalThis[vZ]||(globalThis[vZ]=function(){return nH.apply(this,arguments)}().then(function(e){return globalThis[dZ]=e}).catch(function(){return globalThis[dZ]=!1}));var mZ=function(e,t){var n=t?[t]:Ez(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function kZ(){}var CZ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uZ;Zg(this,e),this.zone=t,this.delegate=n}return Wg(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),wZ=function(){function e(t){Zg(this,e),this.zone=t,this.task=null}return Wg(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",kZ,{},kZ,kZ)}),t.pipe(mN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),_Z=function(){var e=Wg(function e(t){Zg(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new CZ(Zone.current)}),this.insideAngular=t.run(function(){return new CZ(Zone.current,cZ)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function bZ(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function EZ(e){return bZ().ngZone.runOutsideAngular(function(){return e()})}function SZ(e){return bZ().ngZone.run(function(){return e()})}function PZ(e){return bZ(),function(e){return function(t){return(t=t.lift(new wZ(e.ngZone))).pipe(Yy(e.outsideAngular),jy(e.insideAngular))}}(bZ())(e)}var OZ=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),SZ(function(){return e.apply(n,r)})}},TZ=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=SZ(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",kZ,{},kZ,kZ)}))),i[a]=OZ(i[a],n));var o=EZ(function(){return e.apply(r,i)});if(!t){if(o instanceof yy){var s=bZ();return o.pipe(Yy(s.outsideAngular),jy(s.insideAngular))}return SZ(function(){return o})}return o instanceof yy?o.pipe(PZ):o instanceof Promise?SZ(function(){return new Promise(function(e,t){return o.then(function(t){return SZ(function(){return e(t)})},function(e){return SZ(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:SZ(function(){return o})}},IZ=Wg(function e(t){return Zg(this,e),t}),AZ=Wg(function e(){return Zg(this,e),Ez()}),RZ=new YC("angularfire2._apps"),xZ={provide:IZ,useFactory:function(e){return e&&1===e.length?e[0]:new IZ(bz())},deps:[[new bw,RZ]]},MZ={provide:AZ,deps:[[new bw,RZ]]};function NZ(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new IZ(r)}}var DZ=function(){var e=Wg(function e(t){Zg(this,e),Sz("angularfire",lZ.full,"core"),Sz("angularfire",lZ.full,"app"),Sz("angular",pO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(pw(VT))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[xZ,MZ]}),e}(),LZ=TZ(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:dz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Cz.create("bad-app-name",{appName:String(r)});var i=pz.get(r);if(i){if(OB(e,i.options)&&OB(n,i.config))return i;throw Cz.create("duplicate-app",{appName:r})}var a,o=new zB(r),s=Gg(gz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new wz(e,n,o);return pz.set(r,c),c},!0),FZ=new Map,UZ={activated:!1,tokenObservers:[]},VZ={initialized:!1,enabled:!1};function BZ(e){return FZ.get(e)||UZ}function zZ(e,t){FZ.set(e,t)}function GZ(){return VZ}var HZ=function(){function e(t,n,r,i,a){if(Zg(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return Wg(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new pB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new pB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),$Z=new SB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function ZZ(e){if(!BZ(e).activated)throw $Z.create("use-before-activation",{appName:e.name})}function qZ(e,t){return WZ.apply(this,arguments)}function WZ(){return WZ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),$Z.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw $Z.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),$Z.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw $Z.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),WZ.apply(this,arguments)}function jZ(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var YZ="firebase-app-check-store",KZ=null;function QZ(){return KZ||(KZ=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t($Z.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(YZ,{keyPath:"compositeKey"})}}catch(r){t($Z.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),KZ)}function XZ(){return XZ=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,QZ();case 2:return r=e.sent.transaction(YZ,"readwrite"),i=r.objectStore(YZ).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t($Z.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),XZ.apply(this,arguments)}var JZ=new jB("@firebase/app-check");function eq(e,t){return wB()?function(e,t){return function(e,t){return XZ.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){JZ.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function tq(){return GZ().enabled}function nq(){return rq.apply(this,arguments)}function rq(){return rq=aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=GZ()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),rq.apply(this,arguments)}var iq={error:"UNKNOWN_ERROR"};function aq(e){return dB.encodeString(JSON.stringify(e),!1)}function oq(e){return sq.apply(this,arguments)}function sq(){return sq=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],ZZ(r=t.app),i=BZ(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&fq(s)&&(o=s);case 10:if(n||!o||!fq(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!tq()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=qZ,e.t2=jZ,e.t3=r,e.next=21,nq();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,eq(r,l);case 31:return zZ(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?JZ.warn(e.t7.message):JZ.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},zZ(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,eq(r,o);case 48:e.next=51;break;case 50:u=hq(a);case 51:return c&&lq(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),sq.apply(this,arguments)}function uq(e,t){var n=BZ(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),zZ(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function cq(e){var t=e.app,n=BZ(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new HZ(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!BZ(t).token){n.next=6;break}return n.next=3,oq(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,oq(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=BZ(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),zZ(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function lq(e,t){var n,r=Gg(BZ(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function fq(e){return e.expireTimeMillis-Date.now()>0}function hq(e){return{token:aq(iq),error:e}}var dq=function(){function e(t,n){Zg(this,e),this.app=t,this.heartbeatServiceProvider=n}return Wg(e,[{key:"_delete",value:function(){var e,t=Gg(BZ(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;uq(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),vq="app-check-internal";mz(new UB("app-check",function(e){return function(e,t){return new dq(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(vq).initialize()})),mz(new UB(vq,function(e){return function(e){return{getToken:function(t){return oq(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=BZ(i),o={next:n,error:void 0,type:"INTERNAL"};if(zZ(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(Bg(a.tokenObservers),[o])})),a.token&&fq(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),cq(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return cq(e)})}(e,0,t)},removeTokenListener:function(t){return uq(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),Sz("@firebase/app-check","0.5.11");var pq=Wg(function e(){return Zg(this,e),mZ("app-check")});"undefined"!=typeof window&&window;var gq=new SB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),yq=new jB("@firebase/auth");function mq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];yq.logLevel<=HB.ERROR&&yq.error.apply(yq,["Auth (9.9.0): ".concat(e)].concat(n))}function kq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw bq.apply(void 0,[e].concat(n))}function Cq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return bq.apply(void 0,[e].concat(n))}function wq(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Sg({},t,n));return new SB("auth","Firebase",r).create(t,{appName:e.name})}function _q(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&kq(e,"argument-error"),wq(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function bq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=Bg(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(Bg(o)))}return gq.create.apply(gq,[e].concat(n))}function Eq(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw bq.apply(void 0,[t].concat(r))}function Sq(e){var t="INTERNAL ASSERTION FAILED: "+e;throw mq(t),new Error(t)}function Pq(e,t){e||Sq(t)}var Oq=new Map;function Tq(e){Pq(e instanceof Function,"Expected a class definition");var t=Oq.get(e);return t?(Pq(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Oq.set(e,t),t)}function Iq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Aq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Rq=function(){function e(t,n){Zg(this,e),this.shortDelay=t,this.longDelay=n,Pq(n>t,"Short delay should be less than long delay!"),this.isMobile=yB()||kB()}return Wg(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Aq()||"https:"===Aq()||mB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function xq(e,t){Pq(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Mq=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Sq("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Sq("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Sq("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Nq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Dq=new Rq(3e4,6e4);function Lq(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Fq(e,t,n,r){return Uq.apply(this,arguments)}function Uq(){return Uq=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Vq(t,a,aB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=IB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),Mq.fetch()(Hq(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),Uq.apply(this,arguments)}function Vq(e,t,n){return Bq.apply(this,arguments)}function Bq(){return Bq=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},Nq),n),e.prev=2,a=new $q(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Zq(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Pg(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw Zq(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw Zq(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw Zq(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw wq(t,d,h);case 25:kq(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof EB)){e.next=32;break}throw e.t0;case 32:kq(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),Bq.apply(this,arguments)}function zq(e,t,n,r){return Gq.apply(this,arguments)}function Gq(){return Gq=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,Fq(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&kq(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),Gq.apply(this,arguments)}function Hq(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?xq(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var $q=function(){function e(t){var n=this;Zg(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(Cq(n.auth,"network-request-failed"))},Dq.get())})}return Wg(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Zq(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=Cq(e,t,r);return i.customData._tokenResponse=n,i}function qq(){return qq=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fq(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),qq.apply(this,arguments)}function Wq(e,t){return jq.apply(this,arguments)}function jq(){return jq=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fq(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),jq.apply(this,arguments)}function Yq(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Kq(){return Kq=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=DB(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,Eq((a=Xq(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:Yq(Qq(a.auth_time)),issuedAtTime:Yq(Qq(a.iat)),expirationTime:Yq(Qq(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),Kq.apply(this,arguments)}function Qq(e){return 1e3*Number(e)}function Xq(e){var t,n=Pg(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return mq("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return dB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(mq("Failed to decode base64 JWT payload"),null)}catch(s){return mq("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function Jq(e,t){return eW.apply(this,arguments)}function eW(){return eW=aB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof EB&&tW(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),eW.apply(this,arguments)}function tW(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var nW=function(){function e(t){Zg(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return Wg(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),rW=function(){function e(t,n){Zg(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return Wg(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Yq(this.lastLoginAt),this.creationTime=Yq(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function iW(e){return aW.apply(this,arguments)}function aW(){return aW=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Jq(t,Wq(r,{idToken:i}));case 6:Eq(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?uW(o.providerUserInfo):[],u=sW(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new rW(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),aW.apply(this,arguments)}function oW(){return oW=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=DB(t),e.next=3,iW(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),oW.apply(this,arguments)}function sW(e,t){return[].concat(Bg(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),Bg(t))}function uW(e){return e.map(function(e){var t=e.providerId,n=Py(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function cW(){return cW=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vq(t,{},aB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=IB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=Hq(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",Mq.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),cW.apply(this,arguments)}var lW=function(){function e(){Zg(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Wg(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){Eq(e.idToken,"internal-error"),Eq(void 0!==e.idToken,"internal-error"),Eq(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=Xq(e);return Eq(t,"internal-error"),Eq(void 0!==t.exp,"internal-error"),Eq(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(Eq(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return cW.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return Sq("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(Eq("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(Eq("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(Eq("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function fW(e,t){Eq("string"==typeof e||void 0===e,"internal-error",{appName:t})}var hW=function(){function e(t){Zg(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Py(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?Bg(a.providerData):[],this.metadata=new rW(a.createdAt||void 0,a.lastLoginAt||void 0)}return Wg(e,[{key:"getIdToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Jq(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(Eq(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return Kq.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return oW.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(Eq(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){Eq(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,iW(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,Jq(e,function(e,t){return qq.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,b=n.stsTokenManager;Eq(k&&b,t,"internal-error");var E=lW.fromJSON(this.name,b);Eq("string"==typeof k,t,"internal-error"),fW(f,t.name),fW(h,t.name),Eq("boolean"==typeof C,t,"internal-error"),Eq("boolean"==typeof w,t,"internal-error"),fW(d,t.name),fW(v,t.name),fW(p,t.name),fW(g,t.name),fW(y,t.name),fW(m,t.name);var S=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(S.providerData=_.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new lW).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,iW(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),dW=function(){var e=function(){function e(){Zg(this,e),this.type="NONE",this.storage={}}return Wg(e,[{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function vW(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var pW=function(){function e(t,n,r){Zg(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=vW(this.userKey,a.apiKey,o),this.fullPersistenceKey=vW("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return Wg(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?hW._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(Tq(dW),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||Tq(dW),s=vW(r,t.config.apiKey,t.name),u=null,c=Gg(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=hW._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function gW(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(CW(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(yW(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(_W(t))return"Blackberry";if(bW(t))return"Webos";if(mW(t))return"Safari";if((t.includes("chrome/")||kW(t))&&!t.includes("edge/"))return"Chrome";if(wW(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function yW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/firefox\//i.test(e)}function mW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function kW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/crios\//i.test(e)}function CW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/iemobile/i.test(e)}function wW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/android/i.test(e)}function _W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/blackberry/i.test(e)}function bW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/webos/i.test(e)}function EW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function SW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return EW(e)||wW(e)||bW(e)||_W(e)||/windows phone/i.test(e)||CW(e)}function PW(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=gW(gB());break;case"Worker":t="".concat(gW(gB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var OW=function(){function e(t){Zg(this,e),this.auth=t,this.queue=[]}return Wg(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=Gg(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=Gg(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),TW=function(){function e(t,n,r){Zg(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AW(this),this.idTokenSubscription=new AW(this),this.beforeStateQueue=new OW(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gq,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return Wg(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=Tq(t)),this._initializationPromise=this.queue(aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,pW.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return Eq(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,iW(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?DB(e):null,n.abrupt("return",(r&&Eq(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&Eq(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(Tq(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new SB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return Eq(r=e&&Tq(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,pW.create(t,[Tq(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Eq(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return Eq(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PW(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function IW(e){return DB(e)}var AW=function(){function e(t){var n,r=this;Zg(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new xB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return Wg(e,[{key:"next",get:function(){return Eq(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),RW=function(){function e(t,n){Zg(this,e),this.providerId=t,this.signInMethod=n}return Wg(e,[{key:"toJSON",value:function(){return Sq("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Sq("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Sq("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Sq("not implemented")}}]),e}();function xW(){return xW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),xW.apply(this,arguments)}function MW(){return MW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",zq(t,"POST","/v1/accounts:signInWithPassword",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),MW.apply(this,arguments)}function NW(e,t){return DW.apply(this,arguments)}function DW(){return DW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fq(t,"POST","/v1/accounts:sendOobCode",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),DW.apply(this,arguments)}function LW(e,t){return FW.apply(this,arguments)}function FW(){return FW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",NW(t,n));case 1:case"end":return e.stop()}},e)})),FW.apply(this,arguments)}function UW(e,t){return VW.apply(this,arguments)}function VW(){return VW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",NW(t,n));case 1:case"end":return e.stop()}},e)})),VW.apply(this,arguments)}function BW(){return BW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",zq(t,"POST","/v1/accounts:signInWithEmailLink",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),BW.apply(this,arguments)}function zW(){return zW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",zq(t,"POST","/v1/accounts:signInWithEmailLink",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),zW.apply(this,arguments)}var GW=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zg(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return Wg(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return MW.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return BW.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:kq(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return xW.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return zW.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:kq(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(RW);function HW(e,t){return $W.apply(this,arguments)}function $W(){return $W=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",zq(t,"POST","/v1/accounts:signInWithIdp",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),$W.apply(this,arguments)}var ZW=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return Wg(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return HW(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,HW(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,HW(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=IB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kq("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Py(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(RW),qW=function(){function e(t){var n,r,i,a,o,s;Zg(this,e);var u=AB(RB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);Eq(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return Wg(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=AB(RB(e)).link,n=t?AB(RB(t)).deep_link_id:null,r=AB(RB(e)).deep_link_id;return(r?AB(RB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),WW=function(){var e=function(){function e(){Zg(this,e),this.providerId=e.PROVIDER_ID}return Wg(e,null,[{key:"credential",value:function(e,t){return GW._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=qW.parseLink(t);return Eq(n,"argument-error"),GW._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),jW=function(){function e(t){Zg(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return Wg(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),YW=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).scopes=[],e}return Wg(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return Bg(this.scopes)}}]),n}(jW),KW=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return Wg(n,null,[{key:"credential",value:function(e,t){return ZW._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(YW);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function QW(e,t){return XW.apply(this,arguments)}function XW(){return XW=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",zq(t,"POST","/v1/accounts:signUp",Lq(t,n)));case 1:case"end":return e.stop()}},e)})),XW.apply(this,arguments)}var JW=function(){function e(t){Zg(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return Wg(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,hW._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=ej(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=ej(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function ej(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var tj=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o,s;return Zg(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(Fg(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return Wg(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(EB);function nj(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?tj._fromErrorAndOperation(e,n,t,r):n})}function rj(e,t){return ij.apply(this,arguments)}function ij(){return ij=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Jq,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",JW._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),ij.apply(this,arguments)}function aj(){return aj=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,Jq(t,nj(a,o,n,t),r);case 5:return Eq((s=e.sent).idToken,a,"internal-error"),Eq(u=Xq(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(Eq(t.uid===c,a,"user-mismatch"),JW._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&kq(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),aj.apply(this,arguments)}function oj(e,t){return sj.apply(this,arguments)}function sj(){return sj=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,nj(t,i,n);case 4:return a=e.sent,e.next=7,JW._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),sj.apply(this,arguments)}function uj(){return uj=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oj(IW(t),n));case 1:case"end":return e.stop()}},e)})),uj.apply(this,arguments)}function cj(e,t,n){var r;Eq((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Eq(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Eq(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Eq(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function lj(){return lj=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=DB(t),a={requestType:"PASSWORD_RESET",email:n},r&&cj(i,a,r),e.next=4,UW(i,a);case 4:case"end":return e.stop()}},e)})),lj.apply(this,arguments)}function fj(){return fj=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=IW(t),e.next=3,QW(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,JW._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),fj.apply(this,arguments)}function hj(){return hj=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=DB(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&cj(r.auth,i,n),e.next=8,LW(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),hj.apply(this,arguments)}function dj(e,t){return vj.apply(this,arguments)}function vj(){return vj=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),vj.apply(this,arguments)}function pj(){return pj=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=DB(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,Jq(a,dj(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),pj.apply(this,arguments)}new WeakMap;var gj="__sak",yj=function(){function e(t,n){Zg(this,e),this.storageRetriever=t,this.type=n}return Wg(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(gj,"1"),this.storage.removeItem(gj),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),mj=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=gB();return mW(e)||EW(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=SW(),e._shouldAllowMigration=!0,e}return Wg(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);CB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Rg(Vg(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Rg(Vg(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Rg(Vg(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(yj);return e.type="LOCAL",e}(),kj=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return Wg(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(yj);return e.type="SESSION",e}(),Cj=function(){var e=function(){function e(t){Zg(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return Wg(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function wj(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var _j=function(){function e(t){Zg(this,e),this.target=t,this.handlers=new Set}return Wg(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=wj("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function bj(){return window}function Ej(){return void 0!==bj().WorkerGlobalScope&&"function"==typeof bj().importScripts}function Sj(){return(Sj=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var Pj="firebaseLocalStorageDb",Oj="firebaseLocalStorage",Tj="fbase_key",Ij=function(){function e(t){Zg(this,e),this.request=t}return Wg(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function Aj(e,t){return e.transaction([Oj],t?"readwrite":"readonly").objectStore(Oj)}function Rj(){var e=indexedDB.open(Pj,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(Oj,{keyPath:Tj})}catch(r){n(r)}}),e.addEventListener("success",aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(Oj)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(Pj);return new Ij(e).toPromise()}();case 8:return n.t0=t,n.next=11,Rj();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function xj(e,t,n){return Mj.apply(this,arguments)}function Mj(){return Mj=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Aj(t,!0).put((Sg(i={},Tj,n),Sg(i,"value",r),i)),e.abrupt("return",new Ij(a).toPromise());case 2:case"end":return e.stop()}},e)})),Mj.apply(this,arguments)}function Nj(){return Nj=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Aj(t,!1).get(n),e.next=3,new Ij(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),Nj.apply(this,arguments)}function Dj(e,t){var n=Aj(e,!0).delete(t);return new Ij(n).toPromise()}var Lj=function(){var e=function(){function e(){Zg(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return Wg(e,[{key:"_openDb",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,Rj();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ej()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=Cj._getInstance(Ej()?self:null),e.receiver._subscribe("keyChanged",function(){var t=aB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return Sj.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new _j(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Rj();case 5:return t=e.sent,e.next=8,xj(t,gj,"1");case 8:return e.next=10,Dj(t,gj);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return xj(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return Nj.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return Dj(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=Aj(e,!1).getAll();return new Ij(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Gg(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function Fj(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function Uj(e,t){return t?Tq(t):(Eq(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Fj("rcb"),new Rq(3e4,6e4);var Vj=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,"custom","custom")).params=e,r}return Wg(n,[{key:"_getIdTokenResponse",value:function(e){return HW(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return HW(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return HW(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(RW);function Bj(e){return oj(e.auth,new Vj(e),e.bypassAuthState)}function zj(e){var t=e.auth,n=e.user;return Eq(n,t,"internal-error"),function(e,t){return aj.apply(this,arguments)}(n,new Vj(e),e.bypassAuthState)}function Gj(e){return Hj.apply(this,arguments)}function Hj(){return Hj=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(Eq(r,n,"internal-error"),rj(r,new Vj(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),Hj.apply(this,arguments)}var $j=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Zg(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return Wg(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=aB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bj;case"linkViaPopup":case"linkViaRedirect":return Gj;case"reauthViaPopup":case"reauthViaRedirect":return zj;default:kq(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Pq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Pq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),Zj=new Rq(2e3,1e4);function qj(){return qj=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=IW(t),_q(t,n,jW),a=Uj(i,r),e.abrupt("return",new Wj(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),qj.apply(this,arguments)}var Wj=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=Fg(s),s}return Wg(n,[{key:"executeNotNull",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(Eq(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Pq(1===e.filter.length,"Popup operations only handle one event"),n=wj(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(Cq(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Cq(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(Cq(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,Zj.get())}()}}]),n}($j);return e.currentPopupAction=null,e}(),jj=new Map,Yj=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Zg(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return Wg(n,[{key:"execute",value:function(){var e=this,t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=jj.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return Kj.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,Rg(Vg(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:jj.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||jj.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return Rg(Vg(n.prototype),"onAuthEvent",t)},i=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}($j);function Kj(){return Kj=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Jj(n),i=Xj(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),Kj.apply(this,arguments)}function Qj(e,t){jj.set(e._key(),t)}function Xj(e){return Tq(e._redirectPersistence)}function Jj(e){return vW("pendingRedirect",e.config.apiKey,e.name)}function eY(e,t){return tY.apply(this,arguments)}function tY(){return tY=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=IW(t),a=Uj(i,n),e.next=5,new Yj(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),tY.apply(this,arguments)}var nY=function(){function e(t){Zg(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return Wg(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iY(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!iY(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Cq(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rY(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(rY(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function rY(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function iY(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function aY(e){return oY.apply(this,arguments)}function oY(){return oY=aB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Fq(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),oY.apply(this,arguments)}var sY=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uY=/^https?/;function cY(){return cY=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,aY(t);case 4:n=e.sent,r=n.authorizedDomains,i=Gg(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!lY(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:kq(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),cY.apply(this,arguments)}function lY(e){var t=Iq(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!uY.test(r))return!1;if(sY.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var fY=new Rq(3e4,6e4);function hY(){var e=bj().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=Bg(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var dY=null;function vY(e){return dY=dY||function(e){return new Promise(function(t,n){var r,i,a;function o(){hY(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){hY(),n(Cq(e,"network-request-failed"))},timeout:fY.get()})}if(null===(i=null===(r=bj().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=bj().gapi)||void 0===a?void 0:a.load)){var s=Fj("iframefcb");return bj()[s]=function(){gapi.load?o():n(Cq(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=Cq("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw dY=null,e})}(e),dY}var pY=new Rq(5e3,15e3),gY={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yY=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mY(e){var t=e.config;Eq(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?xq(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:_z},i=yY.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(IB(r).slice(1))}function kY(){return kY=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vY(t);case 2:return n=e.sent,r=bj().gapi,e.abrupt("return",(Eq(r,t,"internal-error"),n.open({where:document.body,url:mY(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gY,dontclear:!0},function(e){return new Promise((n=aB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){bj().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=Cq(t,"network-request-failed"),o=bj().setTimeout(function(){i(a)},pY.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),kY.apply(this,arguments)}var CY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wY=function(){function e(t){Zg(this,e),this.window=t,this.associatedEvent=null}return Wg(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function _Y(e,t,n,r,i,a){Eq(e.config.authDomain,e,"auth-domain-config-required"),Eq(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:_z,eventId:i};if(t instanceof jW){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Pg(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof YW){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?xq(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(IB(d).slice(1))}var bY="webStorageSupport",EY=function(){function e(){Zg(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kj,this._completeRedirectFn=eY,this._overrideRedirectResult=Qj}return Wg(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return Pq(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=_Y(e,t,n,Iq(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},CY),{width:r.toString(),height:i.toString(),top:a,left:o}),c=gB().toLowerCase();n&&(s=kW(c)?"_blank":n),yW(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Pg(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gB();return EW(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new wY(null);var f=window.open(t||"",s,l);Eq(f,e,"popup-blocked");try{f.focus()}catch(h){}return new wY(f)}(e,s,wj()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){bj().location.href=e}(_Y(e,t,n,Iq(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(Pq(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return kY.apply(this,arguments)}(e);case 2:return r=n.sent,i=new nY(e),n.abrupt("return",(r.register("authEvent",function(t){return Eq(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(bY,{type:bY},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[bY];void 0!==i&&t(!!i),kq(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return cY.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return SW()||mW()||EW()}}]),e}(),SY="@firebase/auth",PY=function(){function e(t){Zg(this,e),this.auth=t,this.internalListeners=new Map}return Wg(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){Eq(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){mz(new UB("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){Eq(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),Eq(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PW(e)},a=new TW(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Tq);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),mz(new UB("auth-internal",function(e){var t=IW(e.getProvider("auth").getImmediate());return new PY(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sz(SY,"0.20.5",void 0),Sz(SY,"0.20.5","esm2017")}("Browser");var OY=Wg(function e(t){return Zg(this,e),t}),TY=Wg(function e(){return Zg(this,e),mZ("auth")}),IY=new YC("angularfire2.auth-instances");function AY(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new OY(r)}}var RY,xY={provide:TY,deps:[[new bw,IY]]},MY={provide:OY,useFactory:function(e,t){var n=yZ("auth",e,t);return n&&new OY(n)},deps:[[new bw,IY],IZ]},NY=function(){var e=Wg(function e(){Zg(this,e),Sz("angularfire",lZ.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[MY,xY]}),e}(),DY=TZ(function(e,t,n){return fj.apply(this,arguments)},!0),LY=TZ(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bz(),t=kz(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=kz(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(OB(n.getOptions(),null!=t?t:{}))return r;kq(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:EY,persistence:[Lj,mj,kj]})},!0),FY=TZ(function(e,t,n,r){return DB(e).onAuthStateChanged(t,n,r)},!0),UY=TZ(function(e,t){return hj.apply(this,arguments)},!0),VY=TZ(function(e,t,n){return lj.apply(this,arguments)},!0),BY=TZ(function(e,t,n){return function(e,t){return uj.apply(this,arguments)}(DB(e),WW.credential(t,n))},!0),zY=TZ(function(e,t,n){return qj.apply(this,arguments)},!0),GY=TZ(function(e,t){return pj.apply(this,arguments)},!0),HY="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$Y={},ZY=ZY||{},qY=HY||self;function WY(){}function jY(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function YY(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var KY="closure_uid_"+(1e9*Math.random()>>>0),QY=0;function XY(e,t,n){return e.call.apply(e.bind,arguments)}function JY(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function eK(e,t,n){return(eK=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?XY:JY).apply(null,arguments)}function tK(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function nK(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function rK(){this.s=this.s,this.o=this.o}var iK={};rK.prototype.s=!1,rK.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,KY)&&e[KY]||(e[KY]=++QY)}(this);delete iK[e]}},rK.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var aK=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},oK=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function sK(e){return Array.prototype.concat.apply([],arguments)}function uK(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function cK(e){return/^[\s\xa0]*$/.test(e)}var lK,fK=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function hK(e,t){return-1!=e.indexOf(t)}function dK(e,t){return e<t?-1:e>t?1:0}e:{var vK=qY.navigator;if(vK){var pK=vK.userAgent;if(pK){lK=pK;break e}}lK=""}function gK(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function yK(e){var t={};for(var n in e)t[n]=e[n];return t}var mK="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kK(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<mK.length;a++)n=mK[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function CK(e){return CK[" "](e),e}CK[" "]=WY;var wK,_K=hK(lK,"Opera"),bK=hK(lK,"Trident")||hK(lK,"MSIE"),EK=hK(lK,"Edge"),SK=EK||bK,PK=hK(lK,"Gecko")&&!(hK(lK.toLowerCase(),"webkit")&&!hK(lK,"Edge"))&&!(hK(lK,"Trident")||hK(lK,"MSIE"))&&!hK(lK,"Edge"),OK=hK(lK.toLowerCase(),"webkit")&&!hK(lK,"Edge");function TK(){var e=qY.document;return e?e.documentMode:void 0}e:{var IK="",AK=function(){var e=lK;return PK?/rv:([^\);]+)(\)|;)/.exec(e):EK?/Edge\/([\d\.]+)/.exec(e):bK?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):OK?/WebKit\/(\S+)/.exec(e):_K?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(AK&&(IK=AK?AK[1]:""),bK){var RK=TK();if(null!=RK&&RK>parseFloat(IK)){wK=String(RK);break e}}wK=IK}var xK={};var MK=qY.document&&bK&&(TK()||parseInt(wK,10))||void 0,NK=function(){if(!qY.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{qY.addEventListener("test",WY,t),qY.removeEventListener("test",WY,t)}catch(n){}return e}();function DK(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function LK(e,t){if(DK.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(PK){e:{try{CK(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:FK[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&LK.Z.h.call(this)}}DK.prototype.h=function(){this.defaultPrevented=!0},nK(LK,DK);var FK={2:"touch",3:"pen",4:"mouse"};LK.prototype.h=function(){LK.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var UK="closure_listenable_"+(1e6*Math.random()|0),VK=0;function BK(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++VK,this.ca=this.fa=!1}function zK(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function GK(e){this.src=e,this.g={},this.h=0}function HK(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=aK(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(zK(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $K(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}GK.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=$K(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new BK(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var ZK="closure_lm_"+(1e6*Math.random()|0),qK={};function WK(e,t,n,r,i){if(r&&r.once)return YK(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)WK(e,t[a],n,r,i);return null}return n=nQ(n),e&&e[UK]?e.N(t,n,YY(r)?!!r.capture:!!r,i):jK(e,t,n,!1,r,i)}function jK(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=YY(i)?!!i.capture:!!i,s=eQ(e);if(s||(e[ZK]=s=new GK(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=JK;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)NK||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(XK(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function YK(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)YK(e,t[a],n,r,i);return null}return n=nQ(n),e&&e[UK]?e.O(t,n,YY(r)?!!r.capture:!!r,i):jK(e,t,n,!0,r,i)}function KK(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)KK(e,t[a],n,r,i);else r=YY(r)?!!r.capture:!!r,n=nQ(n),e&&e[UK]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=$K(a=e.g[t],n,r,i))&&(zK(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=eQ(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$K(t,n,r,i)),(n=-1<e?t[e]:null)&&QK(n))}function QK(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[UK])HK(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(XK(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=eQ(t))?(HK(n,e),0==n.h&&(n.src=null,t[ZK]=null)):zK(e)}}}function XK(e){return e in qK?qK[e]:qK[e]="on"+e}function JK(e,t){if(e.ca)e=!0;else{t=new LK(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&QK(e),e=n.call(r,t)}return e}function eQ(e){return(e=e[ZK])instanceof GK?e:null}var tQ="__closure_events_fn_"+(1e9*Math.random()>>>0);function nQ(e){return"function"==typeof e?e:(e[tQ]||(e[tQ]=function(t){return e.handleEvent(t)}),e[tQ])}function rQ(){rK.call(this),this.i=new GK(this),this.P=this,this.I=null}function iQ(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new DK(t,e);else if(t instanceof DK)t.target=t.target||e;else{var i=t;kK(t=new DK(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=aQ(o,r,!0,t)&&i}if(i=aQ(o=t.g=e,r,!0,t)&&i,i=aQ(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=aQ(o=t.g=n[a],r,!1,t)&&i}function aQ(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&HK(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}nK(rQ,rK),rQ.prototype[UK]=!0,rQ.prototype.removeEventListener=function(e,t,n,r){KK(this,e,t,n,r)},rQ.prototype.M=function(){if(rQ.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)zK(n[r]);delete t.g[e],t.h--}}this.I=null},rQ.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},rQ.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var oQ=qY.JSON.stringify;function sQ(){var e=vQ,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var uQ,cQ=new(function(){function e(t,n){Zg(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return Wg(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new lQ},function(e){return e.reset()}),lQ=function(){function e(){Zg(this,e),this.next=this.g=this.h=null}return Wg(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function fQ(e){qY.setTimeout(function(){throw e},0)}function hQ(e,t){uQ||function(){var e=qY.Promise.resolve(void 0);uQ=function(){e.then(pQ)}}(),dQ||(uQ(),dQ=!0),vQ.add(e,t)}var dQ=!1,vQ=new(function(){function e(){Zg(this,e),this.h=this.g=null}return Wg(e,[{key:"add",value:function(e,t){var n=cQ.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function pQ(){for(var e;e=sQ();){try{e.h.call(e.g)}catch(n){fQ(n)}var t=cQ;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}dQ=!1}function gQ(e,t){rQ.call(this),this.h=e||1,this.g=t||qY,this.j=eK(this.kb,this),this.l=Date.now()}function yQ(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function mQ(e,t,n){if("function"==typeof e)n&&(e=eK(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=eK(e.handleEvent,e)}return 2147483647<Number(t)?-1:qY.setTimeout(e,t||0)}function kQ(e){e.g=mQ(function(){e.g=null,e.i&&(e.i=!1,kQ(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}nK(gQ,rQ),(RY=gQ.prototype).da=!1,RY.S=null,RY.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),iQ(this,"tick"),this.da&&(yQ(this),this.start()))}},RY.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},RY.M=function(){gQ.Z.M.call(this),yQ(this),delete this.g};var CQ=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return Wg(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:kQ(this)}},{key:"M",value:function(){Rg(Vg(n.prototype),"M",this).call(this),this.g&&(qY.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(rK);function wQ(e){rK.call(this),this.h=e,this.g={}}nK(wQ,rK);var _Q=[];function bQ(e,t,n,r){Array.isArray(n)||(n&&(_Q[0]=n.toString()),n=_Q);for(var i=0;i<n.length;i++){var a=WK(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function EQ(e){gK(e.g,function(e,t){this.g.hasOwnProperty(t)&&QK(e)},e),e.g={}}function SQ(){this.g=!0}function PQ(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return oQ(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}wQ.prototype.M=function(){wQ.Z.M.call(this),EQ(this)},wQ.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},SQ.prototype.Aa=function(){this.g=!1},SQ.prototype.info=function(){};var OQ={},TQ=null;function IQ(){return TQ=TQ||new rQ}function AQ(e){DK.call(this,OQ.Ma,e)}function RQ(e){var t=IQ();iQ(t,new AQ(t,e))}function xQ(e,t){DK.call(this,OQ.STAT_EVENT,e),this.stat=t}function MQ(e){var t=IQ();iQ(t,new xQ(t,e))}function NQ(e,t){DK.call(this,OQ.Na,e),this.size=t}function DQ(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return qY.setTimeout(function(){e()},t)}OQ.Ma="serverreachability",nK(AQ,DK),OQ.STAT_EVENT="statevent",nK(xQ,DK),OQ.Na="timingevent",nK(NQ,DK);var LQ={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},FQ={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function UQ(){}function VQ(){}UQ.prototype.h=null;var BQ,zQ={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function GQ(){DK.call(this,"d")}function HQ(){DK.call(this,"c")}function $Q(){}function ZQ(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new wQ(this),this.P=WQ,this.W=new gQ(e=SK?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new qQ}function qQ(){this.i=null,this.g="",this.h=!1}nK(GQ,DK),nK(HQ,DK),nK($Q,UQ),$Q.prototype.g=function(){return new XMLHttpRequest},$Q.prototype.i=function(){return{}},BQ=new $Q;var WQ=45e3,jQ={},YQ={};function KQ(e,t,n){e.K=1,e.v=kX(dX(t)),e.s=n,e.U=!0,QQ(e,null)}function QQ(e,t){e.F=Date.now(),tX(e),e.A=dX(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),xX(n.h,"t",r),e.C=0,n=e.l.H,e.h=new qQ,e.g=xJ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new CQ(eK(e.Ia,e,e.g),e.O)),bQ(e.V,e.g,"readystatechange",e.gb),t=e.H?yK(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),RQ(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function XQ(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function JQ(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=eX(e,n))==YQ){4==t&&(e.o=4,MQ(14),i=!1),PQ(e.j,e.m,null,"[Incomplete Response]");break}if(r==jQ){e.o=4,MQ(15),PQ(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}PQ(e.j,e.m,r,null),oX(e,r)}XQ(e)&&r!=YQ&&r!=jQ&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,MQ(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),EJ(t),t.L=!0,MQ(11))):(PQ(e.j,e.m,n,"[Invalid Chunked Response]"),aX(e),iX(e))}function eX(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?YQ:(n=Number(t.substring(n,r)),isNaN(n)?jQ:(r+=1)+n>t.length?YQ:(t=t.substr(r,n),e.C=r+n,t))}function tX(e){e.Y=Date.now()+e.P,nX(e,e.P)}function nX(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=DQ(eK(e.eb,e),t)}function rX(e){e.B&&(qY.clearTimeout(e.B),e.B=null)}function iX(e){0==e.l.G||e.I||OJ(e.l,e)}function aX(e){rX(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,yQ(e.W),EQ(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function oX(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||UX(n.i,e)))if(n.I=e.N,!e.J&&UX(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=DQ(eK(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;PJ(n),pJ(n)}bJ(n),MQ(18)}if(1>=FX(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else IJ(n,11)}else if((e.J||n.g==e)&&PJ(n),!cK(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(hK(l,"spdy")||hK(l,"quic")||hK(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(VX(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,mX(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=RJ(r,r.H?r.la:null,r.W),d.J){BX(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(rX(v),tX(v)),r.g=d}else _J(r);0<n.l.length&&mJ(n)}else"stop"!=a[0]&&"close"!=a[0]||IJ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?IJ(n,7):vJ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}RQ(4)}catch(m){}}function sX(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(jY(e)||"string"==typeof e)oK(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(jY(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(jY(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function uX(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof uX)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function cX(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];lX(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)lX(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function lX(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(RY=ZQ.prototype).setTimeout=function(e){this.P=e},RY.gb=function(e){e=e.target;var t=this.L;t&&3==cJ(e)?t.l():this.Ia(e)},RY.Ia=function(e){try{if(e==this.g)e:{var t=cJ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||SK||this.g&&(this.h.h||this.g.ga()||lJ(this.g)))){this.I||4!=t||7==n||RQ(8==n||0>=r?3:2),rX(this);var i=this.g.ba();this.N=i;t:if(XQ(this)){var a=lJ(this.g);e="";var o=a.length,s=4==cJ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){aX(this),iX(this);var u="";break t}this.h.i=new qY.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!cK(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,MQ(12),aX(this),iX(this);break e}PQ(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,oX(this,i)}this.U?(JQ(this,t,u),SK&&this.i&&3==t&&(bQ(this.V,this.W,"tick",this.fb),this.W.start())):(PQ(this.j,this.m,u,null),oX(this,u)),4==t&&aX(this),this.i&&!this.I&&(4==t?OJ(this.l,this):(this.i=!1,tX(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,MQ(12)):(this.o=0,MQ(13)),aX(this),iX(this)}}}catch(h){}},RY.fb=function(){if(this.g){var e=cJ(this.g),t=this.g.ga();this.C<t.length&&(rX(this),JQ(this,e,t),this.i&&4!=e&&tX(this))}},RY.cancel=function(){this.I=!0,aX(this)},RY.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(RQ(3),MQ(17)),aX(this),this.o=2,iX(this)):nX(this,this.Y-e)},(RY=uX.prototype).R=function(){cX(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},RY.T=function(){return cX(this),this.g.concat()},RY.get=function(e,t){return lX(this.h,e)?this.h[e]:t},RY.set=function(e,t){lX(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},RY.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var fX=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function hX(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof hX){this.g=void 0!==t?t:e.g,vX(this,e.j),this.s=e.s,pX(this,e.i),gX(this,e.m),this.l=e.l,t=e.h;var n=new TX;n.i=t.i,t.g&&(n.g=new uX(t.g),n.h=t.h),yX(this,n),this.o=e.o}else e&&(n=String(e).match(fX))?(this.g=!!t,vX(this,n[1]||"",!0),this.s=CX(n[2]||""),pX(this,n[3]||"",!0),gX(this,n[4]),this.l=CX(n[5]||"",!0),yX(this,n[6]||"",!0),this.o=CX(n[7]||"")):(this.g=!!t,this.h=new TX(null,this.g))}function dX(e){return new hX(e)}function vX(e,t,n){e.j=n?CX(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function pX(e,t,n){e.i=n?CX(t,!0):t}function gX(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function yX(e,t,n){t instanceof TX?(e.h=t,function(e,t){t&&!e.j&&(IX(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(AX(this,t),xX(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=wX(t,PX)),e.h=new TX(t,e.g))}function mX(e,t,n){e.h.set(t,n)}function kX(e){return mX(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function CX(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function wX(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,_X),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function _X(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}hX.prototype.toString=function(){var e=[],t=this.j;t&&e.push(wX(t,bX,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(wX(t,bX,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(wX(n,"/"==n.charAt(0)?SX:EX,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",wX(n,OX)),e.join("")};var bX=/[#\/\?@]/g,EX=/[#\?:]/g,SX=/[#\?]/g,PX=/[#\?@]/g,OX=/#/g;function TX(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function IX(e){e.g||(e.g=new uX,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function AX(e,t){IX(e),t=MX(e,t),lX(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,lX((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&cX(e)))}function RX(e,t){return IX(e),t=MX(e,t),lX(e.g.h,t)}function xX(e,t,n){AX(e,t),0<n.length&&(e.i=null,e.g.set(MX(e,t),uK(n)),e.h+=n.length)}function MX(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function NX(e){this.l=e||DX,e=qY.PerformanceNavigationTiming?0<(e=qY.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(qY.g&&qY.g.Ea&&qY.g.Ea()&&qY.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(RY=TX.prototype).add=function(e,t){IX(this),this.i=null,e=MX(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},RY.forEach=function(e,t){IX(this),this.g.forEach(function(n,r){oK(n,function(n){e.call(t,n,r,this)},this)},this)},RY.T=function(){IX(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},RY.R=function(e){IX(this);var t=[];if("string"==typeof e)RX(this,e)&&(t=sK(t,this.g.get(MX(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=sK(t,e[n])}return t},RY.set=function(e,t){return IX(this),this.i=null,RX(this,e=MX(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},RY.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},RY.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var DX=10;function LX(e){return!!e.h||!!e.g&&e.g.size>=e.j}function FX(e){return e.h?1:e.g?e.g.size:0}function UX(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function VX(e,t){e.g?e.g.add(t):e.h=t}function BX(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function zX(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Gg(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return uK(e.i)}function GX(){}function HX(){this.g=new GX}function $X(e,t,n){var r=n||"";try{sX(e,function(e,n){var i=e;YY(e)&&(i=oQ(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function ZX(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function qX(e){this.l=e.$b||null,this.j=e.ib||!1}function WX(e,t){rQ.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=jX,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}NX.prototype.cancel=function(){if(this.i=zX(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Gg(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},GX.prototype.stringify=function(e){return qY.JSON.stringify(e,void 0)},GX.prototype.parse=function(e){return qY.JSON.parse(e,void 0)},nK(qX,UQ),qX.prototype.g=function(){return new WX(this.l,this.j)},qX.prototype.i=function(e){return function(){return e}}({}),nK(WX,rQ);var jX=0;function YX(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function KX(e){e.readyState=4,e.l=null,e.j=null,e.A=null,QX(e)}function QX(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(RY=WX.prototype).open=function(e,t){if(this.readyState!=jX)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,QX(this)},RY.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||qY).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},RY.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,KX(this)),this.readyState=jX},RY.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,QX(this)),this.g&&(this.readyState=3,QX(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==qY.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;YX(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},RY.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?KX(this):QX(this),3==this.readyState&&YX(this)}},RY.Ua=function(e){this.g&&(this.response=this.responseText=e,KX(this))},RY.Ta=function(e){this.g&&(this.response=e,KX(this))},RY.ha=function(){this.g&&KX(this)},RY.setRequestHeader=function(e,t){this.v.append(e,t)},RY.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},RY.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(WX.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var XX=qY.JSON.parse;function JX(e){rQ.call(this),this.headers=new uX,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=eJ,this.K=this.L=!1}nK(JX,rQ);var eJ="",tJ=/^https?$/i,nJ=["POST","PUT"];function rJ(e){return"content-type"==e.toLowerCase()}function iJ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,aJ(e),sJ(e)}function aJ(e){e.D||(e.D=!0,iQ(e,"complete"),iQ(e,"error"))}function oJ(e){if(e.h&&void 0!==ZY&&(!e.C[1]||4!=cJ(e)||2!=e.ba()))if(e.v&&4==cJ(e))mQ(e.Fa,0,e);else if(iQ(e,"readystatechange"),4==cJ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(fX)[1]||null;if(!a&&qY.self&&qY.self.location){var o=qY.self.location.protocol;a=o.substr(0,o.length-1)}i=!tJ.test(a?a.toLowerCase():"")}t=i}if(t)iQ(e,"complete"),iQ(e,"success");else{e.m=6;try{var s=2<cJ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",aJ(e)}}finally{sJ(e)}}}function sJ(e,t){if(e.g){uJ(e);var n=e.g,r=e.C[0]?WY:null;e.g=null,e.C=null,t||iQ(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function uJ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(qY.clearTimeout(e.A),e.A=null)}function cJ(e){return e.g?e.g.readyState:0}function lJ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case eJ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function fJ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return gK(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):mX(e,t,n))}function hJ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function dJ(e){this.za=0,this.l=[],this.h=new SQ,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=hJ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=hJ("baseRetryDelayMs",5e3,e),this.$a=hJ("retryDelaySeedMs",1e4,e),this.Ya=hJ("forwardChannelMaxRetries",2,e),this.ra=hJ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new NX(e&&e.concurrentRequestLimit),this.Ca=new HX,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function vJ(e){if(gJ(e),3==e.G){var t=e.V++,n=dX(e.F);mX(n,"SID",e.J),mX(n,"RID",t),mX(n,"TYPE","terminate"),CJ(e,n),(t=new ZQ(e,e.h,t,void 0)).K=2,t.v=kX(dX(n)),n=!1,qY.navigator&&qY.navigator.sendBeacon&&(n=qY.navigator.sendBeacon(t.v.toString(),"")),!n&&qY.Image&&((new Image).src=t.v,n=!0),n||(t.g=xJ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),tX(t)}AJ(e)}function pJ(e){e.g&&(EJ(e),e.g.cancel(),e.g=null)}function gJ(e){pJ(e),e.u&&(qY.clearTimeout(e.u),e.u=null),PJ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&qY.clearTimeout(e.m),e.m=null)}function yJ(e,t){e.l.push(new(function(){return Wg(function e(t,n){Zg(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&mJ(e)}function mJ(e){LX(e.i)||e.m||(e.m=!0,hQ(e.Ha,e),e.C=0)}function kJ(e,t){var n;n=t?t.m:e.V++;var r=dX(e.F);mX(r,"SID",e.J),mX(r,"RID",n),mX(r,"AID",e.U),CJ(e,r),e.o&&e.s&&fJ(r,e.o,e.s),n=new ZQ(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=wJ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),VX(e.i,n),KQ(n,r,t)}function CJ(e,t){e.j&&sX({},function(e,n){mX(t,n,e)})}function wJ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?eK(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{$X(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function _J(e){e.g||e.u||(e.Y=1,hQ(e.Ga,e),e.A=0)}function bJ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=DQ(eK(e.Ga,e),TJ(e,e.A)),e.A++,0))}function EJ(e){null!=e.B&&(qY.clearTimeout(e.B),e.B=null)}function SJ(e){e.g=new ZQ(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=dX(e.oa);mX(t,"RID","rpc"),mX(t,"SID",e.J),mX(t,"CI",e.N?"0":"1"),mX(t,"AID",e.U),CJ(e,t),mX(t,"TYPE","xmlhttp"),e.o&&e.s&&fJ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=kX(dX(t)),n.s=null,n.U=!0,QQ(n,e)}function PJ(e){null!=e.v&&(qY.clearTimeout(e.v),e.v=null)}function OJ(e,t){var n=null;if(e.g==t){PJ(e),EJ(e),e.g=null;var r=2}else{if(!UX(e.i,t))return;n=t.D,BX(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;iQ(r=IQ(),new NQ(r,n,t,i)),mJ(e)}else _J(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(FX(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=DQ(eK(e.Ha,e,t),TJ(e,e.C)),e.C++,0)))}(e,t)||2==r&&bJ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:IJ(e,5);break;case 4:IJ(e,10);break;case 3:IJ(e,6);break;default:IJ(e,2)}}function TJ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function IJ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=eK(e.jb,e);n||(n=new hX("//www.google.com/images/cleardot.gif"),qY.location&&"http"==qY.location.protocol||vX(n,"https"),kX(n)),function(e,t){var n=new SQ;if(qY.Image){var r=new Image;r.onload=tK(ZX,n,r,"TestLoadImage: loaded",!0,t),r.onerror=tK(ZX,n,r,"TestLoadImage: error",!1,t),r.onabort=tK(ZX,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=tK(ZX,n,r,"TestLoadImage: timeout",!1,t),qY.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else MQ(2);e.G=0,e.j&&e.j.va(t),AJ(e),gJ(e)}function AJ(e){e.G=0,e.I=-1,e.j&&((0!=zX(e.i).length||0!=e.l.length)&&(e.i.i.length=0,uK(e.l),e.l.length=0),e.j.ua())}function RJ(e,t,n){var r=function(e){return e instanceof hX?dX(e):new hX(e,void 0)}(n);if(""!=r.i)t&&pX(r,t+"."+r.i),gX(r,r.m);else{var i=qY.location;r=function(e,t,n,r){var i=new hX(null,void 0);return e&&vX(i,e),t&&pX(i,t),n&&gX(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&gK(e.aa,function(e,t){mX(r,t,e)}),n=e.sa,(t=e.D)&&n&&mX(r,t,n),mX(r,"VER",e.ma),CJ(e,r),r}function xJ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new JX(n&&e.Ba&&!e.qa?new qX({ib:!0}):e.qa)).L=e.H,t}function MJ(){}function NJ(){if(bK&&!(10<=Number(MK)))throw Error("Environmental error: no available transport.")}function DJ(e,t){rQ.call(this),this.g=new dJ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!cK(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!cK(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new UJ(this)}function LJ(e){GQ.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function FJ(){HQ.call(this),this.status=1}function UJ(e){this.g=e}(RY=JX.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():BQ.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:BQ),this.g.onreadystatechange=eK(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void iJ(this,a)}e=n||"";var i=new uX(this.headers);r&&sX(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=rJ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=qY.FormData&&e instanceof qY.FormData,!(0<=aK(nJ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{uJ(this),0<this.B&&((this.K=function(e){return bK&&function(){return e=xK,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=fK(String(wK)).split("."),n=fK("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=dK(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||dK(0==a[2].length,0==o[2].length)||dK(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=eK(this.pa,this)):this.A=mQ(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){iJ(this,a)}},RY.pa=function(){void 0!==ZY&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,iQ(this,"timeout"),this.abort(8))},RY.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,iQ(this,"complete"),iQ(this,"abort"),sJ(this))},RY.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),sJ(this,!0)),JX.Z.M.call(this)},RY.Fa=function(){this.s||(this.F||this.v||this.l?oJ(this):this.cb())},RY.cb=function(){oJ(this)},RY.ba=function(){try{return 2<cJ(this)?this.g.status:-1}catch(e){return-1}},RY.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},RY.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),XX(t)}},RY.Da=function(){return this.m},RY.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(RY=dJ.prototype).ma=8,RY.G=1,RY.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},RY.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new ZQ(this,this.h,e,void 0),n=this.s;if(this.P&&(n?kK(n=yK(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=wJ(this,t,r),mX(i=dX(this.F),"RID",e),mX(i,"CVER",22),this.D&&mX(i,"X-HTTP-Session-Id",this.D),CJ(this,i),this.o&&n&&fJ(i,this.o,n),VX(this.i,t),this.Ra&&mX(i,"TYPE","init"),this.ja?(mX(i,"$req",r),mX(i,"SID","null"),t.$=!0,KQ(t,i,null)):KQ(t,i,r),this.G=2}}else 3==this.G&&(e?kJ(this,e):0==this.l.length||LX(this.i)||kJ(this))},RY.Ga=function(){if(this.u=null,SJ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=DQ(eK(this.bb,this),e)}},RY.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,MQ(10),pJ(this),SJ(this))},RY.ab=function(){null!=this.v&&(this.v=null,pJ(this),bJ(this),MQ(19))},RY.jb=function(e){e?(this.h.info("Successfully pinged google.com"),MQ(2)):(this.h.info("Failed to ping google.com"),MQ(1))},(RY=MJ.prototype).xa=function(){},RY.wa=function(){},RY.va=function(){},RY.ua=function(){},RY.Oa=function(){},NJ.prototype.g=function(e,t){return new DJ(e,t)},nK(DJ,rQ),DJ.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),hQ(eK(e.hb,e,t))),MQ(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=RJ(e,null,e.W),mJ(e)},DJ.prototype.close=function(){vJ(this.g)},DJ.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,yJ(this.g,t)}else this.v?((t={}).__data__=oQ(e),yJ(this.g,t)):yJ(this.g,e)},DJ.prototype.M=function(){this.g.j=null,delete this.j,vJ(this.g),delete this.g,DJ.Z.M.call(this)},nK(LJ,GQ),nK(FJ,HQ),nK(UJ,MJ),UJ.prototype.xa=function(){iQ(this.g,"a")},UJ.prototype.wa=function(e){iQ(this.g,new LJ(e))},UJ.prototype.va=function(e){iQ(this.g,new FJ(e))},UJ.prototype.ua=function(){iQ(this.g,"b")},NJ.prototype.createWebChannel=NJ.prototype.g,DJ.prototype.send=DJ.prototype.u,DJ.prototype.open=DJ.prototype.m,DJ.prototype.close=DJ.prototype.close,LQ.NO_ERROR=0,LQ.TIMEOUT=8,LQ.HTTP_ERROR=6,FQ.COMPLETE="complete",VQ.EventType=zQ,zQ.OPEN="a",zQ.CLOSE="b",zQ.ERROR="c",zQ.MESSAGE="d",rQ.prototype.listen=rQ.prototype.N,JX.prototype.listenOnce=JX.prototype.O,JX.prototype.getLastError=JX.prototype.La,JX.prototype.getLastErrorCode=JX.prototype.Da,JX.prototype.getStatus=JX.prototype.ba,JX.prototype.getResponseJson=JX.prototype.Qa,JX.prototype.getResponseText=JX.prototype.ga,JX.prototype.send=JX.prototype.ea;var VJ=$Y.createWebChannelTransport=function(){return new NJ},BJ=$Y.getStatEventTarget=function(){return IQ()},zJ=$Y.ErrorCode=LQ,GJ=$Y.EventType=FQ,HJ=$Y.Event=OQ,$J=$Y.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ZJ=$Y.FetchXmlHttpFactory=qX,qJ=$Y.WebChannel=VQ,WJ=$Y.XhrIo=JX,jJ="@firebase/firestore",YJ=function(){function e(t){Zg(this,e),this.uid=t}return Wg(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();YJ.UNAUTHENTICATED=new YJ(null),YJ.GOOGLE_CREDENTIALS=new YJ("google-credentials-uid"),YJ.FIRST_PARTY=new YJ("first-party-uid"),YJ.MOCK_USER=new YJ("mock-user");var KJ="9.9.0",QJ=new jB("@firebase/firestore");function XJ(){return QJ.logLevel}function JJ(e){if(QJ.logLevel<=HB.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(n1);QJ.debug.apply(QJ,["Firestore (".concat(KJ,"): ").concat(e)].concat(Bg(i)))}}function e1(e){if(QJ.logLevel<=HB.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(n1);QJ.error.apply(QJ,["Firestore (".concat(KJ,"): ").concat(e)].concat(Bg(i)))}}function t1(e){if(QJ.logLevel<=HB.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(n1);QJ.warn.apply(QJ,["Firestore (".concat(KJ,"): ").concat(e)].concat(Bg(i)))}}function n1(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function r1(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(KJ,") INTERNAL ASSERTION FAILED: ")+e;throw e1(t),new Error(t)}function i1(e,t){e||r1()}function a1(e,t){return e}var o1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},s1=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return Wg(n)}(EB),u1=Wg(function e(){var t=this;Zg(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),c1=Wg(function e(t,n){Zg(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),l1=function(){function e(){Zg(this,e)}return Wg(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(YJ.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),f1=function(){function e(t){Zg(this,e),this.t=t,this.currentUser=YJ.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Wg(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new u1;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new u1,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){JJ("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(JJ("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new u1)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(JJ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(i1("string"==typeof n.accessToken),new c1(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return i1(null===e||"string"==typeof e),new YJ(e)}}]),e}(),h1=Wg(function e(t,n,r){Zg(this,e),this.type="FirstParty",this.user=YJ.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),d1=function(){function e(t,n,r){Zg(this,e),this.h=t,this.l=n,this.m=r}return Wg(e,[{key:"getToken",value:function(){return Promise.resolve(new h1(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(YJ.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),v1=Wg(function e(t){Zg(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),p1=function(){function e(t){Zg(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return Wg(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&JJ("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,JJ("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){JJ("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):JJ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(i1("string"==typeof t.token),e.p=t.token,new v1(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function g1(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var y1=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=g1(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function m1(e,t){return e<t?-1:e>t?1:0}function k1(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var C1=function(){function e(t,n){if(Zg(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new s1(o1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new s1(o1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new s1(o1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new s1(o1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return Wg(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?m1(this.nanoseconds,e.nanoseconds):m1(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),w1=function(){function e(t){Zg(this,e),this.timestamp=t}return Wg(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new C1(0,0))}},{key:"max",value:function(){return new e(new C1(253402300799,999999999))}}]),e}(),_1=function(){function e(t,n,r){Zg(this,e),void 0===n?n=0:n>t.length&&r1(),void 0===r?r=t.length-n:r>t.length-n&&r1(),this.segments=t,this.offset=n,this.len=r}return Wg(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),b1=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new s1(o1.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,Bg(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(_1),E1=/^[_a-zA-Z][_a-zA-Z0-9]*$/,S1=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return E1.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new s1(o1.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new s1(o1.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new s1(o1.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new s1(o1.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(_1),P1=function(){function e(t){Zg(this,e),this.path=t}return Wg(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===b1.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(b1.fromString(t))}},{key:"fromName",value:function(t){return new e(b1.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(b1.emptyPath())}},{key:"comparator",value:function(e,t){return b1.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new b1(t.slice()))}}]),e}();function O1(e){return new T1(e.readTime,e.key,-1)}var T1=function(){function e(t,n,r){Zg(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return Wg(e,null,[{key:"min",value:function(){return new e(w1.min(),P1.empty(),-1)}},{key:"max",value:function(){return new e(w1.max(),P1.empty(),-1)}}]),e}();function I1(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=P1.comparator(e.documentKey,t.documentKey))?n:m1(e.largestBatchId,t.largestBatchId)}var A1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function R1(e){return x1.apply(this,arguments)}function x1(){return x1=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===o1.FAILED_PRECONDITION&&t.message===A1){e.next=2;break}throw t;case 2:JJ("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),x1.apply(this,arguments)}var M1=function(){function e(t){var n=this;Zg(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return Wg(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&r1(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Gg(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function N1(e){return"IndexedDbTransactionError"===e.name}var D1=function(){function e(t,n){var r=this;Zg(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return Wg(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function L1(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function F1(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function U1(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}D1.ot=-1;var V1=function(){function e(t,n){Zg(this,e),this.comparator=t,this.root=n||z1.EMPTY}return Wg(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,z1.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,z1.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new B1(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new B1(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new B1(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new B1(this.root,e,this.comparator,!0)}}]),e}(),B1=function(){function e(t,n,r,i){Zg(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return Wg(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),z1=function(){function e(t,n,r,i,a){Zg(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return Wg(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw r1();var e=this.left.check();if(e!==this.right.check())throw r1();return e+(this.isRed()?0:1)}}]),e}();z1.EMPTY=null,z1.RED=!0,z1.BLACK=!1,z1.EMPTY=new(function(){function e(){Zg(this,e),this.size=0}return Wg(e,[{key:"key",get:function(){throw r1()}},{key:"value",get:function(){throw r1()}},{key:"color",get:function(){throw r1()}},{key:"left",get:function(){throw r1()}},{key:"right",get:function(){throw r1()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new z1(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var G1=function(){function e(t){Zg(this,e),this.comparator=t,this.data=new V1(this.comparator)}return Wg(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new H1(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new H1(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),H1=function(){function e(t){Zg(this,e),this.iter=t}return Wg(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),$1=function(){function e(t){Zg(this,e),this.fields=t,t.sort(S1.comparator)}return Wg(e,[{key:"unionWith",value:function(t){var n,r=new G1(S1.comparator),i=Gg(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=Gg(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=Gg(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return k1(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),Z1=function(e){function t(e){Zg(this,t),this.binaryString=e}return Wg(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return m1(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();Z1.EMPTY_BYTE_STRING=new Z1("");var q1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function W1(e){if(i1(!!e),"string"==typeof e){var t=0,n=q1.exec(e);if(i1(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:j1(e.seconds),nanos:j1(e.nanos)}}function j1(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Y1(e){return"string"==typeof e?Z1.fromBase64String(e):Z1.fromUint8Array(e)}function K1(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Q1(e){var t=e.mapValue.fields.__previous_value__;return K1(t)?Q1(t):t}function X1(e){var t=W1(e.mapValue.fields.__local_write_time__.timestampValue);return new C1(t.seconds,t.nanos)}var J1=Wg(function e(t,n,r,i,a,o,s,u){Zg(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),e0=function(){function e(t,n){Zg(this,e),this.projectId=t,this.database=n||"(default)"}return Wg(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function t0(e){return null==e}function n0(e){return 0===e&&1/e==-1/0}var r0={fields:{__type__:{stringValue:"__max__"}}};function i0(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?K1(e)?4:m0(e)?9007199254740991:10:r1()}function a0(e,t){if(e===t)return!0;var n,r=i0(e);if(r!==i0(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return X1(e).isEqual(X1(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=W1(e.timestampValue),r=W1(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,Y1(e.bytesValue).isEqual(Y1(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return j1(e.geoPointValue.latitude)===j1(t.geoPointValue.latitude)&&j1(e.geoPointValue.longitude)===j1(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return j1(e.integerValue)===j1(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=j1(e.doubleValue),r=j1(t.doubleValue);return n===r?n0(n)===n0(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return k1(e.arrayValue.values||[],t.arrayValue.values||[],a0);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(L1(n)!==L1(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!a0(n[i],r[i])))return!1;return!0}(e,t);default:return r1()}}function o0(e,t){return void 0!==(e.values||[]).find(function(e){return a0(e,t)})}function s0(e,t){if(e===t)return 0;var n,r,i,a,o=i0(e),s=i0(t);if(o!==s)return m1(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return m1(e.booleanValue,t.booleanValue);case 2:return r=t,i=j1((n=e).integerValue||n.doubleValue),a=j1(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return u0(e.timestampValue,t.timestampValue);case 4:return u0(X1(e),X1(t));case 5:return m1(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Y1(e),r=Y1(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=m1(n[i],r[i]);if(0!==a)return a}return m1(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=m1(j1(e.latitude),j1(t.latitude));return 0!==n?n:m1(j1(e.longitude),j1(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=s0(n[i],r[i]);if(a)return a}return m1(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===r0&&t===r0)return 0;if(e===r0)return 1;if(t===r0)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=m1(r[o],a[o]);if(0!==s)return s;var u=s0(n[r[o]],i[a[o]]);if(0!==u)return u}return m1(r.length,a.length)}(e.mapValue,t.mapValue);default:throw r1()}}function u0(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return m1(e,t);var n=W1(e),r=W1(t),i=m1(n.seconds,r.seconds);return 0!==i?i:m1(n.nanos,r.nanos)}function c0(e){return l0(e)}function l0(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=W1(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?Y1(e.bytesValue).toBase64():"referenceValue"in e?P1.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Gg(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=l0(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Gg(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(l0(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):r1();var t,n,r}function f0(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function h0(e){return!!e&&"integerValue"in e}function d0(e){return!!e&&"arrayValue"in e}function v0(e){return!!e&&"nullValue"in e}function p0(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function g0(e){return!!e&&"mapValue"in e}function y0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return F1(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=y0(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=y0(e.arrayValue.values[r]);return n}return Object.assign({},e)}function m0(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var k0=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!g0(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=y0(t)}},{key:"setAll",value:function(e){var t=this,n=S1.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=y0(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());g0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return a0(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];g0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){F1(t,function(t,n){return e[t]=n});var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(y0(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function C0(e){var t=[];return F1(e.fields,function(e,n){var r=new S1([e]);if(g0(n)){var i=C0(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Gg(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new $1(t)}var w0=function(){function e(t,n,r,i,a,o){Zg(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return Wg(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=k0.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=k0.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=w1.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,w1.min(),w1.min(),k0.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,w1.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,w1.min(),k0.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,w1.min(),k0.empty(),2)}}]),e}(),_0=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Zg(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function b0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new _0(e,t,n,r,i,a,o)}function E0(e){var t=a1(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+c0(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),t0(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return c0(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return c0(e)}).join(",")),t.ut=n}return t.ut}function S0(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!U0(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!a0(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!B0(e.startAt,t.startAt)&&B0(e.endAt,t.endAt)}function P0(e){return P1.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var O0=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(s0(t,this.value)):null!==t&&i0(this.value)===i0(t)&&this.at(s0(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return r1()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new T0(e,t,r):"array-contains"===t?new x0(e,r):"in"===t?new M0(e,r):"not-in"===t?new N0(e,r):"array-contains-any"===t?new D0(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new I0(e,n):new A0(e,n)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),T0=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,i)).key=P1.fromName(i.referenceValue),a}return Wg(n,[{key:"matches",value:function(e){var t=P1.comparator(e.key,this.key);return this.at(t)}}]),n}(O0),I0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,"in",r)).keys=R0(0,r),i}return Wg(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(O0),A0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,"not-in",r)).keys=R0(0,r),i}return Wg(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(O0);function R0(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return P1.fromName(e.referenceValue)})}var x0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"array-contains",r)}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return d0(t)&&o0(t.arrayValue,this.value)}}]),n}(O0),M0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"in",r)}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&o0(this.value.arrayValue,t)}}]),n}(O0),N0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"not-in",r)}return Wg(n,[{key:"matches",value:function(e){if(o0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!o0(this.value.arrayValue,t)}}]),n}(O0),D0=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"array-contains-any",r)}return Wg(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!d0(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return o0(t.value.arrayValue,e)})}}]),n}(O0),L0=Wg(function e(t,n){Zg(this,e),this.position=t,this.inclusive=n}),F0=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";Zg(this,e),this.field=t,this.dir=n});function U0(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function V0(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?P1.comparator(P1.fromName(o.referenceValue),n.key):s0(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function B0(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!a0(e.position[n],t.position[n]))return!1;return!0}var z0=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Zg(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function G0(e){return new z0(e)}function H0(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function $0(e){var t,n=Gg(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function Z0(e){return null!==e.collectionGroup}function q0(e){var t=a1(e);if(null===t.lt){t.lt=[];var n=$0(t),r=H0(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new F0(n)),t.lt.push(new F0(S1.keyField(),"asc"));else{var i,a=!1,o=Gg(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new F0(S1.keyField(),u))}}}return t.lt}function W0(e){var t=a1(e);if(!t.ft)if("F"===t.limitType)t.ft=b0(t.path,t.collectionGroup,q0(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Gg(q0(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new F0(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new L0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new L0(t.startAt.position,t.startAt.inclusive):null;t.ft=b0(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function j0(e,t,n){return new z0(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Y0(e,t){return S0(W0(e),W0(t))&&e.limitType===t.limitType}function K0(e){return"".concat(E0(W0(e)),"|lt:").concat(e.limitType)}function Q0(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(c0(t.value));var t}).join(", "),"]")),t0(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return c0(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return c0(e)}).join(",")),"Target(".concat(t,")")}(W0(e)),"; limitType=").concat(e.limitType,")")}function X0(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):P1.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Gg(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Gg(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=q0(o),i=s,a=V0(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=V0(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,q0(o),s)));var n,r,i,a,o,s}function J0(e){return function(t,n){var r,i=!1,a=Gg(q0(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e2(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function e2(e,t,n){var r,i,a,o,s=e.field.isKeyField()?P1.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?s0(a,o):r1());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return r1()}}function t2(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:n0(t)?"-0":t}}function n2(e){return{integerValue:""+e}}var r2=Wg(function e(){Zg(this,e),this._=void 0});function i2(e,t,n){return e instanceof s2?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof u2?c2(e,t):e instanceof l2?f2(e,t):function(e,t){var n=o2(e,t),r=d2(n)+d2(e._t);return h0(n)&&h0(e._t)?n2(r):t2(e.wt,r)}(e,t);var r,i,a}function a2(e,t,n){return e instanceof u2?c2(e,t):e instanceof l2?f2(e,t):n}function o2(e,t){return e instanceof h2?h0(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var s2=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(r2),u2=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).elements=e,r}return Wg(n)}(r2);function c2(e,t){var n,r=v2(t),i=Gg(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return a0(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var l2=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).elements=e,r}return Wg(n)}(r2);function f2(e,t){var n,r=v2(t),i=Gg(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!a0(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var h2=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).wt=e,i._t=r,i}return Wg(n)}(r2);function d2(e){return j1(e.integerValue||e.doubleValue)}function v2(e){return d0(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var p2=Wg(function e(t,n){Zg(this,e),this.field=t,this.transform=n}),g2=Wg(function e(t,n){Zg(this,e),this.version=t,this.transformResults=n}),y2=function(){function e(t,n){Zg(this,e),this.updateTime=t,this.exists=n}return Wg(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function m2(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var k2=Wg(function e(){Zg(this,e)});function C2(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new x2(e.key,y2.none()):new S2(e.key,e.data,y2.none());var n,r=e.data,i=k0.empty(),a=new G1(S1.comparator),o=Gg(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new P2(e.key,i,new $1(a.toArray()),y2.none())}function w2(e,t,n){var r,i,a,o,s;e instanceof S2?(i=t,a=n,o=(r=e).value.clone(),s=T2(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof P2?function(e,t,n){if(m2(e.precondition,t)){var r=T2(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(O2(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function _2(e,t,n,r){return e instanceof S2?function(e,t,n,r){if(!m2(e.precondition,t))return n;var i=e.value.clone(),a=I2(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof P2?function(e,t,n,r){if(!m2(e.precondition,t))return n;var i=I2(e.fieldTransforms,r,t),a=t.data;return a.setAll(O2(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,m2(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function b2(e,t){var n,r=null,i=Gg(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=o2(a.transform,o||null);null!=s&&(null===r&&(r=k0.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function E2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&k1(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof u2&&r instanceof u2||n instanceof l2&&r instanceof l2?k1(n.elements,r.elements,a0):n instanceof h2&&r instanceof h2?a0(n._t,r._t):n instanceof s2&&r instanceof s2);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var S2=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Zg(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(k2),P2=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Zg(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return Wg(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(k2);function O2(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function T2(e,t,n){var r=new Map;i1(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,a2(o,s,n[i]))}return r}function I2(e,t,n){var r,i=new Map,a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,i2(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var A2,R2,x2=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(k2),M2=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(k2),N2=Wg(function e(t){Zg(this,e),this.count=t});function D2(e){switch(e){default:return r1();case o1.CANCELLED:case o1.UNKNOWN:case o1.DEADLINE_EXCEEDED:case o1.RESOURCE_EXHAUSTED:case o1.INTERNAL:case o1.UNAVAILABLE:case o1.UNAUTHENTICATED:return!1;case o1.INVALID_ARGUMENT:case o1.NOT_FOUND:case o1.ALREADY_EXISTS:case o1.PERMISSION_DENIED:case o1.FAILED_PRECONDITION:case o1.ABORTED:case o1.OUT_OF_RANGE:case o1.UNIMPLEMENTED:case o1.DATA_LOSS:return!0}}function L2(e){if(void 0===e)return e1("GRPC error has no .code"),o1.UNKNOWN;switch(e){case A2.OK:return o1.OK;case A2.CANCELLED:return o1.CANCELLED;case A2.UNKNOWN:return o1.UNKNOWN;case A2.DEADLINE_EXCEEDED:return o1.DEADLINE_EXCEEDED;case A2.RESOURCE_EXHAUSTED:return o1.RESOURCE_EXHAUSTED;case A2.INTERNAL:return o1.INTERNAL;case A2.UNAVAILABLE:return o1.UNAVAILABLE;case A2.UNAUTHENTICATED:return o1.UNAUTHENTICATED;case A2.INVALID_ARGUMENT:return o1.INVALID_ARGUMENT;case A2.NOT_FOUND:return o1.NOT_FOUND;case A2.ALREADY_EXISTS:return o1.ALREADY_EXISTS;case A2.PERMISSION_DENIED:return o1.PERMISSION_DENIED;case A2.FAILED_PRECONDITION:return o1.FAILED_PRECONDITION;case A2.ABORTED:return o1.ABORTED;case A2.OUT_OF_RANGE:return o1.OUT_OF_RANGE;case A2.UNIMPLEMENTED:return o1.UNIMPLEMENTED;case A2.DATA_LOSS:return o1.DATA_LOSS;default:return r1()}}(R2=A2||(A2={}))[R2.OK=0]="OK",R2[R2.CANCELLED=1]="CANCELLED",R2[R2.UNKNOWN=2]="UNKNOWN",R2[R2.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",R2[R2.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",R2[R2.NOT_FOUND=5]="NOT_FOUND",R2[R2.ALREADY_EXISTS=6]="ALREADY_EXISTS",R2[R2.PERMISSION_DENIED=7]="PERMISSION_DENIED",R2[R2.UNAUTHENTICATED=16]="UNAUTHENTICATED",R2[R2.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",R2[R2.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",R2[R2.ABORTED=10]="ABORTED",R2[R2.OUT_OF_RANGE=11]="OUT_OF_RANGE",R2[R2.UNIMPLEMENTED=12]="UNIMPLEMENTED",R2[R2.INTERNAL=13]="INTERNAL",R2[R2.UNAVAILABLE=14]="UNAVAILABLE",R2[R2.DATA_LOSS=15]="DATA_LOSS";var F2=function(){function e(t,n){Zg(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return Wg(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=Pg(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){F1(this.inner,function(t,n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=Pg(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return U1(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),U2=new V1(P1.comparator);function V2(){return U2}var B2=new V1(P1.comparator);function z2(){for(var e=B2,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function G2(e){var t=B2;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function H2(){return Z2()}function $2(){return Z2()}function Z2(){return new F2(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var q2=new V1(P1.comparator),W2=new G1(P1.comparator);function j2(){for(var e=W2,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var Y2=new G1(m1);function K2(){return Y2}var Q2=function(){function e(t,n,r,i,a){Zg(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return Wg(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,X2.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(w1.min(),r,K2(),V2(),j2())}}]),e}(),X2=function(){function e(t,n,r,i,a){Zg(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return Wg(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(Z1.EMPTY_BYTE_STRING,n,j2(),j2(),j2())}}]),e}(),J2=Wg(function e(t,n,r,i){Zg(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),e3=Wg(function e(t,n){Zg(this,e),this.targetId=t,this.It=n}),t3=Wg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z1.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Zg(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),n3=function(){function e(){Zg(this,e),this.Tt=0,this.Et=a3(),this.At=Z1.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return Wg(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=j2(),t=j2(),n=j2();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:r1()}}),new X2(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=a3()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),r3=function(){function e(t){Zg(this,e),this.Mt=t,this.Ft=new Map,this.$t=V2(),this.Bt=i3(),this.Lt=new G1(m1)}return Wg(e,[{key:"Ut",value:function(e){var t,n=Gg(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=Gg(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:r1()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(P0(i))if(0===n){var a=new P1(i.path);this.Kt(t,a,w0.newNoDocument(a,w1.min()))}else i1(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&P0(a.target)){var o=new P1(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,w0.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=j2();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new Q2(e,n,this.Lt,this.$t,r);return this.$t=V2(),this.Bt=i3(),this.Lt=new G1(m1),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new n3,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new G1(m1),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||JJ("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new n3),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function i3(){return new V1(P1.comparator)}function a3(){return new V1(P1.comparator)}var o3={asc:"ASCENDING",desc:"DESCENDING"},s3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},u3=Wg(function e(t,n){Zg(this,e),this.databaseId=t,this.dt=n});function c3(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function l3(e,t){return e.dt?t.toBase64():t.toUint8Array()}function f3(e,t){return c3(e,t.toTimestamp())}function h3(e){return i1(!!e),w1.fromTimestamp((t=W1(e),new C1(t.seconds,t.nanos)));var t}function d3(e,t){return(n=e,new b1(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function v3(e){var t=b1.fromString(e);return i1(x3(t)),t}function p3(e,t){return d3(e.databaseId,t.path)}function g3(e,t){var n=v3(t);if(n.get(1)!==e.databaseId.projectId)throw new s1(o1.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new s1(o1.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new P1(k3(n))}function y3(e,t){return d3(e.databaseId,t)}function m3(e){return new b1(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function k3(e){return i1(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function C3(e,t,n){return{name:p3(e,t),fields:n.value.mapValue.fields}}function w3(e,t){return{documents:[y3(e,t.path)]}}function _3(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=y3(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=y3(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(p0(e.value))return{unaryFilter:{field:O3(e.field),op:"IS_NAN"}};if(v0(e.value))return{unaryFilter:{field:O3(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(p0(e.value))return{unaryFilter:{field:O3(e.field),op:"IS_NOT_NAN"}};if(v0(e.value))return{unaryFilter:{field:O3(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:O3(e.field),op:P3(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:O3((t=e).field),direction:S3(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||t0(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function b3(e){var t=function(e){var t=v3(e);return 4===t.length?b1.emptyPath():k3(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){i1(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=E3(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new F0(T3((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return t0(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new L0((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new L0(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new z0(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function E3(e){return e?void 0!==e.unaryFilter?[A3(e)]:void 0!==e.fieldFilter?[I3(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return E3(e)}).reduce(function(e,t){return e.concat(t)}):r1():[]}function S3(e){return o3[e]}function P3(e){return s3[e]}function O3(e){return{fieldPath:e.canonicalString()}}function T3(e){return S1.fromServerFormat(e.fieldPath)}function I3(e){return O0.create(T3(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return r1()}}(e.fieldFilter.op),e.fieldFilter.value)}function A3(e){switch(e.unaryFilter.op){case"IS_NAN":var t=T3(e.unaryFilter.field);return O0.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=T3(e.unaryFilter.field);return O0.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=T3(e.unaryFilter.field);return O0.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=T3(e.unaryFilter.field);return O0.create(i,"!=",{nullValue:"NULL_VALUE"});default:return r1()}}function R3(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function x3(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var M3=function(){function e(t,n,r,i){Zg(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return Wg(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&w2(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=Gg(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=_2(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=Gg(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=_2(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=$2();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=C2(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(w1.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},j2())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&k1(this.mutations,e.mutations,function(e,t){return E2(e,t)})&&k1(this.baseMutations,e.baseMutations,function(e,t){return E2(e,t)})}}]),e}(),N3=function(){function e(t,n,r,i){Zg(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return Wg(e,null,[{key:"from",value:function(t,n,r){i1(t.mutations.length===r.length);for(var i=q2,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),D3=function(){function e(t,n){Zg(this,e),this.largestBatchId=t,this.mutation=n}return Wg(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),L3=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:w1.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:w1.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Z1.EMPTY_BYTE_STRING;Zg(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return Wg(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),F3=Wg(function e(t){Zg(this,e),this.ne=t});function U3(e){var t=b3({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?j0(t,t.limit,"L"):t}var V3=function(){function e(){Zg(this,e)}return Wg(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(j1(e.integerValue));else if("doubleValue"in e){var n=j1(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),n0(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(Y1(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?m0(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):r1()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),P1.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();V3.ye=new V3;var B3=function(){function e(){Zg(this,e),this.ze=new z3}return Wg(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),M1.resolve()}},{key:"getCollectionParents",value:function(e,t){return M1.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return M1.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return M1.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return M1.resolve(null)}},{key:"getIndexType",value:function(e,t){return M1.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return M1.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return M1.resolve(null)}},{key:"getMinOffset",value:function(e,t){return M1.resolve(T1.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return M1.resolve(T1.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return M1.resolve()}},{key:"updateIndexEntries",value:function(e,t){return M1.resolve()}}]),e}(),z3=function(){function e(){Zg(this,e),this.index={}}return Wg(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new G1(b1.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new G1(b1.comparator)).toArray()}}]),e}();new Uint8Array(0);var G3=function(){function e(t,n,r){Zg(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Wg(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();G3.DEFAULT_COLLECTION_PERCENTILE=10,G3.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,G3.DEFAULT=new G3(41943040,G3.DEFAULT_COLLECTION_PERCENTILE,G3.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),G3.DISABLED=new G3(-1,0,0);var H3=function(){function e(t){Zg(this,e),this.En=t}return Wg(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),$3=Wg(function e(t,n){Zg(this,e),this.overlayedDocument=t,this.mutatedFields=n}),Z3=function(){function e(t,n,r,i){Zg(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return Wg(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&_2(r.mutation,e,$1.empty(),C1.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,j2()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j2(),i=H2();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=z2();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=H2();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,j2())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=V2(),a=Z2(),o=Z2();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof P2)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),_2(o.mutation,t,o.mutation.getFieldMask(),C1.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new $3(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Z2(),i=new V1(function(e,t){return e-t}),a=j2();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=Gg(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||$1.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||j2()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=$2();c.forEach(function(e){if(!a.has(e)){var n=C2(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return M1.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return P1.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Z0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):M1.resolve(H2()),s=-1,u=a;return o.next(function(t){return M1.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?M1.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,j2())}).next(function(e){return{batchId:s,changes:G2(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new P1(t)).next(function(e){var t=z2();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=z2();return this.indexManager.getCollectionParents(e,i).next(function(o){return M1.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new z0(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,w0.newInvalidDocument(n)))});var n=z2();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&_2(a.mutation,i,$1.empty(),C1.now()),X0(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):M1.resolve(w0.newInvalidDocument(t))}}]),e}(),q3=function(){function e(t){Zg(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return Wg(e,[{key:"getBundleMetadata",value:function(e,t){return M1.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:h3(n.createTime)}),M1.resolve()}},{key:"getNamedQuery",value:function(e,t){return M1.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:U3(n.bundledQuery),readTime:h3(n.readTime)}),M1.resolve();var n}}]),e}(),W3=function(){function e(){Zg(this,e),this.overlays=new V1(P1.comparator),this.Xn=new Map}return Wg(e,[{key:"getOverlay",value:function(e,t){return M1.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=H2();return M1.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),M1.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),M1.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=H2(),i=t.length+1,a=new P1(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return M1.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new V1(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=H2(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=H2(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return M1.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new D3(t,n));var a=this.Xn.get(t);void 0===a&&(a=j2(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),j3=function(){function e(){Zg(this,e),this.Zn=new G1(Y3.ts),this.es=new G1(Y3.ns)}return Wg(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Y3(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new Y3(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new P1(new b1([])),r=new Y3(n,e),i=new Y3(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new P1(new b1([])),n=new Y3(t,e),r=new Y3(t,e+1),i=j2();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new Y3(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Y3=function(){function e(t,n){Zg(this,e),this.key=t,this.ls=n}return Wg(e,null,[{key:"ts",value:function(e,t){return P1.comparator(e.key,t.key)||m1(e.ls,t.ls)}},{key:"ns",value:function(e,t){return m1(e.ls,t.ls)||P1.comparator(e.key,t.key)}}]),e}(),K3=function(){function e(t,n){Zg(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new G1(Y3.ts)}return Wg(e,[{key:"checkEmpty",value:function(e){return M1.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new M3(i,t,n,r);this.mutationQueue.push(a);var o,s=Gg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new Y3(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return M1.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return M1.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return M1.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return M1.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return M1.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Y3(t,0),i=new Y3(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),M1.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new G1(m1);return t.forEach(function(e){var t=new Y3(e,0),i=new Y3(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),M1.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;P1.isDocumentKey(i)||(i=i.child(""));var a=new Y3(new P1(i),0),o=new G1(m1);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),M1.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;i1(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return M1.forEach(t.mutations,function(i){var a=new Y3(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Y3(t,0),r=this.ds.firstAfterOrEqual(n);return M1.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return M1.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Q3=function(){function e(t){Zg(this,e),this.ps=t,this.docs=new V1(P1.comparator),this.size=0}return Wg(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return M1.resolve(n?n.document.mutableCopy():w0.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=V2();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():w0.newInvalidDocument(e))}),M1.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=V2(),i=new P1(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||I1(O1(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return M1.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){r1()}},{key:"Is",value:function(e,t){return M1.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new X3(this)}},{key:"getSize",value:function(e){return M1.resolve(this.size)}}]),e}(),X3=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).zn=e,r}return Wg(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),M1.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){Zg(this,e),this.changes=new F2(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return Wg(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,w0.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?M1.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),J3=function(){function e(t){Zg(this,e),this.persistence=t,this.Ts=new F2(function(e){return E0(e)},S0),this.lastRemoteSnapshotVersion=w1.min(),this.highestTargetId=0,this.Es=0,this.As=new j3,this.targetCount=0,this.Rs=H3.An()}return Wg(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),M1.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return M1.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return M1.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),M1.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),M1.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new H3(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,M1.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),M1.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,M1.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),M1.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return M1.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return M1.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),M1.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),M1.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),M1.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return M1.resolve(n)}},{key:"containsKey",value:function(e,t){return M1.resolve(this.As.containsKey(t))}}]),e}(),e4=function(){function e(t,n){var r=this;Zg(this,e),this.bs={},this.overlays={},this.Ps=new D1(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new J3(this),this.indexManager=new B3,this.remoteDocumentCache=new Q3(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new F3(n),this.Ds=new q3(this.wt)}return Wg(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new W3,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new K3(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;JJ("MemoryPersistence","Starting transaction:",e);var i=new t4(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return M1.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),t4=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return Wg(n)}(function(){function e(){Zg(this,e),this.onCommittedListeners=[]}return Wg(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),n4=function(){function e(t){Zg(this,e),this.persistence=t,this.ks=new j3,this.Os=null}return Wg(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw r1()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),M1.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),M1.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),M1.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M1.forEach(this.Fs,function(r){var i=P1.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,w1.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return M1.or([function(){return M1.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),r4=function(){function e(t,n,r,i){Zg(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return Wg(e,null,[{key:"Vi",value:function(t,n){var r,i=j2(),a=j2(),o=Gg(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),i4=function(){function e(){Zg(this,e),this.Si=!1}return Wg(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return M1.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(w1.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(XJ()<=HB.DEBUG&&JJ("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Q0(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=w1.fromTimestamp(1e9===r?new C1(n+1,0):new C1(n,r));return new T1(i,P1.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new G1(J0(e));return t.forEach(function(t,r){X0(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return XJ()<=HB.DEBUG&&JJ("QueryEngine","Using full collection scan to execute query:",Q0(t)),this.Di.getDocumentsMatchingQuery(e,t,T1.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),a4=function(){function e(t,n,r,i){Zg(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new V1(m1),this.Bi=new F2(function(e){return E0(e)},S0),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return Wg(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Z3(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function o4(e,t){return s4.apply(this,arguments)}function s4(){return s4=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a1(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=j2(),u=Gg(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=Gg(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Gg(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Gg(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),s4.apply(this,arguments)}function u4(e,t){var n=a1(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=M1.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);i1(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=j2(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function c4(e){var t=a1(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function l4(e,t){var n=a1(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken(Z1.EMPTY_BYTE_STRING,w1.min()).withLastLimboFreeSnapshotVersion(w1.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=V2(),u=j2();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=j2(),i=j2();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=V2();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(w1.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):JJ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(w1.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return M1.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function f4(e,t){var n=a1(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function h4(e,t){var n=a1(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,M1.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new L3(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function d4(e,t,n){return v4.apply(this,arguments)}function v4(){return v4=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a1(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),N1(e.t1)){e.next=12;break}throw e.t1;case 12:JJ("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),v4.apply(this,arguments)}function p4(e,t,n){var r=a1(e),i=w1.min(),a=j2();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=W0(t),c=a1(o),l=c.Bi.get(u),void 0!==l?M1.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:w1.min(),n?a:j2())}).next(function(e){return function(e,t,n){var r=w1.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var g4=function(){function e(){Zg(this,e),this.activeTargetIds=K2()}return Wg(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),y4=function(){function e(){Zg(this,e),this.Fr=new g4,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Wg(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new g4,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),m4=function(){function e(){Zg(this,e)}return Wg(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),k4=function(){function e(){var t=this;Zg(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return Wg(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){JJ("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Gg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){JJ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Gg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),C4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},w4=function(){function e(t){Zg(this,e),this.jr=t.jr,this.Wr=t.Wr}return Wg(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),_4=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return Wg(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new WJ;o.listenOnce(GJ.COMPLETE,function(){try{switch(o.getLastErrorCode()){case zJ.NO_ERROR:var t=o.getResponseJson();JJ("Connection","XHR received:",JSON.stringify(t)),i(t);break;case zJ.TIMEOUT:JJ("Connection",'RPC "'+e+'" timed out'),a(new s1(o1.DEADLINE_EXCEEDED,"Request time out"));break;case zJ.HTTP_ERROR:var n=o.getStatus();if(JJ("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(o1).indexOf(c)>=0?c:o1.UNKNOWN);a(new s1(s,r.message))}else a(new s1(o1.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new s1(o1.UNAVAILABLE,"Connection failed."));break;default:r1()}}finally{JJ("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=VJ(),a=BJ(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ZJ({})),this.uo(o.initMessageHeaders,t,n),yB()||kB()||gB().indexOf("Electron/")>=0||CB()||gB().indexOf("MSAppHost/")>=0||mB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");JJ("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new w4({jr:function(e){l?JJ("Connection","Not sending because WebChannel is closed:",e):(c||(JJ("Connection","Opening WebChannel transport."),u.open(),c=!0),JJ("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,qJ.EventType.OPEN,function(){l||JJ("Connection","WebChannel transport opened.")}),h(u,qJ.EventType.CLOSE,function(){l||(l=!0,JJ("Connection","WebChannel transport closed"),f.eo())}),h(u,qJ.EventType.ERROR,function(e){l||(l=!0,t1("Connection","WebChannel transport errored:",e),f.eo(new s1(o1.UNAVAILABLE,"The operation could not be completed")))}),h(u,qJ.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];i1(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){JJ("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=A2[e];if(void 0!==t)return L2(t)}(a),s=i.message;void 0===o&&(o=o1.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new s1(o,s)),u.close()}else JJ("Connection","WebChannel received:",n),f.no(n)}}),h(a,HJ.STAT_EVENT,function(e){e.stat===$J.PROXY?JJ("Connection","Detected buffering proxy"):e.stat===$J.NOPROXY&&JJ("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){Zg(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Wg(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);JJ("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return JJ("RestConnection","Received: ",e),e},function(t){throw t1("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+KJ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(C4[e])}}]),e}());function b4(){return"undefined"!=typeof document?document:null}function E4(e){return new u3(e,!0)}var S4=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;Zg(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return Wg(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&JJ("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),P4=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new S4(t,n)}return Wg(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===o1.RESOURCE_EXHAUSTED?(e1(t.toString()),e1("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===o1.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Pg(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new s1(o1.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return JJ("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(JJ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),O4=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return Wg(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:r1(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(i1(void 0===t||"string"==typeof t),Z1.fromBase64String(t||"")):(i1(void 0===t||t instanceof Uint8Array),Z1.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?o1.UNKNOWN:L2(e.code);return new s1(t,e.message||"")}(s);n=new t3(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=g3(e,c.document.name),f=h3(c.document.updateTime),h=new k0({mapValue:{fields:c.document.fields}}),d=w0.newFoundDocument(l,f,h);n=new J2(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=g3(e,v.document),g=v.readTime?h3(v.readTime):w1.min(),y=w0.newNoDocument(p,g);n=new J2([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=g3(e,m.document);n=new J2([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return r1();var C=t.filter,w=new N2(C.count||0);n=new e3(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return w1.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?w1.min():t.readTime?h3(t.readTime):w1.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=m3(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=P0(i)?{documents:w3(t,i)}:{query:_3(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=l3(t,n.resumeToken):n.snapshotVersion.compareTo(w1.min())>0&&(r.readTime=c3(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return r1()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=m3(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(P4),T4=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return Wg(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Rg(Vg(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(i1(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(i1(void 0!==t),e.map(function(e){return function(e,t){var n=h3(e.updateTime?e.updateTime:t);return n.isEqual(w1.min())&&(n=h3(t)),new g2(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=h3(e.commitTime);return this.listener.Jo(n,t)}return i1(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=m3(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof S2)n={update:C3(e,t.key,t.value)};else if(t instanceof x2)n={delete:p3(e,t.key)};else if(t instanceof P2)n={update:C3(e,t.key,t.data),updateMask:R3(t.fieldMask)};else{if(!(t instanceof M2))return r1();n={verify:p3(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof s2)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof u2)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof l2)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof h2)return{fieldPath:t.field.canonicalString(),increment:n._t};throw r1()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:f3(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:r1()),n}(t.wt,e)})};this.Mo(n)}}]),n}(P4),I4=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return Wg(n,[{key:"tu",value:function(){if(this.Zo)throw new s1(o1.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Pg(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===o1.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new s1(o1.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=Pg(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===o1.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new s1(o1.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),A4=function(){function e(t,n){Zg(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return Wg(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(e1(t),this.su=!1):JJ("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),R4=Wg(function e(t,n,r,i,a){Zg(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=G4(o),!e.t0){e.next=5;break}return JJ("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=a1(t)).lu.add(4),e.next=4,N4(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,x4(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new A4(r,i)});function x4(e){return M4.apply(this,arguments)}function M4(){return M4=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!G4(t)){e.next=18;break}n=Gg(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),M4.apply(this,arguments)}function N4(e){return D4.apply(this,arguments)}function D4(){return D4=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Gg(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),D4.apply(this,arguments)}function L4(e,t){var n=a1(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),z4(n)?B4(n):g5(n).Co()&&U4(n,t))}function F4(e,t){var n=a1(e),r=g5(n);n.hu.delete(t),r.Co()&&V4(n,t),0===n.hu.size&&(r.Co()?r.ko():G4(n)&&n._u.set("Unknown"))}function U4(e,t){e.wu.Nt(t.targetId),g5(e).Qo(t)}function V4(e,t){e.wu.Nt(t),g5(e).jo(t)}function B4(e){e.wu=new r3({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),g5(e).start(),e._u.iu()}function z4(e){return G4(e)&&!g5(e).Do()&&e.hu.size>0}function G4(e){return 0===a1(e).lu.size}function H4(e){e.wu=void 0}function $4(e){return Z4.apply(this,arguments)}function Z4(){return Z4=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){U4(t,e)});case 1:case"end":return e.stop()}},e)})),Z4.apply(this,arguments)}function q4(e,t){return W4.apply(this,arguments)}function W4(){return W4=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:H4(t),z4(t)?(t._u.uu(n),B4(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),W4.apply(this,arguments)}function j4(e,t,n){return Y4.apply(this,arguments)}function Y4(){return Y4=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof t3&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Gg(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),JJ("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,K4(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof J2?t.wu.Ut(n):n instanceof e3?t.wu.zt(n):t.wu.Gt(n),r.isEqual(w1.min())){e.next=29;break}return e.prev=14,e.next=17,c4(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(Z1.EMPTY_BYTE_STRING,n.snapshotVersion)),V4(e,t);var r=new L3(n.target,t,1,n.sequenceNumber);U4(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),JJ("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,K4(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),Y4.apply(this,arguments)}function K4(e,t,n){return Q4.apply(this,arguments)}function Q4(){return Q4=aB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(N1(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,N4(t);case 5:t._u.set("Offline"),r||(r=function(){return c4(t.localStore)}),t.asyncQueue.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return JJ("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,x4(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),Q4.apply(this,arguments)}function X4(e,t){return t().catch(function(n){return K4(e,n,t)})}function J4(e){return e5.apply(this,arguments)}function e5(){return e5=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a1(t),r=y5(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!t5(n)){e.next=19;break}return e.prev=3,e.next=6,f4(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,n5(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,K4(n,e.t0);case 17:e.next=2;break;case 19:r5(n)&&i5(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),e5.apply(this,arguments)}function t5(e){return G4(e)&&e.au.length<10}function n5(e,t){e.au.push(t);var n=y5(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function r5(e){return G4(e)&&!y5(e).Do()&&e.au.length>0}function i5(e){y5(e).start()}function a5(e){return o5.apply(this,arguments)}function o5(){return o5=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y5(t).Xo();case 1:case"end":return e.stop()}},e)})),o5.apply(this,arguments)}function s5(e){return u5.apply(this,arguments)}function u5(){return u5=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=y5(t),r=Gg(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),u5.apply(this,arguments)}function c5(e,t,n){return l5.apply(this,arguments)}function l5(){return l5=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=N3.from(i,n,r),e.next=3,X4(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,J4(t);case 5:case"end":return e.stop()}},e)})),l5.apply(this,arguments)}function f5(e,t){return h5.apply(this,arguments)}function h5(){return h5=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&y5(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!D2(i=n.code)||i===o1.ABORTED){e.next=7;break}return r=t.au.shift(),y5(t).No(),e.next=5,X4(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,J4(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:r5(t)&&i5(t);case 5:case"end":return e.stop()}},e)})),h5.apply(this,arguments)}function d5(e,t){return v5.apply(this,arguments)}function v5(){return v5=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a1(t)).asyncQueue.verifyOperationInProgress(),JJ("RemoteStore","RemoteStore received new credentials"),i=G4(r),r.lu.add(3),e.next=6,N4(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,x4(r);case 12:case"end":return e.stop()}},e)})),v5.apply(this,arguments)}function p5(){return p5=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a1(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,x4(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,N4(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),p5.apply(this,arguments)}function g5(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:$4.bind(null,e),Jr:q4.bind(null,e),Go:j4.bind(null,e)},(i=a1(t)).tu(),new O4(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),z4(e)?B4(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:H4(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function y5(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:a5.bind(null,e),Jr:f5.bind(null,e),Yo:s5.bind(null,e),Jo:c5.bind(null,e)},(i=a1(t)).tu(),new T4(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,J4(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(JJ("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var m5=function(){function e(t,n,r,i,a){Zg(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new u1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return Wg(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new s1(o1.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function k5(e,t){if(e1("AsyncQueue","".concat(t,": ").concat(e)),N1(e))return new s1(o1.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var C5=function(){function e(t){Zg(this,e),this.comparator=t?function(e,n){return t(e,n)||P1.comparator(e.key,n.key)}:function(e,t){return P1.comparator(e.key,t.key)},this.keyedMap=z2(),this.sortedSet=new V1(this.comparator)}return Wg(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),w5=function(){function e(){Zg(this,e),this.yu=new V1(P1.comparator)}return Wg(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):r1():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),_5=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return Wg(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Y0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,C5.emptySet(n),a,r,i,!0,!1)}}]),e}(),b5=Wg(function e(){Zg(this,e),this.Iu=void 0,this.listeners=[]}),E5=Wg(function e(){Zg(this,e),this.queries=new F2(function(e){return K0(e)},Y0),this.onlineState="Unknown",this.Tu=new Set});function S5(e,t){return P5.apply(this,arguments)}function P5(){return P5=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a1(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new b5),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=k5(e.t0,"Initialization of query '".concat(Q0(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&R5(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),P5.apply(this,arguments)}function O5(e,t){return T5.apply(this,arguments)}function T5(){return T5=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a1(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),T5.apply(this,arguments)}function I5(e,t){var n,r=a1(e),i=!1,a=Gg(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Gg(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&R5(r)}function A5(e,t,n){var r=a1(e),i=r.queries.get(t);if(i){var a,o=Gg(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function R5(e){e.Tu.forEach(function(e){e.next()})}var x5=function(){function e(t,n,r){Zg(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return Wg(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Gg(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new _5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=_5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),M5=Wg(function e(t){Zg(this,e),this.key=t}),N5=Wg(function e(t){Zg(this,e),this.key=t}),D5=function(){function e(t,n){Zg(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=j2(),this.mutatedKeys=j2(),this.Lu=J0(t),this.Uu=new C5(this.Lu)}return Wg(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new w5,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=X0(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return r1()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new _5(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new w5,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=j2(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new N5(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new M5(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=j2();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return _5.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),L5=Wg(function e(t,n,r){Zg(this,e),this.query=t,this.targetId=n,this.view=r}),F5=Wg(function e(t){Zg(this,e),this.key=t,this.Xu=!1}),U5=function(){function e(t,n,r,i,a,o){Zg(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new F2(function(e){return K0(e)},Y0),this.ec=new Map,this.nc=new Set,this.sc=new V1(P1.comparator),this.ic=new Map,this.rc=new j3,this.oc={},this.uc=new Map,this.cc=H3.Rn(),this.onlineState="Unknown",this.ac=void 0}return Wg(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function V5(e,t){return B5.apply(this,arguments)}function B5(){return B5=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d6(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,h4(r.localStore,W0(n));case 8:return s=e.sent,r.isPrimaryClient&&L4(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,z5(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),B5.apply(this,arguments)}function z5(e,t,n,r){return G5.apply(this,arguments)}function G5(){return G5=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,p4(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(a6(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,p4(t.localStore,n,!0);case 3:return a=e.sent,o=new D5(n,a.ji),s=o.Ku(a.documents),u=X2.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),a6(t,r,c.zu),l=new L5(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),G5.apply(this,arguments)}function H5(e,t){return $5.apply(this,arguments)}function $5(){return $5=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a1(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!Y0(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,d4(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),F4(r.remoteStore,i.targetId),r6(r,i.targetId)}).catch(R1);case 9:e.next=14;break;case 11:return r6(r,i.targetId),e.next=14,d4(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),$5.apply(this,arguments)}function Z5(){return Z5=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=v6(t),e.prev=1,e.next=4,function(e,t){var n,r,i=a1(e),a=C1.now(),o=t.reduce(function(e,t){return e.add(t.key)},j2());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=V2(),u=j2();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=Gg(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=b2(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new P2(c.key,l,C0(l.value.mapValue),y2.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:G2(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),s=i,u=a.batchId,c=r,l=void 0,(l=s.oc[s.currentUser.toKey()])||(l=new V1(m1)),l=l.insert(u,c),s.oc[s.currentUser.toKey()]=l,e.next=9,u6(i,a.changes);case 9:return e.next=11,J4(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=k5(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}var s,u,c,l},e,null,[[1,13]])})),Z5.apply(this,arguments)}function q5(e,t){return W5.apply(this,arguments)}function W5(){return W5=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a1(t),e.prev=1,e.next=4,l4(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(i1(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?i1(n.Xu):e.removedDocuments.size>0&&(i1(n.Xu),n.Xu=!1))}),e.next=8,u6(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,R1(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),W5.apply(this,arguments)}function j5(e,t,n){var r=a1(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=a1(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Gg(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&R5(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Y5(e,t,n){return K5.apply(this,arguments)}function K5(){return K5=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=a1(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new V1(P1.comparator)).insert(o,w0.newNoDocument(o,w1.min())),u=j2().add(o),c=new Q2(w1.min(),new Map,new G1(m1),s,u),e.next=9,q5(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),s6(i),e.next=16;break;case 14:return e.next=16,d4(i.localStore,n,!1).then(function(){return r6(i,n,r)}).catch(R1);case 16:case"end":return e.stop()}},e)})),K5.apply(this,arguments)}function Q5(e,t){return X5.apply(this,arguments)}function X5(){return X5=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a1(t),i=n.batch.batchId,e.prev=1,e.next=4,u4(r.localStore,n);case 4:return a=e.sent,n6(r,i,null),t6(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,u6(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,R1(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),X5.apply(this,arguments)}function J5(e,t,n){return e6.apply(this,arguments)}function e6(){return e6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=a1(t),e.prev=1,e.next=4,function(e,t){var n=a1(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return i1(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,n6(i,n,r),t6(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,u6(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,R1(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),e6.apply(this,arguments)}function t6(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function n6(e,t,n){var r=a1(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function r6(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Gg(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||i6(e,t)})}function i6(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(F4(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),s6(e))}function a6(e,t,n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof M5?(e.rc.addReference(a.key,t),o6(e,a)):a instanceof N5?(JJ("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||i6(e,a.key)):r1()}}catch(o){i.e(o)}finally{i.f()}}function o6(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(JJ("SyncEngine","New document in limbo: "+n),e.nc.add(r),s6(e))}function s6(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new P1(b1.fromString(t)),r=e.cc.next();e.ic.set(r,new F5(n)),e.sc=e.sc.insert(n,r),L4(e.remoteStore,new L3(W0(G0(n.path)),r,2,D1.ot))}}function u6(e,t,n){return c6.apply(this,arguments)}function c6(){return c6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a1(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=r4.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a1(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return M1.forEach(n,function(t){return M1.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return M1.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),N1(e.t0)){e.next=10;break}throw e.t0;case 10:JJ("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Gg(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),c6.apply(this,arguments)}function l6(e,t){return f6.apply(this,arguments)}function f6(){return f6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=a1(t)).currentUser.isEqual(n)){e.next=12;break}return JJ("SyncEngine","User change. New user:",n.toKey()),e.next=5,o4(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new s1(o1.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,u6(r,i.Ki);case 12:case"end":return e.stop()}},e)})),f6.apply(this,arguments)}function h6(e,t){var n=a1(e),r=n.ic.get(t);if(r&&r.Xu)return j2().add(r.key);var i=j2(),a=n.ec.get(t);if(!a)return i;var o,s=Gg(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function d6(e){var t=a1(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=q5.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=h6.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Y5.bind(null,t),t.Zu.Go=I5.bind(null,t.eventManager),t.Zu.lc=A5.bind(null,t.eventManager),t}function v6(e){var t=a1(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Q5.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=J5.bind(null,t),t}var p6=function(){function e(){Zg(this,e),this.synchronizeTabs=!1}return Wg(e,[{key:"initialize",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=E4(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new a4(e,t,n,r)}(this.persistence,new i4,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new e4(n4.Ms,this.wt)}},{key:"dc",value:function(e){return new y4}},{key:"terminate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),g6=function(){function e(){Zg(this,e)}return Wg(e,[{key:"initialize",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return j5(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=l6.bind(null,n.syncEngine),r.next=12,function(e,t){return p5.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new E5}},{key:"createDatastore",value:function(e){var t=E4(e.databaseInfo.databaseId),n=new _4(e.databaseInfo);return new I4(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return j5(o.syncEngine,e,0)},a=k4.V()?new k4:new m4,new R4(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new U5(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a1(t),JJ("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,N4(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),y6=function(){function e(t){Zg(this,e),this.observer=t,this.muted=!1}return Wg(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),m6=function(){function e(t,n,r,i){var a=this;Zg(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=YJ.UNAUTHENTICATED,this.clientId=y1.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return JJ("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return JJ("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return Wg(e,[{key:"getConfiguration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new s1(o1.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new u1;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=k5(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function k6(e,t){return C6.apply(this,arguments)}function C6(){return C6=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),JJ("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,o4(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),C6.apply(this,arguments)}function w6(e,t){return _6.apply(this,arguments)}function _6(){return _6=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,b6(t);case 3:return r=e.sent,JJ("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return d5(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return d5(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),_6.apply(this,arguments)}function b6(e){return E6.apply(this,arguments)}function E6(){return E6=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return JJ("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,k6(t,new p6);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),E6.apply(this,arguments)}function S6(e){return P6.apply(this,arguments)}function P6(){return P6=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return JJ("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,w6(t,new g6);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),P6.apply(this,arguments)}function O6(e){return T6.apply(this,arguments)}function T6(){return T6=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S6(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=V5.bind(null,n.syncEngine),r.onUnlisten=H5.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),T6.apply(this,arguments)}var I6=new Map;function A6(e,t,n){if(!n)throw new s1(o1.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function R6(e){if(!P1.isDocumentKey(e))throw new s1(o1.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function x6(e){if(P1.isDocumentKey(e))throw new s1(o1.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function M6(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":r1()}function N6(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new s1(o1.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=M6(e);throw new s1(o1.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var D6=function(){function e(t){var n;if(Zg(this,e),void 0===t.host){if(void 0!==t.ssl)throw new s1(o1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new s1(o1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new s1(o1.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return Wg(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),L6=function(){function e(t,n,r){Zg(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D6({}),this._settingsFrozen=!1,t instanceof e0?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new s1(o1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new e0(e.options.projectId)}(t))}return Wg(e,[{key:"app",get:function(){if(!this._app)throw new s1(o1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new s1(o1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D6(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new l1;switch(e.type){case"gapi":var t=e.client;return i1(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new d1(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new s1(o1.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=I6.get(e))&&(JJ("ComponentProvider","Removing Datastore"),I6.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),F6=function(){function e(t,n,r){Zg(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return Wg(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new V6(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),U6=function(){function e(t,n,r){Zg(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return Wg(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),V6=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,G0(i)))._path=i,a.type="collection",a}return Wg(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new F6(this.firestore,null,new P1(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(U6);function B6(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=DB(e),1===arguments.length&&(t=y1.I()),A6("doc","path",t),e instanceof L6){var a=b1.fromString.apply(b1,[t].concat(r));return R6(a),new F6(e,null,new P1(a))}if(!(e instanceof F6||e instanceof V6))throw new s1(o1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(b1.fromString.apply(b1,[t].concat(r)));return R6(o),new F6(e.firestore,e instanceof V6?e.converter:null,new P1(o))}var z6=function(){function e(){var t=this;Zg(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new S4(this,"async_queue_retry"),this.Kc=function(){var e=b4();e&&JJ("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=b4();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return Wg(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=b4();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new u1;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),N1(t.t0)){t.next=12;break}throw t.t0;case 12:JJ("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,e1("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=m5.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&r1()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=Gg(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Gg(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function G6(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var H6=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new z6,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return Wg(n,[{key:"_terminate",value:function(){return this._firestoreClient||Z6(this),this._firestoreClient.terminate()}}]),n}(L6);function $6(e){return e._firestoreClient||Z6(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Z6(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new J1(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new m6(e._authCredentials,e._appCheckCredentials,e._queue,a)}var q6=function(){function e(){Zg(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new s1(o1.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new S1(n)}return Wg(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),W6=function(){function e(t){Zg(this,e),this._byteString=t}return Wg(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Z1.fromBase64String(t))}catch(n){throw new s1(o1.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(Z1.fromUint8Array(t))}}]),e}(),j6=Wg(function e(t){Zg(this,e),this._methodName=t}),Y6=function(){function e(t,n){if(Zg(this,e),!isFinite(t)||t<-90||t>90)throw new s1(o1.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new s1(o1.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Wg(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return m1(this._lat,e._lat)||m1(this._long,e._long)}}]),e}(),K6=/^__.*__$/,Q6=function(){function e(t,n,r){Zg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Wg(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new P2(e,this.data,this.fieldMask,t,this.fieldTransforms):new S2(e,this.data,t,this.fieldTransforms)}}]),e}(),X6=function(){function e(t,n,r){Zg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Wg(e,[{key:"toMutation",value:function(e,t){return new P2(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function J6(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw r1()}}var e8=function(){function e(t,n,r,i,a,o){Zg(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return Wg(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return d8(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(J6(this.Zc)&&K6.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),t8=function(){function e(t,n,r){Zg(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||E4(t)}return Wg(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new e8({Zc:e,methodName:t,ca:n,path:S1.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function n8(e){var t=e._freezeSettings(),n=E4(e._databaseId);return new t8(e._databaseId,!!t.ignoreUndefinedProperties,n)}function r8(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);c8("Data must be an object, but it was:",o,r);var s,u,c=s8(r,o);if(a.merge)s=new $1(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=Gg(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=l8(t,d,n);if(!o.contains(v))throw new s1(o1.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));v8(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new $1(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new Q6(new k0(c),s,u)}var i8=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(j6),a8=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"_toFieldTransform",value:function(e){return new p2(e.path,new s2)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(j6);function o8(e,t){if(u8(e=DB(e)))return c8("Unsupported field value:",t,e),s8(e,t);if(e instanceof j6)return function(e,t){if(!J6(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Gg(e);try{for(a.s();!(n=a.n()).done;){var o=o8(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=DB(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!n0(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?n2(t):t2(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=C1.fromDate(e);return{timestampValue:c3(t.wt,n)}}if(e instanceof C1){var r=new C1(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:c3(t.wt,r)}}if(e instanceof Y6)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof W6)return{bytesValue:l3(t.wt,e._byteString)};if(e instanceof F6){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:d3(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(M6(e)))}(e,t)}function s8(e,t){var n={};return U1(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):F1(e,function(e,r){var i=o8(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function u8(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof C1||e instanceof Y6||e instanceof W6||e instanceof F6||e instanceof j6)}function c8(e,t,n){if(!u8(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=M6(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function l8(e,t,n){if((t=DB(t))instanceof q6)return t._internalPath;if("string"==typeof t)return h8(e,t);throw d8("Field path arguments must be of type string or ",e,!1,void 0,n)}var f8=new RegExp("[~\\*/\\[\\]]");function h8(e,t,n){if(t.search(f8)>=0)throw d8("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Ag(q6,Bg(t.split(".")))._internalPath}catch(r){throw d8("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function d8(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new s1(o1.INVALID_ARGUMENT,s+e+u)}function v8(e,t){return e.some(function(e){return e.isEqual(t)})}var p8=function(){function e(t,n,r,i,a){Zg(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Wg(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new F6(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new g8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(y8("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),g8=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"data",value:function(){return Rg(Vg(n.prototype),"data",this).call(this)}}]),n}(p8);function y8(e,t){return"string"==typeof t?h8(e,t):t instanceof q6?t._internalPath:t._delegate._internalPath}var m8=function(){function e(t,n){Zg(this,e),this.hasPendingWrites=t,this.fromCache=n}return Wg(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),k8=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Wg(n,[{key:"exists",value:function(){return Rg(Vg(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new C8(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(y8("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(p8),C8=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Rg(Vg(n.prototype),"data",this).call(this,e)}}]),n}(k8),w8=function(){function e(t,n,r,i){Zg(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new m8(i.hasPendingWrites,i.fromCache),this.query=r}return Wg(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new C8(n._firestore,n._userDataWriter,r.key,r,new m8(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new s1(o1.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new C8(e._firestore,e._userDataWriter,t.doc.key,t.doc,new m8(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new C8(e._firestore,e._userDataWriter,t.doc.key,t.doc,new m8(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:_8(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function _8(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return r1()}}function b8(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new s1(o1.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var E8=Wg(function e(){Zg(this,e)});var S8=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return Wg(n,[{key:"_apply",value:function(e){var t,n,r,i=n8(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new s1(o1.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){I8(o,a);var u,c=[],l=Gg(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(T8(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=T8(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||I8(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return o8(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=O0.create(i,a,s);return function(e,t){if(t.ht()){var n=$0(e);if(null!==n&&!n.isEqual(t.field))throw new s1(o1.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=H0(e);null!==r&&A8(0,t.field,r)}var i=function(e,t){var n,r=Gg(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new s1(o1.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new U6(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new z0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(E8);var P8=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return Wg(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new s1(o1.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new s1(o1.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new F0(t,n);return function(e,t){if(null===H0(e)){var n=$0(e);null!==n&&A8(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new U6(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new z0(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(E8);var O8=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return Wg(n,[{key:"_apply",value:function(e){return new U6(e.firestore,e.converter,j0(e._query,this.ma,this.ga))}}]),n}(E8);function T8(e,t,n){if("string"==typeof(n=DB(n))){if(""===n)throw new s1(o1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z0(t)&&-1!==n.indexOf("/"))throw new s1(o1.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(b1.fromString(n));if(!P1.isDocumentKey(r))throw new s1(o1.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return f0(e,new P1(r))}if(n instanceof F6)return f0(e,n._key);throw new s1(o1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(M6(n),"."))}function I8(e,t){if(!Array.isArray(e)||0===e.length)throw new s1(o1.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new s1(o1.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function A8(e,t,n){if(!n.isEqual(t))throw new s1(o1.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function R8(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var x8=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).firestore=e,r}return Wg(n,[{key:"convertBytes",value:function(e){return new W6(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new F6(this.firestore,null,t)}}]),n}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(i0(e)){case 0:return null;case 1:return e.booleanValue;case 2:return j1(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Y1(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw r1()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return F1(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new Y6(j1(e.latitude),j1(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Q1(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(X1(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=W1(e);return new C1(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=b1.fromString(e);i1(x3(n));var r=new e0(n.get(1),n.get(3)),i=new P1(n.popFirst(5));return r.isEqual(t)||e1("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function M8(e,t){return n=$6(e),r=t,i=new u1,n.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return Z5.apply(this,arguments)},e.next=3,function(e){return S6(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function N8(e,t,n){var r=n.docs.get(t._key),i=new x8(e);return new k8(e,i,t._key,r,new m8(n.hasPendingWrites,n.fromCache),t.converter)}function D8(){return new a8("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];KJ="9.9.0",mz(new UB("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new H6(i,new f1(e.getProvider("auth-internal")),new p1(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),Sz(jJ,"3.4.12",e),Sz(jJ,"3.4.12","esm2017")}();var L8=Wg(function e(t){return Zg(this,e),t}),F8=new YC("angularfire2.firestore-instances");function U8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new L8(r)}}var V8={provide:Wg(function e(){return Zg(this,e),mZ("firestore")}),deps:[[new bw,F8]]},B8={provide:L8,useFactory:function(e,t){var n=yZ("firestore",e,t);return n&&new L8(n)},deps:[[new bw,F8],IZ]},z8=function(){var e=Wg(function e(){Zg(this,e),Sz("angularfire",lZ.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[B8,V8]}),e}(),G8=TZ(function(e,t){var n=N6(e.firestore,H6),r=B6(e),i=R8(e.converter,t);return M8(n,[r8(n8(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,y2.exists(!1))]).then(function(){return r})},!0),H8=TZ(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=DB(e),A6("collection","path",t),e instanceof L6){var a=b1.fromString.apply(b1,[t].concat(r));return x6(a),new V6(e,null,a)}if(!(e instanceof F6||e instanceof V6))throw new s1(o1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(b1.fromString.apply(b1,[t].concat(r)));return x6(o),new V6(e.firestore,null,o)},!0),$8=TZ(function(e){return M8(N6(e.firestore,H6),[new x2(e._key,y2.none())])},!0),Z8=TZ(B6,!0),q8=TZ(function(e){e=N6(e,F6);var t=N6(e.firestore,H6);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new u1;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new y6({next:function(a){t.enqueueAndForget(function(){return O5(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new s1(o1.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new s1(o1.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new x5(G0(n.path),a,{includeMetadataChanges:!0,Du:!0});return S5(e,o)},i.next=3,O6(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}($6(t),e._key).then(function(n){return N8(t,e,n)})},!0),W8=TZ(function(e){e=N6(e,U6);var t=N6(e.firestore,H6),n=$6(t),r=new x8(t);return b8(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new u1;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new y6({next:function(n){t.enqueueAndForget(function(){return O5(e,o)}),n.fromCache&&"server"===r.source?i.reject(new s1(o1.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new x5(n,a,{includeMetadataChanges:!0,Du:!0});return S5(e,o)},i.next=3,O6(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new w8(t,r,e,n)})},!0),j8=TZ(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bz();return kz(e,"firestore").getImmediate()},!0),Y8=TZ(function(e){return function(e,t){if(t<=0)throw new s1(o1.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new O8("limit",e,"F")},!0),K8=TZ(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=DB(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||G6(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(G6(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof F6)l=N6(e.firestore,H6),f=G0(e._key.path),c={next:function(t){n[u]&&n[u](N8(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=N6(e,U6);l=N6(v.firestore,H6),f=v._query;var p=new x8(l);c={next:function(e){n[u]&&n[u](new w8(l,p,v,e))},error:n[u+1],complete:n[u+2]},b8(e._query)}return function(e,t,n,r){var i=new y6(r),a=new x5(t,i,n);return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=S5,t.next=3,O6(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=O5,t.next=3,O6(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}($6(l),f,h,c)},!0),Q8=TZ(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=y8("orderBy",e);return new P8(r,n)},!0),X8=TZ(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),J8=TZ(function(e,t,n){e=N6(e,F6);var r=N6(e.firestore,H6),i=R8(e.converter,t,n);return M8(r,[r8(n8(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,y2.none())])},!0),e7=TZ(function(e,t,n){e=N6(e,F6);for(var r,i=N6(e.firestore,H6),a=n8(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=DB(t))||t instanceof q6?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[l8(t,r,n)],u=[i];if(a.length%2!=0)throw new s1(o1.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(l8(t,a[c])),u.push(a[c+1]);for(var l=[],f=k0.empty(),h=s.length-1;h>=0;--h)if(!v8(l,s[h])){var d=s[h],v=u[h];v=DB(v);var p=o.ia(d);if(v instanceof i8)l.push(d);else{var g=o8(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new $1(l);return new X6(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);c8("Data must be an object, but it was:",i,r);var a=[],o=k0.empty();F1(r,function(e,r){var s=h8(t,e,n);r=DB(r);var u=i.ia(s);if(r instanceof i8)a.push(s);else{var c=o8(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new $1(a);return new X6(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),M8(i,[r.toMutation(e._key,y2.exists(!0))])},!0),t7=TZ(function(e,t,n){var r=t,i=y8("where",e);return new S8(i,r,n)},!0),n7=function(){var e=function(){function e(t,n){Zg(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=H8(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return Wg(e,[{key:"create",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,G8(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,q8(Z8(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?fB.of(oB.getNonNullable(i.data())):fB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),e7(Z8(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return sB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),$8(Z8(this.collection,t))}},{key:"set",value:function(t,n){return sB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),J8(Z8(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return K8(Z8(this.collection,e),function(e){t(fB.ofNullable(e.data()))})}},{key:"findWhere",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,W8(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;sB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return K8(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(sB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(sB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(sB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))})}},{key:"constructQuery",value:function(e,t,n){var r=X8(this.collection);null!=t&&(r=X8(r,Q8(t))),null!=n&&(r=X8(r,Y8(n)));var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=X8(r,t7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,r,e)}return Wg(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),r7=function(){function e(){Zg(this,e)}return Wg(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&lB(this.get(),e.get())}}],[{key:"success",value:function(e){return new i7(e)}},{key:"failure",value:function(e){return new a7(e)}}]),e}(),i7=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).value=e,r}return Wg(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return fB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(r7),a7=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).reason=e,r}return Wg(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return fB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(r7),o7=function(){function e(t){Zg(this,e),this.reason=t}return Wg(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?r7.success(e):r7.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return r7.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();o7.SUCCESS=new o7(null);var s7=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,"errors",e)}return Wg(n,[{key:"findErrors",value:function(e,t,n,r){return this.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}}]),n}(n7);return e.\u0275fac=function(t){return new(t||e)(pw(L8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),u7=Tg(5378),c7=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,u7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),l7=function(){function t(e,n,r){Zg(this,t),this.errorDAO=e,this.router=n,this.messageDisplayer=r,t.setSingletonInstance(this)}return Wg(t,[{key:"logError",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(e||(e=_g(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.errorDAO.findErrors(t,o,n,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:t,route:o,message:n,firstEncounter:D8(),lastEncounter:D8(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:D8(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(e){t.singleton=fB.of(e)}},{key:"logErrorAndFail",value:function(e,n,r){throw t.logError(e,n,r),new Error("".concat(e,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),o7.failure(e+": "+t)}}]),t}();function f7(e,t){if(!1===e)throw l7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}l7.singleton=fB.empty(),l7.\u0275fac=function(e){return new(e||l7)(pw(s7),pw(jL),pw(c7))},l7.\u0275prov=dm({token:l7,factory:l7.\u0275fac,providedIn:"root"});var h7=Wg(function e(t){Zg(this,e),this.value=t});h7.HARD_DRAW=new h7(0),h7.RESIGN=new h7(1),h7.ESCAPE=new h7(2),h7.VICTORY=new h7(3),h7.TIMEOUT=new h7(4),h7.UNACHIEVED=new h7(5),h7.AGREED_DRAW_BY_ZERO=new h7(6),h7.AGREED_DRAW_BY_ONE=new h7(7);var d7=function(){function e(t,n){Zg(this,e),this.id=t,this.data=n}return Wg(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===h7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===h7.AGREED_DRAW_BY_ZERO.value||this.data.result===h7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===h7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(f7(this.data.result===h7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),oB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===h7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===h7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===h7.RESIGN.value}},{key:"getWinner",value:function(){return fB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return fB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Eg(Eg({},this.data),{},{winner:t,loser:n}))}}]),e}(),v7=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"parts",e),sB(n.VERBOSE,"PartDAO.constructor"),r}return Wg(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Eg(Eg({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",h7.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",h7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",h7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(n7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(L8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),p7=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"chats",e),sB(n.VERBOSE,"ChatDAO.constructor"),r}return Wg(n,[{key:"addMessage",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}}]),n}(n7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(L8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),g7=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_SEND_MESSAGE=function(){return $localize(t||(t=_g(["You're not allowed to send a message here."])))},e.FORBIDDEN_MESSAGE=function(){return $localize(n||(n=_g(["This message is forbidden."])))},e}(),y7=function(){var e=function(){function e(t){Zg(this,e),this.chatDAO=t,this.followedChatId=fB.empty(),sB(e.VERBOSE,"ChatService.constructor")}return Wg(e,[{key:"startObserving",value:function(t,n){sB(e.VERBOSE,"ChatService.startObserving "+t),this.followedChatId.isAbsent()?(sB(e.VERBOSE,"[start watching chat "+t),this.followedChatId=fB.of(t),this.followedChatUnsubscribe=this.chatDAO.subscribeToMessages(t,n)):this.followedChatId.equalsValue(t)?l7.logErrorAndFail("ChatService","Already observing same chat",{chatId:t}):l7.logErrorAndFail("ChatService","Already observing another chat",{chatId:t,followedChatId:this.followedChatId.get()})}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");sB(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=fB.empty(),this.followedChatUnsubscribe()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",o7.failure("Cannot send message if not observing chat"));case 2:if(a=r.followedChatId.get(),!1!==r.userCanSendMessage(e.name,a)){i.next=5;break}return i.abrupt("return",o7.failure(g7.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",o7.failure(g7.FORBIDDEN_MESSAGE()));case 7:return o={content:t,sender:e,postedTime:D8(),currentTurn:n},i.next=10,r.chatDAO.addMessage(a,o);case 10:return i.abrupt("return",o7.SUCCESS);case 11:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(p7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),m7=Wg(function e(t,n,r){Zg(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),k7=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,n.COLLECTION_NAME,e),sB(n.VERBOSE,"UserDAO.constructor"),r}return Wg(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}},{key:"updatePresenceToken",value:function(e){return this.update(e,{lastUpdateTime:D8()})}}]),n}(n7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(pw(L8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),C7=function(){var e=function(){function e(t){Zg(this,e),this.userDAO=t,this.activeUsersBS=new nN([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return Wg(e,[{key:"startObserving",value:function(){var t=this;sB(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new m7(function(n){var r;sB(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,Bg(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;sB(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,a=Gg(n);try{var o=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=oB.getNonNullable(e.data).lastUpdateTime,r=oB.getNonNullable(n).seconds,i=oB.getNonNullable(t.data).lastUpdateTime;return r-oB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(k7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),w7=function(){var e=function(){function e(t,n){Zg(this,e),this.activeUsersService=t,this.userDAO=n}return Wg(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",fB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",(f7(null!=i,"should not receive a lastUpdateTime equal to null"),fB.of(i)));case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(C7),pw(k7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),_7=function(e){Mg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aZ;return Zg(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return Wg(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),Rg(Vg(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Cy),b7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return DY(e,t,n)}},{key:"sendEmailVerification",value:function(e){return UY(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return VY(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,BY(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,zY(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return GY(e,t)}}]),e}(),E7=function(){function e(t,n,r,i){Zg(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return Wg(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();E7.NOT_CONNECTED=new E7("",fB.empty(),fB.empty(),!1);var S7=function(){var e=function(){function e(t,n){Zg(this,e);var r,i=this;this.userDAO=t,this.auth=n,this.user=fB.empty(),this.userUnsubscribe=fB.empty(),sB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new _7(1),this.userObs=this.userRS.asObservable(),this.unsubscribeFromAuth=FY(this.auth,(r=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(sB(e.VERBOSE,"User is not connected"),i.userUnsubscribe.isPresent()&&i.userUnsubscribe.get()(),i.userRS.next(E7.NOT_CONNECTED),i.user=fB.empty()):(f7(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userUnsubscribe=fB.of(i.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;sB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(i.emailVerified(n)));var a=!0===i.emailVerified(n)&&null!=r;if(!0===a&&!1===t.get().verified)return i.userDAO.markAsVerified(n.uid);var o=new E7(n.uid,fB.ofNullable(n.email),fB.ofNullable(r),a);i.user=fB.of(o),i.userRS.next(o)}})));case 1:case"end":return t.stop()}},t)})),function(e){return r.apply(this,arguments)}))}return Wg(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",o7.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",o7.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return aB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=r7.failure($localize(r||(r=_g(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,b7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,b7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=oB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",r7.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",r7.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=_g(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=_g(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=_g(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=_g(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=_g(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=_g(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=_g(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(f||(f=_g(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return l7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=fB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",l7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",l7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,b7.sendEmailVerification(r.get());case 9:return n.abrupt("return",o7.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",o7.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,b7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",o7.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",o7.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=o7,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new KW).addScope("profile"),n.addScope("email"),t.next=5,b7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",r7.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",r7.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!fB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=o7.SUCCESS,t.next=7;break;case 6:t.t0=o7.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",o7.failure($localize(h||(h=_g(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",o7.failure($localize(d||(d=_g(["This username is already in use, please select a different one."])))));case 9:return r=oB.getNonNullable(t.auth.currentUser),n.next=12,b7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",o7.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",o7.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=oB.getNonNullable(t.auth.currentUser),n.next=4,b7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",o7.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",o7.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return f7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return f7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return f7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userDAO.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userUnsubscribe.isPresent()&&this.userUnsubscribe.get()(),this.unsubscribeFromAuth()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(k7),pw(OY))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),P7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return f7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();P7.CREATOR=new P7("CREATOR"),P7.RANDOM=new P7("RANDOM"),P7.CHOSEN_PLAYER=new P7("CHOSEN_PLAYER");var O7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();O7.STANDARD=new O7("STANDARD"),O7.BLITZ=new O7("BLITZ"),O7.CUSTOM=new O7("CUSTOM"),O7.NORMAL_MOVE_DURATION=120,O7.NORMAL_PART_DURATION=1800,O7.BLITZ_MOVE_DURATION=30,O7.BLITZ_PART_DURATION=900;var T7=Wg(function e(t){Zg(this,e),this.value=t});T7.PART_CREATED=new T7(0),T7.CONFIG_PROPOSED=new T7(2),T7.PART_STARTED=new T7(3),T7.PART_FINISHED=new T7(4);var I7=Wg(function e(){Zg(this,e)}),A7=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return f7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){Mg(s,n);var o=Dg(s);function s(){return Zg(this,s),o.apply(this,arguments)}return Wg(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=oB.getNonNullable(n).type,a=oB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(I7),R7=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return f7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Mg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Mg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Mg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Mg(r,t);var n=Dg(r);function r(){return Zg(this,r),n.apply(this,arguments)}return Wg(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(A7);R7.booleanEncoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(R7));var x7=function(){function e(){Zg(this,e),this.value=2}return Wg(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PlayerNone"}},{key:"equals",value:function(e){return this===e}}]),e}();x7.NONE=new x7;var M7,N7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(oB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(oB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();N7.numberEncoder=R7.ofN(2,function(e){return e.value},function(e){return 2===e?M7.NONE:N7.of(e)}),N7.ZERO=new N7(0),N7.ONE=new N7(1),N7.PLAYERS=[N7.ZERO,N7.ONE],function(e){e.ZERO=N7.ZERO,e.ONE=N7.ONE,e.NONE=x7.NONE}(M7||(M7={}));var D7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"rematchAccepted",value:function(e,t){return L7("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return N7.of(oB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return oB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return oB.getNonNullable(e.data).partId}}]),e}();function L7(e,t){return{code:e,data:t}}function F7(e){return function(t){return L7(e,{player:t.value})}}D7.drawProposed=F7("DrawProposed"),D7.drawAccepted=L7("DrawAccepted",{}),D7.drawRefused=F7("DrawRefused"),D7.takeBackAsked=F7("TakeBackAsked"),D7.takeBackRefused=F7("TakeBackRefused"),D7.takeBackAccepted=F7("TakeBackAccepted"),D7.rematchProposed=F7("RematchProposed"),D7.addTurnTime=F7("AddTurnTime"),D7.addGlobalTime=F7("AddGlobalTime");var U7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===lB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),V7=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"config-room",e),sB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return Wg(n,[{key:"addCandidate",value:function(e,t){return this.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.subCollectionDAO(e,"candidates").delete(t.id)}}]),n}(n7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(L8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B7=function(){var e=function(){function e(t,n){Zg(this,e),this.configRoomDAO=t,this.connectedUserService=n,this.configRoomUnsubscribe=fB.empty(),this.candidatesUnsubscribe=fB.empty(),sB(e.VERBOSE,"ConfigRoomService.constructor")}return Wg(e,[{key:"subscribeToChanges",value:function(e,t){this.observedConfigRoomId=e,this.configRoomUnsubscribe=fB.of(this.configRoomDAO.subscribeToChanges(e,t))}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new m7(function(e){var r,i=Gg(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Gg(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Gg(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)}),i=this.configRoomDAO.subCollectionDAO(e,"candidates");this.candidatesUnsubscribe=fB.of(i.observingWhere([],r))}},{key:"unsubscribe",value:function(){f7(this.configRoomUnsubscribe.isPresent(),"ConfigRoomService cannot unsubscribe if no configRoom is observed"),f7(this.candidatesUnsubscribe.isPresent(),"ConfigRoomService cannot unsubscribe if no configRoom is observed"),this.configRoomUnsubscribe.get()(),this.configRoomUnsubscribe=fB.empty(),this.candidatesUnsubscribe.get()(),this.candidatesUnsubscribe=fB.empty()}},{key:"createInitialConfigRoom",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.set(t,{chosenOpponent:null,firstPlayer:P7.RANDOM.value,partType:O7.STANDARD.value,partStatus:T7.PART_CREATED.value,maximalMoveDuration:O7.NORMAL_MOVE_DURATION,totalPartDuration:O7.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=o7.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.configRoomDAO.addCandidate(t,i);case 13:r.t0=o7.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"removeCandidate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(f7(null!=t.observedConfigRoomId,"cannot remove candidate if not observing a configRoom"),t.configRoomDAO.removeCandidate(oB.getNonNullable(t.observedConfigRoomId),e)));case 1:case"end":return n.stop()}},n)}))()}},{key:"cancelJoining",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"ConfigRoomService.cancelJoining(); this.observedConfigRoomId = "+t.observedConfigRoomId),null!=t.observedConfigRoomId){n.next=2;break}throw new Error("cannot cancel joining when not observing a configRoom");case 2:return r=t.connectedUserService.user.get().toMinimalUser(),n.next=5,t.configRoomDAO.read(t.observedConfigRoomId);case 5:if((i=n.sent).isAbsent()){n.next=11;break}return o=i.get(),s=[t.configRoomDAO.removeCandidate(t.observedConfigRoomId,r)],(null===(a=o.chosenOpponent)||void 0===a?void 0:a.id)===r.id&&s.push(t.configRoomDAO.update(t.observedConfigRoomId,{chosenOpponent:null,partStatus:T7.PART_CREATED.value})),n.next=11,Promise.all(s);case 11:case"end":return n.stop()}},n)}))()}},{key:"deleteConfigRoom",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(); this.observedConfigRoomId = "+n.observedConfigRoomId),f7(null!=n.observedConfigRoomId,"ConfigRoomService is not observing a configRoom"),i=oB.getNonNullable(n.observedConfigRoomId),r.next=4,Promise.all(t.map(function(e){return n.configRoomDAO.removeCandidate(i,e)}));case 4:return r.next=6,n.configRoomDAO.delete(i);case 6:case"end":return r.stop()}},r)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a){var o=this;return aB(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(sB(e.VERBOSE,{configRoomService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:a}}),sB(e.VERBOSE,"this.followedConfigRoomId: "+o.observedConfigRoomId),f7(null!=o.observedConfigRoomId,"ConfigRoomService is not observing a configRoom"),o.configRoomDAO.update(oB.getNonNullable(o.observedConfigRoomId),{partStatus:T7.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:a,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenOpponent",value:function(t){return sB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t.name,")")),this.configRoomDAO.update(oB.getNonNullable(this.observedConfigRoomId),{chosenOpponent:t})}},{key:"reviewConfig",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.reviewConfig"),f7(null!=t.observedConfigRoomId,"ConfigRoomService is not observing a configRoom"),t.configRoomDAO.update(oB.getNonNullable(t.observedConfigRoomId),{partStatus:T7.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.reviewConfig"),f7(null!=t.observedConfigRoomId,"ConfigRoomService is not observing a configRoom"),t.configRoomDAO.update(oB.getNonNullable(t.observedConfigRoomId),{partStatus:T7.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return n.stop()}},n)}))()}},{key:"acceptConfig",value:function(){return sB(e.VERBOSE,"ConfigRoomService.acceptConfig"),f7(null!=this.observedConfigRoomId,"ConfigRoomService is not observing a configRoom"),this.configRoomDAO.update(oB.getNonNullable(this.observedConfigRoomId),{partStatus:T7.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.create("+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.readConfigRoomById("+t+")"),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.set("+t+", "+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateConfigRoomById",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,{configRoomService_updateConfigRoomById:{partId:t,update:n}}),r.configRoomDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(v||(v=_g(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(pw(V7),pw(S7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),z7=function(){var e=function(){function e(t,n,r,i){Zg(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,this.followedPartId=fB.empty(),sB(e.VERBOSE,"GameService.constructor")}return Wg(e,[{key:"getPartValidity",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?o7.failure("NONEXISTENT_PART"):i.get().typeGame===t?o7.SUCCESS:o7.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){sB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:h7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return sB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){sB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=P7.of(e.firstPlayer);return r===P7.RANDOM&&(r=Math.random()<.5?P7.CREATOR:P7.CHOSEN_PLAYER),r===P7.CREATOR?(t=e.creator,n=oB.getNonNullable(e.chosenOpponent)):(t=oB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:D8(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return sB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,N7.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");sB(e.VERBOSE,"[start watching part "+t),this.followedPartId=fB.of(t),this.followedPartUnsubscribe=this.partDAO.subscribeToChanges(t,n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:h7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:h7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,D7.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===N7.ZERO?h7.AGREED_DRAW_BY_ZERO:h7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,D7.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,D7.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return sB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=oB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=oB.getNonNullable(o.playerOne),u=P7.CHOSEN_PLAYER):(l=o.playerZero,u=P7.CREATOR),f=Eg(Eg({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:T7.PART_STARTED.value}),h=i.getStartingConfig(f),d=Eg({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:h7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,D7.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,D7.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return f7(D7.getPlayer(oB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=D7.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:D8(),remainingMsForZero:oB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:oB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=D7.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:D7.addGlobalTime(r.getOpponent())},o=r===N7.ZERO?Eg(Eg({},o),{},{remainingMsForOne:oB.getNonNullable(n.remainingMsForOne)+3e5}):Eg(Eg({},o),{},{remainingMsForZero:oB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.partDAO.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:D7.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){sB(e.VERBOSE,"GameService.stopObserving();"),this.followedPartId=fB.empty(),this.followedPartUnsubscribe()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return aB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return sB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=U7.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:D8()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=Eg(Eg({},p),{},{winner:s,loser:u,result:h7.VICTORY.value}):!0===o&&(p=Eg(Eg({},p),{},{result:h7.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Eg(Eg({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Eg(Eg({},e),{},{remainingMsForZero:oB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Eg(Eg({},e),{},{remainingMsForOne:oB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(v7),pw(S7),pw(B7),pw(y7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),G7={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},H7={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},$7={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},Z7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),q7=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return fB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return Z7.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),W7=function(){var e=function(){function e(t,n){Zg(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return Wg(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return fB.of(t)}return fB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(q7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),j7={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},Y7={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},K7={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},Q7={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},X7={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},J7={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},e9={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function t9(e){return(t9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){n9(e,t,n[t])})}return e}function i9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a9={},o9={};try{"undefined"!=typeof window&&(a9=window),"undefined"!=typeof document&&(o9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(jye){}var s9=(a9.navigator||{}).userAgent,u9=void 0===s9?"":s9,c9=a9,l9=o9,f9=!!l9.documentElement&&!!l9.head&&"function"==typeof l9.addEventListener&&"function"==typeof l9.createElement,h9=(~u9.indexOf("MSIE")||u9.indexOf("Trident/"),"___FONT_AWESOME___"),d9="svg-inline--fa",v9=[1,2,3,4,5,6,7,8,9,10],p9=v9.concat([11,12,13,14,15,16,17,18,19,20]),g9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},y9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",g9.GROUP,g9.SWAP_OPACITY,g9.PRIMARY,g9.SECONDARY].concat(v9.map(function(e){return"".concat(e,"x")})).concat(p9.map(function(e){return"w-".concat(e)})),c9.FontAwesomeConfig||{});l9&&"function"==typeof l9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=i9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=l9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(y9[n]=r)});var m9=r9({},{familyPrefix:"fa",replacementClass:d9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},y9);m9.autoReplaceSvg||(m9.observeMutations=!1);var k9=r9({},m9);c9.FontAwesomeConfig=k9;var C9=c9||{};C9[h9]||(C9[h9]={}),C9[h9].styles||(C9[h9].styles={}),C9[h9].hooks||(C9[h9].hooks={}),C9[h9].shims||(C9[h9].shims=[]);var w9=C9[h9],_9=[];f9&&((l9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(l9.readyState)||l9.addEventListener("DOMContentLoaded",function e(){l9.removeEventListener("DOMContentLoaded",e),_9.map(function(e){return e()})}));var b9,E9="pending",S9="fulfilled",P9="rejected",O9=function(){},T9="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,I9="undefined"==typeof setImmediate?setTimeout:setImmediate,A9=[];function R9(){for(var e=0;e<A9.length;e++)A9[e][0](A9[e][1]);A9=[],b9=!1}function x9(e,t){A9.push([e,t]),b9||(b9=!0,I9(R9,0))}function M9(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=S9;try{r=i(r)}catch(o){F9(a,o)}}N9(a,r)||(n===S9&&D9(a,r),n===P9&&F9(a,r))}function N9(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===t9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?L9(e,r):D9(e,r))},function(t){n||(n=!0,F9(e,t))}),!0}}catch(i){return n||F9(e,i),!0}return!1}function D9(e,t){(e===t||!N9(e,t))&&L9(e,t)}function L9(e,t){e._state===E9&&(e._state="settled",e._data=t,x9(V9,e))}function F9(e,t){e._state===E9&&(e._state="settled",e._data=t,x9(B9,e))}function U9(e){e._then=e._then.forEach(M9)}function V9(e){e._state=S9,U9(e)}function B9(e){e._state=P9,U9(e),!e._handled&&T9&&global.process.emit("unhandledRejection",e._data,e)}function z9(e){global.process.emit("rejectionHandled",e)}function G9(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof G9))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){F9(t,e)}try{e(function(e){D9(t,e)},n)}catch(r){n(r)}}(e,this)}G9.prototype={constructor:G9,_state:E9,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(O9),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===P9&&T9&&x9(z9,this)),this._state===S9||this._state===P9?x9(M9,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},G9.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new G9(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},G9.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new G9(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},G9.resolve=function(e){return e&&"object"===t9(e)&&e.constructor===G9?e:new G9(function(t){t(e)})},G9.reject=function(e){return new G9(function(t,n){n(e)})};var H9={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function $9(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Z9(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function q9(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function W9(e){return e.size!==H9.size||e.x!==H9.x||e.y!==H9.y||e.rotate!==H9.rotate||e.flipX||e.flipY}function j9(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var Y9={x:0,y:0,width:"100%",height:"100%"};function K9(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function Q9(e){return"g"===e.tag?e.children:[e]}function X9(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[k9.replacementClass,a?"".concat(k9.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:r9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||$9())},children:[u]});var _=r9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:r9({},w,f.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=j9({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:r9({},Y9,{fill:"white"})},l=o.children?{children:o.children.map(K9)}:{},f={tag:"g",attributes:r9({},u.inner),children:[K9(r9({tag:o.tag,attributes:r9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:r9({},u.outer),children:[f]},d="mask-".concat(a||$9()),v="clip-".concat(a||$9()),p={tag:"mask",attributes:r9({},Y9,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:Q9(s)},p]};return t.push(g,{tag:"rect",attributes:r9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},Y9)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=q9(e.styles);if(a.length>0&&(n.style=a),W9(i)){var o=j9({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:r9({},o.outer),children:[{tag:"g",attributes:r9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:r9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),E=b.attributes;return _.children=b.children,_.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:r9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(k9.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(W9(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=q9(r9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var J9=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function eee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof w9.hooks.addPack||i?w9.styles[e]=r9({},w9.styles[e]||{},a):w9.hooks.addPack(e,a),"fas"===e&&eee("fa",t)}var tee=w9.styles,nee=w9.shims,ree=function(){var e=function(e){return J9(tee,function(t,n,r){return t[r]=J9(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in tee;J9(nee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function iee(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function aee(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?Z9(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(Z9(e[n]),'" ')},"").trim()}(r),">").concat(a.map(aee).join(""),"</").concat(t,">")}function oee(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}ree(),(oee.prototype=Object.create(Error.prototype)).constructor=oee;var see={fill:"currentColor"},uee={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},cee=(r9({},see,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),r9({},uee,{attributeName:"opacity"}));function lee(e){var t=e[0],n=e[1],r=i9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(k9.familyPrefix,"-").concat(g9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(k9.familyPrefix,"-").concat(g9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(k9.familyPrefix,"-").concat(g9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}r9({},see,{cx:"256",cy:"364",r:"28"}),r9({},uee,{attributeName:"r",values:"28;14;28;28;14;28;"}),r9({},cee,{values:"1;0;1;1;0;1;"}),r9({},see,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),r9({},cee,{values:"1;0;0;0;0;1;"}),r9({},see,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),r9({},cee,{values:"0;0;1;1;0;0;"});var fee=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=r9({},e.definitions[t]||{},i[t]),eee(t,i[t]),ree()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function hee(){k9.autoAddCss&&!gee&&(function(e){if(e&&f9){var t=l9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=l9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}l9.head.insertBefore(t,r)}}(function(){var e="fa",t=d9,n=k9.familyPrefix,r=k9.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),gee=!0)}function dee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return aee(e)})}}),Object.defineProperty(e,"node",{get:function(){if(f9){var t=l9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function vee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return iee(pee.definitions,n,r)||iee(w9.styles,n,r)}var pee=new fee,gee=!1,yee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:vee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:vee(i||{})),e(r,r9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?H9:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return dee(r9({type:"icon"},e),function(){return hee(),k9.autoA11y&&(f?y["aria-labelledby"]="".concat(k9.replacementClass,"-title-").concat(d||$9()):(y["aria-hidden"]="true",y.focusable="false")),X9({icons:{main:lee(_),mask:s?lee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:r9({},H9,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),mee=["*"],kee=function(e){var t,n=(Sg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Sg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Sg(t,"fa-pull-".concat(e.pull),null!==e.pull),Sg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Cee=function(){var e=Wg(function e(){Zg(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),wee=function(){var e=function(){function e(){Zg(this,e),this.definitions={}}return Wg(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Gg(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,Bg(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),_ee=function(){var e=function(){function e(){Zg(this,e),this.stackItemSize="1x"}return Wg(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[uk]}),e}(),bee=function(){var e=function(){function e(t,n){Zg(this,e),this.renderer=t,this.elementRef=n}return Wg(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(fO),QE(uO))},e.\u0275cmp=Hm({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[uk],ngContentSelectors:mee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=xk()[16][6];if(!t.projection)for(var n=t.projection=nw(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=xk(),i=Mk(),a=Sb(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),Bk(),64!=(64&a.flags)&&function(e,t,n){eb(t[11],0,t,n,L_(e,n,t),G_(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Eee=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return Wg(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(Bg(kee(e)),Bg(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=yee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(CR),QE(Cee),QE(wee),QE(_ee,8),QE(bee,8))},e.\u0275cmp=Hm({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(GS("innerHTML",t.renderedIconHTML,s_),$E("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[uk],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),See=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}();function Pee(e,t){if(1&e&&(rS(0),nS(1,"fa-icon",24),iS()),2&e){var n=fS();pb(1),XE("icon",n.faSpinner)}}function Oee(e,t){if(1&e){var n=aS();rS(0),eS(1,"div",9),eS(2,"a",10),FS(3),tS(),eS(4,"div",12),eS(5,"a",26),uS("click",function(){return Nk(n),fS(2).logout()}),ZP(6,27),tS(),tS(),tS(),iS()}if(2&e){var r=fS(2);pb(3),US(r.username.get())}}var Tee=function(){return["/register"]},Iee=function(){return["/login"]};function Aee(e,t){1&e&&(eS(0,"div",28),eS(1,"a",29),eS(2,"strong"),ZP(3,30),tS(),tS(),eS(4,"a",31),ZP(5,32),tS(),tS()),2&e&&(pb(1),XE("routerLink",aT(2,Tee)),pb(3),XE("routerLink",aT(3,Iee)))}function Ree(e,t){if(1&e&&(YE(0,Oee,7,1,"ng-container",22),YE(1,Aee,6,4,"ng-template",null,25,xT)),2&e){var n=KE(2);XE("ngIf",fS().username.isPresent())("ngIfElse",n)}}var xee=function(){return["/"]},Mee=function(){return["/play"]},Nee=function(){return["/lobby"]},Dee=function(){return["/local"]},Lee=function(){return["/tutorial"]},Fee=function(){return["/settings"]},Uee=function(){var e=function(){function e(t,n,r){Zg(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=fB.empty(),this.faCog=Y7,this.faSpinner=e9,this.showMenu=!1}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.getUserObs().subscribe(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(S7),QE(w7))},e.\u0275cmp=Hm({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(p||(p=_g(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(g||(g=_g(["Play online"]))),[1,"navbar-dropdown"],$localize(y||(y=_g(["Create a game"]))),$localize(m||(m=_g(["Join a game"]))),$localize(k||(k=_g(["Play offline"]))),$localize(C||(C=_g(["Create a game"]))),$localize(w||(w=_g(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(_||(_=_g(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(b||(b=_g(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(E||(E=_g(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(S||(S=_g(["Log in"])))]},template:function(e,t){if(1&e&&(eS(0,"nav",0),eS(1,"div",1),eS(2,"a",2),nS(3,"img",3),tS(),eS(4,"a",4),uS("click",function(){return t.showMenu=!t.showMenu}),nS(5,"span",5),nS(6,"span",5),nS(7,"span",5),tS(),tS(),eS(8,"div",6),uS("click",function(){return t.showMenu=!t.showMenu}),eS(9,"div",7),eS(10,"a",2),ZP(11,8),tS(),eS(12,"div",9),eS(13,"a",10),ZP(14,11),tS(),eS(15,"div",12),eS(16,"a",2),ZP(17,13),tS(),eS(18,"a",2),ZP(19,14),tS(),tS(),tS(),eS(20,"div",9),eS(21,"a",10),ZP(22,15),tS(),eS(23,"div",12),eS(24,"a",2),ZP(25,16),tS(),eS(26,"a",2),ZP(27,17),tS(),tS(),tS(),tS(),eS(28,"div",18),eS(29,"a",19),nS(30,"fa-icon",20),tS(),eS(31,"div",21),YE(32,Pee,2,1,"ng-container",22),YE(33,Ree,3,2,"ng-template",null,23,xT),tS(),tS(),tS(),tS()),2&e){var n=KE(34);pb(2),XE("routerLink",aT(12,xee)),pb(2),XE("ngClass",t.showMenu?"is-active":""),pb(4),XE("ngClass",t.showMenu?"is-active":""),pb(2),XE("routerLink",aT(13,xee)),pb(6),XE("routerLink",aT(14,Mee)),pb(2),XE("routerLink",aT(15,Nee)),pb(6),XE("routerLink",aT(16,Dee)),pb(2),XE("routerLink",aT(17,Lee)),pb(3),XE("routerLink",aT(18,Fee)),pb(1),XE("icon",t.faCog),pb(2),XE("ngIf",t.loading)("ngIfElse",n)}},directives:[QL,NA,Eee,UA],encapsulation:2}),e}(),Vee=function(){var e=Wg(function e(t,n){Zg(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=$7,this.faFacebook=G7,this.faGithub=H7});return e.\u0275fac=function(t){return new(t||e)(QE(W7),QE(l7))},e.\u0275cmp=Hm({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(P||(P=_g(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(nS(0,"app-header"),eS(1,"main",0),nS(2,"router-outlet"),tS(),eS(3,"footer",1),eS(4,"div",2),eS(5,"p"),eS(6,"span"),HP(7,3),nS(8,"strong"),$P(),tS(),FS(9," \xa0 "),eS(10,"a",4),nS(11,"fa-icon",5),tS(),FS(12,"\xa0 "),eS(13,"a",6),nS(14,"fa-icon",5),tS(),FS(15,"\xa0 "),eS(16,"a",7),nS(17,"fa-icon",5),tS(),tS(),tS(),tS()),2&e&&(pb(11),XE("icon",t.faGithub),pb(3),XE("icon",t.faTwitter),pb(3),XE("icon",t.faFacebook))},directives:[Uee,JL,Eee],encapsulation:2}),e}(),Bee=function(){function e(t,n){Zg(this,e),this.x=t,this.y=n}return Wg(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),zee=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Bee),Gee=function(){function e(){Zg(this,e)}return Wg(e,[{key:"of",value:function(e,t){var n,r=Gg(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return r7.success(i)}}catch(a){r.e(a)}finally{r.f()}return r7.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?r7.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):r7.failure(Zee.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return r7.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return r7.failure("Invalid int direction: ".concat(e))}}}]),e}(),Hee=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(zee);Hee.UP=new Hee(0,-1),Hee.UP_RIGHT=new Hee(1,-1),Hee.RIGHT=new Hee(1,0),Hee.DOWN_RIGHT=new Hee(1,1),Hee.DOWN=new Hee(0,1),Hee.DOWN_LEFT=new Hee(-1,1),Hee.LEFT=new Hee(-1,0),Hee.UP_LEFT=new Hee(-1,-1),Hee.factory=new(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[Hee.UP,Hee.UP_RIGHT,Hee.RIGHT,Hee.DOWN_RIGHT,Hee.DOWN,Hee.DOWN_LEFT,Hee.LEFT,Hee.UP_LEFT],e}return Wg(n)}(Gee)),Hee.DIRECTIONS=Hee.factory.all,Hee.DIAGONALS=[Hee.UP_RIGHT,Hee.DOWN_RIGHT,Hee.DOWN_LEFT,Hee.UP_LEFT],Hee.ORTHOGONALS=[Hee.UP,Hee.RIGHT,Hee.DOWN,Hee.LEFT],Hee.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return f7("string"==typeof e,"Invalid encoded direction"),Hee.factory.fromString(e).get()}}]),n}(I7));var $ee=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(zee);$ee.UP=new $ee(0,-1),$ee.RIGHT=new $ee(1,0),$ee.DOWN=new $ee(0,1),$ee.LEFT=new $ee(-1,0),$ee.factory=new(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[$ee.UP,$ee.RIGHT,$ee.DOWN,$ee.LEFT],e}return Wg(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?r7.success($ee.UP):1===e&&0===t?r7.success($ee.RIGHT):0===e&&1===t?r7.success($ee.DOWN):-1===e&&0===t?r7.success($ee.LEFT):r7.failure("Invalid orthogonal from x and y")}}]),n}(Gee)),$ee.ORTHOGONALS=$ee.factory.all,$ee.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return f7("string"==typeof e,"Invalid encoded orthogonal"),$ee.factory.fromString(e).get()}}]),n}(I7));var Zee=function(){var e=Wg(function e(){Zg(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(O||(O=_g(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),qee=function(){function e(t,n){Zg(this,e),this.x=t,this.y=n}return Wg(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return Hee.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return R7.tuple([R7.numberEncoder(t),R7.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();qee.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return f7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new qee(t.x,t.y)}}]),n}(I7));var Wee=function(){var e=function(){function e(t){Zg(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=fB.empty(),this.imagesLocation="assets/images/"}return Wg(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?o7.SUCCESS:(this.messageDisplayer.gameMessage(e),o7.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case N7.ZERO:return"player0";case N7.ONE:return"player1";default:return oB.expectToBe(e,M7.NONE),""}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jee=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new qee(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Gg(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new qee(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(Wee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Hm({type:t,selectors:[["ng-component"]],features:[RE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Yee=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===N7.ZERO?e.ZERO:(oB.expectToBe(t,N7.ONE),e.ONE)}}]),e}();Yee.ZERO=new Yee(N7.ZERO.value),Yee.ONE=new Yee(N7.ONE.value),Yee.EMPTY=new Yee(M7.NONE.value),Yee.UNREACHABLE=new Yee(3);var Kee=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return oB.expectToBe(e,n.LEFT),300}}}]),n}(zee);Kee.UP=new Kee(0,-1),Kee.LEFT=new Kee(-1,0),Kee.UP_RIGHT=new Kee(1,-1),Kee.DOWN_LEFT=new Kee(-1,1),Kee.RIGHT=new Kee(1,0),Kee.DOWN=new Kee(0,1),Kee.factory=new(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[Kee.UP,Kee.UP_RIGHT,Kee.RIGHT,Kee.DOWN,Kee.DOWN_LEFT,Kee.LEFT],e}return Wg(n)}(Gee)),Kee.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case Kee.UP:return 0;case Kee.UP_RIGHT:return 1;case Kee.RIGHT:return 2;case Kee.DOWN:return 3;case Kee.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return f7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),Kee.factory.all[e]}}]),n}(R7));var Qee=function(){function e(t,n,r){Zg(this,e),this.size=t,this.origin=n,this.orientation=r}return Wg(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new qee(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new qee(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new qee(t.x+i.x,t.y+i.y))}return n}}]),e}(),Xee=Wg(function e(){Zg(this,e)}),Jee=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return Wg(n)}(Xee);Jee.INSTANCE=new Jee;var ete=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return Wg(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(Xee);ete.INSTANCE=new ete;var tte=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(T||(T=_g(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(I||(I=_g(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(A||(A=_g(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(R||(R=_g(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(x||(x=_g(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(M||(M=_g(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(N||(N=_g(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(D||(D=_g(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(L||(L=_g(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(F||(F=_g(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(U||(U=_g(["There is a piece between the piece you chose and its landing space."])))},e}(),nte=function(){function e(t,n){Zg(this,e),this.ruler=t,this.name=n}return Wg(e,[{key:"toString",value:function(){return this.name}}]),e}(),rte=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),ite=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return lB(t,e)})||t.push(e)}),t}}]),e}(),ate=function(e){function t(e){Zg(this,t),this.values=void 0===e?[]:ite.toComparableSet(e)}return Wg(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Gg(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Gg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Gg(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Gg(this.values);try{for(n.s();!(t=n.n()).done;){if(lB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Gg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?fB.of(this.values[0]):fB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),ote=function(){function e(t){Zg(this,e),this.turn=t}return Wg(e,[{key:"getCurrentPlayer",value:function(){return N7.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?N7.ZERO:N7.ONE}}]),e}(),ste=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).board=e,i}return Wg(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?fB.of(this.board[e.y][e.x]):fB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new qee(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Gg(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Pg(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new qee(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return U7.copyBiArray(this.board)}}]),n}(ote),ute=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==Yee.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===Yee.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Yee.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=Yee.EMPTY,t=Yee.UNREACHABLE,r=Yee.ZERO,i=Yee.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(ste),cte=Wg(function e(){Zg(this,e)}),lte=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).coord=new qee(e,r),i}return Wg(n)}(cte),fte=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return Lg(a)}return Wg(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return r7.success(new n(e,t,fB.empty()))}catch(r){return r7.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];U7.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=Kee.factory.fromDelta(a.x,a.y);if(o.isFailure())return r7.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?r7.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):r7.success(new n(i[1],r,fB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(lte);fte.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=Kee.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new qee(i,r);if(0===e)return fte.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new qee(s,o);return fte.fromDoubleCoord(a,u,n).get()}}]),n}(R7));var hte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(hte||(hte={})),hte),dte=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Zg(this,e),this.map=t,this.isImmutable=n}return Wg(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Gg(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(lB(r.key,e))return fB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Gg(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Gg(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(lB(i.key,e)){var a=i.value;return i.value=t,fB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),fB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return lB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new ate(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Gg(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(lB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Gg(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Gg(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(f7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===lB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),vte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"reverse",value:function(){var e,t=new n,r=Gg(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new ate;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(dte),pte=function(){var e=Wg(function e(){Zg(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),gte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),i=arguments.length>3?arguments[3]:void 0;if(Zg(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=fB.empty(),this.hopedValue=new dte,this.ownValue=new dte,this.possibleMoves=new dte,this.ownValue=new dte,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}pte.createdNodes++,sB(e.VERBOSE||!1,"creating "+this.myToString())}return Wg(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return pte.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return sB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return sB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);f7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=fB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new ate(n)),new ate(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===N7.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===N7.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=Gg(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===N7.ZERO?n:r))break;c===N7.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();f7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=fB.of(new e(o,fB.of(this),fB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){f7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Gg(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return fB.of(r)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Gg(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(sB(e.VERBOSE||n,"VICTORY"),hte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(sB(e.VERBOSE||n,"PRE_VICTORY_MIN"),hte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(sB(e.VERBOSE||n,"PRE_VICTORY_MAX"),hte.PRE_VICTORY):(sB(e.VERBOSE||n,"DEFAULT"),hte.DEFAULT)}}]),e}();gte.VERBOSE=!1,gte.minimaxes=new dte;var yte=function(){function e(t,n){Zg(this,e),this.isEndGame=t,this.winner=n}return Wg(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===N7.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===N7.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();yte.ZERO_WON=new yte(!0,N7.ZERO),yte.ONE_WON=new yte(!0,N7.ONE),yte.DRAW=new yte(!0,M7.NONE),yte.ONGOING=new yte(!1,M7.NONE);var mte=function(){function e(t){Zg(this,e),this.stateType=t,this.setInitialBoard()}return Wg(e,[{key:"choose",value:function(e){var t=!1;sB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){sB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return f7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),sB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(sB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return sB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;sB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new gte(i,fB.of(this.node),fB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();gte.ruler=this,this.node=new gte(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);f7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),kte=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(V||(V=_g(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(B||(B=_g(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(z||(z=_g(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(G||(G=_g(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(H||(H=_g(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize($||($=_g(["This space is not aligned with the current line."])))},e}(),Cte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new ute(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?o7.failure(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Yee.ofPlayer(t.getCurrentOpponent())?o7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):o7.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=Yee.ofPlayer(t.getCurrentPlayer()),o=Yee.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?r7.failure(kte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?r7.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=Yee.ofPlayer(n.getCurrentOpponent()),s=Yee.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?r7.failure(kte.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===Yee.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?r7.failure(kte.CANNOT_PUSH_YOUR_OWN_PIECES()):r7.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=Yee.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return r7.failure(kte.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=Yee.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return r7.failure(kte.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===Yee.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return r7.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?yte.ZERO_WON:t[1]>5?yte.ONE_WON:yte.ONGOING}}]),n}(mte),wte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new qee(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Gg(Kee.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=fte.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=Gg(Kee.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=fte.fromDoubleCoord(o,p,c).get();Cte.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new ate(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Cte.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new ute(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Cte.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n=e.gameState.getScores();return new rte(n[1]-n[0])}}]),n}(nte),_te=function(){function e(t,n,r){Zg(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=fB.empty()}return Wg(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=fB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Ete(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Pte(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Ste(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Ote(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Tte(e,t,n)}}]),e}(),bte=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return Wg(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(_te),Ete=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,f7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return Wg(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(bte),Ste=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return Wg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(bte),Pte=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return Wg(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(bte),Ote=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return Wg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(bte),Tte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isInformation",value:function(){return!0}}]),n}(_te),Ite=Yee.EMPTY,Ate=Yee.UNREACHABLE,Rte=Yee.ZERO,xte=Yee.ONE,Mte=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Z||(Z=_g(["Initial board and goal of the game"]))),$localize(q||(q=_g(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),ute.getInitialState()),_te.anyMove($localize(W||(W=_g(["Moving a piece"]))),$localize(j||(j=_g(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),ute.getInitialState(),fte.fromSingleCoord(new qee(2,6),Kee.UP).get(),$localize(Y||(Y=_g(["Congratulations!"])))),_te.fromMove($localize(K||(K=_g(["Pushing"]))),$localize(Q||(Q=_g(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new ute([[Ate,Ate,Ate,Ate,Ite,Rte,Rte,xte,xte],[Ate,Ate,Ate,Ite,Ite,Ite,Ite,Ite,Ite],[Ate,Ate,Ite,Rte,Rte,Rte,xte,Rte,Ite],[Ate,Ite,Ite,Ite,Ite,Ite,Ite,Ite,Ite],[Ite,Ite,Ite,Ite,Rte,Rte,Rte,xte,xte],[Ite,Ite,Ite,Ite,Ite,Ite,Ite,Ite,Ate],[Ite,Ite,Ite,Ite,Rte,xte,Ite,Ate,Ate],[Ite,Ite,Ite,Rte,Ite,Ite,Ate,Ate,Ate],[Ite,Ite,Rte,Ite,Ite,Ate,Ate,Ate,Ate]],0),[fte.fromSingleCoord(new qee(4,4),Kee.RIGHT).get()],$localize(X||(X=_g(["Congratulations! You know everything you need to start a game!"]))),$localize(J||(J=_g(["Failed!"]))))]});function Nte(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",6),uS("click",function(){Nk(n);var e=fS(2).index,t=fS().index;return fS().onPieceClick(e,t)}),tS()}if(2&e){var r=fS(2).index,i=fS().index,a=fS();vS("id","piece_",r,"_",i,""),XE("ngClass",a.getPieceClasses(r,i)),$E("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Dte(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"polyline",4),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onCaseClick(e,t)}),tS(),YE(2,Nte,1,6,"circle",5),tS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();pb(1),vS("id","case_",i,"_",o,""),XE("ngClass",s.getSquareClasses(i,o)),$E("points",s.getHexaCoordsBy(i,o)),pb(1),XE("ngIf",s.isPiece(a))}}function Lte(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Dte,3,5,"g",3),tS()),2&e){var n=t.$implicit,r=fS(2);pb(1),XE("ngIf",r.isBoard(n))}}function Fte(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Lte,2,1,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Ute(e,t){1&e&&(cC(),eS(0,"marker",7),nS(1,"polygon",8),tS()),2&e&&dS("id","arrowhead_",t.$implicit.dir.toString(),"")}function Vte(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),nS(1,"line",9),eS(2,"line",10),uS("click",function(){var e=Nk(n).$implicit;return fS().chooseDirection(e.dir)}),tS(),eS(3,"polygon",11),uS("click",function(){var e=Nk(n).$implicit;return fS().chooseDirection(e.dir)}),tS(),tS()}if(2&e){var r=t.$implicit;pb(1),dS("id","line_start_",r.dir.toString(),""),$E("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),pb(1),dS("id","line_end_",r.dir.toString(),""),$E("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),pb(1),dS("id","direction_",r.dir.toString(),""),$E("transform",r.transformation)}}var Bte=Wg(function e(t,n,r,i,a,o){Zg(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),zte=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Cte(ute),r.availableMinimaxes=[new wte(r.rules,"Dummy")],r.encoder=fte.encoder,r.tutorial=(new Mte).tutorial,r.scores=fB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new Qee(r.SPACE_SIZE,new qee(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),Jee.INSTANCE),r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=fB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=o7.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new qee(e,t)],n.showPossibleDirections(),o7.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=Yee.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Gg(Kee.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?fte.fromSingleCoord(i,u).get():fte.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=Kee.getAngle(u)+150,p=new Bte(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new qee(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==Yee.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==Yee.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new qee(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),o7.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(kte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),o7.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new qee(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),o7.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=Hee.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=Hee.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),U7.sortByDescending(r.selecteds,fte.sortCoord),r.showPossibleDirections(),o7.SUCCESS):r.cancelMove(kte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(kte.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),o7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?fte.fromSingleCoord(a,e).get():fte.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new qee(e,t),a=Gg(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",o7.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new qee(e,t),r=N7.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(jee);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-abalone"]],features:[RE],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Fte,2,1,"g",1),eS(2,"defs"),YE(3,Ute,2,1,"marker",2),tS(),YE(4,Vte,4,12,"g",1),tS()),2&e&&(pb(1),XE("ngForOf",t.hexaBoard),pb(2),XE("ngForOf",t.directions),pb(1),XE("ngForOf",t.directions))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Gte=function(){function e(t){Zg(this,e),this.x=t}return Wg(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return f7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();Gte.ZERO=new Gte(0),Gte.ONE=new Gte(1),Gte.TWO=new Gte(2),Gte.THREE=new Gte(3);var Hte=function(){var e=Wg(function e(){Zg(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ee||(ee=_g(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(te||(te=_g(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(ne||(ne=_g(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(re||(re=_g(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ie||(ie=_g(["There is no possible transfer from that square!"])))},e}(),$te=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return Wg(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(fB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return r7.failure(Hte.PIECE_SHOULD_MOVE_DOWNWARD());var r=oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(fB.empty())&&n.starting.equals(fB.of(e))}));return r7.success(r)}}]),n}(cte);$te.ALL_MOVES=[new $te(Gte.ZERO,fB.of(N7.ZERO),fB.empty()),new $te(Gte.ONE,fB.of(N7.ZERO),fB.empty()),new $te(Gte.TWO,fB.of(N7.ZERO),fB.empty()),new $te(Gte.THREE,fB.of(N7.ZERO),fB.empty()),new $te(Gte.ZERO,fB.of(N7.ONE),fB.empty()),new $te(Gte.ONE,fB.of(N7.ONE),fB.empty()),new $te(Gte.TWO,fB.of(N7.ONE),fB.empty()),new $te(Gte.THREE,fB.of(N7.ONE),fB.empty()),new $te(Gte.TWO,fB.empty(),fB.of(Gte.THREE)),new $te(Gte.ONE,fB.empty(),fB.of(Gte.THREE)),new $te(Gte.ZERO,fB.empty(),fB.of(Gte.THREE)),new $te(Gte.ONE,fB.empty(),fB.of(Gte.TWO)),new $te(Gte.ZERO,fB.empty(),fB.of(Gte.TWO)),new $te(Gte.ZERO,fB.empty(),fB.of(Gte.ONE))],$te.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return $te.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=$te.ALL_MOVES.findIndex(function(t){return t.equals(e)});return f7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return f7(e<$te.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),$te.ALL_MOVES[e]}}]),n}(R7));var Zte=function(){function e(t){Zg(this,e),this.containing=t}return Wg(e,[{key:"isFull",value:function(){return this.count(N7.ZERO)+this.count(N7.ONE)>=this.count(M7.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(N7.ZERO),r=this.count(N7.ONE),i=this.count(M7.NONE);return t===N7.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(N7.ZERO),r=this.count(N7.ONE),i=this.count(M7.NONE);return t===N7.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(N7.ZERO),t=this.count(N7.ONE);return e>t?N7.ZERO:t>e?N7.ONE:M7.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return r7.failure("invalid starting space");var i=new dte([{key:N7.ZERO,value:t},{key:N7.ONE,value:n},{key:M7.NONE,value:r}]);i.makeImmutable();var a=new e(i);return r7.success(a)}}]),e}(),qte=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return Wg(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&U7.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=Zte.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new dte;return u.set(N7.ZERO,r),u.set(N7.ONE,i),new n(e,a,u)}}]),n}(ote);return e.PIECES_PER_PLAYER=10,e}(),Wte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new qte(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===Gte.THREE)return i.updateAt(e.landing,o);var s=Gte.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new qte(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?r7.failure(Hte.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?r7.failure(Hte.NO_PIECE_REMAINING_TO_DROP()):r7.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?r7.failure(Hte.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(Gte.from(n)).isFull())return yte.ONGOING;var r=t.getPieceAt(Gte.THREE).getDominatingPlayer();return f7(r.isPlayer(),"winner can only be a player if the game is finished"),yte.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(qte))),this.singleton.get()}}]),n}(mte);Wte.singleton=fB.empty();var jte=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return $te.ALL_MOVES.filter(function(e){return Wte.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=Wte.get().getGameStatus(e);if(t.isEndGame)return rte.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new rte(n.getScoreModifier()):new rte(0)}}]),n}(nte),Yte=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(ae||(ae=_g(["Initial board and goal of the game"]))),$localize(oe||(oe=_g(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),qte.getInitialState()),_te.anyMove($localize(se||(se=_g(["Drop"]))),$localize(ue||(ue=_g(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),qte.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),$te.drop(Gte.ZERO,N7.ZERO),$localize(ce||(ce=_g(["Congratulations!"])))),_te.fromPredicate($localize(le||(le=_g(["Transfer"]))),$localize(fe||(fe=_g(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),qte.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),$te.transfer(Gte.TWO,Gte.ZERO).get(),function(e,t){return e.isDrop()?o7.failure($localize(he||(he=_g(["This move is a drop, please do a transfer!"])))):o7.SUCCESS},$localize(de||(de=_g(["Congratulations!"])))),_te.fromPredicate($localize(ve||(ve=_g(["Victory"]))),$localize(pe||(pe=_g(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),qte.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),$te.drop(Gte.TWO,N7.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(N7.ONE)?o7.SUCCESS:o7.failure($localize(ge||(ge=_g(["You actively made your opponent win!"])))):o7.failure($localize(ye||(ye=_g(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(me||(me=_g(["Congratulations!"]))))]});function Kte(e,t){if(1&e&&(cC(),nS(0,"circle",5)),2&e){var n=t.$implicit,r=fS();$E("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Qte(e,t){if(1&e){var n=aS();cC(),eS(0,"polygon",7),uS("click",function(){Nk(n);var e=fS().index,t=fS();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),tS()}if(2&e){var r=fS().index,i=fS();dS("id","dropArrow_zero_",r,""),XE("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),$E("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ZERO))}}function Xte(e,t){if(1&e){var n=aS();cC(),eS(0,"polygon",7),uS("click",function(){Nk(n);var e=fS().index,t=fS();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),tS()}if(2&e){var r=fS().index,i=fS();dS("id","dropArrow_one_",r,""),XE("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),$E("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ONE))}}function Jte(e,t){if(1&e){var n=aS();cC(),rS(0),eS(1,"circle",8),uS("click",function(){Nk(n);var e=fS().index;return fS().onSquareClick(e)}),tS(),iS()}if(2&e){var r=t.$implicit,i=fS(),a=i.index,o=i.$implicit,s=fS();pb(1),pS("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),XE("ngClass",s.getPieceClasses(a,r,o)),$E("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function ene(e,t){if(1&e){var n=aS();cC(),rS(0),YE(1,Qte,1,4,"polygon",6),YE(2,Xte,1,4,"polygon",6),eS(3,"rect",7),uS("click",function(){var e=Nk(n).index;return fS().onSquareClick(e)}),tS(),YE(4,Jte,2,6,"ng-container",3),iS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();pb(1),XE("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),pb(1),XE("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),pb(1),dS("id","square_",i,""),XE("ngClass",a.getSquareClasses(i)),$E("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pb(1),XE("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}function tne(e,t){if(1&e&&(cC(),nS(0,"circle",9)),2&e){var n=t.$implicit,r=fS();$E("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var nne=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).PlayerOrNone=M7,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=qte.PIECES_PER_PLAYER,r.selectedPiece=fB.empty(),r.leftPiece=fB.empty(),r.droppedPiece=fB.empty(),r.displayableArrow=[],r.rules=new Wte(qte),r.availableMinimaxes=[new jte(r.rules,"ApagosDummyMinimax")],r.encoder=$te.encoder,r.tutorial=(new Yte).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(N7.ZERO).get(),this.remainingOne=e.remaining.get(N7.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=fB.empty(),this.leftPiece=fB.empty(),this.selectedPiece=fB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=fB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===N7.ZERO?n-1:e.count(M7.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=fB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=fB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(N7.ZERO).get()>0&&this.displayableArrow.push({x:t,player:N7.ZERO}),e.remaining.get(N7.ONE).get()>0&&this.displayableArrow.push({x:t,player:N7.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(M7.NONE))return new qee(r,i);var a=n.count(M7.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new qee(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===N7.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===N7.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=Gte.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=$te.transfer(Gte.from(s),a).get()):o=$te.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(N7.ZERO),o=n.count(N7.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===N7.ZERO?a++:o++}var s=n.count(M7.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),o7.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(Hte.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=fB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Hte.NO_POSSIBLE_TRANSFER_REMAINS()):o7.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(Wee);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-apagos"]],features:[RE],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Kte,1,3,"circle",1),eS(2,"g",2),YE(3,ene,5,9,"ng-container",3),tS(),YE(4,tne,1,3,"circle",4),tS()),2&e&&(pb(1),XE("ngForOf",t.range(t.remainingZero)),pb(1),$E("transform","translate(0, "+2*t.PIECE_RADIUS+")"),pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.range(t.remainingOne)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),rne=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(Wee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Hm({type:t,selectors:[["ng-component"]],features:[RE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),ine=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).captured=i,a}return Wg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(U7.createTable(6,2,4),0,[0,0])}}]),n}(ste),ane=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ke||(ke=_g(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(Ce||(Ce=_g(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=_g(["You should distribute but you do not."])))},e}(),one=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new ine(s,t.turn+1,t.captured);var c=[0,0],l=U7.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new ine(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return r7.failure(ane.MUST_CHOOSE_NONEMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?r7.failure(ane.SHOULD_DISTRIBUTE()):r7.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new qee(e,t)}},{key:"capture",value:function(e,t,n,r){f7(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?yte.ZERO_WON:t.captured[1]>24?yte.ONE_WON:24===t.captured[0]&&24===t.captured[1]?yte.DRAW:yte.ONGOING}}]),n}(mte);return e.VERBOSE=!1,e}(),sne=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).x=e,r}return Wg(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return f7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(cte);sne.ZERO=new sne(0),sne.ONE=new sne(1),sne.TWO=new sne(2),sne.THREE=new sne(3),sne.FOUR=new sne(4),sne.FIVE=new sne(5),sne.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return sne.from(e)}}]),n}(R7));var une=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=sne.from(a),one.isLegal(t,r).isSuccess()&&(t=sne.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return U7.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=one.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=one.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=one.getGameStatus(e);if(t.isEndGame)return rte.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new rte(n[1]-n[0])}}]),n}(nte),cne=Wg(function e(){Zg(this,e),this.tutorial=[_te.anyMove($localize(_e||(_e=_g(["Sowing"]))),$localize(be||(be=_g(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),ine.getInitialState(),sne.ZERO,$localize(Ee||(Ee=_g(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),_te.anyMove($localize(Se||(Se=_g(["Big sowing"]))),$localize(Pe||(Pe=_g(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new ine([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),sne.ONE,$localize(Oe||(Oe=_g(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),_te.fromMove($localize(Te||(Te=_g(["Simple capture"]))),$localize(Ie||(Ie=_g(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new ine([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[sne.ZERO],$localize(Ae||(Ae=_g(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Re||(Re=_g(["Failed. Try again and sow from the leftmost house."])))),_te.fromMove($localize(xe||(xe=_g(["Multiple captures"]))),$localize(Me||(Me=_g(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new ine([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[sne.ZERO],$localize(Ne||(Ne=_g(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(De||(De=_g(["Failed. Try again."])))),_te.fromMove($localize(Le||(Le=_g(["Interrupted capture"]))),$localize(Fe||(Fe=_g(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new ine([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[sne.ZERO],$localize(Ue||(Ue=_g(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Ve||(Ve=_g(["Failed. Try again."])))),_te.fromMove($localize(Be||(Be=_g(["Capture on the other side only"]))),$localize(ze||(ze=_g(["Try to capture the two leftmost houses of the opponent."]))),new ine([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[sne.ONE],$localize(Ge||(Ge=_g(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(He||(He=_g(["You have only captured one house, try again!"])))),_te.fromMove($localize($e||($e=_g(["Do not starve"]))),$localize(Ze||(Ze=_g(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new ine([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[sne.ZERO],$localize(qe||(qe=_g(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(We||(We=_g(["Failed. Try again."])))),_te.anyMove($localize(je||(je=_g(["Feeding is mandatory"]))),$localize(Ye||(Ye=_g(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new ine([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),sne.THREE,$localize(Ke||(Ke=_g(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),_te.anyMove($localize(Qe||(Qe=_g(["End of the game"]))),$localize(Xe||(Xe=_g(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new ine([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),sne.FIVE,$localize(Je||(Je=_g(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function lne(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",4),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),tS(),eS(2,"text",5),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),FS(3),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","click_",i,"_",a,""),XE("ngClass",o.getSquareClasses(i,a)),$E("cx",50+100*i)("cy",50+120*a),pb(1),$E("x",50+100*i)("y",66+120*a),pb(1),VS(" ",r," ")}}function fne(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,lne,4,8,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var hne=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).last=fB.empty(),r.captured=[],r.moved=[],r.scores=fB.of([0,0]),r.rules=new one(ine),r.availableMinimaxes=[new une(r.rules,"AwaleMinimax")],r.encoder=sne.encoder,r.tutorial=(new cne).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=fB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=fB.of(new qee(t.get().x,n)),this.showPreviousMove()}else this.last=fB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new qee(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(ane.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=fB.empty(),a=sne.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-awale-component"]],features:[RE],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),nS(1,"rect",1),YE(2,fne,2,1,"g",2),nS(3,"line",3),tS()),2&e&&(pb(2),XE("ngForOf",t.board))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dne=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(tte.MOVE_CANNOT_BE_STATIC());return i.end=r,Lg(i)}return Wg(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return Hee.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Mg(a,r);var i=Dg(a);function a(){var n;return Zg(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return Wg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new qee((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new qee((r-=r%1)%e,o);return n(s,a)}}]),a}(R7))}}]),n}(lte),vne=function(){var e=Wg(function e(){Zg(this,e)});return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(et||(et=_g(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(tt||(tt=_g(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(nt||(nt=_g(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(rt||(rt=_g(["Tafl moves must be orthogonal."])))},e}(),pne=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(vne.MOVE_MUST_BE_ORTHOGONAL());return Lg(i)}return Wg(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(dne),gne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return r7.success(r)}catch(r){return r7.failure(r.message)}}}]),n}(pne);gne.encoder=dne.getEncoder(7,7,gne.of);var yne={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:N7.ZERO},mne=function(){function e(t,n){Zg(this,e),this.owner=t,this.king=n}return Wg(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();mne.UNOCCUPIED=new mne(M7.NONE,!1),mne.PLAYER_ONE_KING=new mne(N7.ONE,!0),mne.INVADERS=new mne(N7.ZERO,!1),mne.DEFENDERS=new mne(N7.ONE,!1);var kne=Wg(function e(t){Zg(this,e),this.value=t});kne.NONE=new kne("NONE"),kne.OPPONENT=new kne("OPPONENT"),kne.PLAYER=new kne("PLAYER");var Cne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new qee(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===M7.NONE?kne.NONE:e===n?kne.PLAYER:kne.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(ste),wne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=mne.UNOCCUPIED,t=mne.INVADERS,r=mne.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,mne.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Cne),_ne=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return Wg(n,[{key:"isLegal",value:function(e,t){sB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?r7.failure(i.getReason()):r7.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===kne.NONE)return o7.failure(tte.MUST_CHOOSE_PLAYER_PIECE());if(r===kne.OPPONENT)return o7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==kne.NONE)return o7.failure(vne.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return o7.failure(vne.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return o7.failure(vne.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==mne.UNOCCUPIED)return o7.failure(tte.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return o7.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===kne.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):fB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===kne.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===kne.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):fB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):kne.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):kne.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):kne.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===kne.PLAYER?1:0;return 2===(i+=t===kne.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(sB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),fB.of(r)):fB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t)}else{var i=r===kne.PLAYER,a=n===kne.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return fB.of(t)}return fB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=kne.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===kne.NONE?!1===this.isThrone(i,s)?(sB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),fB.empty()):(sB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):u===kne.PLAYER?(sB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):(sB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===kne.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===kne.PLAYER||l&&s)?(sB(n.VERBOSE||!1,"king captured by 4 invaders"),fB.of(t)):fB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){sB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=mne.UNOCCUPIED;var u,c=Gg($ee.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=mne.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?yte.getVictory(t.get()):yte.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return sB(t,"The king is dead, victory to invader"),fB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(sB(t,"The king escape, victory to defender"),fB.of(this.getDefender())):this.isPlayerImmobilized(N7.ZERO,e)?(sB(t,"Zero has no move, victory to one"),fB.of(N7.ONE)):this.isPlayerImmobilized(N7.ONE,e)?(sB(t,"One has no move, victory to zero"),fB.of(N7.ZERO)):(sB(t,"no victory"),fB.empty())}},{key:"getKingCoord",value:function(e){sB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return fB.of(new qee(r,t));return fB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);sB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Gg(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Gg(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new qee(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Gg($ee.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===M7.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(mte);return e.VERBOSE=!1,e}(),bne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,wne,yne,gne.of)}return Wg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),gte.ruler=this.singleton,n.singleton}}]),n}(_ne),Ene=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=mne.UNOCCUPIED,a.captureds=[],a.chosen=new qee(-1,-1),a.lastMove=fB.empty(),a}return Wg(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){sB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=Gg($ee.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===kne.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===mne.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===M7.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new qee(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return sB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===mne.UNOCCUPIED?this.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new qee(e,t),this.updateViewInfo(),sB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),o7.SUCCESS):this.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new qee(e,t);return n.getRelativeOwner(r,i)===kne.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new qee(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new qee(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new qee(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new qee(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new qee(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new qee(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===mne.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(rne),Sne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){sB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?U7.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):U7.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new rte(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(N7.ZERO,t).length,i=this.ruler.getPlayerListPawns(N7.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=N7.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=N7.ONE.getScoreModifier(),new rte(r*a+i*o)}}]),n}(nte),Pne=function(){function e(t,n){Zg(this,e),this.directThreats=t,this.mover=n}return Wg(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),One=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,new ate([e]),r)).directThreat=e,i.mover=r,i}return Wg(n)}(Pne),Tne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Mg(r,e);var n=Dg(r);function r(e){var t;if(Zg(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return Lg(t)}return Wg(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Gg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Gg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(ate,Symbol.iterator)),Ine=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n,r=e.gameState,i=mne.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=Gg(N7.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=Gg(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Gg($ee.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new rte(a)}},{key:"getPiecesMap",value:function(e){for(var t=mne.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new qee(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===N7.ZERO?n.push(o):r.push(o))}return new dte([{key:N7.ZERO,value:new Tne(n)},{key:N7.ONE,value:new Tne(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new dte,i=Gg(N7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new ate(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);f7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=Gg($ee.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=Gg($ee.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===mne.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new One(u,new Tne(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==N7.ONE&&t.getPieceAt(e)!==mne.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new dte,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Tne(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Gg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=Gg(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Gg(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new One(d.directThreat,new Tne(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new ate(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=Gg(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(Sne),Ane=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=mne.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=Gg(N7.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new Tne,p=Gg(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Gg($ee.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,_=Gg(v);try{for(_.s();!(w=_.n()).done;){var b=w.value,E=n.CONTROL_VALUE[b.y][b.x];s+=d.getScoreModifier()*E}}catch(S){_.e(S)}finally{_.f()}}}catch(S){f.e(S)}finally{f.f()}return new rte(s)}}]),n}(Ine);Ane.SCORE_BY_THREATENED_PIECE=530,Ane.SCORE_BY_SAFE_PIECE=16*Ane.SCORE_BY_THREATENED_PIECE+1,Ane.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Rne=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=mne.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=Gg(N7.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new Tne,g=Gg(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=Gg($ee.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,b=Gg(p);try{for(b.s();!(_=b.n()).done;){var E=_.value,S=Ane.CONTROL_VALUE[E.y][E.x];u+=v.getScoreModifier()*S}}catch(O){b.e(O)}finally{b.f()}}}catch(O){h.e(O)}finally{h.f()}var P=this.getStepForEscape(r);return new rte(531*P*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?fB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?fB.of(t):(t++,r.push.apply(r,Bg(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Gg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Gg($ee.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===mne.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(Ane);Rne.SCORE_BY_THREATENED_PIECE=530,Rne.SCORE_BY_SAFE_PIECE=16*Ane.SCORE_BY_THREATENED_PIECE+1,Rne.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var xne=mne.UNOCCUPIED,Mne=mne.INVADERS,Nne=mne.DEFENDERS,Dne=mne.PLAYER_ONE_KING,Lne=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(it||(it=_g(["Goal of the game"]))),$localize(at||(at=_g(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),wne.getInitialState()),_te.anyMove($localize(ot||(ot=_g(["Moving"]))),$localize(st||(st=_g(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),wne.getInitialState(),gne.of(new qee(3,1),new qee(1,1)),$localize(ut||(ut=_g(["Congratulations!"])))),_te.fromMove($localize(ct||(ct=_g(["Capturing a soldier (1/2)"]))),$localize(lt||(lt=_g(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new wne([[xne,xne,xne,Mne,xne,xne,xne],[xne,xne,xne,Mne,xne,xne,xne],[Mne,xne,xne,Nne,xne,xne,xne],[xne,xne,Nne,Dne,Nne,Mne,Mne],[xne,xne,Mne,xne,xne,xne,xne],[xne,xne,xne,Nne,xne,Mne,xne],[xne,xne,xne,Mne,xne,xne,xne]],1),[gne.of(new qee(3,5),new qee(2,5))],$localize(ft||(ft=_g(["Congratulations, that will teach him a lesson!"]))),$localize(ht||(ht=_g(["Failed, you missed an opportunity to capture a piece of the opponent."])))),_te.fromMove($localize(dt||(dt=_g(["Capturing a soldier (2/2)"]))),$localize(vt||(vt=_g(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new wne([[xne,xne,xne,Mne,xne,xne,xne],[xne,xne,Mne,xne,xne,xne,xne],[xne,xne,xne,Nne,xne,xne,xne],[Mne,Nne,xne,xne,Nne,Mne,Mne],[xne,Nne,xne,xne,xne,xne,xne],[xne,Mne,xne,Dne,xne,Mne,xne],[xne,xne,xne,Mne,xne,xne,xne]],12),[gne.of(new qee(2,1),new qee(3,1)),gne.of(new qee(3,0),new qee(3,1))],$localize(pt||(pt=_g(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(gt||(gt=_g(["Failed, you did not do the expected move."])))),_te.fromMove($localize(yt||(yt=_g(["Capturing the king on his throne"]))),$localize(mt||(mt=_g(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new wne([[xne,xne,xne,xne,xne,xne,xne],[xne,xne,xne,Nne,xne,xne,xne],[xne,xne,xne,Mne,xne,xne,xne],[xne,Mne,xne,Dne,Mne,xne,xne],[xne,xne,xne,Mne,xne,xne,xne],[xne,Nne,xne,xne,xne,xne,xne],[xne,xne,xne,xne,xne,xne,xne]],72),[gne.of(new qee(1,3),new qee(2,3))],$localize(kt||(kt=_g(["Congratulations, you won!"]))),$localize(Ct||(Ct=_g(["Failed, you let the king run away."])))),_te.fromMove($localize(wt||(wt=_g(["Capturing the king next to his throne"]))),$localize(_t||(_t=_g(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new wne([[xne,xne,Mne,xne,xne,xne,xne],[xne,xne,xne,Mne,xne,xne,xne],[xne,xne,xne,Dne,Mne,xne,xne],[xne,Mne,Nne,xne,Nne,xne,xne],[xne,xne,xne,Mne,xne,xne,xne],[xne,xne,xne,xne,xne,xne,xne],[xne,xne,xne,xne,xne,xne,xne]],72),[gne.of(new qee(2,0),new qee(2,2))],$localize(bt||(bt=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Et||(Et=_g(["Failed!"])))),_te.fromMove($localize(St||(St=_g(["Capturing the king far from his throne"]))),$localize(Pt||(Pt=_g(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new wne([[xne,xne,xne,xne,xne,xne,xne],[xne,xne,xne,xne,xne,xne,xne],[xne,Mne,xne,Mne,xne,xne,xne],[Mne,xne,xne,xne,Nne,xne,xne],[xne,xne,xne,Nne,xne,xne,xne],[xne,xne,xne,xne,xne,xne,xne],[xne,Dne,xne,Mne,xne,xne,xne]],72),[gne.of(new qee(3,6),new qee(2,6))],$localize(Ot||(Ot=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Tt||(Tt=_g(["Failed!"]))))]});function Fne(e,t){1&e&&(cC(),nS(0,"polyline",8))}function Une(e,t){1&e&&(cC(),nS(0,"polyline",9))}function Vne(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Fne,1,0,"polyline",6),YE(2,Une,1,0,"ng-template",null,7,xT),tS()),2&e){var n=KE(3),r=fS().index,i=fS().index,a=fS();pb(1),XE("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Bne(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"line",10),nS(2,"line",10),nS(3,"line",10),nS(4,"line",10),nS(5,"line",10),tS()),2&e){var n=fS(2).index,r=fS().index,i=fS();pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function zne(e,t){if(1&e&&(cC(),nS(0,"polyline",15)),2&e){var n=fS(3).index,r=fS().index;XE("ngClass",fS().viewInfo.pieceClasses[r][n])}}function Gne(e,t){if(1&e&&(cC(),nS(0,"line",10),nS(1,"line",10),nS(2,"line",10),nS(3,"line",10)),2&e){var n=fS(3).index,r=fS().index,i=fS();XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Hne(e,t){if(1&e&&(cC(),YE(0,zne,1,1,"polyline",13),YE(1,Gne,4,20,"ng-template",null,14,xT)),2&e){var n=KE(2),r=fS(2).index,i=fS().index;XE("ngIf",fS().isKing(r,i))("ngIfElse",n)}}function $ne(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",10),YE(2,Bne,6,25,"g",11),YE(3,Hne,3,2,"ng-template",null,12,xT),tS()),2&e){var n=KE(4),r=fS().index,i=fS().index,a=fS();pb(1),XE("ngClass",a.viewInfo.pieceClasses[i][r]),$E("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),pb(1),XE("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Zne(e,t){if(1&e){var n=aS();cC(),eS(0,"g",3),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(1,"rect",4),YE(2,Vne,4,2,"g",5),YE(3,$ne,5,6,"g",5),tS()}if(2&e){var r=t.index,i=fS().index,a=fS();vS("id","click_",r,"_",i,""),$E("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),pb(1),XE("ngClass",a.getRectClasses(r,i)),$E("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pb(1),XE("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),pb(1),XE("ngIf",a.board[i][r]!==a.EMPTY)}}function qne(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Zne,4,8,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Wne(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",16),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),vS("id","click_",r.x,"_",r.y,""),$E("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var jne=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,!1,gne.from)).rules=bne.get(),r.availableMinimaxes=[new Sne(r.rules,"DummyBot"),new Ine(r.rules,"Piece > Influence"),new Ane(r.rules,"Piece > Control"),new Rne(r.rules,"Escape > Piece > Control")],r.encoder=gne.encoder,r.tutorial=(new Lne).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-brandhub"]],features:[RE],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,qne,2,1,"g",1),YE(2,Wne,2,6,"g",1),tS()),2&e&&($E("viewBox",t.getViewBox()),pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.getClickables()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yne=function(){var e,t=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return Wg(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new qee(.5*this.SPACE_SIZE*e,i);return[o,new qee(n,a),new qee(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new qee(.5*this.SPACE_SIZE*e,a);return[o,new qee(n,i),new qee(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(Wee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Hm({type:t,selectors:[["ng-component"]],features:[RE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Kne=function(){var e=Wg(function e(){Zg(this,e)});return e.INVALID_DISTANCE=function(){return $localize(It||(It=_g(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(At||(At=_g(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Rt||(Rt=_g(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(xt||(xt=_g(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Mt||(Mt=_g(["You cannot capture your own pieces."])))},e}(),Qne=function(){function e(t,n){Zg(this,e),this.direction=t,this.str=n}return Wg(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(Kne.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();Qne.LEFT=new Qne(new Bee(-2,0),"LEFT"),Qne.UP_LEFT=new Qne(Hee.UP_LEFT,"UP_LEFT"),Qne.UP_RIGHT=new Qne(Hee.UP_RIGHT,"UP_RIGHT"),Qne.RIGHT=new Qne(new Bee(2,0),"RIGHT"),Qne.DOWN_LEFT=new Qne(Hee.DOWN_LEFT,"DOWN_LEFT"),Qne.DOWN_RIGHT=new Qne(Hee.DOWN_RIGHT,"DOWN_RIGHT"),Qne.STEPS=[Qne.LEFT,Qne.UP_LEFT,Qne.UP_RIGHT,Qne.RIGHT,Qne.DOWN_LEFT,Qne.DOWN_RIGHT];var Xne=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return Wg(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new qee(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(fB.of(e),fB.of(t),fB.of(r),fB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(fB.empty(),fB.empty(),fB.empty(),fB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=Qne.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(cte);Xne.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?Xne.fromTilesExchange(new qee(n,t)):Xne.fromMovement(new qee(n,t),Qne.STEPS[e-1])}}]),n}(R7));var Jne=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getNeighbors",value:function(e){var t=new qee(e.x-1,e.y),n=new qee(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new qee(e.x,e.y-1)]:[t,n,new qee(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new qee(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return fB.of(o);s++}a++}return fB.empty()}}]),e}(),ere=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Gg(Jne.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(ste),tre=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return Wg(n,[{key:"applyLegalMovement",value:function(e){sB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=Yee.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Yee.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){sB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Gg(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return Jne.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,Yee.EMPTY).length}},{key:"capture",value:function(e){sB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return sB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=Yee.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){sB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Gg(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===Yee.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){f7(this.getPieceAt(e)!==Yee.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Bee(n,t),1);if(this.getPieceAt(r)!==Yee.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=fB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==Yee.UNREACHABLE&&(r.isAbsent()&&(r=fB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){sB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=Yee.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Gg(Qne.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===Yee.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new qee(n,t),Yee.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new qee(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new qee(e.x+1,e.y-1),new qee(e.x+3,e.y+0),new qee(e.x+3,e.y+1),new qee(e.x+1,e.y+2),new qee(e.x-1,e.y+1),new qee(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=Yee.EMPTY,t=Yee.UNREACHABLE,r=Yee.ZERO,i=Yee.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(ere);tre.VERBOSE=!1,tre.NEIGHBORS_TILES_DIRECTIONS=[new Bee(0,-2),new Bee(3,-1),new Bee(3,1),new Bee(0,2),new Bee(-3,1),new Bee(-3,-1)],tre.isInRange=function(e){return e.isInRange(15,10)};var nre=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=Yee.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new tre(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new tre(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return sB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new tre(a.board,t.turn+1,a.tiles,a.captures);return sB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return r7.failure(Kne.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===Yee.UNREACHABLE||n===Yee.EMPTY?r7.failure(Kne.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?r7.failure(Kne.CANNOT_CAPTURE_OWN_PIECES()):r7.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===Yee.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return r7.failure(n)}if(t.getPieceAt(e.landingCoord.get())===Yee.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return r7.failure(r)}var i=t.getPieceAt(e.start.get());return i===Yee.EMPTY?r7.failure(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?r7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?yte.ZERO_WON:t.captures[1]>=18?yte.ONE_WON:yte.ONGOING}}]),n}(mte);return e.VERBOSE=!1,e}(),rre=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=Yee.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new qee(o,a);if(n.getPieceAt(s)===i){var u=Xne.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new qee(a,i);if(n.getPieceAt(o).is(r)){var s,u=Gg(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Xne.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=nre.getGameStatus(e);if(t.isEndGame)return rte.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new rte(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return U7.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(nte),ire=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=nre.getGameStatus(e);if(t.isEndGame)return rte.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=Gg(N7.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=Gg(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new rte(u)}},{key:"getPiecesMap",value:function(e){for(var t=new dte,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new qee(a,i),s=e.getPieceAt(o);s===Yee.ZERO?n.push(o):s===Yee.ONE&&r.push(o)}return t.set(N7.ZERO,new Tne(n)),t.set(N7.ONE,new Tne(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new dte,i=Gg(N7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=N7.of(t.getPieceAt(e).value).getOpponent(),i=fB.empty(),a=fB.empty(),o=[],s=Jne.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=Gg(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=fB.of(c));else if(l===Yee.EMPTY){if(i.isPresent())return fB.empty();i=fB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=Gg(Qne.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return fB.of(new Pne(new Tne(o),new Tne(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new Tne(o);return fB.of(new Pne(p,new Tne([a.get()])))}return fB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=fB.empty(),a=tre.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new Bee(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=fB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=tre.getTilesUpperLeftCoord(e),i=Gg(Qne.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=tre.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===Yee.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new dte,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Tne(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Gg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=fB.empty(),h=Gg(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=Gg(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=fB.of(new Pne(l.directThreats,new Tne(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=Gg(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(rre);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),are=Yee.EMPTY,ore=Yee.UNREACHABLE,sre=Yee.ZERO,ure=Yee.ONE,cre=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Nt||(Nt=_g(["Board and goal of the game"]))),$localize(Dt||(Dt=_g(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),tre.getInitialState()),_te.anyMove($localize(Lt||(Lt=_g(["Move"]))),$localize(Ft||(Ft=_g(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),tre.getInitialState(),Xne.fromCoordToCoord(new qee(3,5),new qee(5,5)),$localize(Ut||(Ut=_g(["Congratulations! Let's see captures now."])))),_te.fromMove($localize(Vt||(Vt=_g(["Capture"]))),$localize(Bt||(Bt=_g(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new tre([[ore,ore,ore,ore,ore,ore,sre,are,sre,ore,ore,ore,ore,ore,ore],[ore,ore,ore,sre,are,are,are,are,are,sre,are,are,ore,ore,ore],[are,ure,are,ure,sre,ure,are,are,sre,are,are,ure,are,ure,are],[ure,are,are,are,are,are,are,are,are,are,ure,are,are,are,ure],[are,ure,are,ure,are,are,are,are,are,are,are,ure,are,ure,are],[are,sre,are,sre,are,are,are,are,are,are,are,sre,are,sre,are],[sre,are,are,are,sre,are,are,are,are,are,sre,are,are,are,sre],[are,sre,are,sre,are,are,ure,are,ure,are,are,sre,are,sre,are],[ore,ore,ore,are,are,ure,are,are,are,ure,are,are,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ure,are,ure,ore,ore,ore,ore,ore,ore]],3,[0,0],[0,0]),[Xne.fromCoordToCoord(new qee(5,2),new qee(4,1)),Xne.fromCoordToCoord(new qee(3,4),new qee(4,3))],$localize(zt||(zt=_g(["Congratulations!"]))),$localize(Gt||(Gt=_g(["Failed, you have not captured any piece."])))),_te.fromMove($localize(Ht||(Ht=_g(["Gain a tile"]))),$localize($t||($t=_g(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new tre([[ore,ore,ore,ore,ore,ore,are,are,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ure,are,are,ore,ore,ore,ore,ore,ore],[are,are,are,ore,ore,ore,are,are,are,ore,ore,ore,ore,ore,ore],[are,are,ure,are,are,are,are,sre,are,ore,ore,ore,ore,ore,ore],[are,are,are,ure,are,are,are,are,are,ore,ore,ore,ore,ore,ore],[are,are,are,are,are,are,are,are,are,are,are,sre,ore,ore,ore],[are,are,sre,are,are,ure,are,are,are,are,sre,are,are,are,sre],[are,are,are,are,are,are,ure,are,ure,are,are,sre,are,sre,are],[ore,ore,ore,are,are,ure,are,are,are,ure,are,are,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ure,are,ure,ore,ore,ore,ore,ore,ore]],2,[0,0],[0,0]),[Xne.fromCoordToCoord(new qee(2,6),new qee(4,6)),Xne.fromCoordToCoord(new qee(2,6),new qee(3,5)),Xne.fromCoordToCoord(new qee(2,6),new qee(3,7))],$localize(Zt||(Zt=_g(["Congratulations!"]))),$localize(qt||(qt=_g(["Failed, you have not gained the two tiles that you could, try again!"])))),_te.fromMove($localize(Wt||(Wt=_g(["Exchanging a tile"]))),$localize(jt||(jt=_g(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new tre([[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,sre,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,are,are,are,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,are,ure,are,ure,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,ure,are,are,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ure,are,ure,ore,ore,ore,ore,ore,ore]],1,[0,2],[0,0]),[Xne.fromTilesExchange(new qee(5,5))],$localize(Yt||(Yt=_g(["Congratulations!"]))),$localize(Kt||(Kt=_g(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),_te.fromMove($localize(Qt||(Qt=_g(["Special capture"]))),$localize(Xt||(Xt=_g(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new tre([[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,are,are,sre,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,sre,are,are,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,sre,ure,are,ure,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,ure,sre,are,are,are,ore,ore,ore,ore,ore,ore],[ore,ore,ore,are,are,ure,ore,ore,ore,ore,ore,ore,ore,ore,ore],[ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore,ore]],1,[0,0],[0,0]),[Xne.fromCoordToCoord(new qee(7,6),new qee(6,5)),Xne.fromCoordToCoord(new qee(7,6),new qee(8,5))],$localize(Jt||(Jt=_g(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(en||(en=_g(["Failed!"]))))]});function lre(e,t){if(1&e&&(cC(),nS(0,"polygon",13)),2&e){var n=fS().index,r=fS().index,i=fS();XE("ngClass",i.getPyramidClass(n,r)),$E("points",i.getPyramidCoordinate(n,r))}}function fre(e,t){if(1&e&&(cC(),nS(0,"polygon",15)),2&e){var n=fS(2).index,r=fS().index,i=fS();XE("ngClass",i.getEmptyClass(n,r)),$E("points",i.getTriangleCoordinate(n,r))}}function hre(e,t){if(1&e&&(cC(),YE(0,fre,1,2,"polygon",14)),2&e){var n=fS().index,r=fS().index;XE("ngIf",fS().isEmptyCase(n,r))}}function dre(e,t){if(1&e&&(cC(),nS(0,"polygon",16)),2&e){var n=fS().index,r=fS().index,i=fS();vS("id","dark_line_",n,"_",r,""),$E("points",i.getLineCoordinate(n,r))}}function vre(e,t){if(1&e&&(cC(),nS(0,"polygon",17)),2&e){var n=fS().index,r=fS().index,i=fS();vS("id","dark_line_",n,"_",r,""),$E("points",i.getLineCoordinate(n,r))}}function pre(e,t){if(1&e){var n=aS();cC(),eS(0,"g",8),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),YE(1,lre,1,2,"polygon",9),YE(2,hre,1,1,"ng-template",null,10,xT),YE(4,dre,1,3,"polygon",11),YE(5,vre,1,3,"polygon",12),tS()}if(2&e){var r=t.$implicit,i=t.index,a=KE(3),o=fS().index,s=fS();vS("id","click_",i,"_",o,""),pb(1),XE("ngIf",s.isPyramid(i,o))("ngIfElse",a),pb(3),XE("ngIf",r!==s.NONE),pb(1),XE("ngIf",r!==s.NONE)}}function gre(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,pre,6,6,"g",7),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function yre(e,t){if(1&e&&(cC(),nS(0,"polygon",18)),2&e){var n=t.$implicit;$E("points",fS().getTriangleCoordinate(n.x,n.y))}}function mre(e,t){if(1&e&&(cC(),nS(0,"polygon",19)),2&e){var n=fS();$E("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function kre(e,t){if(1&e&&(cC(),nS(0,"polygon",19)),2&e){var n=fS();$E("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Cre(e,t){if(1&e&&(cC(),nS(0,"polygon",20)),2&e){var n=fS();$E("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function wre(e,t){if(1&e&&(cC(),eS(0,"g",21),nS(1,"polygon",22),eS(2,"text",23),FS(3),tS(),tS()),2&e){var n=fS();pb(1),$E("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),pb(1),$E("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),pb(1),US(n.tiles[0])}}function _re(e,t){if(1&e&&(cC(),eS(0,"g",24),nS(1,"polygon",25),eS(2,"text",26),FS(3),tS(),tS()),2&e){var n=fS();pb(1),$E("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),pb(1),$E("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),pb(1),US(n.tiles[1])}}var bre=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=Yee.UNREACHABLE,r.chosenCoord=fB.empty(),r.lastStart=fB.empty(),r.lastEnd=fB.empty(),r.highlights=[],r.scores=fB.of([0,0]),r.rules=new nre(tre),r.availableMinimaxes=[new rre(r.rules,"Normal"),new ire(r.rules,"Piece > Threat > Tiles")],r.encoder=Xne.encoder,r.tutorial=(new cre).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.chosenCoord=fB.empty(),this.state=this.rules.node.gameState,this.scores=fB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=fB.empty(),this.lastEnd=fB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new qee(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=Xne.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=fB.of(e),t.showHighlight(),o7.SUCCESS):t.cancelMove(Kne.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),o7.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=Xne.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(Kne.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===Yee.ZERO?this.getPlayerClass(N7.ZERO):n===Yee.ONE?this.getPlayerClass(N7.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===Yee.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===Yee.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===Yee.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===Yee.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(Yne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-coerceo"]],features:[RE],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,gre,2,1,"g",1),YE(2,yre,1,1,"polygon",2),YE(3,mre,1,1,"polygon",3),YE(4,kre,1,1,"polygon",3),YE(5,Cre,1,1,"polygon",4),YE(6,wre,4,6,"g",5),YE(7,_re,4,6,"g",6),tS()),2&e&&($E("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.highlights),pb(1),XE("ngIf",t.lastStart.isPresent()),pb(1),XE("ngIf",t.lastEnd.isPresent()),pb(1),XE("ngIf",t.chosenCoord.isPresent()),pb(1),XE("ngIf",t.mustShowTilesOf(0)),pb(1),XE("ngIf",t.mustShowTilesOf(1)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ere=function(){var e=Wg(function e(){Zg(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(tn||(tn=_g(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(nn||(nn=_g(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(rn||(rn=_g(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(an||(an=_g(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(on||(on=_g(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(sn||(sn=_g(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(un||(un=_g(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Sre=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(U7.createTable(n.WIDTH,n.HEIGHT,M7.NONE),0)}}]),n}(ste);Sre.WIDTH=17,Sre.HEIGHT=17,Sre.CENTRAL_ZONE_TOP_LEFT=new qee(4,6),Sre.CENTRAL_ZONE_BOTTOM_RIGHT=new qee(12,10),Sre.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Sre.ALL_SHELTERS=new ate(Sre.SHELTERS_INDICES.flatMap(function(e){return[new qee(e,0),new qee(e,Sre.HEIGHT-1),new qee(0,e),new qee(Sre.WIDTH-1,e)]})).toList();var Pre=function(e){Mg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e.x,e.y)}return Wg(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Sre.WIDTH,Sre.HEIGHT)?r7.success(new n(e)):r7.failure("Move out of board")}}]),n}(lte);Pre.encoder=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Mg(a,r);var i=Dg(a);function a(){var e;return Zg(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return Wg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new qee((r-=r%1)%e,i);return n(a)}}]),a}(R7))}}]),e}().getEncoder(Sre.WIDTH,Sre.HEIGHT,function(e){return Pre.of(e).get()});var Ore=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Sre.WIDTH,Sre.HEIGHT)&&t.isInRange(Sre.WIDTH,Sre.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?r7.success(new n(e,t)):r7.failure(Ere.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):r7.failure("Move out of board")}}]),n}(dne);Ore.encoder=dne.getEncoder(Sre.WIDTH,Sre.HEIGHT,function(e,t){return Ore.of(e,t).get()});var Tre=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).coords=e,r}return Wg(n,[{key:"addJump",value:function(e){var t=U7.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return r7.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Gg(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Sre.WIDTH,Sre.HEIGHT))return r7.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return r7.failure(Ere.INVALID_JUMP());return new Tne(e).size()===e.length?r7.success(new n(e)):r7.failure(Ere.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(cte);Tre.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).coordEncoder=qee.numberEncoder(Sre.WIDTH,Sre.HEIGHT),e}return Wg(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){f7(null!=oB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=oB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Tre.of(t).get()}}]),n}(A7));var Ire=A7.disjunction3(Pre.encoder,Ore.encoder,Tre.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Are=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Sre)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=M7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=M7.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Sre(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?r7.failure(Ere.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?r7.failure(Ere.MUST_DROP_IN_CENTRAL_ZONE()):r7.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?r7.failure(Ere.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):r7.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return r7.failure(Ere.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE());var n,r=Gg(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===M7.NONE)return r7.failure(Ere.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Gg(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return r7.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new qee(e.x+2,e.y),new qee(e.x-2,e.y),new qee(e.x,e.y+2),new qee(e.x,e.y-2),new qee(e.x+2,e.y+2),new qee(e.x+2,e.y-2),new qee(e.x-2,e.y+2),new qee(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Tre.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Gg(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Gg(Sre.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return yte.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return yte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(mte);Are.singleton=fB.empty();var Rre=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Sre.CENTRAL_ZONE_TOP_LEFT,r=Sre.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===M7.NONE&&t.push(Pre.of(new qee(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Sre.HEIGHT;r++)for(var i=0;i<Sre.WIDTH;i++){var a=new qee(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new qee(t.x+1,t.y),new qee(t.x-1,t.y),new qee(t.x,t.y+1),new qee(t.x,t.y-1),new qee(t.x+1,t.y+1),new qee(t.x+1,t.y-1),new qee(t.x-1,t.y+1),new qee(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Ore.of(t,a);o.isSuccess()&&Are.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new ate,i=Gg(Are.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Tre.of([t,a]).get();Are.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Are.get().nextJumps(t,e),i=new ate(r),a=Gg(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new dte([{key:N7.ZERO,value:0},{key:N7.ONE,value:0}]),i=0;i<Sre.HEIGHT;i++)for(var a=0;a<Sre.WIDTH;a++){var o=new qee(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new rte(s.getVictoryValue())}else{var u,c=100,l=Gg(Sre.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===M7.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new rte(n)}}]),n}(nte),xre=M7.NONE,Mre=M7.ZERO,Nre=M7.ONE,Dre=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(cn||(cn=_g(["Board and aim of the game"]))),$localize(ln||(ln=_g(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Sre.getInitialState()),_te.anyMove($localize(fn||(fn=_g(["Initial phase"]))),$localize(hn||(hn=_g(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Sre.getInitialState(),Pre.of(new qee(7,7)).get(),$localize(dn||(dn=_g(["Congratulations!"])))),_te.fromPredicate($localize(vn||(vn=_g(["Simple move"]))),$localize(pn||(pn=_g(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Sre([[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Mre,Nre,Nre,Mre,Mre,Nre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Nre,Mre,Nre,Mre,Mre,Mre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Nre,xre,xre,xre,xre,xre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Mre,Nre,Nre,Nre,Mre,Mre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Nre,Nre,Nre,Nre,Nre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre]],40),Ore.of(new qee(4,6),new qee(3,5)).get(),function(e,t){return e.isSimple()?o7.SUCCESS:o7.failure($localize(gn||(gn=_g(["You have made a jump, not a simple move. Try again!"]))))},$localize(yn||(yn=_g(["Congratulations!"])))),_te.fromPredicate($localize(mn||(mn=_g(["Jumps"]))),$localize(kn||(kn=_g(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Sre([[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Mre,Nre,Nre,Mre,Mre,Nre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Nre,Mre,Nre,Mre,Mre,Mre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Nre,xre,xre,xre,xre,xre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Mre,Nre,Nre,Nre,Mre,Mre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Nre,Nre,Nre,Nre,Nre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre]],40),Tre.of([new qee(6,7),new qee(6,5)]).get(),function(e,t){return e.isJump()?o7.SUCCESS:o7.failure($localize(Cn||(Cn=_g(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=_g(["Congratulations!"])))),_te.fromMove($localize(_n||(_n=_g(["Chaining jumps in a single move"]))),$localize(bn||(bn=_g(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Sre([[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,Nre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,Nre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,Nre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Mre,xre,Nre,Mre,Mre,Nre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,xre,Mre,Nre,Mre,Mre,Mre,Mre,Nre,xre,xre,xre,xre],[xre,xre,xre,xre,Mre,Nre,xre,xre,xre,xre,xre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Mre,Nre,Nre,Nre,Mre,Mre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,Nre,Mre,Nre,Nre,Nre,Nre,Nre,Nre,Mre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre],[xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre,xre]],40),[Tre.of([new qee(8,6),new qee(6,4),new qee(6,2),new qee(6,0)]).get()],$localize(En||(En=_g(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Sn||(Sn=_g(["You have not performed a triple jump. Try again!"]))))]});function Lre(e,t){if(1&e){var n=aS();cC(),eS(0,"rect",9),uS("click",function(){Nk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),tS()}if(2&e){var r=fS().$implicit,i=fS(2);$E("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function Fre(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",6),uS("click",function(){Nk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),tS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();vS("id","piece_",i,"_",o,""),XE("ngClass",a.pieceClasses),$E("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function Ure(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",6),uS("click",function(){var e=Nk(n).$implicit;return fS(2).onClick(e.coord)}),tS(),YE(2,Lre,1,4,"rect",7),YE(3,Fre,1,6,"circle",8),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","click_",i,"_",a,""),XE("ngClass",r.squareClasses),$E("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r.isShelter),pb(1),XE("ngIf",r.hasPiece)}}function Vre(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Ure,4,9,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Bre(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",10),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),XE("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),$E("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function zre(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=t.$implicit,r=fS();dS("id","sidePiece_0_",n,""),$E("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Gre(e,t){if(1&e&&(cC(),nS(0,"circle",12)),2&e){var n=t.$implicit,r=fS();dS("id","sidePiece_1_",n,""),$E("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Hre(e,t){if(1&e&&(cC(),nS(0,"rect",13)),2&e){var n=fS();$E("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var $re=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).ALL_SHELTERS=Sre.ALL_SHELTERS,r.CENTRAL_ZONE_START=Sre.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Bee(Sre.CENTRAL_ZONE_BOTTOM_RIGHT.x-Sre.CENTRAL_ZONE_TOP_LEFT.x+1,Sre.CENTRAL_ZONE_BOTTOM_RIGHT.y-Sre.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=fB.empty(),r.jumpInConstruction=fB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=Are.get(),r.availableMinimaxes=[new Rre(r.rules,"ConspirateursMinimax")],r.encoder=Ire,r.tutorial=(new Dre).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Sre.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Sre.WIDTH;n++){var r=new qee(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Gg(Sre.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Gg(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Are.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Gg(Sre.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=Gg(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=fB.empty(),this.selected=fB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=fB.of(e),t.jumpInConstruction=fB.empty(),t.updateViewInfo(),o7.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Pre.of(e),n.abrupt("return",(f7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=fB.of(e),t.updateViewInfo(),o7.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Ore.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Tre.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(Wee);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-conspirateurs"]],features:[RE],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Vre,2,1,"g",1),YE(2,Bre,2,5,"g",1),YE(3,zre,1,4,"circle",2),YE(4,Gre,1,4,"circle",3),YE(5,Hre,1,4,"rect",4),nS(6,"polyline",5),tS()),2&e&&(pb(1),XE("ngForOf",t.viewInfo.boardInfo),pb(1),XE("ngForOf",t.ALL_SHELTERS),pb(1),XE("ngForOf",t.range(t.viewInfo.sidePieces[0])),pb(1),XE("ngForOf",t.range(t.viewInfo.sidePieces[1])),pb(1),XE("ngIf",t.viewInfo.dropPhase),pb(1),$E("points",t.viewInfo.lastMoveArrow))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zre=function(){function e(t,n){Zg(this,e),this.owner=t,this.otherPieceType=n}return Wg(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===N7.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===N7.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();Zre.encoder=R7.tuple([N7.numberEncoder,R7.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return Zre.of(e[0],e[1])}),Zre.EMPTY=new Zre(M7.NONE,!1),Zre.ZERO_FIRST=new Zre(N7.ZERO,!1),Zre.ZERO_SECOND=new Zre(N7.ZERO,!0),Zre.ONE_FIRST=new Zre(N7.ONE,!1),Zre.ONE_SECOND=new Zre(N7.ONE,!0),Zre.PLAYER_PIECES=[Zre.ZERO_FIRST,Zre.ZERO_SECOND,Zre.ONE_FIRST,Zre.ONE_SECOND];var qre=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),(i=t.call(this)).target=e,i.piece=r,r===Zre.EMPTY)throw new Error("Cannot drop an empty piece");return Lg(i)}return Wg(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(cte);qre.encoder=R7.tuple([R7.numberEncoder(7),Zre.encoder],function(e){return[e.target,e.piece]},function(e){return new qre(e[0],e[1])});var Wre=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return Wg(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new qee(e.x,3-e.y),t)}}]),n}(cte);Wre.encoder=R7.tuple([qee.numberEncoder(8,4),R7.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new Wre(e[0],e[1]?"clockwise":"counterclockwise")});var jre=R7.disjunction(qre.encoder,Wre.encoder,function(e){return e.isDrop()}),Yre=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Pn||(Pn=_g(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(On||(On=_g(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Tn||(Tn=_g(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(In||(In=_g(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(An||(An=_g(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),Kre=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return Wg(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==Zre.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=Zre.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==Zre.EMPTY&&i[n.pieceIndex(s)]--}return f7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case Zre.ZERO_FIRST:return 0;case Zre.ZERO_SECOND:return 1;case Zre.ONE_FIRST:return 2;default:return oB.expectToBe(e,Zre.ONE_SECOND),3}}}]),n}(ste);return e.WIDTH=8,e.HEIGHT=4,e}(),Qre=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Kre)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=U7.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=U7.copyImmutableArray(t.remainingPieces);return r[Kre.pieceIndex(e.piece)]-=1,new Kre(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=U7.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<Kre.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==Zre.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=Zre.EMPTY,i++,a++;return new Kre(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?r7.failure(Yre.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===Kre.HEIGHT?r7.failure(Yre.SPACE_IS_FULL()):r7.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Kre.HEIGHT?r7.failure(Yre.TARGET_STACK_TOO_HIGH()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return f7(n.owner.isPlayer(),"highest alignment is owned by a player"),yte.getVictory(n.owner)}return yte.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<Kre.WIDTH/2;t++)for(var n=Kre.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Kre.WIDTH/2,n);if(r!==Zre.EMPTY&&r===i)return fB.of(new qee(t,n))}return fB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new Wre(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new Wre(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(mte);Qre.singleton=fB.empty();var Xre=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Gg(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new Wre(i,"clockwise"),new Wre(i,"counterclockwise")];a<o.length;a++){var s=o[a];Qre.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<Kre.WIDTH;r++){var i,a=Gg(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new qre(r,o);Qre.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Gg(Zre.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Kre.HEIGHT;r++)for(var i=0;i<Kre.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new qee(i,r));return t}},{key:"getBoardValue",value:function(e){var t=Qre.get().getGameStatus(e);return new rte(t.isEndGame?t.toBoardValue():0)}}]),n}(nte),Jre=Zre.EMPTY,eie=Zre.ZERO_FIRST,tie=Zre.ZERO_SECOND,nie=Zre.ONE_FIRST,rie=Zre.ONE_SECOND,iie=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Rn||(Rn=_g(["Initial board and player pieces"]))),$localize(xn||(xn=_g(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),Kre.getInitialState()),_te.fromMove($localize(Mn||(Mn=_g(["Goal of the game"]))),$localize(Nn||(Nn=_g(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),Kre.fromRepresentation([[Jre,Jre,Jre,Jre,Jre,Jre,Jre,Jre],[Jre,Jre,Jre,Jre,Jre,Jre,Jre,Jre],[Jre,Jre,Jre,Jre,nie,Jre,Jre,Jre],[eie,Jre,Jre,Jre,eie,Jre,Jre,Jre]],3),[new qre(0,Zre.ONE_FIRST)],$localize(Dn||(Dn=_g(["Congratulations, you won!"]))),$localize(Ln||(Ln=_g(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),_te.fromMove($localize(Fn||(Fn=_g(["Types of move"]))),$localize(Un||(Un=_g(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),Kre.fromRepresentation([[Jre,Jre,Jre,Jre,Jre,Jre,Jre,Jre],[Jre,Jre,Jre,Jre,rie,Jre,Jre,Jre],[Jre,Jre,Jre,Jre,eie,Jre,Jre,Jre],[nie,Jre,Jre,Jre,tie,Jre,Jre,Jre]],4),[Wre.fromRepresentation(new qee(4,3),"counterclockwise"),Wre.fromRepresentation(new qee(4,3),"clockwise"),Wre.fromRepresentation(new qee(4,2),"counterclockwise"),Wre.fromRepresentation(new qee(4,2),"clockwise")],$localize(Vn||(Vn=_g(["Congratulations!"]))),$localize(Bn||(Bn=_g(["Failed, try to move one of your piece that is already on the board."])))),_te.fromMove($localize(zn||(zn=_g(["Special case"]))),$localize(Gn||(Gn=_g(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),Kre.fromRepresentation([[Jre,Jre,Jre,Jre,eie,Jre,Jre,Jre],[Jre,Jre,Jre,Jre,rie,Jre,Jre,eie],[Jre,Jre,Jre,Jre,eie,Jre,Jre,rie],[Jre,nie,Jre,Jre,tie,Jre,Jre,nie]],8),[Wre.fromRepresentation(new qee(4,2),"counterclockwise")],$localize(Hn||(Hn=_g(["Congratulations!"]))),$localize($n||($n=_g(["Failed, try to shift a stack of pieces to the left."]))))]});function aie(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"path",6),uS("click",function(){var e=Nk(n).$implicit;return fS().onSpaceClick(e)}),tS(),eS(2,"path",7),uS("click",function(){var e=Nk(n).$implicit;return fS().onSpaceClick(e)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),dS("id","click_",r,""),XE("ngClass",i.viewInfo.boardInfo[r].spaceClasses),$E("d",i.BOARD_PATHS[r]),pb(1),XE("ngClass",i.viewInfo.boardInfo[r].spaceClasses),$E("d",i.DECORATION_PATHS[r])}}function oie(e,t){if(1&e){var n=aS();cC(),eS(0,"g",9),uS("click",function(){var e=Nk(n).$implicit,t=fS().$implicit;return fS().onPieceInGameClick(t,e.y)}),nS(1,"use",10),nS(2,"use",11),tS()}if(2&e){var r=t.$implicit;vS("id","click_",fS().$implicit,"_",r.y,""),XE("ngClass",r.foregroundClasses),pb(1),XE("ngClass",r.backgroundClasses),$E("x",r.drawPosition.x)("y",r.drawPosition.y),pb(1),$E("x",r.drawPosition.x)("y",r.drawPosition.y)}}function sie(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,oie,3,8,"g",8),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function uie(e,t){if(1&e){var n=aS();cC(),eS(0,"g",12),uS("click",function(){var e=Nk(n).$implicit;return fS().onRemainingPieceClick(e.actualPiece)}),nS(1,"use",10),nS(2,"use",11),tS()}if(2&e){var r=t.$implicit;vS("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),XE("ngClass",r.foregroundClasses),pb(1),XE("ngClass",r.backgroundClasses),$E("x",r.drawPosition.x)("y",r.drawPosition.y),pb(1),$E("x",r.drawPosition.x)("y",r.drawPosition.y)}}var cie=function(){return[0,1,2,3,4,5,6,7]},lie=function(){return[2,1,3,0,4,7,5,6]},fie=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=fB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=Qre.get(),r.availableMinimaxes=[new Xre(r.rules,"DiamDummyMinimax")],r.encoder=jre,r.tutorial=(new iie).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new qre(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%Kre.WIDTH!==e){n.next=10;break}i=new Wre(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(Kre.WIDTH-1))%Kre.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(Yre.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new Wre(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(Yre.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=fB.of({type:"pieceFromBoard",position:new qee(e,t)}),n.updateViewInfo(),o7.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=fB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),o7.SUCCESS):t.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new qee(r,i);return[{start:fB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<Kre.HEIGHT&&t.getPieceAtXY(n,o)!==Zre.EMPTY;o++,i++)a.push({start:fB.of(new qee(n,o)),end:new qee(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<Kre.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;f7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<Kre.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;f7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Gg(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=Gg(Zre.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===N7.ZERO?-100:600,i=e.otherPieceType?100:450,new qee(r,i).getNext(new Bee(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<Kre.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new qee(e,i);if(a!==Zre.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Bee(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.updateBoard()}}]),n}(Wee);fie.CENTER=[new qee(40,160),new qee(100,50),new qee(255,2),new qee(400,50),new qee(460,160),new qee(400,270),new qee(255,320),new qee(100,270)],fie.PIECE_HEIGHT=36,fie.\u0275fac=function(e){return new(e||fie)(QE(c7))},fie.\u0275cmp=Hm({type:fie,selectors:[["app-diam"]],features:[RE],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"defs"),eS(2,"g",1),nS(3,"path",2),nS(4,"ellipse",3),tS(),tS(),YE(5,aie,3,5,"g",4),YE(6,sie,2,1,"g",4),YE(7,uie,3,8,"g",5),tS()),2&e&&(pb(5),XE("ngForOf",aT(3,cie)),pb(1),XE("ngForOf",aT(4,lie)),pb(1),XE("ngForOf",t.viewInfo.remainingPieces))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var hie=function(){function e(t,n){Zg(this,e),this.offset=t,this.constant=n}return Wg(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return Kee.DOWN;case"r":return Kee.RIGHT;case"s":return Kee.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?fB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?fB.of(e.constantR(a)):r!==i&&a!==o&&s===u?fB.of(e.constantS(s)):fB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Gg(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),die=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,f7(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return Wg(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=Gg(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(hie.constantQ(t));for(var n=0;n<this.height;n++)e.push(hie.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(hie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new qee(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new qee(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new qee(e.offset,0):new qee(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=l7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new qee(e.x+t,e.y-t),new qee(e.x+t,e.y),new qee(e.x-t,e.y+t),new qee(e.x-t,e.y),new qee(e.x,e.y+t),new qee(e.x,e.y-t)]}}]),n}(ste),vie=function(){function e(t,n,r){Zg(this,e),this.owner=t,this.size=n,this.source=r}return Wg(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();vie.sizeEncoder=R7.numberEncoder(49),vie.encoder=R7.tuple([R7.booleanEncoder,N7.numberEncoder,vie.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new vie(e[1],e[2],e[0])}),vie.MAX_SIZE=49,vie.EMPTY=new vie(M7.NONE,0,!1),vie.UNREACHABLE=new vie(M7.NONE,-1,!1),vie.PLAYER_ZERO=new vie(N7.ZERO,1,!1),vie.PLAYER_ONE=new vie(N7.ONE,1,!1),vie.SOURCE=new vie(M7.NONE,1,!0);var pie=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,vie.EMPTY)).alreadyPassed=i,a}return Wg(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new qee(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return die.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=U7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==vie.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=vie.UNREACHABLE,t=vie.PLAYER_ZERO,n=vie.PLAYER_ONE,r=vie.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==vie.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(die);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e}(),gie=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!pie.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!pie.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(dne);gie.PASS=new gie(new qee(-1,-1),new qee(-2,-2)),gie.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return gie.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new gie(new qee((e=e/16|0)%16,r),new qee(n,t))}}]),n}(R7));var yie=function(){var e=Wg(function e(){Zg(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Zn||(Zn=_g(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=_g(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Wn||(Wn=_g(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(jn||(jn=_g(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Yn||(Yn=_g(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Kn||(Kn=_g(["The stack must land on an occupied space."])))},e}(),mie=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isMovablePiece",value:function(e,t){f7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?o7.failure(yie.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?o7.failure(yie.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?o7.SUCCESS:o7.failure(yie.CANT_REACH_TARGET()):o7.failure(yie.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;die.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=U7.createTable(pie.WIDTH,pie.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,vie.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===gie.PASS)return new pie(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,vie.EMPTY).setAt(e.end,vie.append(r,i));return this.removeDisconnectedPieces(new pie(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==gie.PASS||t.alreadyPassed?r7.failure(tte.MUST_PASS()):r7.success(void 0);if(e===gie.PASS)return r7.failure(tte.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?r7.failure(yie.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?r7.failure(yie.EMPTY_TARGET_STACK()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?yte.ZERO_WON:r[0]<r[1]?yte.ONE_WON:yte.DRAW:yte.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==die.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return die.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(N7.ZERO)?t+=i.getSize():i.belongsTo(N7.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(mte),kie=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return mie.getMovablePieces(n).forEach(function(e){return mie.pieceTargets(n,e).forEach(function(t){var n=gie.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(gie.PASS)&&r.push(gie.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=mie.getScores(t);return 0===mie.getMovablePieces(t).length?new rte(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new rte(n[0]-n[1])}}]),n}(nte),Cie=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=Rg(Vg(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return U7.sortByDescending(r,function(e){f7(e!==gie.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=mie.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n=e.gameState,r=mie.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(N7.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(N7.ONE)}).length;return new rte((s*r[1]-o*r[0])/a)}}]),n}(kie),wie=vie.EMPTY,_ie=vie.UNREACHABLE,bie=vie.SOURCE,Eie=vie.PLAYER_ZERO,Sie=vie.PLAYER_ONE,Pie=new vie(N7.ZERO,2,!1),Oie=new vie(N7.ONE,2,!1),Tie=new vie(N7.ZERO,4,!1),Iie=new vie(N7.ONE,4,!1),Aie=Wg(function e(){Zg(this,e),this.tutorial=[_te.anyMove($localize(Qn||(Qn=_g(["Moving"]))),$localize(Xn||(Xn=_g(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),pie.getInitialState(),gie.of(new qee(2,0),new qee(3,0)),$localize(Jn||(Jn=_g(["Congratulations!"])))),_te.fromPredicate($localize(er||(er=_g(["Disconnection"]))),$localize(tr||(tr=_g(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new pie([[_ie,_ie,Sie,bie,wie,wie,wie,wie,wie,wie,wie],[_ie,wie,Eie,wie,wie,wie,wie,wie,wie,wie,wie],[wie,wie,Iie,wie,wie,wie,wie,Sie,bie,wie,wie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie,_ie]],0,!1),gie.of(new qee(2,1),new qee(2,0)),function(e,t){return e.end.equals(new qee(3,0))?o7.failure($localize(nr||(nr=_g(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(f7(e.end.equals(new qee(2,0)),"player made an impossible move"),o7.SUCCESS)},$localize(rr||(rr=_g(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),_te.fromPredicate($localize(ir||(ir=_g(["Moving on a source"]))),$localize(ar||(ar=_g(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new pie([[_ie,_ie,bie,Sie,wie,wie,wie,wie,wie,wie,wie],[_ie,Eie,Eie,wie,wie,wie,wie,wie,wie,wie,wie],[wie,Sie,Eie,Sie,wie,wie,Eie,Oie,bie,wie,wie],[wie,wie,Sie,wie,wie,wie,wie,wie,wie,wie,_ie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie,_ie]],0,!1),gie.of(new qee(2,1),new qee(2,0)),function(e,t){return e.end.equals(new qee(2,0))?o7.SUCCESS:o7.failure($localize(or||(or=_g(["You have not taken possession of a source, try again."]))))},$localize(sr||(sr=_g(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),_te.informational($localize(ur||(ur=_g(["Passing"]))),$localize(cr||(cr=_g(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new pie([[_ie,_ie,bie,wie,wie,wie,wie,wie,wie,wie,wie],[_ie,wie,Pie,wie,wie,wie,wie,wie,wie,wie,wie],[wie,wie,Oie,wie,wie,wie,wie,Oie,bie,Tie,wie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie,_ie]],0,!1)),_te.fromMove($localize(lr||(lr=_g(["End of the game"]))),$localize(fr||(fr=_g(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new pie([[_ie,_ie,bie,wie,wie,wie,wie,wie,wie,wie,wie],[_ie,wie,Eie,wie,wie,wie,wie,wie,wie,wie,wie],[wie,wie,wie,wie,wie,wie,wie,wie,bie,Tie,wie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie],[wie,wie,wie,wie,wie,wie,wie,wie,wie,_ie,_ie]],0,!1),[gie.of(new qee(2,1),new qee(2,0))],$localize(hr||(hr=_g(["Congratulations, you won 6 - 0!"]))),$localize(dr||(dr=_g(["Bad idea, by moving on the source you would have won a point."]))))]});function Rie(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS().$implicit,r=fS().$implicit,i=fS();XE("ngClass",i.getPieceClasses(n)),$E("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function xie(e,t){if(1&e&&(cC(),nS(0,"polygon",11)),2&e){var n=fS().$implicit,r=fS().$implicit,i=fS();$E("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Mie(e,t){if(1&e){var n=aS();cC(),eS(0,"text",12),uS("click",function(){Nk(n);var e=fS(2).$implicit;return fS().onClick(e.x,e.y)}),FS(1),tS()}if(2&e){var r=fS().$implicit,i=fS().$implicit,a=fS();$E("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),pb(1),US(r.getSize())}}function Nie(e,t){if(1&e){var n=aS();cC(),eS(0,"g",5),uS("click",function(){Nk(n);var e=fS().$implicit;return fS().onClick(e.x,e.y)}),nS(1,"polyline",6),YE(2,Rie,1,4,"circle",7),YE(3,xie,1,1,"polygon",8),YE(4,Mie,2,3,"text",9),tS()}if(2&e){var r=t.$implicit,i=fS().$implicit,a=fS();vS("id","click_",i.x,"_",i.y,""),pb(1),$E("points",a.getHexaCoordsAt(i)),pb(1),XE("ngIf",r.getSize()>0),pb(1),XE("ngIf",r.containsSource()),pb(1),XE("ngIf",r.getSize()>1)}}var Die=function(e){return[e]};function Lie(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Nie,5,6,"g",4),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",oT(1,Die,r.state.getPieceAt(n)))}}function Fie(e,t){if(1&e&&(cC(),eS(0,"text",16),FS(1),tS()),2&e){var n=fS().$implicit,r=fS();$E("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),pb(1),US(n.caseContent.getSize())}}function Uie(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"polyline",13),nS(2,"circle",14),YE(3,Fie,2,3,"text",15),tS()),2&e){var n=t.$implicit,r=fS();pb(1),$E("points",r.getHexaCoordsAt(n.coord)),pb(1),vS("id","captured_",n.coord.x,"_",n.coord.y,""),XE("ngClass",r.getPieceClasses(n.caseContent)),$E("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),pb(1),XE("ngIf",n.caseContent.getSize()>1)}}function Vie(e,t){if(1&e&&(cC(),rS(0),nS(1,"polyline",17),nS(2,"polyline",17),iS()),2&e){var n=fS();pb(1),$E("points",n.getHexaCoordsAt(n.lastMove.get().coord)),pb(1),$E("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function Bie(e,t){if(1&e&&(cC(),nS(0,"polyline",18)),2&e){var n=fS();$E("points",n.getHexaCoordsAt(n.chosen.get()))}}var zie=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosen=fB.empty(),r.disconnecteds=[],r.rules=new mie(pie),r.availableMinimaxes=[new kie(r.rules,"DvonnMinimax"),new Cie(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=gie.encoder,r.tutorial=(new Aie).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=fB.of(mie.getScores(r.rules.node.gameState)),r.hexaLayout=new Qee(1.5*r.SPACE_SIZE,new qee(-r.SPACE_SIZE,2*r.SPACE_SIZE),Jee.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return Wg(n,[{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=fB.of(mie.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new qee(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new qee(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=fB.empty()}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(gie.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new qee(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),o7.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new qee(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=fB.of(n),o7.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new qee(e,t),o=gie.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(jee);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-dvonn"]],features:[RE],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Lie,2,3,"g",1),YE(2,Uie,4,8,"g",1),YE(3,Vie,3,2,"ng-container",2),YE(4,Bie,1,1,"polyline",3),tS()),2&e&&(pb(1),XE("ngForOf",t.state.allCoords()),pb(1),XE("ngForOf",t.disconnecteds),pb(1),XE("ngIf",t.lastMove.isPresent()),pb(1),XE("ngIf",t.chosen.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Gie=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(Gie||(Gie={})),Gie),Hie=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return N7.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return N7.ONE;default:return M7.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return Gie.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return Gie.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return Gie.SMALL;default:return oB.expectToBe(this,e.NONE),Gie.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return oB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===N7.ZERO&&t===Gie.BIG?e.BIG_DARK:n===N7.ZERO&&t===Gie.MEDIUM?e.MEDIUM_DARK:n===N7.ZERO&&t===Gie.SMALL?e.SMALL_DARK:n===N7.ONE&&t===Gie.BIG?e.BIG_LIGHT:n===N7.ONE&&t===Gie.MEDIUM?e.MEDIUM_LIGHT:n===N7.ONE&&t===Gie.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();Hie.SMALL_DARK=new Hie(0),Hie.SMALL_LIGHT=new Hie(1),Hie.MEDIUM_DARK=new Hie(2),Hie.MEDIUM_LIGHT=new Hie(3),Hie.BIG_DARK=new Hie(4),Hie.BIG_LIGHT=new Hie(5),Hie.NONE=new Hie(6);var $ie=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return Wg(n,[{key:"getRemainingPieces",value:function(){return U7.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new Zie(M7.NONE,M7.NONE,M7.NONE).encode(),t=U7.createTable(3,3,e);return new n(U7.mapBiArray(t,function(e){return Zie.decode(e)}),0,[Hie.BIG_DARK,Hie.BIG_DARK,Hie.BIG_LIGHT,Hie.BIG_LIGHT,Hie.MEDIUM_DARK,Hie.MEDIUM_DARK,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT,Hie.SMALL_DARK,Hie.SMALL_DARK,Hie.SMALL_LIGHT,Hie.SMALL_LIGHT])}}]),n}(ste),Zie=function(){function e(t,n,r){Zg(this,e),this.small=t,this.medium=n,this.big=r}return Wg(e,[{key:"isEmpty",value:function(){return this.small===M7.NONE&&this.medium===M7.NONE&&this.big===M7.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(Hie.ofSizeAndPlayer(Gie.SMALL,this.small)),this.medium.isPlayer()&&e.push(Hie.ofSizeAndPlayer(Gie.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Hie.ofSizeAndPlayer(Gie.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=Hie.ofSizeAndPlayer(Gie.SMALL,this.small),t=Hie.ofSizeAndPlayer(Gie.MEDIUM,this.medium),n=Hie.ofSizeAndPlayer(Gie.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===N7.ZERO?Hie.BIG_DARK:this.big===N7.ONE?Hie.BIG_LIGHT:this.medium===N7.ZERO?Hie.MEDIUM_DARK:this.medium===N7.ONE?Hie.MEDIUM_LIGHT:this.small===N7.ZERO?Hie.SMALL_DARK:this.small===N7.ONE?Hie.SMALL_LIGHT:Hie.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===Hie.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?fB.of(this.put(e)):fB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===Hie.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case Gie.BIG:t=new e(this.small,this.medium,M7.NONE);break;case Gie.MEDIUM:t=new e(this.small,M7.NONE,M7.NONE);break;default:oB.expectToBe(r,Gie.SMALL),t=new e(M7.NONE,M7.NONE,M7.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===Hie.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case Gie.BIG:return new e(this.small,this.medium,n);case Gie.MEDIUM:return f7(this.big===M7.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return oB.expectToBe(r,Gie.SMALL),f7(this.big===M7.NONE,"Cannot put a piece on top of a bigger one"),f7(this.medium===M7.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){f7(t%1==0,"EncapsuleCase must be encoded as integer: "+t),f7(t>=0,"To small representation for EncapsuleCase: "+t),f7(t<=26,"To big representation for EncapsuleCase: "+t);var n=N7.numberEncoder.decodeNumber(t%3);t-=n.value;var r=N7.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,N7.numberEncoder.decodeNumber(t/=3))}}]),e}();Zie.EMPTY=new Zie(M7.NONE,M7.NONE,M7.NONE);var qie=function(){var e=Wg(function e(){Zg(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(vr||(vr=_g(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(pr||(pr=_g(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(gr||(gr=_g(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(yr||(yr=_g(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(mr||(mr=_g(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(kr||(kr=_g(["You are performing a move, you must select a landing square."])))},e}(),Wie=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=Zie.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=Zie.decode(c).removeBiggest();i[u.y][u.x]=Zie.decode(l.removedCase.encode()),r=l.removedPiece}return new $ie(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=Gg(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return fB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===M7.NONE?fB.empty():t[0]===t[1]&&t[1]===t[2]?fB.of(t[0]):fB.empty()}},{key:"isLegal",value:function(e,t){var n;if(sB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return r7.failure(qie.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?r7.success(i.get()):r7.failure(qie.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?yte.getVictory(t.get()):yte.ONGOING}}]),n}(mte);Wie.LINES=[[new qee(0,0),new qee(0,1),new qee(0,2)],[new qee(1,0),new qee(1,1),new qee(1,2)],[new qee(2,0),new qee(2,1),new qee(2,2)],[new qee(0,0),new qee(1,0),new qee(2,0)],[new qee(0,1),new qee(1,1),new qee(2,1)],[new qee(0,2),new qee(1,2),new qee(2,2)],[new qee(0,0),new qee(1,1),new qee(2,2)],[new qee(0,2),new qee(1,1),new qee(2,0)]];var jie=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return Wg(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(fB.of(e),t,fB.empty())}},{key:"fromDrop",value:function(e,t){return new n(fB.empty(),t,fB.of(e))}}]),n}(cte);jie.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new qee(r,n);if(0===t){var a=Hie.of(e);return jie.fromDrop(a,i)}var o=e%3;e-=o;var s=new qee((e/=3)%3,o);return jie.fromMove(s,i)}}]),n}(R7));var Yie=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=Wie.getGameStatus(e);return new rte(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=ite.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new qee(s,o),l=Gg(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=jie.fromDrop(f,c);Wie.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new qee(v,d);if(!p.equals(c)){var g=jie.fromMove(c,p);Wie.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(nte),Kie=new Zie(M7.NONE,M7.NONE,M7.NONE),Qie=new Zie(N7.ZERO,M7.NONE,M7.NONE),Xie=new Zie(M7.NONE,N7.ZERO,M7.NONE),Jie=new Zie(M7.NONE,M7.NONE,N7.ZERO),eae=new Zie(N7.ONE,M7.NONE,M7.NONE),tae=new Zie(M7.NONE,M7.NONE,N7.ONE),nae=new Zie(N7.ONE,N7.ZERO,M7.NONE),rae=new Zie(N7.ZERO,N7.ZERO,M7.NONE),iae=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Cr||(Cr=_g(["Goal of the game"]))),$localize(wr||(wr=_g(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new $ie([[Qie,eae,tae],[Kie,Xie,Kie],[Kie,Kie,Jie]],0,[Hie.SMALL_DARK,Hie.MEDIUM_DARK,Hie.BIG_DARK,Hie.SMALL_LIGHT,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT,Hie.BIG_LIGHT])),_te.anyMove($localize(_r||(_r=_g(["Putting a piece"]))),$localize(br||(br=_g(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),$ie.getInitialState(),jie.fromDrop(Hie.SMALL_DARK,new qee(1,1)),$localize(Er||(Er=_g(["Congratulations!"])))),_te.fromMove($localize(Sr||(Sr=_g(["Moving"]))),$localize(Pr||(Pr=_g(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new $ie([[Qie,tae,Kie],[Kie,Kie,Kie],[Kie,Kie,Kie]],0,[]),[jie.fromMove(new qee(0,0),new qee(2,0)),jie.fromMove(new qee(0,0),new qee(0,1)),jie.fromMove(new qee(0,0),new qee(1,1)),jie.fromMove(new qee(0,0),new qee(2,1)),jie.fromMove(new qee(0,0),new qee(0,2)),jie.fromMove(new qee(0,0),new qee(1,2)),jie.fromMove(new qee(0,0),new qee(2,2))],$localize(Or||(Or=_g(["Congratulations!"]))),$localize(Tr||(Tr=_g(["Failed. Try again."])))),_te.fromPredicate($localize(Ir||(Ir=_g(["Particularity"]))),$localize(Ar||(Ar=_g(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new $ie([[nae,Kie,eae],[rae,tae,tae],[Kie,Kie,Kie]],0,[Hie.MEDIUM_DARK,Hie.BIG_DARK,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT]),jie.fromMove(new qee(0,1),new qee(0,2)),function(e,t){if(e.landingCoord.equals(new qee(0,2))){if(e.isDropping())return o7.failure($localize(Rr||(Rr=_g(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new qee(0,1)))return o7.SUCCESS}return o7.failure($localize(xr||(xr=_g(["Failed. Try again."]))))},$localize(Mr||(Mr=_g(["Congratulations!"]))))]});function aae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",5),uS("click",function(){var e=Nk(n),t=e.$implicit,r=e.index;return fS().onPieceClick(0,t,r)}),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();pb(1),dS("id","piece_0_",r.toString(),""),XE("ngClass",a.getSidePieceClasses(r,i)),$E("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function oae(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",8),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onBoardClick(e,t)}),tS()}if(2&e){var r=t.$implicit,i=fS().index,a=fS().index,o=fS();XE("ngClass",o.getPieceClasses(r)),$E("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function sae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",6),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onBoardClick(e,t)}),tS(),YE(2,oae,1,4,"circle",7),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","click_",i,"_",a,""),XE("ngClass",o.getRectClasses(i,a)),$E("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngForOf",o.getListPieces(r))}}function uae(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,sae,3,8,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function cae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",9),uS("click",function(){var e=Nk(n).$implicit;return fS().onBoardClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),$E("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function lae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",5),uS("click",function(){var e=Nk(n),t=e.$implicit,r=e.index;return fS().onPieceClick(1,t,r)}),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();pb(1),dS("id","piece_1_",r.toString(),""),XE("ngClass",a.getSidePieceClasses(r,i)),$E("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var fae=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.chosenCoord=fB.empty(),r.chosenPiece=fB.empty(),r.remainingPieceLeftX=[],r.rules=new Wie($ie),r.availableMinimaxes=[new Yie(r.rules,"EncapsuleMinimax")],r.encoder=jie.encoder,r.tutorial=(new iae).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=fB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=fB.empty(),this.lastStartingCoord=fB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(N7.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new qee(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=fB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=jie.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(qie.INVALID_PIECE_SELECTED()):o7.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(qie.SAME_DEST_AS_ORIGIN()));case 11:return u=jie.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenPiece=fB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(qie.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=fB.of(t),r.chosenPieceIndex=n,o7.SUCCESS):r.cancelMove(qie.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new qee(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return f7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case Gie.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case Gie.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return oB.expectToBe(e.getSize(),Gie.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-encapsule"]],features:[RE],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"g",null,1),YE(3,aae,2,5,"g",2),tS(),eS(4,"g",null,3),YE(6,uae,2,1,"g",2),YE(7,cae,2,4,"g",2),tS(),eS(8,"g",null,4),YE(10,lae,2,5,"g",2),tS(),tS()),2&e&&(pb(1),$E("transform","translate("+t.STROKE_WIDTH+", 0)"),pb(2),XE("ngForOf",t.getRemainingPieces(0)),pb(1),$E("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),pb(2),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.getHighlightedCases()),pb(1),$E("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),pb(2),XE("ngForOf",t.getRemainingPieces(1)))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hae=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;if(Zg(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return Lg(s)}return Wg(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(lte);hae.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=Hee.factory.fromInt(t);return new hae(a,i,r+1,n+1,o.get())}}]),n}(R7));var dae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=M7.NONE,t=M7.ZERO,r=M7.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(ste),vae=function(){var e=Wg(function e(){Zg(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Nr||(Nr=_g(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Dr||(Dr=_g(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Lr||(Lr=_g(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Fr||(Fr=_g(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Ur||(Ur=_g(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Vr||(Vr=_g(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Br||(Br=_g(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(zr||(zr=_g(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Gr||(Gr=_g(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Hr||(Hr=_g(["A phalanx cannot contain a piece of the opponent."])))},e}(),pae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new dae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(N7.ZERO,0),r=t.count(N7.ONE,11);if(t.turn%2==0){if(n>r)return yte.ZERO_WON}else if(r>n)return yte.ONE_WON;return!1===t.doesOwnPiece(N7.ZERO)?yte.ONE_WON:!1===t.doesOwnPiece(N7.ONE)?yte.ZERO_WON:yte.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return r7.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=U7.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:r7.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return o7.failure(vae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===M7.NONE)return o7.failure(vae.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(a===i)return o7.failure(vae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return o7.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=M7.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return r7.failure(vae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return r7.failure(vae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?r7.failure(vae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?r7.failure(tte.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=M7.NONE,n[a.y][a.x]=r,r7.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=M7.NONE),++a>=n.movedPieces)return r7.failure(vae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return r7.success(t)}}]),n}(mte),gae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return U7.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new rte(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new qee(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[Hee.UP_LEFT,Hee.UP,Hee.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=M7.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new qee(u,s);if(o.getPieceAt(c)===n){var l,f=Gg(Hee.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new hae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new hae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return pae.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(nte),yae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=gae.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return U7.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new rte(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new qee(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===N7.ZERO?(o=12-n,s=[Hee.UP_LEFT,Hee.UP,Hee.UP_RIGHT]):(o=n+1,s=[Hee.DOWN_LEFT,Hee.DOWN,Hee.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Gg(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(nte),mae=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return Wg(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new qee(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new qee(n,11))===N7.ZERO&&(t+=N7.ZERO.getScoreModifier()),e.getPieceAt(new qee(n,0))===N7.ONE&&(t+=N7.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new qee(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new qee(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===M7.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new qee(n,0))===N7.ZERO&&(t+=N7.ZERO.getScoreModifier()),e.getPieceAt(new qee(n,11))===N7.ONE&&(t+=N7.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new qee(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new qee(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=Gg(Hee.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===M7.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===N7.ZERO?n=Math.max(n,d):s===N7.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*N7.ZERO.getScoreModifier()+r*N7.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new rte(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new rte(r+i+a+o+s+u)}}]),n}(gae),kae=M7.NONE,Cae=M7.ZERO,wae=M7.ONE,_ae=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize($r||($r=_g(["Initial board"]))),$localize(Zr||(Zr=_g(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),dae.getInitialState()),_te.informational($localize(qr||(qr=_g(["Goal of the game (1/2)"]))),$localize(Wr||(Wr=_g(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new dae([[kae,kae,kae,kae,kae,Cae,kae,kae,wae,wae,wae,wae,wae,wae],[kae,kae,kae,kae,kae,Cae,kae,kae,kae,kae,kae,kae,wae,wae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,wae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,Cae,Cae,Cae,Cae,kae,kae,kae]],0)),_te.informational($localize(jr||(jr=_g(["Goal of the game (2/2)"]))),$localize(Yr||(Yr=_g(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new dae([[kae,kae,kae,kae,kae,Cae,kae,kae,kae,kae,wae,wae,wae,wae],[kae,kae,kae,kae,kae,Cae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,wae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,wae,wae,kae,kae,kae,Cae,Cae,kae,Cae,Cae,Cae,Cae]],1)),_te.fromPredicate($localize(Kr||(Kr=_g(["Moving a piece"]))),$localize(Qr||(Qr=_g(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),dae.getInitialState(),new hae(0,10,1,1,Hee.UP),function(e,t){return 1===e.movedPieces?o7.SUCCESS:o7.failure($localize(Xr||(Xr=_g(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Jr||(Jr=_g(["This is how you move a single piece."])))),_te.fromPredicate($localize(ei||(ei=_g(["Moving a phalanx"]))),$localize(ti||(ti=_g(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),dae.getInitialState(),new hae(0,11,2,1,Hee.UP),function(e,t){return e.movedPieces>1?o7.SUCCESS:o7.failure($localize(ni||(ni=_g(["Failed! You moved only one piece."]))))},$localize(ri||(ri=_g(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),_te.fromMove($localize(ii||(ii=_g(["Capture"]))),$localize(ai||(ai=_g(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new dae([[kae,kae,kae,kae,kae,kae,kae,kae,wae,wae,wae,wae,wae,wae],[kae,kae,kae,kae,kae,kae,wae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,wae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,wae,kae,wae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,wae,wae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,wae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,Cae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,Cae,kae,kae,kae,kae,wae,kae,kae,kae,kae,kae,kae],[kae,kae,Cae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,Cae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae],[kae,kae,kae,kae,kae,kae,kae,Cae,Cae,Cae,Cae,Cae,Cae,Cae]],0),[new hae(2,10,4,2,Hee.UP)],$localize(oi||(oi=_g(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(si||(si=_g(["Failed, you have not captured the phalanx."]))))]});function bae(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",4),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),tS()}if(2&e){var r=fS().index,i=fS().index,a=fS();XE("ngClass",a.getPieceClasses(r,i)),$E("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function Eae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",2),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),tS(),YE(2,bae,1,4,"circle",3),tS()}if(2&e){var r=t.index,i=fS().index,a=fS();pb(1),vS("id","click_",r,"_",i,""),XE("ngClass",a.getRectClasses(r,i)),$E("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pb(1),XE("ngIf",a.board[i][r]!==a.NONE)}}function Sae(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Eae,3,8,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Pae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",5),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),$E("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Oae=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).NONE=M7.NONE,r.firstPiece=fB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=fB.empty(),r.phalanxDirection=fB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new pae(dae),r.availableMinimaxes=[new gae(r.rules,"Normal"),new yae(r.rules,"Positional"),new mae(r.rules,"Attack")],r.encoder=hae.encoder,r.tutorial=(new _ae).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.firstPiece=fB.empty(),this.lastPiece=fB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=fB.of(new qee(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),o7.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(oB.expectToBe(n.board[t][e],M7.NONE),n.cancelMove(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Gg(Hee.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=Hee.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=Hee.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptyCases()}},{key:"getNeighboringEmptyCases",value:function(){var e,t=[],n=Gg(Hee.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===M7.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=fB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=fB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new qee(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),o7.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(vae.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===M7.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new hae(a.x,a.y,1,1,c)):n.cancelMove(vae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(vae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return oB.expectToBe(n.board[t][e],s),l=new hae(a.x,a.y,u,1,c),f=pae.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.lastPiece=fB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=fB.of(c),o7.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new qee(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(vae.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=Hee.factory.fromMove(o,s).get(),c=Hee.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=fB.of(s),n.lastPiece=fB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(vae.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=fB.of(a),l=n.firstPiece.get().getDistance(a)+1,f=new hae(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),h=pae.getPhalanxValidity(n.rules.node.gameState,f),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),o7.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new hae(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=fB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",o7.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),o7.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=fB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),o7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new qee(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new qee(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new qee(r,n));return e}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-epaminondas"]],features:[RE],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Sae,2,1,"g",1),YE(2,Pae,2,4,"g",1),tS()),2&e&&(pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.getHighlightedCoords()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Tae(e){return new(function(t){Mg(r,t);var n=Dg(r);function r(){return Zg(this,r),n.apply(this,arguments)}return Wg(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?fB.empty():fB.of(e.decode(t))}}]),r}(I7))}var Iae=function(){function e(t){if(Zg(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===hie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=U7.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=fB.empty(),i=Gg(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=fB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return Wg(e,[{key:"toString",value:function(){var e,t="",n=Gg(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return hie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Iae.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return qee.encoder.encode(e)})}},{key:"decode",value:function(e){return new Iae(e.map(function(e){return qee.encoder.decode(e)}))}}]),n}(I7));var Aae=function(){function e(t,n){Zg(this,e),this.coord=t,this.direction=n}return Wg(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Aae.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Tae(Kee.encoder),e}return Wg(n,[{key:"encode",value:function(e){return{coord:qee.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return f7(null!=t.coord,"Invalid encoded GipfPlacement"),new Aae(qee.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(I7));var Rae=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return Wg(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===U7.compareArray(this.initialCaptures,e.initialCaptures)||!1===U7.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(cte);Rae.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={placement:Aae.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Iae.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Iae.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return f7(null!=t.placement,"Invalid encoded GipfMove"),new Rae(Aae.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Iae.encoder.decode),this.decodeArray(t,"finalCapture",Iae.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(A7));var xae=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,r,e,7,7,[3,2,1],Yee.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return Wg(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&U7.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=U7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Yee.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=Yee.EMPTY,t=Yee.UNREACHABLE,r=Yee.ZERO,i=Yee.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(die),Mae=function(){var e=Wg(function e(){Zg(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ui||(ui=_g(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ci||(ci=_g(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(li||(li=_g(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(fi||(fi=_g(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(hi||(hi=_g(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(di||(di=_g(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(vi||(vi=_g(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(pi||(pi=_g(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(gi||(gi=_g(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(yi||(yi=_g(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),Nae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new xae(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==Yee.EMPTY;)o.push(s),s=s.getNext(a);return f7(i.isOnBoard(s)&&i.getPieceAt(s)===Yee.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():r7.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return o7.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return o7.failure(Mae.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?o7.SUCCESS:o7.failure(Mae.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?o7.SUCCESS:o7.failure(Mae.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==Yee.EMPTY){if(t.direction.isAbsent())return o7.failure(Mae.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return o7.failure(Mae.PLACEMENT_ON_COMPLETE_LINE());var i,a=Gg(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return o7.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return o7.failure(Mae.INVALID_PLACEMENT_DIRECTION())}return o7.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return ete.INSTANCE.isOnBorder(e,t)?o7.SUCCESS:o7.failure(Mae.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,N7.ZERO),i=n.getPlayerScore(t,N7.ONE);return r.isAbsent()?yte.ONE_WON:i.isAbsent()?yte.ZERO_WON:yte.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,Yee.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new xae(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return ete.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===Yee.EMPTY?t.push(new Aae(r,fB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Aae(r,fB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===Yee.EMPTY)return fB.of(r);return fB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=Yee.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==Yee.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==Yee.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new xae(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(ete.INSTANCE.isTopLeftCorner(e,t))return[Kee.RIGHT,Kee.DOWN,Kee.UP_RIGHT];if(ete.INSTANCE.isTopCorner(e,t))return[Kee.DOWN,Kee.DOWN_LEFT,Kee.RIGHT];if(ete.INSTANCE.isTopRightCorner(e,t))return[Kee.DOWN_LEFT,Kee.DOWN,Kee.LEFT];if(ete.INSTANCE.isBottomLeftCorner(e,t))return[Kee.UP_RIGHT,Kee.UP,Kee.RIGHT];if(ete.INSTANCE.isBottomCorner(e,t))return[Kee.UP,Kee.LEFT,Kee.UP_RIGHT];if(ete.INSTANCE.isBottomRightCorner(e,t))return[Kee.LEFT,Kee.UP,Kee.DOWN_LEFT];if(ete.INSTANCE.isOnTopLeftBorder(e,t))return[Kee.RIGHT,Kee.DOWN];if(ete.INSTANCE.isOnLeftBorder(e,t))return[Kee.UP_RIGHT,Kee.RIGHT];if(ete.INSTANCE.isOnBottomLeftBorder(e,t))return[Kee.UP,Kee.UP_RIGHT];if(ete.INSTANCE.isOnBottomRightBorder(e,t))return[Kee.LEFT,Kee.UP];if(ete.INSTANCE.isOnRightBorder(e,t))return[Kee.LEFT,Kee.DOWN_LEFT];if(ete.INSTANCE.isOnTopRightBorder(e,t))return[Kee.DOWN_LEFT,Kee.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return fB.of({0:o,1:s,2:a});return fB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==Yee.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==Yee.EMPTY;c=c.getNext(a))n.push(c);return new Iae(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return fB.empty();var i=e.getNumberOfPiecesCaptured(t);return fB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,N7.ZERO),r=n.getPlayerScore(e,N7.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(mte),Dae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=Nae.getPlayerScore(t,N7.ZERO),r=Nae.getPlayerScore(t,N7.ONE);return n.isAbsent()?new rte(N7.ONE.getVictoryValue()):r.isAbsent()?new rte(N7.ZERO.getVictoryValue()):new rte(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return Nae.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=Nae.applyCaptures(r,e);Nae.getPlacements(i).forEach(function(e){var a=Nae.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Rae(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=Nae.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Gg(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(U7.copyImmutableArray(u)):o?(a.push(U7.copyImmutableArray(u)),u.push(n),a.push(U7.copyImmutableArray(u))):(u.push(n),a.push(U7.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(nte),Lae=Wg(function e(t,n,r,i,a,o){Zg(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),Fae=Yee.UNREACHABLE,Uae=Yee.EMPTY,Vae=Yee.ZERO,Bae=Yee.ONE,zae=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(mi||(mi=_g(["Goal of the game"]))),$localize(ki||(ki=_g(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),xae.getInitialState()),_te.anyMove($localize(Ci||(Ci=_g(["Pushing"]))),$localize(wi||(wi=_g(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),xae.getInitialState(),new Rae(new Aae(new qee(3,0),fB.of(Kee.DOWN)),[],[]),$localize(_i||(_i=_g(["Congratulations!"])))),_te.fromMove($localize(bi||(bi=_g(["Capture (1/3)"]))),$localize(Ei||(Ei=_g(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new xae([[Fae,Fae,Fae,Vae,Bae,Uae,Uae],[Fae,Fae,Uae,Uae,Uae,Uae,Uae],[Fae,Uae,Uae,Uae,Uae,Uae,Uae],[Vae,Vae,Vae,Uae,Uae,Uae,Uae],[Bae,Uae,Uae,Uae,Uae,Uae,Fae],[Uae,Uae,Uae,Bae,Uae,Fae,Fae],[Uae,Uae,Uae,Bae,Fae,Fae,Fae]],42,[8,8],[0,0]),[new Rae(new Aae(new qee(0,3),fB.of(Kee.RIGHT)),[],[new Iae([new qee(0,3),new qee(1,3),new qee(2,3),new qee(3,3)])])],$localize(Si||(Si=_g(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(Pi||(Pi=_g(["Failed!"])))),_te.fromMove($localize(Oi||(Oi=_g(["Capture (2/3)"]))),$localize(Ti||(Ti=_g(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new xae([[Fae,Fae,Fae,Uae,Uae,Uae,Uae],[Fae,Fae,Uae,Bae,Uae,Uae,Uae],[Fae,Uae,Uae,Vae,Uae,Uae,Uae],[Vae,Vae,Vae,Bae,Uae,Uae,Uae],[Uae,Uae,Uae,Vae,Uae,Uae,Fae],[Uae,Uae,Uae,Vae,Uae,Fae,Fae],[Uae,Uae,Uae,Bae,Fae,Fae,Fae]],42,[8,4],[2,3]),[new Rae(new Aae(new qee(0,3),fB.of(Kee.RIGHT)),[],[new Iae([new qee(3,1),new qee(3,2),new qee(3,3),new qee(3,4),new qee(3,5),new qee(3,6)])])],$localize(Ii||(Ii=_g(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ai||(Ai=_g(["Failed, the best capture was taking 2 of your opponent's pieces"])))),_te.fromMove($localize(Ri||(Ri=_g(["Capture (3/3)"]))),$localize(xi||(xi=_g(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new xae([[Fae,Fae,Fae,Vae,Uae,Uae,Vae],[Fae,Fae,Uae,Vae,Uae,Uae,Vae],[Fae,Vae,Vae,Uae,Vae,Bae,Vae],[Uae,Uae,Uae,Vae,Uae,Uae,Vae],[Uae,Uae,Uae,Vae,Uae,Uae,Fae],[Vae,Vae,Vae,Bae,Bae,Fae,Fae],[Uae,Uae,Uae,Vae,Fae,Fae,Fae]],42,[8,4],[2,3]),[new Rae(new Aae(new qee(3,6),fB.of(Kee.UP)),[new Iae([new qee(6,0),new qee(6,1),new qee(6,2),new qee(6,3)])],[new Iae([new qee(0,5),new qee(1,5),new qee(2,5),new qee(3,5),new qee(4,5)]),new Iae([new qee(1,2),new qee(2,2),new qee(3,2),new qee(4,2),new qee(5,2)])]),new Rae(new Aae(new qee(4,6),fB.of(Kee.UP)),[new Iae([new qee(6,0),new qee(6,1),new qee(6,2),new qee(6,3)])],[new Iae([new qee(0,5),new qee(1,5),new qee(2,5),new qee(3,5),new qee(4,5)]),new Iae([new qee(3,0),new qee(3,1),new qee(3,2),new qee(3,3),new qee(3,4)])]),new Rae(new Aae(new qee(3,6),fB.of(Kee.UP)),[new Iae([new qee(6,0),new qee(6,1),new qee(6,2),new qee(6,3)])],[new Iae([new qee(1,2),new qee(2,2),new qee(3,2),new qee(4,2),new qee(5,2)]),new Iae([new qee(0,5),new qee(1,5),new qee(2,5),new qee(3,5),new qee(4,5)])])],$localize(Mi||(Mi=_g(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Ni||(Ni=_g(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function Gae(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS().$implicit,r=fS();XE("ngClass",r.getPieceClass(n)),$E("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function Hae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"g",8),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e)}),nS(2,"polyline",9),YE(3,Gae,1,4,"circle",10),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),vS("id","click_",r.x,"_",r.y,""),pb(1),vS("id","case_",r.x,"_",r.y,""),XE("ngClass",i.getSpaceClass(r)),$E("points",i.getHexaCoordsAt(r)),pb(1),XE("ngIf",i.isPiece(r))}}function $ae(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",14),uS("click",function(){var e=Nk(n).$implicit;return fS(2).onClick(e)}),tS()}if(2&e){var r=t.$implicit;$E("points",fS(2).getHexaCoordsAt(r))}}function Zae(e,t){if(1&e&&(cC(),eS(0,"g",12),YE(1,$ae,1,1,"polyline",13),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n.capturedSpaces)}}function qae(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"line",15),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.destination)}),tS(),tS()}if(2&e){var r=t.$implicit;pb(1),$E("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function Wae(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",16),tS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();pb(1),vS("id","piece_",r,"_",n,""),XE("ngClass",i.getSidePieceClass(r)),$E("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function jae(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Wae,2,6,"g",5),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",r.getPlayerSidePieces(n))}}function Yae(e,t){if(1&e&&(cC(),nS(0,"line",17)),2&e){var n=fS();$E("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var Kae=function(){return[0,1]},Qae=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).inserted=fB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=fB.empty(),r.placementEntrance=fB.empty(),r.finalCaptures=[],r.scores=fB.of([0,0]),r.rules=new Nae(xae),r.availableMinimaxes=[new Dae(r.rules,"GipfMinimax")],r.encoder=Rae.encoder,r.tutorial=(new zae).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new Qee(1.5*r.SPACE_SIZE,new qee(2*r.SPACE_SIZE,0),ete.INSTANCE),r}return Wg(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=fB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=fB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new Lae(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(N7.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==Yee.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(oB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(Mae.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(Mae.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=Kee.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Mae.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Mae.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=Nae.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=Nae.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():o7.SUCCESS):(oB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):o7.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,o7.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=Nae.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,o7.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=Nae.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,o7.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Gg(Nae.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===Nae.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new Lae(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=fB.of(e),t.constructedState.getPieceAt(e)===Yee.EMPTY?t.selectPlacementDirection(fB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Mae.NO_DIRECTIONS_AVAILABLE()),o7.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=fB.of(new Aae(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=Nae.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Rae(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=fB.empty(),this.placement=fB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(N7.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(N7.of(e))}}]),n}(jee);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-gipf"]],features:[RE],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"defs"),eS(2,"marker",1),nS(3,"polygon",2),tS(),eS(4,"marker",3),nS(5,"polygon",4),tS(),tS(),YE(6,Hae,4,7,"g",5),YE(7,Zae,2,1,"g",6),YE(8,qae,2,4,"g",5),YE(9,jae,2,1,"g",5),YE(10,Yae,1,4,"line",7),tS()),2&e&&(pb(6),XE("ngForOf",t.getAllCoords()),pb(1),XE("ngForOf",t.possibleCaptures),pb(1),XE("ngForOf",t.arrows),pb(1),XE("ngForOf",aT(5,Kae)),pb(1),XE("ngIf",t.inserted.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Xae=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(lte);Xae.PASS=new Xae(-1,0),Xae.ACCEPT=new Xae(-2,0),Xae.PASS_NUMBER=-1,Xae.ACCEPT_NUMBER=-2,Xae.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===Xae.PASS_NUMBER)return Xae.PASS;var t=e%19;return new Xae(t,(e-t)/19)}}]),n}(R7));var Jae=function(){function e(t,n){Zg(this,e),this.player=t,this.type=n}return Wg(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return f7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return f7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===N7.ZERO?e.DARK:e.LIGHT}}]),e}();Jae.DARK=new Jae(N7.ZERO,"alive"),Jae.LIGHT=new Jae(N7.ONE,"alive"),Jae.EMPTY=new Jae(M7.NONE,"empty"),Jae.DEAD_DARK=new Jae(N7.ZERO,"dead"),Jae.DEAD_LIGHT=new Jae(N7.ONE,"dead"),Jae.DARK_TERRITORY=new Jae(M7.NONE,"territory"),Jae.LIGHT_TERRITORY=new Jae(M7.NONE,"territory");var eoe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(eoe||(eoe={})),eoe),toe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return Wg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,fB.empty(),eoe.PLAYING)}},{key:"getStartingBoard",value:function(){return U7.createTable(n.WIDTH,n.HEIGHT,Jae.EMPTY)}}]),n}(ste);return e.WIDTH=13,e.HEIGHT=13,e}(),noe=function(){var e=function(){function e(t){Zg(this,e),this.color=t}return Wg(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),roe=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return Wg(n,[{key:"getCoords",value:function(){return this.color===Jae.DARK?this.darkCoords:this.color===Jae.LIGHT?this.lightCoords:this.color===Jae.DEAD_DARK?this.deadDarkCoords:this.color===Jae.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(f7(!1===this.contains(e),"This group already contains "+e.toString()),t){case Jae.DARK:this.darkCoords=noe.insertAsEntryPoint(this.darkCoords,e);break;case Jae.LIGHT:this.lightCoords=noe.insertAsEntryPoint(this.lightCoords,e);break;case Jae.DEAD_DARK:this.deadDarkCoords=noe.insertAsEntryPoint(this.deadDarkCoords,e);break;case Jae.DEAD_LIGHT:this.deadLightCoords=noe.insertAsEntryPoint(this.deadLightCoords,e);break;default:oB.expectToBeMultiple(t,[Jae.EMPTY,Jae.DARK_TERRITORY,Jae.LIGHT_TERRITORY]),this.emptyCoords=noe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new dte;e.set(Jae.EMPTY,this.emptyCoords.length),e.set(Jae.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Jae.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==Jae.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Jae.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Jae.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Jae.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Jae.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(noe),ioe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getNewInstance",value:function(e){return new roe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return $ee.ORTHOGONALS}}]),n}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"getGroupDatas",value:function(e,t){sB(noe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){sB(noe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Gg(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),aoe=function(){var e=Wg(function e(){Zg(this,e)});return e.ILLEGAL_KO=function(){return $localize(Di||(Di=_g(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Li||(Li=_g(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Fi||(Fi=_g(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Ui||(Ui=_g(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Vi||(Vi=_g(["You cannot commit suicide."])))},e}(),ooe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return sB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(sB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(sB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===eoe.PLAYING,a=t.phase===eoe.PASSED;return sB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?r7.success([]):r7.failure(aoe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===eoe.ACCEPT;return t.phase===eoe.COUNTING||o?r7.success([]):r7.failure(aoe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(sB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?r7.success([]):r7.failure(aoe.OCCUPIED_INTERSECTION())):(sB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new ioe).getGroupDatas(i,t),s=o.emptyCoords,u=Jae.pieceBelongTo(a,N7.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return fB.of(r)}return fB.empty()}},{key:"markTerritoryAndCount",value:function(e){sB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Gg(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===Jae.LIGHT){a[1]+=s.emptyCoords.length;var c,l=Gg(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=Jae.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{f7(u===Jae.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=Gg(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=Jae.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new toe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===Jae.DARK_TERRITORY?(n[i][a]=Jae.EMPTY,r[0]=r[0]-1):t===Jae.LIGHT_TERRITORY&&(n[i][a]=Jae.EMPTY,r[1]=r[1]-1);return new toe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new ioe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new qee(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===Jae.DEAD_DARK?r++:t===Jae.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();f7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new ioe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case Jae.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=Gg(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=Jae.DARK}}catch(y){o.e(y)}finally{o.f()}break;case Jae.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=Gg(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=Jae.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case Jae.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=Gg(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=Jae.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:oB.expectToBe(r.color,Jae.DARK),i[1]+=2*r.darkCoords.length;var v,p=Gg(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=Jae.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new toe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===eoe.FINISHED?t.captured[0]>t.captured[1]?yte.ZERO_WON:t.captured[1]>t.captured[0]?yte.ONE_WON:yte.DRAW:yte.ONGOING}},{key:"isPass",value:function(e){return e.equals(Xae.PASS)}},{key:"isAccept",value:function(e){return e.equals(Xae.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===eoe.COUNTING||t.phase===eoe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return r7.failure(aoe.ILLEGAL_KO());[eoe.COUNTING,eoe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(soe.isCapturing(i))return r7.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?Jae.DARK:Jae.LIGHT;var a=0===(new ioe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=Jae.EMPTY,a?r7.failure(aoe.CANNOT_COMMIT_SUICIDE()):r7.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){sB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new soe,o=Gg($ee.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?Jae.LIGHT:Jae.DARK)){sB(n.VERBOSE||!1,"a group could be captured");var o=(new ioe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return sB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===eoe.PASSED?(t=eoe.COUNTING,r=new toe(i,a,o+1,fB.empty(),t),r=n.markTerritoryAndCount(r)):(f7(e.phase===eoe.PLAYING,"Cannot pass in counting phase!"),t=eoe.PASSED,r=new toe(i,a,o+1,fB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===eoe.COUNTING?eoe.ACCEPT:eoe.FINISHED,new toe(n,e.getCapturedCopy(),e.turn+1,fB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;sB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[eoe.COUNTING,eoe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=Jae.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=Gg(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=Jae.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new toe(s,p,l,v,eoe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new qee(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){sB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new toe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,fB.empty(),eoe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(mte);return e.VERBOSE=!1,e}(),soe=function(){function e(){Zg(this,e),this.capturedCoords=[]}return Wg(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),uoe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){sB(ooe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===eoe.PLAYING||t.phase===eoe.PASSED)return n.push(Xae.PASS),n;sB(ooe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[Xae.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new Xae(i,r),e.getPieceAt(t.coord)===Jae.EMPTY&&ooe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Gg(ooe.getGroupsDatasWhere(r,function(e){return e!==Jae.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new Xae(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===Jae.DARK?Jae.DEAD_DARK:e===Jae.LIGHT?Jae.DEAD_LIGHT:e.isTerritory()?Jae.EMPTY:e}),n=new toe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=ooe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=ooe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=ooe.getGameStatus(e);if(n.isEndGame)return new rte(n.toBoardValue());sB(ooe.VERBOSE||!1,"GoRules.getBoardValue");var r=ooe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new rte(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(nte),coe=Jae.LIGHT,loe=Jae.DARK,foe=Jae.DEAD_LIGHT,hoe=Jae.LIGHT_TERRITORY,doe=Jae.DARK_TERRITORY,voe=Jae.EMPTY,poe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Bi||(Bi=_g(["Preliminary information"]))),$localize(zi||(zi=_g(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),toe.getInitialState()),_te.informational($localize(Gi||(Gi=_g(["Goal of the game"]))),$localize(Hi||(Hi=_g(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new toe([[voe,loe,voe,voe,coe,coe],[voe,loe,voe,voe,coe,voe],[voe,loe,loe,coe,coe,voe],[voe,voe,loe,coe,voe,voe],[voe,voe,loe,coe,voe,voe],[voe,voe,loe,coe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING)),_te.fromMove($localize($i||($i=_g(["Simple capture"]))),$localize(Zi||(Zi=_g(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new toe([[voe,voe,voe,voe,voe],[voe,voe,loe,voe,voe],[voe,loe,coe,voe,voe],[voe,voe,loe,voe,voe],[voe,voe,voe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING),[new Xae(3,2)],$localize(qi||(qi=_g(["Congratulations, you have earned one point."]))),$localize(Wi||(Wi=_g(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),_te.fromMove($localize(ji||(ji=_g(["Capturing multiple stones"]))),$localize(Yi||(Yi=_g(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new toe([[voe,loe,voe,voe,voe],[loe,coe,voe,voe,voe],[loe,coe,coe,loe,voe],[voe,loe,loe,voe,voe],[voe,voe,voe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING),[new Xae(2,1)],$localize(Ki||(Ki=_g(["Congratulations, you have earned three points and formed a territory."]))),$localize(Qi||(Qi=_g(["Failed, you have not captured the group. Play on the last liberty of that group."])))),_te.informational($localize(Xi||(Xi=_g(["Suicide"]))),$localize(Ji||(Ji=_g(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new toe([[voe,loe,voe,voe,voe],[loe,voe,voe,voe,voe],[loe,voe,voe,voe,coe],[coe,loe,voe,coe,voe],[voe,coe,voe,coe,loe]],[0,0],0,fB.empty(),eoe.PLAYING)),_te.informational($localize(ea||(ea=_g(["Life and death (death)"]))),$localize(ta||(ta=_g(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new toe([[voe,voe,voe,voe,voe],[loe,loe,loe,voe,voe],[coe,coe,loe,voe,voe],[voe,coe,loe,voe,voe],[coe,coe,loe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING)),_te.informational($localize(na||(na=_g(["Life and death (eyes)"]))),$localize(ra||(ra=_g(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new toe([[voe,loe,coe,voe,voe],[coe,loe,coe,voe,voe],[loe,loe,coe,voe,voe],[coe,loe,coe,voe,voe],[voe,loe,coe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING)),_te.informational($localize(ia||(ia=_g(["Seki"]))),$localize(aa||(aa=_g(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new toe([[voe,coe,loe,voe,coe,loe,voe],[voe,coe,loe,loe,coe,loe,voe],[voe,coe,loe,loe,coe,loe,voe],[voe,coe,loe,loe,coe,loe,voe],[voe,coe,loe,coe,coe,loe,voe],[voe,coe,loe,coe,coe,loe,voe],[voe,coe,loe,voe,coe,loe,voe]],[0,0],0,fB.empty(),eoe.PLAYING)),_te.fromMove($localize(oa||(oa=_g(["Ko"]))),$localize(sa||(sa=_g(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new toe([[voe,voe,voe,voe,voe,voe,voe],[voe,voe,voe,voe,voe,voe,voe],[voe,voe,voe,loe,coe,voe,voe],[voe,voe,loe,coe,voe,coe,voe],[voe,voe,voe,loe,coe,voe,voe],[voe,voe,voe,voe,voe,voe,voe],[voe,voe,voe,voe,voe,voe,voe]],[0,0],0,fB.empty(),eoe.PLAYING),[new Xae(4,3)],$localize(ua||(ua=_g(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(ca||(ca=_g(["Failed!"])))),_te.fromMove($localize(la||(la=_g(["End of the game"]))),$localize(fa||(fa=_g(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new toe([[coe,loe,loe,loe,loe,loe,doe,doe,doe],[coe,coe,coe,coe,loe,loe,loe,doe,doe],[coe,hoe,coe,coe,loe,foe,foe,loe,doe],[loe,coe,coe,coe,coe,loe,doe,doe,doe],[voe,coe,hoe,coe,loe,loe,foe,loe,doe],[coe,hoe,coe,coe,loe,loe,loe,loe,loe],[coe,coe,loe,loe,loe,coe,coe,loe,coe],[loe,loe,loe,coe,coe,coe,hoe,coe,coe],[doe,doe,loe,loe,loe,coe,coe,hoe,hoe]],[0,0],0,fB.empty(),eoe.COUNTING),[new Xae(0,3)],$localize(ha||(ha=_g(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(da||(da=_g(["Failed, try again."]))))]});function goe(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS(2).index,r=fS().index;$E("cx",25+50*n)("cy",25+50*r)("r",22)}}function yoe(e,t){if(1&e){var n=aS();cC(),eS(0,"line",11),uS("click",function(){Nk(n);var e=fS(2).index,t=fS().index;return fS().onClick(e,t)}),tS()}if(2&e){var r=fS(2).index,i=fS().index;$E("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function moe(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",7),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),tS(),YE(2,goe,1,3,"circle",8),YE(3,yoe,1,4,"line",9),tS()}if(2&e){var r=fS().index,i=fS().index,a=fS();pb(1),XE("ngClass",a.getSpaceClass(r,i)),$E("cx",25+50*r)("cy",25+50*i)("r",22),pb(1),XE("ngIf",a.isLastCase(r,i)),pb(1),XE("ngIf",a.isDead(r,i))}}function koe(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",15),uS("click",function(){Nk(n);var e=fS(2).index,t=fS().index;return fS().onClick(e,t)}),tS()}if(2&e){var r=fS(2),i=r.index,a=r.$implicit,o=fS().index,s=fS();$E("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function Coe(e,t){if(1&e){var n=aS();cC(),eS(0,"rect",12),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),tS(),eS(1,"line",13),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),tS(),eS(2,"line",13),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),tS(),YE(3,koe,1,4,"circle",14)}if(2&e){var r=fS().index,i=fS().index,a=fS();vS("id","click_",r,"_",i,""),$E("x",50*r)("y",50*i),pb(1),$E("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),pb(1),$E("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),pb(1),XE("ngIf",a.isTerritory(r,i))}}function woe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,moe,4,6,"g",5),YE(2,Coe,4,13,"ng-template",null,6,xT),tS()),2&e){var n=t.index,r=KE(3),i=fS().index,a=fS();pb(1),XE("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function _oe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,woe,4,2,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function boe(e,t){if(1&e&&(cC(),nS(0,"rect",16)),2&e){var n=fS();$E("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Eoe(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",17),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.x,e.y)}),tS()}if(2&e){var r=t.$implicit;$E("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Soe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).ko=fB.empty(),r.last=fB.empty(),r.captures=[],r.GoPiece=Jae,r.scores=fB.of([0,0]),r.rules=new ooe(toe),r.availableMinimaxes=[new uoe(r.rules,"GoMinimax")],r.encoder=Xae.encoder,r.tutorial=(new poe).tutorial,r.canPass=!0,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=fB.empty(),a=new Xae(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){sB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=fB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==eoe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new qee(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===Jae.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===eoe.PLAYING||n===eoe.PASSED?e.onClick(Xae.PASS.coord.x,Xae.PASS.coord.y):(f7(n===eoe.COUNTING||n===eoe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Xae.ACCEPT.coord.x,Xae.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==Jae.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new qee(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new qee(e,t))}}]),n}(rne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-go"]],features:[RE],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),nS(1,"rect",1),YE(2,_oe,2,1,"g",2),YE(3,boe,1,2,"rect",3),YE(4,Eoe,1,3,"circle",4),tS()),2&e&&($E("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),pb(1),$E("width",50*t.board.length)("height",50*t.board.length),pb(1),XE("ngForOf",t.board),pb(1),XE("ngIf",t.ko.isPresent()),pb(1),XE("ngForOf",t.captures))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Poe=function(){function e(t,n,r){Zg(this,e),this.value=t,this.name=n,this.rgb=r}return Wg(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return oB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Poe.ANY=new Poe(0,"any","#000"),Poe.ORANGE=new Poe(1,"orange","#d67421"),Poe.BLUE=new Poe(2,"blue","#006bac"),Poe.PURPLE=new Poe(3,"purple","#6f3787"),Poe.PINK=new Poe(4,"pink","#d2719e"),Poe.YELLOW=new Poe(5,"yellow","#e2c200"),Poe.RED=new Poe(6,"red","#d23339"),Poe.GREEN=new Poe(7,"green","#009157"),Poe.BROWN=new Poe(8,"brown","#562500");var Ooe=function(){function e(t,n){Zg(this,e),this.player=t,this.color=n}return Wg(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(M7.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Poe.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Poe.ORANGE),BLUE:new e(t,Poe.BLUE),PURPLE:new e(t,Poe.PURPLE),PINK:new e(t,Poe.PINK),YELLOW:new e(t,Poe.YELLOW),RED:new e(t,Poe.RED),GREEN:new e(t,Poe.GREEN),BROWN:new e(t,Poe.BROWN)}}}]),e}();Ooe.EMPTY=new Ooe(M7.NONE,Poe.ANY),Ooe.ZERO=Ooe.createPlayerColors(N7.ZERO),Ooe.ONE=Ooe.createPlayerColors(N7.ONE);var Toe=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=Ooe.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return Ooe.of(N7.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return Ooe.of(N7.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(Ooe.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new qee(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Toe.INITIAL=Toe.getInitialBoard(),Toe.SIZE=8,Toe.COLORS=U7.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Poe.of);var Ioe=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Toe.SIZE,Toe.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Toe.SIZE,Toe.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(dne);Ioe.PASS=new Ioe(new qee(-2,-2),new qee(-3,-3)),Ioe.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Ioe.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Ioe(new qee((e=e/16|0)%16,r),new qee(n,t))}}]),n}(R7));var Aoe=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,U7.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(0,Poe.ANY,fB.empty(),!1,Toe.INITIAL)}}]),n}(ste),Roe=function(){var e=Wg(function e(){Zg(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(va||(va=_g(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(pa||(pa=_g(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(ga||(ga=_g(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(ya||(ya=_g(["You must play with the selected piece."])))},e}(),xoe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"nextCoordToPlay",value:function(e,t){return fB.ofNullable(Toe.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===Ioe.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new Aoe(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,a=e.end,o=t.getCopiedBoard();o[a.y][a.x]=o[i.y][i.x],o[i.y][i.x]=Ooe.EMPTY;var s=Toe.getColorAt(a.x,a.y),u=this.nextCoordToPlay(t,s);return new Aoe(t.turn+1,s,u,!1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return yte.getDefeat(r);var i=Pg(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?yte.ONE_WON:0===a?yte.ZERO_WON:yte.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new qee(0,7),new qee(1,7),new qee(2,7),new qee(3,7),new qee(4,7),new qee(5,7),new qee(6,7),new qee(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Gg(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Toe.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===N7.ONE?[Hee.DOWN,Hee.DOWN_LEFT,Hee.DOWN_RIGHT]:[Hee.UP,Hee.UP_LEFT,Hee.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===N7.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(f7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Ioe.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Gg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Gg(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<Toe.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!Toe.isEmptyAt(e.board,h))break;var d=Ioe.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Toe.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);f7(i!==Ooe.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===N7.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,a=t.colorToPlay;if(e===Ioe.PASS)return this.isLegalPass(t);if(n.isVictory(t))return r7.failure("You should never see this message");var o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE());if(a!==Poe.ANY&&o.color!==a)return r7.failure(Roe.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return r7.failure(tte.MUST_CLICK_ON_EMPTY_SPACE());var s=Hee.factory.fromMove(r,i);if(s.isFailure())return r7.failure(Roe.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return r7.failure(Roe.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return r7.failure(Roe.MOVE_BLOCKED());return r7.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?r7.success(void 0):r7.failure(tte.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Pg(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(mte),Moe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=xoe.getListMovesFromState(e.gameState);return U7.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(xoe.mustPass(t)&&t.alreadyPassed)return new rte(n.getDefeatValue());var r=Pg(xoe.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new rte(7===a?N7.ONE.getVictoryValue():0===i?N7.ZERO.getVictoryValue():a-(7-i))}}]),n}(nte),Noe=Ooe.EMPTY,Doe=Ooe.ZERO.ORANGE,Loe=Ooe.ONE.ORANGE,Foe=Ooe.ZERO.BLUE,Uoe=Ooe.ONE.BLUE,Voe=Ooe.ZERO.PURPLE,Boe=Ooe.ONE.PURPLE,zoe=Ooe.ZERO.PINK,Goe=Ooe.ONE.PINK,Hoe=Ooe.ZERO.YELLOW,$oe=Ooe.ONE.YELLOW,Zoe=Ooe.ZERO.RED,qoe=Ooe.ONE.RED,Woe=Ooe.ZERO.GREEN,joe=Ooe.ONE.GREEN,Yoe=Ooe.ZERO.BROWN,Koe=Ooe.ONE.BROWN,Qoe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(ma||(ma=_g(["Goal of the game"]))),$localize(ka||(ka=_g(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Aoe(5,Poe.ORANGE,fB.empty(),!1,[[Yoe,Uoe,Boe,Goe,$oe,qoe,joe,Koe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Loe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Woe,Zoe,Hoe,zoe,Voe,Foe,Doe]])).withPreviousMove(Ioe.of(new qee(0,7),new qee(0,0))),_te.anyMove($localize(Ca||(Ca=_g(["Initial board and initial move"]))),$localize(wa||(wa=_g(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Aoe.getInitialState(),Ioe.of(new qee(7,7),new qee(3,3)),$localize(_a||(_a=_g(["Perfect! Note that each of your piece has a different color."])))),_te.fromMove($localize(ba||(ba=_g(["Moving"]))),$localize(Ea||(Ea=_g(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Aoe(1,Poe.PINK,fB.of(new qee(3,0)),!1,[[Loe,Uoe,Boe,Goe,$oe,qoe,joe,Koe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Foe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Yoe,Woe,Zoe,Hoe,zoe,Voe,Noe,Doe]]),[Ioe.of(new qee(3,0),new qee(3,6)),Ioe.of(new qee(3,0),new qee(4,1))],$localize(Sa||(Sa=_g(["Congratulations!"]))),$localize(Pa||(Pa=_g(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(Ioe.of(new qee(6,7),new qee(6,5))),_te.informational($localize(Oa||(Oa=_g(["Stuck situation"]))),$localize(Ta||(Ta=_g(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Aoe(1,Poe.PINK,fB.of(new qee(3,6)),!1,[[Loe,Uoe,Boe,Noe,$oe,qoe,joe,Koe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Foe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Goe,Noe,Noe,Noe,Noe],[Yoe,Woe,Zoe,Hoe,zoe,Voe,Noe,Doe]])).withPreviousMove(Ioe.of(new qee(6,5),new qee(7,4))),_te.fromMove($localize(Ia||(Ia=_g(["Victory by blocking"]))),$localize(Aa||(Aa=_g(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Aoe(2,Poe.RED,fB.of(new qee(2,4)),!1,[[Noe,Uoe,Boe,Noe,Noe,qoe,Noe,Noe],[Noe,Noe,Noe,$oe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Goe,Noe,Boe,Noe,Noe],[Noe,Noe,Noe,Hoe,Noe,Noe,Noe,Noe],[Noe,Noe,Zoe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,joe,Noe],[Loe,Noe,Noe,Noe,Noe,zoe,Noe,Koe],[Yoe,Woe,Noe,Noe,Noe,Noe,Foe,Doe]]),[Ioe.of(new qee(2,4),new qee(0,2))],$localize(Ra||(Ra=_g(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(xa||(xa=_g(["Failed!"])))).withPreviousMove(Ioe.of(new qee(4,0),new qee(3,1)))]});function Xoe(e,t){if(1&e&&(cC(),nS(0,"circle",8)),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().index,o=fS();$E("cx",o.SPACE_SIZE/2+r*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("fill",o.pieceColor(i))("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Joe(e,t){if(1&e&&(cC(),nS(0,"rect",9)),2&e){var n=fS(),r=n.$implicit,i=n.index,a=fS().index,o=fS();XE("ngClass",o.piecePlayerClass(r)),$E("x",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(r)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(r)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function ese(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"g",4),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(2,"rect",5),YE(3,Xoe,1,4,"circle",6),YE(4,Joe,1,7,"rect",7),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","click_",i,"_",a,""),pb(1),$E("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),pb(1),XE("ngIf",r!==o.UNOCCUPIED),pb(1),XE("ngIf",r!==o.UNOCCUPIED)}}function tse(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,ese,5,9,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function nse(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"rect",10),nS(2,"rect",10),tS()),2&e){var n=fS();pb(1),$E("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),pb(1),$E("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function rse(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS();$E("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var ise=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).UNOCCUPIED=Ooe.EMPTY,r.lastMove=fB.empty(),r.chosen=fB.empty(),r.chosenAutomatically=!1,r.rules=new xoe(Aoe),r.availableMinimaxes=[new Moe(r.rules,"KamisadoMinimax")],r.encoder=Ioe.encoder,r.tutorial=(new Qoe).tutorial,r.canPass=!1,r.updateBoard(),r}return Wg(n,[{key:"backgroundColor",value:function(e,t){return Toe.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===N7.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=xoe.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=fB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(f7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Ioe.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new qee(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(tte.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),o7.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Roe.PLAY_WITH_SELECTED_PIECE()):(n.chosen=fB.of(a),o7.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=fB.of(new qee(e,t)),o7.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new qee(e,t),o=Ioe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=fB.empty())}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-kamisado"]],features:[RE],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,tse,2,1,"g",1),YE(2,nse,3,8,"g",2),YE(3,rse,1,2,"circle",3),tS()),2&e&&($E("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),pb(1),XE("ngForOf",t.board),pb(1),XE("ngIf",t.lastMove.isPresent()),pb(1),XE("ngIf",t.chosen.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ase=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){var e=M7.NONE,t=M7.ZERO,r=M7.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(ste);return e.SIZE=8,e}(),ose=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).direction=i,a.direction=Hee.factory.fromMove(e,r).get(),a}return Wg(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=Hee.factory.fromMove(e,t);return r.isFailure()?r7.failure(r.getReason()):e.isNotInRange(ase.SIZE,ase.SIZE)?r7.failure("start coord is not in range"):t.isNotInRange(ase.SIZE,ase.SIZE)?r7.failure("end coord is not in range"):r7.success(new n(e,t,r.get()))}}]),n}(dne);ose.encoder=dne.getEncoder(ase.SIZE,ase.SIZE,function(e,t){return ose.of(e,t).get()});var sse=function(){var e=Wg(function e(){Zg(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Ma||(Ma=_g(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Na||(Na=_g(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Da||(Da=_g(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(La||(La=_g(["A move must be orthogonal or diagonal."])))},e}(),use=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=M7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new ase(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Pg(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?yte.ZERO_WON:i>1&&1===a?yte.ONE_WON:yte.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<ase.SIZE;r++)for(var i=0;i<ase.SIZE;i++){var a=new qee(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=Gg(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=ose.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=U7.createTable(ase.SIZE,ase.SIZE,-1),r=[0,0],i=0,a=0;a<ase.SIZE;a++)for(var o=0;o<ase.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new qee(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new qee(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=oB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Gg(Hee.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===M7.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?r7.failure(sse.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?r7.failure(sse.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?r7.failure(tte.CANNOT_SELF_CAPTURE()):r7.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Gg(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];ase.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case Hee.UP:case Hee.DOWN:return[new qee(e.x,0),Hee.DOWN];case Hee.LEFT:case Hee.RIGHT:return[new qee(0,e.y),Hee.RIGHT];case Hee.UP_RIGHT:case Hee.DOWN_LEFT:return[new qee(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Hee.UP_RIGHT];default:return oB.expectToBeMultiple(t,[Hee.UP_LEFT,Hee.DOWN_RIGHT]),[new qee(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Hee.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Pg(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?fB.of(M7.NONE):1===r?fB.of(N7.ZERO):1===i?fB.of(N7.ONE):fB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Gg(Hee.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=ose.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(mte),cse=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return use.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Pg(use.getNumberOfGroups(t),2),r=n[0],i=n[1];return new rte(1===r&&i>1?N7.ZERO.getVictoryValue():r>1&&1===i?N7.ONE.getVictoryValue():100/r*N7.ZERO.getScoreModifier()+100/i*N7.ONE.getScoreModifier())}}]),n}(nte),lse=M7.NONE,fse=M7.ZERO,hse=M7.ONE,dse=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Fa||(Fa=_g(["Goal of the game"]))),$localize(Ua||(Ua=_g(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new ase([[lse,lse,lse,lse,lse,lse,lse,lse],[hse,lse,lse,lse,fse,lse,lse,hse],[lse,lse,fse,fse,hse,lse,lse,lse],[lse,lse,lse,fse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse]],0)),_te.anyMove($localize(Va||(Va=_g(["Initial board and initial move"]))),$localize(Ba||(Ba=_g(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),ase.getInitialState(),ose.of(new qee(1,7),new qee(1,5)).get(),$localize(za||(za=_g(["Congratulations!"])))),_te.fromMove($localize(Ga||(Ga=_g(["Jumping"]))),$localize(Ha||(Ha=_g(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new ase([[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,hse,fse,fse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,lse,lse,fse]],0),[ose.of(new qee(3,1),new qee(6,1)).get()],$localize($a||($a=_g(["Congratulations!"]))),$localize(Za||(Za=_g(["Failed. You did not jump over one of your pieces."])))),_te.fromMove($localize(qa||(qa=_g(["Moving"]))),$localize(Wa||(Wa=_g(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new ase([[lse,lse,lse,lse,lse,lse,hse,lse],[lse,lse,lse,lse,lse,fse,lse,lse],[lse,lse,lse,lse,hse,lse,lse,lse],[lse,lse,lse,fse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,hse,lse,hse],[lse,lse,lse,fse,lse,lse,hse,hse],[lse,lse,lse,fse,lse,lse,lse,lse]],0),[ose.of(new qee(3,3),new qee(3,0)).get(),ose.of(new qee(3,3),new qee(0,0)).get(),ose.of(new qee(3,3),new qee(2,3)).get(),ose.of(new qee(3,3),new qee(4,3)).get()],$localize(ja||(ja=_g(["Congratulations!"]))),$localize(Ya||(Ya=_g(["Failed. This was not one of the expected moves."])))),_te.fromMove($localize(Ka||(Ka=_g(["Capturing"]))),$localize(Qa||(Qa=_g(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new ase([[lse,fse,lse,fse,fse,fse,fse,lse],[hse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,fse,lse,hse,lse,lse,lse],[hse,lse,lse,lse,lse,lse,lse,hse],[hse,lse,lse,lse,lse,lse,lse,hse],[hse,lse,lse,lse,lse,lse,lse,hse],[hse,lse,lse,lse,lse,lse,lse,hse],[lse,fse,fse,fse,fse,fse,fse,lse]],0),[ose.of(new qee(2,2),new qee(4,2)).get()],$localize(Xa||(Xa=_g(["Congratulations!"]))),$localize(Ja||(Ja=_g(["Failed!"])))),_te.fromMove($localize(eo||(eo=_g(["Tie"]))),$localize(to||(to=_g(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new ase([[lse,lse,lse,lse,lse,lse,lse,lse],[lse,lse,lse,lse,lse,lse,lse,lse],[fse,lse,lse,fse,hse,fse,lse,lse],[lse,lse,lse,fse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,lse,lse,hse],[lse,lse,lse,lse,lse,lse,lse,lse]],0),[ose.of(new qee(0,2),new qee(4,2)).get()],$localize(no||(no=_g(["Congratulations!"]))),$localize(ro||(ro=_g(["Failed!"]))))]});function vse(e,t){if(1&e&&(cC(),nS(0,"circle",3)),2&e){var n=fS().index,r=fS().index,i=fS();XE("ngClass",i.getPieceClasses(n,r)),$E("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function pse(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"g",2),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(2,"rect",3),YE(3,vse,1,4,"circle",4),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","click_",i,"_",a,""),pb(1),XE("ngClass",o.getSquareClasses(i,a)),$E("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r!==o.EMPTY)}}function gse(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,pse,4,8,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function yse(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",5),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),$E("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var mse=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=M7.NONE,r.targets=[],r.selected=fB.empty(),r.lastMove=fB.empty(),r.captured=fB.empty(),r.rules=new use(ase),r.availableMinimaxes=[new cse(r.rules,"LinesOfActionMinimax")],r.encoder=ose.encoder,r.tutorial=(new dse).tutorial,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new qee(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=ose.of(n.selected.get(),new qee(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(sse.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=fB.of(e),t.targets=use.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(sse.PIECE_CANNOT_MOVE()):o7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?fB.of(e.end):fB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new qee(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-linesofaction"]],features:[RE],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,gse,2,1,"g",1),YE(2,yse,2,4,"g",1),tS()),2&e&&(pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.targets))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kse=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return Zg(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return Wg(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(lte);kse.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){return{coord:qee.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return f7(null!=t.coord,"Invalid encoded LodestoneMove"),f7(null!=t.direction,"Invalid encoded LodestoneMove"),f7(null!=t.orientation,"Invalid encoded LodestoneMove"),f7(null!=t.captures,"Invalid encoded LodestoneMove"),new kse(qee.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(A7));var Cse=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(io||(io=_g(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(ao||(ao=_g(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(oo||(oo=_g(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(so||(so=_g(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(uo||(uo=_g(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(co||(co=_g(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),wse=function(){function e(t){Zg(this,e),this.unreachable=t}return Wg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();wse.UNREACHABLE=new wse(!0),wse.EMPTY=new wse(!1);var _se=function(){function e(t){Zg(this,e),this.owner=t}return Wg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===N7.ZERO?e.ZERO:e.ONE}}]),e}();_se.ZERO=new _se(N7.ZERO),_se.ONE=new _se(N7.ONE);var bse=function(){function e(t,n,r){Zg(this,e),this.owner=t,this.direction=n,this.orientation=r}return Wg(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();bse.LODESTONES={0:{push:{diagonal:new bse(N7.ZERO,"push","diagonal"),orthogonal:new bse(N7.ZERO,"push","orthogonal")},pull:{diagonal:new bse(N7.ZERO,"pull","diagonal"),orthogonal:new bse(N7.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new bse(N7.ONE,"push","diagonal"),orthogonal:new bse(N7.ONE,"push","orthogonal")},pull:{diagonal:new bse(N7.ONE,"pull","diagonal"),orthogonal:new bse(N7.ONE,"pull","orthogonal")}}};var Ese=function(){function e(t,n){Zg(this,e),this.width=t,this.pieces=n}return Wg(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(f7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),fB.empty());for(var r=U7.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(_se.of(t));return fB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:wse.EMPTY}}]),e}();Ese.POSITIONS=["top","bottom","left","right"],Ese.EMPTY_5=new Ese(5,[]),Ese.EMPTY_3=new Ese(3,[]);var Sse=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return Wg(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=Gg(Ese.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return fB.empty();var n=this.getPieceAt(t.get());switch(f7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return fB.of("pull");case"pull":return fB.of("push")}}}],[{key:"getInitialState",value:function(){var e=wse.EMPTY,t=_se.ZERO,r=_se.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new dte,{top:fB.of(Ese.EMPTY_5),bottom:fB.of(Ese.EMPTY_5),left:fB.of(Ese.EMPTY_5),right:fB.of(Ese.EMPTY_5)})}}]),n}(ste);return e.SIZE=8,e}(),Pse=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Sse)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=U7.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=Eg({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new Sse(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=Gg(Ese.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(Sse.SIZE,Sse.SIZE);i=i.getNext(n)){var a,o=Gg(N7.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=wse.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return r7.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return r7.failure(Cse.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=Gg(Ese.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return r7.failure(Cse.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return r7.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=U7.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=wse.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=bse.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=Gg("diagonal"===r?Hee.DIAGONALS:Hee.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=wse.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=wse.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=Gg("diagonal"===r?Hee.DIAGONALS:Hee.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,Sse.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=wse.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=wse.EMPTY)}else o.push(l),t[l.y][l.x]=wse.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?o7.failure(Cse.MUST_FLIP_LODESTONE()):o7.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return o7.failure(Cse.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return o7.failure(tte.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?o7.failure(tte.MUST_CLICK_ON_EMPTY_SQUARE()):o7.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?yte.DRAW:0===t[0]?yte.ONE_WON:0===t[1]?yte.ZERO_WON:yte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(mte);Pse.THREATENED_COORD_RANGE=dte.from({top:{startForBigPlate:new qee(0,0),startForSmallPlate:new qee(0,1),direction:Hee.RIGHT},bottom:{startForBigPlate:new qee(0,Sse.SIZE-1),startForSmallPlate:new qee(0,Sse.SIZE-2),direction:Hee.RIGHT},left:{startForBigPlate:new qee(0,0),startForSmallPlate:new qee(1,0),direction:Hee.DOWN},right:{startForBigPlate:new qee(Sse.SIZE-1,0),startForSmallPlate:new qee(Sse.SIZE-2,0),direction:Hee.DOWN}}),Pse.singleton=fB.empty();var Ose=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=Gg(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=Pse.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=Gg(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new kse(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new ate([{top:0,bottom:0,left:0,right:0}]);var n,r=new ate,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=Gg(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(Eg(Eg({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(Eg(Eg({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(Eg(Eg({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(Eg(Eg({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<Sse.SIZE;r++)for(var i=0;i<Sse.SIZE;i++){var a=new qee(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?N7.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?N7.ONE.getVictoryValue():n[0]*N7.ZERO.getScoreModifier()+n[1]*N7.ONE.getScoreModifier(),new rte(t)}}]),n}(nte),Tse=wse.UNREACHABLE,Ise=wse.EMPTY,Ase=_se.ZERO,Rse=_se.ONE,xse=bse.of(N7.ONE,{direction:"push",orientation:"orthogonal"}),Mse={top:fB.of(Ese.EMPTY_5),bottom:fB.of(Ese.EMPTY_5),left:fB.of(Ese.EMPTY_5),right:fB.of(Ese.EMPTY_5)},Nse=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(lo||(lo=_g(["Board and aim of the game"]))),$localize(fo||(fo=_g(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),Sse.getInitialState()),_te.forClick($localize(ho||(ho=_g(["Selecting a lodestone"]))),$localize(vo||(vo=_g(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),Sse.getInitialState(),["#lodestone_push_diagonal"],$localize(po||(po=_g(["Congratulations!"]))),$localize(go||(go=_g(["This is not the right lodestone, try again."])))),_te.informational($localize(yo||(yo=_g(["The repelling lodestone"]))),$localize(mo||(mo=_g(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),Sse.getInitialState()),_te.informational($localize(ko||(ko=_g(["The attracting lodestone"]))),$localize(Co||(Co=_g(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),Sse.getInitialState()),_te.informational($localize(wo||(wo=_g(["Flipping the lodestone"]))),$localize(_o||(_o=_g(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),Sse.getInitialState()),_te.fromPredicate($localize(bo||(bo=_g(["Capturing"]))),$localize(Eo||(Eo=_g(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),Sse.getInitialState(),new kse(new qee(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t){return 32===t.remainingSpaces()?o7.failure($localize(So||(So=_g(["You have not captured any of the opponent's pieces, try again!"])))):o7.SUCCESS},"Congratulations!"),_te.fromPredicate($localize(Po||(Po=_g(["Crumbling a first pressure plate"]))),$localize(Oo||(Oo=_g(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new Sse([[Ise,Ise,Ise,Ise,Rse,Ise,Ise,Ise],[Ise,Ise,Ase,Ise,Ise,Rse,Ise,Ise],[Ise,Ise,xse,Ise,Ise,Ise,Ise,Ase],[Ise,Ise,Ise,Ise,Rse,Ise,Ise,Ase],[Ise,Ise,Ise,Ise,Ise,Ase,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise]],0,new dte([{key:N7.ONE,value:new qee(2,2)}]),Eg(Eg({},Mse),{},{top:Ese.EMPTY_5.addCaptured(N7.ONE,4)})),new kse(new qee(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t){return 5===t.pressurePlates.top.get().width?o7.failure($localize(To||(To=_g(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):o7.SUCCESS},"Congratulations!"),_te.fromPredicate($localize(Io||(Io=_g(["Crumbling a second pressure plate"]))),$localize(Ao||(Ao=_g(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new Sse([[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ase],[Ise,Ise,Ise,Ise,Ise,Ase,Ise,Ase],[Ise,xse,Ise,Ise,Rse,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Rse,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise]],0,new dte([{key:N7.ONE,value:new qee(1,4)}]),Eg(Eg({},Mse),{},{top:Ese.EMPTY_3.addCaptured(N7.ONE,2)})),new kse(new qee(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t){return t.pressurePlates.top.isPresent()?o7.failure($localize(Ro||(Ro=_g(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):o7.SUCCESS},"Congratulations!"),_te.informational($localize(xo||(xo=_g(["Minimal board"]))),$localize(Mo||(Mo=_g(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new Sse([[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Tse,Tse,Ase,Rse,Ise,Ise,Tse,Tse],[Tse,Tse,xse,Rse,Ise,Ise,Tse,Tse],[Tse,Tse,Ise,Ase,Ase,Ise,Tse,Tse],[Tse,Tse,Ase,Ise,Ise,Ise,Tse,Tse],[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse]],0,new dte([{key:N7.ONE,value:new qee(2,3)}]),{top:fB.empty(),bottom:fB.empty(),left:fB.empty(),right:fB.empty()})),_te.fromMove($localize(No||(No=_g(["Making the lodestone fall"]))),$localize(Do||(Do=_g(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new Sse([[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Rse,Ise,Ise],[Ise,Ise,Ise,xse,Ise,Ise,Ase,Ise],[Ise,Ise,Ase,Ase,Rse,Ise,Ise,Ase],[Ise,Ise,Ise,Ise,Ise,Ase,Ise,Ise],[Ise,Ise,Ase,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Rse,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise]],0,new dte([{key:N7.ONE,value:new qee(3,2)}]),Eg(Eg({},Mse),{},{top:Ese.EMPTY_5.addCaptured(N7.ONE,4)})),[new kse(new qee(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(Lo||(Lo=_g(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(Fo||(Fo=_g(["Failed, try again."])))),_te.fromMove($localize(Uo||(Uo=_g(["End of the game"]))),$localize(Vo||(Vo=_g(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new Sse([[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse],[Tse,Rse,Ase,Rse,Ise,Ise,Tse,Tse],[Tse,Rse,xse,Ise,Rse,Ise,Tse,Tse],[Tse,Ise,Ise,Ase,Ase,Ise,Tse,Tse],[Tse,Rse,Ase,Ise,Rse,Ise,Tse,Tse],[Tse,Ise,Ise,Ise,Ase,Ise,Tse,Tse],[Tse,Tse,Tse,Tse,Tse,Tse,Tse,Tse]],0,new dte([{key:N7.ONE,value:new qee(2,3)}]),{top:fB.empty(),bottom:Ese.EMPTY_3.addCaptured(N7.ZERO,2),left:fB.of(Ese.EMPTY_3),right:fB.empty()}),[new kse(new qee(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(Bo||(Bo=_g(["Congratulations, you won!"]))),$localize(zo||(zo=_g(["This is not the winning move. Try again."]))))]});function Dse(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();vS("id","piece_",r,"_",a,""),XE("ngClass",i.pieceClasses),$E("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Lse(e,t){if(1&e&&(cC(),nS(0,"polygon",15)),2&e){var n=fS().$implicit,r=fS(3).$implicit,i=fS(2);jE("transform","rotate(",90*n,")"),XE("ngClass",r.lodestone.movingClass),$E("points",i.TRIANGLE_OUT)}}function Fse(e,t){if(1&e&&(cC(),nS(0,"polygon",15)),2&e){var n=fS().$implicit,r=fS(3).$implicit,i=fS(2);jE("transform","rotate(",90*n,")"),XE("ngClass",r.lodestone.movingClass),$E("points",i.TRIANGLE_IN)}}function Use(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Lse,1,3,"polygon",14),YE(2,Fse,1,3,"polygon",14),tS()),2&e){var n=fS(3).$implicit;pb(1),XE("ngIf","push"===n.lodestone.direction),pb(1),XE("ngIf","pull"===n.lodestone.direction)}}var Vse=function(){return[0,1,2,3]};function Bse(e,t){if(1&e&&(cC(),eS(0,"g",11),nS(1,"circle",12),nS(2,"circle",13),eS(3,"g"),YE(4,Use,3,2,"g",1),tS(),tS()),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();$E("transform",o.getSquareTransform(r,a)),pb(1),XE("ngClass",i.lodestone.selectedClass),$E("r",o.PIECE_RADIUS),pb(1),XE("ngClass",i.lodestone.pieceClasses),$E("r",o.PIECE_RADIUS/4),pb(1),jE("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),pb(1),XE("ngForOf",aT(7,Vse))}}function zse(e,t){if(1&e){var n=aS();cC(),eS(0,"g",6),uS("click",function(){Nk(n);var e=fS().$implicit;return fS(2).selectCoord(e.coord)}),nS(1,"rect",7),YE(2,Dse,1,6,"circle",8),YE(3,Bse,5,8,"g",9),tS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();vS("id","square_",i,"_",o,""),pb(1),XE("ngClass",a.squareClasses),$E("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),pb(1),XE("ngIf",a.hasPiece),pb(1),XE("ngIf",a.lodestone)}}function Gse(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,zse,4,9,"g",5),tS()),2&e){var n=t.$implicit;pb(1),XE("ngIf",!1===n.crumbled)}}function Hse(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Gse,2,1,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function $se(e,t){if(1&e&&(cC(),eS(0,"g",16),nS(1,"circle",17),tS()),2&e){var n=t.$implicit,r=t.index,i=fS();dS("id","capture_",r,""),$E("transform",i.getCaptureTransform(r)),pb(1),XE("ngClass",n.pieceClasses),$E("r",i.PIECE_RADIUS)}}function Zse(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"polygon",15),tS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();pb(1),jE("transform","rotate(",90*n,")"),XE("ngClass",r.movingClass),$E("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function qse(e,t){if(1&e){var n=aS();cC(),eS(0,"g",6),uS("click",function(){var e=Nk(n).$implicit;return fS().selectLodestone(e)}),nS(1,"circle",12),nS(2,"circle",13),eS(3,"g"),YE(4,Zse,2,3,"g",1),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();vS("id","lodestone_",r.direction,"_",r.orientation,""),$E("transform",a.getAvailableLodestoneTransform(i)),pb(1),XE("ngClass",r.selectedClass),$E("r",a.PIECE_RADIUS),pb(1),XE("ngClass",r.pieceClasses),$E("r",a.PIECE_RADIUS/4),pb(1),jE("transform","rotate(","diagonal"===r.orientation?45:0,")"),pb(1),XE("ngForOf",aT(9,Vse))}}function Wse(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().$implicit,o=fS();vS("id","platePiece_",a.position,"_",r,""),XE("ngClass",i.pieceClasses),$E("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function jse(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"g",6),uS("click",function(){var e=Nk(n),t=e.$implicit,r=e.index,i=fS().$implicit;return fS().onPressurePlateClick(t.temporary,i.position,r)}),nS(2,"rect",18),YE(3,Wse,1,6,"circle",8),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().$implicit,o=fS();$E("transform",o.getPressurePlateTransform(a.position)),pb(1),vS("id","plate_",a.position,"_",i,""),pb(1),vS("id","plateSquare_",a.position,"_",i,""),XE("ngClass",r.squareClasses),$E("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r.hasPiece)}}function Yse(e,t){if(1&e&&(cC(),eS(0,"g",16),YE(1,jse,4,11,"g",1),tS()),2&e){var n=t.$implicit;dS("id","pressurePlate_",n.position,""),pb(1),XE("ngForOf",n.coords)}}function Kse(e,t){if(1&e&&(cC(),nS(0,"rect",19)),2&e){var n=fS();vS("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),$E("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var Qse=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;Zg(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:fB.empty(),pressurePlateShift:{top:new Bee(0,0),left:new Bee(0,0),right:new Bee(0,0),bottom:new Bee(0,0)}},r.stateAfterPlacingLodestone=fB.empty(),r.lastInfos=fB.empty(),r.capturesToPlace=0,r.selectedCoord=fB.empty(),r.selectedLodestone=fB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=Pse.get(),r.tutorial=(new Nse).tutorial,r.availableMinimaxes=[new Ose(r.rules,"LodestoneDummyMinimax")],r.encoder=kse.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.rules.node.gameState,r.scores=fB.of([0,0]),r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(Cse.MUST_PLACE_CAPTURES()));case 5:return i=Pse.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedLodestone.isPresent()?(t.selectedCoord=fB.of(e),t.putLodestone()):(t.selectedCoord=fB.of(e),t.updateViewInfo(),o7.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return f7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),n.abrupt("return",(t.selectedLodestone=fB.of(bse.of(i,e)),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),o7.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.selectedCoord.isPresent(),"coord should have been selected"),f7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),f7(Pse.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=Pse.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=fB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=fB.of(e.displayedState),e.updateViewInfo(),o7.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.selectedCoord.isPresent(),"coord should have been selected"),f7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new kse(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(Cse.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=U7.copyBiArray(a.board),u=Eg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Pse.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Sse(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),o7.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=U7.copyBiArray(a.board),u=Eg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Pse.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Sse(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),o7.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=fB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=fB.empty(),this.lastInfos=fB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=U7.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=wse.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=fB.empty(),this.selectedLodestone=fB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<Sse.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<Sse.SIZE;t++){var n=new qee(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:fB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=bse.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=Gg(Ese.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=fB.of(Pse.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=Gg(Ese.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=oB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=Gg(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=Gg(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}}catch(s){n.e(s)}finally{n.f()}var i,a=Gg(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new qee(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new qee(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new qee(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new qee(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(Sse.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(Sse.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(Wee);Qse.PRESSURE_PLATE_EXTRA_SHIFT=.2,Qse.PRESSURE_PLATES_POSITIONS=dte.from({top:{startForBigPlate:new qee(.5,-1-Qse.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new qee(1.5,0-Qse.PRESSURE_PLATE_EXTRA_SHIFT),direction:Hee.RIGHT},bottom:{startForBigPlate:new qee(.5,8+Qse.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new qee(1.5,7+Qse.PRESSURE_PLATE_EXTRA_SHIFT),direction:Hee.RIGHT},left:{startForBigPlate:new qee(-1-Qse.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new qee(0-Qse.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Hee.DOWN},right:{startForBigPlate:new qee(8+Qse.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new qee(7+Qse.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Hee.DOWN}}),Qse.\u0275fac=function(e){return new(e||Qse)(QE(c7))},Qse.\u0275cmp=Hm({type:Qse,selectors:[["app-lodestone"]],features:[RE],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Hse,2,1,"g",1),YE(2,$se,2,4,"g",2),YE(3,qse,5,10,"g",3),YE(4,Yse,2,2,"g",2),YE(5,Kse,1,6,"rect",4),tS()),2&e&&(pb(1),XE("ngForOf",t.viewInfo.boardInfo),pb(1),XE("ngForOf",t.viewInfo.capturesToPlace),pb(1),XE("ngForOf",t.viewInfo.availableLodestones),pb(1),XE("ngForOf",t.viewInfo.pressurePlates),pb(1),XE("ngIf",t.viewInfo.selected.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Xse=function(){var e=Wg(function e(){Zg(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(Go||(Go=_g(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(Ho||(Ho=_g(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize($o||($o=_g(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(Zo||(Zo=_g(["Drones must move one or two steps in any direction."])))},e}(),Jse=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return Wg(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return r7.failure(Xse.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return r7.failure(Xse.END_COORD_OUT_OF_RANGE());if(t.equals(e))return r7.failure(tte.MOVE_CANNOT_BE_STATIC());var i=Hee.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?r7.failure(i.getReason()):r7.success(new n(e,t,r))}}]),n}(dne);Jse.encoder=R7.tuple([qee.numberEncoder(4,8),qee.numberEncoder(4,8),R7.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return Jse.from(e[0],e[1],e[2]).get()});var eue=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){f7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?fB.of(e.from(r)):fB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(oB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();eue.EMPTY=new eue(0),eue.PAWN=new eue(1),eue.DRONE=new eue(2),eue.QUEEN=new eue(3);var tue=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).ruler=e,i}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=Gg(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case eue.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case eue.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case eue.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new qee(t,n),a=[],o=Gg(Hee.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(eue.DRONE),s=!1===e.isTherePieceOnPlayerSide(eue.QUEEN),u=e.lastMove,c=Gg(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===eue.EMPTY)this.add(i,Jse.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=eue.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=Jse.from(t,l).get();(d===eue.DRONE&&o||d===eue.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,Jse.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new qee(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=Gg(Hee.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(eue.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(eue.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new qee(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(N7.ZERO);t=e.gameState.getScoreOf(N7.ONE)-r}return new rte(t)}}]),n}(nte),nue=function(){function e(t){Zg(this,e),this.captures=t,t.makeImmutable()}return Wg(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new dte,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),rue=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fB.empty(),s=arguments.length>4?arguments[4]:void 0;return Zg(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new dte([{key:N7.ZERO,value:nue.from([])},{key:N7.ONE,value:nue.from([])}])),s.makeImmutable(),i.captured=s,i}return Wg(n,[{key:"getPlayerTerritory",value:function(e){return e===N7.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=Gg(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(N7.ZERO)?fB.of(N7.ZERO):this.isTerritoryEmpty(N7.ONE)?fB.of(N7.ONE):fB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=Gg(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==eue.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(N7.fromTurn(e)).get();return[t.captures.get(eue.PAWN).getOrElse(0),t.captures.get(eue.DRONE).getOrElse(0),t.captures.get(eue.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=eue.EMPTY,t=eue.PAWN,r=eue.DRONE,i=eue.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,fB.empty())}}]),n}(ste);rue.PLAYER_ZERO_TERRITORY=new ate([0,1,2,3]),rue.PLAYER_ONE_TERRITORY=new ate([4,5,6,7]);var iue=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(qo||(qo=_g(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(Wo||(Wo=_g(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(jo||(jo=_g(["You cannot perform a move that is the reverse of the previous one."])))},e}(),aue=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=eue.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=fB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new rue(i,t.turn+1,fB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return r7.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return r7.failure(iue.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return r7.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){f7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==eue.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==eue.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return r7.failure(iue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return r7.failure(iue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return r7.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return r7.failure(iue.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===eue.EMPTY)return r7.failure(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===eue.PAWN)return e.isValidForPawn()?r7.success(void 0):r7.failure(Xse.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===eue.DRONE&&!1===e.isValidForDrone())return r7.failure(Xse.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=Gg(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==eue.EMPTY)return r7.failure(tte.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return r7.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return eue.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,yte.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=yte.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return yte.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(N7.ZERO),r=e.getScoreOf(N7.ONE);return n>r?yte.ZERO_WON:r>n?yte.ONE_WON:t}}]),n}(mte);aue.STARTING_COUNT_DOWN=fB.of(7);var oue=function(){var e=Wg(function e(){Zg(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(Yo||(Yo=_g(["Failed, you did not capture any piece."])))},e}(),sue=eue.EMPTY,uue=eue.PAWN,cue=eue.DRONE,lue=eue.QUEEN,fue=function(){return $localize(Ko||(Ko=_g(["This is not a field promotion!"])))},hue=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Qo||(Qo=_g(["Goal of the game"]))),$localize(Xo||(Xo=_g(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),rue.getInitialState()),_te.informational($localize(Jo||(Jo=_g(["The pieces"]))),$localize(es||(es=_g(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),rue.getInitialState()),_te.fromPredicate($localize(ts||(ts=_g(["Moving pawns"]))),$localize(ns||(ns=_g(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),rue.getInitialState(),Jse.from(new qee(1,2),new qee(2,3)).get(),function(e,t){return t.getPieceAt(e.end)===eue.PAWN?o7.SUCCESS:o7.failure($localize(rs||(rs=_g(["This is not a pawn!"]))))},$localize(is||(is=_g(["Congratulations!"])))),_te.fromPredicate($localize(as||(as=_g(["Moving drones"]))),$localize(os||(os=_g(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),rue.getInitialState(),Jse.from(new qee(2,0),new qee(3,0)).get(),function(e,t){return t.getPieceAt(e.end)===eue.DRONE?o7.SUCCESS:o7.failure($localize(ss||(ss=_g(["This is not a drone!"]))))},$localize(us||(us=_g(["Congratulations!"])))),_te.fromPredicate($localize(cs||(cs=_g(["Moving queens"]))),$localize(ls||(ls=_g(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new rue([[cue,uue,sue,sue],[lue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,lue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[lue,cue,uue,sue]],0),Jse.from(new qee(2,3),new qee(2,7)).get(),function(e,t){return t.getPieceAt(e.end)===eue.QUEEN?o7.SUCCESS:o7.failure($localize(fs||(fs=_g(["This is not a queen!"]))))},$localize(hs||(hs=_g(["Congratulations!"])))),_te.fromMove($localize(ds||(ds=_g(["Capture"]))),$localize(vs||(vs=_g(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new rue([[cue,uue,uue,sue],[sue,sue,sue,sue],[lue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,uue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,cue,uue,sue]],0),[Jse.from(new qee(0,2),new qee(2,4)).get()],$localize(ps||(ps=_g(["Congratulations! By capturing that pawn, you won one point."]))),oue.YOU_DID_NOT_CAPTURE_ANY_PIECE()),_te.fromMove($localize(gs||(gs=_g(["Field Promotion (1/2)"]))),$localize(ys||(ys=_g(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new rue([[sue,sue,sue,lue],[sue,uue,sue,sue],[sue,sue,uue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,lue],[sue,sue,cue,sue],[sue,uue,sue,sue]],0),[Jse.from(new qee(1,1),new qee(2,2)).get(),Jse.from(new qee(2,2),new qee(1,1)).get()],$localize(ms||(ms=_g(["Congratulations!"]))),fue()),_te.fromPredicate($localize(ks||(ks=_g(["Field Promotion (2/2)"]))),$localize(Cs||(Cs=_g(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new rue([[uue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,cue,sue],[sue,uue,sue,sue]],1),Jse.from(new qee(1,7),new qee(2,6)).get(),function(e,t){return t.getPieceAt(e.end)===eue.QUEEN?o7.SUCCESS:o7.failure(fue())},$localize(ws||(ws=_g(["Congratulations!"])))),_te.fromPredicate($localize(_s||(_s=_g(["Call the clock"]))),$localize(bs||(bs=_g(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),rue.getInitialState(),Jse.from(new qee(2,2),new qee(3,3),!0).get(),function(e,t){return e.calledTheClock?o7.SUCCESS:o7.failure($localize(Es||(Es=_g(["You did not call the clock!"]))))},$localize(Ss||(Ss=_g(["Congratulations!"])))),_te.fromMove($localize(Ps||(Ps=_g(["Restarting the clock"]))),$localize(Os||(Os=_g(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new rue([[sue,sue,sue,sue],[sue,uue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,uue],[sue,sue,cue,sue],[sue,uue,sue,sue]],14,fB.empty(),fB.of(1)),[Jse.from(new qee(1,1),new qee(2,2)).get()],$localize(Ts||(Ts=_g(["Congratulations!"]))),$localize(Is||(Is=_g(["This is not a capture, the game is now over, please retry!"])))),_te.anyMove($localize(As||(As=_g(["End game (by clock)"]))),$localize(Rs||(Rs=_g(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new rue([[sue,sue,sue,lue],[sue,uue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[cue,sue,sue,sue],[sue,sue,sue,sue],[sue,cue,sue,sue]],14,fB.empty(),fB.of(1)),Jse.from(new qee(1,1),new qee(2,2)).get(),$localize(xs||(xs=_g(["Congratulations!"])))),_te.fromPredicate($localize(Ms||(Ms=_g(["End by emptyness"]))),$localize(Ns||(Ns=_g(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new rue([[sue,sue,sue,lue],[sue,uue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,uue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue],[sue,sue,sue,sue]],1),Jse.from(new qee(2,4),new qee(1,3)).get(),function(e,t){return 3===e.end.y?o7.SUCCESS:o7.failure($localize(Ds||(Ds=_g(["Your piece is still in you territory!"]))))},$localize(Ls||(Ls=_g(["Congratulations!"]))))]});function due(e,t){if(1&e&&(cC(),nS(0,"g",20)),2&e){var n=fS(2).index,r=fS().index,i=fS();PS(i.style),vS("mainShapeId","pawn_",n,"_",r,""),XE("pieceClasses",i.getPieceClasses(n,r))}}function vue(e,t){if(1&e&&(cC(),nS(0,"g",21)),2&e){var n=fS(2).index,r=fS().index,i=fS();PS(i.style),vS("mainShapeId","drone_",n,"_",r,""),XE("pieceClasses",i.getPieceClasses(n,r))}}function pue(e,t){if(1&e&&(cC(),nS(0,"g",22)),2&e){var n=fS(2).index,r=fS().index,i=fS();PS(i.style),vS("mainShapeId","queen_",n,"_",r,""),XE("pieceClasses",i.getPieceClasses(n,r))}}function gue(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,due,1,5,"g",17),YE(2,vue,1,5,"g",18),YE(3,pue,1,5,"g",19),tS()),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().index,o=fS();$E("transform",o.getPieceLocation(r,a)),pb(1),XE("ngIf",i===o.pieces.PAWN),pb(1),XE("ngIf",i===o.pieces.DRONE),pb(1),XE("ngIf",i===o.pieces.QUEEN)}}function yue(e,t){if(1&e){var n=aS();cC(),eS(0,"g",15),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(1,"rect",16),YE(2,gue,4,4,"g",14),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();vS("id","click_",i,"_",a,""),$E("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),pb(1),vS("id","square_",i,"_",a,""),XE("ngClass",o.getSquareClasses(i,a)),$E("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r!==o.pieces.EMPTY)}}function mue(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",23),uS("click",function(){var e=Nk(n).$implicit;return fS(3).onClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS(3);pb(1),vS("id","indicator_",r.x,"_",r.y,""),$E("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function kue(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,mue,2,7,"g",1),tS()),2&e){var n=fS(2);pb(1),XE("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function Cue(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,yue,3,11,"g",13),YE(2,kue,2,1,"g",14),tS()),2&e){var n=t.$implicit,r=fS();$E("transform","translate("+r.SPACE_SIZE+", 0)"),pb(1),XE("ngForOf",n),pb(1),XE("ngIf",r.selectedPieceInfo.isPresent())}}function wue(e,t){if(1&e&&(cC(),eS(0,"text",24),FS(1),tS()),2&e){var n=fS();XE("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),$E("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),pb(1),US(n.countDown.get())}}function _ue(e,t){if(1&e&&(cC(),nS(0,"polyline",25)),2&e){var n=fS();XE("ngClass",n.getClockCircleClasses()),$E("points",n.clockNeedlesPoints)}}var bue=function(e){return[e]};function Eue(e,t){if(1&e){var n=aS();cC(),rS(0),eS(1,"g",28),uS("click",function(){var e=Nk(n).index;return fS(2).chooseStyle(e)}),tS(),iS()}if(2&e){var r=t.$implicit,i=t.index,a=fS(2);pb(1),PS(r.style),XE("id",r.name)("pieceClasses",oT(5,bue,"player"+a.getCurrentPlayer().value)),$E("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function Sue(e,t){if(1&e&&(cC(),eS(0,"g",26),nS(1,"rect",27),YE(2,Eue,2,7,"ng-container",1),tS()),2&e){var n=fS();pb(1),$E("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),pb(1),XE("ngForOf",n.listOfStyles)}}function Pue(e,t){if(1&e&&(cC(),eS(0,"text",34),FS(1),tS()),2&e){var n=fS(2).$implicit,r=fS().$implicit,i=fS();XE("ngClass","player"+(0===r?1:0)),$E("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),pb(1),US(n+" x ")}}function Oue(e,t){if(1&e&&(cC(),nS(0,"g",35)),2&e){var n=fS(3).$implicit;PS(fS().style),XE("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Tue(e,t){if(1&e&&(cC(),nS(0,"g",36)),2&e){var n=fS(3).$implicit;PS(fS().style),XE("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Iue(e,t){if(1&e&&(cC(),nS(0,"g",37)),2&e){var n=fS(3).$implicit;PS(fS().style),XE("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Aue(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Pue,2,4,"text",30),eS(2,"g",29),YE(3,Oue,1,5,"g",31),YE(4,Tue,1,5,"g",32),YE(5,Iue,1,5,"g",33),tS(),tS()),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().$implicit,o=fS();$E("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),pb(1),XE("ngIf",i>1),pb(1),vS("id","piece_",r,"_player_",a,""),$E("transform","translate("+o.SPACE_SIZE+", 0)"),pb(1),XE("ngIf",0===r),pb(1),XE("ngIf",1===r),pb(1),XE("ngIf",2===r)}}function Rue(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Aue,6,8,"g",14),tS()),2&e){var n=t.$implicit;pb(1),XE("ngIf",n>0)}}function xue(e,t){if(1&e&&(cC(),eS(0,"g"),eS(1,"g",29),YE(2,Rue,2,1,"g",1),tS(),tS()),2&e){var n=t.$implicit,r=fS();pb(1),dS("id","capture_of_player_",n,""),$E("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),pb(1),XE("ngForOf",r.state.getCapturesOf(n))}}var Mue=function(){return[0,1]},Nue=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=eue,r.selectedPieceInfo=fB.empty(),r.countDown=fB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.rules=new aue(rue),r.availableMinimaxes=[new tue(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=Jse.encoder,r.tutorial=(new hue).tutorial,r.scores=fB.of([0,0]),r.updateBoard(),r}return Wg(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board;var e=this.state.getScoreOf(N7.ZERO),t=this.state.getScoreOf(N7.ONE);this.countDown=this.state.countDown,this.scores=fB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new qee(e,t),r=[];return r.push(t<=3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==eue.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new qee(0,t))&&r.push("highlighted"),r}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new qee(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),o7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=fB.of({selectedPiece:e,legalLandings:r}),o7.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===eue.PAWN?Hee.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===eue.DRONE?2:8)).filter(function(n){var r=Jse.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return Hee.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===eue.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),o7.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return f7((i=Jse.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.rules.node.gameState,n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=Jse.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==eue.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=fB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),o7.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===N7.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===eue.EMPTY||i.gameState.isInOpponentTerritory(new qee(0,t))?r.push("moved"):r.push("captured"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new qee(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new qee(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(rne);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-martian-chess"]],features:[RE],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Cue,3,3,"g",1),eS(2,"g",2),uS("click",function(){return t.onClockClick()}),nS(3,"rect",3),nS(4,"circle",4),YE(5,wue,2,5,"text",5),YE(6,_ue,1,2,"polyline",6),tS(),nS(7,"line",7),eS(8,"g",8),eS(9,"g",9),uS("click",function(){return t.onModeCogClick()}),nS(10,"rect",3),nS(11,"path",10),tS(),YE(12,Sue,3,5,"g",11),tS(),eS(13,"g",12),YE(14,xue,3,3,"g",1),tS(),tS()),2&e&&($E("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT),pb(1),XE("ngForOf",t.board),pb(1),$E("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),pb(1),$E("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),pb(1),XE("ngClass",t.getClockCircleClasses()),$E("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),pb(1),XE("ngIf",t.countDown.isPresent()),pb(1),XE("ngIf",t.countDown.isAbsent()),pb(1),XE("ngClass","player"+t.getCurrentPlayer().value),$E("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),pb(1),$E("transform",t.configViewTranslation),pb(2),$E("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),pb(1),XE("ngClass","player"+t.getCurrentPlayer().value),$E("transform",t.configCogTransformation),pb(1),XE("ngIf",t.displayModePanel),pb(2),XE("ngForOf",aT(24,Mue)))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Due=Number.MAX_SAFE_INTEGER,Lue=Number.MIN_SAFE_INTEGER,Fue=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,U7.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(0,new qee(0,0))}}]),n}(ste);Fue.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Fue.BOARD_1=[[0,+Due,-1,-1],[1,2,+Due,-1],[+Lue,3,4,-1],[-1,+Lue,+Lue,-1]],Fue.BOARD_2=[[0,+Due,-1,-1],[+Due,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Fue.BOARD_3=[[0,1,+Lue,-1],[1,+Lue,-1,-1],[+Lue,-1,-1,-1],[-1,-1,-1,-1]],Fue.BOARD_4=[[0,1,+Lue,-1],[1,+Lue,-1,-1],[+Lue,-1,-1,-1],[-1,-1,-1,1]],Fue.initialBoard=Fue.BOARD_0;var Uue=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new qee(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Fue(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?r7.failure("incorrect move"):r7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===N7.ZERO.getVictoryValue()?yte.ZERO_WON:n===N7.ONE.getVictoryValue()?yte.ONE_WON:t.location.equals(new qee(3,3))?0===n?yte.DRAW:n>0?yte.ONE_WON:yte.ZERO_WON:yte.ONGOING}}]),n}(mte),Vue=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).right=e,r}return Wg(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(cte);Vue.RIGHT=new Vue(!0),Vue.DOWN=new Vue(!1),Vue.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Vue.RIGHT:Vue.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(R7));var Bue=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=Uue.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n=e.gameState;return new rte(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Vue.RIGHT),n.location.y<3&&t.push(Vue.DOWN),t}}]),n}(nte);function zue(e,t){1&e&&(rS(0),FS(1,"("),iS())}function Gue(e,t){1&e&&(rS(0),FS(1,")"),iS())}function Hue(e,t){if(1&e&&(eS(0,"td"),YE(1,zue,2,0,"ng-container",3),FS(2),YE(3,Gue,2,0,"ng-container",3),tS()),2&e){var n=t.$implicit,r=t.index,i=fS().index,a=fS();pb(1),XE("ngIf",a.coord.x===r&&a.coord.y===i),pb(1),VS(" ",n," "),pb(1),XE("ngIf",a.coord.x===r&&a.coord.y===i)}}function $ue(e,t){if(1&e&&(eS(0,"tr"),YE(1,Hue,4,3,"td",0),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var Zue=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).coord=new qee(-1,-1),r.rules=new Uue(Fue),r.availableMinimaxes=[new Bue(r.rules,"MinimaxTestingMinimax")],r.encoder=Vue.encoder,r}return Wg(n,[{key:"chooseRight",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Vue.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Vue.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-minimax-testing"]],features:[RE],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(eS(0,"table"),YE(1,$ue,2,1,"tr",0),eS(2,"div",1),uS("click",function(){return t.chooseRight()}),FS(3," goRight "),tS(),eS(4,"div",2),uS("click",function(){return t.chooseDown()}),FS(5," goDown "),tS(),eS(6,"div"),FS(7),tS(),tS()),2&e&&(pb(1),XE("ngForOf",t.board),pb(6),VS(" ",t.coord," "))},directives:[LA,UA],encapsulation:2}),e}(),que=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(U7.createTable(7,6,M7.NONE),0)}}]),n}(ste),Wue=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).x=e,r}return Wg(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(cte);Wue.ZERO=new Wue(0),Wue.ONE=new Wue(1),Wue.TWO=new Wue(2),Wue.THREE=new Wue(3),Wue.FOUR=new Wue(4),Wue.FIVE=new Wue(5),Wue.SIX=new Wue(6),Wue.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Wue.of(e)}}]),n}(R7));var jue=function(){var e=Wg(function e(){Zg(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(Fs||(Fs=_g(["Please put your piece in an incomplete column."])))},e}(),Yue=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new que(a,s+1)}},{key:"isLegal",value:function(e,t){return sB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?r7.failure(jue.COLUMN_IS_FULL()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new qee(r,i));if(gte.getScoreStatus(a)===hte.VICTORY)return yte.getVictory(t.getCurrentOpponent())}return 42===t.turn?yte.DRAW:yte.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new qee(r,i));(a===N7.ZERO.getVictoryValue()||a===N7.ONE.getVictoryValue())&&t.push(new qee(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){sB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new qee(r,i));if(gte.getScoreStatus(a)!==hte.DEFAULT)return sB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new rte(a);t+=a}return new rte(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===M7.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new qee(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return f7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===N7.ONE?N7.ZERO:N7.ONE}},{key:"getSquareScore",value:function(e,t){sB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),sB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new dte,u=new dte,c=Gg(Hee.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[Hee.UP,Hee.UP_RIGHT,Hee.RIGHT,Hee.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return sB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){sB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===M7.NONE){var a=Wue.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return sB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(mte);return e.VERBOSE=!1,e}(),Kue=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return Yue.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return sB(Yue.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Yue.getBoardValue(t)}}]),n}(nte),Que=M7.NONE,Xue=M7.ZERO,Jue=M7.ONE,ece=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Us||(Us=_g(["Goal of the game"]))),$localize(Vs||(Vs=_g(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),que.getInitialState()),_te.anyMove($localize(Bs||(Bs=_g(["Dropping a piece"]))),$localize(zs||(zs=_g(["Click on any space in any column."]))),que.getInitialState(),Wue.THREE,$localize(Gs||(Gs=_g(["As you can see, the piece falls at the bottom of the column."])))),_te.fromMove($localize(Hs||(Hs=_g(["Victory"]))),$localize($s||($s=_g(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new que([[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Jue,Que,Que,Que],[Que,Que,Que,Jue,Que,Que,Que],[Que,Que,Xue,Xue,Xue,Jue,Que]],0),[Wue.of(1)],$localize(Zs||(Zs=_g(["You won!"]))),$localize(qs||(qs=_g(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),_te.fromMove($localize(Ws||(Ws=_g(["Other victory"]))),$localize(js||(js=_g(["You can also align 4 pieces diagonally or vertically."]))),new que([[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Xue,Jue,Que,Que],[Que,Que,Xue,Xue,Jue,Que,Que],[Que,Xue,Jue,Xue,Xue,Que,Que]],0),[Wue.of(3),Wue.of(4)],$localize(Ys||(Ys=_g(["You won!"]))),$localize(Ks||(Ks=_g(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function tce(e,t){if(1&e&&(cC(),nS(0,"circle",8)),2&e){var n=fS().index,r=fS().index,i=fS();XE("ngClass",i.getSquareFillClass(n,r)),$E("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function nce(e,t){if(1&e){var n=aS();cC(),eS(0,"g",5),uS("click",function(){var e=Nk(n).index;return fS(2).onClick(e)}),nS(1,"rect",6),YE(2,tce,1,4,"circle",7),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();dS("id","click_",i,""),pb(1),$E("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r!==o.EMPTY_CASE)}}function rce(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,nce,3,6,"g",4),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function ice(e,t){if(1&e&&(cC(),nS(0,"rect",9)),2&e){var n=fS();$E("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function ace(e,t){if(1&e&&(cC(),nS(0,"rect",10)),2&e){var n=t.$implicit,r=fS();vS("id","victory_coord_",n.x,"_",n.y,""),$E("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var oce=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY_CASE=M7.NONE,r.victoryCoords=[],r.rules=new Yue(que),r.availableMinimaxes=[new Kue(r.rules,"P4Minimax")],r.encoder=Wue.encoder,r.tutorial=(new ece).tutorial,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Wue.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Yue.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Yue.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=fB.of(new qee(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=fB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(rne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-p4"]],features:[RE],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,rce,2,1,"g",1),YE(2,ice,1,4,"rect",2),YE(3,ace,1,6,"rect",3),tS()),2&e&&(pb(1),XE("ngForOf",t.board),pb(1),XE("ngIf",t.last.isPresent()),pb(1),XE("ngForOf",t.victoryCoords))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),sce=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Zg(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return Lg(a)}return Wg(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,fB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,fB.empty())}}]),n}(lte);sce.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={coord:qee.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=qee.encoder.decode(t.coord),r=fB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return sce.withRotation(n.x,n.y,r.get(),i)}return sce.rotationless(n.x,n.y)}}]),n}(A7));var uce=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(Qs||(Qs=_g(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(Xs||(Xs=_g(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),cce=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return Wg(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(Hee.UP,1)),i=this.getPieceAt(t.getNext(Hee.UP_LEFT,1));return this.getPieceAt(t.getNext(Hee.RIGHT,1))===r&&this.getPieceAt(t.getNext(Hee.DOWN,1))===r&&this.getPieceAt(t.getNext(Hee.LEFT,1))===r&&this.getPieceAt(t.getNext(Hee.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Hee.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Hee.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Gg(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=Gg(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(U7.createTable(6,6,M7.NONE),0)}},{key:"getBlockCenter",value:function(e){return new qee(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(ste);cce.ROTATION_MAP=[[new qee(-1,-1),new qee(1,-1)],[new qee(0,-1),new qee(1,0)],[new qee(1,-1),new qee(1,1)],[new qee(1,0),new qee(0,1)],[new qee(1,1),new qee(-1,1)],[new qee(0,1),new qee(-1,0)],[new qee(-1,1),new qee(-1,-1)],[new qee(-1,0),new qee(0,-1)]];var lce=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return r7.failure(uce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return r7.failure(uce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return r7.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Gg(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?yte.DRAW:yte.ZERO_WON:!0===r[1]?yte.ONE_WON:36===t.turn?yte.DRAW:yte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(cce))),n.singleton.get()}}]),n}(mte);lce.singleton=fB.empty(),lce.VICTORY_SOURCE=[[new qee(1,0),new Bee(1,1),!1],[new qee(0,1),new Bee(1,1),!1],[new qee(4,0),new Bee(-1,1),!1],[new qee(5,1),new Bee(-1,1),!1],[new qee(1,1),new Bee(1,1),!0],[new qee(4,1),new Bee(-1,1),!0],[new qee(0,1),new Bee(0,1),!0],[new qee(1,1),new Bee(0,1),!0],[new qee(2,1),new Bee(0,1),!0],[new qee(3,1),new Bee(0,1),!0],[new qee(4,1),new Bee(0,1),!0],[new qee(5,1),new Bee(0,1),!0],[new qee(1,0),new Bee(1,0),!0],[new qee(1,1),new Bee(1,0),!0],[new qee(1,2),new Bee(1,0),!0],[new qee(1,3),new Bee(1,0),!0],[new qee(1,4),new Bee(1,0),!0],[new qee(1,5),new Bee(1,0),!0]];var fce=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Gg(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=sce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Gg(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(sce.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new qee(r,n);e.getPieceAt(i)===M7.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new rte(lce.get().getGameStatus(e).toBoardValue())}}]),n}(nte);fce.FIRST_TURN_MOVES=[sce.rotationless(0,0),sce.rotationless(1,0),sce.rotationless(2,0),sce.rotationless(0,1),sce.rotationless(1,1),sce.rotationless(0,2)];var hce=M7.NONE,dce=M7.ZERO,vce=M7.ONE,pce=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Js||(Js=_g(["Initial board"]))),$localize(eu||(eu=_g(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),cce.getInitialState()),_te.informational($localize(tu||(tu=_g(["Goal of the game"]))),$localize(nu||(nu=_g(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new cce([[dce,hce,hce,dce,vce,hce],[dce,vce,hce,hce,hce,hce],[dce,hce,vce,hce,hce,hce],[dce,hce,hce,hce,hce,vce],[dce,hce,hce,hce,vce,hce],[hce,hce,hce,hce,hce,hce]],10)).withPreviousMove(sce.withRotation(0,0,0,!1)),_te.fromPredicate($localize(ru||(ru=_g(["Simple move"]))),$localize(iu||(iu=_g(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new cce([[hce,hce,hce,hce,hce,hce],[hce,dce,hce,hce,vce,hce],[hce,hce,hce,hce,hce,hce],[hce,hce,hce,hce,hce,hce],[hce,vce,hce,hce,dce,hce],[hce,hce,hce,hce,hce,hce]],10),sce.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?o7.failure($localize(au||(au=_g(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):o7.SUCCESS},$localize(ou||(ou=_g(["Congratulations!"])))),_te.fromPredicate($localize(su||(su=_g(["Move with rotation"]))),$localize(uu||(uu=_g(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new cce([[hce,hce,hce,hce,hce,hce],[hce,dce,hce,hce,vce,hce],[hce,hce,hce,hce,hce,hce],[hce,hce,hce,hce,hce,hce],[hce,vce,hce,hce,dce,hce],[hce,hce,hce,hce,hce,hce]],10),sce.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?o7.SUCCESS:o7.failure($localize(cu||(cu=_g(["You made a move without rotation, try again!"]))))},$localize(lu||(lu=_g(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function gce(e,t){if(1&e){var n=aS();cC(),rS(0),eS(1,"circle",9),uS("click",function(){var e=Nk(n).$implicit,t=fS().$implicit,r=fS().index,i=fS().index;return fS().onClick(3*r+e,3*i+t)}),tS(),iS()}if(2&e){var r=t.$implicit,i=fS().$implicit,a=fS(),o=a.index,s=a.$implicit,u=fS(),c=u.index,l=u.$implicit,f=fS();pb(1),vS("id","click_",3*o+r,"_",3*c+i,""),XE("ngClass",f.getSquareClasses(3*o+r,3*c+i)),$E("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var yce=function(){return[0,1,2]};function mce(e,t){1&e&&(cC(),rS(0),YE(1,gce,2,6,"ng-container",3),iS()),2&e&&(pb(1),XE("ngForOf",aT(1,yce)))}function kce(e,t){if(1&e&&(cC(),rS(0),nS(1,"rect",8),YE(2,mce,2,2,"ng-container",3),iS()),2&e){var n=t.$implicit,r=t.index,i=fS(),a=i.index,o=i.$implicit,s=fS();pb(1),XE("ngClass",s.getBlockClasses(r,a)),$E("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),pb(1),XE("ngForOf",aT(8,yce))}}var Cce=function(e){return[0,e]};function wce(e,t){if(1&e&&(cC(),rS(0),YE(1,kce,3,9,"ng-container",3),iS()),2&e){var n=fS();pb(1),XE("ngForOf",oT(1,Cce,n.BLOCK_SEPARATION))}}function _ce(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS();vS("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),XE("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),$E("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function bce(e,t){if(1&e){var n=aS();cC(),eS(0,"path",11),uS("click",function(){var e=Nk(n).$implicit;return fS().rotate(e)}),tS()}if(2&e){var r=t.$implicit,i=fS();vS("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),$E("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Ece(e,t){if(1&e&&(cC(),nS(0,"circle",12)),2&e){var n=t.$implicit,r=fS();vS("id","victoryCoord_",n.x,"_",n.y,""),XE("ngClass",r.getSquareClasses(n.x,n.y)),$E("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Sce(e,t){if(1&e){var n=aS();cC(),eS(0,"g",13),uS("click",function(){return Nk(n),fS().skipRotation()}),nS(1,"circle",14),nS(2,"line",15),tS()}if(2&e){var r=fS();pb(1),$E("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),pb(1),$E("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var Pce=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new lce(cce),r.availableMinimaxes=[new fce(r.rules,"PentagoMinimax")],r.encoder=sce.encoder,r.tutorial=(new pce).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new qee(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new qee(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?oB.getNonNullable(cce.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:oB.getNonNullable(cce.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Bee(i%2==0?1:4,i<2?1:4),1),this.lastDrop=fB.of(r)}else this.lastDrop=fB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=fB.empty(),this.movedBlock=fB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=fB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(tte.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=sce.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=fB.of(new qee(e,t)),n.displayArrows(s.neutralBlocks),o7.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new qee(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=sce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=sce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-pentago"]],features:[RE],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"defs"),eS(2,"marker",1),nS(3,"polygon",2),tS(),tS(),YE(4,wce,2,3,"ng-container",3),YE(5,_ce,1,6,"circle",4),YE(6,bce,1,4,"path",5),YE(7,Ece,1,7,"circle",6),YE(8,Sce,3,9,"g",7),tS()),2&e&&(pb(4),XE("ngForOf",oT(5,Cce,t.BLOCK_SEPARATION)),pb(1),XE("ngIf",t.currentDrop.isPresent()),pb(1),XE("ngForOf",t.arrows),pb(1),XE("ngForOf",t.victoryCoords),pb(1),XE("ngIf",t.canSkipRotation))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Oce=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return Lg(a)}return Wg(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new qee(this.x-1,this.y-1),r=new qee(this.x,this.y-1),i=new qee(this.x-1,this.y),a=new qee(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new qee(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?fB.empty():fB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?fB.empty():fB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(qee),Tce=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return Wg(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=fB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=fB.empty(),n=fB.empty();if(e.length>0&&(t=fB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=fB.of(e[1]),e[1].isUpperThan(e[0])&&(t=fB.of(e[1]),n=fB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=fB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(cte);Tce.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Oce.encode(e.landingCoord),n=Oce.encodeOptional(e.startingCoord),r=Oce.encodeOptional(e.firstCapture);return 270400*Oce.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Oce.decode(e%64);e-=e%64;var n=Oce.decodeToOptional((e/=64)%65);e-=e%65;var r=Oce.decodeToOptional((e/=65)%65);e-=e%65;var i=Oce.decodeToOptional(e/=65);return new Tce(n,t,r,i)}}]),n}(R7));var Ice=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).boards=e,i}return Wg(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:M7.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:M7.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:M7.NONE}),t=n?this.turn+1:this.turn,this.setBoardAts(r,t)}},{key:"setBoardAts",value:function(e,t){var r,i=[U7.copyBiArray(this.boards[0]),U7.copyBiArray(this.boards[1]),U7.copyBiArray(this.boards[2]),U7.copyBiArray(this.boards[3])],a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=Gg(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===M7.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Gg(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[M7.NONE.value]=0,e[N7.ZERO.value]=0,e[N7.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Oce(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removeCoord",value:function(e){return this.setBoardAts([{coord:e,value:M7.NONE}],this.turn)}},{key:"applyDrop",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAts([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=Gg(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Gg(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new Oce(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([U7.createTable(4,4,M7.NONE),U7.createTable(3,3,M7.NONE),U7.createTable(2,2,M7.NONE),[[M7.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return oB.expectToBe(e,2),[0,1]}}}]),n}(ote),Ace=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(fu||(fu=_g(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(hu||(hu=_g(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(du||(du=_g(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(vu||(vu=_g(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(pu||(pu=_g(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(gu||(gu=_g(["Your second capture is invalid."])))},e}(),Rce=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return r7.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return r7.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:r7.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return r7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===M7.NONE)return r7.failure(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removeCoord(e.startingCoord.get());return r7.success(a)}return r7.failure(Ace.CANNOT_MOVE_SUPPORTING_PIECE())}return r7.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?r7.success(t.applyDrop(e.landingCoord)):r7.failure(Ace.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return r7.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return r7.failure(Ace.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removeCoord(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?r7.success(void 0):r7.failure(Ace.INVALID_SECOND_CAPTURE())}return r7.failure(Ace.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Oce(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Gg(e.freeToMove);try{var i=function(){var r,i=t.value,a=Gg(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=Tce.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Gg(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Tce.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[$ee.UP,$ee.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[$ee.LEFT,$ee.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new ate,r=Gg(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new ate([i]));var a,o=Gg(e.removeCoord(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new ate([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[N7.ZERO.value]?yte.ONE_WON:15===t[N7.ONE.value]?yte.ZERO_WON:yte.ONGOING}}]),n}(mte),xce=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Rce.getGameStatus(e);if(t.isEndGame)return new rte(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new rte(n[N7.ZERO.value]-n[N7.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Rce.getStateInfo(n),a=Rce.getClimbingMoves(i),o=Rce.getDropMoves(i),s=Gg(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new ate;Rce.canCapture(c,u.landingCoord)?l=Rce.getPossibleCaptures(c):r.push(u);var f,h=Gg(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=Tce.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(nte),Mce=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=xce.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(xce),Nce=M7.NONE,Dce=M7.ZERO,Lce=M7.ONE,Fce=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(yu||(yu=_g(["Goal of the game"]))),$localize(mu||(mu=_g(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),Ice.getInitialState()),_te.anyMove($localize(ku||(ku=_g(["Dropping a piece"]))),$localize(Cu||(Cu=_g(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),Ice.getInitialState(),Tce.fromDrop(new Oce(1,1,0),[]),$localize(wu||(wu=_g(["There you go, as simple as that."])))),_te.fromMove($localize(_u||(_u=_g(["Climbing"]))),$localize(bu||(bu=_g(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new Ice([[[Dce,Lce,Nce,Nce],[Lce,Dce,Nce,Nce],[Nce,Nce,Nce,Nce],[Nce,Nce,Nce,Dce]],[[Nce,Nce,Nce],[Nce,Nce,Nce],[Nce,Nce,Nce]],[[Nce,Nce],[Nce,Nce]],[[Nce]]],0),[Tce.fromClimb(new Oce(3,3,0),new Oce(0,0,1),[])],$localize(Eu||(Eu=_g(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(Su||(Su=_g(["Failed!"])))),_te.fromMove($localize(Pu||(Pu=_g(["Square (1/2)"]))),$localize(Ou||(Ou=_g(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new Ice([[[Dce,Dce,Nce,Nce],[Nce,Dce,Nce,Nce],[Nce,Nce,Nce,Nce],[Nce,Nce,Nce,Nce]],[[Nce,Nce,Nce],[Nce,Nce,Nce],[Nce,Nce,Nce]],[[Nce,Nce],[Nce,Nce]],[[Nce]]],0),[Tce.fromDrop(new Oce(0,1,0),[new Oce(0,0,0)]),Tce.fromDrop(new Oce(0,1,0),[new Oce(0,1,0)]),Tce.fromDrop(new Oce(0,1,0),[new Oce(1,0,0)]),Tce.fromDrop(new Oce(0,1,0),[new Oce(1,1,0)])],$localize(Tu||(Tu=_g(["Congratulations, you have saved up one piece."]))),$localize(Iu||(Iu=_g(["Failed!"])))),_te.fromPredicate($localize(Au||(Au=_g(["Square (2/2)"]))),$localize(Ru||(Ru=_g(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new Ice([[[Dce,Dce,Nce,Nce],[Nce,Dce,Nce,Nce],[Nce,Nce,Nce,Nce],[Nce,Nce,Nce,Nce]],[[Nce,Nce,Nce],[Nce,Nce,Nce],[Nce,Nce,Nce]],[[Nce,Nce],[Nce,Nce]],[[Nce]]],0),Tce.fromDrop(new Oce(0,1,0),[new Oce(0,0,0),new Oce(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?o7.SUCCESS:e.firstCapture.isPresent()?o7.failure($localize(xu||(xu=_g(["Failed, you only captured one piece."])))):o7.failure(oue.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(Mu||(Mu=_g(["Congratulations, you have saved up two pieces."]))))]});function Uce(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",4),tS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();pb(1),vS("id","piece_",r,"_",n,""),XE("ngClass",i.getPlayerPieceClass(r)),$E("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Vce(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Uce,2,6,"g",1),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",r.getPlayerSidePieces(n))}}function Bce(e,t){if(1&e){var n=aS();cC(),eS(0,"circle",8),uS("click",function(){Nk(n);var e=fS(2).$implicit,t=fS().$implicit,r=fS().$implicit;return fS().onPieceClick(e,t,r)}),tS()}if(2&e){var r=fS(2).$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();pS("id","piece_",r,"_",i,"_",a,""),XE("ngClass",o.getPieceClasses(r,i,a)),$E("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function zce(e,t){if(1&e){var n=aS();cC(),eS(0,"rect",8),uS("click",function(){Nk(n);var e=fS(2).$implicit,t=fS().$implicit,r=fS().$implicit;return fS().onDrop(e,t,r)}),tS()}if(2&e){var r=fS(2).$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();pS("id","drop_",r,"_",i,"_",a,""),XE("ngClass",o.getSquareClasses(r,i,a)),$E("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Gce(e,t){if(1&e&&(cC(),rS(0),YE(1,Bce,1,7,"circle",6),YE(2,zce,1,8,"ng-template",null,7,xT),iS()),2&e){var n=KE(3),r=fS().$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();pb(1),XE("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Hce(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Gce,4,2,"ng-container",5),tS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS().$implicit,a=fS();pb(1),XE("ngIf",a.mustDraw(n,r,i))}}function $ce(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Hce,2,1,"g",1),tS()),2&e){var n=fS().$implicit,r=fS();pb(1),XE("ngForOf",r.getLevelRange(n))}}function Zce(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,$ce,2,1,"g",1),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",r.getLevelRange(n))}}function qce(e,t){if(1&e&&(cC(),nS(0,"rect",9)),2&e){var n=fS();pS("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),$E("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var Wce=function(){return[0,1]},jce=function(){return[0,1,2]},Yce=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.lastFirstCapture=fB.empty(),r.lastSecondCapture=fB.empty(),r.highCapture=fB.empty(),r.chosenStartingCoord=fB.empty(),r.chosenLandingCoord=fB.empty(),r.chosenFirstCapture=fB.empty(),r.lastMove=fB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Rce(Ice),r.availableMinimaxes=[new xce(r.rules,"PylosMinimax"),new Mce(r.rules,"PylosOrderedMinimax")],r.encoder=Tce.encoder,r.tutorial=(new Fce).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return Wg(n,[{key:"getLevelRange",value:function(e){return Ice.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new Oce(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Oce(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(Ace.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),o7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),o7.SUCCESS):t.chosenFirstCapture.equalsValue(e)?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?Tce.fromDrop(t.chosenLandingCoord.get(),e):Tce.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=fB.empty(),this.chosenLandingCoord=fB.empty(),this.chosenFirstCapture=fB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Oce(e,t,n),i.abrupt("return",Rce.canCapture(r.constructedState,o)?(r.chosenLandingCoord=fB.of(o),r.constructedState=r.constructedState.applyDrop(o),o7.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=fB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Ace.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Oce(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new Oce(e,t,n);if(this.justClimbed(r))return!1;var i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Oce(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(N7.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=fB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=fB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=fB.empty(),this.lastLandingCoord=fB.empty(),this.lastFirstCapture=fB.empty(),this.lastSecondCapture=fB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(Wee);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-pylos"]],features:[RE],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Vce,2,1,"g",1),nS(2,"rect",2),YE(3,Zce,2,1,"g",1),YE(4,qce,1,7,"rect",3),tS()),2&e&&(pb(1),XE("ngForOf",aT(3,Wce)),pb(2),XE("ngForOf",aT(4,jce)),pb(1),XE("ngIf",t.highCapture.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Kce=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();Kce.AAAA=new Kce(0),Kce.AAAB=new Kce(1),Kce.AABA=new Kce(2),Kce.AABB=new Kce(3),Kce.ABAA=new Kce(4),Kce.ABAB=new Kce(5),Kce.ABBA=new Kce(6),Kce.ABBB=new Kce(7),Kce.BAAA=new Kce(8),Kce.BAAB=new Kce(9),Kce.BABA=new Kce(10),Kce.BABB=new Kce(11),Kce.BBAA=new Kce(12),Kce.BBAB=new Kce(13),Kce.BBBA=new Kce(14),Kce.BBBB=new Kce(15),Kce.EMPTY=new Kce(16),Kce.pieces=[Kce.AAAA,Kce.AAAB,Kce.AABA,Kce.AABB,Kce.ABAA,Kce.ABAB,Kce.ABBA,Kce.ABBB,Kce.BAAA,Kce.BAAB,Kce.BABA,Kce.BABB,Kce.BBAA,Kce.BBAB,Kce.BBBA,Kce.BBBB];var Qce=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).piece=i,a}return Wg(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(lte);Qce.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Qce(e/=4,n,Kce.fromInt(t))}}]),n}(R7));var Xce=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return Wg(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Gg(Kce.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(U7.createTable(4,4,Kce.EMPTY),0,Kce.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(ste),Jce=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Nu||(Nu=_g(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Du||(Du=_g(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Lu||(Lu=_g(["You cannot give the piece that was in your hands."])))},e}(),ele=function(){function e(t){Zg(this,e),this.subCriterion=[fB.empty(),fB.empty(),fB.empty(),fB.empty()],this.subCriterion[0]=fB.of(8==(8&t.value)),this.subCriterion[1]=fB.of(4==(4&t.value)),this.subCriterion[2]=fB.of(2==(2&t.value)),this.subCriterion[3]=fB.of(1==(1&t.value))}return Wg(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=fB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),tle=function(){function e(t,n){Zg(this,e),this.initialCoord=t,this.direction=n}return Wg(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),nle=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Xce(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:hte.DEFAULT,sensitiveSquares:new Tne},a=Gg(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===hte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Gg(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Kce.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?o7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):a===Kce.EMPTY?15===t.turn?o7.SUCCESS:o7.failure(Jce.MUST_GIVE_A_PIECE()):Xce.isAlreadyOnBoard(a,o)?o7.failure(Jce.PIECE_ALREADY_ON_BOARD()):s===a?o7.failure(Jce.CANNOT_GIVE_PIECE_IN_HAND()):o7.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===hte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:hte.VICTORY,sensitiveSquares:new Tne}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new ele(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:hte.VICTORY,sensitiveSquares:new Tne};a.get().matchPiece(t.pieceInHand)&&(r.score=hte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=fB.empty(),a=fB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Kce.EMPTY){if(!i.isAbsent())return{sensitiveCoord:fB.of(o),commonCriterion:a,boardStatus:fB.of(r)};i=fB.of(o)}else a.isAbsent()?(a=fB.of(new ele(u)),sB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),sB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:fB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=N7.of(t%2);return e===hte.VICTORY?yte.getDefeat(n):16===t?yte.DRAW:yte.ONGOING}}]),n}(mte);nle.VERBOSE=!1,nle.lines=[new tle(new qee(0,0),Hee.DOWN),new tle(new qee(1,0),Hee.DOWN),new tle(new qee(2,0),Hee.DOWN),new tle(new qee(3,0),Hee.DOWN),new tle(new qee(0,0),Hee.RIGHT),new tle(new qee(0,1),Hee.RIGHT),new tle(new qee(0,2),Hee.RIGHT),new tle(new qee(0,3),Hee.RIGHT),new tle(new qee(0,0),Hee.DOWN_RIGHT),new tle(new qee(0,3),Hee.UP_RIGHT)];var rle=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Kce.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Qce(s,o,Kce.EMPTY);return t.push(u),t}var c,l=Gg(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new Qce(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:hte.DEFAULT,sensitiveSquares:new Tne},a=Gg(nle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=nle.updateBoardStatus(o,r,i)).score===hte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===hte.DEFAULT)return new rte(0);var n=N7.of(t%2);return new rte(e===hte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(nte),ile=Kce.AABA,ale=Kce.AABB,ole=Kce.ABAA,sle=Kce.ABAB,ule=Kce.ABBA,cle=Kce.BAAA,lle=Kce.BAAB,fle=Kce.BABB,hle=Kce.BBAA,dle=Kce.BBAB,vle=Kce.BBBA,ple=Kce.BBBB,gle=Kce.EMPTY,yle=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Fu||(Fu=_g(["Goal of the game"]))),$localize(Uu||(Uu=_g(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Xce([[vle,hle,ole,ile],[gle,gle,gle,gle],[gle,gle,gle,gle],[gle,gle,gle,gle]],7,Kce.ABAB)),_te.anyMove($localize(Vu||(Vu=_g(["Placement"]))),$localize(Bu||(Bu=_g(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Xce([[vle,ale,ule,gle],[gle,gle,gle,gle],[gle,cle,gle,gle],[gle,gle,gle,gle]],7,Kce.ABAA),new Qce(2,2,Kce.BAAB),$localize(zu||(zu=_g(["Perfect!"])))),_te.fromMove($localize(Gu||(Gu=_g(["Situation"]))),$localize(Hu||(Hu=_g(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Xce([[ple,vle,dle,gle],[ole,fle,hle,gle],[sle,cle,lle,gle],[gle,gle,gle,gle]],7,Kce.AABA),[new Qce(3,3,Kce.AABB)],$localize($u||($u=_g(["Well done!"]))),$localize(Zu||(Zu=_g(["Failed!"]))))]});function mle(e,t){if(1&e&&(cC(),nS(0,"rect",11)),2&e){var n=fS(2),r=n.$implicit,i=n.index,a=fS().index,o=fS();XE("ngClass",o.getPieceClasses(r.value)),$E("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function kle(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS(2),r=n.$implicit,i=n.index,a=fS().index,o=fS();XE("ngClass",o.getPieceClasses(r.value)),$E("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function Cle(e,t){if(1&e&&(cC(),nS(0,"circle")),2&e){var n=fS(2).index,r=fS().index,i=fS();$E("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function wle(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,mle,1,5,"rect",9),YE(2,kle,1,4,"ng-template",null,10,xT),YE(4,Cle,1,3,"circle",3),tS()),2&e){var n=KE(3),r=fS().$implicit,i=fS(2);pb(1),XE("ngIf",r.isRectangle())("ngIfElse",n),pb(3),XE("ngIf",i.pieceHasDot(r.value))}}function _le(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",8),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().chooseCoord(e,t)}),tS(),YE(2,wle,5,3,"g",3),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","chooseCoord_",i,"_",a,""),XE("ngClass",o.getSquareClasses(i,a)),$E("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r!==o.EMPTY)}}function ble(e,t){if(1&e&&(cC(),eS(0,"g",null,7),YE(2,_le,3,8,"g",2),tS()),2&e){var n=t.$implicit;pb(2),XE("ngForOf",n)}}function Ele(e,t){if(1&e&&(cC(),nS(0,"rect",15)),2&e){var n=fS(2);XE("ngClass",n.getPieceClasses(n.pieceInHand.value)),$E("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Sle(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS(2);XE("ngClass",n.getPieceClasses(n.pieceInHand.value)),$E("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Ple(e,t){if(1&e&&(cC(),nS(0,"circle")),2&e){var n=fS(2);$E("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function Ole(e,t){if(1&e&&(cC(),eS(0,"g",null,12),nS(2,"rect",13),YE(3,Ele,1,5,"rect",14),YE(4,Sle,1,4,"ng-template",null,10,xT),YE(6,Ple,1,3,"circle",3),tS()),2&e){var n=KE(5),r=fS();$E("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),pb(2),$E("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),pb(1),XE("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),pb(3),XE("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Tle(e,t){if(1&e&&(cC(),eS(0,"g",null,16),nS(2,"rect",17),tS()),2&e){var n=t.$implicit,r=fS();pb(2),$E("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Ile(e,t){if(1&e&&(cC(),nS(0,"rect",11)),2&e){var n=fS(2);XE("ngClass",n.getPieceClasses(n.pieceInHand.value)),$E("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Ale(e,t){if(1&e&&(cC(),nS(0,"circle",19)),2&e){var n=fS(2);XE("ngClass",n.getPieceClasses(n.pieceInHand.value)),$E("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Rle(e,t){1&e&&(cC(),nS(0,"circle",20)),2&e&&$E("cy",.75*fS(2).SPACE_SIZE)("r",10)}function xle(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Ile,1,6,"rect",9),YE(2,Ale,1,3,"ng-template",null,10,xT),YE(4,Rle,1,2,"circle",18),tS()),2&e){var n=KE(3),r=fS();pb(1),XE("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),pb(3),XE("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Mle(e,t){if(1&e&&(cC(),nS(0,"rect",27)),2&e){var n=fS(2).index,r=fS().index,i=fS();$E("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Nle(e,t){if(1&e&&(cC(),nS(0,"rect",11)),2&e){var n=fS(2).index,r=fS().index,i=fS();XE("ngClass",i.getPieceClasses(4*r+n)),$E("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Dle(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS(2).index,r=fS().index,i=fS();XE("ngClass",i.getPieceClasses(4*r+n)),$E("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Lle(e,t){if(1&e&&(cC(),nS(0,"circle")),2&e){var n=fS(2).index,r=fS().index,i=fS();$E("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Fle(e,t){if(1&e){var n=aS();cC(),eS(0,"g",25),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().choosePiece(4*t+e)}),YE(1,Mle,1,4,"rect",26),YE(2,Nle,1,5,"rect",9),YE(3,Dle,1,4,"ng-template",null,10,xT),YE(5,Lle,1,3,"circle",3),tS()}if(2&e){var r=KE(4),i=fS().index,a=fS().index,o=fS();dS("id","choosePiece_",4*a+i,""),pb(1),XE("ngIf",o.pieceToGive.value===4*a+i),pb(1),XE("ngIf",(4*a+i)%4<2)("ngIfElse",r),pb(3),XE("ngIf",o.pieceHasDot(4*a+i))}}function Ule(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Fle,6,5,"g",24),tS()),2&e){var n=t.index,r=fS().index,i=fS();pb(1),XE("ngIf",i.isRemaining(4*r+n))}}function Vle(e,t){if(1&e&&(cC(),eS(0,"g",null,21),nS(2,"rect",22,23),YE(4,Ule,2,1,"g",2),tS()),2&e){var n=t.$implicit,r=fS();$E("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),pb(2),$E("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),pb(2),XE("ngForOf",n)}}var Ble=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY=Kce.EMPTY,r.chosen=fB.empty(),r.lastMove=fB.empty(),r.pieceInHand=Kce.EMPTY,r.pieceToGive=Kce.EMPTY,r.victoriousCoords=[],r.rules=new nle(Xce),r.availableMinimaxes=[new rle(r.rules,"QuartoMinimax")],r.encoder=Qce.encoder,r.tutorial=(new yle).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=fB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Kce.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Qce(e,t,Kce.EMPTY),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==Kce.EMPTY){r.next=9;break}return r.abrupt("return",o7.SUCCESS);case 9:return o=new Qce(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(tte.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=Kce.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",o7.SUCCESS);case 5:return i=t.chosen.get(),a=new Qce(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=Kce.EMPTY}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=fB.of(new qee(e,t))}},{key:"isRemaining",value:function(e){return Xce.isGivable(Kce.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Kce.EMPTY.value&&e%8<4}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-quarto"]],features:[RE],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"g",1),YE(2,ble,3,1,"g",2),YE(3,Ole,7,6,"g",3),YE(4,Tle,3,3,"g",2),eS(5,"g",null,4),nS(7,"rect",5,6),YE(9,xle,5,3,"g",3),tS(),YE(10,Vle,5,6,"g",2),tS(),tS()),2&e&&($E("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),pb(2),XE("ngForOf",t.board),pb(1),XE("ngIf",t.chosen.isPresent()),pb(1),XE("ngForOf",t.victoriousCoords),pb(1),$E("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),pb(2),$E("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),pb(2),XE("ngIf",t.chosen.isAbsent()),pb(1),XE("ngForOf",t.board))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zle=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(qu||(qu=_g(["You must pick a space from the edge of the board."])))},e}(),Gle=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;Zg(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===$ee.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===$ee.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===$ee.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===$ee.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return Wg(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?o7.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?o7.failure(zle.NO_INSIDE_CLICK()):o7.SUCCESS}}]),n}(lte);Gle.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=$ee.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Gle(e/=5,n,t)}}]),n}(R7));var Hle=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(U7.createTable(5,5,M7.NONE),0)}}]),n}(ste),$le=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?r7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[N7.ZERO.value]),a=n.getFullestLine(r[N7.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===N7.ZERO||a<5)?yte.ZERO_WON:5===a?yte.ONE_WON:yte.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new qee(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new qee(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new qee(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new qee(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push($ee.LEFT),0!==e.y&&t.push($ee.UP),4!==e.x&&t.push($ee.RIGHT),4!==e.y&&t.push($ee.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[N7.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[N7.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new qee(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new qee(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new qee(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new qee(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,Bg(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(mte),Zle=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=$le.getVerticalCoords(e),i=Gg($le.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Gg($le.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Gle(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=$le.getLinesSums(t),r=$le.getFullestLine(n[N7.ZERO.value]),i=$le.getFullestLine(n[N7.ONE.value]),a=t.getCurrentPlayer();return new rte(5===r&&(a===N7.ZERO||i<5)?N7.ZERO.getVictoryValue():5===i?N7.ONE.getVictoryValue():i-r)}}]),n}(nte),qle=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case $ee.UP:r=0,i=-1,a=-90;break;case $ee.DOWN:r=0,i=1,a=90;break;case $ee.LEFT:r=-1,i=0,a=180;break;default:oB.expectToBe(n,$ee.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),Wle=M7.NONE,jle=M7.ZERO,Yle=M7.ONE,Kle=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Wu||(Wu=_g(["Goal of the game."]))),$localize(ju||(ju=_g(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),Hle.getInitialState()),_te.fromMove($localize(Yu||(Yu=_g(["What a move looks like (without animation)"]))),$localize(Ku||(Ku=_g(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new Hle([[Wle,Wle,Wle,Wle,Wle],[Wle,Wle,Wle,Wle,Wle],[Wle,Wle,Wle,Wle,Wle],[Wle,Wle,Wle,Wle,Wle],[jle,jle,jle,jle,Wle]],1),[new Gle(4,4,$ee.LEFT)],$localize(Qu||(Qu=_g(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(Xu||(Xu=_g(["Failed!"])))),_te.fromMove($localize(Ju||(Ju=_g(["Victory"]))),$localize(ec||(ec=_g(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new Hle([[Wle,Yle,Wle,Yle,Yle],[Wle,jle,jle,Wle,jle],[Yle,Yle,Yle,jle,Yle],[jle,Wle,jle,Yle,Yle],[Yle,jle,Wle,Yle,jle]],31),[new Gle(3,0,$ee.DOWN)],$localize(tc||(tc=_g(["Congratulations, you won!"]))),$localize(nc||(nc=_g(["Failed!"]))))]});function Qle(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",4),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onBoardClick(e,t)}),tS(),tS()}if(2&e){var r=t.index,i=fS().index,a=fS();pb(1),vS("id","click_",r,"_",i,""),XE("ngClass",a.getPieceClasses(r,i)),$E("cx",50+100*r)("cy",50+100*i)}}function Xle(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Qle,2,5,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Jle(e,t){if(1&e){var n=aS();cC(),eS(0,"use",6),uS("click",function(){var e=Nk(n).$implicit;return fS(2).chooseDirection(e)}),tS()}if(2&e){var r=t.$implicit,i=fS(2);dS("id","chooseDirection_",r,""),$E("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function efe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Jle,1,2,"use",5),tS()),2&e){var n=fS();pb(1),XE("ngForOf",n.getPossiblesDirections())}}var tfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMoveCoord=fB.empty(),r.chosenCoord=fB.empty(),r.victoriousCoords=[],r.rules=new $le(Hle),r.availableMinimaxes=[new Zle(r.rules,"QuixoMinimax")],r.encoder=Gle.encoder,r.tutorial=(new Kle).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=$le.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new qee(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new qee(e,t),i=Gle.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=fB.of(r),o7.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=$ee.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Gle(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return qle.getArrowTransform(this.SPACE_SIZE,e,$ee.factory.fromString(t).get())}}]),n}(rne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-quixo"]],features:[RE],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"defs"),nS(2,"polygon",1),tS(),YE(3,Xle,2,1,"g",2),YE(4,efe,2,1,"g",3),tS()),2&e&&(pb(3),XE("ngForOf",t.board),pb(1),XE("ngIf",t.chosenCoord.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=U7.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,M7.NONE);return e[3][3]=N7.ZERO,e[4][4]=N7.ZERO,e[3][4]=N7.ONE,e[4][3]=N7.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new qee(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(ste);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),rfe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(lte);rfe.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return(nfe.BOARD_HEIGHT-1)*nfe.BOARD_WIDTH+(nfe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*nfe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%nfe.BOARD_WIDTH;return new rfe(t,(e-t)/nfe.BOARD_WIDTH)}}]),n}(R7)),rfe.PASS=new rfe(-1,-1),rfe.PASS_NUMBER=rfe.encoder.encodeNumber(rfe.PASS);var ife=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(rc||(rc=_g(["Your move should switch at least one piece."])))},e}(),afe=Wg(function e(t,n){Zg(this,e),this.move=t,this.switched=n}),ofe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(rfe.PASS))return new nfe(a,r+1);var o,s=Gg(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new nfe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(rfe.PASS))return n.playerCanOnlyPass(t)?r7.success([]):r7.failure(tte.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return sB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),r7.failure(tte.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return sB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?r7.failure(ife.NO_ELEMENT_SWITCHED()):r7.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return yte.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?yte.ZERO_WON:i>0?yte.ONE_WON:yte.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Gg(Hee.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(nfe.BOARD_WIDTH,nfe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=Gg(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(nfe.BOARD_WIDTH,nfe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===M7.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(rfe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new nfe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===M7.NONE&&(t=e.getCopiedBoard(),nfe.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new rfe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=Gg(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;f7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new afe(u,c.length))}}return 0===r.length&&r.push(new afe(rfe.PASS,0)),r}}]),n}(mte);return e.VERBOSE=!1,e}(),sfe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=ofe.getGameStatus(e);if(t.isEndGame)return rte.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<nfe.BOARD_HEIGHT;a++)for(var o=0;o<nfe.BOARD_WIDTH;o++){var s=(0===o||o===nfe.BOARD_WIDTH-1?4:1)*(0===a||a===nfe.BOARD_HEIGHT-1?4:1);n[a][o]===N7.ZERO&&(r+=s),n[a][o]===N7.ONE&&(i+=s)}return r*=N7.ZERO.getScoreModifier(),i*=N7.ONE.getScoreModifier(),new rte(i+r)}},{key:"getListMoves",value:function(e){var t=ofe.getListMoves(e.gameState);return U7.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(nte);sfe.bestCoords=[new qee(0,0),new qee(0,nfe.BOARD_HEIGHT-1),new qee(nfe.BOARD_WIDTH-1,0),new qee(nfe.BOARD_WIDTH-1,nfe.BOARD_HEIGHT-1)];var ufe=M7.NONE,cfe=M7.ZERO,lfe=M7.ONE,ffe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(ic||(ic=_g(["Goal of the game"]))),$localize(ac||(ac=_g(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new nfe([[cfe,cfe,cfe,cfe,cfe,cfe,cfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,cfe,cfe,cfe,cfe,cfe,cfe,cfe]],60)),_te.anyMove($localize(oc||(oc=_g(["Capture (1/2)"]))),$localize(sc||(sc=_g(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),nfe.getInitialState(),new rfe(2,4),$localize(uc||(uc=_g(["Congratulations!"])))),_te.fromMove($localize(cc||(cc=_g(["Capture (2/2)"]))),$localize(lc||(lc=_g(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new nfe([[ufe,ufe,ufe,ufe,ufe,ufe,ufe,ufe],[ufe,ufe,ufe,ufe,ufe,ufe,ufe,ufe],[ufe,ufe,ufe,ufe,ufe,ufe,ufe,ufe],[ufe,ufe,ufe,ufe,lfe,ufe,ufe,ufe],[ufe,ufe,ufe,cfe,ufe,ufe,ufe,ufe],[ufe,ufe,cfe,ufe,ufe,ufe,ufe,ufe],[cfe,cfe,ufe,ufe,ufe,ufe,ufe,ufe],[ufe,cfe,lfe,cfe,lfe,cfe,ufe,ufe]],1),[new rfe(0,7)],$localize(fc||(fc=_g(["Congratulations!"]))),$localize(hc||(hc=_g(["Lower and more to the left, please."])))),_te.informational($localize(dc||(dc=_g(["Passing a turn"]))),$localize(vc||(vc=_g(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new nfe([[lfe,cfe,cfe,cfe,cfe,cfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[cfe,lfe,lfe,lfe,lfe,lfe,lfe,cfe],[lfe,lfe,lfe,lfe,lfe,lfe,ufe,ufe],[cfe,cfe,cfe,cfe,cfe,cfe,ufe,ufe]],60))]});function hfe(e,t){if(1&e&&(cC(),nS(0,"circle",4)),2&e){var n=fS().index,r=fS().index,i=fS();XE("ngClass",i.getPieceClass(n,r)),$E("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function dfe(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",2),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),tS(),YE(2,hfe,1,4,"circle",3),tS()}if(2&e){var r=t.index,i=fS().index,a=fS();pb(1),vS("id","click_",r,"_",i,""),XE("ngClass",a.getRectClasses(r,i)),$E("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pb(1),XE("ngIf",a.board[i][r]!==a.EMPTY)}}function vfe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,dfe,3,8,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var pfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY=M7.NONE,r.lastMove=new qee(-2,-2),r.captureds=[],r.scores=fB.of([2,2]),r.rules=new ofe(nfe),r.availableMinimaxes=[new sfe(r.rules,"ReversiMinimax")],r.encoder=rfe.encoder,r.tutorial=(new ffe).tutorial,r.canPass=!1,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new rfe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new qee(-2,-2),this.scores=fB.of(e.countScore()),this.canPass=ofe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=Gg(Hee.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(nfe.BOARD_WIDTH,nfe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new qee(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(f7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(rfe.PASS.coord.x,rfe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(rne);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-reversi"]],features:[RE],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,vfe,2,1,"g",1),tS()),2&e&&($E("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),pb(1),XE("ngForOf",t.board))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),gfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){var e=Yee.UNREACHABLE,t=Yee.ZERO,r=Yee.ONE,i=Yee.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(ere);return e.HEIGHT=6,e.WIDTH=11,e}(),yfe=function(){var e=Wg(function e(){Zg(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(pc||(pc=_g(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(gc||(gc=_g(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(yc||(yc=_g(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(mc||(mc=_g(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(kc||(kc=_g(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Cc||(Cc=_g(["Those two spaces have no intermediary neighbor."])))},e}(),mfe=function(e){Mg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return o7.failure(tte.MOVE_CANNOT_BE_STATIC());if(1===n){var r=Jne.getFakeNeighbors(e);if(t.equals(r))return o7.failure(yfe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return o7.failure($localize(wc||(wc=_g(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return o7.failure(yfe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return o7.failure(yfe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return o7.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(gfe.WIDTH,gfe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(gfe.WIDTH,gfe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():r7.success(new n(e,t))}}]),n}(dne);mfe.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 396*gfe.WIDTH+66*gfe.HEIGHT+6*gfe.WIDTH+gfe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,mfe.from(new qee(e/=6,r),new qee(n,t)).get()}}]),n}(R7));var kfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=Yee.EMPTY,new gfe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return r7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==Yee.EMPTY)return r7.failure(tte.MUST_LAND_ON_EMPTY_SPACE());var n=Jne.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===Yee.EMPTY?r7.success(void 0):r7.failure(yfe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):r7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,N7.ZERO),i=n.getBoardValuesFor(t,N7.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<gfe.HEIGHT;r++)for(var i=0;i<gfe.WIDTH;i++)e[r][i].is(t)&&n.push(new qee(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Gg(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=ere.getEmptyNeighbors(e,o,Yee.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?yte.ONE_WON:0===t[0]?yte.ZERO_WON:yte.ONGOING}}]),n}(mte);return e.VERBOSE=!1,e}(),Cfe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Gg(kfe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Gg(ere.getEmptyNeighbors(r,s,Yee.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=mfe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=Yee.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=Gg(ere.getEmptyNeighbors(r,c,Yee.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=mfe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=Yee.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=Yee.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=Yee.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=kfe.getBoardValuesFor(t,N7.ZERO),r=kfe.getBoardValuesFor(t,N7.ONE),i=kfe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return rte.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new rte(r[a%6]-n[a%6])}}]),n}(nte),wfe=Yee.UNREACHABLE,_fe=Yee.ZERO,bfe=Yee.ONE,Efe=Yee.EMPTY,Sfe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(_c||(_c=_g(["Initial board"]))),$localize(bc||(bc=_g(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),gfe.getInitialState()),_te.informational($localize(Ec||(Ec=_g(["Goal of the game"]))),$localize(Sc||(Sc=_g(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new gfe([[wfe,wfe,Efe,Efe,bfe,Efe,Efe,_fe,bfe,wfe,wfe],[wfe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,wfe],[bfe,_fe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,_fe],[_fe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,bfe],[wfe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,Efe,wfe],[wfe,wfe,bfe,_fe,Efe,Efe,Efe,bfe,_fe,wfe,wfe]],3)),_te.fromPredicate($localize(Pc||(Pc=_g(["Simple step"]))),$localize(Oc||(Oc=_g(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),gfe.getInitialState(),mfe.from(new qee(2,0),new qee(2,1)).get(),function(e,t){return e.isSimpleStep()?o7.SUCCESS:o7.failure($localize(Tc||(Tc=_g(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ic||(Ic=_g(["Congratulations!"])))),_te.fromPredicate($localize(Ac||(Ac=_g(["Double step"]))),$localize(Rc||(Rc=_g(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),gfe.getInitialState(),mfe.from(new qee(7,0),new qee(5,0)).get(),function(e,t){return e.isSimpleStep()?o7.failure($localize(xc||(xc=_g(["Failed! You have made a single step."])))):o7.SUCCESS},$localize(Mc||(Mc=_g(["Congratulations!"]))))]});function Pfe(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"polyline",6),tS()),2&e){var n=fS().index,r=fS().index,i=fS();pb(1),XE("ngClass",i.getPlayerClassFor(n,r)),$E("points",i.getPyramidCoordinate(n,r))}}function Ofe(e,t){if(1&e&&(cC(),nS(0,"polyline",9)),2&e){var n=fS(2).index,r=fS().index;$E("points",fS().getTriangleCoordinate(n,r))}}function Tfe(e,t){if(1&e&&(cC(),nS(0,"polyline",10)),2&e){var n=fS(2).index,r=fS().index;$E("points",fS().getTriangleCoordinate(n,r))}}function Ife(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Ofe,1,1,"polyline",7),YE(2,Tfe,1,1,"polyline",8),tS()),2&e){var n=fS().index,r=fS().index;pb(1),XE("ngIf",(n+r)%2==1),pb(1),XE("ngIf",(n+r)%2==0)}}function Afe(e,t){if(1&e){var n=aS();cC(),eS(0,"g",5),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),YE(1,Pfe,2,2,"g",2),YE(2,Ife,3,2,"g",2),tS()}if(2&e){var r=t.$implicit;vS("id","click_",t.index,"_",fS().index,""),pb(1),XE("ngIf",r.isPlayer()),pb(1),XE("ngIf",2===r.value)}}function Rfe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Afe,3,4,"g",4),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function xfe(e,t){if(1&e&&(cC(),rS(0),nS(1,"polyline",11),nS(2,"polyline",11),iS()),2&e){var n=fS();pb(1),$E("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),pb(1),$E("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Mfe(e,t){if(1&e&&(cC(),nS(0,"polyline",12)),2&e){var n=fS();$E("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var Nfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastCoord=fB.empty(),r.lastMoved=fB.empty(),r.chosenCoord=fB.empty(),r.rules=new kfe(gfe),r.availableMinimaxes=[new Cfe(r.rules,"SaharaMinimax")],r.encoder=mfe.encoder,r.tutorial=(new Sfe).tutorial,r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===Yee.EMPTY?this.cancelMove(yfe.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=fB.of(new qee(e,t)),o7.SUCCESS):this.cancelMove(yfe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new qee(e,t),a=n.rules.node.gameState.getCurrentPlayer(),o=Yee.ofPlayer(a),n.board[t][e]!==o){r.next=3;break}return r.abrupt("return",(n.chosenCoord=fB.of(new qee(e,t)),o7.SUCCESS));case 3:if(!(s=mfe.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=fB.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(N7.of(this.board[t][e].value))}}]),n}(Yne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-sahara"]],features:[RE],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Rfe,2,1,"g",1),YE(2,xfe,3,2,"ng-container",2),YE(3,Mfe,1,1,"polyline",3),tS()),2&e&&(pb(1),XE("ngForOf",t.board),pb(1),XE("ngIf",t.lastMoved.isPresent()),pb(1),XE("ngIf",t.chosenCoord.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Dfe=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return Wg(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(lte);Dfe.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?fB.empty():$ee.factory.fromInt(r).toOptional();e-=r;var a=$ee.factory.fromInt(e/=5).get();return new Dfe(n-1,t-1,i,a)}}]),n}(R7));var Lfe=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"belongTo",value:function(e){return e===N7.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?N7.ZERO:5<=this.value&&this.value<=8?N7.ONE:M7.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return fB.empty();case 1:case 5:return fB.of($ee.UP);case 2:case 6:return fB.of($ee.RIGHT);case 3:case 7:return fB.of($ee.DOWN);case 4:case 8:return fB.of($ee.LEFT);default:return oB.expectToBe(this.value,9),fB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return oB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===N7.ZERO?t===$ee.UP?e.LIGHT_UP:t===$ee.RIGHT?e.LIGHT_RIGHT:t===$ee.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===$ee.UP?e.DARK_UP:t===$ee.RIGHT?e.DARK_RIGHT:t===$ee.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();Lfe.EMPTY=new Lfe(0),Lfe.LIGHT_UP=new Lfe(1),Lfe.LIGHT_RIGHT=new Lfe(2),Lfe.LIGHT_DOWN=new Lfe(3),Lfe.LIGHT_LEFT=new Lfe(4),Lfe.DARK_UP=new Lfe(5),Lfe.DARK_RIGHT=new Lfe(6),Lfe.DARK_DOWN=new Lfe(7),Lfe.DARK_LEFT=new Lfe(8),Lfe.MOUNTAIN=new Lfe(9);var Ffe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=U7.createTable(5,5,Lfe.EMPTY);return e[2][1]=Lfe.MOUNTAIN,e[2][2]=Lfe.MOUNTAIN,e[2][3]=Lfe.MOUNTAIN,new n(e,0)}}]),n}(ste),Ufe=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Nc||(Nc=_g(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Dc||(Dc=_g(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Lc||(Lc=_g(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(Fc||(Fc=_g(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(Uc||(Uc=_g(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=function(){return $localize(Vc||(Vc=_g(["You should insert or choose one of your pieces!"])))},e}(),Vfe=Wg(function e(t,n){Zg(this,e),this.resultingBoard=t,this.moved=n}),Bfe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){if(sB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return r7.failure(tte.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return sB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){sB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return r7.failure(i.legal.getReason());r=i.insertedPiece}else sB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?o7.SUCCESS:o7.failure(Ufe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){sB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return r7.failure(Ufe.ILLEGAL_ROTATION());var o=t.getCopiedBoard();return o[r.y][r.x]=Lfe.of(e.landingOrientation,a),r7.success(new Vfe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=U7.copyBiArray(n.resultingBoard);return new Ffe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?yte.getVictory(r):yte.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Lfe.of(-1===e.x?$ee.RIGHT:-1===e.y?$ee.DOWN:5===e.x?$ee.LEFT:$ee.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){sB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Lfe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Lfe.EMPTY&&!1===n.isStraight(r,e))return sB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),r7.failure(Ufe.ILLEGAL_PUSH());var u=fB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=Lfe.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==Lfe.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,sB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===Lfe.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==Lfe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(sB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(sB(n.VERBOSE,"This move is an illegal push: "+f),r7.failure(Ufe.NOT_ENOUGH_FORCE_TO_PUSH())):(sB(n.VERBOSE,"This move is a legal push: "+f),r7.success(new Vfe(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===N7.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,f=t.getCurrentPlayer(),h=Gg(u);try{for(h.s();!(s=h.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(N7.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):f===N7.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){h.e(v)}finally{h.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,f)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Lfe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):M7.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return sB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Lfe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){sB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Gg(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=$ee.DOWN,l=new qee(u,4);o.push({direction:c,fallingCoord:l}),c=$ee.UP,l=new qee(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=Gg(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=$ee.LEFT,p=new qee(0,d);o.push({direction:v,fallingCoord:p}),v=$ee.RIGHT,p=new qee(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return sB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){sB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=fB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===Lfe.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=fB.of(s),o!==Lfe.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countPlayerPawn())||f>0?fB.empty():fB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Dfe(-1,a,fB.of($ee.RIGHT),$ee.RIGHT)),i.push(Lfe.of($ee.RIGHT,n)),r.push(new Dfe(5,a,fB.of($ee.LEFT),$ee.LEFT)),i.push(Lfe.of($ee.LEFT,n)),r.push(new Dfe(a,-1,fB.of($ee.DOWN),$ee.DOWN)),i.push(Lfe.of($ee.DOWN,n)),r.push(new Dfe(a,5,fB.of($ee.UP),$ee.UP)),i.push(Lfe.of($ee.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),a=1;a<=3;a++)t=new Dfe(-1,a,fB.of($ee.RIGHT),$ee.UP),n=Lfe.of($ee.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Dfe(-1,a,fB.of($ee.RIGHT),$ee.DOWN),n=Lfe.of($ee.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Dfe(5,a,fB.of($ee.LEFT),$ee.UP),n=Lfe.of($ee.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Dfe(5,a,fB.of($ee.LEFT),$ee.DOWN),n=Lfe.of($ee.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var o=1;o<=3;o++)t=new Dfe(o,-1,fB.of($ee.DOWN),$ee.LEFT),n=Lfe.of($ee.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Dfe(o,-1,fB.of($ee.DOWN),$ee.RIGHT),n=Lfe.of($ee.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Dfe(o,5,fB.of($ee.UP),$ee.LEFT),n=Lfe.of($ee.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Dfe(o,5,fB.of($ee.UP),$ee.RIGHT),n=Lfe.of($ee.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new qee(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(mte);return e.VERBOSE=!1,e}(),zfe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){return new rte(Bfe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var a=0;a<5;a++)if((t=e.gameState.getPieceAtXY(a,i)).belongTo(r)){var o,s=t.getDirection(),u=Gg($ee.ORTHOGONALS);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c!==s){var l=e.gameState.getCopiedBoard(),f=new Dfe(a,i,fB.empty(),c);l[i][a]=Lfe.of(c,r),n.push(f)}var h,d=Gg(new qee(a+c.x,i+c.y).isInRange(5,5)?$ee.ORTHOGONALS:[c]);try{for(d.s();!(h=d.n()).done;){var v=h.value,p=new Dfe(a,i,fB.of(c),v);Bfe.isLegalForwarding(p,e.gameState,t).isSuccess()&&n.push(p)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(Bfe.getPushingInsertions(e))).concat(Bfe.getDerapingInsertions(e))),sB(Bfe.VERBOSE,{getListMovesResult:n}),n}}]),n}(nte),Gfe=Lfe.EMPTY,Hfe=Lfe.MOUNTAIN,$fe=Lfe.LIGHT_UP,Zfe=Lfe.LIGHT_LEFT,qfe=Lfe.LIGHT_RIGHT,Wfe=Lfe.LIGHT_DOWN,jfe=Lfe.DARK_UP,Yfe=Lfe.DARK_LEFT,Kfe=Lfe.DARK_RIGHT,Qfe=Lfe.DARK_DOWN,Xfe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Bc||(Bc=_g(["Goal of the game"]))),$localize(zc||(zc=_g(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Ffe.getInitialState()),_te.anyMove($localize(Gc||(Gc=_g(["Inserting a piece"]))),$localize(Hc||(Hc=_g(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Ffe.getInitialState(),new Dfe(2,-1,fB.of($ee.DOWN),$ee.DOWN),$localize($c||($c=_g(["Congratulations!"])))),_te.fromMove($localize(Zc||(Zc=_g(["Moving a piece"]))),$localize(qc||(qc=_g(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Ffe([[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Hfe,Hfe,Hfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,$fe,Gfe,Gfe]],0),[new Dfe(2,4,fB.of($ee.UP),$ee.DOWN)],$localize(Wc||(Wc=_g(["Congratulations, you made a side-slip!"]))),$localize(jc||(jc=_g(["Failed!"])))),_te.fromMove($localize(Yc||(Yc=_g(["Moving a piece out of the board"]))),$localize(Kc||(Kc=_g(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Ffe([[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Hfe,Hfe,Hfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,$fe,Gfe,Gfe]],0),[new Dfe(2,4,fB.of($ee.DOWN),$ee.DOWN)],$localize(Qc||(Qc=_g(["Congratulations, even if in this context it was not a useful move."]))),$localize(Xc||(Xc=_g(["Failed, the piece is still on the board."])))),_te.fromMove($localize(Jc||(Jc=_g(["Pushing"]))),$localize(el||(el=_g(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Ffe([[qfe,Hfe,Hfe,Yfe,Zfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,Gfe,Hfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,Kfe,Yfe,Zfe]],0),[new Dfe(4,4,fB.of($ee.LEFT),$ee.LEFT)],$localize(tl||(tl=_g(["Congratulations!"]))),$localize(nl||(nl=_g(["Failed!"])))),_te.fromMove($localize(rl||(rl=_g(["Victory"]))),$localize(il||(il=_g(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Ffe([[Gfe,Gfe,Gfe,Gfe,Gfe],[Gfe,Gfe,Gfe,Gfe,Gfe],[Hfe,jfe,Zfe,Gfe,Wfe],[Gfe,Gfe,Gfe,Gfe,Qfe],[Gfe,Gfe,Gfe,Gfe,Hfe]],0),[new Dfe(2,2,fB.of($ee.LEFT),$ee.LEFT)],$localize(al||(al=_g(["Congratulations, you won!"]))),$localize(ol||(ol=_g(["Failed, you lost."]))))]});function Jfe(e,t){if(1&e){var n=aS();cC(),eS(0,"use",7),uS("click",function(){var e=Nk(n).$implicit;return fS(3).insertAt(e.x,e.y)}),tS()}if(2&e){var r=t.$implicit,i=fS(3);vS("id","insertAt_",r.x,"_",r.y,""),$E("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var ehe=function(e,t){return{dir:"DOWN",x:e,y:t}},the=function(e){return{dir:"UP",x:e,y:5}},nhe=function(e,t){return{dir:"RIGHT",x:e,y:t}},rhe=function(e){return{dir:"LEFT",x:5,y:e}},ihe=function(e,t,n,r){return[e,t,n,r]};function ahe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Jfe,1,3,"use",6),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=HE(e,t,n,r);return HE(e,t+2,i,a)||o}(e,c,i,a,o,s)?zE(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):uT(e,c+4)}(xk(),Hk(),e,t,n,r,i,a,o)}(11,ihe,sT(1,ehe,n,-1),oT(4,the,n),sT(6,nhe,-1,n),oT(9,rhe,n)))}}var ohe=function(){return[0,1,2,3,4]};function she(e,t){1&e&&(cC(),rS(0),YE(1,ahe,2,16,"g",5),iS()),2&e&&(pb(1),XE("ngForOf",aT(1,ohe)))}function uhe(e,t){if(1&e){var n=aS();cC(),eS(0,"use",13),uS("click",function(){var e=Nk(n).$implicit;return fS(5).chooseDirection(e)}),tS()}if(2&e){var r=t.$implicit,i=fS(3).index,a=fS().index,o=fS();dS("id","chooseDirection_",r,""),$E("transform",o.getArrowTransform(i+1,a+1,r))}}var che=function(){return["RIGHT","DOWN","LEFT","UP"]};function lhe(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"circle",11),uS("click",function(){return Nk(n),fS(4).chooseDirection("")}),tS(),YE(2,uhe,1,2,"use",12),tS()}if(2&e){var r=fS(2).index,i=fS().index,a=fS();pb(1),$E("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),pb(1),XE("ngForOf",aT(3,che))}}function fhe(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"use",10),uS("click",function(){Nk(n);var e=fS().index,t=fS().index;return fS().clickPiece(e,t)}),tS(),YE(2,lhe,3,4,"g",4),tS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();pb(1),vS("id","clickPiece_",i,"_",o,""),XE("ngClass",s.getPieceClasses(a)),$E("transform",s.getPieceTransform(i,o)),pb(1),XE("ngIf",s.choosingDirection(i,o))}}function hhe(e,t){if(1&e&&(cC(),nS(0,"use",14)),2&e){var n=fS().index,r=fS().index,i=fS();$E("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function dhe(e,t){if(1&e){var n=aS();cC(),eS(0,"use",13),uS("click",function(){var e=Nk(n).$implicit;return fS(4).chooseOrientation(e)}),tS()}if(2&e){var r=t.$implicit,i=fS(2).index,a=fS().index,o=fS();dS("id","chooseOrientation_",r,""),$E("transform",o.getArrowTransform(i+1,a+1,r))}}function vhe(e,t){1&e&&(cC(),eS(0,"g"),YE(1,dhe,1,2,"use",12),tS()),2&e&&(pb(1),XE("ngForOf",aT(1,che)))}function phe(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",8),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().insertAt(e,t)}),tS(),YE(2,fhe,3,5,"g",4),YE(3,hhe,1,1,"use",9),YE(4,vhe,2,2,"g",4),tS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pb(1),vS("id","insertAt_",i,"_",a,""),XE("ngClass",o.getSquareClasses(i,a)),$E("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pb(1),XE("ngIf",r.isPiece()),pb(1),XE("ngIf",o.isMountain(r)),pb(1),XE("ngIf",o.choosingOrientation(i,a))}}function ghe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,phe,5,10,"g",5),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var yhe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosenCoord=fB.empty(),r.landingCoord=fB.empty(),r.chosenDirection=fB.empty(),r.chosenOrientation=fB.empty(),r.movedPieces=[],r.rules=new Bfe(Ffe),r.availableMinimaxes=[new zfe(r.rules,"SiamMinimax")],r.encoder=Dfe.encoder,r.tutorial=(new Xfe).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){if(sB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenDirection=fB.empty(),this.landingCoord=fB.empty(),this.chosenOrientation=fB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(tte.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=fB.of(new qee(e,t)),o7.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=fB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=$ee.factory.fromString(e).get(),t.chosenDirection=fB.of(a),t.landingCoord=fB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return sB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=fB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",o7.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=fB.of($ee.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Ufe.CANNOT_INSERT_WHEN_SELECTED()));case 6:if(o=new qee(e,t),!r.getState().isOnBoard(o)||!r.getState().getPieceAtXY(e,t).isEmptyOrMountain()){i.next=9;break}return i.abrupt("return",r.cancelMove(Ufe.MUST_INSERT_OR_CHOOSE_YOUR_PIECE()));case 9:return r.chosenCoord=fB.of(o),s=Bfe.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=fB.of(s),r.landingCoord=fB.of(r.chosenCoord.get().getNext(s)),o7.SUCCESS));case 12:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Dfe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Lfe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new qee(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new qee(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*($ee.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return qle.getArrowTransform(this.SPACE_SIZE,new qee(e,t),$ee.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new qee(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(rne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-siam"]],features:[RE],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),eS(1,"defs"),nS(2,"polygon",1),nS(3,"polygon",2),nS(4,"polygon",3),tS(),YE(5,she,2,2,"ng-container",4),YE(6,ghe,2,1,"g",5),tS()),2&e&&(pb(5),XE("ngIf",t.isPlayerTurn()),pb(1),XE("ngForOf",t.board))},directives:[UA,LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),mhe=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(sl||(sl=_g(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(ul||(ul=_g(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(cl||(cl=_g(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(ll||(ll=_g(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(fl||(fl=_g(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(hl||(hl=_g(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(dl||(dl=_g(["You must put this piece next to another piece."])))},e}(),khe=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;Zg(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return Wg(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Gg(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new vte,u=new Bee(-t,-r);if(0!==t||0!==r){var c,l=Gg(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=U7.createTable(this.width,this.height,M7.NONE.value),n=Gg(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?o7.failure(tte.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?o7.SUCCESS:o7.failure(mhe.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Gg(Kee.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():M7.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new vte;if(t.size()>0){i=new vte;var a,o=Gg(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(N7.ZERO).getOrElse(new Tne),n=e.get(N7.ONE).getOrElse(new Tne);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);l7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[N7.ZERO.value],[N7.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new vte,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==M7.NONE.value&&i.set(new qee(o,a),N7.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new vte,a=0,o=Gg(Kee.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new ate,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Gg(Kee.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(ote),Che=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return Lg(a)}return Wg(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(fB.empty(),e,fB.empty())}},{key:"fromMovement",value:function(e,t){return new n(fB.of(e),t,fB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(fB.of(e),t,fB.of(r))}}]),n}(cte);Che.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?qee.encoder.encode(e.start.get()):null,landing:qee.encoder.encode(e.landing),keep:e.keep.isPresent()?qee.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=qee.encoder.decode(t.landing);if(null==t.start)return Che.fromDrop(n);var r=qee.encoder.decode(t.start);if(null==t.keep)return Che.fromMovement(r,n);var i=qee.encoder.decode(t.keep);return Che.fromCut(r,n,i)}}]),n}(A7));var whe=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?r7.failure(mhe.NO_MOVEMENT_BEFORE_TURN_40()):r7.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return yte.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?yte.ONE_WON:o<a?yte.ZERO_WON:yte.DRAW:a<6?yte.getDefeat(N7.ZERO):o<6?yte.getDefeat(N7.ONE):yte.ONGOING}return yte.ONGOING}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Kee.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(Kee.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=Kee.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=Kee.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Tne,r=Gg(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Gg(Kee.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===M7.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return r7.failure(mhe.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case M7.NONE:return r7.failure(tte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return r7.failure(tte.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=khe.deplacePiece(t,e),i=khe.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?r7.failure(mhe.CANNOT_CHOOSE_TO_KEEP()):r7.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return r7.success(new Tne)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new ate,i=Gg(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new ate([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return r7.failure(mhe.MUST_CUT());if(n.get(e.get()).isAbsent())return r7.failure(mhe.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return r7.success(o)}}catch(s){a.e(s)}finally{a.f()}return r7.failure(mhe.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(mte),_he=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:hte.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===hte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===hte.VICTORY)return r;n={status:r.status,victory:fB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(nte),bhe=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return Wg(n)}(rte),Ehe=function(e){Mg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Wg(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=whe.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){sB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=Che.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Gg(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Che.fromMovement(s,c);if(e.isCoordConnected(c,fB.of(s))){var f=khe.deplacePiece(e,l),h=khe.getGroups(f,l.start.get());if(whe.isSplit(h)){var d,v=Gg(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=Che.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Gg(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Tne(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=Che.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===hte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Che.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:hte.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=fB.empty();if(a.status===hte.DEFAULT&&a.preVictory.isPresent()&&(o=fB.of(a.preVictory.get())),a.status===hte.VICTORY)return new bhe(i,fB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new bhe(u<c?N7.ONE.getVictoryValue():c<u?N7.ZERO.getVictoryValue():0,fB.empty()):u<6?new bhe(N7.ZERO.getDefeatValue(),fB.empty()):c<6?new bhe(N7.ONE.getDefeatValue(),fB.empty()):new bhe(u-c,o)}return new bhe(a.status===hte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Kee.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:hte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(Kee.factory.all[o],1)}return{status:hte.VICTORY,victory:fB.of(i),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:hte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:hte.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:hte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.length%2==0&&(i=Kee.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:hte.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Kee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:hte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.push(o),a.length%2==0&&(i=Kee.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:hte.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(Kee.factory.all[e],1),s=0,u=fB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=Kee.factory.all[l];c===M7.NONE?(s+=.16,u=fB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(sB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:hte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};i=t}else if(5===e)return{status:hte.VICTORY,victory:fB.of(n),preVictory:fB.empty(),sum:0};return{status:r.status,victory:fB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=Kee.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=fB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:hte.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0};5.16===p&&f===hte.DEFAULT&&(h.isPresent()?(f7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=hte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:fB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),fB.empty();case M7.NONE:return n.push(.16),fB.of(t);default:return n.push(1),fB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Kee.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===M7.NONE?(u+=.16,c=fB.of(s)):u++,o.length%2==0&&(a=Kee.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Kee.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===M7.NONE?(u+=.16,c=fB.of(s)):u++,o.push(s),o.length%2==0&&(a=Kee.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new whe(khe);n.singleton=fB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(_he);Ehe.singleton=fB.empty();var She=M7.NONE.value,Phe=N7.ZERO.value,Ohe=N7.ONE.value,The=function(){var e=Wg(function e(){Zg(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(vl||(vl=_g(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(pl||(pl=_g(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),Ihe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(gl||(gl=_g(["Six"]))),$localize(yl||(yl=_g(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),khe.getInitialState()),_te.fromMove($localize(ml||(ml=_g(["Victory (line)"]))),$localize(kl||(kl=_g(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),khe.fromRepresentation([[Phe,Ohe,Ohe,Ohe,Ohe,Phe],[She,Phe,Ohe,She,Phe,She],[Ohe,Ohe,Phe,She,She,She],[She,She,Phe,She,She,She],[She,Phe,She,She,She,She],[Phe,She,She,She,She,She]],0),[Che.fromDrop(new qee(3,2))],$localize(Cl||(Cl=_g(["Congratulations!"]))),$localize(wl||(wl=_g(["Failed!"])))),_te.fromMove($localize(_l||(_l=_g(["Victory (circle)"]))),$localize(bl||(bl=_g(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),khe.fromRepresentation([[She,She,She,Ohe,She,She],[She,She,Ohe,Ohe,Phe,Phe],[She,Ohe,She,Phe,Ohe,She],[Ohe,Phe,Phe,Phe,Phe,Ohe]],0),[Che.fromDrop(new qee(5,2))],$localize(El||(El=_g(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(Sl||(Sl=_g(["Failed!"])))),_te.fromMove($localize(Pl||(Pl=_g(["Victory (triangle)"]))),$localize(Ol||(Ol=_g(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),khe.fromRepresentation([[She,She,She,Ohe,She,She],[She,Phe,Ohe,Phe,Phe,Phe],[She,Phe,She,Phe,Phe,She],[Ohe,Ohe,Ohe,She,Ohe,She]],0),[Che.fromDrop(new qee(3,3))],$localize(Tl||(Tl=_g(["Congratulations!"]))),$localize(Il||(Il=_g(["Failed!"])))),_te.fromPredicate($localize(Al||(Al=_g(["Second phase"]))),$localize(Rl||(Rl=_g(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),khe.fromRepresentation([[She,She,She,She,She,She,She,Ohe,She],[She,She,She,She,She,She,Phe,She,She],[She,She,She,She,Phe,Phe,Phe,She,She],[She,She,She,She,Ohe,Ohe,She,Ohe,Phe],[She,Phe,Ohe,Ohe,Phe,Phe,Ohe,She,She],[Phe,Phe,Phe,Phe,Ohe,Ohe,Ohe,Phe,She],[Ohe,Ohe,Phe,She,Ohe,Ohe,Phe,She,She],[She,Phe,She,Phe,Phe,She,She,She,She],[Ohe,Ohe,Ohe,Ohe,She,She,She,She,She],[She,Phe,She,Ohe,She,She,She,She,She]],40),Che.fromMovement(new qee(6,1),new qee(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?o7.SUCCESS:o7.failure(The.MOVEMENT_NOT_DISCONNECTING()):o7.failure(The.MOVEMENT_SELF_DISCONNECTING())},$localize(xl||(xl=_g(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),_te.fromPredicate($localize(Ml||(Ml=_g(["Victory by disconnection"]))),$localize(Nl||(Nl=_g(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),khe.fromRepresentation([[She,She,She,She,She,Ohe],[She,She,She,She,Phe,Ohe],[She,She,She,Ohe,Phe,Phe],[She,She,Phe,She,Ohe,Phe],[Ohe,Ohe,She,She,She,Phe],[Phe,Ohe,She,She,She,She],[Phe,She,She,She,She,She]],40),Che.fromMovement(new qee(2,3),new qee(3,3)),function(e,t){return e.start.equalsValue(new qee(2,3))?o7.SUCCESS:o7.failure(The.MOVEMENT_NOT_DISCONNECTING())},$localize(Dl||(Dl=_g(["Congratulations, you won!"])))),_te.fromPredicate($localize(Ll||(Ll=_g(["Special disconnection"]))),$localize(Fl||(Fl=_g(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),khe.fromRepresentation([[She,She,She,She,She,Ohe],[She,She,She,She,Phe,Ohe],[She,She,She,Ohe,Phe,Phe],[Phe,She,Phe,She,She,Ohe],[Ohe,Ohe,She,She,She,She],[Phe,Phe,She,She,She,She],[Phe,She,She,She,She,She]],40),Che.fromCut(new qee(2,3),new qee(2,5),new qee(2,5)),function(e,t){return e.keep.isAbsent()?o7.failure($localize(Ul||(Ul=_g(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===M7.NONE?o7.failure($localize(Vl||(Vl=_g(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):o7.SUCCESS},$localize(Bl||(Bl=_g(["Congratulations, you won!"]))))]});function Ahe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",10),uS("click",function(){var e=Nk(n).$implicit;return fS().onPieceClick(e)}),tS()}if(2&e){var r=t.$implicit,i=fS();vS("id","piece_",r.x,"_",r.y,""),XE("ngClass",i.getPieceClass(r)),$E("points",i.getHexaCoordsAt(r))}}function Rhe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",11),uS("click",function(){var e=Nk(n).$implicit;return fS().onNeighborClick(e)}),tS()}if(2&e){var r=t.$implicit,i=fS();vS("id","neighbor_",r.x,"_",r.y,""),$E("points",i.getHexaCoordsAt(r))}}function xhe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",10),uS("click",function(){Nk(n);var e=fS();return e.onPieceClick(e.chosenLanding.get())}),tS()}if(2&e){var r=fS();vS("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),XE("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),$E("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Mhe(e,t){if(1&e&&(cC(),nS(0,"polyline",12)),2&e){var n=t.$implicit,r=fS();vS("id","disconnected_",n.x,"_",n.y,""),$E("points",r.getHexaCoordsAt(n))}}function Nhe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",13),uS("click",function(){Nk(n);var e=fS();return e.onNeighborClick(e.leftCoord.get())}),tS()}if(2&e){var r=fS();vS("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),$E("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Dhe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",14),uS("click",function(){Nk(n);var e=fS();return e.onPieceClick(e.lastDrop.get())}),tS()}if(2&e){var r=fS();vS("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),$E("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Lhe(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",15),uS("click",function(){Nk(n);var e=fS();return e.onPieceClick(e.selectedPiece.get())}),tS()}if(2&e){var r=fS();vS("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),XE("ngClass",r.getSelectedPieceClass()),$E("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Fhe(e,t){if(1&e&&(cC(),nS(0,"polyline",16)),2&e){var n=t.$implicit,r=fS();vS("id","victoryCoord_",n.x,"_",n.y,""),$E("points",r.getHexaCoordsAt(n))}}function Uhe(e,t){if(1&e){var n=aS();cC(),eS(0,"g",19),uS("click",function(){var e=Nk(n).$implicit;return fS(2).onPieceClick(e)}),nS(1,"polyline",20),tS()}if(2&e){var r=t.$implicit,i=fS(2);pb(1),vS("id","cuttable_",r.x,"_",r.y,""),$E("points",i.getHexaCoordsAt(r))}}function Vhe(e,t){if(1&e&&(cC(),eS(0,"g",17),YE(1,Uhe,2,3,"g",18),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var Bhe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=fB.empty(),r.lastDrop=fB.empty(),r.selectedPiece=fB.empty(),r.chosenLanding=fB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new whe(khe),r.availableMinimaxes=[new Ehe(r.rules,"SixMinimax")],r.encoder=Che.encoder,r.tutorial=(new Ihe).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new Qee(1.5*r.SPACE_SIZE,new qee(2*r.SPACE_SIZE,0),ete.INSTANCE),r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.chosenLanding=fB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=fB.empty(),this.lastDrop=fB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Gg(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Gg(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=fB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?fB.of(e.start.get().getNext(this.state.offset,1)):fB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=Gg(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=whe.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(mhe.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(tte.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=fB.of(e),o7.SUCCESS));case 7:return i=Che.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(mhe.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(Che.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(mhe.CAN_NO_LONGER_DROP()));case 9:return i=Che.fromMovement(t.selectedPiece.get(),e),a=whe.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=fB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,o7.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===mhe.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=Che.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=khe.deplacePiece(this.state,e),n=khe.getGroups(t,e.start.get()),r=whe.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Gg(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(jee);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-six"]],features:[RE],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Ahe,1,4,"polyline",1),YE(2,Rhe,1,3,"polyline",2),YE(3,xhe,1,4,"polyline",3),YE(4,Mhe,1,3,"polyline",4),YE(5,Nhe,1,3,"polyline",5),YE(6,Dhe,1,3,"polyline",6),YE(7,Lhe,1,4,"polyline",7),YE(8,Fhe,1,3,"polyline",8),YE(9,Vhe,2,1,"g",9),tS()),2&e&&($E("viewBox",t.viewBox),pb(1),XE("ngForOf",t.pieces),pb(1),XE("ngForOf",t.neighbors),pb(1),XE("ngIf",t.chosenLanding.isPresent()),pb(1),XE("ngForOf",t.disconnecteds),pb(1),XE("ngIf",t.leftCoord.isPresent()),pb(1),XE("ngIf",t.lastDrop.isPresent()),pb(1),XE("ngIf",t.selectedPiece.isPresent()),pb(1),XE("ngForOf",t.victoryCoords),pb(1),XE("ngForOf",t.cuttableGroups))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zhe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return r7.success(r)}catch(r){return r7.failure(r.message)}}}]),n}(pne);zhe.encoder=dne.getEncoder(9,9,zhe.of);var Ghe={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:N7.ZERO},Hhe=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=mne.UNOCCUPIED,t=mne.INVADERS,r=mne.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,mne.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Cne),$he=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Hhe,Ghe,zhe.of)}return Wg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),gte.ruler=this.singleton,n.singleton}}]),n}(_ne),Zhe=mne.UNOCCUPIED,qhe=mne.INVADERS,Whe=mne.DEFENDERS,jhe=mne.PLAYER_ONE_KING,Yhe=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(zl||(zl=_g(["Goal of the game"]))),$localize(Gl||(Gl=_g(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),Hhe.getInitialState()),_te.anyMove($localize(Hl||(Hl=_g(["Moving"]))),$localize($l||($l=_g(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),Hhe.getInitialState(),zhe.of(new qee(4,1),new qee(1,1)),$localize(Zl||(Zl=_g(["Congratulations!"])))),_te.fromMove($localize(ql||(ql=_g(["Capturing a soldier (1/2)"]))),$localize(Wl||(Wl=_g(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Hhe([[Zhe,Zhe,Zhe,qhe,qhe,qhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,qhe,Whe,Zhe,Zhe,Zhe,qhe],[qhe,qhe,Whe,Whe,jhe,Whe,Whe,qhe,qhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,qhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,qhe,qhe,qhe,Zhe,Zhe,Zhe]],1),[zhe.of(new qee(2,4),new qee(2,3)),zhe.of(new qee(4,2),new qee(3,2))],$localize(jl||(jl=_g(["Congratulations, that will teach him a lesson!"]))),$localize(Yl||(Yl=_g(["Failed, you missed an opportunity to capture a piece of the opponent."])))),_te.fromMove($localize(Kl||(Kl=_g(["Capturing a soldier (2/2)"]))),$localize(Ql||(Ql=_g(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Hhe([[Zhe,Zhe,Zhe,qhe,qhe,qhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Whe,Zhe,jhe,Zhe,Whe,Zhe,qhe],[qhe,qhe,Zhe,Whe,Zhe,Whe,Whe,qhe,qhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,qhe],[Zhe,Zhe,Zhe,Zhe,Whe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,qhe,qhe,qhe,Zhe,Zhe,Zhe]],12),[zhe.of(new qee(1,4),new qee(2,4))],$localize(Xl||(Xl=_g(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(Jl||(Jl=_g(["Failed, you did not do the expected move."])))),_te.fromMove($localize(ef||(ef=_g(["Capturing the king (1/2)"]))),$localize(tf||(tf=_g(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new Hhe([[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,qhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[qhe,jhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,qhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe]],72),[zhe.of(new qee(3,4),new qee(2,4))],$localize(nf||(nf=_g(["Congratulations, you won!"]))),$localize(rf||(rf=_g(["Failed, you let the king run away."])))),_te.fromMove($localize(af||(af=_g(["Capturing the king (2/2)"]))),$localize(of||(of=_g(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new Hhe([[Zhe,Zhe,qhe,jhe,qhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,qhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe],[Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe,Zhe]],72),[zhe.of(new qee(3,3),new qee(3,1))],$localize(sf||(sf=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(uf||(uf=_g(["Failed!"]))))]});function Khe(e,t){1&e&&(cC(),nS(0,"polyline",8))}function Qhe(e,t){1&e&&(cC(),nS(0,"polyline",9))}function Xhe(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Khe,1,0,"polyline",6),YE(2,Qhe,1,0,"ng-template",null,7,xT),tS()),2&e){var n=KE(3),r=fS().index,i=fS().index,a=fS();pb(1),XE("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Jhe(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"line",10),nS(2,"line",10),nS(3,"line",10),nS(4,"line",10),nS(5,"line",10),tS()),2&e){var n=fS(2).index,r=fS().index,i=fS();pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ede(e,t){if(1&e&&(cC(),nS(0,"polyline",15)),2&e){var n=fS(3).index,r=fS().index;XE("ngClass",fS().viewInfo.pieceClasses[r][n])}}function tde(e,t){if(1&e&&(cC(),nS(0,"line",10),nS(1,"line",10),nS(2,"line",10),nS(3,"line",10)),2&e){var n=fS(3).index,r=fS().index,i=fS();XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),pb(1),XE("ngClass",i.viewInfo.pieceClasses[r][n]),$E("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function nde(e,t){if(1&e&&(cC(),YE(0,ede,1,1,"polyline",13),YE(1,tde,4,20,"ng-template",null,14,xT)),2&e){var n=KE(2),r=fS(2).index,i=fS().index;XE("ngIf",fS().isKing(r,i))("ngIfElse",n)}}function rde(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",10),YE(2,Jhe,6,25,"g",11),YE(3,nde,3,2,"ng-template",null,12,xT),tS()),2&e){var n=KE(4),r=fS().index,i=fS().index,a=fS();pb(1),XE("ngClass",a.viewInfo.pieceClasses[i][r]),$E("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),pb(1),XE("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function ide(e,t){if(1&e){var n=aS();cC(),eS(0,"g",3),uS("click",function(){var e=Nk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(1,"rect",4),YE(2,Xhe,4,2,"g",5),YE(3,rde,5,6,"g",5),tS()}if(2&e){var r=t.index,i=fS().index,a=fS();vS("id","click_",r,"_",i,""),$E("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),pb(1),XE("ngClass",a.getRectClasses(r,i)),$E("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pb(1),XE("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),pb(1),XE("ngIf",a.board[i][r]!==a.EMPTY)}}function ade(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,ide,4,8,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function ode(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",16),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e.x,e.y)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),vS("id","click_",r.x,"_",r.y,""),$E("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var sde=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,!1,zhe.from)).rules=$he.get(),r.availableMinimaxes=[new Sne(r.rules,"DummyBot"),new Ine(r.rules,"Piece > Influence"),new Ane(r.rules,"Piece > Control"),new Rne(r.rules,"Escape > Piece > Control")],r.encoder=zhe.encoder,r.tutorial=(new Yhe).tutorial,r.updateBoard(),r}return Wg(n)}(Ene);return e.\u0275fac=function(t){return new(t||e)(QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["app-tablut"]],features:[RE],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,ade,2,1,"g",1),YE(2,ode,2,6,"g",1),tS()),2&e&&($E("viewBox",t.getViewBox()),pb(1),XE("ngForOf",t.board),pb(1),XE("ngForOf",t.getClickables()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ude=Wg(function e(){Zg(this,e)});ude.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(cf||(cf=_g(["You cannot put a new ring after the tenth turn."])))},ude.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(lf||(lf=_g(["You cannot put a marker in a ring before placing all of your rings."])))},ude.MISSING_CAPTURES=Mae.MISSING_CAPTURES,ude.MOVE_DIRECTION_INVALID=function(){return $localize(ff||(ff=_g(["The direction of your move is invalid: a move is made along a straight line."])))},ude.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(hf||(hf=_g(["You can only capture your own markers."])))},ude.SHOULD_SELECT_PLAYER_RING=function(){return $localize(df||(df=_g(["You must pick one of your own rings to move."])))},ude.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(vf||(vf=_g(["Your ring must land on an empty space."])))},ude.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(pf||(pf=_g(["A ring can only jump over markers or empty spaces, not over another ring."])))},ude.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(gf||(gf=_g(["Your ring must land on the first empty space after a group of markers."])))},ude.AMBIGUOUS_CAPTURE_COORD=Mae.AMBIGUOUS_CAPTURE_COORD,ude.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(yf||(yf=_g(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var cde=function(){function e(t,n){Zg(this,e),this.player=t,this.isRing=n}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return f7(!1===this.isRing,"cannot flip a ring (it should never happen)"),f7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return oB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===M7.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();cde.encoder=R7.tuple([N7.numberEncoder,R7.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return cde.of(e[0],e[1])}),cde.UNREACHABLE=new cde(M7.NONE,!1),cde.EMPTY=new cde(M7.NONE,!1),cde.MARKER_ZERO=new cde(N7.ZERO,!1),cde.MARKER_ONE=new cde(N7.ONE,!1),cde.MARKERS=[cde.MARKER_ZERO,cde.MARKER_ONE],cde.RING_ZERO=new cde(N7.ZERO,!0),cde.RING_ONE=new cde(N7.ONE,!0),cde.RINGS=[cde.RING_ZERO,cde.RING_ONE];var lde=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],cde.EMPTY)).sideRings=r,a}return Wg(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&U7.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==cde.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=U7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=cde.EMPTY,t=cde.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(die);return e.SIZE=11,e}(),fde=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=fB.ofNullable(r),Lg(i)}return Wg(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===Rg(Vg(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=Kee.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Iae);fde.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return qee.encoder.encode(e)}),ringTaken:qee.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return f7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new fde(t.captured.map(function(e){return qee.encoder.decode(e)}),qee.encoder.decode(t.ringTaken))}}]),n}(I7));var hde=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return Wg(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===U7.compareArray(this.initialCaptures,e.initialCaptures)||!1===U7.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(cte);hde.coordOptionalEncoder=Tae(qee.encoder),hde.encoder=new(function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={moveStart:qee.encoder.encode(e.start),moveEnd:hde.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=fde.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=fde.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return f7(null!=t.moveStart,"Invalid encoded YinshMove"),new hde(this.decodeArray(t,"initialCapture",fde.encoder.decode),qee.encoder.decode(t.moveStart),hde.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",fde.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(A7));var dde=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?rte.fromWinner(t.winner):new rte(e.gameState.sideRings[0]*N7.ZERO.getScoreModifier()+e.gameState.sideRings[1]*N7.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Gg(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Pg(i.value,2),s=o[0];o[1]===cde.EMPTY&&n.push(new hde([],s,fB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new hde(e,r.start,fB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Dae.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return f7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Gg(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new fde(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Gg(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Gg(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===cde.RINGS[t]&&n.push(e)}),n}}]),n}(nte),vde=function(e){Mg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new lde(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new lde(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,cde.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new lde(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,cde.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===cde.RINGS[n]?o7.SUCCESS:o7.failure(ude.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,cde.MARKERS[r]);i=i.setAt(t,cde.RINGS[r]);for(var a=Kee.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==cde.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return r7.failure(ude.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():r7.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return r7.failure(ude.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==cde.EMPTY)return r7.failure(tte.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,cde.of(n,!0)).board,a=new lde(i,r,e.turn);return r7.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==cde.RINGS[n]?o7.failure(ude.SHOULD_SELECT_PLAYER_RING()):o7.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==cde.EMPTY)return o7.failure(ude.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=Kee.factory.fromMove(t,n);if(i.isFailure())return o7.failure(ude.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===cde.EMPTY){if(o)return o7.failure(ude.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return o7.failure(ude.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return o7.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return o7.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Gg(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==cde.MARKERS[r])return o7.failure(ude.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==cde.RINGS[r]?o7.failure(ude.CAPTURE_SHOULD_TAKE_RING()):o7.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?o7.SUCCESS:o7.failure(ude.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?fB.of({start:s,end:r,dir:o}):fB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(fde.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Gg(Kee.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===cde.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?yte.ONGOING:e.gameState.sideRings[0]>=3?yte.ZERO_WON:e.gameState.sideRings[1]>=3?yte.ONE_WON:yte.ONGOING}}]),n}(mte),pde=cde.EMPTY,gde=cde.UNREACHABLE,yde=cde.MARKER_ZERO,mde=cde.RING_ZERO,kde=cde.MARKER_ONE,Cde=cde.RING_ONE,wde=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(mf||(mf=_g(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(kf||(kf=_g(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),_de=Wg(function e(){Zg(this,e),this.tutorial=[_te.informational($localize(Cf||(Cf=_g(["Goal of the game"]))),$localize(wf||(wf=_g(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new lde([[gde,gde,gde,gde,gde,gde,pde,pde,pde,pde,gde],[gde,gde,gde,gde,pde,pde,pde,pde,pde,pde,pde],[gde,gde,gde,yde,Cde,pde,pde,pde,pde,pde,pde],[gde,gde,pde,yde,pde,Cde,pde,kde,pde,pde,pde],[gde,pde,mde,kde,pde,pde,Cde,yde,pde,pde,pde],[gde,pde,pde,yde,kde,pde,pde,pde,pde,pde,gde],[pde,pde,pde,yde,pde,pde,pde,Cde,pde,pde,gde],[pde,pde,pde,kde,yde,mde,pde,pde,pde,gde,gde],[pde,pde,pde,pde,pde,pde,pde,pde,gde,gde,gde],[pde,pde,pde,pde,pde,pde,pde,gde,gde,gde,gde],[gde,pde,pde,pde,pde,gde,gde,gde,gde,gde,gde]],[3,1],20)),_te.anyMove($localize(_f||(_f=_g(["Initial board and placement phase"]))),$localize(bf||(bf=_g(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new lde(lde.getInitialState().board,[5,5],0),new hde([],new qee(5,5),fB.empty(),[]),$localize(Ef||(Ef=_g(["Congratulations!"])))),_te.anyMove($localize(Sf||(Sf=_g(["Putting a marker"]))),$localize(Pf||(Pf=_g(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new lde([[gde,gde,gde,gde,gde,gde,pde,pde,pde,pde,gde],[gde,gde,gde,gde,pde,pde,pde,pde,pde,pde,pde],[gde,gde,gde,Cde,pde,pde,pde,pde,pde,pde,pde],[gde,gde,Cde,pde,pde,Cde,pde,pde,pde,pde,pde],[gde,pde,mde,kde,pde,pde,Cde,pde,pde,pde,pde],[gde,pde,pde,kde,pde,pde,pde,pde,pde,pde,gde],[pde,pde,pde,pde,mde,pde,pde,Cde,pde,pde,gde],[pde,pde,pde,pde,pde,mde,pde,pde,pde,gde,gde],[pde,pde,pde,mde,pde,pde,pde,gde,gde,gde,gde],[pde,pde,pde,pde,pde,pde,pde,gde,gde,gde,gde],[gde,pde,pde,pde,pde,gde,gde,gde,gde,gde,gde]],[0,0],20),new hde([],new qee(2,4),fB.of(new qee(4,4)),[]),$localize(Of||(Of=_g(["Congratulations!"])))),_te.fromPredicate($localize(Tf||(Tf=_g(["Getting a ring by aligning 5 markers"]))),$localize(If||(If=_g(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new lde([[gde,gde,gde,gde,gde,gde,pde,pde,pde,pde,gde],[gde,gde,gde,gde,pde,pde,pde,pde,pde,pde,pde],[gde,gde,gde,Cde,pde,pde,pde,pde,pde,pde,pde],[gde,gde,Cde,pde,pde,Cde,pde,pde,pde,pde,pde],[gde,pde,yde,yde,mde,kde,kde,pde,pde,pde,pde],[gde,pde,pde,Cde,pde,pde,pde,pde,pde,pde,gde],[pde,pde,pde,pde,mde,pde,pde,Cde,pde,pde,gde],[pde,pde,pde,pde,pde,mde,pde,pde,pde,gde,gde],[pde,pde,pde,mde,pde,pde,pde,mde,gde,gde,gde],[pde,pde,pde,pde,pde,pde,pde,gde,gde,gde,gde],[gde,pde,pde,pde,pde,gde,gde,gde,gde,gde,gde]],[0,0],20),new hde([],new qee(4,4),fB.of(new qee(7,4)),[fde.of(new qee(2,4),new qee(6,4),new qee(7,4))]),function(e,t){return 1===t.sideRings[N7.ZERO.value]?o7.SUCCESS:o7.failure(wde.MUST_ALIGN_FIVE())},$localize(Af||(Af=_g(["Congratulations!"])))),_te.fromPredicate($localize(Rf||(Rf=_g(["Compound captures"]))),$localize(xf||(xf=_g(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new lde([[gde,gde,gde,gde,gde,gde,pde,pde,pde,pde,gde],[gde,gde,gde,gde,mde,pde,pde,Cde,Cde,mde,pde],[gde,gde,gde,mde,pde,pde,kde,Cde,pde,mde,pde],[gde,gde,pde,mde,pde,pde,pde,pde,pde,Cde,pde],[gde,pde,pde,pde,pde,yde,pde,pde,Cde,pde,pde],[gde,pde,pde,pde,yde,yde,pde,kde,pde,pde,gde],[pde,pde,pde,yde,pde,yde,pde,pde,pde,pde,gde],[pde,pde,yde,pde,pde,yde,pde,pde,pde,gde,gde],[pde,yde,pde,pde,pde,yde,pde,pde,gde,gde,gde],[pde,pde,pde,pde,pde,yde,pde,gde,gde,gde,gde],[gde,pde,pde,pde,pde,gde,gde,gde,gde,gde,gde]],[0,0],10),new hde([fde.of(new qee(5,4),new qee(1,8),new qee(3,2)),fde.of(new qee(5,9),new qee(5,5),new qee(3,3))],new qee(4,1),fB.of(new qee(4,2)),[]),function(e,t){return 2===t.sideRings[N7.ZERO.value]?o7.SUCCESS:o7.failure(wde.MUST_CAPTURE_TWO())},$localize(Mf||(Mf=_g(["Congratulations!"]))))]});function bde(e,t){if(1&e&&(cC(),nS(0,"circle",9)),2&e){var n=fS(2).$implicit,r=fS(2);$E("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Ede(e,t){if(1&e&&(cC(),nS(0,"circle",10)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();vS("id","ring_",r,"_",a,""),XE("ngClass",i.ringClasses),$E("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Sde(e,t){if(1&e&&(cC(),nS(0,"circle",9)),2&e){var n=fS(2).$implicit,r=fS(2);$E("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Pde(e,t){if(1&e&&(cC(),nS(0,"circle",11)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();vS("id","marker_",r,"_",a,""),XE("ngClass",i.markerClasses),$E("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Ode(e,t){if(1&e){var n=aS();cC(),eS(0,"g",3),uS("click",function(){Nk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),nS(1,"polyline",4),eS(2,"g",5),YE(3,bde,1,3,"circle",6),YE(4,Ede,1,6,"circle",7),YE(5,Sde,1,3,"circle",6),YE(6,Pde,1,6,"circle",8),tS(),tS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index;vS("id","click_",i,"_",o,""),pb(1),vS("id","space_",i,"_",o,""),XE("ngClass",a.spaceClasses),$E("points",a.coordinates),pb(1),vS("id","pieceGroup_",i,"_",o,""),XE("ngClass",a.removedClass),pb(1),XE("ngIf",a.isRing),pb(1),XE("ngIf",a.isRing),pb(1),XE("ngIf",a.isRing),pb(1),XE("ngIf",a.isMarker)}}function Tde(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Ode,7,13,"g",2),tS()),2&e){var n=t.$implicit;pb(1),XE("ngIf",null!=n)}}function Ide(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Tde,2,1,"g",1),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}function Ade(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"polyline",12),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),vS("id","selected_",r.x,"_",r.y,""),$E("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Rde(e,t){if(1&e){var n=aS();cC(),eS(0,"polyline",14),uS("click",function(){Nk(n);var e=fS().$implicit;return fS().onClick(e)}),tS()}if(2&e){var r=fS().$implicit,i=fS();vS("id","selectable_",r.x,"_",r.y,""),$E("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function xde(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Rde,1,3,"polyline",13),tS()),2&e){var n=fS();pb(1),XE("ngIf",n.isPlayerTurn())}}function Mde(e,t){if(1&e){var n=aS();cC(),eS(0,"g"),eS(1,"rect",15),uS("click",function(){var e=Nk(n).$implicit;return fS().onClick(e)}),tS(),tS()}if(2&e){var r=t.$implicit,i=fS();pb(1),$E("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Nde(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",16),nS(2,"circle",9),nS(3,"circle",17),tS()),2&e){var n=t.index,r=fS().$implicit,i=fS();pb(1),vS("id","player_",r,"_sideRing_",n+1,""),$E("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),pb(1),$E("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),pb(1),XE("ngClass",i.viewInfo.sideRingClass[r]),$E("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Dde=function(){return[]};function Lde(e,t){if(1&e&&(cC(),eS(0,"g"),YE(1,Nde,4,12,"g",1),tS()),2&e){var n=t.$implicit,r=fS();pb(1),XE("ngForOf",aT(1,Dde).constructor(r.viewInfo.sideRings[n]))}}var Fde=function(){return[0,1]},Ude=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=fB.empty(),r.moveEnd=fB.empty(),r.currentlyMoved=[],r.currentCapture=fB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=fB.of([0,0]),r.rules=new vde(lde),r.availableMinimaxes=[new dde(r.rules,"YinshMinimax")],r.encoder=hde.encoder,r.tutorial=(new _de).tutorial,r.hexaLayout=new Qee(1.5*n.RING_OUTER_SIZE,new qee(2*n.RING_OUTER_SIZE,0),ete.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return Wg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=fB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=Gg(N7.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Gg(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Gg(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Gg(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Gg(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==cde.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=fB.empty(),this.moveStart=fB.empty(),this.moveEnd=fB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=Gg(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=Kee.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==cde.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Gg(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),o7.SUCCESS}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(ude.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",o7.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Gg(e);try{for(n.s();!(t=n.n()).done;){var r,i=Gg(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(oB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(ude.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(ude.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=fB.of(e),this.constructedState=new lde(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(f7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),o7.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Gg(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,cde.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,cde.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=fB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),o7.SUCCESS)):(oB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),o7.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),o7.SUCCESS}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new hde(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=fB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=fB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",o7.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=fB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),o7.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(jee);function Vde(e,t){if(1&e&&(eS(0,"option",5),FS(1),tS()),2&e){var n=t.$implicit;XE("value",n.urlName),pb(1),US(n.name)}}Ude.RING_OUTER_SIZE=40,Ude.RING_MID_SIZE=34,Ude.RING_INNER_SIZE=28,Ude.MARKER_SIZE=Ude.RING_INNER_SIZE,Ude.INDICATOR_SIZE=10,Ude.\u0275fac=function(e){return new(e||Ude)(QE(c7))},Ude.\u0275cmp=Hm({type:Ude,selectors:[["app-yinsh"]],features:[RE],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(cC(),eS(0,"svg",0),YE(1,Ide,2,1,"g",1),YE(2,Ade,2,3,"g",1),YE(3,xde,2,1,"g",1),YE(4,Mde,2,4,"g",1),YE(5,Lde,2,2,"g",1),tS()),2&e&&(pb(1),XE("ngForOf",t.viewInfo.spaceInfo),pb(1),XE("ngForOf",t.viewInfo.selectedCoords),pb(1),XE("ngForOf",t.viewInfo.selectableCoords),pb(1),XE("ngForOf",t.viewInfo.targets),pb(1),XE("ngForOf",aT(5,Fde)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Bde=function(){var e=Wg(function e(){Zg(this,e)});return e.ABALONE=function(){return $localize(Nf||(Nf=_g(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Df||(Df=_g(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Lf||(Lf=_g(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Ff||(Ff=_g(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Uf||(Uf=_g(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(Vf||(Vf=_g(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(Bf||(Bf=_g(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(zf||(zf=_g(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(Gf||(Gf=_g(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(Hf||(Hf=_g(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize($f||($f=_g(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(Zf||(Zf=_g(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(qf||(qf=_g(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(Wf||(Wf=_g(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(jf||(jf=_g(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(Yf||(Yf=_g(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(Kf||(Kf=_g(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(Qf||(Qf=_g(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(Xf||(Xf=_g(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(Jf||(Jf=_g(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(eh||(eh=_g(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(th||(th=_g(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(nh||(nh=_g(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(rh||(rh=_g(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(ih||(ih=_g(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(ah||(ah=_g(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(oh||(oh=_g(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),zde=function(){var e=Wg(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Zg(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Zue,new Date("1970-01-01"),"",!1),new e($localize(sh||(sh=_g(["Four in a Row"]))),"P4",oce,new Date("2018-08-28"),Bde.P4()),new e($localize(uh||(uh=_g(["Awal\xe9"]))),"Awale",hne,new Date("2018-11-29"),Bde.AWALE()),new e($localize(ch||(ch=_g(["Quarto"]))),"Quarto",Ble,new Date("2018-12-09"),Bde.QUARTO()),new e($localize(lh||(lh=_g(["Tablut"]))),"Tablut",sde,new Date("2018-12-27"),Bde.TABLUT()),new e($localize(fh||(fh=_g(["Reversi"]))),"Reversi",pfe,new Date("2019-01-16"),Bde.REVERSI()),new e($localize(hh||(hh=_g(["Go"]))),"Go",Soe,new Date("2019-12-21"),Bde.GO()),new e($localize(dh||(dh=_g(["Encapsule"]))),"Encapsule",fae,new Date("2019-12-30"),Bde.ENCAPSULE()),new e($localize(vh||(vh=_g(["Siam"]))),"Siam",yhe,new Date("2020-01-11"),Bde.SIAM()),new e($localize(ph||(ph=_g(["Sahara"]))),"Sahara",Nfe,new Date("2020-02-29"),Bde.SAHARA()),new e($localize(gh||(gh=_g(["Pylos"]))),"Pylos",Yce,new Date("2020-10-02"),Bde.PYLOS()),new e($localize(yh||(yh=_g(["Kamisado"]))),"Kamisado",ise,new Date("2020-10-03"),Bde.KAMISADO()),new e($localize(mh||(mh=_g(["Quixo"]))),"Quixo",tfe,new Date("2020-10-15"),Bde.QUIXO()),new e($localize(kh||(kh=_g(["Dvonn"]))),"Dvonn",zie,new Date("2020-10-21"),Bde.DVONN()),new e($localize(Ch||(Ch=_g(["Epaminondas"]))),"Epaminondas",Oae,new Date("2021-01-16"),Bde.EPAMINONDAS()),new e($localize(wh||(wh=_g(["Gipf"]))),"Gipf",Qae,new Date("2021-02-22"),Bde.GIPF()),new e($localize(_h||(_h=_g(["Coerceo"]))),"Coerceo",bre,new Date("2021-03-21"),Bde.COERCEO()),new e($localize(bh||(bh=_g(["Six"]))),"Six",Bhe,new Date("2021-04-08"),Bde.SIX()),new e($localize(Eh||(Eh=_g(["Lines of Action"]))),"LinesOfAction",mse,new Date("2021-04-28"),Bde.LINES_OF_ACTION()),new e($localize(Sh||(Sh=_g(["Pentago"]))),"Pentago",Pce,new Date("2021-05-23"),Bde.PENTAGO()),new e($localize(Ph||(Ph=_g(["Abalone"]))),"Abalone",zte,new Date("2021-07-13"),Bde.ABALONE()),new e($localize(Oh||(Oh=_g(["Yinsh"]))),"Yinsh",Ude,new Date("2021-07-31"),Bde.YINSH()),new e($localize(Th||(Th=_g(["Apagos"]))),"Apagos",nne,new Date("2021-11-04"),Bde.APAGOS()),new e($localize(Ih||(Ih=_g(["Diam"]))),"Diam",fie,new Date("2021-11-30"),Bde.DIAM()),new e($localize(Ah||(Ah=_g(["Brandhub"]))),"Brandhub",jne,new Date("2021-12-07"),Bde.BRANDHUB()),new e($localize(Rh||(Rh=_g(["Conspirateurs"]))),"Conspirateurs",$re,new Date("2021-12-30"),Bde.CONSPIRATEURS()),new e($localize(xh||(xh=_g(["Lodestone"]))),"Lodestone",Qse,new Date("2022-06-24"),Bde.LODESTONE()),new e($localize(Mh||(Mh=_g(["Martian Chess"]))),"MartianChess",Nue,new Date("2022-07-01"),Bde.MARTIAN_CHESS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),Gde=function(){var e=function(){function e(){Zg(this,e),this.games=zde.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new gT}return Wg(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Hm({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(Nh||(Nh=_g(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"select",1),uS("change",function(e){return t.onChange(e)}),eS(2,"option",2),ZP(3,3),tS(),YE(4,Vde,2,2,"option",4),tS(),tS()),2&e&&(pb(4),XE("ngForOf",t.games))},directives:[oM,lM,LA],encapsulation:2}),e}();function Hde(e,t){if(1&e){var n=aS();eS(0,"div",26),eS(1,"div",27),uS("click",function(){return Nk(n),fS().closeInfo()}),tS(),eS(2,"div",28),eS(3,"header",29),eS(4,"p",30),FS(5),tS(),eS(6,"button",31),uS("click",function(){return Nk(n),fS().closeInfo()}),tS(),tS(),eS(7,"section",32),eS(8,"div",6),eS(9,"div",33),eS(10,"p",34),nS(11,"img",35),tS(),tS(),eS(12,"div",7),eS(13,"div",13),FS(14),tS(),tS(),tS(),eS(15,"div",6),eS(16,"div",33),eS(17,"a",36),uS("click",function(){Nk(n);var e=fS();return e.createGame(e.gameInfoDetails.get().urlName)}),nS(18,"fa-icon",37),FS(19,"\xa0"),eS(20,"span"),ZP(21,38),tS(),tS(),tS(),eS(22,"div",33),eS(23,"a",36),uS("click",function(){Nk(n);var e=fS();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),nS(24,"fa-icon",37),FS(25,"\xa0"),eS(26,"span"),ZP(27,39),tS(),tS(),tS(),eS(28,"div",33),eS(29,"a",36),uS("click",function(){Nk(n);var e=fS();return e.createTutorial(e.gameInfoDetails.get().urlName)}),nS(30,"fa-icon",37),FS(31,"\xa0"),eS(32,"span"),ZP(33,40),tS(),tS(),tS(),tS(),tS(),tS(),tS()}if(2&e){var r=fS();pb(5),US(r.gameInfoDetails.get().name),pb(6),vS("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",u_),pb(3),VS(" ",r.gameInfoDetails.get().description," "),pb(4),XE("icon",r.iconOnlineGame),pb(6),XE("icon",r.iconLocalGame),pb(6),XE("icon",r.iconTutorial)}}function $de(e,t){if(1&e){var n=aS();eS(0,"div",8),eS(1,"div",9),eS(2,"p",10),FS(3),tS(),tS(),eS(4,"div",42),eS(5,"figure",34),eS(6,"img",43),uS("click",function(){var e=Nk(n).$implicit;return fS(2).openInfo(e)}),tS(),eS(7,"figcaption",44),uS("click",function(){var e=Nk(n).$implicit;return fS(2).openInfo(e)}),eS(8,"div",45),FS(9,"?"),tS(),tS(),eS(10,"figcaption",46),eS(11,"a",47),uS("click",function(){var e=Nk(n).$implicit;return fS(2).createGame(e.urlName)}),nS(12,"fa-icon",37),tS(),eS(13,"a",48),uS("click",function(){var e=Nk(n).$implicit;return fS(2).createLocalGame(e.urlName)}),nS(14,"fa-icon",37),tS(),eS(15,"a",49),uS("click",function(){var e=Nk(n).$implicit;return fS(2).createTutorial(e.urlName)}),nS(16,"fa-icon",37),tS(),tS(),tS(),tS(),eS(17,"div",50),FS(18),tS(),tS()}if(2&e){var r=t.$implicit,i=fS(2);pb(3),US(r.name),pb(3),dS("id","image_",r.urlName,""),vS("src","assets/images/",i.theme,"/",r.urlName,".png",u_),pb(5),dS("id","playOnline_",r.urlName,""),pb(1),XE("icon",i.iconOnlineGame),pb(1),dS("id","playLocally_",r.urlName,""),pb(1),XE("icon",i.iconLocalGame),pb(1),dS("id","startTutorial_",r.urlName,""),pb(1),XE("icon",i.iconTutorial),pb(2),VS(" ",r.description," ")}}function Zde(e,t){if(1&e&&(eS(0,"div",7),YE(1,$de,19,11,"div",41),tS()),2&e){var n=t.$implicit;pb(1),XE("ngForOf",n)}}var qde=function(){var e=function(){function e(t,n){Zg(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=X7,this.iconLocalGame=K7,this.iconTutorial=j7,this.gameInfoDetails=fB.empty(),this.theme=n.getTheme();for(var r=zde.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return Wg(e,[{key:"createGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=fB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=fB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(W7))},e.\u0275cmp=Hm({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Dh||(Dh=_g(["EveryBoard"]))),[1,"subtitle"],$localize(Lh||(Lh=_g(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Fh||(Fh=_g(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Uh||(Uh=_g(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Vh||(Vh=_g(["See the game list"]))),$localize(Bh||(Bh=_g(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(zh||(zh=_g(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Gh||(Gh=_g(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(Hh||(Hh=_g(["Play online"]))),$localize($h||($h=_g(["Play offline"]))),$localize(Zh||(Zh=_g(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(qh||(qh=_g(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Wh||(Wh=_g(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(jh||(jh=_g(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(eS(0,"section",0),eS(1,"div",1),eS(2,"p",2),ZP(3,3),tS(),eS(4,"p",4),HP(5,5),nS(6,"br"),$P(),tS(),tS(),eS(7,"div",6),eS(8,"div",7),eS(9,"div",8),eS(10,"header",9),eS(11,"p",10),ZP(12,11),tS(),tS(),eS(13,"div",12),eS(14,"div",13),eS(15,"button",14),ZP(16,15),tS(),eS(17,"button",16),ZP(18,17),tS(),tS(),tS(),tS(),tS(),eS(19,"div",7),eS(20,"div",8),eS(21,"header",9),eS(22,"p",10),ZP(23,18),tS(),tS(),eS(24,"div",12),eS(25,"div",19),eS(26,"button",20),ZP(27,21),tS(),eS(28,"button",22),ZP(29,23),tS(),tS(),tS(),tS(),tS(),tS(),YE(30,Hde,34,7,"div",24),eS(31,"div",6),YE(32,Zde,2,1,"div",25),tS(),tS()),2&e&&(pb(30),XE("ngIf",t.gameInfoDetails.isPresent()),pb(2),XE("ngForOf",t.games))},directives:[KL,UA,LA,Eee],encapsulation:2}),e}(),Wde=function(){var e=function(){function e(t){Zg(this,e),this.element=t}return Wg(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(uO))},e.\u0275dir=Ym({type:e,selectors:[["","autofocus",""]]}),e}(),jde=function(){var e=function(){function e(t){var n=this;Zg(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return Wg(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(uO))},e.\u0275dir=Ym({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Yde(e,t){if(1&e&&(eS(0,"div",29),eS(1,"div",30),ZP(2,31),tS(),eS(3,"div",32),FS(4),tS(),tS()),2&e){var n=fS();pb(4),US(n.errorMessage)}}var Kde=function(){return["/register"]},Qde=function(){return["/reset-password"]},Xde=function(){var e=function(){function e(t,n){Zg(this,e),this.router=t,this.connectedUserService=n,this.faEye=Q7,this.loginForm=new Bx({email:new Vx,password:new Vx})}return Wg(e,[{key:"ngOnInit",value:function(){var e,t=this;this.connectedUserService.getUserObs().subscribe((e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==E7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(S7))},e.\u0275cmp=Hm({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(Yh||(Yh=_g(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Kh||(Kh=_g(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(Qh||(Qh=_g(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(Xh||(Xh=_g(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(Jh||(Jh=_g(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ed||(ed=_g(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(td||(td=_g(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(nd||(nd=_g(["No account?"]))),[3,"routerLink"],$localize(rd||(rd=_g(["Register"]))),$localize(id||(id=_g(["Forgot your password?"]))),$localize(ad||(ad=_g(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(od||(od=_g(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"p",1),ZP(2,2),tS(),eS(3,"form",3),eS(4,"div",4),eS(5,"div",5),eS(6,"label",6),ZP(7,7),tS(),tS(),eS(8,"div",8),eS(9,"div",9),eS(10,"div",10),nS(11,"input",11),tS(),tS(),tS(),tS(),eS(12,"div",4),eS(13,"div",5),eS(14,"label",12),ZP(15,13),tS(),tS(),eS(16,"div",8),eS(17,"div",9),eS(18,"div",14),nS(19,"input",15),eS(20,"span",16),nS(21,"fa-icon",17),tS(),tS(),tS(),tS(),tS(),eS(22,"div",4),nS(23,"div",5),eS(24,"div",8),eS(25,"div",9),eS(26,"div",10),eS(27,"button",18),uS("click",function(){return t.loginWithEmail(t.loginForm.value)}),ZP(28,19),tS(),tS(),tS(),tS(),tS(),eS(29,"div",4),nS(30,"div",5),eS(31,"div",8),eS(32,"div",9),eS(33,"div",10),eS(34,"button",20),uS("click",function(){return t.loginWithGoogle()}),ZP(35,21),tS(),tS(),tS(),tS(),tS(),YE(36,Yde,5,1,"div",22),eS(37,"p",23),rS(38),ZP(39,24),iS(),FS(40,"\xa0 "),eS(41,"a",25),ZP(42,26),tS(),tS(),eS(43,"p",23),rS(44),ZP(45,27),iS(),FS(46,"\xa0 "),eS(47,"a",25),ZP(48,28),tS(),tS(),tS(),tS()),2&e&&(pb(3),XE("formGroup",t.loginForm),pb(18),XE("icon",t.faEye),pb(6),XE("disabled",!t.canLogin()),pb(9),XE("ngIf",t.errorMessage),pb(5),XE("routerLink",aT(6,Kde)),pb(6),XE("routerLink",aT(7,Qde)))},directives:[jx,gx,eM,VR,px,nM,Wde,hM,Eee,jde,UA,QL],encapsulation:2}),e}(),Jde=function(){var e=function(){function e(t){Zg(this,e),this.partDAO=t,this.unsubscribe=fB.empty(),this.activePartsBS=new nN([]),this.activePartsObs=this.activePartsBS.asObservable()}return Wg(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;f7(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new m7(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,Bg(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=Gg(t);try{var a=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=Gg(e.activePartsBS.value);try{var a=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=fB.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){f7(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=fB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(v7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),eve=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL))},e.\u0275cmp=Hm({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(sd||(sd=_g(["Create an online game"])))]},template:function(e,t){1&e&&(eS(0,"app-pick-game",0),uS("pickGame",function(e){return t.pickGame(e)}),tS(),eS(1,"button",1),uS("click",function(){return t.navigateToOnlineGameCreation()}),ZP(2,2),tS()),2&e&&(pb(1),XE("disabled",!t.selectedGame))},directives:[Gde],encapsulation:2}),e}(),tve=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"transform",value:function(e){return pA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Km({name:"firebaseDate",type:e,pure:!0}),e}(),nve=["chatDiv"];function rve(e,t){1&e&&(rS(0),ZP(1,5),iS())}function ive(e,t){1&e&&ZP(0,6),2&e&&(qP(fS().unreadMessagesText),WP(0))}function ave(e,t){if(1&e){var n=aS();eS(0,"button",11),uS("click",function(){return Nk(n),fS(2).scrollToBottom()}),FS(1),tS()}if(2&e){var r=fS(2);pb(1),VS("",r.unreadMessagesText," \u2193")}}function ove(e,t){if(1&e&&(eS(0,"p"),FS(1),fT(2,"firebaseDate"),eS(3,"b",12),FS(4),tS(),eS(5,"span",13),FS(6),tS(),tS()),2&e){var n=t.$implicit;pb(1),VS(" [",hT(2,3,n.postedTime),"] "),pb(3),VS("",n.sender.name," : "),pb(2),US(n.content)}}function sve(e,t){if(1&e){var n=aS();eS(0,"div"),YE(1,ave,2,1,"button",7),eS(2,"div",8,9),uS("scroll",function(){return Nk(n),fS().updateCurrentScrollPosition()}),YE(4,ove,7,5,"p",10),tS(),tS()}if(2&e){var r=fS();pb(1),XE("ngIf",r.showUnreadMessagesButton),pb(3),XE("ngForOf",r.chat)}}var uve=function(){return{standalone:!0}};function cve(e,t){if(1&e){var n=aS();eS(0,"form",14),uS("onSubmit",function(){return Nk(n),fS().sendMessage()}),eS(1,"div",15),eS(2,"div",16),eS(3,"input",17,18),uS("ngModelChange",function(e){return Nk(n),fS().userMessage=e}),tS(),eS(5,"p",19),FS(6),tS(),tS(),eS(7,"div",20),eS(8,"button",21),uS("click",function(){return Nk(n),fS().sendMessage()}),nS(9,"fa-icon",22),tS(),tS(),tS(),eS(10,"div",23),eS(11,"p"),eS(12,"strong"),ZP(13,24),tS(),tS(),tS(),tS()}if(2&e){var r=KE(4),i=fS();pb(3),XE("ngModel",i.userMessage)("ngModelOptions",aT(4,uve)),pb(3),VS("",r.value.length,"/128"),pb(3),XE("icon",i.faReply)}}var lve=function(){var e=function(){function e(t,n){Zg(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=J7,this.isNearBottom=!0,this.notYetScrolled=!0,sB(e.VERBOSE,"ChatComponent constructor")}return Wg(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),f7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new m7(t,t,function(){});this.chatService.startObserving(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(ud||(ud=_g(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(cd||(cd=_g(["1 new message"]))):$localize(ld||(ld=_g([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(y7),QE(S7))},e.\u0275cmp=Hm({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&IT(nve,5),2&e)&&(TT(n=AT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(fd||(fd=_g(["Hide chat"]))),$localize(hd||(hd=_g(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(dd||(dd=_g(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(vd||(vd=_g(["Be polite"])))]},template:function(e,t){if(1&e&&(eS(0,"div"),eS(1,"button",0),uS("click",function(){return t.switchChatVisibility()}),YE(2,rve,2,0,"ng-container",1),YE(3,ive,1,1,"ng-template",null,2,xT),tS(),YE(5,sve,5,2,"div",3),YE(6,cve,14,5,"form",4),tS()),2&e){var n=KE(4);pb(2),XE("ngIf",t.visible)("ngIfElse",n),pb(3),XE("ngIf",t.visible),pb(1),XE("ngIf",t.visible)}},directives:[UA,LA,jx,gx,$x,VR,vM,px,Wx,Eee],pipes:[tve],encapsulation:2}),e}();function fve(e,t){if(1&e&&(rS(0),FS(1),iS()),2&e){var n=fS().$implicit;pb(1),US(n.data.playerOne.name)}}function hve(e,t){1&e&&(rS(0),ZP(1,26),iS())}function dve(e,t){if(1&e){var n=aS();eS(0,"tr",22),uS("click",function(){var e=Nk(n).$implicit;return fS(2).joinGame(e.id,e.data.typeGame)}),eS(1,"td",23),FS(2),tS(),eS(3,"td",23),FS(4),tS(),eS(5,"td",23),YE(6,fve,2,1,"ng-container",24),YE(7,hve,2,0,"ng-template",null,25,xT),tS(),eS(9,"td",23),FS(10),tS(),tS()}if(2&e){var r=t.$implicit,i=t.index,a=KE(8);dS("id","part_",i,""),pb(2),US(r.data.typeGame),pb(2),US(r.data.playerZero.name),pb(2),XE("ngIf",r.data.playerOne)("ngIfElse",a),pb(4),US(r.data.turn)}}function vve(e,t){if(1&e&&(eS(0,"div",13),eS(1,"div",14),eS(2,"table",15),eS(3,"thead"),eS(4,"tr"),eS(5,"th",16),ZP(6,17),tS(),eS(7,"th",16),ZP(8,18),tS(),eS(9,"th",16),ZP(10,19),tS(),eS(11,"th",16),ZP(12,20),tS(),tS(),tS(),eS(13,"tbody"),YE(14,dve,11,6,"tr",21),tS(),tS(),tS(),tS()),2&e){var n=fS();pb(14),XE("ngForOf",n.activeParts)}}function pve(e,t){1&e&&(eS(0,"div",27),nS(1,"app-online-game-selection",28),tS())}function gve(e,t){if(1&e&&(eS(0,"li",39),FS(1),fT(2,"firebaseDate"),tS()),2&e){var n=fS().$implicit;hS("id",n.data.username),pb(1),BS("",n.data.username,": ",hT(2,3,n.data.lastUpdateTime),"")}}function yve(e,t){if(1&e&&(rS(0),YE(1,gve,3,5,"li",38),iS()),2&e){var n=t.$implicit;pb(1),XE("ngIf",n.data.lastUpdateTime)}}function mve(e,t){if(1&e&&(eS(0,"div",29),eS(1,"div",30),eS(2,"div",31),nS(3,"app-chat",32),tS(),tS(),eS(4,"div",33),eS(5,"div",34),eS(6,"p"),ZP(7,35),tS(),eS(8,"ul",36),YE(9,yve,2,1,"ng-container",37),tS(),tS(),tS(),tS()),2&e){var n=fS();pb(3),XE("turn",-1),pb(6),XE("ngForOf",n.activeUsers)}}var kve=function(){var e=function(){function e(t,n,r){Zg(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return Wg(e,[{key:"ngOnInit",value:function(){var t=this;sB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){sB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(jL),QE(w7),QE(Jde))},e.\u0275cmp=Hm({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(pd||(pd=_g(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(gd||(gd=_g(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(yd||(yd=_g(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(md||(md=_g(["Game"]))),$localize(kd||(kd=_g(["First player"]))),$localize(Cd||(Cd=_g(["Second player"]))),$localize(wd||(wd=_g(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(_d||(_d=_g(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(bd||(bd=_g(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"ul"),eS(2,"li",1),eS(3,"a",2),uS("click",function(){return t.selectTab("games")}),ZP(4,3),tS(),tS(),eS(5,"li",4),eS(6,"a",5),uS("click",function(){return t.selectTab("create")}),ZP(7,6),tS(),tS(),eS(8,"li",7),eS(9,"a",8),uS("click",function(){return t.selectTab("chat")}),ZP(10,9),tS(),tS(),tS(),tS(),YE(11,vve,15,1,"div",10),YE(12,pve,2,0,"div",11),YE(13,mve,10,2,"div",12)),2&e&&(pb(11),XE("ngIf","games"===t.currentTab),pb(1),XE("ngIf","create"===t.currentTab),pb(1),XE("ngIf","chat"===t.currentTab))},directives:[NA,UA,LA,eve,lve],pipes:[tve],encapsulation:2}),e}(),Cve=function(){var e=Wg(function e(t){var n;Zg(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(Ed||(Ed=_g(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(QE(OD))},e.\u0275cmp=Hm({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Sd||(Sd=_g(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"div",1),ZP(2,2),tS(),eS(3,"div",3),FS(4),tS(),tS()),2&e&&(pb(4),US(t.message))},encapsulation:2}),e}();function wve(e,t){}var _ve=function(){var e=Wg(function e(t){Zg(this,e),this.viewContainerRef=t,sB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(ZO))},e.\u0275cmp=Hm({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&YE(0,wve,0,0,"ng-template")},encapsulation:2}),e}(),bve=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(Pd||(Pd=_g(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Od||(Od=_g(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Td||(Td=_g(["You cannot clone a game. This feature might be implemented later."])))},e}(),Eve=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[fB.empty(),fB.empty()],this.observerRole=M7.NONE,this.endGame=!1,this.Player=N7,sB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return Wg(e,[{key:"getMatchingComponent",value:function(t){return sB(e.VERBOSE,"GameWrapper.getMatchingComponent"),fB.ofNullable(zde.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"GameWrapper.createGameComponent"),r=oB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",bve.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return f7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(sB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",o7.failure(bve.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",o7.failure($localize(Id||(Id=_g(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),o7.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:sB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=o7.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===M7.NONE){var t=bve.NO_CLONING_FEATURE();return o7.failure(t)}return this.isPlayerTurn()?o7.SUCCESS:o7.failure(bve.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===M7.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayer();return sB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.observerRole,areYouPlayer:this.players[n].isPresent()&&lB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(iO),QE(OD),QE(S7),QE(jL),QE(c7))},e.\u0275cmp=Hm({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&IT(_ve,5),2&e)&&(TT(n=AT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Sve=function(){function e(t,n,r){Zg(this,e),this.added=t,this.modified=n,this.removed=r}return Wg(e,[{key:"addNewKeys",value:function(e,t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=Gg(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{f7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),f7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Eg({},n),r;if(null==n)return r.removed=Eg({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function Pve(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Ove(e,t){return Pve(t)-Pve(e)}function Tve(e){return by(function(t,n){Vy(e).subscribe(new Ey(n,function(){return n.complete()},iy)),!n.closed&&t.subscribe(n)})}var Ive=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Ad||(Ad=_g([""," hours"])),r)):1===r&&i.push($localize(Rd||(Rd=_g(["1 hour"])))),n>1?i.push($localize(xd||(xd=_g([""," minutes"])),n)):1===n&&i.push($localize(Md||(Md=_g(["1 minute"])))),t>1?i.push($localize(Nd||(Nd=_g([""," seconds"])),t)):1===t&&i.push($localize(Dd||(Dd=_g(["1 second"])))),0===i.length)return $localize(Ld||(Ld=_g(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(Fd||(Fd=_g([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Km({name:"humanDuration",type:e,pure:!0}),e}();function Ave(e,t){if(1&e&&(rS(0),FS(1),iS()),2&e){var n=fS(3);pb(1),US(n.viewInfo.chosenOpponent)}}function Rve(e,t){1&e&&ZP(0,44)}function xve(e,t){if(1&e&&(eS(0,"div",45),eS(1,"div",8),eS(2,"label",46),rS(3),ZP(4,47),iS(),eS(5,"output"),FS(6),fT(7,"humanDuration"),tS(),tS(),eS(8,"div",37),nS(9,"input",48),tS(),tS(),eS(10,"div",8),eS(11,"label",49),HP(12,50),nS(13,"output"),fT(14,"humanDuration"),$P(),tS(),eS(15,"div",37),nS(16,"input",51),tS(),tS(),tS()),2&e){var n=fS(3);pb(6),US(hT(7,2,n.viewInfo.maximalMoveDuration||0)),pb(8),qP(hT(14,4,n.viewInfo.totalPartDuration||0)),WP(12)}}function Mve(e,t){1&e&&(eS(0,"div"),HP(1,52),nS(2,"br"),$P(),tS())}function Nve(e,t){1&e&&(eS(0,"button",64),ZP(1,65),tS())}function Dve(e,t){if(1&e){var n=aS();eS(0,"tr",60),uS("click",function(){var e=Nk(n).$implicit;return fS(4).selectOpponent(e)}),eS(1,"td",61),FS(2),tS(),eS(3,"td",62),YE(4,Nve,2,0,"button",63),tS(),tS()}if(2&e){var r=t.$implicit,i=fS(4);dS("id","presenceOf_",r,""),XE("ngClass",i.viewInfo.candidateClasses[r]),pb(1),XE("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),pb(1),US(r),pb(2),XE("ngIf",i.viewInfo.chosenOpponent!==r)}}function Lve(e,t){if(1&e&&(rS(0),ZP(1,53),iS(),eS(2,"div",54),eS(3,"table",55),eS(4,"thead"),eS(5,"tr"),eS(6,"th",56),ZP(7,57),tS(),eS(8,"th",56),ZP(9,58),tS(),tS(),tS(),eS(10,"tbody"),YE(11,Dve,5,5,"tr",59),tS(),tS(),tS()),2&e){var n=fS(3);pb(11),XE("ngForOf",n.viewInfo.candidates)}}function Fve(e,t){if(1&e){var n=aS();eS(0,"button",66),uS("click",function(){return Nk(n),fS(3).changeConfig()}),ZP(1,67),tS()}}function Uve(e,t){if(1&e){var n=aS();eS(0,"div"),eS(1,"h1",4),ZP(2,5),tS(),eS(3,"form",6),eS(4,"fieldset",7),eS(5,"div",8),eS(6,"label",9),ZP(7,10),tS(),eS(8,"div",11),eS(9,"button",12),uS("click",function(){return Nk(n),fS(2).selectFirstPlayer("RANDOM")}),ZP(10,13),tS(),eS(11,"button",14),uS("click",function(){return Nk(n),fS(2).selectFirstPlayer("CREATOR")}),ZP(12,15),tS(),eS(13,"button",16),uS("click",function(){return Nk(n),fS(2).selectFirstPlayer("CHOSEN_PLAYER")}),YE(14,Ave,2,1,"ng-container",17),YE(15,Rve,1,0,"ng-template",null,18,xT),tS(),tS(),tS(),eS(17,"div",8),eS(18,"label",9),ZP(19,19),tS(),eS(20,"div",11),eS(21,"div",20),uS("click",function(){return Nk(n),fS(2).selectPartType("STANDARD")}),eS(22,"div",21),eS(23,"span"),ZP(24,22),tS(),tS(),eS(25,"div",23),eS(26,"div",24),eS(27,"div",25),eS(28,"p"),rS(29),ZP(30,26),iS(),eS(31,"strong"),FS(32),fT(33,"humanDuration"),tS(),nS(34,"br"),rS(35),HP(36,27),nS(37,"strong"),fT(38,"humanDuration"),$P(),iS(),tS(),tS(),tS(),tS(),tS(),eS(39,"div",28),uS("click",function(){return Nk(n),fS(2).selectPartType("BLITZ")}),eS(40,"div",21),eS(41,"span"),ZP(42,29),tS(),tS(),eS(43,"div",23),eS(44,"div",24),eS(45,"div",25),eS(46,"p"),rS(47),ZP(48,30),iS(),eS(49,"strong"),FS(50),fT(51,"humanDuration"),tS(),nS(52,"br"),rS(53),HP(54,31),nS(55,"strong"),fT(56,"humanDuration"),$P(),iS(),tS(),tS(),tS(),tS(),tS(),eS(57,"button",32),uS("click",function(){return Nk(n),fS(2).selectPartType("CUSTOM")}),ZP(58,33),tS(),tS(),tS(),YE(59,xve,17,6,"div",34),eS(60,"div",8),eS(61,"label",35),ZP(62,36),tS(),eS(63,"div",37),YE(64,Mve,3,0,"div",17),YE(65,Lve,12,1,"ng-template",null,38,xT),tS(),tS(),tS(),eS(67,"div",8),eS(68,"div",11),eS(69,"button",39),uS("click",function(){return Nk(n),fS(2).proposeConfig()}),ZP(70,40),tS(),YE(71,Fve,2,0,"button",41),eS(72,"button",42),uS("click",function(){return Nk(n),fS(2).cancelGameCreation()}),ZP(73,43),tS(),tS(),tS(),tS(),tS()}if(2&e){var r=KE(16),i=KE(66),a=fS(2);pb(3),XE("formGroup",a.configFormGroup),pb(1),XE("disabled",!a.viewInfo.canEditConfig),pb(5),XE("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),pb(2),XE("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),pb(2),XE("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),pb(1),XE("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),pb(7),XE("ngClass",a.viewInfo.partTypeClasses.STANDARD),pb(11),US(hT(33,19,a.partType.NORMAL_MOVE_DURATION)),pb(6),qP(hT(38,21,a.partType.NORMAL_PART_DURATION)),WP(36),pb(1),XE("ngClass",a.viewInfo.partTypeClasses.BLITZ),pb(11),US(hT(51,23,a.partType.BLITZ_MOVE_DURATION)),pb(6),qP(hT(56,25,a.partType.BLITZ_PART_DURATION)),WP(54),pb(1),XE("ngClass",a.viewInfo.partTypeClasses.CUSTOM),pb(2),XE("ngIf",a.viewInfo.showCustomTime),pb(5),XE("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),pb(5),XE("disabled",!a.viewInfo.canProposeConfig),pb(2),XE("ngIf",a.viewInfo.canReviewConfig)}}function Vve(e,t){if(1&e&&(eS(0,"div",74),eS(1,"p"),HP(2,75),nS(3,"br"),$P(),tS(),tS()),2&e){var n=fS(3);pb(3),qP(n.viewInfo.creator),WP(2)}}function Bve(e,t){if(1&e&&(eS(0,"span"),ZP(1,81),tS()),2&e){var n=fS(4);pb(1),qP(n.viewInfo.creator),WP(1)}}function zve(e,t){1&e&&(eS(0,"span"),ZP(1,82),tS())}function Gve(e,t){1&e&&(eS(0,"span"),ZP(1,83),tS())}function Hve(e,t){if(1&e){var n=aS();eS(0,"div",74),eS(1,"p"),ZP(2,76),tS(),eS(3,"ul"),eS(4,"li"),YE(5,Bve,2,1,"span",2),YE(6,zve,2,0,"span",2),YE(7,Gve,2,0,"span",2),tS(),eS(8,"li"),HP(9,77),nS(10,"strong"),fT(11,"humanDuration"),$P(),tS(),eS(12,"li"),HP(13,78),nS(14,"strong"),fT(15,"humanDuration"),$P(),tS(),tS(),eS(16,"button",79),uS("click",function(){return Nk(n),fS(3).acceptConfig()}),ZP(17,80),tS(),tS()}if(2&e){var r=fS(3);pb(2),qP(r.viewInfo.creator)(r.viewInfo.partTypeName),WP(2),pb(3),XE("ngIf","CREATOR"===r.viewInfo.firstPlayer),pb(1),XE("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),pb(1),XE("ngIf","RANDOM"===r.viewInfo.firstPlayer),pb(4),qP(hT(11,7,r.viewInfo.maximalMoveDuration||0)),WP(9),pb(4),qP(hT(15,9,r.viewInfo.totalPartDuration||0)),WP(13)}}function $ve(e,t){if(1&e&&(eS(0,"div"),eS(1,"div",68),eS(2,"div",69),eS(3,"p"),ZP(4,70),tS(),tS(),eS(5,"div",71),YE(6,Vve,4,1,"div",72),YE(7,Hve,18,11,"ng-template",null,73,xT),tS(),tS(),tS()),2&e){var n=KE(8),r=fS(2);pb(6),XE("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Zve(e,t){if(1&e&&(rS(0),ZP(1,86),iS()),2&e){var n=fS(3);pb(1),qP(n.viewInfo.creator),WP(1)}}function qve(e,t){if(1&e&&ZP(0,87),2&e){var n=fS(3);qP(n.viewInfo.creator)(n.viewInfo.chosenOpponent),WP(0)}}function Wve(e,t){if(1&e&&(eS(0,"div",68),eS(1,"div",69),eS(2,"p"),ZP(3,84),tS(),tS(),eS(4,"div",71),eS(5,"p"),YE(6,Zve,2,1,"ng-container",17),YE(7,qve,1,2,"ng-template",null,85,xT),tS(),tS(),tS()),2&e){var n=KE(8),r=fS(2);pb(6),XE("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function jve(e,t){if(1&e&&(eS(0,"div",1),YE(1,Uve,74,27,"div",2),YE(2,$ve,9,2,"div",2),YE(3,Wve,9,2,"div",3),tS()),2&e){var n=fS();pb(1),XE("ngIf",n.viewInfo.userIsCreator),pb(1),XE("ngIf",n.viewInfo.userIsChosenOpponent),pb(1),XE("ngIf",n.viewInfo.userIsObserver)}}var Yve=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.configRoomService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=O7,this.gameStartNotification=new gT,this.gameStarted=!1,this.gameExists=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new Cy,this.allUserInterval=fB.empty(),this.ownTokenInterval=fB.empty(),this.selfSubscription=function(){},this.allDocDeleted=!1,sB(e.VERBOSE,"PartCreationComponent constructed")}return Wg(e,[{key:"ngOnInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=17;break;case 9:return n.next=11,t.updateUserDocWithObservedPart();case 11:return n.next=13,t.startSendingPresenceTokens();case 13:t.gameExists=!0,t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),sB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 17:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;f7(e.isPresent()&&e.get()!==E7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),f7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[P7.RANDOM.value,ZR.required],maximalMoveDuration:[O7.NORMAL_MOVE_DURATION,ZR.required],partType:["STANDARD",ZR.required],totalPartDuration:[O7.NORMAL_PART_DURATION,ZR.required],chosenOpponent:["",ZR.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return sB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomService.subscribeToChanges(this.partId,n),this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return oB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(Tve(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=oB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==T7.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Tve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Tve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Tve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Tve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=oB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===T7.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==T7.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==T7.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Ud||(Ud=_g(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Vd||(Vd=_g(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(Bd||(Bd=_g(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(O7.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(O7.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(O7.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(O7.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.configRoomService.setChosenOpponent(i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return oB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(s,O7.of(r),i,P7.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.candidates);case 12:sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(sB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=oB.getNonNullable(n.currentConfigRoom),a=oB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(zd||(zd=_g([""," left the game, please pick another opponent."])),a))),n.currentConfigRoom=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observePlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(sB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Gd||(Gd=_g(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return oB.getNonNullable(this.currentConfigRoom).partStatus===T7.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=oB.getNonNullable(this.currentConfigRoom);sB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,sB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observePlayers",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:f7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),r=t.connectedUserService.user.get().id,t.allUserInterval=fB.of(window.setInterval(aB(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=oB.getNonNullable(t.currentConfigRoom),i=t.lastToken,r!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(i);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(i);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 3:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=oB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(0==(oB.getNonNullable(e.currentConfigRoom).partStatus===T7.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),f7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=Gg(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(l7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Ove(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=oB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent();case 5:return n.abrupt("return",t.configRoomService.removeCandidate(e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:f7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=fB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){f7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=fB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription()}},{key:"acceptConfig",value:function(){return sB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,oB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),t.gameExists&&t.configRoomService.unsubscribe(),r=t.connectedUserService.user.get(),!0===t.gameStarted){n.next=18;break}if(null!==t.currentConfigRoom){n.next=5;break}return n.abrupt("return",void sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 5:if(r.id!==t.currentConfigRoom.creator.id||!1!==t.allDocDeleted){n.next=11;break}return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=9,t.cancelGameCreation();case 9:n.next=18;break;case 11:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=18;break}return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=16,t.connectedUserService.removeObservedPart();case 16:return n.next=18,t.configRoomService.cancelJoining();case 18:case"end":return n.stop()}},n)}))()}}]),e}();function Kve(e,t){if(1&e){var n=aS();eS(0,"button",3),uS("click",function(){return Nk(n),fS().addTime()}),ZP(1,4),tS()}if(2&e){var r=fS();pb(1),qP(r.timeToAdd),WP(1)}}Yve.VERBOSE=!1,Yve.TOKEN_INTERVAL=5e3,Yve.TOKEN_TIMEOUT=2*Yve.TOKEN_INTERVAL,Yve.\u0275fac=function(e){return new(e||Yve)(QE(jL),QE(S7),QE(z7),QE(B7),QE(y7),QE(w7),QE(mM),QE(c7))},Yve.\u0275cmp=Hm({type:Yve,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(Hd||(Hd=_g(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize($d||($d=_g(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(Zd||(Zd=_g(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(qd||(qd=_g(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(Wd||(Wd=_g(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(jd||(jd=_g(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(Yd||(Yd=_g(["Maximal turn duration: "]))),$localize(Kd||(Kd=_g(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(Qd||(Qd=_g(["Blitz"]))),$localize(Xd||(Xd=_g(["Maximal turn duration: "]))),$localize(Jd||(Jd=_g(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(ev||(ev=_g(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(tv||(tv=_g(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(nv||(nv=_g(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(rv||(rv=_g(["Cancel game"]))),$localize(iv||(iv=_g(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(av||(av=_g(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(ov||(ov=_g(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(sv||(sv=_g(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(uv||(uv=_g(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(cv||(cv=_g(["Name"]))),$localize(lv||(lv=_g(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(fv||(fv=_g(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(hv||(hv=_g(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(dv||(dv=_g(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(vv||(vv=_g(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(pv||(pv=_g(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(gv||(gv=_g(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(yv||(yv=_g(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(mv||(mv=_g(["Accept and start"]))),$localize(kv||(kv=_g(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Cv||(Cv=_g(["you play first"]))),$localize(wv||(wv=_g(["the first player is selected randomly"]))),$localize(_v||(_v=_g(["One moment..."]))),["proposalSent",""],$localize(bv||(bv=_g(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Ev||(Ev=_g(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&YE(0,jve,4,3,"div",0),2&e&&XE("ngIf",t.viewInfo)},directives:[UA,jx,gx,eM,NA,VR,Qx,px,nM,LA],pipes:[Ive],encapsulation:2});var Qve=function(){var e=function(){function e(){Zg(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new gT,this.addTimeToOpponent=new gT,this.cssClasses=e.SAFE_TIME}return Wg(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(sB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(sB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(sB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){sB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(sB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(sB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){sB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Hm({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Sv||(Sv=_g(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"p",1),FS(2),fT(3,"number"),tS(),YE(4,Kve,2,1,"button",2),tS()),2&e&&(XE("ngClass",t.getTimeClass()),pb(2),BS("",t.displayedMinute,":",function(e,t,n,r){var i=xk(),a=bk(i,23);return vT(i,dT(i,23)?lT(i,Hk(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),pb(2),XE("ngIf",t.canAddTime))},directives:[NA,UA],pipes:[zA],encapsulation:2}),e}(),Xve=["partCreation"],Jve=["chatComponent"],epe=["chronoZeroGlobal"],tpe=["chronoOneGlobal"],npe=["chronoZeroTurn"],rpe=["chronoOneTurn"];function ipe(e,t){if(1&e){var n=aS();eS(0,"app-part-creation",5,6),uS("gameStartNotification",function(e){return Nk(n),fS().startGame(e)}),tS()}2&e&&XE("partId",fS().currentPartId)}function ape(e,t){1&e&&(rS(0),ZP(1,40),iS())}function ope(e,t){if(1&e&&(rS(0),ZP(1,41),iS()),2&e){var n=fS(4);pb(1),qP(null==n.currentPlayer?null:n.currentPlayer.name),WP(1)}}function spe(e,t){if(1&e&&(eS(0,"p",37),YE(1,ape,2,0,"ng-container",38),YE(2,ope,2,1,"ng-template",null,39,xT),tS()),2&e){var n=KE(3),r=fS(3);pb(1),XE("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function upe(e,t){if(1&e&&(eS(0,"div",33),eS(1,"p",34),ZP(2,35),tS(),YE(3,spe,4,2,"p",36),tS()),2&e){var n=fS(2);pb(2),qP(n.currentPart.getTurn()+1),WP(2),pb(1),XE("ngIf",!1===n.endGame)}}function cpe(e,t){if(1&e&&(eS(0,"p",42),FS(1),tS()),2&e){var n=fS(2);XE("ngClass",n.getPlayerNameClass(n.Player.ZERO)),pb(1),US(n.players[0].get().name)}}function lpe(e,t){if(1&e&&(eS(0,"p",43),ZP(1,44),tS()),2&e){var n=fS(2);pb(1),qP(n.gameComponent.scores.get()[0]),WP(1)}}function fpe(e,t){if(1&e&&(eS(0,"p",45),FS(1),tS()),2&e){var n=fS(2);XE("ngClass",n.getPlayerNameClass(n.Player.ONE)),pb(1),US(n.players[1].get().name)}}function hpe(e,t){if(1&e&&(eS(0,"p",46),ZP(1,47),tS()),2&e){var n=fS(2);pb(1),qP(n.gameComponent.scores.get()[1]),WP(1)}}function dpe(e,t){if(1&e){var n=aS();eS(0,"button",56),uS("click",function(){return Nk(n),fS(3).resign()}),ZP(1,57),tS()}}function vpe(e,t){if(1&e){var n=aS();eS(0,"button",58),uS("click",function(){return Nk(n),fS(3).proposeDraw()}),ZP(1,59),tS()}}function ppe(e,t){if(1&e){var n=aS();eS(0,"button",60),uS("click",function(){return Nk(n),fS(3).acceptDraw()}),ZP(1,61),tS()}}function gpe(e,t){if(1&e){var n=aS();eS(0,"button",62),uS("click",function(){return Nk(n),fS(3).refuseDraw()}),ZP(1,63),tS()}}function ype(e,t){if(1&e){var n=aS();eS(0,"button",64),uS("click",function(){return Nk(n),fS(3).gameComponent.pass()}),ZP(1,65),tS()}}function mpe(e,t){if(1&e){var n=aS();eS(0,"button",66),uS("click",function(){return Nk(n),fS(3).acceptTakeBack()}),ZP(1,67),tS()}}function kpe(e,t){if(1&e){var n=aS();eS(0,"button",68),uS("click",function(){return Nk(n),fS(3).refuseTakeBack()}),ZP(1,69),tS()}}function Cpe(e,t){if(1&e){var n=aS();eS(0,"button",70),uS("click",function(){return Nk(n),fS(3).askTakeBack()}),ZP(1,71),tS()}}function wpe(e,t){if(1&e&&(rS(0),YE(1,dpe,2,0,"button",48),YE(2,vpe,2,0,"button",49),YE(3,ppe,2,0,"button",50),YE(4,gpe,2,0,"button",51),YE(5,ype,2,0,"button",52),YE(6,mpe,2,0,"button",53),YE(7,kpe,2,0,"button",54),YE(8,Cpe,2,0,"button",55),iS()),2&e){var n=fS(2);pb(1),XE("ngIf",n.canResign()),pb(1),XE("ngIf",n.canProposeDraw()),pb(1),XE("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),pb(1),XE("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),pb(1),XE("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),pb(1),XE("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),pb(1),XE("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),pb(1),XE("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function _pe(e,t){1&e&&(eS(0,"div"),eS(1,"p",73),ZP(2,74),tS(),tS())}function bpe(e,t){1&e&&(eS(0,"p",78),ZP(1,79),tS())}function Epe(e,t){1&e&&(eS(0,"p",80),ZP(1,81),tS())}function Spe(e,t){1&e&&(eS(0,"p",82),ZP(1,83),tS())}function Ppe(e,t){if(1&e&&(eS(0,"div"),YE(1,bpe,2,0,"p",75),YE(2,Epe,2,0,"p",76),YE(3,Spe,2,0,"p",77),tS()),2&e){var n=fS(3);pb(1),XE("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),pb(1),XE("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),pb(1),XE("ngIf",!1===n.isPlaying())}}function Ope(e,t){1&e&&(eS(0,"p",86),ZP(1,87),tS())}function Tpe(e,t){1&e&&(eS(0,"p",88),ZP(1,89),tS())}function Ipe(e,t){if(1&e&&(eS(0,"p",88),ZP(1,90),tS()),2&e){var n=fS(4);pb(1),qP(n.currentPart.getWinner().get().name),WP(1)}}function Ape(e,t){if(1&e&&(eS(0,"div"),YE(1,Ope,2,0,"p",84),YE(2,Tpe,2,0,"p",85),YE(3,Ipe,2,1,"p",85),tS()),2&e){var n=fS(3);pb(1),XE("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),pb(1),XE("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pb(1),XE("ngIf",!1===n.isPlaying())}}function Rpe(e,t){if(1&e&&(eS(0,"p",86),ZP(1,91),tS()),2&e){var n=fS(4);pb(1),qP(n.currentPart.getLoser().get().name),WP(1)}}function xpe(e,t){1&e&&(eS(0,"p",88),ZP(1,92),tS())}function Mpe(e,t){if(1&e&&(eS(0,"p",88),ZP(1,93),tS()),2&e){var n=fS(4);pb(1),qP(n.currentPart.getLoser().get().name),WP(1)}}function Npe(e,t){if(1&e&&(eS(0,"div"),YE(1,Rpe,2,1,"p",84),YE(2,xpe,2,0,"p",85),YE(3,Mpe,2,1,"p",85),tS()),2&e){var n=fS(3);pb(1),XE("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),pb(1),XE("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pb(1),XE("ngIf",!1===n.isPlaying())}}function Dpe(e,t){1&e&&(eS(0,"p",95),ZP(1,96),tS())}function Lpe(e,t){if(1&e&&(eS(0,"p",95),ZP(1,97),tS()),2&e){var n=fS(4);pb(1),qP(n.currentPart.getLoser().get().name),WP(1)}}function Fpe(e,t){if(1&e&&(eS(0,"div"),YE(1,Dpe,2,0,"p",94),YE(2,Lpe,2,1,"p",94),tS()),2&e){var n=fS(3);pb(1),XE("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pb(1),XE("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Upe(e,t){if(1&e&&(eS(0,"div",72),nS(1,"hr"),YE(2,_pe,3,0,"div",26),YE(3,Ppe,4,3,"div",26),YE(4,Ape,4,3,"div",26),YE(5,Npe,4,3,"div",26),YE(6,Fpe,3,2,"div",26),tS()),2&e){var n=fS(2);pb(2),XE("ngIf",n.currentPart.isHardDraw()),pb(1),XE("ngIf",n.currentPart.isAgreedDraw()),pb(1),XE("ngIf",n.currentPart.isWin()),pb(1),XE("ngIf",n.currentPart.isTimeout()),pb(1),XE("ngIf",n.currentPart.isResign())}}function Vpe(e,t){1&e&&(eS(0,"button",98),ZP(1,99),tS())}function Bpe(e,t){if(1&e){var n=aS();eS(0,"button",100),uS("click",function(){return Nk(n),fS(2).proposeRematch()}),ZP(1,101),tS()}}function zpe(e,t){if(1&e){var n=aS();eS(0,"button",102),uS("click",function(){return Nk(n),fS(2).acceptRematch()}),ZP(1,103),tS()}}function Gpe(e,t){if(1&e){var n=aS();eS(0,"div",7),eS(1,"div",8),eS(2,"div",9),YE(3,upe,4,2,"div",10),eS(4,"div",11),YE(5,cpe,2,2,"p",12),YE(6,lpe,2,1,"p",13),eS(7,"app-count-down",14,15),uS("outOfTimeAction",function(){Nk(n);var e=fS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return Nk(n),fS().addGlobalTime()}),tS(),eS(9,"app-count-down",16,17),uS("outOfTimeAction",function(){Nk(n);var e=fS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return Nk(n),fS().addTurnTime()}),tS(),tS(),eS(11,"p",18),ZP(12,19),tS(),eS(13,"div",11),YE(14,fpe,2,2,"p",20),YE(15,hpe,2,1,"p",21),eS(16,"app-count-down",22,23),uS("outOfTimeAction",function(){Nk(n);var e=fS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return Nk(n),fS().addGlobalTime()}),tS(),eS(18,"app-count-down",24,25),uS("outOfTimeAction",function(){Nk(n);var e=fS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return Nk(n),fS().addTurnTime()}),tS(),tS(),nS(20,"hr"),YE(21,wpe,9,8,"ng-container",26),YE(22,Upe,7,5,"div",27),YE(23,Vpe,2,0,"button",28),YE(24,Bpe,2,0,"button",29),YE(25,zpe,2,0,"button",30),tS(),tS(),eS(26,"div",31),eS(27,"div",32),nS(28,"app-game-includer"),tS(),tS(),tS()}if(2&e){var r=fS();pb(3),XE("ngIf",r.currentPart),pb(2),XE("ngIf",r.players[0].isPresent()),pb(1),XE("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),pb(1),XE("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.observerRole===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),pb(2),XE("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.observerRole===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),pb(5),XE("ngIf",r.players[1].isPresent()),pb(1),XE("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),pb(1),XE("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.observerRole===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),pb(2),XE("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.observerRole===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),pb(3),XE("ngIf",r.isPlaying()),pb(1),XE("ngIf",r.endGame),pb(1),XE("ngIf",r.endGame),pb(1),XE("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),pb(1),XE("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),pb(1),XE("ngClass",r.getBoardHighlight())}}var Hpe=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Pv||(Pv=_g(["The game you tried to join does not exist."])))},e}(),$pe=Wg(function e(t){Zg(this,e),this.value=t});$pe.PRE_START_DOC=new $pe("PRE_START_DOC"),$pe.STARTING_DOC=new $pe("STARTING_DOC"),$pe.DUPLICATE=new $pe("DUPLICATE"),$pe.MOVE_WITHOUT_TIME=new $pe("MOVE_WITHOUT_TIME"),$pe.MOVE=new $pe("MOVE"),$pe.REQUEST=new $pe("REQUEST"),$pe.END_GAME=new $pe("END_GAME"),$pe.END_GAME_WITHOUT_TIME=new $pe("END_GAME_WITHOUT_TIME"),$pe.ACCEPT_TAKE_BACK_WITHOUT_TIME=new $pe("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Zpe=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s,u){var c;return Zg(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=fB.empty(),c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Ov||(Ov=_g(["5 minutes"]))),c.turnTimeMessage=$localize(Tv||(Tv=_g(["30 seconds"]))),sB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return Wg(n,[{key:"extractPartIdFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.observerRole===e}},{key:"isOpponent",value:function(e){return this.observerRole!==e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!zde.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=Hpe.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=bve.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof wN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.getUserObs().subscribe(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 6:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),f7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;sB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new d7(t.currentPartId,e),sB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,sB(n.VERBOSE,a===$pe.REQUEST?"UpdateType: Request("+oB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===$pe.REQUEST?8:r.t0===$pe.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===$pe.DUPLICATE?12:r.t0===$pe.END_GAME_WITHOUT_TIME?13:r.t0===$pe.END_GAME?14:r.t0===$pe.MOVE_WITHOUT_TIME?15:r.t0===$pe.MOVE?16:r.t0===$pe.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(oB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void f7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(f7(a===$pe.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(N7.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=Sve.from(null!=this.currentPart?this.currentPart.data:null,e.data);sB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return $pe.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?$pe.ACCEPT_TAKE_BACK_WITHOUT_TIME:$pe.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?$pe.MOVE_WITHOUT_TIME:$pe.MOVE:null==t.modified.lastUpdateTime?$pe.MOVE_WITHOUT_TIME:$pe.MOVE;if(null==e.data.beginning)return $pe.PRE_START_DOC;if(e.data.result!==h7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?$pe.END_GAME_WITHOUT_TIME:$pe.END_GAME}return f7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),$pe.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);f7(null!=r,"oldTime should not be null"),f7(null!=i,"updateTime should not be null");var a=N7.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(oB.getNonNullable(r),oB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=Ove(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){sB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){sB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();for(var t=U7.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;r.node.gameState.turn<t.length;){var i=r.node.gameState.turn,a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,r.node.gameState),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';f7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){sB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=N7.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(sB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=N7.fromTurn(e.data.turn);this.endGame=!0,[h7.VICTORY,h7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(f7(!0===[h7.RESIGN,h7.TIMEOUT,h7.HARD_DRAW,h7.AGREED_DRAW_BY_ZERO,h7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),sB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){sB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===yte.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(f7(r===yte.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return f7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&this.currentPart.data.request.data.player===this.observerRole.getOpponent().value)&&this.getTakeBackRequester()===M7.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return M7.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?D7.getPlayer(e):M7.NONE}},{key:"canProposeDraw",value:function(){return f7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&D7.getPlayer(this.currentPart.data.request)===this.observerRole.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===M7.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==M7.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return M7.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?D7.getPlayer(e):M7.NONE}},{key:"onRequest",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(sB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=D7.getPlayer(e).getOpponent(),r.isPlayer(a)&&(sB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",D7.getTypeGame(e),D7.getPartId(e)]);case 15:return 3e4,o=N7.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=N7.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return oB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(sB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=N7.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;sB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[fB.of(e.data.playerZero),fB.ofNullable(e.data.playerOne)],f7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=fB.empty();if(this.players[0].get().id===this.authUser.id?(this.observerRole=N7.ZERO,r=this.players[1]):this.players[1].get().id===this.authUser.id?(this.observerRole=N7.ONE,r=this.players[0]):this.observerRole=M7.NONE,r.isPresent()){this.opponentSubscription=fB.of(this.userService.observeUser(r.get().id,function(e){f7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent={id:r.get().id,name:oB.getNonNullable(e.get().username)}}))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),sB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===yte.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.observerRole,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.observerRole,a=e.getPlayer(),o=e.players[(e.observerRole.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.observerRole,t.stopCountdownsFor(e),e!==t.observerRole){r.next=8;break}return o=oB.getNonNullable(t.opponent),r.next=6,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 6:r.next=13;break;case 8:if(f7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=13;break}return s=oB.getNonNullable(t.opponent),r.next=12,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,s);case 12:t.endGame=!0;case 13:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new d7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.observerRole);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.observerRole);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return f7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"acceptDraw",value:function(){return f7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"refuseDraw",value:function(){return f7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"askTakeBack",value:function(){return f7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"acceptTakeBack",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.observerRole,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return f7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"startCountDownFor",value:function(e){sB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===N7.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===N7.ZERO?(this.chronoZeroGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===N7.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){sB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===N7.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===N7.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return f7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.observerRole,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.observerRole,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=N7.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===N7.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===N7.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving()),sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}]),n}(Eve);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(iO),QE(OD),QE(jL),QE(c7),QE(S7),QE(w7),QE(z7))},e.\u0275cmp=Hm({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(IT(Xve,5),IT(Jve,5),IT(epe,5),IT(tpe,5),IT(npe,5),IT(rpe,5)),2&e)&&(TT(n=AT())&&(t.partCreation=n.first),TT(n=AT())&&(t.chatComponent=n.first),TT(n=AT())&&(t.chronoZeroGlobal=n.first),TT(n=AT())&&(t.chronoOneGlobal=n.first),TT(n=AT())&&(t.chronoZeroTurn=n.first),TT(n=AT())&&(t.chronoOneTurn=n.first))},features:[RE],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Iv||(Iv=_g(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Av||(Av=_g(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(Rv||(Rv=_g(["It is your turn."]))),$localize(xv||(xv=_g(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Mv||(Mv=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(Nv||(Nv=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Dv||(Dv=_g(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Lv||(Lv=_g(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Fv||(Fv=_g(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Uv||(Uv=_g(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Vv||(Vv=_g(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Bv||(Bv=_g(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(zv||(zv=_g(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Gv||(Gv=_g(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(Hv||(Hv=_g(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize($v||($v=_g(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(Zv||(Zv=_g(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(qv||(qv=_g(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(Wv||(Wv=_g(["You won."]))),[1,"title"],$localize(jv||(jv=_g(["You lost."]))),$localize(Yv||(Yv=_g(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(Kv||(Kv=_g(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(Qv||(Qv=_g(["You reached your time limit."]))),$localize(Xv||(Xv=_g(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(Jv||(Jv=_g(["You resigned."]))),$localize(ep||(ep=_g(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(tp||(tp=_g(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(np||(np=_g(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(rp||(rp=_g(["Accept to play again"])))]},template:function(e,t){1&e&&(YE(0,ipe,2,1,"app-part-creation",0),YE(1,Gpe,29,27,"div",1),eS(2,"div",2),eS(3,"div",3),nS(4,"app-chat",4),tS(),tS()),2&e&&(XE("ngIf",!1===t.gameStarted),pb(1),XE("ngIf",t.gameStarted),pb(3),XE("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[UA,lve,Yve,Qve,NA,_ve,KL],encapsulation:2}),e}();function qpe(e,t){if(1&e&&(eS(0,"option",25),FS(1),tS()),2&e){var n=t.$implicit;XE("value",n.name),pb(1),US(n.name)}}function Wpe(e,t){if(1&e&&(eS(0,"option",25),ZP(1,29),tS()),2&e){var n=t.$implicit;XE("value",n),pb(1),qP(n),WP(1)}}var jpe=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Ype(e,t){if(1&e){var n=aS();eS(0,"select",26),uS("ngModelChange",function(e){return Nk(n),fS(2).aiDepths[0]=e})("change",function(){Nk(n);var e=fS(2);return e.updatePlayer(e.Player.ZERO)}),eS(1,"option",27),ZP(2,28),tS(),YE(3,Wpe,2,2,"option",16),tS()}2&e&&(XE("ngModel",fS(2).aiDepths[0]),pb(3),XE("ngForOf",aT(2,jpe)))}function Kpe(e,t){if(1&e&&(eS(0,"p",30),ZP(1,31),tS()),2&e){var n=fS(2);pb(1),qP(n.gameComponent.scores.get()[0]),WP(1)}}function Qpe(e,t){if(1&e&&(eS(0,"option",25),FS(1),tS()),2&e){var n=t.$implicit;XE("value",n.name),pb(1),US(n.name)}}function Xpe(e,t){if(1&e&&(eS(0,"option",25),ZP(1,34),tS()),2&e){var n=t.$implicit;XE("value",n),pb(1),qP(n),WP(1)}}function Jpe(e,t){if(1&e){var n=aS();eS(0,"select",32),uS("ngModelChange",function(e){return Nk(n),fS(2).aiDepths[1]=e})("change",function(){Nk(n);var e=fS(2);return e.updatePlayer(e.Player.ONE)}),eS(1,"option",27),ZP(2,33),tS(),YE(3,Xpe,2,2,"option",16),tS()}2&e&&(XE("ngModel",fS(2).aiDepths[1]),pb(3),XE("ngForOf",aT(2,jpe)))}function ege(e,t){if(1&e&&(eS(0,"p",35),ZP(1,36),tS()),2&e){var n=fS(2);pb(1),qP(n.gameComponent.scores.get()[1]),WP(1)}}function tge(e,t){if(1&e&&(eS(0,"h4"),ZP(1,40),tS()),2&e){var n=fS(3);pb(1),qP(n.winner.get()),WP(1)}}function nge(e,t){1&e&&(eS(0,"h4",41),ZP(1,42),tS())}function rge(e,t){if(1&e&&(eS(0,"div",37),YE(1,tge,2,1,"h4",38),YE(2,nge,2,0,"h4",39),tS()),2&e){var n=fS(2);pb(1),XE("ngIf",n.winner.isPresent()),pb(1),XE("ngIf",n.winner.isAbsent())}}function ige(e,t){if(1&e){var n=aS();eS(0,"div",6),eS(1,"div",7),eS(2,"p",8),ZP(3,9),tS(),tS(),eS(4,"div",10),eS(5,"div",11),eS(6,"div",12),eS(7,"select",13),uS("change",function(){Nk(n);var e=fS();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return Nk(n),fS().playerSelection[0]=e}),eS(8,"option",14),ZP(9,15),tS(),YE(10,qpe,2,2,"option",16),tS(),tS(),eS(11,"div",12),YE(12,Ype,4,3,"select",17),tS(),YE(13,Kpe,2,1,"p",18),tS(),eS(14,"div",19),eS(15,"div",12),eS(16,"select",20),uS("change",function(){Nk(n);var e=fS();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return Nk(n),fS().playerSelection[1]=e}),eS(17,"option",14),ZP(18,21),tS(),YE(19,Qpe,2,2,"option",16),tS(),tS(),eS(20,"div",12),YE(21,Jpe,4,3,"select",22),tS(),YE(22,ege,2,1,"p",23),tS(),tS(),YE(23,rge,3,2,"div",24),tS()}if(2&e){var r=fS();pb(3),qP(r.gameComponent.rules.node.gameState.turn+1),WP(3),pb(4),XE("ngModel",r.playerSelection[0]),pb(3),XE("ngForOf",r.gameComponent.availableMinimaxes),pb(2),XE("ngIf",!1===r.players[0].equalsValue("human")),pb(1),XE("ngIf",r.gameComponent.scores.isPresent()),pb(3),XE("ngModel",r.playerSelection[1]),pb(3),XE("ngForOf",r.gameComponent.availableMinimaxes),pb(2),XE("ngIf",!1===r.players[1].equalsValue("human")),pb(1),XE("ngIf",r.gameComponent.scores.isPresent()),pb(1),XE("ngIf",r.endGame)}}function age(e,t){if(1&e&&(rS(0),FS(1),nS(2,"br"),iS()),2&e){var n=t.$implicit,r=fS(3);pb(1),VS(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function oge(e,t){if(1&e&&(rS(0),YE(1,age,3,1,"ng-container",48),FS(2),nS(3,"br"),FS(4),nS(5,"br"),iS()),2&e){var n=fS(2);pb(1),XE("ngForOf",n.gameComponent.availableMinimaxes),pb(1),VS(" Created ",n.getCreatedNodes()," nodes."),pb(2),VS(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function sge(e,t){if(1&e){var n=aS();eS(0,"button",49),uS("click",function(){return Nk(n),fS(2).gameComponent.pass()}),ZP(1,50),tS()}}function uge(e,t){if(1&e){var n=aS();eS(0,"button",51),uS("click",function(){return Nk(n),fS(2).takeBack()}),ZP(1,52),tS()}}function cge(e,t){if(1&e){var n=aS();eS(0,"div",43),YE(1,oge,6,3,"ng-container",38),YE(2,sge,2,0,"button",44),YE(3,uge,2,0,"button",45),eS(4,"button",46),uS("click",function(){return Nk(n),fS().restartGame()}),ZP(5,47),tS(),tS()}if(2&e){var r=fS();pb(1),XE("ngIf",r.gameComponent.rules.node.move),pb(1),XE("ngIf",!1===r.endGame&&r.gameComponent.canPass),pb(1),XE("ngIf",r.canTakeBack())}}var lge=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=fB.empty(),u.botTimeOut=1e3,u.players=[fB.of(u.playerSelection[0]),fB.of(u.playerSelection[1])],u.observerRole=N7.ZERO,sB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return Wg(n,[{key:"getCreatedNodes",value:function(){return pte.createdNodes}},{key:"getMinimaxTime",value:function(){return pte.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=fB.of(this.playerSelection[e.value]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=fB.of($localize(ip||(ip=_g(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return fB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?fB.empty():fB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return f7((r=t.gameComponent.rules).getGameStatus(r.node)===yte.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),o7.SUCCESS):(t.messageDisplayer.criticalMessage($localize(ap||(ap=_g(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),l7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new gte(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=fB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(Eve);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(iO),QE(OD),QE(S7),QE(jL),QE(c7),QE(NO))},e.\u0275cmp=Hm({type:e,selectors:[["app-local-game-wrapper"]],features:[RE],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(op||(op=_g(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(sp||(sp=_g(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(up||(up=_g(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(cp||(cp=_g(["Pick the level"]))),$localize(lp||(lp=_g(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(fp||(fp=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(hp||(hp=_g(["Pick the level"]))),$localize(dp||(dp=_g(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(vp||(vp=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(pp||(pp=_g(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(gp||(gp=_g(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(yp||(yp=_g(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(mp||(mp=_g(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(kp||(kp=_g(["Take back move"])))]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"div",1),YE(2,ige,24,10,"div",2),YE(3,cge,6,3,"div",3),tS(),eS(4,"div",4),eS(5,"div",5),nS(6,"app-game-includer"),tS(),tS(),tS()),2&e&&(pb(2),XE("ngIf",t.gameComponent),pb(1),XE("ngIf",t.gameComponent),pb(1),XE("ngClass",t.getBoardHighlight()))},directives:[UA,NA,_ve,aM,px,Wx,oM,lM,LA],encapsulation:2,changeDetection:0}),e}(),fge=function(){var e=Wg(function e(){Zg(this,e)});return e.STEP_FINISHED=function(){return $localize(Cp||(Cp=_g(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(wp||(wp=_g(["This step is not expecting any move from your part."])))},e}();function hge(e,t){if(1&e&&(eS(0,"div",20),eS(1,"div",21),ZP(2,22),tS(),eS(3,"div",23),FS(4),tS(),tS()),2&e){var n=fS();pb(4),US(n.currentReason.get())}}function dge(e,t){if(1&e){var n=aS();eS(0,"button",24),uS("click",function(){return Nk(n),fS().retry()}),ZP(1,25),tS()}}function vge(e,t){1&e&&(rS(0),ZP(1,30),iS())}function pge(e,t){1&e&&(rS(0),ZP(1,31),iS())}function gge(e,t){if(1&e&&YE(0,pge,2,0,"ng-container",27),2&e){fS();var n=KE(5),r=fS();XE("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function yge(e,t){1&e&&(rS(0),ZP(1,32),iS())}function mge(e,t){if(1&e){var n=aS();eS(0,"button",26),uS("click",function(){return Nk(n),fS().next()}),YE(1,vge,2,0,"ng-container",27),YE(2,gge,1,2,"ng-template",null,28,xT),YE(4,yge,2,0,"ng-template",null,29,xT),tS()}if(2&e){var r=KE(3),i=fS();pb(1),XE("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function kge(e,t){if(1&e){var n=aS();eS(0,"button",33),uS("click",function(){return Nk(n),fS().start()}),ZP(1,34),tS()}}function Cge(e,t){if(1&e){var n=aS();eS(0,"button",35),uS("click",function(){return Nk(n),fS().playLocally()}),ZP(1,36),tS()}}function wge(e,t){if(1&e){var n=aS();eS(0,"button",37),uS("click",function(){return Nk(n),fS().createGame()}),ZP(1,38),tS()}}function _ge(e,t){if(1&e){var n=aS();eS(0,"button",39),uS("click",function(){return Nk(n),fS().showSolution()}),ZP(1,40),tS()}}function bge(e,t){if(1&e&&(rS(0),eS(1,"option",42),FS(2),tS(),iS()),2&e){var n=fS(),r=n.index,i=n.$implicit;pb(1),dS("id","step_",r,""),XE("value",r),pb(1),US(i.title)}}function Ege(e,t){1&e&&(rS(0),FS(1,"v "),iS())}function Sge(e,t){1&e&&FS(0,"x ")}function Pge(e,t){if(1&e&&(eS(0,"option",43),YE(1,Ege,2,0,"ng-container",27),YE(2,Sge,1,0,"ng-template",null,44,xT),eS(4,"span",45),FS(5),tS(),tS()),2&e){var n=KE(3),r=fS(),i=r.index,a=r.$implicit,o=fS();XE("value",i),pb(1),XE("ngIf",o.stepFinished[i])("ngIfElse",n),pb(3),dS("id","step_",i,""),pb(1),US(a.title)}}function Oge(e,t){if(1&e&&(rS(0),YE(1,bge,3,3,"ng-container",27),YE(2,Pge,6,5,"ng-template",null,41,xT),iS()),2&e){var n=t.index,r=KE(3),i=fS();pb(1),XE("ngIf",n===i.stepIndex)("ngIfElse",r)}}var Tge=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(_p||(_p=_g(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=fB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,sB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.observerRole=N7.ZERO,u}return Wg(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){sB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=fB.empty(),this.gameComponent.rules.node=new gte(t.state,fB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],f7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.gameState,(o=oB.getNonNullable(i.predicate)(e,a)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=fB.of(o.getReason())):i.isAnyMove()?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(f7(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=fB.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){sB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(sB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=fB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return o7.failure(fge.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,oB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),o7.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),o7.SUCCESS):o7.failure(fge.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=fB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Gg(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:sB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),f7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof cte?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(Eve);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(QE(iO),QE(OD),QE(jL),QE(c7),QE(NO),QE(S7))},e.\u0275cmp=Hm({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[RE],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(bp||(bp=_g(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Ep||(Ep=_g(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Sp||(Sp=_g(["Ok"]))),$localize(Pp||(Pp=_g(["Continue"]))),$localize(Op||(Op=_g(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Tp||(Tp=_g(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Ip||(Ip=_g(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Ap||(Ap=_g(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(Rp||(Rp=_g(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"div",1),eS(2,"div",2),nS(3,"progress",3),eS(4,"div",4),eS(5,"p",5),FS(6),tS(),nS(7,"p",6),tS(),YE(8,hge,5,1,"div",7),eS(9,"div",8),YE(10,dge,2,0,"button",9),YE(11,mge,6,2,"button",10),YE(12,kge,2,0,"button",11),YE(13,Cge,2,0,"button",12),YE(14,wge,2,0,"button",13),YE(15,_ge,2,0,"button",14),eS(16,"div",15),eS(17,"select",16),uS("change",function(e){return t.changeStep(e)}),YE(18,Oge,4,2,"ng-container",17),tS(),tS(),tS(),tS(),tS(),eS(19,"div",18),eS(20,"div",19),nS(21,"app-game-includer"),tS(),tS(),tS()),2&e&&(pb(3),$E("value",t.successfulSteps)("max",t.getNumberOfSteps()),pb(3),zS("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),pb(1),XE("innerHTML",t.currentMessage,s_),pb(1),XE("ngIf",t.currentReason.isPresent()),pb(2),XE("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),pb(1),XE("ngIf",!1===t.tutorialOver),pb(1),XE("ngIf",t.tutorialOver),pb(1),XE("ngIf",t.tutorialOver),pb(1),XE("ngIf",t.tutorialOver),pb(1),XE("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),pb(3),XE("ngForOf",t.steps),pb(1),XE("ngClass",t.getBoardHighlight()))},directives:[UA,LA,NA,_ve,oM,lM],encapsulation:2,changeDetection:0}),e}();function Ige(e,t){if(1&e&&(eS(0,"div",35),eS(1,"div",36),ZP(2,37),tS(),eS(3,"div",38),FS(4),tS(),tS()),2&e){var n=fS();pb(4),US(n.errorMessage)}}var Age=function(){return["/login"]},Rge=function(){var e=function(){function e(t,n){Zg(this,e),this.authService=t,this.router=n,this.faEye=Q7,this.registrationForm=new Bx({email:new Vx,username:new Vx,password:new Vx})}return Wg(e,[{key:"registerWithEmail",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(xp||(xp=_g(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(S7),QE(jL))},e.\u0275cmp=Hm({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Mp||(Mp=_g(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Np||(Np=_g(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Dp||(Dp=_g(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(Lp||(Lp=_g(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Fp||(Fp=_g(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Up||(Up=_g(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Vp||(Vp=_g(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(Bp||(Bp=_g(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(zp||(zp=_g(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Gp||(Gp=_g(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(Hp||(Hp=_g(["Register with Google"]))),[1,"help","level-right"],$localize($p||($p=_g(["Have an account?"]))),[3,"routerLink"],$localize(Zp||(Zp=_g(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(qp||(qp=_g(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"p",1),ZP(2,2),tS(),eS(3,"form",3),eS(4,"div",4),eS(5,"div",5),eS(6,"label",6),ZP(7,7),tS(),tS(),eS(8,"div",8),eS(9,"div",9),eS(10,"div",10),nS(11,"input",11),eS(12,"p",12),ZP(13,13),tS(),tS(),tS(),tS(),tS(),eS(14,"div",4),eS(15,"div",5),eS(16,"label",14),ZP(17,15),tS(),tS(),eS(18,"div",8),eS(19,"div",9),eS(20,"div",10),nS(21,"input",16),tS(),tS(),tS(),tS(),eS(22,"div",4),eS(23,"div",5),eS(24,"label",17),ZP(25,18),tS(),tS(),eS(26,"div",8),eS(27,"div",9),eS(28,"div",19),nS(29,"input",20),eS(30,"span",21),nS(31,"fa-icon",22),tS(),eS(32,"p",23),ZP(33,24),tS(),tS(),tS(),tS(),tS(),eS(34,"div",4),nS(35,"div",5),eS(36,"div",8),eS(37,"div",9),eS(38,"div",10),eS(39,"button",25),uS("click",function(){return t.registerWithEmail()}),ZP(40,26),tS(),tS(),tS(),tS(),tS(),eS(41,"div",4),nS(42,"div",5),eS(43,"div",27),YE(44,Ige,5,1,"div",28),tS(),tS(),eS(45,"div",4),nS(46,"div",5),eS(47,"div",8),eS(48,"button",29),uS("click",function(){return t.registerWithGoogle()}),ZP(49,30),tS(),tS(),tS(),eS(50,"p",31),rS(51),ZP(52,32),iS(),FS(53,"\xa0 "),eS(54,"a",33),ZP(55,34),tS(),tS(),tS(),tS()),2&e&&(pb(3),XE("formGroup",t.registrationForm),pb(28),XE("icon",t.faEye),pb(1),XE("ngClass",t.getPasswordHelpClass()),pb(7),XE("disabled",!t.canRegister()),pb(5),XE("ngIf",t.errorMessage),pb(10),XE("routerLink",aT(6,Age)))},directives:[jx,gx,eM,VR,px,nM,Wde,hM,Eee,jde,NA,UA,QL],encapsulation:2}),e}(),xge=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL))},e.\u0275cmp=Hm({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Wp||(Wp=_g(["Play offline"])))]},template:function(e,t){1&e&&(eS(0,"app-pick-game",0),uS("pickGame",function(e){return t.pickGame(e)}),tS(),eS(1,"button",1),uS("click",function(){return t.playLocally()}),ZP(2,2),tS()),2&e&&(pb(1),XE("disabled",!t.selectedGame))},directives:[Gde],encapsulation:2}),e}(),Mge=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(jL))},e.\u0275cmp=Hm({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(jp||(jp=_g(["Learn the rules"])))]},template:function(e,t){1&e&&(eS(0,"app-pick-game",0),uS("pickGame",function(e){return t.pickGame(e)}),tS(),eS(1,"button",1),uS("click",function(){return t.launchTutorial()}),ZP(2,2),tS()),2&e&&(pb(1),XE("disabled",!t.selectedGame))},directives:[Gde],encapsulation:2}),e}(),Nge=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Hm({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(Yp||(Yp=_g(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(eS(0,"p"),ZP(1,0),tS())},encapsulation:2}),e}();function Dge(e,t){if(1&e&&(cC(),nS(0,"polygon",4)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessQueenComponent.HEPTAGON)}}function Lge(e,t){if(1&e&&(cC(),nS(0,"polygon",4)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Fge(e,t){if(1&e&&(cC(),nS(0,"circle",5)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Uge(e,t){if(1&e&&(rS(0),cC(),nS(1,"circle",6),nS(2,"circle",6),nS(3,"circle",6),iS()),2&e){var n=fS();pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Vge(e,t){if(1&e&&(cC(),eS(0,"g"),nS(1,"circle",7),nS(2,"circle",7),nS(3,"circle",7),tS()),2&e){var n=fS();pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pb(1),$E("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pb(1),$E("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Bge(e,t){if(1&e&&(cC(),eS(0,"g",8),nS(1,"circle",9),nS(2,"circle",9),nS(3,"circle",9),tS()),2&e){var n=fS();XE("ngClass",n.pieceClasses),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var zge=Wg(function e(){Zg(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=Nue,this.horizontalDotsRadius=Nue.SPACE_SIZE/15});function Gge(e,t){if(1&e&&(cC(),nS(0,"polygon",4)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessDroneComponent.PENTAGON)}}function Hge(e,t){if(1&e&&(cC(),nS(0,"polygon",4)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function $ge(e,t){if(1&e&&(cC(),nS(0,"circle",5)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Zge(e,t){if(1&e&&(rS(0),cC(),nS(1,"circle",6),nS(2,"circle",6),iS()),2&e){var n=fS();pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function qge(e,t){if(1&e&&(cC(),eS(0,"g",7),nS(1,"circle",8),nS(2,"circle",8),tS()),2&e){var n=fS();XE("ngClass",n.pieceClasses),pb(1),$E("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pb(1),$E("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Wge(e,t){if(1&e&&(cC(),eS(0,"g",7),nS(1,"circle",9),nS(2,"circle",9),tS()),2&e){var n=fS();XE("ngClass",n.pieceClasses),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}zge.HEPTAGON=Nue.getRegularPolygon(7),zge.EIGHT_POINTED_STAR=Nue.getNPointedStar(8,0),zge.\u0275fac=function(e){return new(e||zge)},zge.\u0275cmp=Hm({type:zge,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(YE(0,Dge,1,3,"polygon",0),YE(1,Lge,1,3,"polygon",0),YE(2,Fge,1,5,"circle",1),YE(3,Uge,4,9,"ng-container",2),YE(4,Vge,4,9,"g",2),YE(5,Bge,4,10,"g",3)),2&e&&(XE("ngIf","Polygon"===t.style.shape),pb(1),XE("ngIf","Star"===t.style.shape),pb(1),XE("ngIf","Circle"===t.style.shape),pb(1),XE("ngIf","Concentric Circles"===t.style.points),pb(1),XE("ngIf","Dots"===t.style.points),pb(1),XE("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var jge=Wg(function e(){Zg(this,e),this.MartianChessComponent=Nue,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=Nue.SPACE_SIZE/15});function Yge(e,t){if(1&e&&(cC(),nS(0,"polygon",5)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessPawnComponent.TRIANGLE)}}function Kge(e,t){if(1&e&&(cC(),nS(0,"polygon",5)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Qge(e,t){if(1&e&&(cC(),nS(0,"circle",6)),2&e){var n=fS();XE("id",n.mainShapeId)("ngClass",n.pieceClasses),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Xge(e,t){if(1&e&&(cC(),nS(0,"circle",7)),2&e){var n=fS();$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function Jge(e,t){if(1&e&&(cC(),nS(0,"circle",8)),2&e){var n=fS();$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function eye(e,t){if(1&e&&(cC(),eS(0,"g",9),nS(1,"circle",10),tS()),2&e){var n=fS();XE("ngClass",n.pieceClasses),pb(1),$E("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}jge.FOUR_POINTED_STAR_VERTICAL=Nue.getNPointedStar(4,0),jge.PENTAGON=Nue.getRegularPolygon(5),jge.\u0275fac=function(e){return new(e||jge)},jge.\u0275cmp=Hm({type:jge,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(YE(0,Gge,1,3,"polygon",0),YE(1,Hge,1,3,"polygon",0),YE(2,$ge,1,5,"circle",1),YE(3,Zge,3,6,"ng-container",2),YE(4,qge,3,7,"g",3),YE(5,Wge,3,7,"g",3)),2&e&&(XE("ngIf","Polygon"===t.style.shape),pb(1),XE("ngIf","Star"===t.style.shape),pb(1),XE("ngIf","Circle"===t.style.shape),pb(1),XE("ngIf","Concentric Circles"===t.style.points),pb(1),XE("ngIf","Dots"===t.style.points),pb(1),XE("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var tye=function(){function e(){Zg(this,e),this.MartianChessComponent=Nue,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=Nue.SPACE_SIZE/15}return Wg(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return Nue.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=Nue.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();tye.FOUR_POINTED_STAR_DIAGONAL=Nue.getNPointedStar(4,45),tye.TRIANGLE_Y_OFFSET=tye.yOffsetForVerticalCentering(),tye.TRIANGLE=tye.getTriangle(),tye.\u0275fac=function(e){return new(e||tye)},tye.\u0275cmp=Hm({type:tye,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(YE(0,Yge,1,3,"polygon",0),YE(1,Kge,1,3,"polygon",0),YE(2,Qge,1,5,"circle",1),YE(3,Xge,1,3,"circle",2),YE(4,Jge,1,3,"circle",3),YE(5,eye,2,4,"g",4)),2&e&&(XE("ngIf","Polygon"===t.style.shape),pb(1),XE("ngIf","Star"===t.style.shape),pb(1),XE("ngIf","Circle"===t.style.shape),pb(1),XE("ngIf","Concentric Circles"===t.style.points),pb(1),XE("ngIf","Dots"===t.style.points),pb(1),XE("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var nye={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"},rye=function(){var e=function(){function e(t){Zg(this,e),this.authService=t}return Wg(e,[{key:"canActivate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=aB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(S7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),iye=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(rye);return e.\u0275fac=function(t){return new(t||e)(pw(S7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function aye(e,t){1&e&&(eS(0,"p",20),ZP(1,21),tS())}function oye(e,t){if(1&e){var n=aS();eS(0,"div",7),eS(1,"p",8),ZP(2,9),tS(),eS(3,"div",10),eS(4,"p",11),ZP(5,12),tS(),eS(6,"button",13),uS("click",function(){return Nk(n),fS().finalizeEmailVerification()}),ZP(7,14),tS(),tS(),eS(8,"div",15),eS(9,"p",11),ZP(10,16),tS(),eS(11,"button",17),uS("click",function(){return Nk(n),fS().sendEmailVerification()}),ZP(12,18),tS(),tS(),YE(13,aye,2,0,"p",19),tS()}if(2&e){var r=fS();pb(2),qP(r.emailAddress),WP(2),pb(11),XE("ngIf",r.success)}}function sye(e,t){if(1&e){var n=aS();eS(0,"div",24),eS(1,"div",8),ZP(2,25),tS(),eS(3,"form",26),eS(4,"div",27),eS(5,"div",28),nS(6,"input",29),tS(),eS(7,"div",28),eS(8,"button",30),uS("click",function(){Nk(n);var e=fS(2);return e.pickUsername(e.usernameForm.value)}),ZP(9,31),tS(),tS(),tS(),tS(),tS()}if(2&e){var r=fS(2);pb(3),XE("formGroup",r.usernameForm)}}var uye=function(){return["/lobby"]};function cye(e,t){1&e&&(eS(0,"div",32),HP(1,33),nS(2,"a",34),$P(),tS()),2&e&&(pb(2),XE("routerLink",aT(1,uye)))}function lye(e,t){if(1&e&&(rS(0),YE(1,sye,10,1,"div",22),YE(2,cye,3,2,"div",23),iS()),2&e){var n=fS();pb(1),XE("ngIf",!n.success),pb(1),XE("ngIf",n.success)}}function fye(e,t){if(1&e&&(eS(0,"div",35),eS(1,"div",36),FS(2),tS(),tS()),2&e){var n=fS();pb(2),US(n.errorMessage)}}var hye=function(){var e=function(){function e(t,n){Zg(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new Bx({username:new Vx})}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(Kp||(Kp=_g(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(S7),QE(jL))},e.\u0275cmp=Hm({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(Qp||(Qp=_g(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(Xp||(Xp=_g(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(Jp||(Jp=_g(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(eg||(eg=_g(["Finalize email verification"]))),[1,"level-left"],$localize(tg||(tg=_g(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(ng||(ng=_g(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(rg||(rg=_g(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(ig||(ig=_g(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(ag||(ag=_g(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(og||(og=_g(["Pick username"]))),["id","success",1,"message-body"],$localize(sg||(sg=_g(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"div",1),eS(2,"div",2),ZP(3,3),tS(),YE(4,oye,14,2,"div",4),YE(5,lye,3,2,"ng-container",5),tS(),YE(6,fye,3,1,"div",6),tS()),2&e&&(pb(4),XE("ngIf","send-email"===t.verificationType),pb(1),XE("ngIf","enter-username"===t.verificationType),pb(1),XE("ngIf",t.errorMessage))},directives:[UA,jx,gx,eM,VR,hM,px,nM,QL],encapsulation:2}),e}(),dye=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(rye);return e.\u0275fac=function(t){return new(t||e)(pw(S7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),vye=function(){var e=function(e){Mg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(rye);return e.\u0275fac=function(t){return new(t||e)(pw(S7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function pye(e,t){1&e&&(eS(0,"p",12),ZP(1,13),tS())}function gye(e,t){if(1&e&&(eS(0,"div",14),eS(1,"div",15),ZP(2,16),tS(),eS(3,"div",17),FS(4),tS(),tS()),2&e){var n=fS();pb(4),US(n.errorMessage.get())}}var yye=function(){return{standalone:!0}},mye=function(){var e=function(){function e(t){Zg(this,e),this.authService=t,this.success=!1,this.errorMessage=fB.empty(),this.email=""}return Wg(e,[{key:"resetPassword",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=fB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=fB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(S7))},e.\u0275cmp=Hm({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(ug||(ug=_g(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(cg||(cg=_g(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(lg||(lg=_g(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(fg||(fg=_g(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(hg||(hg=_g(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(dg||(dg=_g(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"p",1),ZP(2,2),tS(),eS(3,"div",3),eS(4,"div",4),eS(5,"input",5),uS("ngModelChange",function(e){return t.email=e}),tS(),eS(6,"p",6),ZP(7,7),tS(),YE(8,pye,2,0,"p",8),tS(),tS(),eS(9,"button",9),uS("click",function(){return t.resetPassword()}),ZP(10,10),tS(),YE(11,gye,5,1,"div",11),tS()),2&e&&(pb(5),XE("ngModel",t.email)("ngModelOptions",aT(5,yye)),pb(3),XE("ngIf",t.success),pb(1),XE("disabled",""===t.email),pb(2),XE("ngIf",t.errorMessage.isPresent()))},directives:[VR,Wde,hM,px,Wx,UA],encapsulation:2}),e}();function kye(e,t){if(1&e&&(eS(0,"option",13),FS(1),tS()),2&e){var n=t.$implicit,r=fS();XE("value",n.value)("selected",n.value===r.currentTheme),pb(1),VS(" ",n.name," ")}}function Cye(e,t){if(1&e&&(eS(0,"option",13),FS(1),tS()),2&e){var n=t.$implicit,r=fS();XE("value",n.value)("selected",n.value===r.currentLanguage),pb(1),VS(" ",n.name," ")}}var wye=function(){var e=function(){function e(t,n){Zg(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(vg||(vg=_g(["Light"])))},{value:"dark",name:$localize(pg||(pg=_g(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return Wg(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(q7),QE(W7))},e.\u0275cmp=Hm({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(gg||(gg=_g(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(yg||(yg=_g(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(mg||(mg=_g(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(eS(0,"div",0),eS(1,"p",1),ZP(2,2),tS(),eS(3,"div",3),eS(4,"label",4),ZP(5,5),tS(),eS(6,"div",6),eS(7,"div",7),eS(8,"select",8),uS("change",function(e){return t.changeTheme(e)}),YE(9,kye,2,3,"option",9),tS(),tS(),tS(),tS(),eS(10,"div",3),eS(11,"label",10),ZP(12,11),tS(),eS(13,"div",6),eS(14,"div",7),eS(15,"select",12),uS("change",function(e){return t.changeLanguage(e)}),YE(16,Cye,2,3,"option",9),tS(),tS(),tS(),tS(),tS()),2&e&&(pb(9),XE("ngForOf",t.availableThemes),pb(7),XE("ngForOf",t.availableLanguages))},directives:[LA,oM,lM],encapsulation:2}),e}(),_ye=function(){var e=Wg(function e(){Zg(this,e)});return e.ALREADY_INGAME=function(){return $localize(kg||(kg=_g(["You are already in a game. Finish it or cancel it first."])))},e}(),bye=function(){var e=function(){function e(t,n,r,i,a,o){Zg(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.partDAO=a,this.gameService=o}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return oB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(f7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",bve.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartConfigRoomAndChat(e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(_ye.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return fB.ofNullable(zde.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(QE(OD),QE(jL),QE(S7),QE(c7),QE(v7),QE(z7))},e.\u0275cmp=Hm({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Cg||(Cg=_g(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(eS(0,"p"),ZP(1,0),tS())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[YS.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),ZS[t]=e,n&&(ZS[t][YS.ExtraData]=n)}(e,void 0,void 0)}(rB());var Eye=[{path:"login",component:Xde},{path:"lobby",component:kve,canActivate:[iye]},{path:"settings",component:wye},{path:"register",component:Rge,canActivate:[vye]},{path:"reset-password",component:mye,canActivate:[vye]},{path:"notFound/:message",component:Cve},{path:"nextGameLoading",component:Nge,canActivate:[iye]},{path:"verify-account",component:hye,canActivate:[dye]},{path:"play",component:eve,canActivate:[iye]},{path:"play/:compo",component:bye,canActivate:[iye]},{path:"play/:compo/:id",component:Zpe,canActivate:[iye]},{path:"local",component:xge},{path:"local/:compo",component:lge},{path:"tutorial",component:Mge},{path:"tutorial/:compo",component:Tge},{path:"",component:qde},{path:"**",component:Cve}],Sye=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:DZ,providers:[{provide:RZ,useFactory:NZ(e),multi:!0,deps:[eI,IE,_Z].concat(n)}]}}(function(){return LZ(nye)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:z8,providers:[{provide:F8,useFactory:U8(e),multi:!0,deps:[eI,IE,_Z,AZ,[new bw,TY],[new bw,pq]].concat(n)}]}}(function(){var e=j8();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:NY,providers:[{provide:IY,useFactory:AY(e),multi:!0,deps:[eI,IE,_Z,AZ,[new bw,pq]].concat(n)}]}}(function(){return LY()})}}]),e}(),Pye=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e,bootstrap:[Vee]}),e.\u0275inj=vm({providers:[S7,z7,B7,w7,y7,v7,W7,{provide:GT,useValue:Z7.getLocale()}],imports:[[Sye.app(),Sye.firestore(),Sye.auth(),SR,tN,cF.forRoot(Eye,{useHash:!1}),yM,gM,tB,See]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map($m)},r.pipeDefs=function(){return n.map(Zm)}}(Nue,[LA,NA,UA,tye,jge,zge],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var Oye=function(){function e(t){Zg(this,e),this.digits=t}return Wg(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),Tye=function(){function e(t){Zg(this,e),this.powerOfTwos=[t]}return Wg(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=Oye.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),Iye=function(){function e(t){Zg(this,e),this.base=t,this.exponents=[new Tye(Oye.one())]}return Wg(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Tye(n)}return this.exponents[e]}}]),e}();function Aye(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=Rye(t,0),r=Rye(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Rye(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=xye(r=Nye(r,Uye(e,n,Mye.Little)),i=Nye(i,Uye(e,n+4,Mye.Little)),t=Nye(t,Uye(e,n+8,Mye.Little)));r=o[0],i=o[1],t=o[2]}return r=Nye(r,Uye(e,n,Mye.Little)),i=Nye(i,Uye(e,n+4,Mye.Little)),t=Nye(t,a),xye(r,i,t=Nye(t,Uye(e,n+8,Mye.Little)<<8))[2]}function xye(e,t,n){return e=Lye(e,t),e=Lye(e,n),e^=n>>>13,t=Lye(t,n),t=Lye(t,e),t^=e<<8,n=Lye(n,e),n=Lye(n,t),n^=t>>>13,e=Lye(e,t),e=Lye(e,n),e^=n>>>12,t=Lye(t,n),t=Lye(t,e),t^=e<<16,n=Lye(n,e),n=Lye(n,t),n^=t>>>5,e=Lye(e,t),e=Lye(e,n),e^=n>>>3,t=Lye(t,n),t=Lye(t,e),t^=e<<10,n=Lye(n,e),n=Lye(n,t),[e,t,n^=t>>>15]}var Mye=((Mye=Mye||{})[Mye.Little=0]="Little",Mye[Mye.Big=1]="Big",Mye);function Nye(e,t){return Dye(e,t)[1]}function Dye(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Lye(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Fye(e,t){return t>=e.length?0:e[t]}function Uye(e,t,n){var r=0;if(n===Mye.Big)for(var i=0;i<4;i++)r+=Fye(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Fye(e,t+a)<<8*a;return r}var Vye=new Iye(256);function Bye(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function zye(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Gye=function(e){Mg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,"No translation found for ".concat($ye(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return Wg(n)}(Ig(Error));function Hye(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function $ye(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Zye(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Bye(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=wg(i.split("\u241f")),o=a[0],s=a.slice(1),u=Pg(o.split("@@",2),2),c=u[0],l=u[1],f=Pg(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=Bye(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?zye(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Aye(e);if(t){var r=Aye(t);n=function(e,t){var n=e[0],r=t[0],i=Dye(e[1],t[1]),a=i[0],o=i[1];return[Nye(Nye(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=Vye.toThePowerOf(0).multiplyBy(t);return Vye.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Gye(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat($ye(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function qye(){(function(){if(hI)throw new Error("Cannot enable prod mode after platform setup.");fI=!1})(),bR().bootstrapModule(Pye).catch(function(e){return console.error(e)})}var Wye=Z7.getLocale();"en"!==Wye?fetch("/assets/"+Wye+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Zye),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:Hye(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,qye()}).catch(function(e){console.log(e)}):qye()}},function(e){e(e.s=6607)}])}();