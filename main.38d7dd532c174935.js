(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{8910:(Ju,J0,j2)=>{"use strict";function Sn(r){return"function"==typeof r}function Z2(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const S3=Z2(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function O3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class On{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Sn(n))try{n()}catch(o){e=o instanceof S3?o.errors:[o]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const o of i)try{b3(o)}catch(s){e=e??[],s instanceof S3?e=[...e,...s.errors]:e.push(s)}}if(e)throw new S3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)b3(e);else{if(e instanceof On){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&O3(t,e)}remove(e){const{_finalizers:t}=this;t&&O3(t,e),e instanceof On&&e._removeParent(this)}}On.EMPTY=(()=>{const r=new On;return r.closed=!0,r})();const n6=On.EMPTY;function T3(r){return r instanceof On||r&&"closed"in r&&Sn(r.remove)&&Sn(r.add)&&Sn(r.unsubscribe)}function b3(r){Sn(r)?r():r.unsubscribe()}const gc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},H4={setTimeout(r,e,...t){const{delegate:n}=H4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=H4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function r6(r){H4.setTimeout(()=>{const{onUnhandledError:e}=gc;if(!e)throw r;e(r)})}function Hs(){}const Y2=i6("C",void 0,void 0);function i6(r,e,t){return{kind:r,value:e,error:t}}let wa=null;function dt(r){if(gc.useDeprecatedSynchronousErrorHandling){const e=!wa;if(e&&(wa={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=wa;if(wa=null,t)throw n}}else r()}class Ht extends On{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,T3(e)&&e.add(this)):this.destination=n7}static create(e,t,n){return new ko(e,t,n)}next(e){this.isStopped?t7(function e7(r){return i6("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?t7(function e8(r){return i6("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?t7(Y2,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Rn=Function.prototype.bind;function Lr(r,e){return Rn.call(r,e)}class w3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){ro(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){ro(n)}else ro(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ro(t)}}}class ko extends Ht{constructor(e,t,n){let i;if(super(),Sn(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let o;this&&gc.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Lr(e.next,o),error:e.error&&Lr(e.error,o),complete:e.complete&&Lr(e.complete,o)}):i=e}this.destination=new w3(i)}}function ro(r){gc.useDeprecatedSynchronousErrorHandling?function at(r){gc.useDeprecatedSynchronousErrorHandling&&wa&&(wa.errorThrown=!0,wa.error=r)}(r):r6(r)}function t7(r,e){const{onStoppedNotification:t}=gc;t&&H4.setTimeout(()=>t(r,e))}const n7={closed:!0,next:Hs,error:function o6(r){throw r},complete:Hs},r7="function"==typeof Symbol&&Symbol.observable||"@@observable";function pc(r){return r}function bh(r){return 0===r.length?pc:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let O1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const o=function wy(r){return r&&r instanceof Ht||function by(r){return r&&Sn(r.next)&&Sn(r.error)&&Sn(r.complete)}(r)&&T3(r)}(t)?t:new ko(t,n,i);return dt(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=wh(n))((i,o)=>{const s=new ko({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[r7](){return this}pipe(...t){return bh(t)(this)}toPromise(t){return new(t=wh(t))((n,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>n(o))})}}return r.create=e=>new r(e),r})();function wh(r){var e;return null!==(e=r??gc.Promise)&&void 0!==e?e:Promise}const Ny=Z2(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Vs=(()=>{class r extends O1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new Nh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new Ny}next(t){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:o}=this;return n||i?n6:(this.currentObservers=null,o.push(t),new On(()=>{this.currentObservers=null,O3(o,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:o}=this;n?t.error(i):o&&t.complete()}asObservable(){const t=new O1;return t.source=this,t}}return r.create=(e,t)=>new Nh(e,t),r})();class Nh extends Vs{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:n6}}class xo extends Vs{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function Ah(r){return Sn(r?.lift)}function ei(r){return e=>{if(Ah(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function pr(r,e,t,n,i){return new Ay(r,e,t,n,i)}class Ay extends Ht{constructor(e,t,n,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Zn(r,e){return ei((t,n)=>{let i=0;t.subscribe(pr(n,o=>{n.next(r.call(e,o,i++))}))})}function o7(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function d2(r){return this instanceof d2?(this.v=r,this):new d2(r)}function a6(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function t1(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,c){!function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=r[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const rz=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function iz(r){return Sn(r?.then)}function oz(r){return Sn(r[r7])}function sz(r){return Symbol.asyncIterator&&Sn(r?.[Symbol.asyncIterator])}function az(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const cz=function F4e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function lz(r){return Sn(r?.[cz])}function uz(r){return function n8(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(m){n[m]&&(i[m]=function(E){return new Promise(function(T,L){o.push([m,E,T,L])>1||a(m,E)})})}function a(m,E){try{!function c(m){m.value instanceof d2?Promise.resolve(m.value.v).then(l,f):d(o[0][2],m)}(n[m](E))}catch(T){d(o[0][3],T)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,E){m(E),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield d2(t.read());if(i)return yield d2(void 0);yield yield d2(n)}}finally{t.releaseLock()}})}function fz(r){return Sn(r?.getReader)}function g2(r){if(r instanceof O1)return r;if(null!=r){if(oz(r))return function $4e(r){return new O1(e=>{const t=r[r7]();if(Sn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(rz(r))return function G4e(r){return new O1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(iz(r))return function B4e(r){return new O1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,r6)})}(r);if(sz(r))return dz(r);if(lz(r))return function U4e(r){return new O1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(fz(r))return function W4e(r){return dz(uz(r))}(r)}throw az(r)}function dz(r){return new O1(e=>{(function q4e(r,e){var t,n,i,o;return function Se(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=a6(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function N3(r,e,t,n=0,i=!1){const o=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(o),!i)return o}function io(r,e,t=1/0){return Sn(e)?io((n,i)=>Zn((o,s)=>e(n,o,i,s))(g2(r(n,i))),t):("number"==typeof e&&(t=e),ei((n,i)=>function j4e(r,e,t,n,i,o,s,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},E=L=>l<n?T(L):c.push(L),T=L=>{o&&e.next(L),l++;let z=!1;g2(t(L,f++)).subscribe(pr(e,G=>{i?.(G),o?E(G):e.next(G)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const G=c.shift();s?N3(e,s,()=>T(G)):T(G)}m()}catch(G){e.error(G)}}))};return r.subscribe(pr(e,E,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function r8(r=1/0){return io(pc,r)}const mc=new O1(r=>r.complete());function zy(r){return r[r.length-1]}function hz(r){return Sn(zy(r))?r.pop():void 0}function a7(r){return function Y4e(r){return r&&Sn(r.schedule)}(zy(r))?r.pop():void 0}function kh(r,e=0){return ei((t,n)=>{t.subscribe(pr(n,i=>N3(n,r,()=>n.next(i),e),()=>N3(n,r,()=>n.complete(),e),i=>N3(n,r,()=>n.error(i),e)))})}function xh(r,e=0){return ei((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function gz(r,e){if(!r)throw new Error("Iterable cannot be null");return new O1(t=>{N3(t,e,()=>{const n=r[Symbol.asyncIterator]();N3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function fi(r,e){return e?function nle(r,e){if(null!=r){if(oz(r))return function X4e(r,e){return g2(r).pipe(xh(e),kh(e))}(r,e);if(rz(r))return function J4e(r,e){return new O1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(iz(r))return function Q4e(r,e){return g2(r).pipe(xh(e),kh(e))}(r,e);if(sz(r))return gz(r,e);if(lz(r))return function ele(r,e){return new O1(t=>{let n;return N3(t,e,()=>{n=r[cz](),N3(t,e,()=>{let i,o;try{({value:i,done:o}=n.next())}catch(s){return void t.error(s)}o?t.complete():t.next(i)},0,!0)}),()=>Sn(n?.return)&&n.return()})}(r,e);if(fz(r))return function tle(r,e){return gz(uz(r),e)}(r,e)}throw az(r)}(r,e):g2(r)}function $t(...r){return fi(r,a7(r))}function pz(r={}){const{connector:e=(()=>new Vs),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return o=>{let s,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},E=()=>{m(),s=c=void 0,f=d=!1},T=()=>{const L=s;E(),L?.unsubscribe()};return ei((L,z)=>{l++,!d&&!f&&m();const G=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=Dy(T,i))}),G.subscribe(z),!s&&l>0&&(s=new ko({next:B=>G.next(B),error:B=>{d=!0,m(),a=Dy(E,t,B),G.error(B)},complete:()=>{f=!0,m(),a=Dy(E,n),G.complete()}}),g2(L).subscribe(s))})(o)}}function Dy(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new ko({next:()=>{n.unsubscribe(),r()}});return g2(e(...t)).subscribe(n)}function Na(r,e){return ei((t,n)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&n.complete();t.subscribe(pr(n,c=>{i?.unsubscribe();let l=0;const f=o++;g2(r(c,f)).subscribe(i=pr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function ole(r,e){return r===e}function l1(r){for(let e in r)if(r[e]===l1)return e;throw Error("Could not find renamed property on target object.")}function Lh(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function di(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(di).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Hy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const sle=l1({__forward_ref__:l1});function T1(r){return r.__forward_ref__=T1,r.toString=function(){return di(this())},r}function Wt(r){return Vy(r)?r():r}function Vy(r){return"function"==typeof r&&r.hasOwnProperty(sle)&&r.__forward_ref__===T1}function Fy(r){return r&&!!r.\u0275providers}const mz="https://g.co/ng/security#xss";class pe extends Error{constructor(e,t){super(function Rh(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function Yt(r){return"string"==typeof r?r:null==r?"":String(r)}function $y(r,e){throw new pe(-201,!1)}function Gt(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function De(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function oo(r){return{providers:r.providers||[],imports:r.imports||[]}}function zh(r){return _z(r,Hh)||_z(r,vz)}function _z(r,e){return r.hasOwnProperty(e)?r[e]:null}function Dh(r){return r&&(r.hasOwnProperty(Gy)||r.hasOwnProperty(gle))?r[Gy]:null}const Hh=l1({\u0275prov:l1}),Gy=l1({\u0275inj:l1}),vz=l1({ngInjectableDef:l1}),gle=l1({ngInjectorDef:l1});var fn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(fn||{});let By;function Fs(r){const e=By;return By=r,e}function yz(r,e,t){const n=zh(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&fn.Optional?null:void 0!==e?e:void $y(di(r))}const C1=globalThis,c7={},Zy="__NG_DI_FLAG__",Vh="ngTempTokenPath",_le=/\n/gm,Ez="__source";let i8;function F4(r){const e=i8;return i8=r,e}function yle(r,e=fn.Default){if(void 0===i8)throw new pe(-203,!1);return null===i8?yz(r,void 0,e):i8.get(r,e&fn.Optional?null:void 0,e)}function Oe(r,e=fn.Default){return(function Cz(){return By}()||yle)(Wt(r),e)}function nt(r,e=fn.Default){return Oe(r,Fh(e))}function Fh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function Yy(r){const e=[];for(let t=0;t<r.length;t++){const n=Wt(r[t]);if(Array.isArray(n)){if(0===n.length)throw new pe(900,!1);let i,o=fn.Default;for(let s=0;s<n.length;s++){const a=n[s],c=Mle(a);"number"==typeof c?-1===c?i=a.token:o|=c:i=a}e.push(Oe(i,o))}else e.push(Oe(n))}return e}function l7(r,e){return r[Zy]=e,r.prototype[Zy]=e,r}function Mle(r){return r[Zy]}function A3(r){return{toString:r}.toString()}var $h=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}($h||{}),X2=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(X2||{});const _c={},Yn=[],Gh=l1({\u0275cmp:l1}),Ky=l1({\u0275dir:l1}),Xy=l1({\u0275pipe:l1}),Sz=l1({\u0275mod:l1}),I3=l1({\u0275fac:l1}),u7=l1({__NG_ELEMENT_ID__:l1}),Oz=l1({__NG_ENV_ID__:l1});function Tz(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const o=e.length;if(i+o===n||r.charCodeAt(i+o)<=32)return i}t=i+1}}function Qy(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const o=t[n++],s=t[n++],a=t[n++];r.setAttribute(e,s,a,o)}else{const o=i,s=t[++n];wz(o)?r.setProperty(e,o,s):r.setAttribute(e,o,s),n++}}return n}function bz(r){return 3===r||4===r||6===r}function wz(r){return 64===r.charCodeAt(0)}function f7(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||Nz(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function Nz(r,e,t,n,i){let o=0,s=r.length;if(-1===e)s=-1;else for(;o<r.length;){const a=r[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<r.length;){const a=r[o];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[o+1]=i));if(n===r[o+1])return void(r[o+2]=i)}o++,null!==n&&o++,null!==i&&o++}-1!==s&&(r.splice(s,0,e),o=s+1),r.splice(o++,0,t),null!==n&&r.splice(o++,0,n),null!==i&&r.splice(o++,0,i)}const Az="ng-template";function Sle(r,e,t){let n=0,i=!0;for(;n<r.length;){let o=r[n++];if("string"==typeof o&&i){const s=r[n++];if(t&&"class"===o&&-1!==Tz(s.toLowerCase(),e,0))return!0}else{if(1===o){for(;n<r.length&&"string"==typeof(o=r[n++]);)if(o.toLowerCase()===e)return!0;return!1}"number"==typeof o&&(i=!1)}}return!1}function Iz(r){return 4===r.type&&r.value!==Az}function Ole(r,e,t){return e===(4!==r.type||t?r.value:Az)}function Tle(r,e,t){let n=4;const i=r.attrs||[],o=function Nle(r){for(let e=0;e<r.length;e++)if(bz(r[e]))return e;return r.length}(i);let s=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!s)if(4&n){if(n=2|1&n,""!==c&&!Ole(r,c,t)||""===c&&1===e.length){if(Aa(n))return!1;s=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!Sle(r.attrs,l,t)){if(Aa(n))return!1;s=!0}continue}const d=ble(8&n?"class":c,i,Iz(r),t);if(-1===d){if(Aa(n))return!1;s=!0;continue}if(""!==l){let m;m=d>o?"":i[d+1].toLowerCase();const E=8&n?m:null;if(E&&-1!==Tz(E,l,0)||2&n&&l!==m){if(Aa(n))return!1;s=!0}}}}else{if(!s&&!Aa(n)&&!Aa(c))return!1;if(s&&Aa(c))continue;s=!1,n=c|1&n}}return Aa(n)||s}function Aa(r){return 0==(1&r)}function ble(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let o=!1;for(;i<e.length;){const s=e[i];if(s===r)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function Ale(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function kz(r,e,t=!1){for(let n=0;n<e.length;n++)if(Tle(r,e[n],t))return!0;return!1}function Ile(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function xz(r,e){return r?":not("+e.trim()+")":e}function kle(r){let e=r[0],t=1,n=2,i="",o=!1;for(;t<r.length;){let s=r[t];if("string"==typeof s)if(2&n){const a=r[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+s:4&n&&(i+=" "+s);else""!==i&&!Aa(s)&&(e+=xz(o,i),i=""),n=s,o=o||!Aa(n);t++}return""!==i&&(e+=xz(o,i)),e}function Fe(r){return A3(()=>{const e=Rz(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===$h.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||X2.Emulated,styles:r.styles||Yn,_:null,schemas:r.schemas||null,tView:null,id:""};zz(t);const n=r.dependencies;return t.directiveDefs=Bh(n,!1),t.pipeDefs=Bh(n,!0),t.id=function Vle(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function o8(r,e,t){const n=r.\u0275cmp;n.directiveDefs=Bh(e,!1),n.pipeDefs=Bh(t,!0)}function Rle(r){return zn(r)||so(r)}function zle(r){return null!==r}function Lo(r){return A3(()=>({type:r.type,bootstrap:r.bootstrap||Yn,declarations:r.declarations||Yn,imports:r.imports||Yn,exports:r.exports||Yn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function Lz(r,e){if(null==r)return _c;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),t[i]=n,e&&(e[i]=o)}return t}function zt(r){return A3(()=>{const e=Rz(r);return zz(e),e})}function Ro(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function zn(r){return r[Gh]||null}function so(r){return r[Ky]||null}function cs(r){return r[Xy]||null}function m2(r,e){const t=r[Sz]||null;if(!t&&!0===e)throw new Error(`Type ${di(r)} does not have '\u0275mod' property.`);return t}function Rz(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||_c,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||Yn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Lz(r.inputs,e),outputs:Lz(r.outputs)}}function zz(r){r.features?.forEach(e=>e(r))}function Bh(r,e){if(!r)return null;const t=e?cs:Rle;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(zle)}const Rr=0,Je=1,en=2,Y1=3,Ia=4,d7=5,zo=6,a8=7,zr=8,$4=9,c8=10,Kt=11,h7=12,Dz=13,l8=14,Dr=15,g7=16,u8=17,vc=18,p7=19,Hz=20,G4=21,k3=22,Uh=23,Wh=24,yn=25,Jy=1,Vz=2,Cc=7,f8=9,ao=11;function $s(r){return Array.isArray(r)&&"object"==typeof r[Jy]}function Gs(r){return Array.isArray(r)&&!0===r[Jy]}function eM(r){return 0!=(4&r.flags)}function u6(r){return r.componentOffset>-1}function jh(r){return 1==(1&r.flags)}function ka(r){return!!r.template}function tM(r){return 0!=(512&r[en])}function f6(r,e){return r.hasOwnProperty(I3)?r[I3]:null}let Wle=C1.WeakRef??class Ule{constructor(e){this.ref=e}deref(){return this.ref}},jle=0,yc=null,Zh=!1;function Ii(r){const e=yc;return yc=r,e}class Uz{constructor(){this.id=jle++,this.ref=function qle(r){return new Wle(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Zh;Zh=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Zh=e}}producerAccessed(){if(Zh)throw new Error("");if(null===yc)return;let e=yc.producers.get(this.id);void 0===e?(e={consumerNode:yc.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:yc.trackingVersion},yc.producers.set(this.id,e),this.consumers.set(yc.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=yc.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==yc?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let Wz=null;const jz=()=>{};class Xle extends Uz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=jz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=Ii(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=jz,this.watch(this.registerOnCleanup)}finally{Ii(e)}}cleanup(){this.cleanupFn()}}class Qle{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Do(){return Zz}function Zz(r){return r.type.prototype.ngOnChanges&&(r.setInput=e6e),Jle}function Jle(){const r=Kz(this),e=r?.current;if(e){const t=r.previous;if(t===_c)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function e6e(r,e,t,n){const i=this.declaredInputs[t],o=Kz(r)||function t6e(r,e){return r[Yz]=e}(r,{previous:_c,current:null}),s=o.current||(o.current={}),a=o.previous,c=a[i];s[i]=new Qle(c&&c.currentValue,e,a===_c),r[n]=e}Do.ngInherit=!0;const Yz="__ngSimpleChanges__";function Kz(r){return r[Yz]||null}const Mc=function(r,e,t){},Xz="svg";function b1(r){for(;Array.isArray(r);)r=r[Rr];return r}function Xh(r,e){return b1(e[r])}function Bs(r,e){return b1(e[r.index])}function Jz(r,e){return r.data[e]}function d8(r,e){return r[e]}function _2(r,e){const t=e[r];return $s(t)?t:t[Rr]}function B4(r,e){return null==e?null:r[e]}function eD(r){r[u8]=0}function c6e(r){1024&r[en]||(r[en]|=1024,nD(r,1))}function tD(r){1024&r[en]&&(r[en]&=-1025,nD(r,-1))}function nD(r,e){let t=r[Y1];if(null===t)return;t[d7]+=e;let n=t;for(t=t[Y1];null!==t&&(1===e&&1===n[d7]||-1===e&&0===n[d7]);)t[d7]+=e,n=t,t=t[Y1]}const Bt={lFrame:hD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function oD(){return Bt.bindingsEnabled}function h8(){return null!==Bt.skipHydrationRootTNode}function Pe(){return Bt.lFrame.lView}function Dn(){return Bt.lFrame.tView}function ee(r){return Bt.lFrame.contextLView=r,r[zr]}function te(r){return Bt.lFrame.contextLView=null,r}function co(){let r=sD();for(;null!==r&&64===r.type;)r=r.parent;return r}function sD(){return Bt.lFrame.currentTNode}function _7(){const r=Bt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function Ec(r,e){const t=Bt.lFrame;t.currentTNode=r,t.isParent=e}function aM(){return Bt.lFrame.isParent}function cM(){Bt.lFrame.isParent=!1}function ls(){const r=Bt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function x3(){return Bt.lFrame.bindingIndex}function g8(){return Bt.lFrame.bindingIndex++}function L3(r){const e=Bt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function lD(r){Bt.lFrame.inI18n=r}function y6e(r,e){const t=Bt.lFrame;t.bindingIndex=t.bindingRootIndex=r,lM(e)}function lM(r){Bt.lFrame.currentDirectiveIndex=r}function uD(){return Bt.lFrame.currentQueryIndex}function fM(r){Bt.lFrame.currentQueryIndex=r}function E6e(r){const e=r[Je];return 2===e.type?e.declTNode:1===e.type?r[zo]:null}function fD(r,e,t){if(t&fn.SkipSelf){let i=e,o=r;for(;!(i=i.parent,null!==i||t&fn.Host||(i=E6e(o),null===i||(o=o[l8],10&i.type))););if(null===i)return!1;e=i,r=o}const n=Bt.lFrame=dD();return n.currentTNode=e,n.lView=r,!0}function dM(r){const e=dD(),t=r[Je];Bt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function dD(){const r=Bt.lFrame,e=null===r?null:r.child;return null===e?hD(r):e}function hD(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function gD(){const r=Bt.lFrame;return Bt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const pD=gD;function hM(){const r=gD();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function us(){return Bt.lFrame.selectedIndex}function d6(r){Bt.lFrame.selectedIndex=r}function ir(){const r=Bt.lFrame;return Jz(r.tView,r.selectedIndex)}function I(){Bt.lFrame.currentNamespace=Xz}let _D=!0;function Qh(){return _D}function U4(r){_D=r}function Jh(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const o=r.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=o;s&&(r.contentHooks??=[]).push(-t,s),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function eg(r,e,t){vD(r,e,3,t)}function tg(r,e,t,n){(3&r[en])===t&&vD(r,e,t,n)}function gM(r,e){let t=r[en];(3&t)===e&&(t&=8191,t+=1,r[en]=t)}function vD(r,e,t,n){const o=n??-1,s=e.length-1;let a=0;for(let c=void 0!==n?65535&r[u8]:0;c<s;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[u8]+=65536),(a<o||-1==o)&&(N6e(r,t,e,c),r[u8]=(4294901760&r[u8])+c+2),c++}function CD(r,e){Mc(4,r,e);const t=Ii(null);try{e.call(r)}finally{Ii(t),Mc(5,r,e)}}function N6e(r,e,t,n){const i=t[n]<0,o=t[n+1],a=r[i?-t[n]:t[n]];i?r[en]>>13<r[u8]>>16&&(3&r[en])===e&&(r[en]+=8192,CD(a,o)):CD(a,o)}const p8=-1;class v7{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function mM(r){return r!==p8}function C7(r){return 32767&r}function y7(r,e){let t=function x6e(r){return r>>16}(r),n=e;for(;t>0;)n=n[l8],t--;return n}let _M=!0;function ng(r){const e=_M;return _M=r,e}const yD=255,MD=5;let L6e=0;const Pc={};function rg(r,e){const t=ED(r,e);if(-1!==t)return t;const n=e[Je];n.firstCreatePass&&(r.injectorIndex=e.length,vM(n.data,r),vM(e,null),vM(n.blueprint,null));const i=ig(r,e),o=r.injectorIndex;if(mM(i)){const s=C7(i),a=y7(i,e),c=a[Je].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function vM(r,e){r.push(0,0,0,0,0,0,0,0,e)}function ED(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function ig(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=ND(i),null===n)return p8;if(t++,i=i[l8],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return p8}function CM(r,e,t){!function R6e(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(u7)&&(n=t[u7]),null==n&&(n=t[u7]=L6e++);const i=n&yD;e.data[r+(i>>MD)]|=1<<i}(r,e,t)}function PD(r,e,t){if(t&fn.Optional||void 0!==r)return r;$y()}function SD(r,e,t,n){if(t&fn.Optional&&void 0===n&&(n=null),!(t&(fn.Self|fn.Host))){const i=r[$4],o=Fs(void 0);try{return i?i.get(e,n,t&fn.Optional):yz(e,n,t&fn.Optional)}finally{Fs(o)}}return PD(n,0,t)}function OD(r,e,t,n=fn.Default,i){if(null!==r){if(2048&e[en]&&!(n&fn.Self)){const s=function $6e(r,e,t,n,i){let o=r,s=e;for(;null!==o&&null!==s&&2048&s[en]&&!(512&s[en]);){const a=TD(o,s,t,n|fn.Self,Pc);if(a!==Pc)return a;let c=o.parent;if(!c){const l=s[Hz];if(l){const f=l.get(t,Pc,n);if(f!==Pc)return f}c=ND(s),s=s[l8]}o=c}return i}(r,e,t,n,Pc);if(s!==Pc)return s}const o=TD(r,e,t,n,Pc);if(o!==Pc)return o}return SD(e,t,n,i)}function TD(r,e,t,n,i){const o=function H6e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(u7)?r[u7]:void 0;return"number"==typeof e?e>=0?e&yD:F6e:e}(t);if("function"==typeof o){if(!fD(e,r,n))return n&fn.Host?PD(i,0,n):SD(e,t,n,i);try{let s;if(s=o(n),null!=s||n&fn.Optional)return s;$y()}finally{pD()}}else if("number"==typeof o){let s=null,a=ED(r,e),c=p8,l=n&fn.Host?e[Dr][zo]:null;for((-1===a||n&fn.SkipSelf)&&(c=-1===a?ig(r,e):e[a+8],c!==p8&&wD(n,!1)?(s=e[Je],a=C7(c),e=y7(c,e)):a=-1);-1!==a;){const f=e[Je];if(bD(o,a,f.data)){const d=D6e(a,e,t,s,n,l);if(d!==Pc)return d}c=e[a+8],c!==p8&&wD(n,e[Je].data[a+8]===l)&&bD(o,a,e)?(s=f,a=C7(c),e=y7(c,e)):a=-1}}return i}function D6e(r,e,t,n,i,o){const s=e[Je],a=s.data[r+8],f=og(a,s,t,null==n?u6(a)&&_M:n!=s&&0!=(3&a.type),i&fn.Host&&o===a);return null!==f?h6(e,s,f,a):Pc}function og(r,e,t,n,i){const o=r.providerIndexes,s=e.data,a=1048575&o,c=r.directiveStart,f=o>>20,m=i?a+f:r.directiveEnd;for(let E=n?a:a+f;E<m;E++){const T=s[E];if(E<c&&t===T||E>=c&&T.type===t)return E}if(i){const E=s[c];if(E&&ka(E)&&E.type===t)return c}return null}function h6(r,e,t,n){let i=r[t];const o=e.data;if(function A6e(r){return r instanceof v7}(i)){const s=i;s.resolving&&function ale(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new pe(-200,`Circular dependency in DI detected for ${r}${t}`)}(function r1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Yt(r)}(o[t]));const a=ng(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Fs(s.injectImpl):null;fD(r,n,fn.Default);try{i=r[t]=s.factory(void 0,o,r,n),e.firstCreatePass&&t>=n.directiveStart&&function w6e(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(n){const s=Zz(e);(t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s)}i&&(t.preOrderHooks??=[]).push(0-r,i),o&&((t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o))}(t,o[t],e)}finally{null!==l&&Fs(l),ng(a),s.resolving=!1,pD()}}return i}function bD(r,e,t){return!!(t[e+(r>>MD)]&1<<r)}function wD(r,e){return!(r&fn.Self||r&fn.Host&&e)}class fs{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return OD(this._tNode,this._lView,e,Fh(n),t)}}function F6e(){return new fs(co(),Pe())}function K1(r){return A3(()=>{const e=r.prototype.constructor,t=e[I3]||yM(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const o=i[I3]||yM(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function yM(r){return Vy(r)?()=>{const e=yM(Wt(r));return e&&e()}:f6(r)}function ND(r){const e=r[Je],t=e.type;return 2===t?e.declTNode:1===t?r[zo]:null}const _8="__parameters__";function C8(r,e,t){return A3(()=>{const n=function MM(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...o){if(this instanceof i)return n.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(c,l,f){const d=c.hasOwnProperty(_8)?c[_8]:Object.defineProperty(c,_8,{value:[]})[_8];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function M8(r,e){r.forEach(t=>Array.isArray(t)?M8(t,e):e(t))}function ID(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function ag(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function P7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function v2(r,e,t){let n=E8(r,e);return n>=0?r[1|n]=t:(n=~n,function Z6e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function EM(r,e){const t=E8(r,e);if(t>=0)return r[1|t]}function E8(r,e){return function kD(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const o=n+(i-n>>1),s=r[o<<t];if(e===s)return o<<t;s>e?i=o:n=o+1}return~(i<<t)}(r,e,1)}const ds=l7(C8("Optional"),8),lg=l7(C8("SkipSelf"),4);function gg(r){return 128==(128&r.flags)}var W4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(W4||{});const p0e=/^>|^->|<!--|-->|--!>|<!-$/g,m0e=/(<|>)/,_0e="\u200b$1\u200b";const bM=new Map;let v0e=0;const NM="__ngContext__";function Ho(r,e){$s(e)?(r[NM]=e[p7],function y0e(r){bM.set(r[p7],r)}(e)):r[NM]=e}let AM;function IM(r,e){return AM(r,e)}function T7(r){const e=r[Y1];return Gs(e)?e[Y1]:e}function QD(r){return eH(r[h7])}function JD(r){return eH(r[Ia])}function eH(r){for(;null!==r&&!Gs(r);)r=r[Ia];return r}function O8(r,e,t,n,i){if(null!=n){let o,s=!1;Gs(n)?o=n:$s(n)&&(s=!0,n=n[Rr]);const a=b1(n);0===r&&null!==t?null==i?iH(e,t,a):g6(e,t,a,i||null,!0):1===r&&null!==t?g6(e,t,a,i||null,!0):2===r?Mg(e,a,s):3===r&&e.destroyNode(a),null!=o&&function G0e(r,e,t,n,i){const o=t[Cc];o!==b1(t)&&O8(e,r,n,o,i);for(let a=ao;a<t.length;a++){const c=t[a];w7(c[Je],c,r,e,n,o)}}(e,r,o,t,i)}}function mg(r,e){return r.createText(e)}function tH(r,e,t){r.setValue(e,t)}function kM(r,e){return r.createComment(function UD(r){return r.replace(p0e,e=>e.replace(m0e,_0e))}(e))}function _g(r,e,t){return r.createElement(e,t)}function nH(r,e){const t=r[f8],n=t.indexOf(e);tD(e),t.splice(n,1)}function vg(r,e){if(r.length<=ao)return;const t=ao+e,n=r[t];if(n){const i=n[g7];null!==i&&i!==r&&nH(i,n),e>0&&(r[t-1][Ia]=n[Ia]);const o=ag(r,ao+e);!function I0e(r,e){w7(r,e,e[Kt],2,null,null),e[Rr]=null,e[zo]=null}(n[Je],n);const s=o[vc];null!==s&&s.detachView(o[Je]),n[Y1]=null,n[Ia]=null,n[en]&=-129}return n}function xM(r,e){if(!(256&e[en])){const t=e[Kt];e[Uh]?.destroy(),e[Wh]?.destroy(),t.destroyNode&&w7(r,e,t,3,null,null),function L0e(r){let e=r[h7];if(!e)return LM(r[Je],r);for(;e;){let t=null;if($s(e))t=e[h7];else{const n=e[ao];n&&(t=n)}if(!t){for(;e&&!e[Ia]&&e!==r;)$s(e)&&LM(e[Je],e),e=e[Y1];null===e&&(e=r),$s(e)&&LM(e[Je],e),t=e&&e[Ia]}e=t}}(e)}}function LM(r,e){if(!(256&e[en])){e[en]&=-129,e[en]|=256,function H0e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof v7)){const o=t[n+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],c=o[s+1];Mc(4,a,c);try{c.call(a)}finally{Mc(5,a,c)}}else{Mc(4,i,o);try{o.call(i)}finally{Mc(5,i,o)}}}}}(r,e),function D0e(r,e){const t=r.cleanup,n=e[a8];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+3];s>=0?n[s]():n[-s].unsubscribe(),o+=2}else t[o].call(n[t[o+1]]);null!==n&&(e[a8]=null);const i=e[G4];if(null!==i){e[G4]=null;for(let o=0;o<i.length;o++)(0,i[o])()}}(r,e),1===e[Je].type&&e[Kt].destroy();const t=e[g7];if(null!==t&&Gs(e[Y1])){t!==e[Y1]&&nH(t,e);const n=e[vc];null!==n&&n.detachView(r)}!function M0e(r){bM.delete(r[p7])}(e)}}function RM(r,e,t){return rH(r,e.parent,t)}function rH(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Rr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:o}=r.data[n.directiveStart+i];if(o===X2.None||o===X2.Emulated)return null}return Bs(n,t)}}function g6(r,e,t,n,i){r.insertBefore(e,t,n,i)}function iH(r,e,t){r.appendChild(e,t)}function oH(r,e,t,n,i){null!==n?g6(r,e,t,n,i):iH(r,e,t)}function Cg(r,e){return r.parentNode(e)}function sH(r,e,t){return cH(r,e,t)}function aH(r,e,t){return 40&r.type?Bs(r,t):null}let zM,Eg,FM,Pg,cH=aH;function lH(r,e){cH=r,zM=e}function yg(r,e,t,n){const i=RM(r,n,e),o=e[Kt],a=sH(n.parent||e[zo],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)oH(o,i,t[c],a,!1);else oH(o,i,t,a,!1);void 0!==zM&&zM(o,n,e,t,i)}function b7(r,e){if(null!==e){const t=e.type;if(3&t)return Bs(e,r);if(4&t)return DM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return b7(r,n);{const i=r[e.index];return Gs(i)?DM(-1,i):b1(i)}}if(32&t)return IM(e,r)()||b1(r[e.index]);{const n=uH(r,e);return null!==n?Array.isArray(n)?n[0]:b7(T7(r[Dr]),n):b7(r,e.next)}}return null}function uH(r,e){return null!==e?r[Dr][zo].projection[e.projection]:null}function DM(r,e){const t=ao+r+1;if(t<e.length){const n=e[t],i=n[Je].firstChild;if(null!==i)return b7(n,i)}return e[Cc]}function Mg(r,e,t){const n=Cg(r,e);n&&function V0e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function HM(r,e,t,n,i,o,s){for(;null!=t;){const a=n[t.index],c=t.type;if(s&&0===e&&(a&&Ho(b1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)HM(r,e,t.child,n,i,o,!1),O8(e,r,i,a,o);else if(32&c){const l=IM(t,n);let f;for(;f=l();)O8(e,r,i,f,o);O8(e,r,i,a,o)}else 16&c?dH(r,e,n,t,i,o):O8(e,r,i,a,o);t=s?t.projectionNext:t.next}}function w7(r,e,t,n,i,o){HM(t,n,r.firstChild,e,i,o,!1)}function dH(r,e,t,n,i,o){const s=t[Dr],c=s[zo].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)O8(e,r,i,c[l],o);else{let l=c;const f=s[Y1];gg(n)&&(l.flags|=128),HM(r,e,l,f,i,o,!0)}}function hH(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function gH(r,e,t){const{mergedAttrs:n,classes:i,styles:o}=t;null!==n&&Qy(r,e,n),null!==i&&hH(r,e,i),null!==o&&function U0e(r,e,t){r.setAttribute(e,"style",t)}(r,e,o)}function T8(r){return function VM(){if(void 0===Eg&&(Eg=null,C1.trustedTypes))try{Eg=C1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Eg}()?.createHTML(r)||r}function b8(){if(void 0!==FM)return FM;if(typeof document<"u")return document;throw new pe(210,!1)}function $M(){if(void 0===Pg&&(Pg=null,C1.trustedTypes))try{Pg=C1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Pg}function pH(r){return $M()?.createHTML(r)||r}function _H(r){return $M()?.createScriptURL(r)||r}class p6{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${mz})`}}class Y0e extends p6{getTypeName(){return"HTML"}}class K0e extends p6{getTypeName(){return"Style"}}class X0e extends p6{getTypeName(){return"Script"}}class Q0e extends p6{getTypeName(){return"URL"}}class J0e extends p6{getTypeName(){return"ResourceURL"}}function C2(r){return r instanceof p6?r.changingThisBreaksApplicationSecurity:r}function Sc(r,e){const t=function e8e(r){return r instanceof p6&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${mz})`)}return t===e}function vH(r){const e=new a8e(r);return function c8e(){try{return!!(new window.DOMParser).parseFromString(T8(""),"text/html")}catch{return!1}}()?new s8e(e):e}class s8e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(T8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class a8e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=T8(e),t}}const l8e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Sg(r){return(r=String(r)).match(l8e)?r:"unsafe:"+r}function R3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function N7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const CH=R3("area,br,col,hr,img,wbr"),yH=R3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),MH=R3("rp,rt"),GM=N7(CH,N7(yH,R3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),N7(MH,R3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),N7(MH,yH)),BM=R3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),EH=N7(BM,R3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),R3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),u8e=R3("script,style,template");class f8e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!GM.hasOwnProperty(t))return this.sanitizedSomething=!0,!u8e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const o=n.item(i),s=o.name,a=s.toLowerCase();if(!EH.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;BM[a]&&(c=Sg(c)),this.buf.push(" ",s,'="',PH(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();GM.hasOwnProperty(t)&&!CH.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(PH(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const d8e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,h8e=/([^\#-~ |!])/g;function PH(r){return r.replace(/&/g,"&amp;").replace(d8e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(h8e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Og;function SH(r,e){let t=null;try{Og=Og||vH(r);let n=e?String(e):"";t=Og.getInertBodyElement(n);let i=5,o=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=o,o=t.innerHTML,t=Og.getInertBodyElement(n)}while(n!==o);return T8((new f8e).sanitizeChildren(UM(t)||t))}finally{if(t){const n=UM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function UM(r){return"content"in r&&function g8e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var J2=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(J2||{});function A7(r){const e=I7();return e?pH(e.sanitize(J2.HTML,r)||""):Sc(r,"HTML")?pH(C2(r)):SH(b8(),Yt(r))}function Tg(r){const e=I7();return e?e.sanitize(J2.URL,r)||"":Sc(r,"URL")?C2(r):Sg(Yt(r))}function OH(r){const e=I7();if(e)return _H(e.sanitize(J2.RESOURCE_URL,r)||"");if(Sc(r,"ResourceURL"))return _H(C2(r));throw new pe(904,!1)}function I7(){const r=Pe();return r&&r[c8].sanitizer}class et{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=De({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const k7=new et("ENVIRONMENT_INITIALIZER"),bH=new et("INJECTOR",-1),wH=new et("INJECTOR_DEF_TYPES");class WM{get(e,t=c7){if(t===c7){const n=new Error(`NullInjectorError: No provider for ${di(e)}!`);throw n.name="NullInjectorError",n}return t}}function y8e(...r){return{\u0275providers:NH(0,r),\u0275fromNgModule:!0}}function NH(r,...e){const t=[],n=new Set;let i;const o=s=>{t.push(s)};return M8(e,s=>{const a=s;bg(a,o,[],n)&&(i||=[],i.push(a))}),void 0!==i&&AH(i,o),t}function AH(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];jM(i,o=>{e(o,n)})}}function bg(r,e,t,n){if(!(r=Wt(r)))return!1;let i=null,o=Dh(r);const s=!o&&zn(r);if(o||s){if(s&&!s.standalone)return!1;i=r}else{const c=r.ngModule;if(o=Dh(c),!o)return!1;i=c}const a=n.has(i);if(s){if(a)return!1;if(n.add(i),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)bg(l,e,t,n)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;n.add(i);try{M8(o.imports,f=>{bg(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&AH(l,e)}if(!a){const l=f6(i)||(()=>new i);e({provide:i,useFactory:l,deps:Yn},i),e({provide:wH,useValue:i,multi:!0},i),e({provide:k7,useValue:()=>Oe(i),multi:!0},i)}const c=o.providers;if(null!=c&&!a){const l=r;jM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function jM(r,e){for(let t of r)Fy(t)&&(t=t.\u0275providers),Array.isArray(t)?jM(t,e):e(t)}const M8e=l1({provide:String,useValue:l1});function ZM(r){return null!==r&&"object"==typeof r&&M8e in r}function m6(r){return"function"==typeof r}const YM=new et("Set Injector scope."),wg={},P8e={};let KM;function Ng(){return void 0===KM&&(KM=new WM),KM}class y2{}class Ag extends y2{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,QM(e,s=>this.processProvider(s)),this.records.set(bH,w8(void 0,this)),i.has("environment")&&this.records.set(y2,w8(void 0,this));const o=this.records.get(YM);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(wH.multi,Yn,fn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=F4(this),n=Fs(void 0);try{return e()}finally{F4(t),Fs(n)}}get(e,t=c7,n=fn.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Oz))return e[Oz](this);n=Fh(n);const o=F4(this),s=Fs(void 0);try{if(!(n&fn.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function w8e(r){return"function"==typeof r||"object"==typeof r&&r instanceof et}(e)&&zh(e);c=l&&this.injectableDefInScope(l)?w8(XM(e),wg):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&fn.Self?Ng():this.parent).get(e,t=n&fn.Optional&&t===c7?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Vh]=a[Vh]||[]).unshift(di(e)),o)throw a;return function Ele(r,e,t,n){const i=r[Vh];throw e[Ez]&&i.unshift(e[Ez]),r.message=function Ple(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=di(e);if(Array.isArray(e))i=e.map(di).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):di(a)))}i=`{${o.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(_le,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[Vh]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Fs(s),F4(o)}}resolveInjectorInitializers(){const e=F4(this),t=Fs(void 0);try{const i=this.get(k7.multi,Yn,fn.Self);for(const o of i)o()}finally{F4(e),Fs(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(di(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new pe(205,!1)}processProvider(e){let t=m6(e=Wt(e))?e:Wt(e&&e.provide);const n=function O8e(r){return ZM(r)?w8(void 0,r.useValue):w8(xH(r),wg)}(e);if(m6(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=w8(void 0,wg,!0),i.factory=()=>Yy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===wg&&(t.value=P8e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function b8e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Wt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function XM(r){const e=zh(r),t=null!==e?e.factory:f6(r);if(null!==t)return t;if(r instanceof et)throw new pe(204,!1);if(r instanceof Function)return function S8e(r){const e=r.length;if(e>0)throw P7(e,"?"),new pe(204,!1);const t=function hle(r){return r&&(r[Hh]||r[vz])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new pe(204,!1)}function xH(r,e,t){let n;if(m6(r)){const i=Wt(r);return f6(i)||XM(i)}if(ZM(r))n=()=>Wt(r.useValue);else if(function kH(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...Yy(r.deps||[]));else if(function IH(r){return!(!r||!r.useExisting)}(r))n=()=>Oe(Wt(r.useExisting));else{const i=Wt(r&&(r.useClass||r.provide));if(!function T8e(r){return!!r.deps}(r))return f6(i)||XM(i);n=()=>new i(...Yy(r.deps))}return n}function w8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function QM(r,e){for(const t of r)Array.isArray(t)?QM(t,e):t&&Fy(t)?QM(t.\u0275providers,e):e(t)}const Ig=new et("AppId",{providedIn:"root",factory:()=>N8e}),N8e="ng",LH=new et("Platform Initializer"),z3=new et("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),RH=new et("AnimationModuleType"),zH=new et("CSP nonce",{providedIn:"root",factory:()=>b8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let HH=(r,e,t)=>null;function oE(r,e,t=!1){return HH(r,e,t)}class V8e{}class $H{}class $8e{resolveComponentFactory(e){throw function F8e(r){const e=Error(`No component factory found for ${di(r)}.`);return e.ngComponent=r,e}(e)}}let Dg=(()=>{class e{}return e.NULL=new $8e,e})();function G8e(){return A8(co(),Pe())}function A8(r,e){return new Vo(Bs(r,e))}let Vo=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=G8e,e})();function B8e(r){return r instanceof Vo?r.nativeElement:r}class z7{}let Oc=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function U8e(){const r=Pe(),t=_2(co().index,r);return($s(t)?t:r)[Kt]}(),e})(),W8e=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>null}),e})();class I8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const BH=new I8("16.2.0"),cE={};function jH(r,e=null,t=null,n){const i=ZH(r,e,t,n);return i.resolveInjectorInitializers(),i}function ZH(r,e=null,t=null,n,i=new Set){const o=[t||Yn,y8e(r)];return n=n||("object"==typeof r?void 0:di(r)),new Ag(o,e||Ng(),n||null,i)}let lo=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return jH({name:""},i,n,"");{const o=n.name??"";return jH({name:o},n.parent,n.providers,o)}}}return(r=e).THROW_IF_NOT_FOUND=c7,r.NULL=new WM,r.\u0275prov=De({token:r,providedIn:"any",factory:()=>Oe(bH)}),r.__NG_ELEMENT_ID__=-1,e})();function D3(r){return r instanceof Function?r():r}let fE=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new pe(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function D7(r){for(;r;){r[en]|=64;const e=T7(r);if(tM(r)&&!e)return r;r=e}return null}function dE(r){return r.ngOriginalError}class _6{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&dE(e);for(;t&&dE(t);)t=dE(t);return t||null}}const JH=new et("",{providedIn:"root",factory:()=>!1});class rV extends Uz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){D7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=Ii(this);this.trackingVersion++;try{e(t,n)}finally{Ii(i)}}destroy(){this.trackingVersion++}}let Vg=null;function iV(){return Vg??=new rV,Vg}function oV(r,e){return r[e]??iV()}function sV(r,e){const t=iV();t.hasReadASignal&&(r[e]=Vg,t.lView=r,Vg=new rV)}const tn={};function _(r){aV(Dn(),Pe(),us()+r,!1)}function aV(r,e,t,n){if(!n)if(3==(3&e[en])){const o=r.preOrderCheckHooks;null!==o&&eg(e,o,t)}else{const o=r.preOrderHooks;null!==o&&tg(e,o,0,t)}d6(t)}function U(r,e=fn.Default){const t=Pe();return null===t?Oe(r,e):OD(co(),t,Wt(r),e)}function Fg(r,e,t,n,i,o,s,a,c,l,f){const d=e.blueprint.slice();return d[Rr]=i,d[en]=140|n,(null!==l||r&&2048&r[en])&&(d[en]|=2048),eD(d),d[Y1]=d[l8]=r,d[zr]=t,d[c8]=s||r&&r[c8],d[Kt]=a||r&&r[Kt],d[$4]=c||r&&r[$4]||null,d[zo]=o,d[p7]=function C0e(){return v0e++}(),d[k3]=f,d[Hz]=l,d[Dr]=2==e.type?r[Dr]:d,d}function L8(r,e,t,n,i){let o=r.data[e];if(null===o)o=hE(r,e,t,n,i),function C6e(){return Bt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=t,o.value=n,o.attrs=i;const s=_7();o.injectorIndex=null===s?-1:s.injectorIndex}return Ec(o,!0),o}function hE(r,e,t,n,i){const o=sD(),s=aM(),c=r.data[e]=function g5e(r,e,t,n,i,o){let s=e?e.injectorIndex:-1,a=0;return h8()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}function H7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let o=0;o<t;o++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function lV(r,e,t,n,i){const o=oV(e,Uh),s=us(),a=2&n;try{if(d6(-1),a&&e.length>yn&&aV(r,e,yn,!1),Mc(a?2:0,i),a)o.runInContext(t,n,i);else{const l=Ii(null);try{t(n,i)}finally{Ii(l)}}}finally{a&&null===e[Uh]&&sV(e,Uh),d6(s),Mc(a?3:1,i)}}function gE(r,e,t){if(eM(e)){const n=Ii(null);try{const o=e.directiveEnd;for(let s=e.directiveStart;s<o;s++){const a=r.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{Ii(n)}}}function pE(r,e,t){oD()&&(function M5e(r,e,t,n){const i=t.directiveStart,o=t.directiveEnd;u6(t)&&function w5e(r,e,t){const n=Bs(e,r),i=uV(t);let s=16;t.signals?s=4096:t.onPush&&(s=64);const a=$g(r,Fg(r,i,null,s,n,e,null,r[c8].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||rg(t,e),Ho(n,e);const s=t.initialInputs;for(let a=i;a<o;a++){const c=r.data[a],l=h6(e,r,a,t);Ho(l,e),null!==s&&N5e(0,a-i,l,c,0,s),ka(c)&&(_2(t.index,e)[zr]=h6(e,r,a,t))}}(r,e,t,Bs(t,e)),64==(64&t.flags)&&pV(r,e,t))}function mE(r,e,t=Bs){const n=e.localNames;if(null!==n){let i=e.index+1;for(let o=0;o<n.length;o+=2){const s=n[o+1],a=-1===s?t(e,r):r[s];r[i++]=a}}}function uV(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=_E(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function _E(r,e,t,n,i,o,s,a,c,l,f){const d=yn+n,m=d+i,E=function c5e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:tn);return t}(d,m),T="function"==typeof l?l():l;return E[Je]={type:r,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:T,incompleteFirstPass:!1,ssrId:f}}let fV=r=>null;function dV(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const o=r[i];null===n?hV(t,e,i,o):n.hasOwnProperty(i)&&hV(t,e,n[i],o)}return t}function hV(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function M2(r,e,t,n,i,o,s,a){const c=Bs(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(EE(r,t,f,n,i),u6(e)&&function _5e(r,e){const t=_2(e,r);16&t[en]||(t[en]|=64)}(t,e.index)):3&e.type&&(n=function m5e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=s?s(i,e.value||"",n):i,o.setProperty(c,n,i))}function vE(r,e,t,n){if(oD()){const i=null===n?null:{"":-1},o=function P5e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let o=0;o<t.length;o++){const s=t[o];if(kz(e,s.selectors,!1))if(n||(n=[]),ka(s))if(null!==s.findHostDirectiveDefs){const a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),n.unshift(...a,s),CE(r,e,a.length)}else n.unshift(s),CE(r,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,n,i),n.push(s)}return null===n?null:[n,i]}(r,t);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&gV(r,e,t,s,i,a),i&&function S5e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const o=t[e[i+1]];if(null==o)throw new pe(-301,!1);n.push(e[i],o)}}}(t,n,i)}t.mergedAttrs=f7(t.mergedAttrs,t.attrs)}function gV(r,e,t,n,i,o){for(let l=0;l<n.length;l++)CM(rg(t,e),r,n[l].type);!function T5e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let s=!1,a=!1,c=H7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=f7(t.mergedAttrs,f.hostAttrs),b5e(r,t,e,c,f),O5e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function p5e(r,e,t){const i=e.directiveEnd,o=r.data,s=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=o[f],m=t?t.get(d):null,T=m?m.outputs:null;c=dV(d.inputs,f,c,m?m.inputs:null),l=dV(d.outputs,f,l,T);const L=null===c||null===s||Iz(e)?null:A5e(c,f,s);a.push(L)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,o)}function pV(r,e,t){const n=t.directiveStart,i=t.directiveEnd,o=t.index,s=function M6e(){return Bt.lFrame.currentDirectiveIndex}();try{d6(o);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];lM(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&E5e(c,l)}}finally{d6(-1),lM(s)}}function E5e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function CE(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function O5e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;ka(e)&&(t[""]=r)}}function b5e(r,e,t,n,i){r.data[n]=i;const o=i.factory||(i.factory=f6(i.type)),s=new v7(o,ka(i),U);r.blueprint[n]=s,t[n]=s,function C5e(r,e,t,n,i){const o=i.hostBindings;if(o){let s=r.hostBindingOpCodes;null===s&&(s=r.hostBindingOpCodes=[]);const a=~e.index;(function y5e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(s)!=a&&s.push(a),s.push(t,n,o)}}(r,e,n,H7(r,t,i.hostVars,tn),i)}function yE(r,e,t,n,i,o,s){if(null==o)r.removeAttribute(e,i,t);else{const a=null==s?Yt(o):s(o,n||"",i);r.setAttribute(e,i,a,t)}}function N5e(r,e,t,n,i,o){const s=o[e];if(null!==s)for(let a=0;a<s.length;)mV(n,t,s[a++],s[a++],s[a++])}function mV(r,e,t,n,i){const o=Ii(null);try{const s=r.inputTransforms;null!==s&&s.hasOwnProperty(n)&&(i=s[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{Ii(o)}}function A5e(r,e,t){let n=null,i=0;for(;i<t.length;){const o=t[i];if(0!==o)if(5!==o){if("number"==typeof o)break;if(r.hasOwnProperty(o)){null===n&&(n=[]);const s=r[o];for(let a=0;a<s.length;a+=2)if(s[a]===e){n.push(o,s[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function _V(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function vV(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const o=t[n+1];if(-1!==o){const s=r.data[o];fM(t[n]),s.contentQueries(2,e[o],o)}}}function $g(r,e){return r[h7]?r[Dz][Ia]=e:r[h7]=e,r[Dz]=e,e}function ME(r,e,t){fM(0);const n=Ii(null);try{e(r,t)}finally{Ii(n)}}function CV(r){return r[a8]||(r[a8]=[])}function yV(r){return r.cleanup||(r.cleanup=[])}function EV(r,e){const t=r[$4],n=t?t.get(_6,null):null;n&&n.handleError(e)}function EE(r,e,t,n,i){for(let o=0;o<t.length;){const s=t[o++],a=t[o++];mV(r.data[s],e[s],n,a,i)}}function H3(r,e,t){const n=Xh(e,r);tH(r[Kt],n,t)}function I5e(r,e){const t=_2(e,r),n=t[Je];!function k5e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Rr];null!==i&&null===t[k3]&&(t[k3]=oE(i,t[$4])),PE(n,t,t[zr])}function PE(r,e,t){dM(e);try{const n=r.viewQuery;null!==n&&ME(1,n,t);const i=r.template;null!==i&&lV(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&vV(r,e),r.staticViewQueries&&ME(2,r.viewQuery,t);const o=r.components;null!==o&&function x5e(r,e){for(let t=0;t<e.length;t++)I5e(r,e[t])}(e,o)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[en]&=-5,hM()}}let PV=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,o){const s=typeof Zone>"u"?null:Zone.current,a=new Xle(n,f=>{this.all.has(f)&&this.queue.set(f,s)},o);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function Gg(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?i=Hy(i,a):2==o&&(n=Hy(n,a+": "+e[++s]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function V7(r,e,t,n,i=!1){for(;null!==t;){const o=e[t.index];if(null!==o&&n.push(b1(o)),Gs(o)){for(let a=ao;a<o.length;a++){const c=o[a],l=c[Je].firstChild;null!==l&&V7(c[Je],c,l,n)}o[Cc]!==o[Rr]&&n.push(o[Cc])}const s=t.type;if(8&s)V7(r,e,t.child,n);else if(32&s){const a=IM(t,e);let c;for(;c=a();)n.push(c)}else if(16&s){const a=uH(e,t);if(Array.isArray(a))n.push(...a);else{const c=T7(e[Dr]);V7(c[Je],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function Bg(r,e,t,n=!0){const i=e[c8],o=i.rendererFactory,s=i.afterRenderEventManager;o.begin?.(),s?.begin();try{SV(r,e,r.template,t)}catch(c){throw n&&EV(e,c),c}finally{o.end?.(),i.effectManager?.flush(),s?.end()}}function SV(r,e,t,n){const i=e[en];if(256!=(256&i)){e[c8].effectManager?.flush(),dM(e);try{eD(e),function cD(r){return Bt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&lV(r,e,t,2,n);const s=3==(3&i);if(s){const l=r.preOrderCheckHooks;null!==l&&eg(e,l,null)}else{const l=r.preOrderHooks;null!==l&&tg(e,l,0,null),gM(e,0)}if(function z5e(r){for(let e=QD(r);null!==e;e=JD(e)){if(!e[Vz])continue;const t=e[f8];for(let n=0;n<t.length;n++){c6e(t[n])}}}(e),OV(e,2),null!==r.contentQueries&&vV(r,e),s){const l=r.contentCheckHooks;null!==l&&eg(e,l)}else{const l=r.contentHooks;null!==l&&tg(e,l,1),gM(e,1)}!function a5e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=oV(e,Wh);try{for(let i=0;i<t.length;i++){const o=t[i];if(o<0)d6(~o);else{const s=o,a=t[++i],c=t[++i];y6e(a,s),n.runInContext(c,2,e[s])}}}finally{null===e[Wh]&&sV(e,Wh),d6(-1)}}(r,e);const a=r.components;null!==a&&bV(e,a,0);const c=r.viewQuery;if(null!==c&&ME(2,c,n),s){const l=r.viewCheckHooks;null!==l&&eg(e,l)}else{const l=r.viewHooks;null!==l&&tg(e,l,2),gM(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[en]&=-73,tD(e)}finally{hM()}}}function OV(r,e){for(let t=QD(r);null!==t;t=JD(t))for(let n=ao;n<t.length;n++)TV(t[n],e)}function D5e(r,e,t){TV(_2(e,r),t)}function TV(r,e){if(!function s6e(r){return 128==(128&r[en])}(r))return;const t=r[Je];if(80&r[en]&&0===e||1024&r[en]||2===e)SV(t,r,t.template,r[zr]);else if(r[d7]>0){OV(r,1);const i=r[Je].components;null!==i&&bV(r,i,1)}}function bV(r,e,t){for(let n=0;n<e.length;n++)D5e(r,e[n],t)}class F7{get rootNodes(){const e=this._lView,t=e[Je];return V7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[zr]}set context(e){this._lView[zr]=e}get destroyed(){return 256==(256&this._lView[en])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Y1];if(Gs(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(vg(e,n),ag(t,n))}this._attachedToViewContainer=!1}xM(this._lView[Je],this._lView)}onDestroy(e){!function rD(r,e){if(256==(256&r[en]))throw new pe(911,!1);null===r[G4]&&(r[G4]=[]),r[G4].push(e)}(this._lView,e)}markForCheck(){D7(this._cdRefInjectingView||this._lView)}detach(){this._lView[en]&=-129}reattach(){this._lView[en]|=128}detectChanges(){Bg(this._lView[Je],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function x0e(r,e){w7(r,e,e[Kt],2,null,null)}(this._lView[Je],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new pe(902,!1);this._appRef=e}}class H5e extends F7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Bg(e[Je],e,e[zr],!1)}checkNoChanges(){}get context(){return null}}class wV extends Dg{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=zn(e);return new $7(t,this.ngModule)}}function NV(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class F5e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Fh(n);const i=this.injector.get(e,cE,n);return i!==cE||t===cE?i:this.parentInjector.get(e,t,n)}}class $7 extends $H{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=NV(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return NV(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function xle(r){return r.map(kle).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let o=(i=i||this.ngModule)instanceof y2?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new F5e(e,o):e,a=s.get(z7,null);if(null===a)throw new pe(407,!1);const d={rendererFactory:a,sanitizer:s.get(W8e,null),effectManager:s.get(PV,null),afterRenderEventManager:s.get(fE,null)},m=a.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",T=n?function l5e(r,e,t,n){const o=n.get(JH,!1)||t===X2.ShadowDom,s=r.selectRootElement(e,o);return function u5e(r){fV(r)}(s),s}(m,n,this.componentDef.encapsulation,s):_g(m,E,function V5e(r){const e=r.toLowerCase();return"svg"===e?Xz:"math"===e?"math":null}(E)),G=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let B=null;null!==T&&(B=oE(T,s,!0));const de=_E(0,null,null,1,0,null,null,null,null,null,null),ye=Fg(null,de,null,G,null,null,d,m,s,null,B);let Le,tt;dM(ye);try{const gt=this.componentDef;let Pn,Et=null;gt.findHostDirectiveDefs?(Pn=[],Et=new Map,gt.findHostDirectiveDefs(gt,Pn,Et),Pn.push(gt)):Pn=[gt];const no=function G5e(r,e){const t=r[Je],n=yn;return r[n]=e,L8(t,n,2,"#host",null)}(ye,T),X0=function B5e(r,e,t,n,i,o,s){const a=i[Je];!function U5e(r,e,t,n){for(const i of r)e.mergedAttrs=f7(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Gg(e,e.mergedAttrs,!0),null!==t&&gH(n,t,e))}(n,r,e,s);let c=null;null!==e&&(c=oE(e,i[$4]));const l=o.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=Fg(i,uV(t),null,f,i[r.index],r,o,l,null,null,c);return a.firstCreatePass&&CE(a,r,n.length-1),$g(i,d),i[r.index]=d}(no,T,gt,Pn,ye,d,m);tt=Jz(de,yn),T&&function q5e(r,e,t,n){if(n)Qy(r,t,["ng-version",BH.full]);else{const{attrs:i,classes:o}=function Lle(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let o=r[n];if("string"==typeof o)2===i?""!==o&&e.push(o,r[++n]):8===i&&t.push(o);else{if(!Aa(i))break;i=o}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Qy(r,t,i),o&&o.length>0&&hH(r,t,o.join(" "))}}(m,gt,T,n),void 0!==t&&function j5e(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const o=t[i];n.push(null!=o?Array.from(o):null)}}(tt,this.ngContentSelectors,t),Le=function W5e(r,e,t,n,i,o){const s=co(),a=i[Je],c=Bs(s,i);gV(a,i,s,t,null,n);for(let f=0;f<t.length;f++)Ho(h6(i,a,s.directiveStart+f,s),i);pV(a,i,s),c&&Ho(c,i);const l=h6(i,a,s.directiveStart+s.componentOffset,s);if(r[zr]=i[zr]=l,null!==o)for(const f of o)f(l,e);return gE(a,s,r),l}(X0,gt,Pn,Et,ye,[Z5e]),PE(de,ye,null)}finally{hM()}return new $5e(this.componentType,Le,A8(tt,ye),ye,tt)}}class $5e extends V8e{constructor(e,t,n,i,o){super(),this.location=n,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new H5e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const o=this._rootLView;EE(o[Je],o,i,e,t),this.previousInputValues.set(e,t),D7(_2(this._tNode.index,o))}}get injector(){return new fs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Z5e(){const r=co();Jh(Pe()[Je],r)}function Ge(r){let e=function AV(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(ka(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new pe(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const s=r;s.inputs=Ug(r.inputs),s.inputTransforms=Ug(r.inputTransforms),s.declaredInputs=Ug(r.declaredInputs),s.outputs=Ug(r.outputs);const a=i.hostBindings;a&&Q5e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&K5e(r,c),l&&X5e(r,l),Lh(r.inputs,i.inputs),Lh(r.declaredInputs,i.declaredInputs),Lh(r.outputs,i.outputs),null!==i.inputTransforms&&(null===s.inputTransforms&&(s.inputTransforms={}),Lh(s.inputTransforms,i.inputTransforms)),ka(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(r),a===Ge&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Y5e(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=f7(i.hostAttrs,t=f7(t,i.hostAttrs))}}(n)}function Ug(r){return r===_c?{}:r===Yn?[]:r}function K5e(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function X5e(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,o)=>{e(n,i,o),t(n,i,o)}:e}function Q5e(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function LV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function Wg(r){return!!SE(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function SE(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function bc(r,e,t){return r[e]=t}function Fo(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function v6(r,e,t,n){const i=Fo(r,e,t);return Fo(r,e+1,n)||i}function A(r,e,t,n){const i=Pe();return Fo(i,g8(),e)&&(Dn(),function Tc(r,e,t,n,i,o){const s=Bs(r,e);yE(e[Kt],s,o,r.value,t,n,i)}(ir(),i,r,e,t,n)),A}function z8(r,e,t,n){return Fo(r,g8(),t)?e+Yt(t)+n:tn}function D8(r,e,t,n,i,o){const a=v6(r,x3(),t,i);return L3(2),a?e+Yt(t)+n+Yt(i)+o:tn}function H8(r,e,t,n,i,o,s,a){const l=function qg(r,e,t,n,i){const o=v6(r,e,t,n);return Fo(r,e+2,i)||o}(r,x3(),t,i,s);return L3(3),l?e+Yt(t)+n+Yt(i)+o+Yt(s)+a:tn}function V8(r,e,t,n,i,o,s,a,c,l){const d=function ea(r,e,t,n,i,o){const s=v6(r,e,t,n);return v6(r,e+2,i,o)||s}(r,x3(),t,i,s,c);return L3(4),d?e+Yt(t)+n+Yt(i)+o+Yt(s)+a+Yt(c)+l:tn}function O(r,e,t,n,i,o,s,a){const c=Pe(),l=Dn(),f=r+yn,d=l.firstCreatePass?function Pue(r,e,t,n,i,o,s,a,c){const l=e.consts,f=L8(e,r,4,s||null,B4(l,a));vE(e,t,f,B4(l,c)),Jh(e,f);const d=f.tView=_E(2,f,n,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,o,s):l.data[f];Ec(d,!1);const m=jV(l,c,d,r);Qh()&&yg(l,c,m,d),Ho(m,c),$g(c,c[f]=_V(m,c,m,d)),jh(d)&&pE(l,c,d),null!=s&&mE(c,d,a)}let jV=function ZV(r,e,t,n){return U4(!0),e[Kt].createComment("")};function dn(r){return d8(function v6e(){return Bt.lFrame.contextLView}(),yn+r)}function y(r,e,t){const n=Pe();return Fo(n,g8(),e)&&M2(Dn(),ir(),n,r,e,n[Kt],t,!1),y}function AE(r,e,t,n,i){const s=i?"class":"style";EE(r,t,e.inputs[s],s,n)}function P(r,e,t,n){const i=Pe(),o=Dn(),s=yn+r,a=i[Kt],c=o.firstCreatePass?function bue(r,e,t,n,i,o){const s=e.consts,c=L8(e,r,2,n,B4(s,i));return vE(e,t,c,B4(s,o)),null!==c.attrs&&Gg(c,c.attrs,!1),null!==c.mergedAttrs&&Gg(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,o,i,e,t,n):o.data[s],l=YV(o,i,c,a,e,r);i[s]=l;const f=jh(c);return Ec(c,!0),gH(a,l,c),32!=(32&c.flags)&&Qh()&&yg(o,i,l,c),0===function u6e(){return Bt.lFrame.elementDepthCount}()&&Ho(l,i),function f6e(){Bt.lFrame.elementDepthCount++}(),f&&(pE(o,i,c),gE(o,c,i)),null!==n&&mE(i,c),P}function S(){let r=co();aM()?cM():(r=r.parent,Ec(r,!1));const e=r;(function h6e(r){return Bt.skipHydrationRootTNode===r})(e)&&function _6e(){Bt.skipHydrationRootTNode=null}(),function d6e(){Bt.lFrame.elementDepthCount--}();const t=Dn();return t.firstCreatePass&&(Jh(t,r),eM(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function I6e(r){return 0!=(8&r.flags)}(e)&&AE(t,e,Pe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function k6e(r){return 0!=(16&r.flags)}(e)&&AE(t,e,Pe(),e.stylesWithoutHost,!1),S}function V(r,e,t,n){return P(r,e,t,n),S(),V}let YV=(r,e,t,n,i,o)=>(U4(!0),_g(n,i,function mD(){return Bt.lFrame.currentNamespace}()));function qt(r,e,t){const n=Pe(),i=Dn(),o=r+yn,s=i.firstCreatePass?function Aue(r,e,t,n,i){const o=e.consts,s=B4(o,n),a=L8(e,r,8,"ng-container",s);return null!==s&&Gg(a,s,!0),vE(e,t,a,B4(o,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,i,n,e,t):i.data[o];Ec(s,!0);const a=XV(i,n,s,r);return n[o]=a,Qh()&&yg(i,n,a,s),Ho(a,n),jh(s)&&(pE(i,n,s),gE(i,s,n)),null!=t&&mE(n,s),qt}function jt(){let r=co();const e=Dn();return aM()?cM():(r=r.parent,Ec(r,!1)),e.firstCreatePass&&(Jh(e,r),eM(r)&&e.queries.elementEnd(r)),jt}let XV=(r,e,t,n)=>(U4(!0),kM(e[Kt],""));function ge(){return Pe()}function q7(r){return!!r&&"function"==typeof r.then}function QV(r){return!!r&&"function"==typeof r.subscribe}function q(r,e,t,n){const i=Pe(),o=Dn(),s=co();return function eF(r,e,t,n,i,o,s){const a=jh(n),l=r.firstCreatePass&&yV(r),f=e[zr],d=CV(e);let m=!0;if(3&n.type||s){const L=Bs(n,e),z=s?s(L):L,G=d.length,B=s?ye=>s(b1(ye[n.index])):n.index;let de=null;if(!s&&a&&(de=function xue(r,e,t,n){const i=r.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===t&&i[o+1]===n){const a=e[a8],c=i[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=o,de.__ngLastListenerFn__=o,m=!1;else{o=nF(n,e,f,o,!1);const ye=t.listen(z,i,o);d.push(o,ye),l&&l.push(i,B,G,G+1)}}else o=nF(n,e,f,o,!1);const E=n.outputs;let T;if(m&&null!==E&&(T=E[i])){const L=T.length;if(L)for(let z=0;z<L;z+=2){const Le=e[T[z]][T[z+1]].subscribe(o),tt=d.length;d.push(o,Le),l&&l.push(i,n.index,tt,-(tt+1))}}}(o,i,i[Kt],s,r,e,n),q}function tF(r,e,t,n){try{return Mc(6,e,t),!1!==t(n)}catch(i){return EV(r,i),!1}finally{Mc(7,e,t)}}function nF(r,e,t,n,i){return function o(s){if(s===Function)return n;D7(r.componentOffset>-1?_2(r.index,e):e);let c=tF(e,t,n,s),l=o.__ngNextListenerFn__;for(;l;)c=tF(e,t,l,s)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&s.preventDefault(),c}}function p(r=1){return function P6e(r){return(Bt.lFrame.contextLView=function S6e(r,e){for(;r>0;)e=e[l8],r--;return e}(r,Bt.lFrame.contextLView))[zr]}(r)}function Lue(r,e){let t=null;const n=function wle(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===n?kz(r,o,!0):Ile(n,o))return i}else t=i}return t}function Kg(r,e,t){return hn(r,"",e,"",t),Kg}function hn(r,e,t,n,i){const o=Pe(),s=z8(o,e,t,n);return s!==tn&&M2(Dn(),ir(),o,r,s,o[Kt],i,!1),hn}function Ce(r,e,t,n,i,o,s){const a=Pe(),c=D8(a,e,t,n,i,o);return c!==tn&&M2(Dn(),ir(),a,r,c,a[Kt],s,!1),Ce}function Hr(r,e,t,n,i,o,s,a,c){const l=Pe(),f=H8(l,e,t,n,i,o,s,a);return f!==tn&&M2(Dn(),ir(),l,r,f,l[Kt],c,!1),Hr}function IE(r,e,t,n,i,o,s,a,c,l,f){const d=Pe(),m=V8(d,e,t,n,i,o,s,a,c,l);return m!==tn&&M2(Dn(),ir(),d,r,m,d[Kt],f,!1),IE}function Xg(r,e){return r<<17|e<<2}function q4(r){return r>>17&32767}function kE(r){return 2|r}function C6(r){return(131068&r)>>2}function xE(r,e){return-131069&r|e<<2}function LE(r){return 1|r}function uF(r,e,t,n,i){const o=r[t+1],s=null===e;let a=n?q4(o):C6(o),c=!1;for(;0!==a&&(!1===c||s);){const f=r[a+1];Fue(r[a],e)&&(c=!0,r[a+1]=n?LE(f):kE(f)),a=n?q4(f):C6(f)}c&&(r[t+1]=n?kE(o):LE(o))}function Fue(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&E8(r,e)>=0}const gi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function fF(r){return r.substring(gi.key,gi.keyEnd)}function $ue(r){return r.substring(gi.value,gi.valueEnd)}function hF(r,e){const t=gi.textEnd;let n=gi.key=U8(r,e,t);return t===n?-1:(n=gi.keyEnd=function Wue(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=pF(r,n,t),n=gi.value=U8(r,n,t),n=gi.valueEnd=function que(r,e,t){let n=-1,i=-1,o=-1,s=e,a=s;for(;s<t;){const c=r.charCodeAt(s++);if(59===c)return a;34===c||39===c?a=s=mF(r,c,s,t):e===s-4&&85===o&&82===i&&76===n&&40===c?a=s=mF(r,41,s,t):c>32&&(a=s),o=i,i=n,n=-33&c}return a}(r,n,t),pF(r,n,t))}function U8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function pF(r,e,t,n){return(e=U8(r,e,t))<t&&e++,e}function mF(r,e,t,n){let i=-1,o=t;for(;o<n;){const s=r.charCodeAt(o++);if(s==e&&92!==i)return o;i=92==s&&92===i?0:s}throw new Error}function Qg(r,e){return function xa(r,e,t,n){const i=Pe(),o=Dn(),s=L3(2);o.firstUpdatePass&&CF(o,r,s,n),e!==tn&&Fo(i,s,e)&&MF(o,o.data[us()],i,i[Kt],r,i[s+1]=function n7e(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=di(C2(r)))),r}(e,t),n,s)}(r,e,null,!0),Qg}function uo(r){!function La(r,e,t,n){const i=Dn(),o=L3(2);i.firstUpdatePass&&CF(i,null,o,n);const s=Pe();if(t!==tn&&Fo(s,o,t)){const a=i.data[us()];if(PF(a,n)&&!vF(i,o)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=Hy(c,t||"")),AE(i,a,s,t,n)}else!function t7e(r,e,t,n,i,o,s,a){i===tn&&(i=Yn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<o.length?o[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,E=l<o.length?o[l+1]:void 0;let L,T=null;f===d?(c+=2,l+=2,m!==E&&(T=d,L=E)):null===d||null!==f&&f<d?(c+=2,T=f):(l+=2,T=d,L=E),null!==T&&MF(r,e,t,n,T,L,s,a),f=c<i.length?i[c]:null,d=l<o.length?o[l]:null}}(i,a,s,s[Kt],s[o+1],s[o+1]=function Jue(r,e,t){if(null==t||""===t)return Yn;const n=[],i=C2(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)r(n,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&r(n,o,i[o]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,o)}}(yF,jue,r,!1)}function jue(r,e){for(let t=function Bue(r){return function gF(r){gi.key=0,gi.keyEnd=0,gi.value=0,gi.valueEnd=0,gi.textEnd=r.length}(r),hF(r,U8(r,0,gi.textEnd))}(e);t>=0;t=hF(e,t))yF(r,fF(e),$ue(e))}function vF(r,e){return e>=r.expandoStartIndex}function CF(r,e,t,n){const i=r.data;if(null===i[t+1]){const o=i[us()],s=vF(r,t);PF(o,n)&&null===e&&!s&&(e=!1),e=function Yue(r,e,t,n){const i=function uM(r){const e=Bt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let o=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=j7(t=RE(null,r,e,t,n),e.attrs,n),o=null);else{const s=e.directiveStylingLast;if(-1===s||r[s]!==i)if(t=RE(i,r,e,t,n),null===o){let c=function Kue(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==C6(n))return r[q4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=RE(null,r,e,c[1],n),c=j7(c,e.attrs,n),function Xue(r,e,t,n){r[q4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else o=function Que(r,e,t){let n;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)n=j7(n,r[o].hostAttrs,t);return j7(n,e.attrs,t)}(r,e,n)}return void 0!==o&&(n?e.residualClasses=o:e.residualStyles=o),t}(i,o,e,n),function Hue(r,e,t,n,i,o){let s=o?e.classBindings:e.styleBindings,a=q4(s),c=C6(s);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||E8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=q4(r[a+1]);r[n+1]=Xg(m,a),0!==m&&(r[m+1]=xE(r[m+1],n)),r[a+1]=function zue(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=Xg(a,0),0!==a&&(r[a+1]=xE(r[a+1],n)),a=n;else r[n+1]=Xg(c,0),0===a?a=n:r[c+1]=xE(r[c+1],n),c=n;l&&(r[n+1]=kE(r[n+1])),uF(r,f,n,!0),uF(r,f,n,!1),function Vue(r,e,t,n,i){const o=i?r.residualClasses:r.residualStyles;null!=o&&"string"==typeof e&&E8(o,e)>=0&&(t[n+1]=LE(t[n+1]))}(e,f,r,n,o),s=Xg(a,c),o?e.classBindings=s:e.styleBindings=s}(i,o,e,t,s,n)}}function RE(r,e,t,n,i){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],n=j7(n,o.hostAttrs,i),o!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function j7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),v2(r,s,!!t||e[++o]))}return void 0===r?null:r}function yF(r,e,t){v2(r,e,C2(t))}function MF(r,e,t,n,i,o,s,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function Due(r){return 1==(1&r)}(l)?EF(c,e,t,i,C6(l),s):void 0;Jg(f)||(Jg(o)||function Rue(r){return 2==(2&r)}(l)&&(o=EF(c,null,t,i,a,s)),function B0e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let o=-1===n.indexOf("-")?void 0:W4.DashCase;null==i?r.removeStyle(t,n,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=W4.Important),r.setStyle(t,n,i,o))}}(n,s,Xh(us(),t),i,o))}function EF(r,e,t,n,i,o){const s=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===tn&&(m=d?Yn:void 0);let E=d?EM(m,n):f===n?m:void 0;if(l&&!Jg(E)&&(E=EM(c,n)),Jg(E)&&(a=E,s))return a;const T=r[i+1];i=s?q4(T):C6(T)}if(null!==e){let c=o?e.residualClasses:e.residualStyles;null!=c&&(a=EM(c,n))}return a}function Jg(r){return void 0!==r}function PF(r,e){return 0!=(r.flags&(e?8:16))}function rt(r,e=""){const t=Pe(),n=Dn(),i=r+yn,o=n.firstCreatePass?L8(n,i,1,e,null):n.data[i],s=SF(n,t,o,e,r);t[i]=s,Qh()&&yg(n,t,s,o),Ec(o,!1)}let SF=(r,e,t,n,i)=>(U4(!0),mg(e[Kt],n));function gn(r){return ni("",r,""),gn}function ni(r,e,t){const n=Pe(),i=z8(n,r,e,t);return i!==tn&&H3(n,us(),i),ni}function zE(r,e,t,n,i){const o=Pe(),s=D8(o,r,e,t,n,i);return s!==tn&&H3(o,us(),s),zE}function DE(r,e,t,n,i,o,s){const a=Pe(),c=H8(a,r,e,t,n,i,o,s);return c!==tn&&H3(a,us(),c),DE}function HE(r,e,t){const n=Pe();return Fo(n,g8(),e)&&M2(Dn(),ir(),n,r,e,n[Kt],t,!0),HE}const y6=void 0;var S7e=["en",[["a","p"],["AM","PM"],y6],[["AM","PM"],y6,y6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],y6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],y6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",y6,"{1} 'at' {0}",y6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function P7e(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let W8={};function hs(r){const e=function T7e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=GF(e);if(t)return t;const n=e.split("-")[0];if(t=GF(n),t)return t;if("en"===n)return S7e;throw new pe(701,!1)}function GF(r){return r in W8||(W8[r]=C1.ng&&C1.ng.common&&C1.ng.common.locales&&C1.ng.common.locales[r]),W8[r]}var w1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(w1||{});const b7e=["zero","one","two","few","many"],q8="en-US",ep={marker:"element"},tp={marker:"ICU"};var Ws=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(Ws||{});let BF=q8;function UF(r){(function K2(r,e){null==r&&Gt(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(BF=r.toLowerCase().replace(/_/g,"-"))}function WF(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?aH(r,0,t):b1(t[i])}function qF(r,e,t,n,i){const o=e.insertBeforeIndex;if(Array.isArray(o)){let s=n,a=null;if(3&e.type||(a=s,s=i),null!==s&&-1===e.componentOffset)for(let c=1;c<o.length;c++)g6(r,s,t[o[c]],a,!1)}}function jF(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];ZF(n)||I7e(n,e)&&null===k7e(n)&&x7e(n,e.index)}}function ZF(r){return!(64&r.type)}function I7e(r,e){return ZF(e)||r.index>e.index}function k7e(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function x7e(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(lH(WF,qF),r.insertBeforeIndex=e)}function Z7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function z7e(r,e,t){const n=hE(r,t,64,null,null);return jF(e,n),n}function np(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function YF(r){return r>>>17}function KF(r){return(131070&r)>>>1}let Y7=0,K7=0;function QF(r,e,t,n){const i=t[Kt];let s,o=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=mg(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=YF(c);let f,d;if(null===o&&(o=l,s=Cg(i,n)),l===o?(f=n,d=s):(f=null,d=b1(t[l])),null!==d){const L=KF(c);g6(i,d,t[L],f,!1);const G=Z7(r,L);if(null!==G&&"object"==typeof G){const B=np(G,t);null!==B&&QF(r,G.create[B],t,t[G.anchorIdx])}}break;case 1:const E=e[++a],T=e[++a];yE(i,Xh(c>>>1,t),null,null,E,T,null)}else switch(c){case tp:const l=e[++a],f=e[++a];null===t[f]&&Ho(t[f]=kM(i,l),t);break;case ep:const d=e[++a],m=e[++a];null===t[m]&&Ho(t[m]=_g(i,d,null),t)}}}function JF(r,e,t,n,i){for(let o=0;o<t.length;o++){const s=t[o],a=t[++o];if(s&i){let c="";for(let l=o+1;l<=o+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=Yt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],E=t[++l],T=r.data[d];"string"==typeof T?yE(e[Kt],e[d],null,T,m,c,E):M2(r,T,e,m,c,e[Kt],E,!1);break;case 0:const L=e[d];null!==L&&tH(e[Kt],L,c);break;case 2:$7e(r,Z7(r,d),e,c);break;case 3:e$(r,Z7(r,d),n,e)}}}}else{const c=t[o+1];if(c>0&&3==(3&c)){const f=Z7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&e$(r,f,n,e)}}o+=a}}function e$(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let o=Y7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,o=-1),JF(r,n,e.update[i],t,o)}}function $7e(r,e,t,n){const i=function G7e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function w7e(r,e){const t=function $F(r){return hs(r)[w1.PluralCase]}(e)(parseInt(r,10)),n=b7e[t];return void 0!==n?n:"other"}(e,function A7e(){return BF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(np(e,t)!==i&&(t$(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const s=t[e.anchorIdx];s&&QF(r,e.create[i],t,s)}}function t$(r,e,t){let n=np(e,t);if(null!==n){const i=e.remove[n];for(let o=0;o<i.length;o++){const s=i[o];if(s>0){const a=Xh(s,t);null!==a&&Mg(t[Kt],a)}else t$(r,Z7(r,~s),t)}}}function B7e(){const r=[];let t,n,e=-1;function o(a,c){e=0;const l=np(a,c);n=null!==l?a.remove[l]:Yn}function s(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),o(t[Je].data[~a],t),s())}return 0===r.length?null:(n=r.pop(),e=r.pop(),s())}return function i(a,c){for(t=c;r.length;)r.pop();return o(a.value,c),s}}const rp=/\ufffd(\d+):?\d*\ufffd/gi,W7e=/\ufffd(\d+)\ufffd/,r$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,X7="\ufffd",q7e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,j7e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Z7e=/\uE500/g;function i$(r,e,t,n,i,o,s){const a=H7(r,n,1,null);let c=a<<Ws.SHIFT,l=_7();e===l&&(l=null),null===l&&(c|=Ws.APPEND_EAGERLY),s&&(c|=Ws.COMMENT,function w0e(r){void 0===AM&&(AM=r())}(B7e)),i.push(c,null===o?"":o);const f=hE(r,a,s?32:1,null===o?"":o,null);jF(t,f);const d=f.index;return Ec(f,!1),null!==l&&e!==l&&function R7e(r,e){let t=r.insertBeforeIndex;null===t?(lH(WF,qF),t=r.insertBeforeIndex=[null,e]):(function l6(r,e,t){r!=e&&Gt(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function X7e(r,e,t,n,i,o,s){const a=s.match(rp),c=i$(r,e,t,o,n,a?null:s,!1);a&&Q7(i,s,c.index,null,0,null)}function Q7(r,e,t,n,i,o){const s=r.length,a=s+1;r.push(null,null);const c=s+2,l=e.split(rp);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const E=i+parseInt(m,10);r.push(-1-E),f|=o$(E)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,o),r[s]=f,r[a]=r.length-c,f}function o$(r){return 1<<Math.min(r,31)}function s$(r){let e,o,t="",n=0,i=!1;for(;null!==(e=q7e.exec(r));)i?e[0]===`${X7}/*${o}${X7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),o=e[1],i=!0);return t+=r.slice(n),t}function a$(r,e,t,n,i,o){let s=0;const a={type:i.type,currentCaseLViewIndex:H7(r,e,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};(function ofe(r,e,t){r.push(o$(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,o),function L7e(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,o,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const E=f[m];if("string"!=typeof E){const T=d.push(E)-1;f[m]=`\x3c!--\ufffd${T}\ufffd--\x3e`}}s=rfe(r,a,e,t,n,i.cases[l],f.join(""),d)|s}s&&function sfe(r,e,t){r.push(e,1,t<<2|3)}(t,s,o)}function nfe(r){const e=[],t=[];let n=1,i=0;const o=VE(r=r.replace(r$,function(s,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let s=0;s<o.length;){let a=o[s++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=VE(o[s++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function VE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let o;for(i.lastIndex=0;o=i.exec(r);){const a=o.index;if("}"==o[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);r$.test(c)?n.push(nfe(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const s=r.substring(e);return n.push(s),n}function rfe(r,e,t,n,i,o,s,a){const c=[],l=[],f=[];e.cases.push(o),e.create.push(c),e.remove.push(l),e.update.push(f);const m=vH(b8()).getInertBodyElement(s),E=UM(m)||m;return E?c$(r,e,t,n,c,l,f,E,i,a,0):0}function c$(r,e,t,n,i,o,s,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const E=H7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const T=m,L=T.tagName.toLowerCase();if(GM.hasOwnProperty(L)){FE(i,ep,L,c,E),r.data[E]=L;const de=T.attributes;for(let ye=0;ye<de.length;ye++){const Le=de.item(ye),tt=Le.name.toLowerCase();Le.value.match(rp)?EH.hasOwnProperty(tt)&&Q7(s,Le.value,E,Le.name,0,BM[tt]?Sg:null):afe(i,E,Le)}d=c$(r,e,t,n,i,o,s,m,E,l,f+1)|d,l$(o,E,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",G=z.match(rp);FE(i,null,G?"":z,c,E),l$(o,E,f),G&&(d=Q7(s,z,E,null,0,null)|d);break;case Node.COMMENT_NODE:const B=W7e.exec(m.textContent||"");if(B){const ye=l[parseInt(B[1],10)];FE(i,tp,"",c,E),a$(r,t,n,c,ye,E),ife(o,E,f)}}m=m.nextSibling}return d}function l$(r,e,t){0===t&&r.push(e)}function ife(r,e,t){0===t&&(r.push(~e),r.push(e))}function FE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function D7e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function afe(r,e,t){r.push(e<<1|1,t.name,t.value)}function qs(r,e,t=-1){const n=Dn(),i=Pe(),o=yn+r,s=B4(n.consts,e),a=_7();n.firstCreatePass&&function K7e(r,e,t,n,i,o){const s=_7(),a=[],c=[],l=[[]];i=function tfe(r,e){if(function efe(r){return-1===r}(e))return s$(r);{const t=r.indexOf(`:${e}${X7}`)+2+e.toString().length,n=r.search(new RegExp(`${X7}\\/\\*\\d+:${e}${X7}`));return s$(r.substring(t,n))}}(i,o);const f=function Y7e(r){return r.replace(Z7e," ")}(i).split(j7e);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const E=47===m.charCodeAt(0),L=(m.charCodeAt(E?1:0),yn+Number.parseInt(m.substring(E?2:1)));if(E)l.shift(),Ec(_7(),!1);else{const z=z7e(r,l[0],L);l.unshift([]),Ec(z,!0)}}else{const E=VE(m);for(let T=0;T<E.length;T++){let L=E[T];if(1&T){const z=L;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);a$(r,t,c,e,z,i$(r,s,l[0],t,a,"",!0).index)}else""!==L&&X7e(r,s,l[0],a,c,t,L)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,o,s,t),2===n.type?i[Dr][en]|=32:i[en]|=32;const c=n.data[o],f=rH(n,a===i[zo]?null:a,i);(function F7e(r,e,t,n){const i=r[Kt];for(let o=0;o<e.length;o++){const s=e[o++],a=e[o],l=(s&Ws.APPEND_EAGERLY)===Ws.APPEND_EAGERLY,f=s>>>Ws.SHIFT;let d=r[f];null===d&&(d=r[f]=(s&Ws.COMMENT)===Ws.COMMENT?i.createComment(a):mg(i,a)),l&&null!==t&&g6(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),lD(!0)}function js(){lD(!1)}function se(r,e,t){qs(r,e,t),js()}function Hn(r){return function H7e(r){r&&(Y7|=1<<Math.min(K7,31)),K7++}(Fo(Pe(),g8(),r)),Hn}function Bn(r){!function V7e(r,e,t){if(K7>0){const n=r.data[t];JF(r,e,Array.isArray(n)?n:n.update,x3()-K7-1,Y7)}Y7=0,K7=0}(Dn(),Pe(),r+yn)}function $E(r,e,t,n,i){if(r=Wt(r),Array.isArray(r))for(let o=0;o<r.length;o++)$E(r[o],e,t,n,i);else{const o=Dn(),s=Pe(),a=co();let c=m6(r)?r:Wt(r.provide);const l=xH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(m6(r)||!r.multi){const E=new v7(l,i,U),T=BE(c,e,i?f:f+m,d);-1===T?(CM(rg(a,s),o,c),GE(o,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),s.push(E)):(t[T]=E,s[T]=E)}else{const E=BE(c,e,f+m,d),T=BE(c,e,f,f+m),z=T>=0&&t[T];if(i&&!z||!i&&!(E>=0&&t[E])){CM(rg(a,s),o,c);const G=function Efe(r,e,t,n,i){const o=new v7(r,t,U);return o.multi=[],o.index=e,o.componentProviders=0,f$(o,i,n&&!t),o}(i?Mfe:yfe,t.length,i,n,l);!i&&z&&(t[T].providerFactory=G),GE(o,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(G),s.push(G)}else GE(o,r,E>-1?E:T,f$(t[i?T:E],l,!i&&n));!i&&n&&z&&t[T].componentProviders++}}}function GE(r,e,t,n){const i=m6(e),o=function E8e(r){return!!r.useClass}(e);if(i||o){const c=(o?Wt(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function f$(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function BE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function yfe(r,e,t,n){return UE(this.multi,[])}function Mfe(r,e,t,n){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=h6(t,t[Je],this.providerFactory.index,n);o=a.slice(0,s),UE(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],UE(i,o);return o}function UE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function X1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function Cfe(r,e,t){const n=Dn();if(n.firstCreatePass){const i=ka(r);$E(t,n.data,n.blueprint,i,!0),$E(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class M6{}class d${}class WE extends M6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new wV(this);const i=m2(e);this._bootstrapComponents=D3(i.bootstrap),this._r3Injector=ZH(e,t,[{provide:M6,useValue:this},{provide:Dg,useValue:this.componentFactoryResolver},...n],di(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class qE extends d${constructor(e){super(),this.moduleType=e}create(e){return new WE(this.moduleType,e,[])}}class h$ extends M6{constructor(e){super(),this.componentFactoryResolver=new wV(this),this.instance=null;const t=new Ag([...e.providers,{provide:M6,useValue:this},{provide:Dg,useValue:this.componentFactoryResolver}],e.parent||Ng(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function jE(r,e,t=null){return new h$({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let Ofe=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=NH(0,n.type),o=i.length>0?jE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=De({token:r,providedIn:"environment",factory:()=>new r(Oe(y2))}),e})();function g$(r){r.getStandaloneInjector=e=>e.get(Ofe).getOrCreateStandaloneInjector(r)}function Q1(r,e,t){const n=ls()+r,i=Pe();return i[n]===tn?bc(i,n,t?e.call(t):e()):function G7(r,e){return r[e]}(i,n)}function Ra(r,e,t,n){return M$(Pe(),ls(),r,e,t,n)}function J7(r,e){const t=r[e];return t===tn?void 0:t}function M$(r,e,t,n,i,o){const s=e+t;return Fo(r,s,i)?bc(r,s+1,o?n.call(o,i):n(i)):J7(r,s+1)}function za(r,e){const t=Dn();let n;const i=r+yn;t.firstCreatePass?(n=function Gfe(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const o=n.factory||(n.factory=f6(n.type)),a=Fs(U);try{const c=ng(!1),l=o();return ng(c),function Tue(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Pe(),i,l),l}finally{Fs(a)}}function Nc(r,e,t){const n=r+yn,i=Pe(),o=d8(i,n);return ef(i,n)?M$(i,ls(),e,o.transform,t,o):o.transform(t)}function T$(r,e,t,n){const i=r+yn,o=Pe(),s=d8(o,i);return ef(o,i)?function E$(r,e,t,n,i,o,s){const a=e+t;return v6(r,a,i,o)?bc(r,a+2,s?n.call(s,i,o):n(i,o)):J7(r,a+2)}(o,ls(),e,s.transform,t,n,s):s.transform(t,n)}function ef(r,e){return r[Je].data[e].pure}function YE(r){return e=>{setTimeout(r,void 0,e)}}const _1=class qfe extends Vs{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,o=t||(()=>null),s=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=YE(o),i&&(i=YE(i)),s&&(s=YE(s)));const a=super.subscribe({next:i,error:o,complete:s});return e instanceof On&&e.add(a),a}};function jfe(){return this._results[Symbol.iterator]()}class KE{get changes(){return this._changes||(this._changes=new _1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=KE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=jfe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function Q2(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function q6e(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],o=e[n];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function Yfe(r,e,t,n=!0){const i=e[Je];if(function R0e(r,e,t,n){const i=ao+n,o=t.length;n>0&&(t[i-1][Ia]=e),n<o-ao?(e[Ia]=t[i],ID(t,ao+n,e)):(t.push(e),e[Ia]=null),e[Y1]=t;const s=e[g7];null!==s&&t!==s&&function z0e(r,e){const t=r[f8];e[Dr]!==e[Y1][Y1][Dr]&&(r[Vz]=!0),null===t?r[f8]=[e]:t.push(e)}(s,e);const a=e[vc];null!==a&&a.insertView(r),e[en]|=128}(i,e,r,t),n){const o=DM(t,r),s=e[Kt],a=Cg(s,r[Cc]);null!==a&&function k0e(r,e,t,n,i,o){n[Rr]=i,n[zo]=e,w7(r,n,t,1,i,o)}(i,r[zo],s,e,a,o)}}let V3=(()=>{class e{}return e.__NG_ELEMENT_ID__=Qfe,e})();const Kfe=V3,Xfe=class extends Kfe{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function Zfe(r,e,t,n){const i=e.tView,a=Fg(r,i,t,4096&r[en]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[g7]=r[e.index];const l=r[vc];return null!==l&&(a[vc]=l.createEmbeddedView(i)),PE(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new F7(i)}};function Qfe(){return ip(co(),Pe())}function ip(r,e){return 4&r.type?new Xfe(e,r,A8(r,e)):null}let E2=(()=>{class e{}return e.__NG_ELEMENT_ID__=ide,e})();function ide(){return x$(co(),Pe())}const ode=E2,I$=class extends ode{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return A8(this._hostTNode,this._hostLView)}get injector(){return new fs(this._hostTNode,this._hostLView)}get parentInjector(){const e=ig(this._hostTNode,this._hostLView);if(mM(e)){const t=y7(e,this._hostLView),n=C7(e);return new fs(t[Je].data[n+8],t)}return new fs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=k$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ao}createEmbeddedView(e,t,n){let i,o;"number"==typeof n?i=n:null!=n&&(i=n.index,o=n.injector);const a=e.createEmbeddedViewImpl(t||{},o,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,o){const s=e&&!function E7(r){return"function"==typeof r}(e);let a;if(s)a=t;else{const L=t||{};a=L.index,n=L.injector,i=L.projectableNodes,o=L.environmentInjector||L.ngModuleRef}const c=s?e:new $7(zn(e)),l=n||this.parentInjector;if(!o&&null==c.ngModule){const z=(s?l:this.parentInjector).get(y2,null);z&&(o=z)}zn(c.componentType??{});const E=c.create(l,i,null,o);return this.insertImpl(E.hostView,a,false),E}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function a6e(r){return Gs(r[Y1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[Y1],f=new I$(l,l[zo],l[Y1]);f.detach(f.indexOf(e))}}const s=this._adjustIndex(t),a=this._lContainer;return Yfe(a,i,s,!n),e.attachToViewContainerRef(),ID(XE(a),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=k$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=vg(this._lContainer,t);n&&(ag(XE(this._lContainer),t),xM(n[Je],n))}detach(e){const t=this._adjustIndex(e,-1),n=vg(this._lContainer,t);return n&&null!=ag(XE(this._lContainer),t)?new F7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function k$(r){return r[8]}function XE(r){return r[8]||(r[8]=[])}function x$(r,e){let t;const n=e[r.index];return Gs(n)?t=n:(t=_V(n,e,null,r),e[r.index]=t,$g(e,t)),L$(t,e,r,n),new I$(t,r,e)}let L$=function R$(r,e,t,n){if(r[Cc])return;let i;i=8&t.type?b1(n):function sde(r,e){const t=r[Kt],n=t.createComment(""),i=Bs(e,r);return g6(t,Cg(t,i),n,function F0e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[Cc]=i};class QE{constructor(e){this.queryList=e,this.matches=null}clone(){return new QE(this.queryList)}setDirty(){this.queryList.setDirty()}}class JE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let o=0;o<n;o++){const s=t.getByIndex(o);i.push(this.queries[s.indexInDeclarationView].clone())}return new JE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==$$(e,t).matches&&this.queries[t].setDirty()}}class z${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class eP{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,o=this.getByIndex(n).embeddedTView(e,i);o&&(o.indexInDeclarationView=n,null!==t?t.push(o):t=[o])}return null!==t?new eP(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class tP{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new tP(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const o=n[i];this.matchTNodeWithReadOption(e,t,lde(t,o)),this.matchTNodeWithReadOption(e,t,og(t,e,o,!1,!1))}else n===V3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,og(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Vo||i===E2||i===V3&&4&t.type)this.addMatch(t.index,-2);else{const o=og(t,e,i,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function lde(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function fde(r,e,t,n){return-1===t?function ude(r,e){return 11&r.type?A8(r,e):4&r.type?ip(r,e):null}(e,r):-2===t?function dde(r,e,t){return t===Vo?A8(e,r):t===V3?ip(e,r):t===E2?x$(e,r):void 0}(r,e,n):h6(r,r[Je],t,e)}function D$(r,e,t,n){const i=e[vc].queries[n];if(null===i.matches){const o=r.data,s=t.matches,a=[];for(let c=0;c<s.length;c+=2){const l=s[c];a.push(l<0?null:fde(e,o[l],s[c+1],t.metadata.read))}i.matches=a}return i.matches}function nP(r,e,t,n){const i=r.queries.getByIndex(t),o=i.matches;if(null!==o){const s=D$(r,e,i,t);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)n.push(s[a/2]);else{const l=o[a+1],f=e[-c];for(let d=ao;d<f.length;d++){const m=f[d];m[g7]===m[Y1]&&nP(m[Je],m,l,n)}if(null!==f[f8]){const d=f[f8];for(let m=0;m<d.length;m++){const E=d[m];nP(E[Je],E,l,n)}}}}}return n}function Ac(r){const e=Pe(),t=Dn(),n=uD();fM(n+1);const i=$$(t,n);if(r.dirty&&function o6e(r){return 4==(4&r[en])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const o=i.crossesNgTemplate?nP(t,e,n,[]):D$(t,e,i,n);r.reset(o,B8e),r.notifyOnChanges()}return!0}return!1}function F3(r,e,t){const n=Dn();n.firstCreatePass&&(function F$(r,e,t){null===r.queries&&(r.queries=new eP),r.queries.track(new tP(e,t))}(n,new z$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function V$(r,e,t){const n=new KE(4==(4&t));(function h5e(r,e,t,n){const i=CV(e);i.push(t),r.firstCreatePass&&yV(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[vc]&&(e[vc]=new JE),e[vc].queries.push(new QE(n))}(n,Pe(),e)}function Ic(){return function hde(r,e){return r[vc].queries[e].queryList}(Pe(),uD())}function $$(r,e){return r.queries.getByIndex(e)}function mn(r,e){return ip(r,e)}const cP=new et("Application Initializer");let lP=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=nt(cP,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const o of this.appInits){const s=o();if(q7(s))n.push(s);else if(QV(s)){const a=new Promise((c,l)=>{s.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(o=>{this.reject(o)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),iG=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const kc=new et("LocaleId",{providedIn:"root",factory:()=>nt(kc,fn.Optional|fn.SkipSelf)||function Rde(){return typeof $localize<"u"&&$localize.locale||q8}()});let ap=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new xo(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class Hde{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let oG=(()=>{var r;class e{compileModuleSync(n){return new qE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=D3(m2(n).declarations).reduce((a,c)=>{const l=zn(c);return l&&a.push(new $7(l)),a},[]);return new Hde(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function lG(...r){}class u1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _1(!1),this.onMicrotaskEmpty=new _1(!1),this.onStable=new _1(!1),this.onError=new _1(!1),typeof Zone>"u")throw new pe(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function i9e(){const r="function"==typeof C1.requestAnimationFrame;let e=C1[r?"requestAnimationFrame":"setTimeout"],t=C1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function a9e(r){const e=()=>{!function s9e(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(C1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,hP(r),r.isCheckStableRunning=!0,dP(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),hP(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,o,s,a)=>{try{return uG(r),t.invokeTask(i,o,s,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||r.shouldCoalesceRunChangeDetection)&&e(),fG(r)}},onInvoke:(t,n,i,o,s,a,c)=>{try{return uG(r),t.invoke(i,o,s,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),fG(r)}},onHasTask:(t,n,i,o)=>{t.hasTask(i,o),n===i&&("microTask"==o.change?(r._hasPendingMicrotasks=o.microTask,hP(r),dP(r)):"macroTask"==o.change&&(r.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,n,i,o)=>(t.handleError(i,o),r.runOutsideAngular(()=>r.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!u1.isInAngularZone())throw new pe(909,!1)}static assertNotInAngularZone(){if(u1.isInAngularZone())throw new pe(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,o9e,lG,lG);try{return o.runTask(s,t,n)}finally{o.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const o9e={};function dP(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function hP(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function uG(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function fG(r){r._nesting--,dP(r)}class c9e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _1,this.onMicrotaskEmpty=new _1,this.onStable=new _1,this.onError=new _1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const dG=new et("",{providedIn:"root",factory:hG});function hG(){const r=nt(u1);let e=!0;return function rle(...r){const e=a7(r),t=function K4e(r,e){return"number"==typeof zy(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?g2(n[0]):r8(t)(fi(n,e)):mc}(new O1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new O1(i=>{let o;r.runOutsideAngular(()=>{o=r.onStable.subscribe(()=>{u1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const s=r.onUnstable.subscribe(()=>{u1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{o.unsubscribe(),s.unsubscribe()}}).pipe(pz()))}const gG=new et(""),lp=new et("");let mP,gP=(()=>{var r;class e{constructor(n,i,o){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,mP||(function l9e(r){mP=r}(o),o.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{u1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,o){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:o})}whenStable(n,i,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,o){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(u1),Oe(pP),Oe(lp))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),pP=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return mP?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),j4=null;const pG=new et("AllowMultipleToken"),_P=new et("PlatformDestroyListeners"),vP=new et("appBootstrapListener");class _G{constructor(e,t){this.name=e,this.token=t}}function CG(r,e,t=[]){const n=`Platform: ${e}`,i=new et(n);return(o=[])=>{let s=CP();if(!s||s.injector.get(pG,!1)){const a=[...t,...o,{provide:i,useValue:!0}];r?r(a):function d9e(r){if(j4&&!j4.get(pG,!1))throw new pe(400,!1);(function mG(){!function Yle(r){Wz=r}(()=>{throw new pe(600,!1)})})(),j4=r;const e=r.get(MG);(function vG(r){r.get(LH,null)?.forEach(t=>t())})(r)}(function yG(r=[],e){return lo.create({name:e,providers:[{provide:YM,useValue:"platform"},{provide:_P,useValue:new Set([()=>j4=null])},...r]})}(a,n))}return function g9e(r){const e=CP();if(!e)throw new pe(401,!1);return e}()}}function CP(){return j4?.get(MG)??null}let MG=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const o=function p9e(r="zone.js",e){return"noop"===r?new c9e:"zone.js"===r?new u1(e):r}(i?.ngZone,function EG(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return o.run(()=>{const s=function Sfe(r,e,t){return new WE(r,e,t)}(n.moduleType,this.injector,function bG(r){return[{provide:u1,useFactory:r},{provide:k7,multi:!0,useFactory:()=>{const e=nt(_9e,{optional:!0});return()=>e.initialize()}},{provide:TG,useFactory:m9e},{provide:dG,useFactory:hG}]}(()=>o)),a=s.injector.get(_6,null);return o.runOutsideAngular(()=>{const c=o.onError.subscribe({next:l=>{a.handleError(l)}});s.onDestroy(()=>{up(this._modules,s),c.unsubscribe()})}),function PG(r,e,t){try{const n=t();return q7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,o,()=>{const c=s.injector.get(lP);return c.runInitializers(),c.donePromise.then(()=>(UF(s.injector.get(kc,q8)||q8),this._moduleDoBootstrap(s),s))})})}bootstrapModule(n,i=[]){const o=SG({},i);return function u9e(r,e,t){const n=new qE(t);return Promise.resolve(n)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,o))}_moduleDoBootstrap(n){const i=n.injector.get(E6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(o=>i.bootstrap(o));else{if(!n.instance.ngDoBootstrap)throw new pe(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new pe(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(_P,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(lo))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function SG(r,e){return Array.isArray(e)?e.reduce(SG,r):{...r,...e}}let E6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=nt(TG),this.zoneIsStable=nt(dG),this.componentTypes=[],this.components=[],this.isStable=nt(ap).hasPendingTasks.pipe(Na(n=>n?$t(!1):this.zoneIsStable),function ile(r,e=pc){return r=r??ole,ei((t,n)=>{let i,o=!0;t.subscribe(pr(n,s=>{const a=e(s);(o||!r(i,a))&&(o=!1,i=a,n.next(s))}))})}(),pz()),this._injector=nt(y2)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const o=n instanceof $H;if(!this._injector.get(lP).done)throw!o&&function s8(r){const e=zn(r)||so(r)||cs(r);return null!==e&&e.standalone}(n),new pe(405,!1);let a;a=o?n:this._injector.get(Dg).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function f9e(r){return r.isBoundToModule}(a)?void 0:this._injector.get(M6),f=a.create(lo.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get(gG,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),up(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new pe(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;up(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(vP,[]);i.push(...this._bootstrapListeners),i.forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>up(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new pe(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function up(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const TG=new et("",{providedIn:"root",factory:()=>nt(_6).handleError.bind(void 0)});function m9e(){const r=nt(u1),e=nt(_6);return t=>r.runOutsideAngular(()=>e.handleError(t))}let _9e=(()=>{var r;class e{constructor(){this.zone=nt(u1),this.applicationRef=nt(E6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let xc=(()=>{class e{}return e.__NG_ELEMENT_ID__=C9e,e})();function C9e(r){return function y9e(r,e,t){if(u6(r)&&!t){const n=_2(r.index,e);return new F7(n,n)}return 47&r.type?new F7(e[Dr],e):null}(co(),Pe(),16==(16&r))}class IG{constructor(){}supports(e){return Wg(e)}create(e){return new T9e(e)}}const O9e=(r,e)=>e;class T9e{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||O9e}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,o=null;for(;t||n;){const s=!n||t&&t.currentIndex<xG(n,i,o)?t:n,a=xG(s,i,o),c=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)i++;else{o||(o=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const E=m<o.length?o[m]:o[m]=0,T=E+m;f<=T&&T<l&&(o[m]=E+1)}o[s.previousIndex]=f-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Wg(e))throw new pe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,s,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),n=!0),t=t._next}else i=0,function oue(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{s=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new b9e(t,n),o,i),e}_verifyReinsertion(e,t,n,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new kG),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kG),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class b9e{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class w9e{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class kG{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new w9e,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function xG(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class LG{constructor(){}supports(e){return e instanceof Map||SE(e)}create(){return new N9e}}class N9e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||SE(e)))throw new pe(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const o=i._prev,s=i._next;return o&&(o._next=s),s&&(s._prev=o),i._next=null,i._prev=null,i}const n=new A9e(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class A9e{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function RG(){return new hp([new IG])}let hp=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const o=i.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||RG()),deps:[[e,new lg,new ds]]}}find(n){const i=this.factories.find(o=>o.supports(n));if(null!=i)return i;throw new pe(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:RG}),e})();function zG(){return new rf([new LG])}let rf=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const o=i.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||zG()),deps:[[e,new lg,new ds]]}}find(n){const i=this.factories.find(o=>o.supports(n));if(i)return i;throw new pe(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:zG}),e})();const x9e=CG(null,"core",[]);let L9e=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(E6))},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({}),e})();function Y8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let OP=null;function Z4(){return OP}class Z9e{}const ki=new et("DocumentToken");let TP=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(K9e)},providedIn:"platform"}),e})();const Y9e=new et("Location Initialized");let K9e=(()=>{var r;class e extends TP{constructor(){super(),this._doc=nt(ki),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Z4().getBaseHref(this._doc)}onPopState(n){const i=Z4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=Z4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,o){this._history.pushState(n,i,o)}replaceState(n,i,o){this._history.replaceState(n,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function bP(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function UG(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function $3(r){return r&&"?"!==r[0]?"?"+r:r}let S6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(qG)},providedIn:"root"}),e})();const WG=new et("appBaseHref");let qG=(()=>{var r;class e extends S6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??nt(ki).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return bP(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+$3(this._platformLocation.search),o=this._platformLocation.hash;return o&&n?`${i}${o}`:i}pushState(n,i,o,s){const a=this.prepareExternalUrl(o+$3(s));this._platformLocation.pushState(n,i,a)}replaceState(n,i,o,s){const a=this.prepareExternalUrl(o+$3(s));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(TP),Oe(WG,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),X9e=(()=>{var r;class e extends S6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=bP(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,o,s){let a=this.prepareExternalUrl(o+$3(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,o,s){let a=this.prepareExternalUrl(o+$3(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(TP),Oe(WG,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),wP=(()=>{var r;class e{constructor(n){this._subject=new _1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function ehe(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(UG(jG(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+$3(i))}normalize(n){return e.stripTrailingSlash(function J9e(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,jG(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",o=null){this._locationStrategy.pushState(o,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+$3(i)),o)}replaceState(n,i="",o=null){this._locationStrategy.replaceState(o,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+$3(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(o=>o(n,i))}subscribe(n,i,o){return this._subject.subscribe({next:n,error:i,complete:o})}}return(r=e).normalizeQueryParams=$3,r.joinWithSlash=bP,r.stripTrailingSlash=UG,r.\u0275fac=function(n){return new(n||r)(Oe(S6))},r.\u0275prov=De({token:r,factory:function(){return function Q9e(){return new wP(Oe(S6))}()},providedIn:"root"}),e})();function jG(r){return r.replace(/\/index.html$/,"")}var pp=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(pp||{}),ps=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(ps||{}),y1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(y1||{}),P2=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(P2||{}),Vr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Vr||{});function mp(r,e){return na(hs(r)[w1.DateFormat],e)}function _p(r,e){return na(hs(r)[w1.TimeFormat],e)}function vp(r,e){return na(hs(r)[w1.DateTimeFormat],e)}function ta(r,e){const t=hs(r),n=t[w1.NumberSymbols][e];if(typeof n>"u"){if(e===Vr.CurrencyDecimal)return t[w1.NumberSymbols][Vr.Decimal];if(e===Vr.CurrencyGroup)return t[w1.NumberSymbols][Vr.Group]}return n}function YG(r){if(!r[w1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[w1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function na(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function AP(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const ghe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,sf={},phe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var G3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(G3||{}),Xn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Xn||{}),Qn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Qn||{});function KG(r,e,t,n){let i=function She(r){if(JG(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,o=1,s=1]=r.split("-").map(a=>+a);return Cp(i,o-1,s)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(ghe))return function Ohe(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,o=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const s=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return o.call(e,s,a,c,l),e}(n)}const e=new Date(r);if(!JG(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=B3(t,e)||e;let a,s=[];for(;e;){if(a=phe.exec(e),!a){s.push(e);break}{s=s.concat(a.slice(1));const f=s.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=QG(n,c),i=function Phe(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function Ehe(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(QG(e,i)-i))}(i,n,!0));let l="";return s.forEach(f=>{const d=function Mhe(r){if(kP[r])return kP[r];let e;switch(r){case"G":case"GG":case"GGG":e=N1(Qn.Eras,y1.Abbreviated);break;case"GGGG":e=N1(Qn.Eras,y1.Wide);break;case"GGGGG":e=N1(Qn.Eras,y1.Narrow);break;case"y":e=ri(Xn.FullYear,1,0,!1,!0);break;case"yy":e=ri(Xn.FullYear,2,0,!0,!0);break;case"yyy":e=ri(Xn.FullYear,3,0,!1,!0);break;case"yyyy":e=ri(Xn.FullYear,4,0,!1,!0);break;case"Y":e=Pp(1);break;case"YY":e=Pp(2,!0);break;case"YYY":e=Pp(3);break;case"YYYY":e=Pp(4);break;case"M":case"L":e=ri(Xn.Month,1,1);break;case"MM":case"LL":e=ri(Xn.Month,2,1);break;case"MMM":e=N1(Qn.Months,y1.Abbreviated);break;case"MMMM":e=N1(Qn.Months,y1.Wide);break;case"MMMMM":e=N1(Qn.Months,y1.Narrow);break;case"LLL":e=N1(Qn.Months,y1.Abbreviated,ps.Standalone);break;case"LLLL":e=N1(Qn.Months,y1.Wide,ps.Standalone);break;case"LLLLL":e=N1(Qn.Months,y1.Narrow,ps.Standalone);break;case"w":e=IP(1);break;case"ww":e=IP(2);break;case"W":e=IP(1,!0);break;case"d":e=ri(Xn.Date,1);break;case"dd":e=ri(Xn.Date,2);break;case"c":case"cc":e=ri(Xn.Day,1);break;case"ccc":e=N1(Qn.Days,y1.Abbreviated,ps.Standalone);break;case"cccc":e=N1(Qn.Days,y1.Wide,ps.Standalone);break;case"ccccc":e=N1(Qn.Days,y1.Narrow,ps.Standalone);break;case"cccccc":e=N1(Qn.Days,y1.Short,ps.Standalone);break;case"E":case"EE":case"EEE":e=N1(Qn.Days,y1.Abbreviated);break;case"EEEE":e=N1(Qn.Days,y1.Wide);break;case"EEEEE":e=N1(Qn.Days,y1.Narrow);break;case"EEEEEE":e=N1(Qn.Days,y1.Short);break;case"a":case"aa":case"aaa":e=N1(Qn.DayPeriods,y1.Abbreviated);break;case"aaaa":e=N1(Qn.DayPeriods,y1.Wide);break;case"aaaaa":e=N1(Qn.DayPeriods,y1.Narrow);break;case"b":case"bb":case"bbb":e=N1(Qn.DayPeriods,y1.Abbreviated,ps.Standalone,!0);break;case"bbbb":e=N1(Qn.DayPeriods,y1.Wide,ps.Standalone,!0);break;case"bbbbb":e=N1(Qn.DayPeriods,y1.Narrow,ps.Standalone,!0);break;case"B":case"BB":case"BBB":e=N1(Qn.DayPeriods,y1.Abbreviated,ps.Format,!0);break;case"BBBB":e=N1(Qn.DayPeriods,y1.Wide,ps.Format,!0);break;case"BBBBB":e=N1(Qn.DayPeriods,y1.Narrow,ps.Format,!0);break;case"h":e=ri(Xn.Hours,1,-12);break;case"hh":e=ri(Xn.Hours,2,-12);break;case"H":e=ri(Xn.Hours,1);break;case"HH":e=ri(Xn.Hours,2);break;case"m":e=ri(Xn.Minutes,1);break;case"mm":e=ri(Xn.Minutes,2);break;case"s":e=ri(Xn.Seconds,1);break;case"ss":e=ri(Xn.Seconds,2);break;case"S":e=ri(Xn.FractionalSeconds,1);break;case"SS":e=ri(Xn.FractionalSeconds,2);break;case"SSS":e=ri(Xn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Mp(G3.Short);break;case"ZZZZZ":e=Mp(G3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Mp(G3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Mp(G3.Long);break;default:return null}return kP[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Cp(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function B3(r,e){const t=function nhe(r){return hs(r)[w1.LocaleId]}(r);if(sf[t]=sf[t]||{},sf[t][e])return sf[t][e];let n="";switch(e){case"shortDate":n=mp(r,P2.Short);break;case"mediumDate":n=mp(r,P2.Medium);break;case"longDate":n=mp(r,P2.Long);break;case"fullDate":n=mp(r,P2.Full);break;case"shortTime":n=_p(r,P2.Short);break;case"mediumTime":n=_p(r,P2.Medium);break;case"longTime":n=_p(r,P2.Long);break;case"fullTime":n=_p(r,P2.Full);break;case"short":const i=B3(r,"shortTime"),o=B3(r,"shortDate");n=yp(vp(r,P2.Short),[i,o]);break;case"medium":const s=B3(r,"mediumTime"),a=B3(r,"mediumDate");n=yp(vp(r,P2.Medium),[s,a]);break;case"long":const c=B3(r,"longTime"),l=B3(r,"longDate");n=yp(vp(r,P2.Long),[c,l]);break;case"full":const f=B3(r,"fullTime"),d=B3(r,"fullDate");n=yp(vp(r,P2.Full),[f,d])}return n&&(sf[t][e]=n),n}function yp(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function Da(r,e,t="-",n,i){let o="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,o=t));let s=String(r);for(;s.length<e;)s="0"+s;return n&&(s=s.slice(s.length-e)),o+s}function ri(r,e,t=0,n=!1,i=!1){return function(o,s){let a=function _he(r,e){switch(r){case Xn.FullYear:return e.getFullYear();case Xn.Month:return e.getMonth();case Xn.Date:return e.getDate();case Xn.Hours:return e.getHours();case Xn.Minutes:return e.getMinutes();case Xn.Seconds:return e.getSeconds();case Xn.FractionalSeconds:return e.getMilliseconds();case Xn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,o);if((t>0||a>-t)&&(a+=t),r===Xn.Hours)0===a&&-12===t&&(a=12);else if(r===Xn.FractionalSeconds)return function mhe(r,e){return Da(r,3).substring(0,e)}(a,e);const c=ta(s,Vr.MinusSign);return Da(a,e,c,n,i)}}function N1(r,e,t=ps.Format,n=!1){return function(i,o){return function vhe(r,e,t,n,i,o){switch(t){case Qn.Months:return function ohe(r,e,t){const n=hs(r),o=na([n[w1.MonthsFormat],n[w1.MonthsStandalone]],e);return na(o,t)}(e,i,n)[r.getMonth()];case Qn.Days:return function ihe(r,e,t){const n=hs(r),o=na([n[w1.DaysFormat],n[w1.DaysStandalone]],e);return na(o,t)}(e,i,n)[r.getDay()];case Qn.DayPeriods:const s=r.getHours(),a=r.getMinutes();if(o){const l=function lhe(r){const e=hs(r);return YG(e),(e[w1.ExtraData][2]||[]).map(n=>"string"==typeof n?AP(n):[AP(n[0]),AP(n[1])])}(e),f=function uhe(r,e,t){const n=hs(r);YG(n);const o=na([n[w1.ExtraData][0],n[w1.ExtraData][1]],e)||[];return na(o,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[E,T]=m,L=s>=E.hours&&a>=E.minutes,z=s<T.hours||s===T.hours&&a<T.minutes;if(E.hours<T.hours){if(L&&z)return!0}else if(L||z)return!0}else if(m.hours===s&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function rhe(r,e,t){const n=hs(r),o=na([n[w1.DayPeriodsFormat],n[w1.DayPeriodsStandalone]],e);return na(o,t)}(e,i,n)[s<12?0:1];case Qn.Eras:return function she(r,e){return na(hs(r)[w1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,o,r,e,t,n)}}function Mp(r){return function(e,t,n){const i=-1*n,o=ta(t,Vr.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case G3.Short:return(i>=0?"+":"")+Da(s,2,o)+Da(Math.abs(i%60),2,o);case G3.ShortGMT:return"GMT"+(i>=0?"+":"")+Da(s,1,o);case G3.Long:return"GMT"+(i>=0?"+":"")+Da(s,2,o)+":"+Da(Math.abs(i%60),2,o);case G3.Extended:return 0===n?"Z":(i>=0?"+":"")+Da(s,2,o)+":"+Da(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${r}"`)}}}const Che=0,Ep=4;function XG(r){return Cp(r.getFullYear(),r.getMonth(),r.getDate()+(Ep-r.getDay()))}function IP(r,e=!1){return function(t,n){let i;if(e){const o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{const o=XG(t),s=function yhe(r){const e=Cp(r,Che,1).getDay();return Cp(r,0,1+(e<=Ep?Ep:Ep+7)-e)}(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return Da(i,r,ta(n,Vr.MinusSign))}}function Pp(r,e=!1){return function(t,n){return Da(XG(t).getFullYear(),r,ta(n,Vr.MinusSign),e)}}const kP={};function QG(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function JG(r){return r instanceof Date&&!isNaN(r.valueOf())}const The=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function zP(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function rB(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,o]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}const HP=/\s+/,iB=[];let Lt=(()=>{var r;class e{constructor(n,i,o,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=o,this._renderer=s,this.initialClasses=iB,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(HP):iB}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(HP):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const o=this.stateMap.get(n);void 0!==o?(o.enabled!==i&&(o.changed=!0,o.enabled=i),o.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],o=n[1];o.changed?(this._toggleClass(i,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),o.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(HP).forEach(o=>{i?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}}return(r=e).\u0275fac=function(n){return new(n||r)(U(hp),U(rf),U(Vo),U(Oc))},r.\u0275dir=zt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class Vhe{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Dt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,o){this._viewContainer=n,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((o,s,a)=>{if(null==o.previousIndex)i.createEmbeddedView(this._template,new Vhe(o.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===s?void 0:s);else if(null!==s){const c=i.get(s);i.move(c,a),sB(c,o)}});for(let o=0,s=i.length;o<s;o++){const c=i.get(o).context;c.index=o,c.count=s,c.ngForOf=this._ngForOf}n.forEachIdentityChange(o=>{sB(i.get(o.currentIndex),o)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(U(E2),U(V3),U(hp))},r.\u0275dir=zt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function sB(r,e){r.context.$implicit=e.item}let Tt=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new Fhe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){aB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){aB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(U(E2),U(V3))},r.\u0275dir=zt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class Fhe{constructor(){this.$implicit=null,this.ngIf=null}}function aB(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${di(e)}'.`)}let uB=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,o){if(!function $P(r){return!(null==r||""===r||r!=r)}(n))return null;o=o||this._locale;try{return function khe(r,e,t){return function LP(r,e,t,n,i,o,s=!1){let a="",c=!1;if(isFinite(r)){let l=function Lhe(r){let n,i,o,s,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;"0"===e.charAt(o);o++);if(o===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=o,n=[],s=0;o<=a;o++,s++)n[s]=Number(e.charAt(o))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);s&&(l=function xhe(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(o){const B=o.match(The);if(null===B)throw new Error(`${o} is not a valid digit info`);const de=B[1],ye=B[3],Le=B[5];null!=de&&(f=zP(de)),null!=ye&&(d=zP(ye)),null!=Le?m=zP(Le):null!=ye&&d>m&&(m=d)}!function Rhe(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const o=Math.min(Math.max(e,i),t);let s=o+r.integerLen,a=n[s];if(s>0){n.splice(Math.max(r.integerLen,s));for(let d=s;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,s=o+1),n[0]=0;for(let d=1;d<s;d++)n[d]=0}if(a>=5)if(s-1<0){for(let d=0;d>s;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[s-1]++;for(;i<Math.max(0,o);i++)n.push(0);let c=0!==o;const l=e+r.integerLen,f=n.reduceRight(function(d,m,E,T){return T[E]=(m+=d)<10?m:m-10,c&&(0===T[E]&&E>=l?T.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let E=l.digits,T=l.integerLen;const L=l.exponent;let z=[];for(c=E.every(B=>!B);T<f;T++)E.unshift(0);for(;T<0;T++)E.unshift(0);T>0?z=E.splice(T,E.length):(z=E,E=[0]);const G=[];for(E.length>=e.lgSize&&G.unshift(E.splice(-e.lgSize,E.length).join(""));E.length>e.gSize;)G.unshift(E.splice(-e.gSize,E.length).join(""));E.length&&G.unshift(E.join("")),a=G.join(ta(t,n)),z.length&&(a+=ta(t,i)+z.join("")),L&&(a+=ta(t,Vr.Exponential)+"+"+L)}else a=ta(t,Vr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function RP(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],o=n[1],s=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const f=i.length-t.posPre.length-t.posSuf.length,d=o.indexOf("#");t.negPre=o.substring(0,d).replace(/'/g,""),t.negSuf=o.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function NP(r,e){return hs(r)[w1.NumberFormats][e]}(e,pp.Decimal),ta(e,Vr.MinusSign)),e,Vr.Group,Vr.Decimal,t)}(function GP(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),o,i)}catch(s){throw function Ha(r,e){return new pe(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(U(kc,16))},r.\u0275pipe=Ro({name:"number",type:r,pure:!0,standalone:!0}),e})();let uge=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({}),e})();function dB(r){return"server"===r}let gge=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new pge(Oe(ki),window)}),e})();class pge{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function mge(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],i-o[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class hB{}class Vge extends Z9e{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class WP extends Vge{static makeCurrent(){!function j9e(r){OP||(OP=r)}(new WP)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Fge(){return lf=lf||document.querySelector("base"),lf?lf.getAttribute("href"):null}();return null==t?null:function $ge(r){bp=bp||document.createElement("a"),bp.setAttribute("href",r);const e=bp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){lf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return rB(document.cookie,e)}}let bp,lf=null,Bge=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const qP=new et("EventManagerPlugins");let vB=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,o){return this._findPluginFor(i).addEventListener(n,i,o)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new pe(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(qP),Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class CB{constructor(e){this._doc=e}}const jP="ng-app-id";let yB=(()=>{var r;class e{constructor(n,i,o,s={}){this.doc=n,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=dB(s),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(o=>o.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${jP}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(o=>{null!=o.textContent&&i.set(o.textContent,o)}),i}return null}changeUsageCount(n,i){const o=this.styleRef;if(o.has(n)){const s=o.get(n);return s.usage+=i,s.usage}return o.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===n)return o.delete(i),s.removeAttribute(jP),s;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(jP,this.appId),a}}addStyleToHost(n,i){const o=this.getStyleElement(n,i);n.appendChild(o);const s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki),Oe(Ig),Oe(zH,8),Oe(z3))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const ZP={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},YP=/%COMP%/g,jge=new et("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function EB(r,e){return e.map(t=>t.replace(YP,r))}let KP=(()=>{var r;class e{constructor(n,i,o,s,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=dB(c),this.defaultRenderer=new XP(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===X2.ShadowDom&&(i={...i,encapsulation:X2.Emulated});const o=this.getOrCreateRenderer(n,i);return o instanceof SB?o.applyToHost(n):o instanceof QP&&o.applyStyles(),o}getOrCreateRenderer(n,i){const o=this.rendererByCompId;let s=o.get(i.id);if(!s){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case X2.Emulated:s=new SB(l,f,i,this.appId,d,a,c,m);break;case X2.ShadowDom:return new Xge(l,f,n,i,a,c,this.nonce,m);default:s=new QP(l,f,i,d,a,c,m)}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(vB),Oe(yB),Oe(Ig),Oe(jge),Oe(ki),Oe(z3),Oe(u1),Oe(zH))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class XP{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ZP[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(PB(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(PB(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new pe(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const o=ZP[i];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=ZP[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(W4.DashCase|W4.Important)?e.style.setProperty(t,n,i&W4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&W4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=Z4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function PB(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class Xge extends XP{constructor(e,t,n,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=EB(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class QP extends XP{constructor(e,t,n,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?EB(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class SB extends QP{constructor(e,t,n,i,o,s,a,c){const l=i+"-"+n.id;super(e,t,n,o,s,a,c,l),this.contentAttr=function Zge(r){return"_ngcontent-%COMP%".replace(YP,r)}(l),this.hostAttr=function Yge(r){return"_nghost-%COMP%".replace(YP,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let Qge=(()=>{var r;class e extends CB{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,o){return n.addEventListener(i,o,!1),()=>this.removeEventListener(n,i,o)}removeEventListener(n,i,o){return n.removeEventListener(i,o)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const OB=["alt","control","meta","shift"],Jge={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},epe={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let tpe=(()=>{var r;class e extends CB{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,o){const s=e.parseEventName(i),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Z4().onAndCancel(n,s.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),o=i.shift();if(0===i.length||"keydown"!==o&&"keyup"!==o)return null;const s=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),OB.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=o,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let o=Jge[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(o=n.code,s="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),OB.forEach(a=>{a!==o&&(0,epe[a])(n)&&(s+=a+".")}),s+=o,s===i)}static eventCallback(n,i,o){return s=>{e.matchEventFullKeyCode(s,n)&&o.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const bB=[{provide:z3,useValue:"browser"},{provide:LH,useValue:function npe(){WP.makeCurrent()},multi:!0},{provide:ki,useFactory:function ipe(){return function Z0e(r){FM=r}(document),document},deps:[]}],ope=CG(x9e,"browser",bB),spe=new et(""),wB=[{provide:lp,useClass:class Gge{addToWindow(e){C1.getAngularTestability=(n,i=!0)=>{const o=e.findTestabilityInTree(n,i);if(null==o)throw new pe(5103,!1);return o},C1.getAllAngularTestabilities=()=>e.getAllTestabilities(),C1.getAllAngularRootElements=()=>e.getAllRootElements(),C1.frameworkStabilizers||(C1.frameworkStabilizers=[]),C1.frameworkStabilizers.push(n=>{const i=C1.getAllAngularTestabilities();let o=i.length,s=!1;const a=function(c){s=s||c,o--,0==o&&n(s)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Z4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:gG,useClass:gP,deps:[u1,pP,lp]},{provide:gP,useClass:gP,deps:[u1,pP,lp]}],NB=[{provide:YM,useValue:"root"},{provide:_6,useFactory:function rpe(){return new _6},deps:[]},{provide:qP,useClass:Qge,multi:!0,deps:[ki,u1,z3]},{provide:qP,useClass:tpe,multi:!0,deps:[ki]},KP,yB,vB,{provide:z7,useExisting:KP},{provide:hB,useClass:Bge,deps:[]},[]];let AB=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:Ig,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(spe,12))},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:[...NB,...wB],imports:[uge,L9e]}),e})(),IB=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function cpe(){return new IB(Oe(ki))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let LB=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new(n||r):Oe(RB),i},providedIn:"root"}),e})(),RB=(()=>{var r;class e extends LB{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case J2.NONE:return i;case J2.HTML:return Sc(i,"HTML")?C2(i):SH(this._doc,String(i)).toString();case J2.STYLE:return Sc(i,"Style")?C2(i):i;case J2.SCRIPT:if(Sc(i,"Script"))return C2(i);throw new pe(5200,!1);case J2.URL:return Sc(i,"URL")?C2(i):Sg(String(i));case J2.RESOURCE_URL:if(Sc(i,"ResourceURL"))return C2(i);throw new pe(5201,!1);default:throw new pe(5202,!1)}}bypassSecurityTrustHtml(n){return function t8e(r){return new Y0e(r)}(n)}bypassSecurityTrustStyle(n){return function n8e(r){return new K0e(r)}(n)}bypassSecurityTrustScript(n){return function r8e(r){return new X0e(r)}(n)}bypassSecurityTrustUrl(n){return function i8e(r){return new Q0e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function o8e(r){return new J0e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function dpe(r){return new RB(r.get(ki))}(Oe(lo)),i},providedIn:"root"}),e})();function uf(r){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function gpe(r){var e=function hpe(r,e){if("object"!==uf(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===uf(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:ppe}=Array,{getPrototypeOf:mpe,prototype:_pe,keys:vpe}=Object;function DB(r){if(1===r.length){const e=r[0];if(ppe(e))return{args:e,keys:null};if(function Cpe(r){return r&&"object"==typeof r&&mpe(r)===_pe}(e)){const t=vpe(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:ype}=Array;function HB(r){return Zn(e=>function Mpe(r,e){return ype(e)?r(...e):r(e)}(r,e))}function VB(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let FB=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Oc),U(Vo))},r.\u0275dir=zt({type:r}),e})(),O6=(()=>{var r;class e extends FB{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,features:[Ge]}),e})();const Lc=new et("NgValueAccessor"),Ppe={provide:Lc,useExisting:T1(()=>wp),multi:!0};let wp=(()=>{var r;class e extends O6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[X1([Ppe]),Ge]}),e})();const Spe={provide:Lc,useExisting:T1(()=>Va),multi:!0},Tpe=new et("CompositionEventMode");let Va=(()=>{var r;class e extends FB{constructor(n,i,o){super(n,i),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ope(){const r=Z4()?Z4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Oc),U(Vo),U(Tpe,8))},r.\u0275dir=zt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&q("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[X1([Spe]),Ge]}),e})();function K4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function $B(r){return null!=r&&"number"==typeof r.length}const $o=new et("NgValidators"),X4=new et("NgAsyncValidators"),bpe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ff{static min(e){return function GB(r){return e=>{if(K4(e.value)||K4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function BB(r){return e=>{if(K4(e.value)||K4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return UB(e)}static requiredTrue(e){return WB(e)}static email(e){return function qB(r){return K4(r.value)||bpe.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function jB(r){return e=>K4(e.value)||!$B(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return ZB(e)}static pattern(e){return function YB(r){if(!r)return Np;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(K4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return tU(e)}static composeAsync(e){return nU(e)}}function UB(r){return K4(r.value)?{required:!0}:null}function WB(r){return!0===r.value?null:{required:!0}}function ZB(r){return e=>$B(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function Np(r){return null}function KB(r){return null!=r}function XB(r){return q7(r)?fi(r):r}function QB(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function JB(r,e){return e.map(t=>t(r))}function eU(r){return r.map(e=>function wpe(r){return!r.validate}(e)?e:t=>e.validate(t))}function tU(r){if(!r)return null;const e=r.filter(KB);return 0==e.length?null:function(t){return QB(JB(t,e))}}function eS(r){return null!=r?tU(eU(r)):null}function nU(r){if(!r)return null;const e=r.filter(KB);return 0==e.length?null:function(t){return function Epe(...r){const e=hz(r),{args:t,keys:n}=DB(r),i=new O1(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let f=0;f<s;f++){let d=!1;g2(t[f]).subscribe(pr(o,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||o.next(n?VB(n,a):a),o.complete())}))}});return e?i.pipe(HB(e)):i}(JB(t,e).map(XB)).pipe(Zn(QB))}}function tS(r){return null!=r?nU(eU(r)):null}function rU(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function iU(r){return r._rawValidators}function oU(r){return r._rawAsyncValidators}function nS(r){return r?Array.isArray(r)?r:[r]:[]}function Ap(r,e){return Array.isArray(r)?r.includes(e):r===e}function sU(r,e){const t=nS(e);return nS(r).forEach(i=>{Ap(t,i)||t.push(i)}),t}function aU(r,e){return nS(e).filter(t=>!Ap(r,t))}class cU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=eS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=tS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ms extends cU{get formDirective(){return null}get path(){return null}}class Q4 extends cU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class lU{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Rc=(()=>{var r;class e extends lU{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Q4,2))},r.\u0275dir=zt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Qg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ge]}),e})(),J4=(()=>{var r;class e extends lU{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(ms,10))},r.\u0275dir=zt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&Qg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Ge]}),e})();const df="VALID",kp="INVALID",X8="PENDING",hf="DISABLED";function oS(r){return(xp(r)?r.validators:r)||null}function sS(r,e){return(xp(e)?e.asyncValidators:r)||null}function xp(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function fU(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new pe(1e3,"");if(!n[t])throw new pe(1001,"")}function dU(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new pe(1002,"")})}class Lp{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===df}get invalid(){return this.status===kp}get pending(){return this.status==X8}get disabled(){return this.status===hf}get enabled(){return this.status!==hf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(sU(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(sU(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(aU(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(aU(e,this._rawAsyncValidators))}hasValidator(e){return Ap(this._rawValidators,e)}hasAsyncValidator(e){return Ap(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=X8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=hf,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=df,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===df||this.status===X8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hf:df}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=X8,this._hasOwnPendingAsyncValidator=!0;const t=XB(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new _1,this.statusChanges=new _1}_calculateStatus(){return this._allControlsDisabled()?hf:this.errors?kp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(X8)?X8:this._anyControlsHaveStatus(kp)?kp:df}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){xp(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function kpe(r){return Array.isArray(r)?eS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function xpe(r){return Array.isArray(r)?tS(r):r||null}(this._rawAsyncValidators)}}class zc extends Lp{constructor(e,t,n){super(oS(t),sS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){dU(this,0,e),Object.keys(e).forEach(n=>{fU(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,o)=>{n=t(n,i,o)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class hU extends zc{}const T6=new et("CallSetDisabledState",{providedIn:"root",factory:()=>gf}),gf="always";function Rp(r,e){return[...e.path,r]}function pf(r,e,t=gf){aS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function Rpe(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&gU(r,e)})}(r,e),function Dpe(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function zpe(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&gU(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function Lpe(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function zp(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),Hp(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function Dp(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function aS(r,e){const t=iU(r);null!==e.validator?r.setValidators(rU(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=oU(r);null!==e.asyncValidator?r.setAsyncValidators(rU(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();Dp(e._rawValidators,i),Dp(e._rawAsyncValidators,i)}function Hp(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=iU(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,r.setValidators(o))}}if(null!==e.asyncValidator){const i=oU(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,r.setAsyncValidators(o))}}}const n=()=>{};return Dp(e._rawValidators,n),Dp(e._rawAsyncValidators,n),t}function gU(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function pU(r,e){aS(r,e)}function lS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function mU(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function uS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(o=>{o.constructor===Va?t=o:function Fpe(r){return Object.getPrototypeOf(r.constructor)===O6}(o)?n=o:i=o}),i||n||t||null}const Gpe={provide:ms,useExisting:T1(()=>_f)},mf=(()=>Promise.resolve())();let _f=(()=>{var r;class e extends ms{constructor(n,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new _1,this.form=new zc({},eS(n),tS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){mf.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),pf(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){mf.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){mf.then(()=>{const i=this._findContainer(n.path),o=new zc({});pU(o,n),i.registerControl(n.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){mf.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){mf.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,mU(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(U($o,10),U(X4,10),U(T6,8))},r.\u0275dir=zt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&q("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[X1([Gpe]),Ge]}),e})();function _U(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function vU(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const Ys=class extends Lp{constructor(e=null,t,n){super(oS(t),sS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xp(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=vU(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){_U(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){_U(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){vU(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Wpe={provide:Q4,useExisting:T1(()=>vf)},MU=(()=>Promise.resolve())();let vf=(()=>{var r;class e extends Q4{constructor(n,i,o,s,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new Ys,this._registered=!1,this.name="",this.update=new _1,this._parent=n,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=uS(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),lS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){pf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){MU.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,o=0!==i&&Y8(i);MU.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Rp(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(U(ms,9),U($o,10),U(X4,10),U(Lc,10),U(xc,8),U(T6,8))},r.\u0275dir=zt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[X1([Wpe]),Ge,Do]}),e})(),el=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=zt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})();const qpe={provide:Lc,useExisting:T1(()=>fS),multi:!0};let fS=(()=>{var r;class e extends O6{writeValue(n){this.setProperty("value",n??"")}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,i){1&n&&q("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[X1([qpe]),Ge]}),e})(),EU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({}),e})();const Ype={provide:Lc,useExisting:T1(()=>Vp),multi:!0};let Vp=(()=>{var r;class e extends O6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[X1([Ype]),Ge]}),e})();const dS=new et("NgModelWithFormControlWarning"),Kpe={provide:Q4,useExisting:T1(()=>hS)};let hS=(()=>{var r;class e extends Q4{set isDisabled(n){}constructor(n,i,o,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this.update=new _1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=uS(0,o)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&zp(i,this,!1),pf(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}lS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&zp(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(U($o,10),U(X4,10),U(Lc,10),U(dS,8),U(T6,8))},r.\u0275dir=zt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[X1([Kpe]),Ge,Do]}),e})();const Xpe={provide:ms,useExisting:T1(()=>tl)};let tl=(()=>{var r;class e extends ms{constructor(n,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new _1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Hp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return pf(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){zp(n.control||null,n,!1),function $pe(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,mU(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,o=this.form.get(n.path);i!==o&&(zp(i||null,n),(r=>r instanceof Ys)(o)&&(pf(o,n,this.callSetDisabledState),n.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);pU(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Hpe(r,e){return Hp(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){aS(this.form,this),this._oldForm&&Hp(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(U($o,10),U(X4,10),U(T6,8))},r.\u0275dir=zt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&q("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[X1([Xpe]),Ge,Do]}),e})();const eme={provide:Q4,useExisting:T1(()=>b6)};let b6=(()=>{var r;class e extends Q4{set isDisabled(n){}constructor(n,i,o,s,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new _1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=uS(0,s)}ngOnChanges(n){this._added||this._setUpControl(),lS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return Rp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(U(ms,13),U($o,10),U(X4,10),U(Lc,10),U(dS,8))},r.\u0275dir=zt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[X1([eme]),Ge,Do]}),e})();const tme={provide:Lc,useExisting:T1(()=>Fp),multi:!0};function OU(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let Fp=(()=>{var r;class e extends O6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const o=OU(this._getOptionId(n),n);this.setProperty("value",o)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function nme(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[X1([tme]),Ge]}),e})(),Q8=(()=>{var r;class e{constructor(n,i,o){this._element=n,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(OU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Vo),U(Oc),U(Fp,9))},r.\u0275dir=zt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const rme={provide:Lc,useExisting:T1(()=>mS),multi:!0};function TU(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let mS=(()=>{var r;class e extends O6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const o=n.map(s=>this._getOptionId(s));i=(s,a)=>{s._setSelected(o.indexOf(a.toString())>-1)}}else i=(o,s)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const o=[],s=i.selectedOptions;if(void 0!==s){const a=s;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);o.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);o.push(f)}}}this.value=o,n(o)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function ime(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[X1([rme]),Ge]}),e})(),J8=(()=>{var r;class e{constructor(n,i,o){this._element=n,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(TU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(TU(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Vo),U(Oc),U(mS,9))},r.\u0275dir=zt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let w6=(()=>{var r;class e{constructor(){this._validator=Np}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Np,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=zt({type:r,features:[Do]}),e})();const ame={provide:$o,useExisting:T1(()=>nl),multi:!0},cme={provide:$o,useExisting:T1(()=>_S),multi:!0};let nl=(()=>{var r;class e extends w6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Y8,this.createValidator=n=>UB}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&A("required",i._enabled?"":null)},inputs:{required:"required"},features:[X1([ame]),Ge]}),e})(),_S=(()=>{var r;class e extends nl{constructor(){super(...arguments),this.createValidator=n=>WB}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&A("required",i._enabled?"":null)},features:[X1([cme]),Ge]}),e})();const fme={provide:$o,useExisting:T1(()=>vS),multi:!0};let vS=(()=>{var r;class e extends w6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function bU(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>ZB(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275dir=zt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&A("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[X1([fme]),Ge]}),e})(),LU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({imports:[EU]}),e})();class RU extends Lp{constructor(e,t,n){super(oS(t),sS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){dU(this,0,e),e.forEach((n,i)=>{fU(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function zU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let hme=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const o=this._reduceControls(n);let s={};return zU(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new zc(o,s)}record(n,i=null){const o=this._reduceControls(n);return new hU(o,i)}control(n,i,o){let s={};return this.useNonNullable?(zU(i)?s=i:(s.validators=i,s.asyncValidators=o),new Ys(n,{...s,nonNullable:!0})):new Ys(n,i,o)}array(n,i,o){const s=n.map(a=>this._createControl(a));return new RU(s,i,o)}_reduceControls(n){const i={};return Object.keys(n).forEach(o=>{i[o]=this._createControl(n[o])}),i}_createControl(n){return n instanceof Ys||n instanceof Lp?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),gme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:T6,useValue:n.callSetDisabledState??gf}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({imports:[LU]}),e})(),pme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:dS,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:T6,useValue:n.callSetDisabledState??gf}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({imports:[LU]}),e})();function e5(r,e){return Sn(e)?io(r,e,1):io(r,1)}function U3(r,e){return ei((t,n)=>{let i=0;t.subscribe(pr(n,o=>r.call(e,o,i++)&&n.next(o)))})}function Cf(r){return ei((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class $p{}class Gp{}class Dc{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),o=i.toLowerCase(),s=t.slice(n+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Dc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Dc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Dc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const o=e.value;if(o){let s=this.headers.get(t);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class mme{encodeKey(e){return DU(e)}encodeValue(e){return DU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const vme=/%(\d[a-f0-9])/gi,Cme={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function DU(r){return encodeURIComponent(r).replace(vme,(e,t)=>Cme[t]??e)}function Bp(r){return`${r}`}class rl{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new mme,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _me(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,a]=-1==o?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(Bp):[Bp(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(o=>{t.push({param:n,value:o,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new rl({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Bp(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(Bp(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class yme{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function HU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function VU(r){return typeof Blob<"u"&&r instanceof Blob}function FU(r){return typeof FormData<"u"&&r instanceof FormData}class yf{constructor(e,t,n,i){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Mme(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,o=i):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new Dc),this.context||(this.context=new yme),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+s}}else this.params=new rl,this.urlWithParams=t}serializeBody(){return null===this.body?null:HU(this.body)||VU(this.body)||FU(this.body)||function Eme(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof rl?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||FU(this.body)?null:VU(this.body)?this.body.type||null:HU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof rl?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new yf(t,n,o,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:s})}}var t5=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(t5||{});class CS{constructor(e,t=200,n="OK"){this.headers=e.headers||new Dc,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class yS extends CS{constructor(e={}){super(e),this.type=t5.ResponseHeader}clone(e={}){return new yS({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class n5 extends CS{constructor(e={}){super(e),this.type=t5.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new n5({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class $U extends CS{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function MS(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let Pme=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,o={}){let s;if(n instanceof yf)s=n;else{let l,f;l=o.headers instanceof Dc?o.headers:new Dc(o.headers),o.params&&(f=o.params instanceof rl?o.params:new rl({fromObject:o.params})),s=new yf(n,i,void 0!==o.body?o.body:null,{headers:l,context:o.context,params:f,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const a=$t(s).pipe(e5(l=>this.handler.handle(l)));if(n instanceof yf||"events"===o.observe)return a;const c=a.pipe(U3(l=>l instanceof n5));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(Zn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Zn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Zn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(Zn(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new rl).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,o={}){return this.request("PATCH",n,MS(o,i))}post(n,i,o={}){return this.request("POST",n,MS(o,i))}put(n,i,o={}){return this.request("PUT",n,MS(o,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe($p))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function UU(r,e){return e(r)}function Ome(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const bme=new et(""),Mf=new et(""),WU=new et("");function wme(){let r=null;return(e,t)=>{null===r&&(r=(nt(bme,{optional:!0})??[]).reduceRight(Ome,UU));const n=nt(ap),i=n.add();return r(e,t).pipe(Cf(()=>n.remove(i)))}}let qU=(()=>{var r;class e extends $p{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=nt(ap)}handle(n){if(null===this.chain){const o=Array.from(new Set([...this.injector.get(Mf),...this.injector.get(WU,[])]));this.chain=o.reduceRight((s,a)=>function Tme(r,e,t){return(n,i)=>t.runInContext(()=>e(n,o=>r(o,i)))}(s,a,this.injector),UU)}const i=this.pendingTasks.add();return this.chain(n,o=>this.backend.handle(o)).pipe(Cf(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(Gp),Oe(y2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const kme=/^\)\]\}',?\n/;let ZU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new pe(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?fi(i.\u0275loadImpl()):$t(null)).pipe(Na(()=>new O1(s=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,G)=>a.setRequestHeader(z,G.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",G=new Dc(a.getAllResponseHeaders()),B=function xme(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new yS({headers:G,status:a.status,statusText:z,url:B}),l},d=()=>{let{headers:z,status:G,statusText:B,url:de}=f(),ye=null;204!==G&&(ye=typeof a.response>"u"?a.responseText:a.response),0===G&&(G=ye?200:0);let Le=G>=200&&G<300;if("json"===n.responseType&&"string"==typeof ye){const tt=ye;ye=ye.replace(kme,"");try{ye=""!==ye?JSON.parse(ye):null}catch(gt){ye=tt,Le&&(Le=!1,ye={error:gt,text:ye})}}Le?(s.next(new n5({body:ye,headers:z,status:G,statusText:B,url:de||void 0})),s.complete()):s.error(new $U({error:ye,headers:z,status:G,statusText:B,url:de||void 0}))},m=z=>{const{url:G}=f(),B=new $U({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:G||void 0});s.error(B)};let E=!1;const T=z=>{E||(s.next(f()),E=!0);let G={type:t5.DownloadProgress,loaded:z.loaded};z.lengthComputable&&(G.total=z.total),"text"===n.responseType&&a.responseText&&(G.partialText=a.responseText),s.next(G)},L=z=>{let G={type:t5.UploadProgress,loaded:z.loaded};z.lengthComputable&&(G.total=z.total),s.next(G)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",T),null!==c&&a.upload&&a.upload.addEventListener("progress",L)),a.send(c),s.next({type:t5.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",T),null!==c&&a.upload&&a.upload.removeEventListener("progress",L)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(hB))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const ES=new et("XSRF_ENABLED"),YU=new et("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),KU=new et("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class XU{}let zme=(()=>{var r;class e{constructor(n,i,o){this.doc=n,this.platform=i,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=rB(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki),Oe(z3),Oe(YU))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function Dme(r,e){const t=r.url.toLowerCase();if(!nt(ES)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=nt(XU).getToken(),i=nt(KU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var il=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(il||{});function N6(r,e){return{\u0275kind:r,\u0275providers:e}}function Hme(...r){const e=[Pme,ZU,qU,{provide:$p,useExisting:qU},{provide:Gp,useExisting:ZU},{provide:Mf,useValue:Dme,multi:!0},{provide:ES,useValue:!0},{provide:XU,useClass:zme}];for(const t of r)e.push(...t.\u0275providers);return function qM(r){return{\u0275providers:r}}(e)}const QU=new et("LEGACY_INTERCEPTOR_FN");let Fme=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:[Hme(N6(il.LegacyInterceptors,[{provide:QU,useFactory:wme},{provide:Mf,useExisting:QU,multi:!0}]))]}),e})();function PS(...r){const e=a7(r),t=hz(r),{args:n,keys:i}=DB(r);if(0===n.length)return fi([],e);const o=new O1(function jme(r,e,t=pc){return n=>{JU(e,()=>{const{length:i}=r,o=new Array(i);let s=i,a=i;for(let c=0;c<i;c++)JU(e,()=>{const l=fi(r[c],e);let f=!1;l.subscribe(pr(n,d=>{o[c]=d,f||(f=!0,a--),a||n.next(t(o.slice()))},()=>{--s||n.complete()}))},n)},n)}}(n,e,i?s=>VB(i,s):pc));return t?o.pipe(HB(t)):o}function JU(r,e,t){r?N3(t,r,e):e()}const Wp=Z2(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function SS(...r){return function Zme(){return r8(1)}()(fi(r,a7(r)))}function eW(r){return new O1(e=>{g2(r()).subscribe(e)})}function Ef(r,e){const t=Sn(r)?r:()=>r,n=i=>i.error(t());return new O1(e?i=>e.schedule(n,0,i):n)}function OS(){return ei((r,e)=>{let t=null;r._refCount++;const n=pr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class tW extends O1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ah(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new On;const t=this.getSubject();e.add(this.source.subscribe(pr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=On.EMPTY)}return e}refCount(){return OS()(this)}}function r5(r){return r<=0?()=>mc:ei((e,t)=>{let n=0;e.subscribe(pr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function qp(r){return ei((e,t)=>{let n=!1;e.subscribe(pr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function nW(r=Kme){return ei((e,t)=>{let n=!1;e.subscribe(pr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function Kme(){return new Wp}function A6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?U3((i,o)=>r(i,o,n)):pc,r5(1),t?qp(e):nW(()=>new Wp))}function Go(r,e,t){const n=Sn(r)||e||t?{next:r,error:e,complete:t}:r;return n?ei((i,o)=>{var s;null===(s=n.subscribe)||void 0===s||s.call(n);let a=!0;i.subscribe(pr(o,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),o.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),o.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),o.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):pc}function I6(r){return ei((e,t)=>{let o,n=null,i=!1;n=e.subscribe(pr(t,void 0,void 0,s=>{o=g2(r(s,I6(r)(e))),n?(n.unsubscribe(),n=null,o.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,o.subscribe(t))})}function TS(r){return r<=0?()=>mc:ei((e,t)=>{let n=[];e.subscribe(pr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const sn="primary",Pf=Symbol("RouteTitle");class t_e{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function i5(r){return new t_e(r)}function n_e(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let o=0;o<n.length;o++){const s=n[o],a=r[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function Hc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!rW(r[i],e[i]))return!1;return!0}function rW(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,o)=>n[o]===i)}return r===e}function iW(r){return r.length>0?r[r.length-1]:null}function ol(r){return function qme(r){return!!r&&(r instanceof O1||Sn(r.lift)&&Sn(r.subscribe))}(r)?r:q7(r)?fi(Promise.resolve(r)):$t(r)}const i_e={exact:function aW(r,e,t){if(!k6(r.segments,e.segments)||!jp(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!aW(r.children[n],e.children[n],t))return!1;return!0},subset:cW},oW={exact:function o_e(r,e){return Hc(r,e)},subset:function s_e(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>rW(r[t],e[t]))},ignored:()=>!0};function sW(r,e,t){return i_e[t.paths](r.root,e.root,t.matrixParams)&&oW[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function cW(r,e,t){return lW(r,e,e.segments,t)}function lW(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!k6(i,t)||e.hasChildren()||!jp(i,t,n))}if(r.segments.length===t.length){if(!k6(r.segments,t)||!jp(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!cW(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!!(k6(r.segments,i)&&jp(r.segments,i,n)&&r.children[sn])&&lW(r.children[sn],e,o,n)}}function jp(r,e,t){return e.every((n,i)=>oW[t](r[i].parameters,n.parameters))}class o5{constructor(e=new f1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=i5(this.queryParams)),this._queryParamMap}toString(){return l_e.serialize(this)}}class f1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Zp(this)}}class Sf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=i5(this.parameters)),this._parameterMap}toString(){return dW(this)}}function k6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let Of=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new bS},providedIn:"root"}),e})();class bS{parse(e){const t=new y_e(e);return new o5(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Tf(e.root,!0)}`,n=function d_e(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Yp(t)}=${Yp(i)}`).join("&"):`${Yp(t)}=${Yp(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function u_e(r){return encodeURI(r)}(e.fragment)}`:""}`}}const l_e=new bS;function Zp(r){return r.segments.map(e=>dW(e)).join("/")}function Tf(r,e){if(!r.hasChildren())return Zp(r);if(e){const t=r.children[sn]?Tf(r.children[sn],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==sn&&n.push(`${i}:${Tf(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function c_e(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===sn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==sn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===sn?[Tf(r.children[sn],!1)]:[`${i}:${Tf(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[sn]?`${Zp(r)}/${t[0]}`:`${Zp(r)}/(${t.join("//")})`}}function uW(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Yp(r){return uW(r).replace(/%3B/gi,";")}function wS(r){return uW(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Kp(r){return decodeURIComponent(r)}function fW(r){return Kp(r.replace(/\+/g,"%20"))}function dW(r){return`${wS(r.path)}${function f_e(r){return Object.keys(r).map(e=>`;${wS(e)}=${wS(r[e])}`).join("")}(r.parameters)}`}const h_e=/^[^\/()?;#]+/;function NS(r){const e=r.match(h_e);return e?e[0]:""}const g_e=/^[^\/()?;=#]+/,m_e=/^[^=?&#]+/,v_e=/^[^&#]+/;class y_e{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new f1([],{}):new f1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[sn]=new f1(e,t)),n}parseSegment(){const e=NS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new pe(4009,!1);return this.capture(e),new Sf(Kp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function p_e(r){const e=r.match(g_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=NS(this.remaining);i&&(n=i,this.capture(n))}e[Kp(t)]=Kp(n)}parseQueryParam(e){const t=function __e(r){const e=r.match(m_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const s=function C_e(r){const e=r.match(v_e);return e?e[0]:""}(this.remaining);s&&(n=s,this.capture(n))}const i=fW(t),o=fW(n);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=NS(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new pe(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=sn);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[sn]:new f1([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new pe(4011,!1)}}function hW(r){return r.segments.length>0?new f1([],{[sn]:r}):r}function gW(r){const e={};for(const n of Object.keys(r.children)){const o=gW(r.children[n]);if(n===sn&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}return function M_e(r){if(1===r.numberOfChildren&&r.children[sn]){const e=r.children[sn];return new f1(r.segments.concat(e.segments),e.children)}return r}(new f1(r.segments,e))}function x6(r){return r instanceof o5}function pW(r){let e;const i=hW(function t(o){const s={};for(const c of o.children){const l=t(c);s[c.outlet]=l}const a=new f1(o.url,s);return o===r&&(e=a),a}(r.root));return e??i}function mW(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return AS(i,i,i,t,n);const o=function P_e(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new vW(!0,0,r);let e=0,t=!1;const n=r.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new vW(t,e,n)}(e);if(o.toRoot())return AS(i,i,new f1([],{}),t,n);const s=function S_e(r,e,t){if(r.isAbsolute)return new Qp(e,!0,0);if(!t)return new Qp(e,!1,NaN);if(null===t.parent)return new Qp(t,!0,0);const n=Xp(r.commands[0])?0:1;return function O_e(r,e,t){let n=r,i=e,o=t;for(;o>i;){if(o-=i,n=n.parent,!n)throw new pe(4005,!1);i=n.segments.length}return new Qp(n,!1,i-o)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(o,i,r),a=s.processChildren?wf(s.segmentGroup,s.index,o.commands):CW(s.segmentGroup,s.index,o.commands);return AS(i,s.segmentGroup,a,t,n)}function Xp(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function bf(r){return"object"==typeof r&&null!=r&&r.outlets}function AS(r,e,t,n,i){let s,o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),s=r===e?t:_W(r,e,t);const a=hW(gW(s));return new o5(a,o,i)}function _W(r,e,t){const n={};return Object.entries(r.children).forEach(([i,o])=>{n[i]=o===e?t:_W(o,e,t)}),new f1(r.segments,n)}class vW{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Xp(n[0]))throw new pe(4003,!1);const i=n.find(bf);if(i&&i!==iW(n))throw new pe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Qp{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function CW(r,e,t){if(r||(r=new f1([],{})),0===r.segments.length&&r.hasChildren())return wf(r,e,t);const n=function b_e(r,e,t){let n=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return o;const s=r.segments[i],a=t[n];if(bf(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!MW(c,l,s))return o;n+=2}else{if(!MW(c,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const o=new f1(r.segments.slice(0,n.pathIndex),{});return o.children[sn]=new f1(r.segments.slice(n.pathIndex),r.children),wf(o,0,i)}return n.match&&0===i.length?new f1(r.segments,{}):n.match&&!r.hasChildren()?IS(r,e,t):n.match?wf(r,0,i):IS(r,e,t)}function wf(r,e,t){if(0===t.length)return new f1(r.segments,{});{const n=function T_e(r){return bf(r[0])?r[0].outlets:{[sn]:r}}(t),i={};if(!n[sn]&&r.children[sn]&&1===r.numberOfChildren&&0===r.children[sn].segments.length){const o=wf(r.children[sn],e,t);return new f1(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=CW(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{void 0===n[o]&&(i[o]=s)}),new f1(r.segments,i)}}function IS(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const o=t[i];if(bf(o)){const c=w_e(o.outlets);return new f1(n,c)}if(0===i&&Xp(t[0])){n.push(new Sf(r.segments[e].path,yW(t[0]))),i++;continue}const s=bf(o)?o.outlets[sn]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Xp(a)?(n.push(new Sf(s,yW(a))),i+=2):(n.push(new Sf(s,{})),i++)}return new f1(n,{})}function w_e(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=IS(new f1([],{}),0,n))}),e}function yW(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function MW(r,e,t){return r==t.path&&Hc(e,t.parameters)}const Nf="imperative";class Vc{constructor(e,t){this.id=e,this.url=t}}class kS extends Vc{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class sl extends Vc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Jp extends Vc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Af extends Vc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class xS extends Vc{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class N_e extends Vc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class A_e extends Vc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class I_e extends Vc{constructor(e,t,n,i,o){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class k_e extends Vc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class x_e extends Vc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class L_e{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class R_e{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class z_e{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class D_e{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class H_e{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class V_e{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class EW{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class F_e{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new If,this.attachRef=null}}let If=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const o=this.getOrCreateContext(n);o.outlet=i,this.contexts.set(n,o)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new F_e,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class PW{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=LS(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=LS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=RS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return RS(e,this._root).map(t=>t.value)}}function LS(r,e){if(r===e.value)return e;for(const t of e.children){const n=LS(r,t);if(n)return n}return null}function RS(r,e){if(r===e.value)return[e];for(const t of e.children){const n=RS(r,t);if(n.length)return n.unshift(e),n}return[]}class W3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function s5(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class SW extends PW{constructor(e,t){super(e),this.snapshot=t,zS(this,e)}toString(){return this.snapshot.toString()}}function OW(r,e){const t=function $_e(r,e){const s=new em([],{},{},"",{},sn,e,null,{});return new bW("",new W3(s,[]))}(0,e),n=new xo([new Sf("",{})]),i=new xo({}),o=new xo({}),s=new xo({}),a=new xo(""),c=new _s(n,i,s,a,o,sn,e,t.root);return c.snapshot=t.root,new SW(new W3(c,[]),t)}class _s{constructor(e,t,n,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Zn(l=>l[Pf]))??$t(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Zn(e=>i5(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Zn(e=>i5(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function TW(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],o=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(o.component)break;n--}}return function G_e(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class em{get title(){return this.data?.[Pf]}constructor(e,t,n,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=i5(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=i5(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class bW extends PW{constructor(e,t){super(t),this.url=e,zS(this,t)}toString(){return wW(this._root)}}function zS(r,e){e.value._routerState=r,e.children.forEach(t=>zS(r,t))}function wW(r){const e=r.children.length>0?` { ${r.children.map(wW).join(", ")} } `:"";return`${r.value}${e}`}function DS(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Hc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Hc(e.params,t.params)||r.paramsSubject.next(t.params),function r_e(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Hc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),Hc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function HS(r,e){const t=Hc(r.params,e.params)&&function a_e(r,e){return k6(r,e)&&r.every((t,n)=>Hc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||HS(r.parent,e.parent))}let VS=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=sn,this.activateEvents=new _1,this.deactivateEvents=new _1,this.attachEvents=new _1,this.detachEvents=new _1,this.parentContexts=nt(If),this.location=nt(E2),this.changeDetector=nt(xc),this.environmentInjector=nt(y2),this.inputBinder=nt(tm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:o}=n.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new pe(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new pe(4013,!1);this._activatedRoute=n;const o=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new B_e(n,c,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=zt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Do]}),e})();class B_e{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===_s?this.route:e===If?this.childContexts:this.parent.get(e,t)}}const tm=new et("");let NW=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,o=PS([i.queryParams,i.params,i.data]).pipe(Na(([s,a,c],l)=>(c={...s,...a,...c},0===l?$t(c):Promise.resolve(c)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function q9e(r){const e=zn(r);if(!e)return null;const t=new $7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,s[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function kf(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function W_e(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return kf(r,n,i);return kf(r,n)})}(r,e,t);return new W3(n,i)}{if(r.shouldAttach(e.value)){const o=r.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>kf(r,a)),s}}const n=function q_e(r){return new _s(new xo(r.url),new xo(r.params),new xo(r.queryParams),new xo(r.fragment),new xo(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(o=>kf(r,o));return new W3(n,i)}}const FS="ngNavigationCancelingError";function AW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=x6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=IW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function IW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[FS]=!0,n.cancellationCode=e,t&&(n.url=t),n}function kW(r){return xW(r)&&x6(r.url)}function xW(r){return r&&r[FS]}let LW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=Fe({type:r,selectors:[["ng-component"]],standalone:!0,features:[g$],decls:1,vars:0,template:function(n,i){1&n&&V(0,"router-outlet")},dependencies:[VS],encapsulation:2}),e})();function $S(r){const e=r.children&&r.children.map($S),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==sn&&(t.component=LW),t}function Fa(r){return r.outlet||sn}function xf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class J_e{constructor(e,t,n,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),DS(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=s5(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(i===o)if(i.component){const s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=s5(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);if(n&&n.outlet){const s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=s5(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=s5(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new V_e(o.value.snapshot))}),e.children.length&&this.forwardEvent(new D_e(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(DS(i),i===o)if(i.component){const s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),DS(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=xf(i.snapshot);s.attachRef=null,s.route=i,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,n)}}class RW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class nm{constructor(e,t){this.component=e,this.route=t}}function eve(r,e,t){const n=r._root;return Lf(n,e?e._root:null,t,[n.value])}function a5(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function dle(r){return null!==zh(r)}(r)?e.get(r):r:n}function Lf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=s5(e);return r.children.forEach(s=>{(function nve(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=r.value,s=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function rve(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!k6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!k6(r.url,e.url)||!Hc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!HS(r,e)||!Hc(r.queryParams,e.queryParams);default:return!HS(r,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new RW(n)):(o.data=s.data,o._resolvedData=s._resolvedData),Lf(r,e,o.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new nm(a.outlet.component,s))}else s&&Rf(e,a,i),i.canActivateChecks.push(new RW(n)),Lf(r,null,o.component?a?a.children:null:t,n,i)})(s,o[s.value.outlet],t,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Rf(a,t.getContext(s),i)),i}function Rf(r,e,t){const n=s5(r),i=r.value;Object.entries(n).forEach(([o,s])=>{Rf(s,i.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new nm(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function zf(r){return"function"==typeof r}function zW(r){return r instanceof Wp||"EmptyError"===r?.name}const rm=Symbol("INITIAL_VALUE");function c5(){return Na(r=>PS(r.map(e=>e.pipe(r5(1),function Yme(...r){const e=a7(r);return ei((t,n)=>{(e?SS(r,t,e):SS(r,t)).subscribe(n)})}(rm)))).pipe(Zn(e=>{for(const t of e)if(!0!==t){if(t===rm)return rm;if(!1===t||t instanceof o5)return t}return!0}),U3(e=>e!==rm),r5(1)))}function DW(r){return function Th(...r){return bh(r)}(Go(e=>{if(x6(e))throw AW(0,e)}),Zn(e=>!0===e))}class im{constructor(e){this.segmentGroup=e||null}}class HW{constructor(e){this.urlTree=e}}function l5(r){return Ef(new im(r))}function VW(r){return Ef(new HW(r))}class Pve{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new pe(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return $t(n);if(i.numberOfChildren>1||!i.children[sn])return Ef(new pe(4e3,!1));i=i.children[sn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const o=this.createSegmentGroup(e,t.root,n,i);return new o5(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);n[i]=t[a]}else n[i]=o}),n}createSegmentGroup(e,t,n,i){const o=this.createSegments(e,t.segments,n,i);let s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,n,i)}),new f1(o,s)}createSegments(e,t,n,i){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new pe(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const GS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Sve(r,e,t,n,i){const o=BS(r,e,t);return o.matched?(n=function j_e(r,e){return r.providers&&!r._injector&&(r._injector=jE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function yve(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?$t(i.map(s=>{const a=a5(s,r);return ol(function lve(r){return r&&zf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe(c5(),DW()):$t(!0)}(n,e,t).pipe(Zn(s=>!0===s?o:{...GS}))):$t(o)}function BS(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...GS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||n_e)(t,r,e);if(!i)return{...GS};const o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function FW(r,e,t,n){return t.length>0&&function bve(r,e,t){return t.some(n=>om(r,e,n)&&Fa(n)!==sn)}(r,t,n)?{segmentGroup:new f1(e,Tve(n,new f1(t,r.children))),slicedSegments:[]}:0===t.length&&function wve(r,e,t){return t.some(n=>om(r,e,n))}(r,t,n)?{segmentGroup:new f1(r.segments,Ove(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new f1(r.segments,r.children),slicedSegments:t}}function Ove(r,e,t,n,i){const o={};for(const s of n)if(om(r,t,s)&&!i[Fa(s)]){const a=new f1([],{});o[Fa(s)]=a}return{...i,...o}}function Tve(r,e){const t={};t[sn]=e;for(const n of r)if(""===n.path&&Fa(n)!==sn){const i=new f1([],{});t[Fa(n)]=i}return t}function om(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class kve{constructor(e,t,n,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new Pve(this.urlSerializer,this.urlTree)}noMatchError(e){return new pe(4002,!1)}recognize(){const e=FW(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,sn).pipe(I6(t=>{if(t instanceof HW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof im?this.noMatchError(t):t}),Zn(t=>{const n=new em([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},sn,this.rootComponentType,null,{}),i=new W3(n,t),o=new bW("",i),s=function E_e(r,e,t=null,n=null){return mW(pW(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root),{state:o,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,sn).pipe(I6(n=>{throw n instanceof im?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=TW(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const o of Object.keys(n.children))"primary"===o?i.unshift(o):i.push(o);return fi(i).pipe(e5(o=>{const s=n.children[o],a=function X_e(r,e){const t=r.filter(n=>Fa(n)===e);return t.push(...r.filter(n=>Fa(n)!==e)),t}(t,o);return this.processSegmentGroup(e,a,s,o)}),function Qme(r,e){return ei(function Xme(r,e,t,n,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(pr(s,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}(r,e,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),qp(null),function Jme(r,e){const t=arguments.length>=2;return n=>n.pipe(r?U3((i,o)=>r(i,o,n)):pc,TS(1),t?qp(e):nW(()=>new Wp))}(),io(o=>{if(null===o)return l5(n);const s=$W(o);return function xve(r){r.sort((e,t)=>e.value.outlet===sn?-1:t.value.outlet===sn?1:e.value.outlet.localeCompare(t.value.outlet))}(s),$t(s)}))}processSegment(e,t,n,i,o,s){return fi(t).pipe(e5(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,o,s).pipe(I6(c=>{if(c instanceof im)return $t(null);throw c}))),A6(a=>!!a),I6(a=>{if(zW(a))return function Ave(r,e,t){return 0===e.length&&!r.children[t]}(n,i,o)?$t([]):l5(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,o,s,a){return function Nve(r,e,t,n){return!!(Fa(r)===n||n!==sn&&om(e,t,r))&&("**"===r.path||BS(e,r,t).matched)}(n,i,o,s)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,o,s,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,o,s):l5(i):l5(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const o=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?VW(o):this.applyRedirects.lineralizeSegments(n,o).pipe(io(s=>{const a=new f1(s,{});return this.processSegment(e,t,a,s,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=BS(t,i,o);if(!a)return l5(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?VW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(io(m=>this.processSegment(e,n,t,m.concat(l),s,!1)))}matchSegmentAgainstRoute(e,t,n,i,o,s){let a;if("**"===n.path){const c=i.length>0?iW(i).parameters:{};a=$t({snapshot:new em(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GW(n),Fa(n),n.component??n._loadedComponent??null,n,BW(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Sve(t,n,i,e).pipe(Zn(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new em(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GW(n),Fa(n),n.component??n._loadedComponent??null,n,BW(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(Na(c=>null===c?l5(t):this.getChildConfig(e=n._injector??e,n,i).pipe(Na(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:E}=c,{segmentGroup:T,slicedSegments:L}=FW(t,m,E,l);if(0===L.length&&T.hasChildren())return this.processChildren(f,l,T).pipe(Zn(G=>null===G?null:[new W3(d,G)]));if(0===l.length&&0===L.length)return $t([new W3(d,[])]);const z=Fa(n)===o;return this.processSegment(f,l,T,L,z?sn:o,!0).pipe(Zn(G=>[new W3(d,G)]))}))))}getChildConfig(e,t,n){return t.children?$t({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?$t({routes:t._loadedRoutes,injector:t._loadedInjector}):function Cve(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?$t(!0):$t(i.map(s=>{const a=a5(s,r);return ol(function ove(r){return r&&zf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe(c5(),DW())}(e,t,n).pipe(io(i=>i?this.configLoader.loadChildren(e,t).pipe(Go(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function Eve(r){return Ef(IW(!1,3))}())):$t({routes:[],injector:e})}}function Lve(r){const e=r.value.routeConfig;return e&&""===e.path}function $W(r){const e=[],t=new Set;for(const n of r){if(!Lve(n)){e.push(n);continue}const i=e.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=$W(n.children);e.push(new W3(n.value,i))}return e.filter(n=>!t.has(n))}function GW(r){return r.data||{}}function BW(r){return r.resolve||{}}function UW(r){return"string"==typeof r.title||null===r.title}function US(r){return Na(e=>{const t=r(e);return t?fi(t).pipe(Zn(()=>e)):$t(e)})}const u5=new et("ROUTES");let WS=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=nt(oG)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return $t(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=ol(n.loadComponent()).pipe(Zn(WW),Go(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Cf(()=>{this.componentLoaders.delete(n)})),o=new tW(i,()=>new Vs).pipe(OS());return this.componentLoaders.set(n,o),o}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return $t({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Zn(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(u5,[],fn.Self|fn.Optional).flat()),{routes:f.map($S),injector:l}}),Cf(()=>{this.childrenLoaders.delete(i)})),a=new tW(s,()=>new Vs).pipe(OS());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return ol(n()).pipe(Zn(WW),io(i=>i instanceof d$||Array.isArray(i)?$t(i):fi(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function WW(r){return function $ve(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let sm=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Vs,this.configLoader=nt(WS),this.environmentInjector=nt(y2),this.urlSerializer=nt(Of),this.rootContexts=nt(If),this.inputBindingEnabled=null!==nt(tm,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>$t(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=o=>this.events.next(new R_e(o)),this.configLoader.onLoadStartListener=o=>this.events.next(new L_e(o))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new xo({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Nf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(U3(i=>0!==i.id),Zn(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),Na(i=>{let o=!1,s=!1;return $t(i).pipe(Go(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Na(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new Af(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),mc}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return qW(a.source)&&(n.browserUrlTree=a.extractedUrl),$t(a).pipe(Na(d=>{const m=this.transitions?.getValue();return this.events.next(new kS(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?mc:Promise.resolve(d)}),function Rve(r,e,t,n,i,o){return io(s=>function Ive(r,e,t,n,i,o,s="emptyOnly"){return new kve(r,e,t,n,i,s,o).recognize()}(r,e,t,n,s.extractedUrl,i,o).pipe(Zn(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Go(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const E=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(E,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new N_e(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:E,restoredState:T,extras:L}=a,z=new kS(d,this.urlSerializer.serialize(m),E,T);this.events.next(z);const G=OW(0,this.rootComponentType).snapshot;return $t(i={...a,targetSnapshot:G,urlAfterRedirects:m,extras:{...L,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new Af(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),mc}}),Go(a=>{const c=new A_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Zn(a=>i={...a,guards:eve(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function fve(r,e){return io(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?$t({...t,guardsResult:!0}):function dve(r,e,t,n){return fi(r).pipe(io(i=>function vve(r,e,t,n,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?$t(o.map(a=>{const c=xf(e)??i,l=a5(a,c);return ol(function cve(r){return r&&zf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(A6())})).pipe(c5()):$t(!0)}(i.component,i.route,t,e,n)),A6(i=>!0!==i,!0))}(s,n,i,r).pipe(io(a=>a&&function ive(r){return"boolean"==typeof r}(a)?function hve(r,e,t,n){return fi(e).pipe(e5(i=>SS(function pve(r,e){return null!==r&&e&&e(new z_e(r)),$t(!0)}(i.route.parent,n),function gve(r,e){return null!==r&&e&&e(new H_e(r)),$t(!0)}(i.route,n),function _ve(r,e,t){const n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function tve(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(s)).filter(s=>null!==s).map(s=>eW(()=>$t(s.guards.map(c=>{const l=xf(s.node)??t,f=a5(c,l);return ol(function ave(r){return r&&zf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(A6())})).pipe(c5())));return $t(o).pipe(c5())}(r,i.path,t),function mve(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return $t(!0);const i=n.map(o=>eW(()=>{const s=xf(e)??t,a=a5(o,s);return ol(function sve(r){return r&&zf(r.canActivate)}(a)?a.canActivate(e,r):s.runInContext(()=>a(e,r))).pipe(A6())}));return $t(i).pipe(c5())}(r,i.route,t))),A6(i=>!0!==i,!0))}(n,o,r,e):$t(a)),Zn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),Go(a=>{if(i.guardsResult=a.guardsResult,x6(a.guardsResult))throw AW(0,a.guardsResult);const c=new I_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),U3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),US(a=>{if(a.guards.canActivateChecks.length)return $t(a).pipe(Go(c=>{const l=new k_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Na(c=>{let l=!1;return $t(c).pipe(function zve(r,e){return io(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return $t(t);let o=0;return fi(i).pipe(e5(s=>function Dve(r,e,t,n){const i=r.routeConfig,o=r._resolve;return void 0!==i?.title&&!UW(i)&&(o[Pf]=i.title),function Hve(r,e,t,n){const i=function Vve(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return $t({});const o={};return fi(i).pipe(io(s=>function Fve(r,e,t,n){const i=xf(e)??n,o=a5(r,i);return ol(o.resolve?o.resolve(e,t):i.runInContext(()=>o(e,t)))}(r[s],e,t,n).pipe(A6(),Go(a=>{o[s]=a}))),TS(1),function e_e(r){return Zn(()=>r)}(o),I6(s=>zW(s)?mc:Ef(s)))}(o,r,e,n).pipe(Zn(s=>(r._resolvedData=s,r.data=TW(r,t).resolve,i&&UW(i)&&(r.data[Pf]=i.title),null)))}(s.route,n,r,e)),Go(()=>o++),TS(1),io(s=>o===i.length?$t(t):mc))})}(n.paramsInheritanceStrategy,this.environmentInjector),Go({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Go(c=>{const l=new x_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),US(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(Go(d=>{l.component=d}),Zn(()=>{})));for(const d of l.children)f.push(...c(d));return f};return PS(c(a.targetSnapshot.root)).pipe(qp(),r5(1))}),US(()=>this.afterPreactivation()),Zn(a=>{const c=function U_e(r,e,t){const n=kf(r,e._root,t?t._root:void 0);return new SW(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),Go(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>Zn(i=>(new J_e(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),r5(1),Go({next:a=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new sl(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{o=!0}}),Cf(()=>{o||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),I6(a=>{if(s=!0,xW(a)){kW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new Jp(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),kW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||qW(i.source)};n.scheduleNavigation(l,Nf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new xS(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return mc}))}))}cancelNavigationTransition(n,i,o){const s=new Jp(n.id,this.urlSerializer.serialize(n.extractedUrl),i,o);this.events.next(s),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function qW(r){return r!==Nf}let jW=(()=>{var r;class e{buildTitle(n){let i,o=n.root;for(;void 0!==o;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===sn);return i}getResolvedTitleForRoute(n){return n.data[Pf]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Gve)},providedIn:"root"}),e})(),Gve=(()=>{var r;class e extends jW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(IB))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Bve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Wve)},providedIn:"root"}),e})();class Uve{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Wve=(()=>{var r;class e extends Uve{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}(),r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const am=new et("",{providedIn:"root",factory:()=>({})});let qve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(jve)},providedIn:"root"}),e})(),jve=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var Df=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Df||{});function ZW(r,e){r.events.pipe(U3(t=>t instanceof sl||t instanceof Jp||t instanceof xS||t instanceof Af),Zn(t=>t instanceof sl||t instanceof Af?Df.COMPLETE:t instanceof Jp&&(0===t.code||1===t.code)?Df.REDIRECTING:Df.FAILED),U3(t=>t!==Df.REDIRECTING),r5(1)).subscribe(()=>{e()})}function Zve(r){throw r}function Yve(r,e,t){return e.parse("/")}const Kve={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Xve={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Un=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=nt(iG),this.isNgZoneEnabled=!1,this.options=nt(am,{optional:!0})||{},this.pendingTasks=nt(ap),this.errorHandler=this.options.errorHandler||Zve,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Yve,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=nt(qve),this.routeReuseStrategy=nt(Bve),this.titleStrategy=nt(jW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=nt(u5,{optional:!0})?.flat()??[],this.navigationTransitions=nt(sm),this.urlSerializer=nt(Of),this.location=nt(wP),this.componentInputBindingEnabled=!!nt(tm,{optional:!0}),this.isNgZoneEnabled=nt(u1)instanceof u1&&u1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new o5,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=OW(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Nf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,o){const s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){const l={...o};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map($S),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{m=pW(o?o.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return mW(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const o=x6(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,Nf,null,i)}navigate(n,i={skipLocationChange:!1}){return function Qve(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new pe(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(o){i=this.malformedUriErrorHandler(o,this.urlSerializer,n)}return i}isActive(n,i){let o;if(o=!0===i?{...Kve}:!1===i?{...Xve}:i,x6(n))return sW(this.currentUrlTree,n,o);const s=this.parseUrl(n);return sW(this.currentUrlTree,s,o)}removeEmptyProps(n){return Object.keys(n).reduce((i,o)=>{const s=n[o];return null!=s&&(i[o]=s),i},{})}scheduleNavigation(n,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,E)=>{c=m,l=E});const d=this.pendingTasks.add();return ZW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const o=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(o,"",a)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(o,"",s)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Fc=(()=>{var r;class e{constructor(n,i,o,s,a,c){this.router=n,this.route=i,this.tabIndexAttribute=o,this.renderer=s,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Vs,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof sl&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,o,s,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||o||s||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function TH(r,e,t){return function C8e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?OH:Tg}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const o=this.renderer,s=this.el.nativeElement;null!==i?o.setAttribute(s,n,i):o.removeAttribute(s,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Un),U(_s),function sg(r){return function z6e(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const o=t[i];if(bz(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(o===e)return t[i+1];i+=2}}}return null}(co(),r)}("tabindex"),U(Oc),U(Vo),U(S6))},r.\u0275dir=zt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&q("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&A("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",Y8],skipLocationChange:["skipLocationChange","skipLocationChange",Y8],replaceUrl:["replaceUrl","replaceUrl",Y8],routerLink:"routerLink"},standalone:!0,features:[LV,Do]}),e})();class YW{}let tCe=(()=>{var r;class e{constructor(n,i,o,s,a){this.router=n,this.injector=o,this.preloadingStrategy=s,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(U3(n=>n instanceof sl),e5(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const o=[];for(const s of i){s.providers&&!s._injector&&(s._injector=jE(s.providers,n,`Route: ${s.path}`));const a=s._injector??n,c=s._loadedInjector??a;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(a,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(c,s.children??s._loadedRoutes))}return fi(o).pipe(r8())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let o;o=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):$t(null);const s=o.pipe(io(a=>null===a?$t(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?fi([s,this.loader.loadComponent(i)]).pipe(r8()):s})}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(Un),Oe(oG),Oe(y2),Oe(YW),Oe(WS))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const qS=new et("");let KW=(()=>{var r;class e{constructor(n,i,o,s,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=o,this.zone=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof kS?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof sl?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Af&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof EW&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new EW(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function cV(){throw new Error("invalid")}()},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function q3(r,e){return{\u0275kind:r,\u0275providers:e}}function QW(){const r=nt(lo);return e=>{const t=r.get(E6);if(e!==t.components[0])return;const n=r.get(Un),i=r.get(JW);1===r.get(jS)&&n.initialNavigation(),r.get(eq,null,fn.Optional)?.setUpPreloading(),r.get(qS,null,fn.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const JW=new et("",{factory:()=>new Vs}),jS=new et("",{providedIn:"root",factory:()=>1}),eq=new et("");function oCe(r){return q3(0,[{provide:eq,useExisting:tCe},{provide:YW,useExisting:r}])}const tq=new et("ROUTER_FORROOT_GUARD"),aCe=[wP,{provide:Of,useClass:bS},Un,If,{provide:_s,useFactory:function XW(r){return r.routerState.root},deps:[Un]},WS,[]];function cCe(){return new _G("Router",Un)}let lCe=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[aCe,[],{provide:u5,multi:!0,useValue:n},{provide:tq,useFactory:hCe,deps:[[Un,new ds,new lg]]},{provide:am,useValue:i||{}},i?.useHash?{provide:S6,useClass:X9e}:{provide:S6,useClass:qG},{provide:qS,useFactory:()=>{const r=nt(gge),e=nt(u1),t=nt(am),n=nt(sm),i=nt(Of);return t.scrollOffset&&r.setOffset(t.scrollOffset),new KW(i,n,r,e,t)}},i?.preloadingStrategy?oCe(i.preloadingStrategy).\u0275providers:[],{provide:_G,multi:!0,useFactory:cCe},i?.initialNavigation?gCe(i):[],i?.bindToComponentInputs?q3(8,[NW,{provide:tm,useExisting:NW}]).\u0275providers:[],[{provide:nq,useFactory:QW},{provide:vP,multi:!0,useExisting:nq}]]}}static forChild(n){return{ngModule:e,providers:[{provide:u5,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(tq,8))},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({}),e})();function hCe(r){return"guarded"}function gCe(r){return["disabled"===r.initialNavigation?q3(3,[{provide:cP,multi:!0,useFactory:()=>{const e=nt(Un);return()=>{e.setUpLocationChangeListener()}}},{provide:jS,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?q3(2,[{provide:jS,useValue:0},{provide:cP,multi:!0,deps:[lo],useFactory:e=>{const t=e.get(Y9e,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Un),o=e.get(JW);ZW(i,()=>{n(!0)}),e.get(sm).afterPreactivation=()=>(n(!0),o.closed?$t(void 0):o),i.initialNavigation()}))}}]).\u0275providers:[]]}const nq=new et("");class rq{}class mCe{}const j3="*";function iq(r,e=null){return{type:2,steps:r,options:e}}function oq(r){return{type:6,styles:r,offset:null}}class Hf{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class sq{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++n==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function aq(r){return new pe(3e3,!1)}function al(r){switch(r.length){case 0:return new Hf;case 1:return r[0];default:return new sq(r)}}function cq(r,e,t=new Map,n=new Map){const i=[],o=[];let s=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==s,d=f&&a||new Map;c.forEach((m,E)=>{let T=E,L=m;if("offset"!==E)switch(T=r.normalizePropertyName(T,i),L){case"!":L=t.get(E);break;case j3:L=n.get(E);break;default:L=r.normalizeStyleValue(E,T,L,i)}d.set(T,L)}),f||o.push(d),a=d,s=l}),i.length)throw function VCe(r){return new pe(3502,!1)}();return o}function YS(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&KS(t,"start",r)));break;case"done":r.onDone(()=>n(t&&KS(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&KS(t,"destroy",r)))}}function KS(r,e,t){const o=XS(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),s=r._data;return null!=s&&(o._data=s),o}function XS(r,e,t,n,i="",o=0,s){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:o,disabled:!!s}}function S2(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function lq(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const XCe=(()=>typeof document>"u"?null:document.documentElement)();function QS(r){const e=r.parentNode||r.host||null;return e===XCe?null:e}let L6=null,uq=!1;function fq(r,e){for(;e;){if(e===r)return!0;e=QS(e)}return!1}function dq(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let hq=(()=>{var r;class e{validateStyleProperty(n){return function JCe(r){L6||(L6=function eye(){return typeof document<"u"?document.body:null}()||{},uq=!!L6.style&&"WebkitAppearance"in L6.style);let e=!0;return L6.style&&!function QCe(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in L6.style,!e&&uq&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in L6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return fq(n,i)}getParentElement(n){return QS(n)}query(n,i,o){return dq(n,i,o)}computeStyle(n,i,o){return o||""}animate(n,i,o,s,a,c=[],l){return new Hf(o,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),JS=(()=>{class e{}return e.NOOP=new hq,e})();const tye=1e3,eO="ng-enter",cm="ng-leave",lm="ng-trigger",um=".ng-trigger",pq="ng-animating",tO=".ng-animating";function Z3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:nO(parseFloat(e[1]),e[2])}function nO(r,e){return"s"===e?r*tye:r}function fm(r,e,t){return r.hasOwnProperty("duration")?r:function rye(r,e,t){let i,o=0,s="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(aq()),{duration:0,delay:0,easing:""};i=nO(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=nO(parseFloat(c),a[4]));const l=a[5];l&&(s=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function _Ce(){return new pe(3100,!1)}()),a=!0),o<0&&(e.push(function vCe(){return new pe(3101,!1)}()),a=!0),a&&e.splice(c,0,aq())}return{duration:i,delay:o,easing:s}}(r,e,t)}function Vf(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function mq(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function cl(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function $c(r,e,t){e.forEach((n,i)=>{const o=iO(i);t&&!t.has(i)&&t.set(i,r.style[o]),r.style[o]=n})}function R6(r,e){e.forEach((t,n)=>{const i=iO(n);r.style[i]=""})}function Ff(r){return Array.isArray(r)?1==r.length?r[0]:iq(r):r}const rO=new RegExp("{{\\s*(.+?)\\s*}}","g");function vq(r){let e=[];if("string"==typeof r){let t;for(;t=rO.exec(r);)e.push(t[1]);rO.lastIndex=0}return e}function $f(r,e,t){const n=r.toString(),i=n.replace(rO,(o,s)=>{let a=e[s];return null==a&&(t.push(function yCe(r){return new pe(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function dm(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const sye=/-+([a-z0-9])/g;function iO(r){return r.replace(sye,(...e)=>e[1].toUpperCase())}function O2(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function MCe(r){return new pe(3004,!1)}()}}function Cq(r,e){return window.getComputedStyle(r)[e]}const hm="*";function lye(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function uye(r,e,t){if(":"==r[0]){const c=function fye(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function RCe(r){return new pe(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function LCe(r){return new pe(3015,!1)}()),e;const i=n[1],o=n[2],s=n[3];e.push(yq(i,s));"<"==o[0]&&!(i==hm&&s==hm)&&e.push(yq(s,i))}(n,t,e)):t.push(r),t}const gm=new Set(["true","1"]),pm=new Set(["false","0"]);function yq(r,e){const t=gm.has(r)||pm.has(r),n=gm.has(e)||pm.has(e);return(i,o)=>{let s=r==hm||r==i,a=e==hm||e==o;return!s&&t&&"boolean"==typeof i&&(s=i?gm.has(r):pm.has(r)),!a&&n&&"boolean"==typeof o&&(a=o?gm.has(e):pm.has(e)),s&&a}}const dye=new RegExp("s*:selfs*,?","g");function oO(r,e,t,n){return new hye(r).build(e,t,n)}class hye{constructor(e){this._driver=e}build(e,t,n){const i=new mye(t);return this._resetContextStyleTimingState(i),O2(this,Ff(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const o=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push(function PCe(){return new pe(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,o.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,s.push(c)}else t.errors.push(function SCe(){return new pe(3007,!1)}())}),{type:7,name:e.name,states:o,transitions:s,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const o=new Set,s=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{vq(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&(dm(o.values()),t.errors.push(function OCe(r,e){return new pe(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=O2(this,Ff(e.animation),t);return{type:1,matchers:lye(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:z6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>O2(this,n,t)),options:z6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const o=e.steps.map(s=>{t.currentTime=n;const a=O2(this,s,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:o,options:z6(e.options)}}visitAnimate(e,t){const n=function vye(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return sO(fm(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=sO(0,0,"");return o.dynamic=!0,o.strValue=t,o}const i=fm(t,e);return sO(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,o=e.styles?e.styles:oq({});if(5==o.type)i=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;const l={};n.easing&&(l.easing=n.easing),s=oq(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(s,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===j3?n.push(a):t.errors.push(new pe(3002,!1)):n.push(mq(a));let o=!1,s=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:n,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(o!=i&&o>=f.startTime&&i<=f.endTime&&(t.errors.push(function bCe(r,e,t,n,i){return new pe(3010,!1)}()),d=!1),o=f.startTime),d&&l.set(c,{startTime:o,endTime:i}),t.options&&function oye(r,e,t){const n=e.params||{},i=vq(r);i.length&&i.forEach(o=>{n.hasOwnProperty(o)||t.push(function CCe(r){return new pe(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function wCe(){return new pe(3011,!1)}()),n;let o=0;const s=[];let a=!1,c=!1,l=0;const f=e.steps.map(G=>{const B=this._makeStyleAst(G,t);let de=null!=B.offset?B.offset:function _ye(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(B.styles),ye=0;return null!=de&&(o++,ye=B.offset=de),c=c||ye<0||ye>1,a=a||ye<l,l=ye,s.push(ye),B});c&&t.errors.push(function NCe(){return new pe(3012,!1)}()),a&&t.errors.push(function ACe(){return new pe(3200,!1)}());const d=e.steps.length;let m=0;o>0&&o<d?t.errors.push(function ICe(){return new pe(3202,!1)}()):0==o&&(m=1/(d-1));const E=d-1,T=t.currentTime,L=t.currentAnimateTimings,z=L.duration;return f.forEach((G,B)=>{const de=m>0?B==E?1:m*B:s[B],ye=de*z;t.currentTime=T+L.delay+ye,L.duration=ye,this._validateStyleAst(G,t),G.offset=de,n.styles.push(G)}),n}visitReference(e,t){return{type:8,animation:O2(this,Ff(e.animation),t),options:z6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:z6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:z6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[o,s]=function gye(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(dye,"")),r=r.replace(/@\*/g,um).replace(/@\w+/g,t=>um+"-"+t.slice(1)).replace(/:animating/g,tO),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+o:o,S2(t.collectedStyles,t.currentQuerySelector,new Map);const a=O2(this,Ff(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:z6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function kCe(){return new pe(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:fm(e.timings,t.errors,!0);return{type:12,animation:O2(this,Ff(e.animation),t),timings:n,options:null}}}class mye{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function z6(r){return r?(r=Vf(r)).params&&(r.params=function pye(r){return r?Vf(r):null}(r.params)):r={},r}function sO(r,e,t){return{duration:r,delay:e,easing:t}}function aO(r,e,t,n,i,o,s=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class mm{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Mye=new RegExp(":enter","g"),Pye=new RegExp(":leave","g");function cO(r,e,t,n,i,o=new Map,s=new Map,a,c,l=[]){return(new Sye).buildKeyframes(r,e,t,n,i,o,s,a,c,l)}class Sye{buildKeyframes(e,t,n,i,o,s,a,c,l,f=[]){l=l||new mm;const d=new lO(e,t,l,i,o,f,[]);d.options=c;const m=c.delay?Z3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([s],null,d.errors,c),O2(this,n,d);const E=d.timelines.filter(T=>T.containsAnimation());if(E.length&&a.size){let T;for(let L=E.length-1;L>=0;L--){const z=E[L];if(z.element===t){T=z;break}}T&&!T.allowOnlyTimelineStyles()&&T.setStyles([a],null,d.errors,c)}return E.length?E.map(T=>T.buildKeyframes()):[aO(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const o=i?.delay;if(o){const s="number"==typeof o?o:Z3($f(o,i?.params??{},t.errors));n.delayNextStep(s)}}}_visitSubInstructions(e,t,n){let o=t.currentTimeline.currentTime;const s=null!=n.duration?Z3(n.duration):null,a=null!=n.delay?Z3(n.delay):null;return 0!==s&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),O2(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=_m);const s=Z3(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>O2(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?Z3(e.options.delay):0;e.steps.forEach(s=>{const a=t.createSubContext(e.options);o&&a.delayNextStep(o),O2(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return fm(t.params?$f(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const o=e.style;5==o.type?this.visitKeyframes(o,t):(t.incrementTime(n.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(o):n.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,o=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?Z3(i.delay):0;o&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=_m);let s=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);o&&d.delayNextStep(o),l===t.element&&(c=d.currentTimeline),O2(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1);let c=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;O2(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const _m={};class lO{constructor(e,t,n,i,o,s,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=_m,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new vm(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=Z3(n.duration)),null!=n.delay&&(i.delay=Z3(n.delay));const o=n.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=$f(o[a],s,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,o=new lO(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=_m,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},o=new Oye(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(Mye,"."+this._enterClassName)).replace(Pye,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!o&&0==a.length&&s.push(function xCe(r){return new pe(3014,!1)}()),a}}class vm{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new vm(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||j3),this._currentKeyframe.set(t,j3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const o=i&&i.params||{},s=function Tye(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let o of n)t.set(o,j3)}else cl(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of s){const l=$f(c,o,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??j3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=cl(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===j3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const o=e.size?dm(e.values()):[],s=t.size?dm(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return aO(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}}class Oye extends vm{constructor(e,t,n,i,o,s,a=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],s=n+t,a=t/s,c=cl(e[0]);c.set("offset",0),o.push(c);const l=cl(e[0]);l.set("offset",Pq(a)),o.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=cl(e[d]);const E=m.get("offset");m.set("offset",Pq((t+E*n)/s)),o.push(m)}n=s,t=0,i="",e=o}return aO(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function Pq(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class uO{}const bye=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class wye extends uO{normalizePropertyName(e,t){return iO(e)}normalizeStyleValue(e,t,n,i){let o="";const s=n.toString().trim();if(bye.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function ECe(r,e){return new pe(3005,!1)}())}return s+o}}function Sq(r,e,t,n,i,o,s,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const fO={};class Oq{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function Nye(r,e,t,n,i){return r.some(o=>o(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,o,s,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||fO,T=this.buildStyles(n,a&&a.params||fO,d),L=c&&c.params||fO,z=this.buildStyles(i,L,d),G=new Set,B=new Map,de=new Map,ye="void"===i,Le={params:Aye(L,m),delay:this.ast.options?.delay},tt=f?[]:cO(e,t,this.ast.animation,o,s,T,z,Le,l,d);let gt=0;if(tt.forEach(Et=>{gt=Math.max(Et.duration+Et.delay,gt)}),d.length)return Sq(t,this._triggerName,n,i,ye,T,z,[],[],B,de,gt,d);tt.forEach(Et=>{const no=Et.element,X0=S2(B,no,new Set);Et.preStyleProps.forEach(E3=>X0.add(E3));const e6=S2(de,no,new Set);Et.postStyleProps.forEach(E3=>e6.add(E3)),no!==t&&G.add(no)});const Pn=dm(G.values());return Sq(t,this._triggerName,n,i,ye,T,z,tt,Pn,B,de,gt)}}function Aye(r,e){const t=Vf(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class Iye{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Vf(this.defaultParams);return Object.keys(e).forEach(o=>{const s=e[o];null!==s&&(i[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=$f(s,i,t));const c=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,c,s,t),n.set(a,s)})}),n}}class xye{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new Iye(i.style,i.options&&i.options.params||{},n))}),Tq(this.states,"true","1"),Tq(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new Oq(e,i,this.states))}),this.fallbackTransition=function Lye(r,e,t){return new Oq(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(s=>s.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Tq(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const Rye=new mm;class zye{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],o=oO(this._driver,t,n,[]);if(n.length)throw function FCe(r){return new pe(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,n){const i=e.element,o=cq(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],o=this._animations.get(e);let s;const a=new Map;if(o?(s=cO(this._driver,t,o,eO,cm,new Map,new Map,n,Rye,i),s.forEach(f=>{const d=S2(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function $Ce(){return new pe(3300,!1)}()),s=[]),i.length)throw function GCe(r){return new pe(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,E)=>{f.set(E,this._driver.computeStyle(d,E,j3))})});const l=al(s.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function BCe(r){return new pe(3301,!1)}();return t}listen(e,t,n,i){const o=XS(t,"","","");return YS(this._getPlayer(e),n,o,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const o=this._getPlayer(e);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const bq="ng-animate-queued",dO="ng-animate-disabled",$ye=[],wq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Gye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},$a="__ng_removed";class hO{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function qye(r){return r??null}(n?e.value:e),n){const o=Vf(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const Gf="void",gO=new hO(Gf);class Bye{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ra(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function UCe(r,e){return new pe(3302,!1)}();if(null==n||0==n.length)throw function WCe(r){return new pe(3303,!1)}();if(!function jye(r){return"start"==r||"done"==r}(n))throw function qCe(r,e){return new pe(3400,!1)}();const o=S2(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);const a=S2(this._engine.statesByElement,e,new Map);return a.has(t)||(ra(e,lm),ra(e,lm+"-"+t),a.set(t,gO)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function jCe(r){return new pe(3401,!1)}();return t}trigger(e,t,n,i=!0){const o=this._getTrigger(t),s=new pO(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(ra(e,lm),ra(e,lm+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new hO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=gO),l.value!==Gf&&c.value===l.value){if(!function Kye(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const o=t[i];if(!e.hasOwnProperty(o)||r[o]!==e[o])return!1}return!0}(c.params,l.params)){const L=[],z=o.matchStyles(c.value,c.params,L),G=o.matchStyles(l.value,l.params,L);L.length?this._engine.reportError(L):this._engine.afterFlush(()=>{R6(e,z),$c(e,G)})}return}const m=S2(this._engine.playersByElement,e,[]);m.forEach(L=>{L.namespaceId==this.id&&L.triggerName==t&&L.queued&&L.destroy()});let E=o.matchTransition(c.value,l.value,e,l.params),T=!1;if(!E){if(!i)return;E=o.fallbackTransition,T=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:c,toState:l,player:s,isFallbackTransition:T}),T||(ra(e,bq),s.onStart(()=>{f5(e,bq)})),s.onDone(()=>{let L=this.players.indexOf(s);L>=0&&this.players.splice(L,1);const z=this._engine.playersByElement.get(e);if(z){let G=z.indexOf(s);G>=0&&z.splice(G,1)}}),this.players.push(s),m.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,um,!0);n.forEach(i=>{if(i[$a])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const o=this._engine.statesByElement.get(e),s=new Map;if(o){const a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,Gf,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),n&&al(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(o=>{const s=o.name;if(i.has(s))return;i.add(s);const c=this._triggers.get(s).fallbackTransition,l=n.get(s)||gO,f=new hO(Gf),d=new pO(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(n.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const o=e[$a];(!o||o===wq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){ra(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const o=n.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==n.triggerName){const c=XS(o,n.triggerName,n.fromState.value,n.toState.value);c._data=e,YS(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const o=n.transition.ast.depCount,s=i.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Uye{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Bye(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}return t}trigger(e,t,n,i){if(Cm(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Cm(t))return;const o=t[$a];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){const s=this._fetchNamespace(e);s&&s.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ra(e,dO)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),f5(e,dO))}removeNode(e,t,n){if(Cm(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,o){this.collectedLeaveElements.push(t),t[$a]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,n,i,o){return Cm(t)?this._fetchNamespace(e).listen(t,n,i,o):()=>{}}_buildInstruction(e,t,n,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,um,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,tO,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return al(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[$a];if(t&&t.setForRemoval){if(e[$a]=wq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(dO)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)ra(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?al(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function ZCe(r){return new pe(3402,!1)}()}_flushAnimations(e,t){const n=new mm,i=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(ft=>{f.add(ft);const Ot=this.driver.query(ft,".ng-animate-queued",!0);for(let xt=0;xt<Ot.length;xt++)f.add(Ot[xt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),E=Iq(m,this.collectedEnterElements),T=new Map;let L=0;E.forEach((ft,Ot)=>{const xt=eO+L++;T.set(Ot,xt),ft.forEach(kn=>ra(kn,xt))});const z=[],G=new Set,B=new Set;for(let ft=0;ft<this.collectedLeaveElements.length;ft++){const Ot=this.collectedLeaveElements[ft],xt=Ot[$a];xt&&xt.setForRemoval&&(z.push(Ot),G.add(Ot),xt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(kn=>G.add(kn)):B.add(Ot))}const de=new Map,ye=Iq(m,Array.from(G));ye.forEach((ft,Ot)=>{const xt=cm+L++;de.set(Ot,xt),ft.forEach(kn=>ra(kn,xt))}),e.push(()=>{E.forEach((ft,Ot)=>{const xt=T.get(Ot);ft.forEach(kn=>f5(kn,xt))}),ye.forEach((ft,Ot)=>{const xt=de.get(Ot);ft.forEach(kn=>f5(kn,xt))}),z.forEach(ft=>{this.processLeaveNode(ft)})});const Le=[],tt=[];for(let ft=this._namespaceList.length-1;ft>=0;ft--)this._namespaceList[ft].drainQueuedTransitions(t).forEach(xt=>{const kn=xt.player,Nt=xt.element;if(Le.push(kn),this.collectedEnterElements.length){const as=Nt[$a];if(as&&as.setForMove){if(as.previousTriggersValues&&as.previousTriggersValues.has(xt.triggerName)){const Q0=as.previousTriggersValues.get(xt.triggerName),ba=this.statesByElement.get(xt.element);if(ba&&ba.has(xt.triggerName)){const Ty=ba.get(xt.triggerName);Ty.value=Q0,ba.set(xt.triggerName,Ty)}}return void kn.destroy()}}const P3=!d||!this.driver.containsElement(d,Nt),q2=de.get(Nt),t6=T.get(Nt),gr=this._buildInstruction(xt,n,t6,q2,P3);if(gr.errors&&gr.errors.length)return void tt.push(gr);if(P3)return kn.onStart(()=>R6(Nt,gr.fromStyles)),kn.onDestroy(()=>$c(Nt,gr.toStyles)),void i.push(kn);if(xt.isFallbackTransition)return kn.onStart(()=>R6(Nt,gr.fromStyles)),kn.onDestroy(()=>$c(Nt,gr.toStyles)),void i.push(kn);const L4e=[];gr.timelines.forEach(as=>{as.stretchStartingKeyframe=!0,this.disabledNodes.has(as.element)||L4e.push(as)}),gr.timelines=L4e,n.append(Nt,gr.timelines),s.push({instruction:gr,player:kn,element:Nt}),gr.queriedElements.forEach(as=>S2(a,as,[]).push(kn)),gr.preStyleProps.forEach((as,Q0)=>{if(as.size){let ba=c.get(Q0);ba||c.set(Q0,ba=new Set),as.forEach((Ty,tz)=>ba.add(tz))}}),gr.postStyleProps.forEach((as,Q0)=>{let ba=l.get(Q0);ba||l.set(Q0,ba=new Set),as.forEach((Ty,tz)=>ba.add(tz))})});if(tt.length){const ft=[];tt.forEach(Ot=>{ft.push(function YCe(r,e){return new pe(3505,!1)}())}),Le.forEach(Ot=>Ot.destroy()),this.reportError(ft)}const gt=new Map,Pn=new Map;s.forEach(ft=>{const Ot=ft.element;n.has(Ot)&&(Pn.set(Ot,Ot),this._beforeAnimationBuild(ft.player.namespaceId,ft.instruction,gt))}),i.forEach(ft=>{const Ot=ft.element;this._getPreviousPlayers(Ot,!1,ft.namespaceId,ft.triggerName,null).forEach(kn=>{S2(gt,Ot,[]).push(kn),kn.destroy()})});const Et=z.filter(ft=>xq(ft,c,l)),no=new Map;Aq(no,this.driver,B,l,j3).forEach(ft=>{xq(ft,c,l)&&Et.push(ft)});const e6=new Map;E.forEach((ft,Ot)=>{Aq(e6,this.driver,new Set(ft),c,"!")}),Et.forEach(ft=>{const Ot=no.get(ft),xt=e6.get(ft);no.set(ft,new Map([...Ot?.entries()??[],...xt?.entries()??[]]))});const E3=[],Sh=[],Oh={};s.forEach(ft=>{const{element:Ot,player:xt,instruction:kn}=ft;if(n.has(Ot)){if(f.has(Ot))return xt.onDestroy(()=>$c(Ot,kn.toStyles)),xt.disabled=!0,xt.overrideTotalTime(kn.totalTime),void i.push(xt);let Nt=Oh;if(Pn.size>1){let q2=Ot;const t6=[];for(;q2=q2.parentNode;){const gr=Pn.get(q2);if(gr){Nt=gr;break}t6.push(q2)}t6.forEach(gr=>Pn.set(gr,Nt))}const P3=this._buildAnimation(xt.namespaceId,kn,gt,o,e6,no);if(xt.setRealPlayer(P3),Nt===Oh)E3.push(xt);else{const q2=this.playersByElement.get(Nt);q2&&q2.length&&(xt.parentPlayer=al(q2)),i.push(xt)}}else R6(Ot,kn.fromStyles),xt.onDestroy(()=>$c(Ot,kn.toStyles)),Sh.push(xt),f.has(Ot)&&i.push(xt)}),Sh.forEach(ft=>{const Ot=o.get(ft.element);if(Ot&&Ot.length){const xt=al(Ot);ft.setRealPlayer(xt)}}),i.forEach(ft=>{ft.parentPlayer?ft.syncPlayerEvents(ft.parentPlayer):ft.destroy()});for(let ft=0;ft<z.length;ft++){const Ot=z[ft],xt=Ot[$a];if(f5(Ot,cm),xt&&xt.hasAnimation)continue;let kn=[];if(a.size){let P3=a.get(Ot);P3&&P3.length&&kn.push(...P3);let q2=this.driver.query(Ot,tO,!0);for(let t6=0;t6<q2.length;t6++){let gr=a.get(q2[t6]);gr&&gr.length&&kn.push(...gr)}}const Nt=kn.filter(P3=>!P3.destroyed);Nt.length?Zye(this,Ot,Nt):this.processLeaveNode(Ot)}return z.length=0,E3.forEach(ft=>{this.players.push(ft),ft.onDone(()=>{ft.destroy();const Ot=this.players.indexOf(ft);this.players.splice(Ot,1)}),ft.play()}),E3}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,o){let s=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(s=a)}else{const a=this.playersByElement.get(e);if(a){const c=!o||o==Gf;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||s.push(l)})}}return(n||i)&&(s=s.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,t,n){const o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==o,d=S2(n,l,[]);this._getPreviousPlayers(l,f,s,a,t.toState).forEach(E=>{const T=E.getRealPlayer();T.beforeDestroy&&T.beforeDestroy(),E.destroy(),d.push(E)})}R6(o,t.fromStyles)}_buildAnimation(e,t,n,i,o,s){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(T=>{const L=T.element;f.add(L);const z=L[$a];if(z&&z.removedBeforeQueried)return new Hf(T.duration,T.delay);const G=L!==c,B=function Yye(r){const e=[];return kq(r,e),e}((n.get(L)||$ye).map(gt=>gt.getRealPlayer())).filter(gt=>!!gt.element&&gt.element===L),de=o.get(L),ye=s.get(L),Le=cq(this._normalizer,T.keyframes,de,ye),tt=this._buildPlayer(T,Le,B);if(T.subTimeline&&i&&d.add(L),G){const gt=new pO(e,a,L);gt.setRealPlayer(tt),l.push(gt)}return tt});l.forEach(T=>{S2(this.playersByQueriedElement,T.element,[]).push(T),T.onDone(()=>function Wye(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,T.element,T))}),f.forEach(T=>ra(T,pq));const E=al(m);return E.onDestroy(()=>{f.forEach(T=>f5(T,pq)),$c(c,t.toStyles)}),d.forEach(T=>{S2(i,T,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Hf(e.duration,e.delay)}}class pO{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Hf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>YS(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){S2(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Cm(r){return r&&1===r.nodeType}function Nq(r,e){const t=r.style.display;return r.style.display=e??"none",t}function Aq(r,e,t,n,i){const o=[];t.forEach(c=>o.push(Nq(c)));const s=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[$a]=Gye,s.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>Nq(c,o[a++])),s}function Iq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:s(l),o.set(a,c),c}return e.forEach(a=>{const c=s(a);1!==c&&t.get(c).push(a)}),t}function ra(r,e){r.classList?.add(e)}function f5(r,e){r.classList?.remove(e)}function Zye(r,e,t){al(t).onDone(()=>r.processLeaveNode(e))}function kq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof sq?kq(n.players,e):e.push(n)}}function xq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(o=>i.add(o)):e.set(r,n),t.delete(r),!0}class ym{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new Uye(e,t,n),this._timelineEngine=new zye(e,t,n),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,n,i,o){const s=e+"-"+i;let a=this._triggerCache[s];if(!a){const c=[],f=oO(this._driver,o,c,[]);if(c.length)throw function HCe(r,e){return new pe(3404,!1)}();a=function kye(r,e,t){return new xye(r,e,t)}(i,f,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[o,s]=lq(n);this._timelineEngine.command(o,t,s,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,o){if("@"==n.charAt(0)){const[s,a]=lq(n);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,n,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Qye=(()=>{class e{constructor(n,i,o){this._element=n,this._startStyles=i,this._endStyles=o,this._state=0;let s=e.initialStylesByElement.get(n);s||e.initialStylesByElement.set(n,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&$c(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($c(this._element,this._initialStyles),this._endStyles&&($c(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(R6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(R6(this._element,this._endStyles),this._endStyles=null),$c(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function mO(r){let e=null;return r.forEach((t,n)=>{(function Jye(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class Lq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:Cq(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class eMe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return fq(e,t)}getParentElement(e){return QS(e)}query(e,t,n){return dq(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,o,s=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};o&&(c.easing=o);const l=new Map,f=s.filter(E=>E instanceof Lq);(function aye(r,e){return 0===r||0===e})(n,i)&&f.forEach(E=>{E.currentSnapshot.forEach((T,L)=>l.set(L,T))});let d=function iye(r){return r.length?r[0]instanceof Map?r:r.map(e=>mq(e)):[]}(t).map(E=>cl(E));d=function cye(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((o,s)=>{n.has(s)||i.push(s),n.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,Cq(r,a)))}}return e}(e,d,l);const m=function Xye(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=mO(e[0]),e.length>1&&(n=mO(e[e.length-1]))):e instanceof Map&&(t=mO(e)),t||n?new Qye(r,t,n):null}(e,d);return new Lq(e,d,c,m)}}let tMe=(()=>{var r;class e extends rq{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:X2.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(n)?iq(n):n;return Rq(this._renderer,null,i,"register",[o]),new nMe(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(z7),Oe(ki))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class nMe extends mCe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new rMe(this._id,e,t||{},this._renderer)}}class rMe{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Rq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function Rq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const zq="@.disabled";let iMe=(()=>{var r;class e{constructor(n,i,o){this.delegate=n,this.engine=i,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,a)=>{const c=a?.parentNode(s);c&&a.removeChild(c,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(s);return d||(d=new Dq("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new oMe(this,c,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,o){n>=0&&n<this._microtaskId?this._zone.run(()=>i(o)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[a,c]=s;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(z7),Oe(ym),Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class Dq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==zq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class oMe extends Dq{constructor(e,t,n,i,o){super(t,n,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==zq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function sMe(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let o=t.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function aMe(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let cMe=(()=>{var r;class e extends ym{constructor(n,i,o,s){super(n.body,i,o)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ki),Oe(JS),Oe(uO),Oe(E6))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const Hq=[{provide:rq,useClass:tMe},{provide:uO,useFactory:function lMe(){return new wye}},{provide:ym,useClass:cMe},{provide:z7,useFactory:function uMe(r,e,t){return new iMe(r,e,t)},deps:[KP,ym,u1]}],_O=[{provide:JS,useFactory:()=>new eMe},{provide:RH,useValue:"BrowserAnimations"},...Hq],Vq=[{provide:JS,useClass:hq},{provide:RH,useValue:"NoopAnimations"},...Hq];let fMe=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?Vq:_O}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:_O,imports:[AB]}),e})();function Fq(r,e,t,n,i,o,s){try{var a=r[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var o=r.apply(e,t);function s(c){Fq(o,n,i,s,a,"next",c)}function a(c){Fq(o,n,i,s,a,"throw",c)}s(void 0)})}}const $q=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},CO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],s=i+1<r.length,a=s?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,E=63&l;c||(E=64,s||(m=64)),n.push(t[o>>2],t[(3&o)<<4|a>>4],t[m],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray($q(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const o=r[t++],s=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==o||null==a||null==l||null==d)throw new pMe;n.push(o<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class pMe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Em=function(r){return function(r){const e=$q(r);return CO.encodeByteArray(e,!0)}(r).replace(/\./g,"")},Pm=function(r){try{return CO.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},Sm=()=>{try{return function vMe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Pm(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},Bq=r=>{var e,t;return null===(t=null===(e=Sm())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},Uq=()=>{var r;return null===(r=Sm())||void 0===r?void 0:r.config},Wq=r=>{var e;return null===(e=Sm())||void 0===e?void 0:e[`_${r}`]};class Om{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function xi(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function yO(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function D6(){try{return"object"==typeof indexedDB}catch{return!1}}function Bf(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(t){e(t)}})}function MO(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class T2 extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,T2.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gc.prototype.create)}}class Gc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?function NMe(r,e){return r.replace(AMe,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(o,n):"Error";return new T2(i,`${this.serviceName}: ${s} (${i}).`,n)}}const AMe=/\{\$([^}]+)}/g;function bm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const o=r[i],s=e[i];if(jq(o)&&jq(s)){if(!bm(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function jq(r){return null!==r&&"object"==typeof r}function Uf(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Wf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function qf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class xMe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function LMe(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=EO),void 0===i.error&&(i.error=EO),void 0===i.complete&&(i.complete=EO);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EO(){}const RMe=1e3,zMe=2,DMe=144e5,HMe=.5;function SO(r,e=RMe,t=zMe){const n=e*Math.pow(t,r),i=Math.round(HMe*n*(Math.random()-.5)*2);return Math.min(DMe,n+i)}function _r(r){return r&&r._delegate?r._delegate:r}class Bo{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const H6="[DEFAULT]";class FMe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Om;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function GMe(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:H6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=H6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return M(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=H6){return this.instances.has(e)}getOptions(e=H6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(o)&&s.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===H6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=H6){return this.component?this.component.multipleInstances?e:H6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class BMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FMe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const OO=[];var Wn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Wn||{});const Zq={debug:Wn.DEBUG,verbose:Wn.VERBOSE,info:Wn.INFO,warn:Wn.WARN,error:Wn.ERROR,silent:Wn.SILENT},UMe=Wn.INFO,WMe={[Wn.DEBUG]:"log",[Wn.VERBOSE]:"log",[Wn.INFO]:"info",[Wn.WARN]:"warn",[Wn.ERROR]:"error"},qMe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=WMe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class d5{constructor(e){this.name=e,this._logLevel=UMe,this._logHandler=qMe,this._userLogHandler=null,OO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Zq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wn.DEBUG,...e),this._logHandler(this,Wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wn.VERBOSE,...e),this._logHandler(this,Wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wn.INFO,...e),this._logHandler(this,Wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wn.WARN,...e),this._logHandler(this,Wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wn.ERROR,...e),this._logHandler(this,Wn.ERROR,...e)}}const jMe=(r,e)=>e.some(t=>r instanceof t);let Yq,Kq;const Xq=new WeakMap,TO=new WeakMap,Qq=new WeakMap,bO=new WeakMap,wO=new WeakMap;let NO={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return TO.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Qq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ll(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function eEe(r){return"function"==typeof r?function JMe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function YMe(){return Kq||(Kq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(AO(this),e),ll(Xq.get(this))}:function(...e){return ll(r.apply(AO(this),e))}:function(e,...t){const n=r.call(AO(this),e,...t);return Qq.set(n,e.sort?e.sort():[e]),ll(n)}}(r):(r instanceof IDBTransaction&&function XMe(r){if(TO.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});TO.set(r,e)}(r),jMe(r,function ZMe(){return Yq||(Yq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,NO):r)}function ll(r){if(r instanceof IDBRequest)return function KMe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(ll(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&Xq.set(t,r)}).catch(()=>{}),wO.set(e,r),e}(r);if(bO.has(r))return bO.get(r);const e=eEe(r);return e!==r&&(bO.set(r,e),wO.set(e,r)),e}const AO=r=>wO.get(r),nEe=["get","getKey","getAll","getAllKeys","count"],rEe=["put","add","delete","clear"],IO=new Map;function Jq(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(IO.get(e))return IO.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=rEe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!nEe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return IO.set(e,o),o}!function QMe(r){NO=r(NO)}(r=>({...r,get:(e,t,n)=>Jq(e,t)||r.get(e,t,n),has:(e,t)=>!!Jq(e,t)||r.has(e,t)}));class iEe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function oEe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const kO="@firebase/app",V6=new d5("@firebase/app"),wm="[DEFAULT]",IEe={[kO]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},F6=new Map,Nm=new Map;function kEe(r,e){try{r.container.addComponent(e)}catch(t){V6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function vs(r){const e=r.name;if(Nm.has(e))return V6.debug(`There were multiple attempts to register component ${e}.`),!1;Nm.set(e,r);for(const t of F6.values())kEe(t,r);return!0}function h5(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const Y3=new Gc("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class LEe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Y3.create("app-deleted",{appName:this._name})}}const $6="9.23.0";function tj(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:wm,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw Y3.create("bad-app-name",{appName:String(i)});if(t||(t=Uq()),!t)throw Y3.create("no-options");const o=F6.get(i);if(o){if(bm(t,o.options)&&bm(n,o.config))return o;throw Y3.create("duplicate-app",{appName:i})}const s=new BMe(i);for(const c of Nm.values())s.addComponent(c);const a=new LEe(t,n,s);return F6.set(i,a),a}function xO(r=wm){const e=F6.get(r);if(!e&&r===wm&&Uq())return tj();if(!e)throw Y3.create("no-app",{appName:r});return e}function nj(){return Array.from(F6.values())}function vr(r,e,t){var n;let i=null!==(n=IEe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];return o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void V6.warn(a.join(" "))}vs(new Bo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const REe="firebase-heartbeat-database",zEe=1,jf="firebase-heartbeat-store";let RO=null;function rj(){return RO||(RO=function tEe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=ll(s);return n&&s.addEventListener("upgradeneeded",c=>{n(ll(s.result),c.oldVersion,c.newVersion,ll(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(REe,zEe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(jf)}}).catch(r=>{throw Y3.create("idb-open",{originalErrorMessage:r.message})})),RO}function zO(){return(zO=M(function*(r){try{return yield(yield rj()).transaction(jf).objectStore(jf).get(oj(r))}catch(e){if(e instanceof T2)V6.warn(e.message);else{const t=Y3.create("idb-get",{originalErrorMessage:e?.message});V6.warn(t.message)}}})).apply(this,arguments)}function ij(r,e){return DO.apply(this,arguments)}function DO(){return(DO=M(function*(r,e){try{const n=(yield rj()).transaction(jf,"readwrite");yield n.objectStore(jf).put(e,oj(r)),yield n.done}catch(t){if(t instanceof T2)V6.warn(t.message);else{const n=Y3.create("idb-set",{originalErrorMessage:t?.message});V6.warn(n.message)}}})).apply(this,arguments)}function oj(r){return`${r.name}!${r.options.appId}`}class FEe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GEe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return M(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=sj();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(o=>o.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(o=>{const s=new Date(o.date).valueOf();return Date.now()-s<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return M(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=sj(),{heartbeatsToSend:n,unsentEntries:i}=function $Ee(r,e=1024){const t=[];let n=r.slice();for(const i of r){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),aj(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),aj(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),o=Em(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),o})()}}function sj(){return(new Date).toISOString().substring(0,10)}class GEe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!D6()&&Bf().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return M(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function DEe(r){return zO.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return ij(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return ij(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}})()}}function aj(r){return Em(JSON.stringify({version:2,heartbeats:r})).length}!function BEe(r){vs(new Bo("platform-logger",e=>new iEe(e),"PRIVATE")),vs(new Bo("heartbeat",e=>new FEe(e),"PRIVATE")),vr(kO,"0.9.13",r),vr(kO,"0.9.13","esm2017"),vr("fire-js","")}(""),vr("firebase","9.23.0","app");const qEe=(r,e)=>e.some(t=>r instanceof t);let cj,lj;const uj=new WeakMap,HO=new WeakMap,fj=new WeakMap,VO=new WeakMap,FO=new WeakMap;let $O={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return HO.get(r);if("objectStoreNames"===e)return r.objectStoreNames||fj.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ul(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function JEe(r){return"function"==typeof r?function QEe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ZEe(){return lj||(lj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(GO(this),e),ul(uj.get(this))}:function(...e){return ul(r.apply(GO(this),e))}:function(e,...t){const n=r.call(GO(this),e,...t);return fj.set(n,e.sort?e.sort():[e]),ul(n)}}(r):(r instanceof IDBTransaction&&function KEe(r){if(HO.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});HO.set(r,e)}(r),qEe(r,function jEe(){return cj||(cj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,$O):r)}function ul(r){if(r instanceof IDBRequest)return function YEe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(ul(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&uj.set(t,r)}).catch(()=>{}),FO.set(e,r),e}(r);if(VO.has(r))return VO.get(r);const e=JEe(r);return e!==r&&(VO.set(r,e),FO.set(e,r)),e}const GO=r=>FO.get(r),tPe=["get","getKey","getAll","getAllKeys","count"],nPe=["put","add","delete","clear"],BO=new Map;function dj(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(BO.get(e))return BO.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=nPe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!tPe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return BO.set(e,o),o}!function XEe(r){$O=r($O)}(r=>({...r,get:(e,t,n)=>dj(e,t)||r.get(e,t,n),has:(e,t)=>!!dj(e,t)||r.has(e,t)}));const hj="@firebase/installations",UO="0.6.4",gj=1e4,pj=`w:${UO}`,mj="FIS_v2",rPe="https://firebaseinstallations.googleapis.com/v1",iPe=36e5,K3=new Gc("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function _j(r){return r instanceof T2&&r.code.includes("request-failed")}function WO({projectId:r}){return`${rPe}/projects/${r}/installations`}function vj(r){return{token:r.token,requestStatus:2,expiresIn:cPe(r.expiresIn),creationTime:Date.now()}}function qO(r,e){return jO.apply(this,arguments)}function jO(){return(jO=M(function*(r,e){const n=(yield e.json()).error;return K3.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})})).apply(this,arguments)}function Cj({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function ZO(r){return YO.apply(this,arguments)}function YO(){return(YO=M(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e})).apply(this,arguments)}function cPe(r){return Number(r.replace("s","000"))}function KO(){return(KO=M(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=WO(r),i=Cj(r),o=e.getImmediate({optional:!0});if(o){const l=yield o.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:mj,appId:r.appId,sdkVersion:pj})},c=yield ZO(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:vj(l.authToken)}}throw yield qO("Create Installation",c)})).apply(this,arguments)}function Mj(r){return new Promise(e=>{setTimeout(e,r)})}const dPe=/^[cdef][\w-]{21}$/,XO="";function hPe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function gPe(r){return function fPe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return dPe.test(t)?t:XO}catch{return XO}}function g5(r){return`${r.appName}!${r.appId}`}const p5=new Map;function Ej(r,e){const t=g5(r);Pj(t,e),function _Pe(r,e){const t=function Sj(){return!G6&&"BroadcastChannel"in self&&(G6=new BroadcastChannel("[Firebase] FID Change"),G6.onmessage=r=>{Pj(r.data.key,r.data.fid)}),G6}();t&&t.postMessage({key:r,fid:e}),function Oj(){0===p5.size&&G6&&(G6.close(),G6=null)}()}(t,e)}function Pj(r,e){const t=p5.get(r);if(t)for(const n of t)n(e)}let G6=null;const vPe="firebase-installations-database",CPe=1,B6="firebase-installations-store";let QO=null;function JO(){return QO||(QO=function ePe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=ul(s);return n&&s.addEventListener("upgradeneeded",c=>{n(ul(s.result),c.oldVersion,c.newVersion,ul(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(vPe,CPe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(B6)}})),QO}function Am(r,e){return eT.apply(this,arguments)}function eT(){return(eT=M(function*(r,e){const t=g5(r),i=(yield JO()).transaction(B6,"readwrite"),o=i.objectStore(B6),s=yield o.get(t);return yield o.put(e,t),yield i.done,(!s||s.fid!==e.fid)&&Ej(r,e.fid),e})).apply(this,arguments)}function tT(r){return nT.apply(this,arguments)}function nT(){return(nT=M(function*(r){const e=g5(r),n=(yield JO()).transaction(B6,"readwrite");yield n.objectStore(B6).delete(e),yield n.done})).apply(this,arguments)}function Zf(r,e){return rT.apply(this,arguments)}function rT(){return(rT=M(function*(r,e){const t=g5(r),i=(yield JO()).transaction(B6,"readwrite"),o=i.objectStore(B6),s=yield o.get(t),a=e(s);return void 0===a?yield o.delete(t):yield o.put(a,t),yield i.done,a&&(!s||s.fid!==a.fid)&&Ej(r,a.fid),a})).apply(this,arguments)}function iT(r){return oT.apply(this,arguments)}function oT(){return oT=M(function*(r){let e;const t=yield Zf(r.appConfig,n=>{const i=function yPe(r){return bj(r||{fid:hPe(),registrationStatus:0})}(n),o=function MPe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(K3.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function EPe(r,e){return sT.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:PPe(r)}:{installationEntry:e}}(r,i);return e=o.registrationPromise,o.installationEntry});return t.fid===XO?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),oT.apply(this,arguments)}function sT(){return sT=M(function*(r,e){try{const t=yield function uPe(r,e){return KO.apply(this,arguments)}(r,e);return Am(r.appConfig,t)}catch(t){throw _j(t)&&409===t.customData.serverCode?yield tT(r.appConfig):yield Am(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),sT.apply(this,arguments)}function PPe(r){return aT.apply(this,arguments)}function aT(){return(aT=M(function*(r){let e=yield Tj(r.appConfig);for(;1===e.registrationStatus;)yield Mj(100),e=yield Tj(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield iT(r);return n||t}return e})).apply(this,arguments)}function Tj(r){return Zf(r,e=>{if(!e)throw K3.create("installation-not-found");return bj(e)})}function bj(r){return function SPe(r){return 1===r.registrationStatus&&r.registrationTime+gj<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function cT(){return(cT=M(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function TPe(r,{fid:e}){return`${WO(r)}/${e}/authTokens:generate`}(r,t),i=function yj(r,{refreshToken:e}){const t=Cj(r);return t.append("Authorization",function lPe(r){return`${mj} ${r}`}(e)),t}(r,t),o=e.getImmediate({optional:!0});if(o){const l=yield o.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:pj,appId:r.appId}})},c=yield ZO(()=>fetch(n,a));if(c.ok)return vj(yield c.json());throw yield qO("Generate Auth Token",c)})).apply(this,arguments)}function lT(r){return uT.apply(this,arguments)}function uT(){return uT=M(function*(r,e=!1){let t;const n=yield Zf(r.appConfig,o=>{if(!Nj(o))throw K3.create("not-registered");const s=o.authToken;if(!e&&function NPe(r){return 2===r.requestStatus&&!function APe(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+iPe}(r)}(s))return o;if(1===s.requestStatus)return t=function bPe(r,e){return fT.apply(this,arguments)}(r,e),o;{if(!navigator.onLine)throw K3.create("app-offline");const a=function IPe(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(o);return t=function wPe(r,e){return dT.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),uT.apply(this,arguments)}function fT(){return(fT=M(function*(r,e){let t=yield wj(r.appConfig);for(;1===t.authToken.requestStatus;)yield Mj(100),t=yield wj(r.appConfig);const n=t.authToken;return 0===n.requestStatus?lT(r,e):n})).apply(this,arguments)}function wj(r){return Zf(r,e=>{if(!Nj(e))throw K3.create("not-registered");return function kPe(r){return 1===r.requestStatus&&r.requestTime+gj<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function dT(){return dT=M(function*(r,e){try{const t=yield function OPe(r,e){return cT.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield Am(r.appConfig,n),t}catch(t){if(!_j(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield Am(r.appConfig,n)}else yield tT(r.appConfig);throw t}}),dT.apply(this,arguments)}function Nj(r){return void 0!==r&&2===r.registrationStatus}function hT(){return(hT=M(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield iT(e);return n?n.catch(console.error):lT(e).catch(console.error),t.fid})).apply(this,arguments)}function gT(){return gT=M(function*(r,e=!1){const t=r;return yield function RPe(r){return pT.apply(this,arguments)}(t),(yield lT(t,e)).token}),gT.apply(this,arguments)}function pT(){return(pT=M(function*(r){const{registrationPromise:e}=yield iT(r);e&&(yield e)})).apply(this,arguments)}function vT(r){return K3.create("missing-app-config-values",{valueName:r})}const Aj="installations",FPe=r=>{const e=r.getProvider("app").getImmediate(),t=function HPe(r){if(!r||!r.options)throw vT("App Configuration");if(!r.name)throw vT("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw vT(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:h5(e,"heartbeat"),_delete:()=>Promise.resolve()}},$Pe=r=>{const t=h5(r.getProvider("app").getImmediate(),Aj).getImmediate();return{getId:()=>function xPe(r){return hT.apply(this,arguments)}(t),getToken:i=>function LPe(r){return gT.apply(this,arguments)}(t,i)}};(function GPe(){vs(new Bo(Aj,FPe,"PUBLIC")),vs(new Bo("installations-internal",$Pe,"PRIVATE"))})(),vr(hj,UO),vr(hj,UO,"esm2017");const CT="@firebase/remote-config",Ks=new Gc("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class JPe{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const o=yield t.client.fetch(e),s=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===o.status&&s.push(t.storage.setLastSuccessfulFetchResponse(o)),yield Promise.all(s),o})()}}function eSe(r=navigator){return r.languages&&r.languages[0]||r.language}class tSe{constructor(e,t,n,i,o,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=o,this.appId=s}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:eSe()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(s,l),d=new Promise((G,B)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",B(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch(G){let B="fetch-client-network";throw"AbortError"===G?.name&&(B="fetch-timeout"),Ks.create(B,{originalErrorMessage:G?.message})}let E=m.status;const T=m.headers.get("ETag")||void 0;let L,z;if(200===m.status){let G;try{G=yield m.json()}catch(B){throw Ks.create("fetch-client-parse",{originalErrorMessage:B?.message})}L=G.entries,z=G.state}if("INSTANCE_STATE_UNSPECIFIED"===z?E=500:"NO_CHANGE"===z?E=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(L={}),304!==E&&200!==E)throw Ks.create("fetch-status",{httpStatus:E});return{status:E,eTag:T,config:L}})()}}class iSe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return M(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return M(function*(){yield function nSe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),o=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(o),n(Ks.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const o=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),o}catch(o){if(!function rSe(r){if(!(r instanceof T2&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(o))throw o;const s={throttleEndTimeMillis:Date.now()+SO(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(s),i.attemptFetch(e,s)}})()}}class aSe{constructor(e,t,n,i,o){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function km(r,e){const t=r.target.error||void 0;return Ks.create(e,{originalErrorMessage:t&&t?.message})}const U6="app_namespace_store";class fSe{constructor(e,t,n,i=function uSe(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(km(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(U6,{keyPath:"compositeKey"})}}catch(t){e(Ks.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,o)=>{const a=n.transaction([U6],"readonly").objectStore(U6),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{o(km(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){o(Ks.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return M(function*(){const i=yield n.openDbPromise;return new Promise((o,s)=>{const c=i.transaction([U6],"readwrite").objectStore(U6),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{s(km(d,"storage-set"))},f.onsuccess=()=>{o()}}catch(f){s(Ks.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,o)=>{const a=n.transaction([U6],"readwrite").objectStore(U6),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{o(km(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){o(Ks.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class dSe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return M(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),o=yield t;o&&(e.lastFetchStatus=o);const s=yield n;s&&(e.lastSuccessfulFetchTimestampMillis=s);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function gSe(){return ST.apply(this,arguments)}function ST(){return(ST=M(function*(){if(!D6())return!1;try{return yield Bf()}catch{return!1}})).apply(this,arguments)}!function hSe(){vs(new Bo("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ks.create("registration-window");if(!D6())throw Ks.create("indexed-db-unavailable");const{projectId:o,apiKey:s,appId:a}=n.options;if(!o)throw Ks.create("registration-project-id");if(!s)throw Ks.create("registration-api-key");if(!a)throw Ks.create("registration-app-id");const c=new fSe(a,n.name,t=t||"firebase"),l=new dSe(c),f=new d5(CT);f.logLevel=Wn.ERROR;const d=new tSe(i,$6,t,o,s,a),m=new iSe(d,c),E=new JPe(m,c,l,f),T=new aSe(n,E,l,c,f);return function KPe(r){const e=_r(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(T),T},"PUBLIC").setMultipleInstances(!0)),vr(CT,"0.4.4"),vr(CT,"0.4.4","esm2017")}();const pSe=(r,e)=>e.some(t=>r instanceof t);let Lj,Rj;const zj=new WeakMap,OT=new WeakMap,Dj=new WeakMap,TT=new WeakMap,bT=new WeakMap;let wT={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return OT.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Dj.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return X3(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function ESe(r){return"function"==typeof r?function MSe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function _Se(){return Rj||(Rj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(NT(this),e),X3(zj.get(this))}:function(...e){return X3(r.apply(NT(this),e))}:function(e,...t){const n=r.call(NT(this),e,...t);return Dj.set(n,e.sort?e.sort():[e]),X3(n)}}(r):(r instanceof IDBTransaction&&function CSe(r){if(OT.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});OT.set(r,e)}(r),pSe(r,function mSe(){return Lj||(Lj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,wT):r)}function X3(r){if(r instanceof IDBRequest)return function vSe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(X3(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&zj.set(t,r)}).catch(()=>{}),bT.set(e,r),e}(r);if(TT.has(r))return TT.get(r);const e=ESe(r);return e!==r&&(TT.set(r,e),bT.set(e,r)),e}const NT=r=>bT.get(r);function Hj(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=X3(s);return n&&s.addEventListener("upgradeneeded",c=>{n(X3(s.result),c.oldVersion,c.newVersion,X3(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function AT(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),X3(t).then(()=>{})}const PSe=["get","getKey","getAll","getAllKeys","count"],SSe=["put","add","delete","clear"],IT=new Map;function Vj(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(IT.get(e))return IT.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=SSe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!PSe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return IT.set(e,o),o}!function ySe(r){wT=r(wT)}(r=>({...r,get:(e,t,n)=>Vj(e,t)||r.get(e,t,n),has:(e,t)=>!!Vj(e,t)||r.has(e,t)}));const OSe="/firebase-messaging-sw.js",TSe="/firebase-cloud-messaging-push-scope",Fj="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",bSe="https://fcmregistrations.googleapis.com/v1",$j="google.c.a.c_id",wSe="google.c.a.c_l",NSe="google.c.a.ts";var xm=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(xm||{});function Q3(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function kSe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let o=0;o<n.length;++o)i[o]=n.charCodeAt(o);return i}const kT="fcm_token_details_db",xSe=5,Gj="fcm_token_object_Store";function xT(){return xT=M(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(kT))return null;let e=null;return(yield Hj(kT,xSe,{upgrade:(n=M(function*(i,o,s,a){var c;if(o<2||!i.objectStoreNames.contains(Gj))return;const l=a.objectStore(Gj),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===o){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:Q3(d.vapidKey)}}}else if(3===o){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Q3(d.auth),p256dh:Q3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Q3(d.vapidKey)}}}else if(4===o){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Q3(d.auth),p256dh:Q3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Q3(d.vapidKey)}}}}),function(o,s,a,c){return n.apply(this,arguments)})})).close(),yield AT(kT),yield AT("fcm_vapid_details_db"),yield AT("undefined"),function RSe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),xT.apply(this,arguments)}const zSe="firebase-messaging-database",DSe=1,W6="firebase-messaging-store";let LT=null;function RT(){return LT||(LT=Hj(zSe,DSe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(W6)}})),LT}function Bj(r){return zT.apply(this,arguments)}function zT(){return zT=M(function*(r){const e=FT(r),n=yield(yield RT()).transaction(W6).objectStore(W6).get(e);if(n)return n;{const i=yield function LSe(r){return xT.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield DT(r,i),i}}),zT.apply(this,arguments)}function DT(r,e){return HT.apply(this,arguments)}function HT(){return(HT=M(function*(r,e){const t=FT(r),i=(yield RT()).transaction(W6,"readwrite");return yield i.objectStore(W6).put(e,t),yield i.done,e})).apply(this,arguments)}function VT(){return(VT=M(function*(r){const e=FT(r),n=(yield RT()).transaction(W6,"readwrite");yield n.objectStore(W6).delete(e),yield n.done})).apply(this,arguments)}function FT({appConfig:r}){return r.appId}const fo=new Gc("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function FSe(r,e){return $T.apply(this,arguments)}function $T(){return($T=M(function*(r,e){const t=yield WT(r),n=Wj(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let o;try{o=yield(yield fetch(UT(r.appConfig),i)).json()}catch(s){throw fo.create("token-subscribe-failed",{errorInfo:s?.toString()})}if(o.error)throw fo.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw fo.create("token-subscribe-no-token");return o.token})).apply(this,arguments)}function GT(){return(GT=M(function*(r,e){const t=yield WT(r),n=Wj(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let o;try{o=yield(yield fetch(`${UT(r.appConfig)}/${e.token}`,i)).json()}catch(s){throw fo.create("token-update-failed",{errorInfo:s?.toString()})}if(o.error)throw fo.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw fo.create("token-update-no-token");return o.token})).apply(this,arguments)}function Uj(r,e){return BT.apply(this,arguments)}function BT(){return(BT=M(function*(r,e){const n={method:"DELETE",headers:yield WT(r)};try{const o=yield(yield fetch(`${UT(r.appConfig)}/${e}`,n)).json();if(o.error)throw fo.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw fo.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})).apply(this,arguments)}function UT({projectId:r}){return`${bSe}/projects/${r}/registrations`}function WT(r){return qT.apply(this,arguments)}function qT(){return(qT=M(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})})).apply(this,arguments)}function Wj({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==Fj&&(i.web.applicationPubKey=n),i}const GSe=6048e5;function jT(){return jT=M(function*(r){const e=yield function WSe(r,e){return XT.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:Q3(e.getKey("auth")),p256dh:Q3(e.getKey("p256dh"))},n=yield Bj(r.firebaseDependencies);if(n){if(function qSe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+GSe?function USe(r,e){return YT.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield Uj(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return jj(r.firebaseDependencies,t)}return jj(r.firebaseDependencies,t)}),jT.apply(this,arguments)}function ZT(){return ZT=M(function*(r){const e=yield Bj(r.firebaseDependencies);e&&(yield Uj(r.firebaseDependencies,e.token),yield function HSe(r){return VT.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),ZT.apply(this,arguments)}function YT(){return YT=M(function*(r,e){try{const t=yield function $Se(r,e){return GT.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield DT(r.firebaseDependencies,n),t}catch(t){throw yield function qj(r){return ZT.apply(this,arguments)}(r),t}}),YT.apply(this,arguments)}function jj(r,e){return KT.apply(this,arguments)}function KT(){return(KT=M(function*(r,e){const n={token:yield FSe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield DT(r,n),n.token})).apply(this,arguments)}function XT(){return(XT=M(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:kSe(e)})})).apply(this,arguments)}function Zj(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function jSe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const o=e.notification.icon;o&&(r.notification.icon=o)}(e,r),function ZSe(r,e){e.data&&(r.data=e.data)}(e,r),function YSe(r,e){var t,n,i,o,s;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(o=e.notification)||void 0===o?void 0:o.click_action;a&&(r.fcmOptions.link=a);const c=null===(s=e.fcmOptions)||void 0===s?void 0:s.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function Yj(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function QT(r){return fo.create("missing-app-config-values",{valueName:r})}Yj("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Yj("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class QSe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function XSe(r){if(!r||!r.options)throw QT("App Configuration Object");if(!r.name)throw QT("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw QT(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function JT(){return(JT=M(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(OSe,{scope:TSe}),r.swRegistration.update().catch(()=>{})}catch(e){throw fo.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})).apply(this,arguments)}function eb(){return(eb=M(function*(r,e){if(!e&&!r.swRegistration&&(yield function Kj(r){return JT.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw fo.create("invalid-sw-registration");r.swRegistration=e}})).apply(this,arguments)}function tb(){return(tb=M(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=Fj)})).apply(this,arguments)}function nb(){return nb=M(function*(r,e){if(!navigator)throw fo.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw fo.create("permission-blocked");return yield function eOe(r,e){return tb.apply(this,arguments)}(r,e?.vapidKey),yield function JSe(r,e){return eb.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function BSe(r){return jT.apply(this,arguments)}(r)}),nb.apply(this,arguments)}function rb(){return(rb=M(function*(r,e,t){const n=function nOe(r){switch(r){case xm.NOTIFICATION_CLICKED:return"notification_open";case xm.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[$j],message_name:t[wSe],message_time:t[NSe],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function ib(){return ib=M(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===xm.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(Zj(t)):r.onMessageHandler.next(Zj(t)));const n=t.data;(function KSe(r){return"object"==typeof r&&!!r&&$j in r})(n)&&"1"===n["google.c.a.e"]&&(yield function tOe(r,e,t){return rb.apply(this,arguments)}(r,t.messageType,n))}),ib.apply(this,arguments)}const Qj="@firebase/messaging",iOe=r=>{const e=new QSe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function rOe(r,e){return ib.apply(this,arguments)}(e,t)),e},oOe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function Xj(r,e){return nb.apply(this,arguments)}(e,n)}};function eZ(){return ob.apply(this,arguments)}function ob(){return(ob=M(function*(){try{yield Bf()}catch{return!1}return typeof window<"u"&&D6()&&MO()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function sOe(){vs(new Bo("messaging",iOe,"PUBLIC")),vs(new Bo("messaging-internal",oOe,"PRIVATE")),vr(Qj,"0.12.4"),vr(Qj,"0.12.4","esm2017")}();const Lm="analytics",lOe="firebase_id",uOe="origin",fOe=6e4,dOe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",cb="https://www.googletagmanager.com/gtag/js",Li=new d5("@firebase/analytics"),Cs=new Gc("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function gOe(r){if(!r.startsWith(cb)){const e=Cs.create("invalid-gtag-resource",{gtagURL:r});return Li.warn(e.message),""}return r}function tZ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function lb(){return(lb=M(function*(r,e,t,n,i,o){const s=n[i];try{if(s)yield e[s];else{const c=(yield tZ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){Li.error(a)}r("config",i,o)})).apply(this,arguments)}function ub(){return(ub=M(function*(r,e,t,n,i){try{let o=[];if(i&&i.send_to){let s=i.send_to;Array.isArray(s)||(s=[s]);const a=yield tZ(t);for(const c of s){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){o=[];break}o.push(f)}}0===o.length&&(o=Object.values(e)),yield Promise.all(o),r("event",n,i||{})}catch(o){Li.error(o)}})).apply(this,arguments)}const POe=30,nZ=new class OOe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function TOe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function fb(){return(fb=M(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:TOe(n)},o=dOe.replace("{app-id}",t),s=yield fetch(o,i);if(200!==s.status&&304!==s.status){let a="";try{const c=yield s.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw Cs.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()})).apply(this,arguments)}function db(){return(db=M(function*(r,e=nZ,t){const{appId:n,apiKey:i,measurementId:o}=r.options;if(!n)throw Cs.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:n};throw Cs.create("no-api-key")}const s=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new IOe;return setTimeout(M(function*(){a.abort()}),void 0!==t?t:fOe),rZ({appId:n,apiKey:i,measurementId:o},s,a,e)})).apply(this,arguments)}function rZ(r,e,t){return hb.apply(this,arguments)}function hb(){return hb=M(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=nZ){var o;const{appId:s,measurementId:a}=r;try{yield function NOe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),o=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(o),n(Cs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return Li.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:s,measurementId:a};throw c}try{const c=yield function bOe(r){return fb.apply(this,arguments)}(r);return i.deleteThrottleMetadata(s),c}catch(c){const l=c;if(!function AOe(r){if(!(r instanceof T2&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(s),a)return Li.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:s,measurementId:a};throw c}const f=503===Number(null===(o=l?.customData)||void 0===o?void 0:o.httpStatus)?SO(t,i.intervalMillis,POe):SO(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(s,d),Li.debug(`Calling attemptFetch again in ${f} millis`),rZ(r,d,n,i)}}),hb.apply(this,arguments)}class IOe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let gb,Mb;function pb(){return(pb=M(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const o=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:o}))}})).apply(this,arguments)}function Eb(){return(Eb=M(function*(){if(!D6())return Li.warn(Cs.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Bf()}catch(r){return Li.warn(Cs.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0})).apply(this,arguments)}function Pb(){return Pb=M(function*(r,e,t,n,i,o,s){var a;const c=function wOe(r){return db.apply(this,arguments)}(r);c.then(E=>{t[E.measurementId]=E.appId,r.options.measurementId&&E.measurementId!==r.options.measurementId&&Li.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>Li.error(E)),e.push(c);const l=function HOe(){return Eb.apply(this,arguments)}().then(E=>{if(E)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function EOe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(cb)&&t.src.includes(r))return t;return null})(o)||function mOe(r,e){const t=function pOe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:gOe}),n=document.createElement("script"),i=`${cb}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(o,f.measurementId),Mb&&(i("consent","default",Mb),function iZ(r){Mb=r}(void 0)),i("js",new Date);const m=null!==(a=s?.config)&&void 0!==a?a:{};return m[uOe]="firebase",m.update=!0,null!=d&&(m[lOe]=d),i("config",f.measurementId,m),gb&&(i("set",gb),function oZ(r){gb=r}(void 0)),f.measurementId}),Pb.apply(this,arguments)}class FOe{constructor(e){this.app=e}_delete(){return delete Bc[this.app.options.appId],Promise.resolve()}}let Bc={},sZ=[];const aZ={};let lZ,Uc,Rm="dataLayer",Sb=!1;function GOe(r,e,t){!function $Oe(){const r=[];if(yO()&&r.push("This is a browser extension environment."),MO()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=Cs.create("invalid-analytics-context",{errorInfo:e});Li.warn(t.message)}}();const n=r.options.appId;if(!n)throw Cs.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw Cs.create("no-api-key");Li.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Bc[n])throw Cs.create("already-exists",{id:n});if(!Sb){!function _Oe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(Rm);const{wrappedGtag:o,gtagCore:s}=function MOe(r,e,t,n,i){let o=function(...s){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function yOe(r,e,t,n){function o(){return o=M(function*(s,...a){try{if("event"===s){const[c,l]=a;yield function COe(r,e,t,n,i){return ub.apply(this,arguments)}(r,e,t,c,l)}else if("config"===s){const[c,l]=a;yield function vOe(r,e,t,n,i,o){return lb.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===s){const[c]=a;r("consent","update",c)}else if("get"===s){const[c,l,f]=a;r("get",c,l,f)}else if("set"===s){const[c]=a;r("set",c)}else r(s,...a)}catch(c){Li.error(c)}}),o.apply(this,arguments)}return function i(s){return o.apply(this,arguments)}}(o,r,e,t),{gtagCore:o,wrappedGtag:window[i]}}(Bc,sZ,aZ,Rm,"gtag");Uc=o,lZ=s,Sb=!0}return Bc[n]=function VOe(r,e,t,n,i,o,s){return Pb.apply(this,arguments)}(r,sZ,aZ,e,lZ,Rm,t),new FOe(r)}function UOe(){return Ob.apply(this,arguments)}function Ob(){return(Ob=M(function*(){if(yO()||!MO()||!D6())return!1;try{return yield Bf()}catch{return!1}})).apply(this,arguments)}const uZ="@firebase/analytics";!function qOe(){vs(new Bo(Lm,(e,{options:t})=>GOe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),vs(new Bo("analytics-internal",function r(e){try{const t=e.getProvider(Lm).getImmediate();return{logEvent:(n,i,o)=>function WOe(r,e,t,n){r=_r(r),function kOe(r,e,t,n,i){return pb.apply(this,arguments)}(Uc,Bc[r.app.options.appId],e,t,n).catch(i=>Li.error(i))}(t,n,i,o)}}catch(t){throw Cs.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),vr(uZ,"0.10.0"),vr(uZ,"0.10.0","esm2017")}();class jOe extends On{constructor(e,t){super()}schedule(e,t=0){return this}}const zm={setInterval(r,e,...t){const{delegate:n}=zm;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=zm;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class dZ extends jOe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,n=0){return zm.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&zm.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(o){n=!0,i=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,O3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const bb={now:()=>(bb.delegate||Date).now(),delegate:void 0};class Yf{constructor(e,t=Yf.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Yf.now=bb.now;class hZ extends Yf{constructor(e,t=Yf.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const KOe=new class YOe extends hZ{}(class ZOe extends dZ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),XOe=new hZ(dZ),Dm=new I8("7.6.1"),wb="__angularfire_symbol__analyticsIsSupportedValue",Nb="__angularfire_symbol__analyticsIsSupported",Ab="__angularfire_symbol__remoteConfigIsSupportedValue",Ib="__angularfire_symbol__remoteConfigIsSupported",kb="__angularfire_symbol__messagingIsSupportedValue",xb="__angularfire_symbol__messagingIsSupported";function Rb(r,e,t){if(e){if(1===e.length)return e[0];const o=e.filter(s=>s.app===t);if(1===o.length)return o[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[Nb]||(globalThis[Nb]=UOe().then(r=>globalThis[wb]=r).catch(()=>globalThis[wb]=!1)),globalThis[xb]||(globalThis[xb]=eZ().then(r=>globalThis[kb]=r).catch(()=>globalThis[kb]=!1)),globalThis[Ib]||(globalThis[Ib]=gSe().then(r=>globalThis[Ab]=r).catch(()=>globalThis[Ab]=!1));const zb=(r,e)=>{const t=e?[e]:nj(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(s=>{n.includes(s)||n.push(s)})}),n};function m5(){}class gZ{constructor(e,t=KOe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(s){i.runGuarded(()=>{e.apply(this,[s])})},t,n)}}class QOe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",m5,{},m5,m5)),t.pipe(Go({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Db=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new gZ(Zone.current)),this.insideAngular=t.run(()=>new gZ(Zone.current,XOe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function q6(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function j6(r){return q6().ngZone.run(()=>r())}function eTe(r){return q6(),function tTe(r){return function(t){return(t=t.lift(new QOe(r.ngZone))).pipe(xh(r.outsideAngular),kh(r.insideAngular))}}(q6())(r)}const nTe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),j6(()=>r.apply(void 0,n))},z1=(r,e)=>function(){let t;const n=arguments;for(let o=0;o<arguments.length;o++)"function"==typeof n[o]&&(e&&(t||(t=j6(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",m5,{},m5,m5)))),n[o]=nTe(n[o],t));const i=function JOe(r){return q6().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof O1){const o=q6();return i.pipe(xh(o.outsideAngular),kh(o.insideAngular))}return j6(()=>i)}return i instanceof O1?i.pipe(eTe):i instanceof Promise?j6(()=>new Promise((o,s)=>i.then(a=>j6(()=>o(a)),a=>j6(()=>s(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:j6(()=>i)};class _5{constructor(e){return e}}class Hb{constructor(){return nj()}}const Vb=new et("angularfire2._apps"),iTe={provide:_5,useFactory:function rTe(r){return r&&1===r.length?r[0]:new _5(xO())},deps:[[new ds,Vb]]},oTe={provide:Hb,deps:[[new ds,Vb]]};function sTe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new _5(n)}}let aTe=(()=>{class r{constructor(t){vr("angularfire",Dm.full,"core"),vr("angularfire",Dm.full,"app"),vr("angular",BH.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Oe(z3))},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:[iTe,oTe]}),r})();const lTe=z1(tj,!0),Fb=new Map,pZ={activated:!1,tokenObservers:[]},uTe={initialized:!1,enabled:!1};function Cr(r){return Fb.get(r)||Object.assign({},pZ)}function Hm(){return uTe}const $b="https://content-firebaseappcheck.googleapis.com/v1",gTe="exchangeDebugToken",mZ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class mTe{constructor(e,t,n,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return M(function*(){t.stop();try{t.pending=new Om,yield function _Te(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Om,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const ho=new Gc("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Gb(r){if(!Cr(r).activated)throw ho.create("use-before-activation",{appName:r.name})}function $m(r,e){return Ub.apply(this,arguments)}function Ub(){return(Ub=M(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const o={method:"POST",body:JSON.stringify(e),headers:n};let s,a;try{s=yield fetch(r,o)}catch(d){throw ho.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==s.status)throw ho.create("fetch-status-error",{httpStatus:s.status});try{a=yield s.json()}catch(d){throw ho.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw ho.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}})).apply(this,arguments)}function _Z(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${$b}/projects/${t}/apps/${n}:${gTe}?key=${i}`,body:{debug_token:e}}}const MTe="firebase-app-check-database",ETe=1,Kf="firebase-app-check-store";let Gm=null;function Wb(){return(Wb=M(function*(r,e){const n=(yield function CZ(){return Gm||(Gm=new Promise((r,e)=>{try{const t=indexedDB.open(MTe,ETe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(ho.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(Kf,{keyPath:"compositeKey"})}}catch(t){e(ho.create("storage-open",{originalErrorMessage:t?.message}))}}),Gm)}()).transaction(Kf,"readwrite"),o=n.objectStore(Kf).put({compositeKey:r,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},n.onerror=c=>{var l;a(ho.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})})).apply(this,arguments)}const Xf=new d5("@firebase/app-check");function Zb(r,e){return D6()?function STe(r,e){return function yZ(r,e){return Wb.apply(this,arguments)}(function EZ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{Xf.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Kb(){return Hm().enabled}function Xb(){return Qb.apply(this,arguments)}function Qb(){return(Qb=M(function*(){const r=Hm();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const ATe={error:"UNKNOWN_ERROR"};function ITe(r){return CO.encodeString(JSON.stringify(r),!1)}function Bm(r){return Jb.apply(this,arguments)}function Jb(){return(Jb=M(function*(r,e=!1){const t=r.app;Gb(t);const n=Cr(t);let o,i=n.token;if(i&&!v5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(v5(c)?i=c:yield Zb(t,void 0))}if(!e&&i&&v5(i))return{token:i.token};let a,s=!1;if(Kb()){n.exchangeTokenPromise||(n.exchangeTokenPromise=$m(_Z(t,yield Xb()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),s=!0);const c=yield n.exchangeTokenPromise;return yield Zb(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),s=!0),i=yield Cr(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?Xf.warn(c.message):Xf.error(c),o=c}return i?o?a=v5(i)?{token:i.token,internalError:o}:TZ(o):(a={token:i.token},n.token=i,yield Zb(t,i)):a=TZ(o),s&&function OZ(r,e){const t=Cr(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a})).apply(this,arguments)}function PZ(r){return ew.apply(this,arguments)}function ew(){return(ew=M(function*(r){const e=r.app;Gb(e);const{provider:t}=Cr(e);if(Kb()){const n=yield Xb(),{token:i}=yield $m(_Z(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}})).apply(this,arguments)}function nw(r,e){const t=Cr(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function SZ(r){const{app:e}=r,t=Cr(e);let n=t.tokenRefresher;n||(n=function kTe(r){const{app:e}=r;return new mTe(M(function*(){let n;if(n=Cr(e).token?yield Bm(r,!0):yield Bm(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=Cr(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},mZ.RETRIAL_MIN_WAIT,mZ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function v5(r){return r.expireTimeMillis-Date.now()>0}function TZ(r){return{token:ITe(ATe),error:r}}class xTe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Cr(this.app);for(const t of e)nw(this.app,t.next);return Promise.resolve()}}const LZ="app-check-internal";!function jTe(){vs(new Bo("app-check",r=>function LTe(r,e){return new xTe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(LZ).initialize()})),vs(new Bo(LZ,r=>function RTe(r){return{getToken:e=>Bm(r,e),getLimitedUseToken:()=>PZ(r),addTokenListener:e=>function tw(r,e,t,n){const{app:i}=r,o=Cr(i);if(o.tokenObservers=[...o.tokenObservers,{next:t,error:n,type:e}],o.token&&v5(o.token)){const a=o.token;Promise.resolve().then(()=>{t({token:a.token}),SZ(r)}).catch(()=>{})}o.cachedTokenPromise.then(()=>SZ(r))}(r,"INTERNAL",e),removeTokenListener:e=>nw(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),vr("@firebase/app-check","0.8.0")}();class sw{constructor(){return zb("app-check")}}typeof window<"u"&&window;const QTe=function zZ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},DZ=new Gc("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Wm=new d5("@firebase/auth");function qm(r,...e){Wm.logLevel<=Wn.ERROR&&Wm.error(`Auth (${$6}): ${r}`,...e)}function Xs(r,...e){throw cw(r,...e)}function b2(r,...e){return cw(r,...e)}function HZ(r,e,t){const n=Object.assign(Object.assign({},QTe()),{[e]:t});return new Gc("auth","Firebase",n).create(e,{appName:r.name})}function cw(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return DZ.create(r,...e)}function He(r,e,...t){if(!r)throw cw(e,...t)}function Wc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw qm(e),new Error(e)}function J3(r,e){r||Wc(e)}function Qf(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function VZ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class Jf{constructor(e,t){this.shortDelay=e,this.longDelay=t,J3(t>e,"Short delay should be less than long delay!"),this.isMobile=function SMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xi())}()||function TMe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function ebe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function lw(){return"http:"===VZ()||"https:"===VZ()}()||yO()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function uw(r,e){J3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class FZ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Wc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Wc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Wc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nbe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},rbe=new Jf(3e4,6e4);function or(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function yr(r,e,t,n){return fw.apply(this,arguments)}function fw(){return(fw=M(function*(r,e,t,n,i={}){return $Z(r,i,M(function*(){let o={},s={};n&&("GET"===e?s=n:o={body:JSON.stringify(n)});const a=Uf(Object.assign({key:r.config.apiKey},s)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),FZ.fetch()(GZ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},o))}))})).apply(this,arguments)}function $Z(r,e,t){return dw.apply(this,arguments)}function dw(){return(dw=M(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},nbe),e);try{const i=new ibe(r),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=yield o.json();if("needConfirmation"in s)throw ed(r,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw ed(r,"credential-already-in-use",s);if("EMAIL_EXISTS"===c)throw ed(r,"email-already-in-use",s);if("USER_DISABLED"===c)throw ed(r,"user-disabled",s);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw HZ(r,f,l);Xs(r,f)}}catch(i){if(i instanceof T2)throw i;Xs(r,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function e4(r,e,t,n){return hw.apply(this,arguments)}function hw(){return(hw=M(function*(r,e,t,n,i={}){const o=yield yr(r,e,t,n,i);return"mfaPendingCredential"in o&&Xs(r,"multi-factor-auth-required",{_serverResponse:o}),o})).apply(this,arguments)}function GZ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?uw(r.config,i):`${r.config.apiScheme}://${i}`}class ibe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(b2(this.auth,"network-request-failed")),rbe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ed(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=b2(r,e,n);return i.customData._tokenResponse=t,i}function gw(){return(gw=M(function*(r,e){return yr(r,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function mw(){return(mw=M(function*(r,e){return yr(r,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function td(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function _w(){return(_w=M(function*(r,e=!1){const t=_r(r),n=yield t.getIdToken(e),i=jm(n);He(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:td(vw(i.auth_time)),issuedAtTime:td(vw(i.iat)),expirationTime:td(vw(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})).apply(this,arguments)}function vw(r){return 1e3*Number(r)}function jm(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return qm("JWT malformed, contained fewer than 3 sections"),null;try{const i=Pm(t);return i?JSON.parse(i):(qm("Failed to decode base64 JWT payload"),null)}catch(i){return qm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function t4(r,e){return Cw.apply(this,arguments)}function Cw(){return(Cw=M(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof T2&&function ube({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}})).apply(this,arguments)}class fbe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(M(function*(){yield t.iteration()}),n)}iteration(){var e=this;return M(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class BZ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=td(this.lastLoginAt),this.creationTime=td(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function nd(r){return yw.apply(this,arguments)}function yw(){return yw=M(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield t4(r,function abe(r,e){return mw.apply(this,arguments)}(t,{idToken:n}));He(i?.users.length,t,"internal-error");const o=i.users[0];r._notifyReloadListener(o);const s=null!==(e=o.providerUserInfo)&&void 0!==e&&e.length?function gbe(r){return r.map(e=>{var{providerId:t}=e,n=o7(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(o.providerUserInfo):[],a=function hbe(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,s),f=!!r.isAnonymous&&!(r.email&&o.passwordHash||a?.length),d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new BZ(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),yw.apply(this,arguments)}function Mw(){return(Mw=M(function*(r){const e=_r(r);yield nd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function Ew(){return(Ew=M(function*(r,e){const t=yield $Z(r,{},M(function*(){const n=Uf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=r.config,s=GZ(r,i,"/v1/token",`key=${o}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",FZ.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})).apply(this,arguments)}class rd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function lbe(r){const e=jm(r);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return M(function*(){return He(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return M(function*(){const{accessToken:i,refreshToken:o,expiresIn:s}=yield function pbe(r,e){return Ew.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,o,Number(s))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:o}=t,s=new rd;return n&&(He("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(He("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),o&&(He("number"==typeof o,"internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rd,this.toJSON())}_performRefresh(){return Wc("not implemented")}}function fl(r,e){He("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class Z6{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,o=o7(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fbe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new BZ(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){var t=this;return M(function*(){const n=yield t4(t,t.stsTokenManager.getToken(t.auth,e));return He(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function cbe(r){return _w.apply(this,arguments)}(this,e)}reload(){return function dbe(r){return Mw.apply(this,arguments)}(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Z6(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return M(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield nd(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return M(function*(){const t=yield e.getIdToken();return yield t4(e,function obe(r,e){return gw.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,o,s,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,E=null!==(o=t.phoneNumber)&&void 0!==o?o:void 0,T=null!==(s=t.photoURL)&&void 0!==s?s:void 0,L=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,G=null!==(l=t.createdAt)&&void 0!==l?l:void 0,B=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:ye,isAnonymous:Le,providerData:tt,stsTokenManager:gt}=t;He(de&&gt,e,"internal-error");const Pn=rd.fromJSON(this.name,gt);He("string"==typeof de,e,"internal-error"),fl(d,e.name),fl(m,e.name),He("boolean"==typeof ye,e,"internal-error"),He("boolean"==typeof Le,e,"internal-error"),fl(E,e.name),fl(T,e.name),fl(L,e.name),fl(z,e.name),fl(G,e.name),fl(B,e.name);const Et=new Z6({uid:de,auth:e,email:m,emailVerified:ye,displayName:d,isAnonymous:Le,photoURL:T,phoneNumber:E,tenantId:L,stsTokenManager:Pn,createdAt:G,lastLoginAt:B});return tt&&Array.isArray(tt)&&(Et.providerData=tt.map(no=>Object.assign({},no))),z&&(Et._redirectEventId=z),Et}static _fromIdTokenResponse(e,t,n=!1){return M(function*(){const i=new rd;i.updateFromServerResponse(t);const o=new Z6({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield nd(o),o})()}}const UZ=new Map;function n4(r){J3(r instanceof Function,"Expected a class definition");let e=UZ.get(r);return e?(J3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,UZ.set(r,e),e)}const WZ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(t,n){var i=this;return M(function*(){i.storage[t]=n})()}_get(t){var n=this;return M(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return M(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function Zm(r,e,t){return`firebase:${r}:${e}:${t}`}class y5{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Zm(this.userKey,i.apiKey,o),this.fullPersistenceKey=Zm("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return M(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?Z6._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return M(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return M(function*(){if(!t.length)return new y5(n4(WZ),e,n);const i=(yield Promise.all(t.map(function(){var l=M(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let o=i[0]||n4(WZ);const s=Zm(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(s);if(f){const d=Z6._fromJSON(e,f);l!==o&&(a=d),o=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return o._shouldAllowMigration&&c.length?(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(function(){var l=M(function*(f){if(f!==o)try{yield f._remove(s)}catch{}});return function(f){return l.apply(this,arguments)}}())),new y5(o,e,n)):new y5(o,e,n)})()}}function qZ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(YZ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jZ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XZ(e))return"Blackberry";if(QZ(e))return"Webos";if(Pw(e))return"Safari";if((e.includes("chrome/")||ZZ(e))&&!e.includes("edge/"))return"Chrome";if(KZ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function jZ(r=xi()){return/firefox\//i.test(r)}function Pw(r=xi()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZZ(r=xi()){return/crios\//i.test(r)}function YZ(r=xi()){return/iemobile/i.test(r)}function KZ(r=xi()){return/android/i.test(r)}function XZ(r=xi()){return/blackberry/i.test(r)}function QZ(r=xi()){return/webos/i.test(r)}function Ym(r=xi()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function JZ(r=xi()){return Ym(r)||KZ(r)||QZ(r)||XZ(r)||/windows phone/i.test(r)||YZ(r)}function eY(r,e=[]){let t;switch(r){case"Browser":t=qZ(xi());break;case"Worker":t=`${qZ(xi())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$6}/${n}`}function tY(r,e){return Ow.apply(this,arguments)}function Ow(){return(Ow=M(function*(r,e){return yr(r,"GET","/v2/recaptchaConfig",or(r,e))})).apply(this,arguments)}function rY(r){return void 0!==r&&void 0!==r.enterprise}class iY{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function Tw(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const o=b2("internal-error");o.customData=i,t(o)},n.type="text/javascript",n.charset="UTF-8",function ybe(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function oY(r){return`__${r}${Math.floor(1e6*Math.random())}`}class sY{constructor(e){this.type="recaptcha-enterprise",this.auth=Ri(e)}verify(e="verify",t=!1){var n=this;return M(function*(){function o(){return o=M(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,f){tY(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new iY(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),o.apply(this,arguments)}function s(a,c,l){const f=window.grecaptcha;rY(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return o.apply(this,arguments)})(n.auth).then(l=>{if(!t&&rY(window.grecaptcha))s(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));Tw("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{s(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function dl(r,e,t){return bw.apply(this,arguments)}function bw(){return(bw=M(function*(r,e,t,n=!1){const i=new sY(r);let o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}const s=Object.assign({},e);return Object.assign(s,n?{captchaResp:o}:{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s})).apply(this,arguments)}class Sbe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((s,a)=>{try{s(e(o))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return M(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const o of n)try{o()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class Obe{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aY(this),this.idTokenSubscription=new aY(this),this.beforeStateQueue=new Sbe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DZ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=n4(t)),this._initializationPromise=this.queue(M(function*(){var i,o;if(!n._deleted&&(n.persistenceManager=yield y5.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return M(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return M(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let o=i,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=o?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(o=l.user,s=!0)}if(!o)return t.directlySetCurrentUser(null);if(!o._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(o)}catch(a){o=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return o?t.reloadAndSetCurrentUserOrClear(o):t.directlySetCurrentUser(null)}return He(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===o._redirectEventId?t.directlySetCurrentUser(o):t.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(e){var t=this;return M(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return M(function*(){try{yield nd(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function tbe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return M(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return M(function*(){const n=e?_r(e):null;return n&&He(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return M(function*(){if(!n._deleted)return e&&He(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(M(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return M(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(M(function*(){yield t.assertedPersistence.setPersistence(n4(e))}))}initializeRecaptchaConfig(){var e=this;return M(function*(){const t=yield tY(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new iY(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new sY(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Gc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return M(function*(){if(!t.redirectPersistenceManager){const n=e&&n4(e)||t._popupRedirectResolver;He(n,t,"argument-error"),t.redirectPersistenceManager=yield y5.create(t,[n4(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return M(function*(){var n,i;return t._isInitialized&&(yield t.queue(M(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return M(function*(){if(e===t.currentUser)return t.queue(M(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const o="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return He(s,this,"internal-error"),s.then(()=>o(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return M(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eY(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return M(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const o=yield e._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n})()}_getAppCheckToken(){var e=this;return M(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function JTe(r,...e){Wm.logLevel<=Wn.WARN&&Wm.warn(`Auth (${$6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function Ri(r){return _r(r)}class aY{constructor(e){this.auth=e,this.observer=null,this.addObserver=function kMe(r,e){const t=new xMe(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function cY(r,e,t){const n=Ri(r);He(n._canInitEmulator,n,"emulator-config-failed"),He(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,o=lY(e),{host:s,port:a}=function wbe(r){const e=lY(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:uY(n.substr(o.length+1))}}{const[o,s]=n.split(":");return{host:o,port:uY(s)}}}(e);n.config.emulator={url:`${o}//${s}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function Nbe(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function lY(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function uY(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class ww{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wc("not implemented")}_getIdTokenResponse(e){return Wc("not implemented")}_linkToIdToken(e,t){return Wc("not implemented")}_getReauthenticationResolver(e){return Wc("not implemented")}}function dY(r,e){return Aw.apply(this,arguments)}function Aw(){return(Aw=M(function*(r,e){return yr(r,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function kw(r,e){return xw.apply(this,arguments)}function xw(){return(xw=M(function*(r,e){return e4(r,"POST","/v1/accounts:signInWithPassword",or(r,e))})).apply(this,arguments)}function Km(r,e){return Lw.apply(this,arguments)}function Lw(){return(Lw=M(function*(r,e){return yr(r,"POST","/v1/accounts:sendOobCode",or(r,e))})).apply(this,arguments)}function Rw(){return(Rw=M(function*(r,e){return Km(r,e)})).apply(this,arguments)}function zw(r,e){return Dw.apply(this,arguments)}function Dw(){return(Dw=M(function*(r,e){return Km(r,e)})).apply(this,arguments)}function $w(){return($w=M(function*(r,e){return e4(r,"POST","/v1/accounts:signInWithEmailLink",or(r,e))})).apply(this,arguments)}function Gw(){return(Gw=M(function*(r,e){return e4(r,"POST","/v1/accounts:signInWithEmailLink",or(r,e))})).apply(this,arguments)}class id extends ww{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new id(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new id(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return M(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield dl(e,i,"signInWithPassword");return kw(e,o)}return kw(e,i).catch(function(){var o=M(function*(s){if("auth/missing-recaptcha-token"===s.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield dl(e,i,"signInWithPassword");return kw(e,a)}return Promise.reject(s)});return function(s){return o.apply(this,arguments)}}());case"emailLink":return function xbe(r,e){return $w.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Xs(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return M(function*(){switch(n.signInMethod){case"password":return dY(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function Lbe(r,e){return Gw.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Xs(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function r4(r,e){return Bw.apply(this,arguments)}function Bw(){return(Bw=M(function*(r,e){return e4(r,"POST","/v1/accounts:signInWithIdp",or(r,e))})).apply(this,arguments)}class M5 extends ww{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new M5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,o=o7(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new M5(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){return r4(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,r4(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,r4(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Uf(t)}return e}}class sd{constructor(e){var t,n,i,o,s,a;const c=Wf(qf(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function $be(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);He(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function Gbe(r){const e=Wf(qf(r)).link,t=e?Wf(qf(e)).deep_link_id:null,n=Wf(qf(r)).deep_link_id;return(n?Wf(qf(n)).link:null)||n||t||e||r}(e);try{return new sd(t)}catch{return null}}}let hY=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return id._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=sd.parseLink(n);return He(i,"argument-error"),id._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class hl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class gY extends hl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let Bbe=(()=>{class r extends gY{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return M5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function Qm(r,e){return Yw.apply(this,arguments)}function Yw(){return(Yw=M(function*(r,e){return e4(r,"POST","/v1/accounts:signUp",or(r,e))})).apply(this,arguments)}class ia{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return M(function*(){const o=yield Z6._fromIdTokenResponse(e,n,i),s=pY(n);return new ia({user:o,providerId:s,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return M(function*(){yield e._updateTokensIfNecessary(n,!0);const i=pY(n);return new ia({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function pY(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class Jm extends T2{constructor(e,t,n,i){var o;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Jm.prototype),this.customData={appName:e.name,tenantId:null!==(o=e.tenantId)&&void 0!==o?o:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Jm(e,t,n,i)}}function mY(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?Jm._fromErrorAndOperation(r,o,e,n):o})}function Jw(){return(Jw=M(function*(r,e,t=!1){const n=yield t4(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return ia._forOperation(r,"link",n)})).apply(this,arguments)}function tN(){return(tN=M(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const o=yield t4(r,mY(n,i,e,r),t);He(o.idToken,n,"internal-error");const s=jm(o.idToken);He(s,n,"internal-error");const{sub:a}=s;return He(r.uid===a,n,"user-mismatch"),ia._forOperation(r,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&Xs(n,"user-mismatch"),o}})).apply(this,arguments)}function CY(r,e){return nN.apply(this,arguments)}function nN(){return(nN=M(function*(r,e,t=!1){const n="signIn",i=yield mY(r,n,e),o=yield ia._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(o.user)),o})).apply(this,arguments)}function iN(){return(iN=M(function*(r,e){return CY(Ri(r),e)})).apply(this,arguments)}function E5(r,e,t){var n;He((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),He(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(He(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(He(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Ybe(r,e,t){return dN.apply(this,arguments)}function dN(){return dN=M(function*(r,e,t){var n;const i=Ri(r),o={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield dl(i,o,"getOobCode",!0);t&&E5(i,s,t),yield zw(i,s)}else t&&E5(i,o,t),yield zw(i,o).catch(function(){var s=M(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield dl(i,o,"getOobCode",!0);t&&E5(i,c,t),yield zw(i,c)}});return function(a){return s.apply(this,arguments)}}())}),dN.apply(this,arguments)}function Xbe(r,e,t){return _N.apply(this,arguments)}function _N(){return _N=M(function*(r,e,t){var n;const i=Ri(r),o={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let s;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield dl(i,o,"signUpPassword");s=Qm(i,l)}else s=Qm(i,o).catch(function(){var l=M(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield dl(i,o,"signUpPassword");return Qm(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield s.catch(l=>Promise.reject(l)),c=yield ia._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),_N.apply(this,arguments)}function Qbe(r,e,t){return function rN(r,e){return iN.apply(this,arguments)}(_r(r),hY.credential(e,t))}function ewe(r,e){return EN.apply(this,arguments)}function EN(){return EN=M(function*(r,e){const t=_r(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&E5(t.auth,i,e);const{email:o}=yield function Ibe(r,e){return Rw.apply(this,arguments)}(t.auth,i);o!==r.email&&(yield r.reload())}),EN.apply(this,arguments)}function SN(){return(SN=M(function*(r,e){return yr(r,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function nwe(r,e){return ON.apply(this,arguments)}function ON(){return ON=M(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=_r(r),o={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},s=yield t4(n,function twe(r,e){return SN.apply(this,arguments)}(n.auth,o));n.displayName=s.displayName||null,n.photoURL=s.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(s)}),ON.apply(this,arguments)}function uwe(r,e,t,n){return _r(r).onAuthStateChanged(e,t,n)}const t_="__sak";class MY{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(t_,"1"),this.storage.removeItem(t_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const vwe=(()=>{class r extends MY{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function pwe(){const r=xi();return Pw(r)||Ym(r)}()&&function vbe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=JZ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),o=this.localCache[n];i!==o&&t(n,o,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const o=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);!function _be(){return function bMe(){const r=xi();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||s===t.newValue||t.newValue===t.oldValue?o():setTimeout(o,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,o=this;return M(function*(){yield i().call(o,t,n),o.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return M(function*(){const o=yield n().call(i,t);return i.localCache[t]=JSON.stringify(o),o})()}_remove(t){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),EY=(()=>{class r extends MY{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let ywe=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(o=>o.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return M(function*(){const i=t,{eventId:o,eventType:s,data:a}=i.data,c=n.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:s});const l=Array.from(c).map(function(){var d=M(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function Cwe(r){return Promise.all(r.map(function(){var e=M(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:o,eventType:s,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function n_(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class Mwe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return M(function*(){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{const f=n_("",20);o.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(m){const E=m;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(E.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"))}}},i.handlers.add(a),o.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[o.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function ii(){return window}function kN(){return typeof ii().WorkerGlobalScope<"u"&&"function"==typeof ii().importScripts}function xN(){return(xN=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const PY="firebaseLocalStorageDb",r_="firebaseLocalStorage",SY="fbase_key";class cd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function i_(r,e){return r.transaction([r_],e?"readwrite":"readonly").objectStore(r_)}function LN(){const r=indexedDB.open(PY,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(r_,{keyPath:SY})}catch(i){t(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(r_)?e(n):(n.close(),yield function bwe(){const r=indexedDB.deleteDatabase(PY);return new cd(r).toPromise()}(),e(yield LN()))}))})}function OY(r,e,t){return RN.apply(this,arguments)}function RN(){return(RN=M(function*(r,e,t){const n=i_(r,!0).put({[SY]:e,value:t});return new cd(n).toPromise()})).apply(this,arguments)}function zN(){return(zN=M(function*(r,e){const t=i_(r,!1).get(e),n=yield new cd(t).toPromise();return void 0===n?null:n.value})).apply(this,arguments)}function TY(r,e){const t=i_(r,!0).delete(e);return new cd(t).toPromise()}const Iwe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return M(function*(){return t.db||(t.db=yield LN()),t.db})()}_withRetries(t){var n=this;return M(function*(){let i=0;for(;;)try{const o=yield n._openDb();return yield t(o)}catch(o){if(i++>3)throw o;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return M(function*(){return kN()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return M(function*(){t.receiver=ywe._getInstance(function Owe(){return kN()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=M(function*(i,o){return{keyProcessed:(yield t._poll()).includes(o.key)}});return function(i,o){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=M(function*(i,o){return["keyChanged"]});return function(i,o){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return M(function*(){var n,i;if(t.activeServiceWorker=yield function Pwe(){return xN.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new Mwe(t.activeServiceWorker);const o=yield t.sender._send("ping",{},800);o&&null!==(n=o[0])&&void 0!==n&&n.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function Swe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const t=yield LN();return yield OY(t,t_,"1"),yield TY(t,t_),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return M(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(o=>OY(o,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return M(function*(){const i=yield n._withRetries(o=>function wwe(r,e){return zN.apply(this,arguments)}(o,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>TY(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return M(function*(){const n=yield t._withRetries(s=>{const a=i_(s,!1).getAll();return new cd(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],o=new Set;for(const{fbase_key:s,value:a}of n)o.add(s),JSON.stringify(t.localCache[s])!==JSON.stringify(a)&&(t.notifyListeners(s,a),i.push(s));for(const s of Object.keys(t.localCache))t.localCache[s]&&!o.has(s)&&(t.notifyListeners(s,null),i.push(s));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function K6(r,e){return e?n4(e):(He(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}oY("rcb"),new Jf(3e4,6e4);class WN extends ww{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return r4(e,this._buildIdpRequest())}_linkToIdToken(e,t){return r4(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return r4(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jwe(r){return CY(r.auth,new WN(r),r.bypassAuthState)}function Zwe(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function vY(r,e){return tN.apply(this,arguments)}(t,new WN(r),r.bypassAuthState)}function Ywe(r){return qN.apply(this,arguments)}function qN(){return(qN=M(function*(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function Qw(r,e){return Jw.apply(this,arguments)}(t,new WN(r),r.bypassAuthState)})).apply(this,arguments)}class wY{constructor(e,t,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=M(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(o){e.reject(o)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:o,tenantId:s,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:o||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jwe;case"linkViaPopup":case"linkViaRedirect":return Ywe;case"reauthViaPopup":case"reauthViaRedirect":return Zwe;default:Xs(this.auth,"internal-error")}}resolve(e){J3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){J3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Kwe=new Jf(2e3,1e4);function Xwe(r,e,t){return jN.apply(this,arguments)}function jN(){return(jN=M(function*(r,e,t){const n=Ri(r);!function C5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Xs(r,"argument-error"),HZ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,hl);const i=K6(n,t);return new KN(n,"signInViaPopup",e,i).executeNotNull()})).apply(this,arguments)}let KN=(()=>{class r extends wY{constructor(t,n,i,o,s){super(t,n,o,s),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return M(function*(){const n=yield t.execute();return He(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return M(function*(){J3(1===t.filter.length,"Popup operations only handle one event");const n=n_();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(b2(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(b2(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(b2(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,Kwe.get())};t()}}return r.currentPopupAction=null,r})();const Qwe="pendingRedirect",ld=new Map;class Jwe extends wY{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return M(function*(){let n=ld.get(t.auth._key());if(!n){try{const o=(yield function eNe(r,e){return XN.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(o)}catch(i){n=()=>Promise.reject(i)}ld.set(t.auth._key(),n)}return t.bypassAuthState||ld.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function XN(){return(XN=M(function*(r,e){const t=function AY(r){return Zm(Qwe,r.config.apiKey,r.name)}(e),n=function NY(r){return n4(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i})).apply(this,arguments)}function tNe(r,e){ld.set(r._key(),e)}function IY(r,e){return iA.apply(this,arguments)}function iA(){return(iA=M(function*(r,e,t=!1){const n=Ri(r),i=K6(n,e),s=yield new Jwe(n,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield n._persistUserIfCurrent(s.user),yield n._setRedirectUser(null,e)),s})).apply(this,arguments)}class sNe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function aNe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return LY(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!LY(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(b2(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xY(e))}saveEventToCache(e){this.cachedEventUids.add(xY(e)),this.lastProcessedEventTime=Date.now()}}function xY(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function LY({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function sA(){return(sA=M(function*(r,e={}){return yr(r,"GET","/v1/projects",e)})).apply(this,arguments)}const lNe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uNe=/^https?/;function aA(){return aA=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function cNe(r){return sA.apply(this,arguments)}(r);for(const t of e)try{if(dNe(t))return}catch{}Xs(r,"unauthorized-domain")}),aA.apply(this,arguments)}function dNe(r){const e=Qf(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const s=new URL(r);return""===s.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&s.hostname===n}if(!uNe.test(t))return!1;if(lNe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const hNe=new Jf(3e4,6e4);function RY(){const r=ii().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let s_=null;const mNe=new Jf(5e3,15e3),_Ne="__/auth/iframe",vNe="emulator/auth/iframe",CNe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yNe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MNe(r){const e=r.config;He(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?uw(e,vNe):`https://${r.config.authDomain}/${_Ne}`,n={apiKey:e.apiKey,appName:r.name,v:$6},i=yNe.get(r.config.apiHost);i&&(n.eid=i);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Uf(n).slice(1)}`}function cA(){return cA=M(function*(r){const e=yield function pNe(r){return s_=s_||function gNe(r){return new Promise((e,t)=>{var n,i,o;function s(){RY(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{RY(),t(b2(r,"network-request-failed"))},timeout:hNe.get()})}if(null!==(i=null===(n=ii().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(o=ii().gapi)||void 0===o||!o.load){const a=oY("iframefcb");return ii()[a]=()=>{gapi.load?s():t(b2(r,"network-request-failed"))},Tw(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}s()}}).catch(e=>{throw s_=null,e})}(r),s_}(r),t=ii().gapi;return He(t,r,"internal-error"),e.open({where:document.body,url:MNe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:CNe,dontclear:!0},n=>new Promise(function(){var i=M(function*(o,s){yield n.restyle({setHideOnLeave:!1});const a=b2(r,"network-request-failed"),c=ii().setTimeout(()=>{s(a)},mNe.get());function l(){ii().clearTimeout(c),o(n)}n.ping(l).then(l,()=>{s(a)})});return function(o,s){return i.apply(this,arguments)}}()))}),cA.apply(this,arguments)}const PNe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zY{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ANe="__/auth/handler",INe="emulator/auth/handler",kNe=encodeURIComponent("fac");function DY(r,e,t,n,i,o){return lA.apply(this,arguments)}function lA(){return(lA=M(function*(r,e,t,n,i,o){He(r.config.authDomain,r,"auth-domain-config-required"),He(r.config.apiKey,r,"invalid-api-key");const s={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:$6,eventId:i};if(e instanceof hl){e.setDefaultLanguage(r.languageCode),s.providerId=e.providerId||"",function IMe(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(o||{}))s[f]=d}if(e instanceof gY){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(s.scopes=f.join(","))}r.tenantId&&(s.tid=r.tenantId);const a=s;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${kNe}=${encodeURIComponent(c)}`:"";return`${function xNe({config:r}){return r.emulator?uw(r,INe):`https://${r.authDomain}/${ANe}`}(r)}?${Uf(a).slice(1)}${l}`})).apply(this,arguments)}const uA="webStorageSupport",RNe=class LNe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=EY,this._completeRedirectFn=IY,this._overrideRedirectResult=tNe}_openPopup(e,t,n,i){var o=this;return M(function*(){var s;J3(null===(s=o.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const a=yield DY(e,t,n,Qf(),i);return function wNe(r,e,t,n=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},PNe),{width:n.toString(),height:i.toString(),top:o,left:s}),l=xi().toLowerCase();t&&(a=ZZ(l)?"_blank":t),jZ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[E,T])=>`${m}${E}=${T},`,"");if(function mbe(r=xi()){var e;return Ym(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function NNe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new zY(null);const d=window.open(e||"",a,f);He(d,r,"popup-blocked");try{d.focus()}catch{}return new zY(d)}(e,a,n_())})()}_openRedirect(e,t,n,i){var o=this;return M(function*(){return yield o._originValidation(e),function Ewe(r){ii().location.href=r}(yield DY(e,t,n,Qf(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(J3(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return M(function*(){const n=yield function ENe(r){return cA.apply(this,arguments)}(e),i=new sNe(e);return n.register("authEvent",o=>(He(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(uA,{type:uA},i=>{var o;const s=null===(o=i?.[0])||void 0===o?void 0:o[uA];void 0!==s&&t(!!s),Xs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function fNe(r){return aA.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return JZ()||Pw()||Ym()}};var FY="@firebase/auth";class zNe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return M(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const FNe=Wq("authIdTokenMaxAge")||300;let GY=null;const $Ne=r=>function(){var e=M(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>FNe)return;const o=n?.token;GY!==o&&(GY=o,yield fetch(r,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function GNe(r=xO()){const e=h5(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function Tbe(r,e){const t=h5(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(bm(t.getOptions(),e??{}))return i;Xs(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:RNe,persistence:[Iwe,vwe,EY]}),n=Wq("authTokenSyncURL");if(n){const o=$Ne(n);(function lwe(r,e,t){_r(r).beforeAuthStateChanged(e,t)})(t,o,()=>o(t.currentUser)),function cwe(r,e,t,n){_r(r).onIdTokenChanged(e,t,n)}(t,s=>o(s))}const i=Bq("auth");return i&&cY(t,`http://${i}`),t}!function HNe(r){vs(new Bo("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;He(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eY(r)},l=new Obe(n,i,o,c);return function bbe(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(n4);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),vs(new Bo("auth-internal",e=>{const t=Ri(e.getProvider("auth").getImmediate());return new zNe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vr(FY,"0.23.2",function DNe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),vr(FY,"0.23.2","esm2017")}("Browser");class c_{constructor(e){return e}}class UY{constructor(){return zb("auth")}}const dA=new et("angularfire2.auth-instances");function UNe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new c_(n)}}const WNe={provide:UY,deps:[[new ds,dA]]},qNe={provide:c_,useFactory:function BNe(r,e){const t=Rb("auth",r,e);return t&&new c_(t)},deps:[[new ds,dA],_5]};let jNe=(()=>{class r{constructor(){vr("angularfire",Dm.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:[qNe,WNe]}),r})();const KNe=z1(Xbe,!0),XNe=z1(GNe,!0),QNe=z1(uwe,!0),JNe=z1(ewe,!0),eAe=z1(Ybe,!0),tAe=z1(Qbe,!0),nAe=z1(Xwe,!0),rAe=z1(nwe,!0);var Qe,iAe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ga={},hA=hA||{},Xt=iAe||self;function l_(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function ud(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var gA="closure_uid_"+(1e9*Math.random()>>>0),sAe=0;function aAe(r,e,t){return r.call.apply(r.bind,arguments)}function cAe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function Uo(r,e,t){return(Uo=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aAe:cAe).apply(null,arguments)}function u_(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function zi(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,o){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return e.prototype[i].apply(n,s)}}function gl(){this.s=this.s,this.o=this.o}gl.prototype.s=!1,gl.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function oAe(r){Object.prototype.hasOwnProperty.call(r,gA)&&r[gA]||(r[gA]=++sAe)}(this)},gl.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const WY=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function pA(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function qY(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(l_(n)){const i=r.length||0,o=n.length||0;r.length=i+o;for(let s=0;s<o;s++)r[i+s]=n[s]}else r.push(n)}}function Wo(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}Wo.prototype.h=function(){this.defaultPrevented=!0};var uAe=function(){if(!Xt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Xt.addEventListener("test",()=>{},e),Xt.removeEventListener("test",()=>{},e)}catch{}return r}();function fd(r){return/^[\s\xa0]*$/.test(r)}function f_(){var r=Xt.navigator;return r&&(r=r.userAgent)?r:""}function qc(r){return-1!=f_().indexOf(r)}function mA(r){return mA[" "](r),r}mA[" "]=function(){};var vA,r,dAe=qc("Opera"),P5=qc("Trident")||qc("MSIE"),jY=qc("Edge"),_A=jY||P5,ZY=qc("Gecko")&&!(-1!=f_().toLowerCase().indexOf("webkit")&&!qc("Edge"))&&!(qc("Trident")||qc("MSIE"))&&!qc("Edge"),hAe=-1!=f_().toLowerCase().indexOf("webkit")&&!qc("Edge");function YY(){var r=Xt.document;return r?r.documentMode:void 0}e:{var CA="",yA=(r=f_(),ZY?/rv:([^\);]+)(\)|;)/.exec(r):jY?/Edge\/([\d\.]+)/.exec(r):P5?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):hAe?/WebKit\/(\S+)/.exec(r):dAe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(yA&&(CA=yA?yA[1]:""),P5){var MA=YY();if(null!=MA&&MA>parseFloat(CA)){vA=String(MA);break e}}vA=CA}var gAe=Xt.document&&P5&&(YY()||parseInt(vA,10))||void 0;function dd(r,e){if(Wo.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(ZY){e:{try{mA(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:pAe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&dd.$.h.call(this)}}zi(dd,Wo);var pAe={2:"touch",3:"pen",4:"mouse"};dd.prototype.h=function(){dd.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var hd="closure_listenable_"+(1e6*Math.random()|0),mAe=0;function _Ae(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++mAe,this.fa=this.ia=!1}function d_(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function PA(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function XY(r){const e={};for(const t in r)e[t]=r[t];return e}const QY="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function JY(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let o=0;o<QY.length;o++)t=QY[o],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function h_(r){this.src=r,this.g={},this.h=0}function SA(r,e){var t=e.type;if(t in r.g){var o,n=r.g[t],i=WY(n,e);(o=0<=i)&&Array.prototype.splice.call(n,i,1),o&&(d_(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function OA(r,e,t,n){for(var i=0;i<r.length;++i){var o=r[i];if(!o.fa&&o.listener==e&&o.capture==!!t&&o.la==n)return i}return-1}h_.prototype.add=function(r,e,t,n,i){var o=r.toString();(r=this.g[o])||(r=this.g[o]=[],this.h++);var s=OA(r,e,n,i);return-1<s?(e=r[s],t||(e.ia=!1)):((e=new _Ae(e,this.src,o,!!n,i)).ia=t,r.push(e)),e};var TA="closure_lm_"+(1e6*Math.random()|0),bA={};function eK(r,e,t,n,i){if(n&&n.once)return nK(r,e,t,n,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)eK(r,e[o],t,n,i);return null}return t=IA(t),r&&r[hd]?r.O(e,t,ud(n)?!!n.capture:!!n,i):tK(r,e,t,!1,n,i)}function tK(r,e,t,n,i,o){if(!e)throw Error("Invalid event type");var s=ud(i)?!!i.capture:!!i,a=NA(r);if(a||(r[TA]=a=new h_(r)),(t=a.add(e,t,n,s,o)).proxy)return t;if(n=function CAe(){const e=yAe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)uAe||(i=s),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(iK(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function nK(r,e,t,n,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)nK(r,e[o],t,n,i);return null}return t=IA(t),r&&r[hd]?r.P(e,t,ud(n)?!!n.capture:!!n,i):tK(r,e,t,!0,n,i)}function rK(r,e,t,n,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)rK(r,e[o],t,n,i);else n=ud(n)?!!n.capture:!!n,t=IA(t),r&&r[hd]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=OA(o=r.g[e],t,n,i))&&(d_(o[t]),Array.prototype.splice.call(o,t,1),0==o.length&&(delete r.g[e],r.h--))):r&&(r=NA(r))&&(e=r.g[e.toString()],r=-1,e&&(r=OA(e,t,n,i)),(t=-1<r?e[r]:null)&&wA(t))}function wA(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[hd])SA(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(iK(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=NA(e))?(SA(t,r),0==t.h&&(t.src=null,e[TA]=null)):d_(r)}}}function iK(r){return r in bA?bA[r]:bA[r]="on"+r}function yAe(r,e){if(r.fa)r=!0;else{e=new dd(e,this);var t=r.listener,n=r.la||r.src;r.ia&&wA(r),r=t.call(n,e)}return r}function NA(r){return(r=r[TA])instanceof h_?r:null}var AA="__closure_events_fn_"+(1e9*Math.random()>>>0);function IA(r){return"function"==typeof r?r:(r[AA]||(r[AA]=function(e){return r.handleEvent(e)}),r[AA])}function Di(){gl.call(this),this.i=new h_(this),this.S=this,this.J=null}function go(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new Wo(e,r);else if(e instanceof Wo)e.target=e.target||r;else{var i=e;JY(e=new Wo(n,r),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var s=e.g=t[o];i=g_(s,n,!0,e)&&i}if(i=g_(s=e.g=r,n,!0,e)&&i,i=g_(s,n,!1,e)&&i,t)for(o=0;o<t.length;o++)i=g_(s=e.g=t[o],n,!1,e)&&i}function g_(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.fa&&s.capture==t){var a=s.listener,c=s.la||s.src;s.ia&&SA(r.i,s),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}zi(Di,gl),Di.prototype[hd]=!0,Di.prototype.removeEventListener=function(r,e,t,n){rK(this,r,e,t,n)},Di.prototype.N=function(){if(Di.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)d_(t[n]);delete r.g[e],r.h--}}this.J=null},Di.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},Di.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var kA=Xt.JSON.stringify;function EAe(){var r=xA;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var oK=new class MAe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new SAe,r=>r.reset());class SAe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function OAe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function TAe(r){Xt.setTimeout(()=>{throw r},0)}let gd,pd=!1,xA=new class PAe{constructor(){this.h=this.g=null}add(e,t){const n=oK.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},sK=()=>{const r=Xt.Promise.resolve(void 0);gd=()=>{r.then(bAe)}};var bAe=()=>{for(var r;r=EAe();){try{r.h.call(r.g)}catch(t){TAe(t)}var e=oK;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}pd=!1};function p_(r,e){Di.call(this),this.h=r||1,this.g=e||Xt,this.j=Uo(this.qb,this),this.l=Date.now()}function LA(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function RA(r,e,t){if("function"==typeof r)t&&(r=Uo(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=Uo(r.handleEvent,r)}return 2147483647<Number(e)?-1:Xt.setTimeout(r,e||0)}function aK(r){r.g=RA(()=>{r.g=null,r.i&&(r.i=!1,aK(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}zi(p_,Di),(Qe=p_.prototype).ga=!1,Qe.T=null,Qe.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),go(this,"tick"),this.ga&&(LA(this),this.start()))}},Qe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Qe.N=function(){p_.$.N.call(this),LA(this),delete this.g};class wAe extends gl{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:aK(this)}N(){super.N(),this.g&&(Xt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function md(r){gl.call(this),this.h=r,this.g={}}zi(md,gl);var cK=[];function lK(r,e,t,n){Array.isArray(t)||(t&&(cK[0]=t.toString()),t=cK);for(var i=0;i<t.length;i++){var o=eK(e,t[i],n||r.handleEvent,!1,r.h||r);if(!o)break;r.g[o.key]=o}}function uK(r){PA(r.g,function(e,t){this.g.hasOwnProperty(t)&&wA(e)},r),r.g={}}function m_(){this.g=!0}function S5(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function kAe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return kA(t)}catch{return e}}(r,t)+(n?" "+n:"")})}md.prototype.N=function(){md.$.N.call(this),uK(this)},md.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},m_.prototype.Ea=function(){this.g=!1},m_.prototype.info=function(){};var X6={},fK=null;function __(){return fK=fK||new Di}function dK(r){Wo.call(this,X6.Ta,r)}function _d(r){const e=__();go(e,new dK(e))}function hK(r,e){Wo.call(this,X6.STAT_EVENT,r),this.stat=e}function ys(r){const e=__();go(e,new hK(e,r))}function gK(r,e){Wo.call(this,X6.Ua,r),this.size=e}function vd(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Xt.setTimeout(function(){r()},e)}X6.Ta="serverreachability",zi(dK,Wo),X6.STAT_EVENT="statevent",zi(hK,Wo),X6.Ua="timingevent",zi(gK,Wo);var v_={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},pK={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function zA(){}function _K(){}zA.prototype.h=null;var VA,Cd={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function DA(){Wo.call(this,"d")}function HA(){Wo.call(this,"c")}function C_(){}function yd(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new md(this),this.P=xAe,this.V=new p_(r=_A?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new vK}function vK(){this.i=null,this.g="",this.h=!1}zi(DA,Wo),zi(HA,Wo),zi(C_,zA),C_.prototype.g=function(){return new XMLHttpRequest},C_.prototype.i=function(){return{}},VA=new C_;var xAe=45e3,FA={},y_={};function $A(r,e,t){r.L=1,r.v=S_(i4(e)),r.s=t,r.S=!0,CK(r,null)}function CK(r,e){r.G=Date.now(),Md(r),r.A=i4(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),NK(t.i,"t",n),r.C=0,t=r.l.J,r.h=new vK,r.g=JK(r.l,t?e:null,!r.s),0<r.O&&(r.M=new wAe(Uo(r.Pa,r,r.g),r.O)),lK(r.U,r.g,"readystatechange",r.nb),e=r.I?XY(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),_d(),function NAe(r,e,t,n,i,o){r.info(function(){if(r.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");s=2<=d.length&&"type"==d[1]?s+(f+"=")+l+"&":s+(f+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+s})}(r.j,r.u,r.A,r.m,r.W,r.s)}function yK(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function MK(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=LAe(r,t),i==y_){4==e&&(r.o=4,ys(14),n=!1),S5(r.j,r.m,null,"[Incomplete Response]");break}if(i==FA){r.o=4,ys(15),S5(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}S5(r.j,r.m,i,null),GA(r,i)}yK(r)&&i!=y_&&i!=FA&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,ys(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),YA(e),e.M=!0,ys(11))):(S5(r.j,r.m,t,"[Invalid Chunked Response]"),Q6(r),Ed(r))}function LAe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?y_:(t=Number(e.substring(t,n)),isNaN(t)?FA:(n+=1)+t>e.length?y_:(e=e.slice(n,n+t),r.C=n+t,e))}function Md(r){r.Y=Date.now()+r.P,EK(r,r.P)}function EK(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=vd(Uo(r.lb,r),e)}function M_(r){r.B&&(Xt.clearTimeout(r.B),r.B=null)}function Ed(r){0==r.l.H||r.J||YK(r.l,r)}function Q6(r){M_(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,LA(r.V),uK(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function GA(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||BA(t.i,r)))if(!r.K&&BA(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;A_(t),w_(t)}ZA(t),ys(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=vd(Uo(t.ib,t),6e3));if(1>=kK(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else e0(t,11)}else if((r.K||t.g==r)&&A_(t),!fd(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const E=r.g;if(E){const T=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(T){var o=n.i;o.g||-1==T.indexOf("spdy")&&-1==T.indexOf("quic")&&-1==T.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(UA(o,o.h),o.h=null))}if(n.F){const L=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;L&&(n.Da=L,D1(n.I,n.F,L))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var s=r;if((n=t).wa=QK(n,n.J?n.pa:null,n.Y),s.K){xK(n.i,s);var a=s,c=n.L;c&&a.setTimeout(c),a.B&&(M_(a),Md(a)),n.g=s}else jK(n);0<t.j.length&&N_(t)}else"stop"!=l[0]&&"close"!=l[0]||e0(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?e0(t,7):jA(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}_d()}catch{}}function PK(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(l_(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function zAe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(l_(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function RAe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(l_(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,o=0;o<i;o++)e.call(void 0,n[o],t&&t[o],r)}(Qe=yd.prototype).setTimeout=function(r){this.P=r},Qe.nb=function(r){r=r.target;const e=this.M;e&&3==jc(r)?e.l():this.Pa(r)},Qe.Pa=function(r){try{if(r==this.g)e:{const f=jc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||_A||this.g&&(this.h.h||this.g.ja()||$K(this.g)))){this.J||4!=f||7==e||_d(),M_(this);var t=this.g.da();this.ca=t;t:if(yK(this)){var n=$K(this.g);r="";var i=n.length,o=4==jc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Q6(this),Ed(this);var s="";break t}this.h.i=new Xt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:o&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==t,function AAe(r,e,t,n,i,o,s){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!fd(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,ys(12),Q6(this),Ed(this);break e}S5(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,GA(this,t)}this.S?(MK(this,f,s),_A&&this.i&&3==f&&(lK(this.U,this.V,"tick",this.mb),this.V.start())):(S5(this.j,this.m,s,null),GA(this,s)),4==f&&Q6(this),this.i&&!this.J&&(4==f?YK(this.l,this):(this.i=!1,Md(this)))}else(function eIe(r){const e={};r=(r.g&&2<=jc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(fd(r[n]))continue;var t=OAe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const o=e[i]||[];e[i]=o,o.push(t)}!function vAe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<s.indexOf("Unknown SID")?(this.o=3,ys(12)):(this.o=0,ys(13)),Q6(this),Ed(this)}}}catch{}},Qe.mb=function(){if(this.g){var r=jc(this.g),e=this.g.ja();this.C<e.length&&(M_(this),MK(this,r,e),this.i&&4!=r&&Md(this))}},Qe.cancel=function(){this.J=!0,Q6(this)},Qe.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function IAe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(_d(),ys(17)),Q6(this),this.o=2,Ed(this)):EK(this,this.Y-r)};var SK=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function J6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof J6){this.h=r.h,E_(this,r.j),this.s=r.s,this.g=r.g,P_(this,r.m),this.l=r.l;var e=r.i,t=new Od;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),OK(this,t),this.o=r.o}else r&&(e=String(r).match(SK))?(this.h=!1,E_(this,e[1]||"",!0),this.s=Pd(e[2]||""),this.g=Pd(e[3]||"",!0),P_(this,e[4]),this.l=Pd(e[5]||"",!0),OK(this,e[6]||"",!0),this.o=Pd(e[7]||"")):(this.h=!1,this.i=new Od(null,this.h))}function i4(r){return new J6(r)}function E_(r,e,t){r.j=t?Pd(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function P_(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function OK(r,e,t){e instanceof Od?(r.i=e,function BAe(r,e){e&&!r.j&&(pl(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(bK(this,n),NK(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=Sd(e,$Ae)),r.i=new Od(e,r.h))}function D1(r,e,t){r.i.set(e,t)}function S_(r){return D1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function Pd(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function Sd(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,HAe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function HAe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}J6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(Sd(e,TK,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(Sd(e,TK,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(Sd(t,"/"==t.charAt(0)?FAe:VAe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",Sd(t,GAe)),r.join("")};var TK=/[#\/\?@]/g,VAe=/[#\?:]/g,FAe=/[#\?]/g,$Ae=/[#\?@]/g,GAe=/#/g;function Od(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function pl(r){r.g||(r.g=new Map,r.h=0,r.i&&function DAe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var o=r[t].substring(0,n);i=r[t].substring(n+1)}else o=r[t];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function bK(r,e){pl(r),e=O5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function wK(r,e){return pl(r),e=O5(r,e),r.g.has(e)}function NK(r,e,t){bK(r,e),0<t.length&&(r.i=null,r.g.set(O5(r,e),pA(t)),r.h+=t.length)}function O5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function AK(r){this.l=r||WAe,r=Xt.PerformanceNavigationTiming?0<(r=Xt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Xt.g&&Xt.g.Ka&&Xt.g.Ka()&&Xt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Qe=Od.prototype).add=function(r,e){pl(this),this.i=null,r=O5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Qe.forEach=function(r,e){pl(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Qe.ta=function(){pl(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let o=0;o<i.length;o++)t.push(e[n])}return t},Qe.Z=function(r){pl(this);let e=[];if("string"==typeof r)wK(this,r)&&(e=e.concat(this.g.get(O5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Qe.set=function(r,e){return pl(this),this.i=null,wK(this,r=O5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Qe.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Qe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const o=encodeURIComponent(String(n)),s=this.Z(n);for(n=0;n<s.length;n++){var i=o;""!==s[n]&&(i+="="+encodeURIComponent(String(s[n]))),r.push(i)}}return this.i=r.join("&")};var WAe=10;function IK(r){return!!r.h||!!r.g&&r.g.size>=r.j}function kK(r){return r.h?1:r.g?r.g.size:0}function BA(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function UA(r,e){r.g?r.g.add(e):r.h=e}function xK(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function LK(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return pA(r.i)}AK.prototype.cancel=function(){if(this.i=LK(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var qAe=class{stringify(r){return Xt.JSON.stringify(r,void 0)}parse(r){return Xt.JSON.parse(r,void 0)}};function jAe(){this.g=new qAe}function ZAe(r,e,t){const n=t||"";try{PK(r,function(i,o){let s=i;ud(i)&&(s=kA(i)),e.push(n+o+"="+encodeURIComponent(s))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function O_(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function Td(r){this.l=r.fc||null,this.j=r.ob||!1}function T_(r,e){Di.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=WA,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zi(Td,zA),Td.prototype.g=function(){return new T_(this.l,this.j)},Td.prototype.i=function(r){return function(){return r}}({}),zi(T_,Di);var WA=0;function RK(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function bd(r){r.readyState=4,r.l=null,r.j=null,r.A=null,wd(r)}function wd(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Qe=T_.prototype).open=function(r,e){if(this.readyState!=WA)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,wd(this)},Qe.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Xt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Qe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bd(this)),this.readyState=WA},Qe.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,wd(this)),this.g&&(this.readyState=3,wd(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Xt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;RK(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Qe.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?bd(this):wd(this),3==this.readyState&&RK(this)}},Qe.Za=function(r){this.g&&(this.response=this.responseText=r,bd(this))},Qe.Ya=function(r){this.g&&(this.response=r,bd(this))},Qe.ka=function(){this.g&&bd(this)},Qe.setRequestHeader=function(r,e){this.v.append(r,e)},Qe.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Qe.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(T_.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var KAe=Xt.JSON.parse;function Mr(r){Di.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=zK,this.L=this.M=!1}zi(Mr,Di);var zK="",XAe=/^https?$/i,QAe=["POST","PUT"];function DK(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,HK(r),b_(r)}function HK(r){r.F||(r.F=!0,go(r,"complete"),go(r,"error"))}function VK(r){if(r.h&&typeof hA<"u"&&(!r.C[1]||4!=jc(r)||2!=r.da()))if(r.v&&4==jc(r))RA(r.La,0,r);else if(go(r,"readystatechange"),4==jc(r)){r.h=!1;try{const s=r.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===s){var i=String(r.I).match(SK)[1]||null;!i&&Xt.self&&Xt.self.location&&(i=Xt.self.location.protocol.slice(0,-1)),n=!XAe.test(i?i.toLowerCase():"")}t=n}if(t)go(r,"complete"),go(r,"success");else{r.m=6;try{var o=2<jc(r)?r.g.statusText:""}catch{o=""}r.j=o+" ["+r.da()+"]",HK(r)}}finally{b_(r)}}}function b_(r,e){if(r.g){FK(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||go(r,"ready");try{t.onreadystatechange=n}catch{}}}function FK(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Xt.clearTimeout(r.A),r.A=null)}function jc(r){return r.g?r.g.readyState:0}function $K(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case zK:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function GK(r){let e="";return PA(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function qA(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=GK(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):D1(r,e,t))}function Nd(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function BK(r){this.Ga=0,this.j=[],this.l=new m_,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Nd("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Nd("baseRetryDelayMs",5e3,r),this.hb=Nd("retryDelaySeedMs",1e4,r),this.eb=Nd("forwardChannelMaxRetries",2,r),this.xa=Nd("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new AK(r&&r.concurrentRequestLimit),this.Ja=new jAe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function jA(r){if(UK(r),3==r.H){var e=r.W++,t=i4(r.I);if(D1(t,"SID",r.K),D1(t,"RID",e),D1(t,"TYPE","terminate"),Ad(r,t),(e=new yd(r,r.l,e)).L=2,e.v=S_(i4(t)),t=!1,Xt.navigator&&Xt.navigator.sendBeacon)try{t=Xt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Xt.Image&&((new Image).src=e.v,t=!0),t||(e.g=JK(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Md(e)}XK(r)}function w_(r){r.g&&(YA(r),r.g.cancel(),r.g=null)}function UK(r){w_(r),r.u&&(Xt.clearTimeout(r.u),r.u=null),A_(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Xt.clearTimeout(r.m),r.m=null)}function N_(r){if(!IK(r.i)&&!r.m){r.m=!0;var e=r.Na;gd||sK(),pd||(gd(),pd=!0),xA.add(e,r),r.C=0}}function WK(r,e){var t;t=e?e.m:r.W++;const n=i4(r.I);D1(n,"SID",r.K),D1(n,"RID",t),D1(n,"AID",r.V),Ad(r,n),r.o&&r.s&&qA(n,r.o,r.s),t=new yd(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=qK(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),UA(r.i,t),$A(t,n,e)}function Ad(r,e){r.na&&PA(r.na,function(t,n){D1(e,n,t)}),r.h&&PK({},function(t,n){D1(e,n,t)})}function qK(r,e,t){t=Math.min(r.j.length,t);var n=r.h?Uo(r.h.Va,r.h,r):null;e:{var i=r.j;let o=-1;for(;;){const s=["count="+t];-1==o?0<t?(o=i[0].g,s.push("ofs="+o)):o=0:s.push("ofs="+o);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=o,0>l)o=Math.max(0,i[c].g-100),a=!1;else try{ZAe(f,s,"req"+l+"_")}catch{n&&n(f)}}if(a){n=s.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function jK(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;gd||sK(),pd||(gd(),pd=!0),xA.add(e,r),r.A=0}}function ZA(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=vd(Uo(r.Ma,r),KK(r,r.A)),r.A++,0))}function YA(r){null!=r.B&&(Xt.clearTimeout(r.B),r.B=null)}function ZK(r){r.g=new yd(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=i4(r.wa);D1(e,"RID","rpc"),D1(e,"SID",r.K),D1(e,"AID",r.V),D1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&D1(e,"TO",r.qa),D1(e,"TYPE","xmlhttp"),Ad(r,e),r.o&&r.s&&qA(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=S_(i4(e)),t.s=null,t.S=!0,CK(t,r)}function A_(r){null!=r.v&&(Xt.clearTimeout(r.v),r.v=null)}function YK(r,e){var t=null;if(r.g==e){A_(r),YA(r),r.g=null;var n=2}else{if(!BA(r.i,e))return;t=e.F,xK(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;go(n=__(),new gK(n,t)),N_(r)}else jK(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function tIe(r,e){return!(kK(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=vd(Uo(r.Na,r,e),KK(r,r.C)),r.C++,0)))}(r,e)||2==n&&ZA(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:e0(r,5);break;case 4:e0(r,10);break;case 3:e0(r,6);break;default:e0(r,2)}}function KK(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function e0(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=Uo(r.pb,r);t||(t=new J6("//www.google.com/images/cleardot.gif"),Xt.location&&"http"==Xt.location.protocol||E_(t,"https"),S_(t)),function YAe(r,e){const t=new m_;if(Xt.Image){const n=new Image;n.onload=u_(O_,t,n,"TestLoadImage: loaded",!0,e),n.onerror=u_(O_,t,n,"TestLoadImage: error",!1,e),n.onabort=u_(O_,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=u_(O_,t,n,"TestLoadImage: timeout",!1,e),Xt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else ys(2);r.H=0,r.h&&r.h.za(e),XK(r),UK(r)}function XK(r){if(r.H=0,r.ma=[],r.h){const e=LK(r.i);(0!=e.length||0!=r.j.length)&&(qY(r.ma,e),qY(r.ma,r.j),r.i.i.length=0,pA(r.j),r.j.length=0),r.h.ya()}}function QK(r,e,t){var n=t instanceof J6?i4(t):new J6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),P_(n,n.m);else{var i=Xt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new J6(null);n&&E_(o,n),e&&(o.g=e),i&&P_(o,i),t&&(o.l=t),n=o}return e=r.Da,(t=r.F)&&e&&D1(n,t,e),D1(n,"VER",r.ra),Ad(r,n),n}function JK(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Mr(t&&r.Ha&&!r.va?new Td({ob:!0}):r.va)).Oa(r.J),e}function eX(){}function I_(){if(P5&&!(10<=Number(gAe)))throw Error("Environmental error: no available transport.")}function w2(r,e){Di.call(this),this.g=new BK(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!fd(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!fd(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new T5(this)}function tX(r){DA.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function nX(){HA.call(this),this.status=1}function T5(r){this.g=r}function Ba(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function KA(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var o=r.g[3],s=(e=r.g[0])+(o^(t=r.g[1])&((i=r.g[2])^o))+n[0]+3614090360&4294967295;s=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=t+(s<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=e+(i^o&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=e+(t^i^o)+n[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=e+(i^(t|~o))+n[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(e=t+((s=e+(i^(t|~o))+n[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(e^(o|~t))+n[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+o&4294967295}function d1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var o=0|r[i];n&&o==e||(t[i]=o,n=!1)}this.g=t}(Qe=Mr.prototype).Oa=function(r){this.M=r},Qe.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():VA.g(),this.C=function mK(r){return r.h||(r.h=r.i())}(this.u?this.u:VA),this.g.onreadystatechange=Uo(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(o){return void DK(this,o)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const o of n.keys())t.set(o,n.get(o))}n=Array.from(t.keys()).find(o=>"content-type"==o.toLowerCase()),i=Xt.FormData&&r instanceof Xt.FormData,!(0<=WY(QAe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of t)this.g.setRequestHeader(o,s);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{FK(this),0<this.B&&((this.L=function JAe(r){return P5&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Uo(this.ua,this)):this.A=RA(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(o){DK(this,o)}},Qe.ua=function(){typeof hA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,go(this,"timeout"),this.abort(8))},Qe.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,go(this,"complete"),go(this,"abort"),b_(this))},Qe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),b_(this,!0)),Mr.$.N.call(this)},Qe.La=function(){this.s||(this.G||this.v||this.l?VK(this):this.kb())},Qe.kb=function(){VK(this)},Qe.isActive=function(){return!!this.g},Qe.da=function(){try{return 2<jc(this)?this.g.status:-1}catch{return-1}},Qe.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Qe.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),KAe(e)}},Qe.Ia=function(){return this.m},Qe.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Qe=BK.prototype).ra=8,Qe.H=1,Qe.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new yd(this,this.l,r);let o=this.s;if(this.U&&(o?(o=XY(o),JY(o,this.U)):o=this.U),null!==this.o||this.O||(i.I=o,o=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=qK(this,i,e),D1(t=i4(this.I),"RID",r),D1(t,"CVER",22),this.F&&D1(t,"X-HTTP-Session-Id",this.F),Ad(this,t),o&&(this.O?e="headers="+encodeURIComponent(String(GK(o)))+"&"+e:this.o&&qA(t,this.o,o)),UA(this.i,i),this.bb&&D1(t,"TYPE","init"),this.P?(D1(t,"$req",e),D1(t,"SID","null"),i.aa=!0,$A(i,t,null)):$A(i,t,e),this.H=2}}else 3==this.H&&(r?WK(this,r):0==this.j.length||IK(this.i)||WK(this))},Qe.Ma=function(){if(this.u=null,ZK(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=vd(Uo(this.jb,this),r)}},Qe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ys(10),w_(this),ZK(this))},Qe.ib=function(){null!=this.v&&(this.v=null,w_(this),ZA(this),ys(19))},Qe.pb=function(r){r?(this.l.info("Successfully pinged google.com"),ys(2)):(this.l.info("Failed to ping google.com"),ys(1))},Qe.isActive=function(){return!!this.h&&this.h.isActive(this)},(Qe=eX.prototype).Ba=function(){},Qe.Aa=function(){},Qe.za=function(){},Qe.ya=function(){},Qe.isActive=function(){return!0},Qe.Va=function(){},I_.prototype.g=function(r,e){return new w2(r,e)},zi(w2,Di),w2.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;ys(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=QK(r,null,r.Y),N_(r)},w2.prototype.close=function(){jA(this.g)},w2.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=kA(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&N_(e)},w2.prototype.N=function(){this.g.h=null,delete this.j,jA(this.g),delete this.g,w2.$.N.call(this)},zi(tX,DA),zi(nX,HA),zi(T5,eX),T5.prototype.Ba=function(){go(this.g,"a")},T5.prototype.Aa=function(r){go(this.g,new tX(r))},T5.prototype.za=function(r){go(this.g,new nX)},T5.prototype.ya=function(){go(this.g,"b")},zi(Ba,function nIe(){this.blockSize=-1}),Ba.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ba.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,o=0;o<e;){if(0==i)for(;o<=t;)KA(this,r,o),o+=this.blockSize;if("string"==typeof r){for(;o<e;)if(n[i++]=r.charCodeAt(o++),i==this.blockSize){KA(this,n),i=0;break}}else for(;o<e;)if(n[i++]=r[o++],i==this.blockSize){KA(this,n),i=0;break}}this.h=i,this.i+=e},Ba.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var rIe={};function XA(r){return-128<=r&&128>r?function fAe(r,e){var t=rIe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new d1([0|e],0>e?-1:0)}):new d1([0|r],0>r?-1:0)}function Zc(r){if(isNaN(r)||!isFinite(r))return b5;if(0>r)return po(Zc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=QA;return new d1(e,0)}var QA=4294967296,b5=XA(0),JA=XA(1),iX=XA(16777216);function o4(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function oa(r){return-1==r.h}function po(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new d1(t,~r.h).add(JA)}function k_(r,e){return r.add(po(e))}function x_(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function Id(r,e){this.g=r,this.h=e}function L_(r,e){if(o4(e))throw Error("division by zero");if(o4(r))return new Id(b5,b5);if(oa(r))return e=L_(po(r),e),new Id(po(e.g),po(e.h));if(oa(e))return e=L_(r,po(e)),new Id(po(e.g),e.h);if(30<r.g.length){if(oa(r)||oa(e))throw Error("slowDivide_ only works with positive integers.");for(var t=JA,n=e;0>=n.X(r);)t=oX(t),n=oX(n);var i=w5(t,1),o=w5(n,1);for(n=w5(n,2),t=w5(t,2);!o4(n);){var s=o.add(n);0>=s.X(r)&&(i=i.add(t),o=s),n=w5(n,1),t=w5(t,1)}return e=k_(r,i.R(e)),new Id(i,e)}for(i=b5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),s=(o=Zc(t)).R(e);oa(s)||0<s.X(r);)s=(o=Zc(t-=n)).R(e);o4(o)&&(o=JA),i=i.add(o),r=k_(r,s)}return new Id(i,r)}function oX(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new d1(t,r.h)}function w5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],o=0;o<n;o++)i[o]=0<e?r.D(o+t)>>>e|r.D(o+t+1)<<32-e:r.D(o+t);return new d1(i,r.h)}(Qe=d1.prototype).ea=function(){if(oa(this))return-po(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:QA+n)*e,e*=QA}return r},Qe.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(o4(this))return"0";if(oa(this))return"-"+po(this).toString(r);for(var e=Zc(Math.pow(r,6)),t=this,n="";;){var i=L_(t,e).g,o=((0<(t=k_(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(o4(t=i))return o+n;for(;6>o.length;)o="0"+o;n=o+n}},Qe.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Qe.X=function(r){return oa(r=k_(this,r))?-1:o4(r)?0:1},Qe.abs=function(){return oa(this)?po(this):this},Qe.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var o=n+(65535&this.D(i))+(65535&r.D(i)),s=(o>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=s>>>16,t[i]=(s&=65535)<<16|(o&=65535)}return new d1(t,-2147483648&t[t.length-1]?-1:0)},Qe.R=function(r){if(o4(this)||o4(r))return b5;if(oa(this))return oa(r)?po(this).R(po(r)):po(po(this).R(r));if(oa(r))return po(this.R(po(r)));if(0>this.X(iX)&&0>r.X(iX))return Zc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var o=this.D(n)>>>16,s=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=s*c,x_(t,2*n+2*i),t[2*n+2*i+1]+=o*c,x_(t,2*n+2*i+1),t[2*n+2*i+1]+=s*a,x_(t,2*n+2*i+1),t[2*n+2*i+2]+=o*a,x_(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new d1(t,0)},Qe.gb=function(r){return L_(this,r).h},Qe.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new d1(t,this.h&r.h)},Qe.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new d1(t,this.h|r.h)},Qe.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new d1(t,this.h^r.h)},I_.prototype.createWebChannel=I_.prototype.g,w2.prototype.send=w2.prototype.u,w2.prototype.open=w2.prototype.m,w2.prototype.close=w2.prototype.close,v_.NO_ERROR=0,v_.TIMEOUT=8,v_.HTTP_ERROR=6,pK.COMPLETE="complete",_K.EventType=Cd,Cd.OPEN="a",Cd.CLOSE="b",Cd.ERROR="c",Cd.MESSAGE="d",Di.prototype.listen=Di.prototype.O,Mr.prototype.listenOnce=Mr.prototype.P,Mr.prototype.getLastError=Mr.prototype.Sa,Mr.prototype.getLastErrorCode=Mr.prototype.Ia,Mr.prototype.getStatus=Mr.prototype.da,Mr.prototype.getResponseJson=Mr.prototype.Wa,Mr.prototype.getResponseText=Mr.prototype.ja,Mr.prototype.send=Mr.prototype.ha,Mr.prototype.setWithCredentials=Mr.prototype.Oa,Ba.prototype.digest=Ba.prototype.l,Ba.prototype.reset=Ba.prototype.reset,Ba.prototype.update=Ba.prototype.j,d1.prototype.add=d1.prototype.add,d1.prototype.multiply=d1.prototype.R,d1.prototype.modulo=d1.prototype.gb,d1.prototype.compare=d1.prototype.X,d1.prototype.toNumber=d1.prototype.ea,d1.prototype.toString=d1.prototype.toString,d1.prototype.getBits=d1.prototype.D,d1.fromNumber=Zc,d1.fromString=function rX(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return po(rX(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Zc(Math.pow(e,8)),n=b5,i=0;i<r.length;i+=8){var o=Math.min(8,r.length-i),s=parseInt(r.substring(i,i+o),e);8>o?(o=Zc(Math.pow(e,o)),n=n.R(o).add(Zc(s))):n=(n=n.R(t)).add(Zc(s))}return n};var iIe=Ga.createWebChannelTransport=function(){return new I_},oIe=Ga.getStatEventTarget=function(){return __()},eI=Ga.ErrorCode=v_,sIe=Ga.EventType=pK,aIe=Ga.Event=X6,sX=Ga.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},cIe=Ga.FetchXmlHttpFactory=Td,R_=Ga.WebChannel=_K,lIe=Ga.XhrIo=Mr,uIe=Ga.Md5=Ba,N5=Ga.Integer=d1;const aX="@firebase/firestore";class Hi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hi.UNAUTHENTICATED=new Hi(null),Hi.GOOGLE_CREDENTIALS=new Hi("google-credentials-uid"),Hi.FIRST_PARTY=new Hi("first-party-uid"),Hi.MOCK_USER=new Hi("mock-user");let A5="9.23.0";const ml=new d5("@firebase/firestore");function tI(){return ml.logLevel}function be(r,...e){if(ml.logLevel<=Wn.DEBUG){const t=e.map(nI);ml.debug(`Firestore (${A5}): ${r}`,...t)}}function Fr(r,...e){if(ml.logLevel<=Wn.ERROR){const t=e.map(nI);ml.error(`Firestore (${A5}): ${r}`,...t)}}function Ua(r,...e){if(ml.logLevel<=Wn.WARN){const t=e.map(nI);ml.warn(`Firestore (${A5}): ${r}`,...t)}}function nI(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function lt(r="Unexpected state"){const e=`FIRESTORE (${A5}) INTERNAL ASSERTION FAILED: `+r;throw Fr(e),new Error(e)}function pt(r,e){r||lt()}function je(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends T2{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class cX{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fIe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Hi.UNAUTHENTICATED))}shutdown(){}}class dIe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class hIe{constructor(e){this.t=e,this.currentUser=Hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const o=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pi,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(M(function*(){yield l.promise,yield o(n.currentUser)}))},c=l=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pi)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pt("string"==typeof n.accessToken),new cX(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return pt(null===e||"string"==typeof e),new Hi(e)}}class gIe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Hi.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class pIe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new gIe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Hi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lX{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mIe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=o=>{null!=o.error&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.T;return this.T=o.token,be("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.I.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.I.getImmediate({optional:!0});o?i(o):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(pt("string"==typeof t.token),this.T=t.token,new lX(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function _Ie(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class uX{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=_Ie(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[o]%62))}return n}}function Zt(r,e){return r<e?-1:r>e?1:0}function I5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class sr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return sr.fromMillis(Date.now())}static fromDate(e){return sr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new sr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Zt(this.nanoseconds,e.nanoseconds):Zt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class vt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new vt(e)}static min(){return new vt(new sr(0,0))}static max(){return new vt(new sr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class kd{constructor(e,t,n){void 0===t?t=0:t>e.length&&lt(),void 0===n?n=e.length-t:n>e.length-t&&lt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===kd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof kd?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Vn extends kd{construct(e,t,n){return new Vn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Vn(t)}static emptyPath(){return new Vn([])}}const vIe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $r extends kd{construct(e,t,n){return new $r(e,t,n)}static isValidIdentifier(e){return vIe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new $r(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const o=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $r(t)}static emptyPath(){return new $r([])}}class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(Vn.fromString(e))}static fromName(e){return new Ue(Vn.fromString(e).popFirst(5))}static empty(){return new Ue(Vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Vn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Vn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new Vn(e.slice()))}}function hX(r){return new N2(r.readTime,r.key,-1)}class N2{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new N2(vt.min(),Ue.empty(),-1)}static max(){return new N2(vt.max(),Ue.empty(),-1)}}function iI(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ue.comparator(r.documentKey,e.documentKey),0!==t?t:Zt(r.largestBatchId,e.largestBatchId))}const gX="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MIe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function _l(r){return oI.apply(this,arguments)}function oI(){return oI=M(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==gX)throw r;be("LocalStore","Unexpectedly lost primary lease")}),oI.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>n(c))}),s=!0,o===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,o)=>{n.push(t.call(this,i,o))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const o=e.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const l=c;t(e[l]).next(f=>{s[l]=f,++a,a===o&&n(s)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const o=()=>{!0===e()?t().next(()=>{o()},i):n()};o()})}}function vl(r){return"IndexedDbTransactionError"===r.name}let A2=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function Rd(r){return null==r}function zd(r){return 0===r&&1/r==-1/0}function PX(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Cl(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function SX(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class A1{constructor(e,t){this.comparator=e,this.root=t||mo.EMPTY}insert(e,t){return new A1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mo.BLACK,null,null))}remove(e){return new A1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new F_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new F_(this.root,e,this.comparator,!1)}getReverseIterator(){return new F_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new F_(this.root,e,this.comparator,!0)}}class F_{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mo{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??mo.RED,this.left=i??mo.EMPTY,this.right=o??mo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new mo(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===o?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return mo.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw lt();const e=this.left.check();if(e!==this.right.check())throw lt();return e+(this.isRed()?0:1)}}mo.EMPTY=null,mo.RED=!0,mo.BLACK=!1,mo.EMPTY=new class{constructor(){this.size=0}get key(){throw lt()}get value(){throw lt()}get color(){throw lt()}get left(){throw lt()}get right(){throw lt()}copy(r,e,t,n,i){return this}insert(r,e,t){return new mo(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class H1{constructor(e){this.comparator=e,this.data=new A1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new OX(this.data.getIterator())}getIteratorFrom(e){return new OX(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof H1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new H1(this.comparator);return t.data=e,t}}class OX{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Qs{constructor(e){this.fields=e,e.sort($r.comparator)}static empty(){return new Qs([])}unionWith(e){let t=new H1($r.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Qs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return I5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class TX extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class mi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new TX("Invalid base64 string: "+i):i}}(e);return new mi(t)}static fromUint8Array(e){const t=function(n){let i="";for(let o=0;o<n.length;++o)i+=String.fromCharCode(n[o]);return i}(e);return new mi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Zt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mi.EMPTY_BYTE_STRING=new mi("");const UIe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yl(r){if(pt(!!r),"string"==typeof r){let e=0;const t=UIe.exec(r);if(pt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Er(r.seconds),nanos:Er(r.nanos)}}function Er(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function s4(r){return"string"==typeof r?mi.fromBase64String(r):mi.fromUint8Array(r)}function $_(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function G_(r){const e=r.mapValue.fields.__previous_value__;return $_(e)?G_(e):e}function Dd(r){const e=yl(r.mapValue.fields.__local_write_time__.timestampValue);return new sr(e.seconds,e.nanos)}class WIe{constructor(e,t,n,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class r0{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new r0("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof r0&&e.projectId===this.projectId&&e.database===this.database}}const Ml={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function El(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?$_(r)?4:AX(r)?9007199254740991:10:lt()}function Kc(r,e){if(r===e)return!0;const t=El(r);if(t!==El(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Dd(r).isEqual(Dd(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const o=yl(n.timestampValue),s=yl(i.timestampValue);return o.seconds===s.seconds&&o.nanos===s.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,s4(r.bytesValue).isEqual(s4(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return Er(n.geoPointValue.latitude)===Er(i.geoPointValue.latitude)&&Er(n.geoPointValue.longitude)===Er(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return Er(n.integerValue)===Er(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const o=Er(n.doubleValue),s=Er(i.doubleValue);return o===s?zd(o)===zd(s):isNaN(o)&&isNaN(s)}return!1}(r,e);case 9:return I5(r.arrayValue.values||[],e.arrayValue.values||[],Kc);case 10:return function(n,i){const o=n.mapValue.fields||{},s=i.mapValue.fields||{};if(PX(o)!==PX(s))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(void 0===s[a]||!Kc(o[a],s[a])))return!1;return!0}(r,e);default:return lt()}var i}function Hd(r,e){return void 0!==(r.values||[]).find(t=>Kc(t,e))}function Pl(r,e){if(r===e)return 0;const t=El(r),n=El(e);if(t!==n)return Zt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Zt(r.booleanValue,e.booleanValue);case 2:return function(i,o){const s=Er(i.integerValue||i.doubleValue),a=Er(o.integerValue||o.doubleValue);return s<a?-1:s>a?1:s===a?0:isNaN(s)?isNaN(a)?0:-1:1}(r,e);case 3:return bX(r.timestampValue,e.timestampValue);case 4:return bX(Dd(r),Dd(e));case 5:return Zt(r.stringValue,e.stringValue);case 6:return function(i,o){const s=s4(i),a=s4(o);return s.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,o){const s=i.split("/"),a=o.split("/");for(let c=0;c<s.length&&c<a.length;c++){const l=Zt(s[c],a[c]);if(0!==l)return l}return Zt(s.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,o){const s=Zt(Er(i.latitude),Er(o.latitude));return 0!==s?s:Zt(Er(i.longitude),Er(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,o){const s=i.values||[],a=o.values||[];for(let c=0;c<s.length&&c<a.length;++c){const l=Pl(s[c],a[c]);if(l)return l}return Zt(s.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===Ml.mapValue&&o===Ml.mapValue)return 0;if(i===Ml.mapValue)return 1;if(o===Ml.mapValue)return-1;const s=i.fields||{},a=Object.keys(s),c=o.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=Zt(a[f],l[f]);if(0!==d)return d;const m=Pl(s[a[f]],c[l[f]]);if(0!==m)return m}return Zt(a.length,l.length)}(r.mapValue,e.mapValue);default:throw lt()}}function bX(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return Zt(r,e);const t=yl(r),n=yl(e),i=Zt(t.seconds,n.seconds);return 0!==i?i:Zt(t.nanos,n.nanos)}function x5(r){return cI(r)}function cI(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=yl(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?s4(r.bytesValue).toBase64():"referenceValue"in r?Ue.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",o=!0;for(const s of n.values||[])o?o=!1:i+=",",i+=cI(s);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let o="{",s=!0;for(const a of i)s?s=!1:o+=",",o+=`${a}:${cI(n.fields[a])}`;return o+"}"}(r.mapValue):lt();var e}function o0(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function lI(r){return!!r&&"integerValue"in r}function Vd(r){return!!r&&"arrayValue"in r}function wX(r){return!!r&&"nullValue"in r}function NX(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function W_(r){return!!r&&"mapValue"in r}function Fd(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Cl(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Fd(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fd(r.arrayValue.values[t]);return e}return Object.assign({},r)}function AX(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class _o{constructor(e){this.value=e}static empty(){return new _o({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!W_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fd(t)}setAll(e){let t=$r.emptyPath(),n={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}s?n[a.lastSegment()]=Fd(s):i.push(a.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){const t=this.field(e.popLast());W_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Kc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];W_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Cl(t,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new _o(Fd(this.value))}}function xX(r){const e=[];return Cl(r.fields,(t,n)=>{const i=new $r([t]);if(W_(n)){const o=xX(n.mapValue).fields;if(0===o.length)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Qs(e)}class V1{constructor(e,t,n,i,o,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new V1(e,0,vt.min(),vt.min(),vt.min(),_o.empty(),0)}static newFoundDocument(e,t,n,i){return new V1(e,1,t,vt.min(),n,i,0)}static newNoDocument(e,t){return new V1(e,2,t,vt.min(),vt.min(),_o.empty(),0)}static newUnknownDocument(e,t){return new V1(e,3,t,vt.min(),vt.min(),_o.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(vt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_o.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_o.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof V1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new V1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Sl{constructor(e,t){this.position=e,this.inclusive=t}}function LX(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const o=e[i],s=r.position[i];if(n=o.field.isKeyField()?Ue.comparator(Ue.fromName(s.referenceValue),t.key):Pl(s,t.data.field(o.field)),"desc"===o.dir&&(n*=-1),0!==n)break}return n}function RX(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Kc(r.position[t],e.position[t]))return!1;return!0}class L5{constructor(e,t="asc"){this.field=e,this.dir=t}}function ZIe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class zX{}class Tn extends zX{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new YIe(e,t,n):"array-contains"===t?new QIe(e,n):"in"===t?new GX(e,n):"not-in"===t?new JIe(e,n):"array-contains-any"===t?new eke(e,n):new Tn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new KIe(e,n):new XIe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Pl(t,this.value)):null!==t&&El(this.value)===El(t)&&this.matchesComparison(Pl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return lt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class h1 extends zX{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new h1(e,t)}matches(e){return R5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function R5(r){return"and"===r.op}function fI(r){return function DX(r){for(const e of r.filters)if(e instanceof h1)return!1;return!0}(r)&&R5(r)}function dI(r){if(r instanceof Tn)return r.field.canonicalString()+r.op.toString()+x5(r.value);if(fI(r))return r.filters.map(e=>dI(e)).join(",");{const e=r.filters.map(t=>dI(t)).join(",");return`${r.op}(${e})`}}function HX(r,e){return r instanceof Tn?(t=r,(n=e)instanceof Tn&&t.op===n.op&&t.field.isEqual(n.field)&&Kc(t.value,n.value)):r instanceof h1?function(t,n){return n instanceof h1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,o,s)=>i&&HX(o,n.filters[s]),!0)}(r,e):void lt();var t,n}function FX(r){return r instanceof Tn?`${(e=r).field.canonicalString()} ${e.op} ${x5(e.value)}`:r instanceof h1?function(e){return e.op.toString()+" {"+e.getFilters().map(FX).join(" ,")+"}"}(r):"Filter";var e}class YIe extends Tn{constructor(e,t,n){super(e,t,n),this.key=Ue.fromName(n.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class KIe extends Tn{constructor(e,t){super(e,"in",t),this.keys=$X(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class XIe extends Tn{constructor(e,t){super(e,"not-in",t),this.keys=$X(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $X(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ue.fromName(n.referenceValue))}class QIe extends Tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vd(t)&&Hd(t.arrayValue,this.value)}}class GX extends Tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Hd(this.value.arrayValue,t)}}class JIe extends Tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Hd(this.value.arrayValue,t)}}class eke extends Tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Hd(this.value.arrayValue,n))}}class tke{constructor(e,t=null,n=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.dt=null}}function hI(r,e=null,t=[],n=[],i=null,o=null,s=null){return new tke(r,e,t,n,i,o,s)}function s0(r){const e=je(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>dI(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),Rd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>x5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>x5(n)).join(",")),e.dt=t}return e.dt}function $d(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!ZIe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!HX(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!RX(r.startAt,e.startAt)&&RX(r.endAt,e.endAt)}function q_(r){return Ue.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class a4{constructor(e,t=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function z5(r){return new a4(r)}function qX(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function gI(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function Z_(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function pI(r){return null!==r.collectionGroup}function a0(r){const e=je(r);if(null===e.wt){e.wt=[];const t=Z_(e),n=gI(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new L5(t)),e.wt.push(new L5($r.keyField(),"asc"));else{let i=!1;for(const o of e.explicitOrderBy)e.wt.push(o),o.field.isKeyField()&&(i=!0);if(!i){const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new L5($r.keyField(),o))}}}return e.wt}function Ms(r){const e=je(r);if(!e._t)if("F"===e.limitType)e._t=hI(e.path,e.collectionGroup,a0(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const o of a0(e))t.push(new L5(o.field,"desc"===o.dir?"asc":"desc"));const n=e.endAt?new Sl(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Sl(e.startAt.position,e.startAt.inclusive):null;e._t=hI(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function mI(r,e){e.getFirstInequalityField(),Z_(r);const t=r.filters.concat([e]);return new a4(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Y_(r,e,t){return new a4(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Gd(r,e){return $d(Ms(r),Ms(e))&&r.limitType===e.limitType}function jX(r){return`${s0(Ms(r))}|lt:${r.limitType}`}function _I(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>FX(n)).join(", ")}]`),Rd(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>x5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>x5(n)).join(",")),`Target(${t})`}(Ms(r))}; limitType=${r.limitType})`}function Bd(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ue.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of a0(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,o,s){const a=LX(i,o,s);return i.inclusive?a<=0:a<0}(t.startAt,a0(t),n)||t.endAt&&!function(i,o,s){const a=LX(i,o,s);return i.inclusive?a>=0:a>0}(t.endAt,a0(t),n)));var t,n}function YX(r){return(e,t)=>{let n=!1;for(const i of a0(r)){const o=nke(i,e,t);if(0!==o)return o;n=n||i.field.isKeyField()}return 0}}function nke(r,e,t){const n=r.field.isKeyField()?Ue.comparator(e.key,t.key):function(i,o,s){const a=o.data.field(i),c=s.data.field(i);return null!==a&&null!==c?Pl(a,c):lt()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return lt()}}class c4{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,o]of n)if(this.equalsFn(i,e))return o}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Cl(this.inner,(t,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return SX(this.inner)}size(){return this.innerSize}}const rke=new A1(Ue.comparator);function Js(){return rke}const KX=new A1(Ue.comparator);function Ud(...r){let e=KX;for(const t of r)e=e.insert(t.key,t);return e}function XX(r){let e=KX;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Xc(){return Wd()}function QX(){return Wd()}function Wd(){return new c4(r=>r.toString(),(r,e)=>r.isEqual(e))}const ike=new A1(Ue.comparator),oke=new H1(Ue.comparator);function an(...r){let e=oke;for(const t of r)e=e.add(t);return e}const ske=new H1(Zt);function JX(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zd(e)?"-0":e}}function eQ(r){return{integerValue:""+r}}function tQ(r,e){return function mX(r){return"number"==typeof r&&Number.isInteger(r)&&!zd(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?eQ(e):JX(r,e)}class K_{constructor(){this._=void 0}}function ake(r,e,t){return r instanceof D5?function(n,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&$_(i)&&(i=G_(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):r instanceof c0?rQ(r,e):r instanceof l0?iQ(r,e):function(n,i){const o=nQ(n,i),s=oQ(o)+oQ(n.gt);return lI(o)&&lI(n.gt)?eQ(s):JX(n.serializer,s)}(r,e)}function cke(r,e,t){return r instanceof c0?rQ(r,e):r instanceof l0?iQ(r,e):t}function nQ(r,e){return r instanceof H5?lI(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class D5 extends K_{}class c0 extends K_{constructor(e){super(),this.elements=e}}function rQ(r,e){const t=sQ(e);for(const n of r.elements)t.some(i=>Kc(i,n))||t.push(n);return{arrayValue:{values:t}}}class l0 extends K_{constructor(e){super(),this.elements=e}}function iQ(r,e){let t=sQ(e);for(const n of r.elements)t=t.filter(i=>!Kc(i,n));return{arrayValue:{values:t}}}class H5 extends K_{constructor(e,t){super(),this.serializer=e,this.gt=t}}function oQ(r){return Er(r.integerValue||r.doubleValue)}function sQ(r){return Vd(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class qd{constructor(e,t){this.field=e,this.transform=t}}class uke{constructor(e,t){this.version=e,this.transformResults=t}}class J1{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new J1}static exists(e){return new J1(void 0,e)}static updateTime(e){return new J1(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function X_(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class Q_{}function aQ(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new F5(r.key,J1.none()):new V5(r.key,r.data,J1.none());{const t=r.data,n=_o.empty();let i=new H1($r.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);null===s&&o.length>1&&(o=o.popLast(),s=t.field(o)),null===s?n.delete(o):n.set(o,s),i=i.add(o)}return new l4(r.key,n,new Qs(i.toArray()),J1.none())}}function fke(r,e,t){r instanceof V5?function(n,i,o){const s=n.value.clone(),a=uQ(n.fieldTransforms,i,o.transformResults);s.setAll(a),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()}(r,e,t):r instanceof l4?function(n,i,o){if(!X_(n.precondition,i))return void i.convertToUnknownDocument(o.version);const s=uQ(n.fieldTransforms,i,o.transformResults),a=i.data;a.setAll(lQ(n)),a.setAll(s),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function jd(r,e,t,n){return r instanceof V5?function(i,o,s,a){if(!X_(i.precondition,o))return s;const c=i.value.clone(),l=fQ(i.fieldTransforms,a,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof l4?function(i,o,s,a){if(!X_(i.precondition,o))return s;const c=fQ(i.fieldTransforms,a,o),l=o.data;return l.setAll(lQ(i)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null===s?null:s.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(s=t,X_(r.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):s);var o,s}function dke(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),o=nQ(n.transform,i||null);null!=o&&(null===t&&(t=_o.empty()),t.set(n.field,o))}return t||null}function cQ(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&I5(t,n,(i,o)=>function lke(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof c0&&n instanceof c0||t instanceof l0&&n instanceof l0?I5(t.elements,n.elements,Kc):t instanceof H5&&n instanceof H5?Kc(t.gt,n.gt):t instanceof D5&&n instanceof D5);var t,n}(i,o))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class V5 extends Q_{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class l4 extends Q_{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function lQ(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function uQ(r,e,t){const n=new Map;pt(r.length===t.length);for(let i=0;i<t.length;i++){const o=r[i],s=o.transform,a=e.data.field(o.field);n.set(o.field,cke(s,a,t[i]))}return n}function fQ(r,e,t){const n=new Map;for(const i of r){const o=i.transform,s=t.data.field(i.field);n.set(i.field,ake(o,s,e))}return n}class F5 extends Q_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CI extends Q_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yI{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&fke(o,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=jd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=jd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=QX();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const c=aQ(s,a);null!==c&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(vt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),an())}isEqual(e){return this.batchId===e.batchId&&I5(this.mutations,e.mutations,(t,n)=>cQ(t,n))&&I5(this.baseMutations,e.baseMutations,(t,n)=>cQ(t,n))}}class MI{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){pt(e.mutations.length===n.length);let i=ike;const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new MI(e,t,n,i)}}class EI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class gke{constructor(e,t){this.count=e,this.unchangedNames=t}}var oi,Fn;function hQ(r){if(void 0===r)return Fr("GRPC error has no .code"),fe.UNKNOWN;switch(r){case oi.OK:return fe.OK;case oi.CANCELLED:return fe.CANCELLED;case oi.UNKNOWN:return fe.UNKNOWN;case oi.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case oi.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case oi.INTERNAL:return fe.INTERNAL;case oi.UNAVAILABLE:return fe.UNAVAILABLE;case oi.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case oi.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case oi.NOT_FOUND:return fe.NOT_FOUND;case oi.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case oi.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case oi.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case oi.ABORTED:return fe.ABORTED;case oi.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case oi.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case oi.DATA_LOSS:return fe.DATA_LOSS;default:return lt()}}(Fn=oi||(oi={}))[Fn.OK=0]="OK",Fn[Fn.CANCELLED=1]="CANCELLED",Fn[Fn.UNKNOWN=2]="UNKNOWN",Fn[Fn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fn[Fn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fn[Fn.NOT_FOUND=5]="NOT_FOUND",Fn[Fn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fn[Fn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fn[Fn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fn[Fn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fn[Fn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fn[Fn.ABORTED=10]="ABORTED",Fn[Fn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fn[Fn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fn[Fn.INTERNAL=13]="INTERNAL",Fn[Fn.UNAVAILABLE=14]="UNAVAILABLE",Fn[Fn.DATA_LOSS=15]="DATA_LOSS";class PI{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return J_}static getOrCreateInstance(){return null===J_&&(J_=new PI),J_}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let J_=null;const pke=new N5([4294967295,4294967295],0);function pQ(r){const e=function gQ(){return new TextEncoder}().encode(r),t=new uIe;return t.update(e),new Uint8Array(t.digest())}function mQ(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new N5([t,n],0),new N5([i,o],0)]}class SI{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Zd(`Invalid padding: ${t}`);if(n<0)throw new Zd(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Zd(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Zd(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=N5.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(N5.fromNumber(n)));return 1===i.compare(pke)&&(i=new N5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=pQ(e),[n,i]=mQ(t);for(let o=0;o<this.hashCount;o++){const s=this.Et(n,i,o);if(!this.At(s))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new SI(o,i,t);return n.forEach(a=>s.insert(a)),s}insert(e){if(0===this.It)return;const t=pQ(e),[n,i]=mQ(t);for(let o=0;o<this.hashCount;o++){const s=this.Et(n,i,o);this.Rt(s)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Zd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Yd{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Kd.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Yd(vt.min(),i,new A1(Zt),Js(),an())}}class Kd{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Kd(n,t,an(),an(),an())}}class ev{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class _Q{constructor(e,t){this.targetId=e,this.Vt=t}}class vQ{constructor(e,t,n=mi.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class CQ{constructor(){this.St=0,this.Dt=MQ(),this.Ct=mi.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=an(),t=an(),n=an();return this.Dt.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:lt()}}),new Kd(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=MQ()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class mke{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Js(),this.zt=yQ(),this.Wt=new A1(Zt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:lt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,o=this.se(n);if(o){const s=o.target;if(q_(s))if(0===i){const a=new Ue(s.path);this.Yt(n,a,V1.newNoDocument(a,vt.min()))}else pt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=PI.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,E,T,L,z,G;const B={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(B.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(L=null===(T=null===(E=de?.bits)||void 0===E?void 0:E.bitmap)||void 0===T?void 0:T.length)&&void 0!==L?L:0,padding:null!==(G=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==G?G:0}),B}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:o="",padding:s=0},hashCount:a=0}=n;let c,l;try{c=s4(o).toUint8Array()}catch(f){if(f instanceof TX)return Ua("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new SI(c,s,a)}catch(f){return Ua(f instanceof Zd?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(o=>{const s=this.Gt.ue(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;t.vt(a)||(this.Yt(e,o,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((o,s)=>{const a=this.se(s);if(a){if(o.current&&q_(a.target)){const c=new Ue(a.target.path);null!==this.jt.get(c)||this.ae(s,c)||this.Yt(s,c,V1.newNoDocument(c,e))}o.Mt&&(t.set(s,o.Ot()),o.Ft())}});let n=an();this.zt.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(o))}),this.jt.forEach((o,s)=>s.setReadTime(e));const i=new Yd(e,t,this.Wt,this.jt,n);return this.jt=Js(),this.zt=yQ(),this.Wt=new A1(Zt),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new CQ,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new H1(Zt),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||be("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new CQ),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function yQ(){return new A1(Ue.comparator)}function MQ(){return new A1(Ue.comparator)}const _ke={asc:"ASCENDING",desc:"DESCENDING"},vke={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Cke={and:"AND",or:"OR"};class yke{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function OI(r,e){return r.useProto3Json||Rd(e)?e:{value:e}}function $5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EQ(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Mke(r,e){return $5(r,e.toTimestamp())}function Gr(r){return pt(!!r),vt.fromTimestamp(function(e){const t=yl(e);return new sr(t.seconds,t.nanos)}(r))}function TI(r,e){return(t=r,new Vn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function PQ(r){const e=Vn.fromString(r);return pt(kQ(e)),e}function Xd(r,e){return TI(r.databaseId,e.path)}function Qc(r,e){const t=PQ(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ue(OQ(t))}function bI(r,e){return TI(r.databaseId,e)}function Qd(r){return new Vn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function OQ(r){return pt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function TQ(r,e,t){return{name:Xd(r,e),fields:t.value.mapValue.fields}}function wQ(r,e){return{documents:[bI(r,e.path)]}}function NI(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=bI(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=bI(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return IQ(h1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(0!==c.length)return c.map(l=>{return{field:Ol((f=l).field),direction:Tke(f.dir)};var f})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const s=OI(r,e.limit);var a,c;return null!==s&&(t.structuredQuery.limit=s),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function NQ(r){let e=function SQ(r){const e=PQ(r);return 4===e.length?Vn.emptyPath():OQ(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){pt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];t.where&&(o=function(f){const d=AQ(f);return d instanceof h1&&fI(d)?d.getFilters():[d]}(t.where));let s=[];t.orderBy&&(s=t.orderBy.map(f=>{return new L5(G5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,Rd(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new Sl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new Sl(f.values||[],!f.before)}(t.endAt)),function WX(r,e,t,n,i,o,s,a){return new a4(r,e,t,n,i,o,s,a)}(e,i,s,o,a,"F",c,l)}function AQ(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=G5(e.unaryFilter.field);return Tn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=G5(e.unaryFilter.field);return Tn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=G5(e.unaryFilter.field);return Tn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=G5(e.unaryFilter.field);return Tn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return lt()}}(r):void 0!==r.fieldFilter?Tn.create(G5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return lt()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return h1.create(e.compositeFilter.filters.map(t=>AQ(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return lt()}}(e.compositeFilter.op))}(r):lt();var e}function Tke(r){return _ke[r]}function bke(r){return vke[r]}function wke(r){return Cke[r]}function Ol(r){return{fieldPath:r.canonicalString()}}function G5(r){return $r.fromServerFormat(r.fieldPath)}function IQ(r){return r instanceof Tn?function(e){if("=="===e.op){if(NX(e.value))return{unaryFilter:{field:Ol(e.field),op:"IS_NAN"}};if(wX(e.value))return{unaryFilter:{field:Ol(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(NX(e.value))return{unaryFilter:{field:Ol(e.field),op:"IS_NOT_NAN"}};if(wX(e.value))return{unaryFilter:{field:Ol(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ol(e.field),op:bke(e.op),value:e.value}}}(r):r instanceof h1?function(e){const t=e.getFilters().map(n=>IQ(n));return 1===t.length?t[0]:{compositeFilter:{op:wke(e.op),filters:t}}}(r):lt()}function Nke(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function kQ(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class u4{constructor(e,t,n,i,o=vt.min(),s=vt.min(),a=mi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new u4(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new u4(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new u4(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new u4(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class xQ{constructor(e){this.fe=e}}function AI(r){const e=NQ({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?Y_(e,e.limit,"L"):e}class h0{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Er(e.integerValue));else if("doubleValue"in e){const n=Er(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),zd(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(s4(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?AX(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):lt()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Ue.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}h0.Ve=new h0;class Hke{constructor(){this.rn=new zI}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(N2.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(N2.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class zI{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new H1(Vn.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new H1(Vn.comparator)).toArray()}}new Uint8Array(0);class jo{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new jo(e,jo.DEFAULT_COLLECTION_PERCENTILE,jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}jo.DEFAULT_COLLECTION_PERCENTILE=10,jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jo.DEFAULT=new jo(41943040,jo.DEFAULT_COLLECTION_PERCENTILE,jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jo.DISABLED=new jo(-1,0,0);class p0{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new p0(0)}static Mn(){return new p0(-1)}}class Uke{constructor(){this.changes=new c4(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,V1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class jke{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oJ{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&jd(n.mutation,i,Qs.empty(),sr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,an()).next(()=>n))}getLocalViewOfDocuments(e,t,n=an()){const i=Xc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(o=>{let s=Ud();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){const n=Xc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,an()))}populateOverlays(e,t,n){const i=[];return n.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,n,i){let o=Js();const s=Wd(),a=Wd();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof l4)?o=o.insert(l.key,l):void 0!==f?(s.set(l.key,f.mutation.getFieldMask()),jd(f.mutation,l,f.mutation.getFieldMask(),sr.now())):s.set(l.key,Qs.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,f)=>s.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new jke(f,null!==(d=s.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Wd();let i=new A1((s,a)=>s-a),o=an();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(const a of s)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||Qs.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||an()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=QX();f.forEach(m=>{if(!o.has(m)){const E=aQ(t.get(m),n.get(m));null!==E&&d.set(m,E),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Ue.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):pI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):ce.resolve(Xc());let a=-1,c=o;return s.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,an())).next(f=>({batchId:a,changes:XX(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next(n=>{let i=Ud();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let o=Ud();return this.indexManager.getCollectionParents(e,i).next(s=>ce.forEach(s,a=>{const c=(l=t,f=a.child(i),new a4(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(o=>{i.forEach((a,c)=>{const l=c.getKey();null===o.get(l)&&(o=o.insert(l,V1.newInvalidDocument(l)))});let s=Ud();return o.forEach((a,c)=>{const l=i.get(a);void 0!==l&&jd(l.mutation,c,Qs.empty(),sr.now()),Bd(t,c)&&(s=s.insert(a,c))}),s})}}class Zke{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Gr(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:AI(n.bundledQuery),readTime:Gr(n.readTime)}),ce.resolve();var n}}class Yke{constructor(){this.overlays=new A1(Ue.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Xc();return ce.forEach(t,i=>this.getOverlay(e,i).next(o=>{null!==o&&n.set(i,o)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,o)=>{this.we(e,t,o)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Xc(),o=t.length+1,s=new Ue(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new A1((l,f)=>l-f);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=o.get(l.largestBatchId);null===f&&(f=Xc(),o=o.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=Xc(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const s=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new EI(t,n));let o=this.ls.get(t);void 0===o&&(o=an(),this.ls.set(t,o)),this.ls.set(t,o.add(n.key))}}class DI{constructor(){this.fs=new H1(Fi.ds),this.ws=new H1(Fi._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Fi(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new Fi(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Ue(new Vn([])),n=new Fi(t,e),i=new Fi(t,e+1),o=[];return this.ws.forEachInRange([n,i],s=>{this.ys(s),o.push(s.key)}),o}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ue(new Vn([])),n=new Fi(t,e),i=new Fi(t,e+1);let o=an();return this.ws.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const t=new Fi(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Fi{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ue.comparator(e.key,t.key)||Zt(e.As,t.As)}static _s(e,t){return Zt(e.As,t.As)||Ue.comparator(e.key,t.key)}}class Kke{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new H1(Fi.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const o=this.vs;this.vs++;const s=new yI(o,t,n,i);this.mutationQueue.push(s);for(const a of i)this.Rs=this.Rs.add(new Fi(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(s)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),o=i<0?0:i;return ce.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Fi(t,0),i=new Fi(t,Number.POSITIVE_INFINITY),o=[];return this.Rs.forEachInRange([n,i],s=>{const a=this.Ps(s.As);o.push(a)}),ce.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new H1(Zt);return t.forEach(i=>{const o=new Fi(i,0),s=new Fi(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([o,s],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let o=n;Ue.isDocumentKey(o)||(o=o.child(""));const s=new Fi(new Ue(o),0);let a=new H1(Zt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},s),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){pt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const o=new Fi(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new Fi(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xke{constructor(e){this.Ds=e,this.docs=new A1(Ue.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),o=i?i.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():V1.newInvalidDocument(t))}getEntries(e,t){let n=Js();return t.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():V1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=Js();const s=t.path,a=new Ue(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||iI(hX(f),n)<=0||(i.has(f.key)||Bd(t,f))&&(o=o.insert(f.key,f.mutableCopy()))}return ce.resolve(o)}getAllFromCollectionGroup(e,t,n,i){lt()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Qke(this)}getSize(e){return ce.resolve(this.size)}}class Qke extends Uke{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class Jke{constructor(e){this.persistence=e,this.xs=new c4(t=>s0(t),$d),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.Ns=0,this.ks=new DI,this.targetCount=0,this.Ms=p0.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new p0(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const o=[];return this.xs.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(o).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),ce.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class HI{constructor(e,t){this.$s={},this.overlays={},this.Os=new A2(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Jke(this),this.indexManager=new Hke,this.remoteDocumentCache=new Xke(n=>this.referenceDelegate.Ls(n)),this.serializer=new xQ(t),this.qs=new Zke(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Yke,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new Kke(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){be("MemoryPersistence","Starting transaction:",e);const i=new exe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(o=>this.referenceDelegate.Ks(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class exe extends MIe{constructor(e){super(),this.currentSequenceNumber=e}}class lv{constructor(e){this.persistence=e,this.Qs=new DI,this.js=null}static zs(e){return new lv(e)}get Ws(){if(this.js)return this.js;throw lt()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Ws.add(o.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Ue.fromPath(n);return this.Hs(e,i).next(o=>{o||t.removeEntry(i,vt.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class GI{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=an(),i=an();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new GI(e,t.fromCache,n,i)}}class aJ{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(o=>o||this.Gi(e,t,i,n)).next(o=>o||this.Qi(e,t))}Ki(e,t){if(qX(t))return ce.resolve(null);let n=Ms(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Y_(t,null,"F"),n=Ms(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=an(...o);return this.Ui.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,s,c.readTime)?this.Ki(e,Y_(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return qX(t)||i.isEqual(vt.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(o=>{const s=this.ji(t,o);return this.zi(t,s,n,i)?this.Qi(e,t):(tI()<=Wn.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_I(t)),this.Wi(e,s,t,function dX(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(1e9===n?new sr(t+1,0):new sr(t,n));return new N2(i,Ue.empty(),e)}(i,-1)))})}ji(e,t){let n=new H1(YX(e));return t.forEach((i,o)=>{Bd(e,o)&&(n=n.add(o))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const o="F"===e.limitType?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Qi(e,t){return tI()<=Wn.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",_I(t)),this.Ui.getDocumentsMatchingQuery(e,t,N2.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}}class nxe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new A1(Zt),this.Yi=new c4(o=>s0(o),$d),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oJ(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function lJ(r,e){return BI.apply(this,arguments)}function BI(){return BI=M(function*(r,e){const t=je(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=an();for(const l of i){s.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of o){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:s,addedBatchIds:a}))})})}),BI.apply(this,arguments)}function uJ(r){const e=je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function oxe(r,e){const t=je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function q5(r,e,t){return UI.apply(this,arguments)}function UI(){return UI=M(function*(r,e,t){const n=je(r),i=n.Ji.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!vl(s))throw s;be("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),UI.apply(this,arguments)}function dv(r,e,t){const n=je(r);let i=vt.min(),o=an();return n.persistence.runTransaction("Execute query","readonly",s=>function(a,c,l){const f=je(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,s,Ms(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(s,e,t?i:vt.min(),t?o:an())).next(a=>(function gJ(r,e,t){let n=r.Xi.get(e)||vt.min();t.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),r.Xi.set(e,n)}(n,function ZX(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:o})))}class YI{constructor(){this.activeTargetIds=function vI(){return ske}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _J{constructor(){this.Hr=new YI,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new YI,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cxe{Yr(e){}shutdown(){}}class vJ{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let pv=null;function XI(){return null===pv?pv=268435456+Math.round(2147483648*Math.random()):pv++,"0x"+pv.toString(16)}const lxe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uxe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Zo="WebChannelConnection";class fxe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,o){const s=XI(),a=this.To(e,t);be("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);const c={};return this.Eo(c,i,o),this.Ao(e,a,c,n).then(l=>(be("RestConnection",`Received RPC '${e}' ${s}: `,l),l),l=>{throw Ua("RestConnection",`RPC '${e}' ${s} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,o,s){return this.Io(e,t,n,i,o)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+A5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}To(e,t){return`${this.mo}/v1/${t}:${lxe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const o=XI();return new Promise((s,a)=>{const c=new lIe;c.setWithCredentials(!0),c.listenOnce(sIe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case eI.NO_ERROR:const f=c.getResponseJson();be(Zo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),s(f);break;case eI.TIMEOUT:be(Zo,`RPC '${e}' ${o} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case eI.HTTP_ERROR:const d=c.getStatus();if(be(Zo,`RPC '${e}' ${o} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m?.error;if(E&&E.status&&E.message){const T=function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(E.status);a(new Te(T,E.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:lt()}}finally{be(Zo,`RPC '${e}' ${o} completed.`)}});const l=JSON.stringify(i);be(Zo,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=XI(),o=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=iIe(),a=oIe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new cIe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=o.join("");be(Zo,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=s.createWebChannel(f,c);let m=!1,E=!1;const T=new uxe({ro:z=>{E?be(Zo,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(be(Zo,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),be(Zo,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),L=(z,G,B)=>{z.listen(G,de=>{try{B(de)}catch(ye){setTimeout(()=>{throw ye},0)}})};return L(d,R_.EventType.OPEN,()=>{E||be(Zo,`RPC '${e}' stream ${i} transport opened.`)}),L(d,R_.EventType.CLOSE,()=>{E||(E=!0,be(Zo,`RPC '${e}' stream ${i} transport closed`),T.wo())}),L(d,R_.EventType.ERROR,z=>{E||(E=!0,Ua(Zo,`RPC '${e}' stream ${i} transport errored:`,z),T.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),L(d,R_.EventType.MESSAGE,z=>{var G;if(!E){const B=z.data[0];pt(!!B);const ye=B.error||(null===(G=B[0])||void 0===G?void 0:G.error);if(ye){be(Zo,`RPC '${e}' stream ${i} received error:`,ye);const Le=ye.status;let tt=function(Pn){const Et=oi[Pn];if(void 0!==Et)return hQ(Et)}(Le),gt=ye.message;void 0===tt&&(tt=fe.INTERNAL,gt="Unknown error status: "+Le+" with message "+ye.message),E=!0,T.wo(new Te(tt,gt)),d.close()}else be(Zo,`RPC '${e}' stream ${i} received:`,B),T._o(B)}}),L(a,aIe.STAT_EVENT,z=>{z.stat===sX.PROXY?be(Zo,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===sX.NOPROXY&&be(Zo,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.fo()},0),T}}function mv(){return typeof document<"u"?document:null}function c9(r){return new yke(r,!0)}class QI{constructor(e,t,n=1e3,i=1.5,o=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=o,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&be("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class yJ{constructor(e,t,n,i,o,s,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new QI(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return M(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return M(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return M(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(M(function*(){e.state=0,e.start()}))}tu(e){return be("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dxe extends yJ{constructor(e,t,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function Pke(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:lt(),i=e.targetChange.targetIds||[],o=function(c,l){return c.useProto3Json?(pt(void 0===l||"string"==typeof l),mi.fromBase64String(l||"")):(pt(void 0===l||l instanceof Uint8Array),mi.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(c){const l=void 0===c.code?fe.UNKNOWN:hQ(c.code);return new Te(l,c.message||"")}(s);t=new vQ(n,i,o,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Qc(r,n.document.name),o=Gr(n.document.updateTime),s=n.document.createTime?Gr(n.document.createTime):vt.min(),a=new _o({mapValue:{fields:n.document.fields}}),c=V1.newFoundDocument(i,o,s,a);t=new ev(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Qc(r,n.document),o=n.readTime?Gr(n.readTime):vt.min(),s=V1.newNoDocument(i,o);t=new ev([],n.removedTargetIds||[],s.key,s)}else if("documentRemove"in e){const n=e.documentRemove,i=Qc(r,n.document);t=new ev([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return lt();{const n=e.filter,{count:i=0,unchangedNames:o}=n,s=new gke(i,o);t=new _Q(n.targetId,s)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return vt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?vt.min():o.readTime?Gr(o.readTime):vt.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Qd(this.serializer),t.addTarget=function(i,o){let s;const a=o.target;if(s=q_(a)?{documents:wQ(i,a)}:{query:NI(i,a)},s.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){s.resumeToken=EQ(i,o.resumeToken);const c=OI(i,o.expectedCount);null!==c&&(s.expectedCount=c)}else if(o.snapshotVersion.compareTo(vt.min())>0){s.readTime=$5(i,o.snapshotVersion.toTimestamp());const c=OI(i,o.expectedCount);null!==c&&(s.expectedCount=c)}return s}(this.serializer,e);const n=function Oke(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Qd(this.serializer),t.removeTarget=e,this.Wo(t)}}class hxe extends yJ{constructor(e,t,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(pt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function Ske(r,e){return r&&r.length>0?(pt(void 0!==e),r.map(t=>function(n,i){let o=Gr(n.updateTime?n.updateTime:i);return o.isEqual(vt.min())&&(o=Gr(i)),new uke(o,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Gr(e.commitTime);return this.listener.cu(n,t)}return pt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Qd(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function Jd(r,e){let t;if(e instanceof V5)t={update:TQ(r,e.key,e.value)};else if(e instanceof F5)t={delete:Xd(r,e.key)};else if(e instanceof l4)t={update:TQ(r,e.key,e.data),updateMask:Nke(e.fieldMask)};else{if(!(e instanceof CI))return lt();t={verify:Xd(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const s=o.transform;if(s instanceof D5)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof c0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof l0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof H5)return{fieldPath:o.field.canonicalString(),increment:s.gt};throw lt()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:Mke(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:lt()),t;var i}(this.serializer,n))};this.Wo(t)}}class gxe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Io(e,t,n,i,o)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.vo(e,t,n,o,s,i)).catch(o=>{throw"FirebaseError"===o.name?(o.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Te(fe.UNKNOWN,o.toString())})}terminate(){this.lu=!0}}class mxe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Fr(t),this.mu=!1):be("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class _xe{constructor(e,t,n,i,o){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=o,this.Pu.Yr(a=>{n.enqueueAndForget(M(function*(){var c;Nl(s)&&(be("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(l){const f=je(l);f.vu.add(4),yield j5(f),f.bu.set("Unknown"),f.vu.delete(4),yield l9(f)}),function(l){return c.apply(this,arguments)})(s))}))}),this.bu=new mxe(n,i)}}function l9(r){return ek.apply(this,arguments)}function ek(){return ek=M(function*(r){if(Nl(r))for(const e of r.Ru)yield e(!0)}),ek.apply(this,arguments)}function j5(r){return tk.apply(this,arguments)}function tk(){return tk=M(function*(r){for(const e of r.Ru)yield e(!1)}),tk.apply(this,arguments)}function _v(r,e){const t=je(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),ik(t)?rk(t):Y5(t).Ko()&&nk(t,e))}function u9(r,e){const t=je(r),n=Y5(t);t.Au.delete(e),n.Ko()&&MJ(t,e),0===t.Au.size&&(n.Ko()?n.jo():Nl(t)&&t.bu.set("Unknown"))}function nk(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Y5(r).su(e)}function MJ(r,e){r.Vu.qt(e),Y5(r).iu(e)}function rk(r){r.Vu=new mke({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),Y5(r).start(),r.bu.gu()}function ik(r){return Nl(r)&&!Y5(r).Uo()&&r.Au.size>0}function Nl(r){return 0===je(r).vu.size}function EJ(r){r.Vu=void 0}function vxe(r){return ok.apply(this,arguments)}function ok(){return ok=M(function*(r){r.Au.forEach((e,t)=>{nk(r,e)})}),ok.apply(this,arguments)}function Cxe(r,e){return sk.apply(this,arguments)}function sk(){return sk=M(function*(r,e){EJ(r),ik(r)?(r.bu.Iu(e),rk(r)):r.bu.set("Unknown")}),sk.apply(this,arguments)}function yxe(r,e,t){return ak.apply(this,arguments)}function ak(){return ak=M(function*(r,e,t){if(r.bu.set("Online"),e instanceof vQ&&2===e.state&&e.cause)try{yield(n=M(function*(i,o){const s=o.cause;for(const a of o.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,o){return n.apply(this,arguments)})(r,e)}catch(n){be("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield vv(r,n)}else if(e instanceof ev?r.Vu.Ht(e):e instanceof _Q?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(vt.min()))try{const n=yield uJ(r.localStore);t.compareTo(n)>=0&&(yield function(i,o){const s=i.Vu.ce(o);return s.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,o))}}),s.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(mi.EMPTY_BYTE_STRING,l.snapshotVersion)),MJ(i,a);const f=new u4(l.target,a,c,l.sequenceNumber);nk(i,f)}),i.remoteSyncer.applyRemoteEvent(s)}(r,t))}catch(n){be("RemoteStore","Failed to raise snapshot:",n),yield vv(r,n)}var n}),ak.apply(this,arguments)}function vv(r,e,t){return ck.apply(this,arguments)}function ck(){return ck=M(function*(r,e,t){if(!vl(e))throw e;r.vu.add(1),yield j5(r),r.bu.set("Offline"),t||(t=()=>uJ(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){be("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield l9(r)}))}),ck.apply(this,arguments)}function PJ(r,e){return e().catch(t=>vv(r,t,e))}function Z5(r){return lk.apply(this,arguments)}function lk(){return lk=M(function*(r){const e=je(r),t=Al(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;Mxe(e);)try{const i=yield oxe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,Exe(e,i)}catch(i){yield vv(e,i)}SJ(e)&&OJ(e)}),lk.apply(this,arguments)}function Mxe(r){return Nl(r)&&r.Eu.length<10}function Exe(r,e){r.Eu.push(e);const t=Al(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function SJ(r){return Nl(r)&&!Al(r).Uo()&&r.Eu.length>0}function OJ(r){Al(r).start()}function Pxe(r){return uk.apply(this,arguments)}function uk(){return uk=M(function*(r){Al(r).hu()}),uk.apply(this,arguments)}function Sxe(r){return fk.apply(this,arguments)}function fk(){return fk=M(function*(r){const e=Al(r);for(const t of r.Eu)e.uu(t.mutations)}),fk.apply(this,arguments)}function Oxe(r,e,t){return dk.apply(this,arguments)}function dk(){return dk=M(function*(r,e,t){const n=r.Eu.shift(),i=MI.from(n,e,t);yield PJ(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield Z5(r)}),dk.apply(this,arguments)}function Txe(r,e){return hk.apply(this,arguments)}function hk(){return hk=M(function*(r,e){var t;e&&Al(r).ou&&(yield(t=M(function*(n,i){if(function dQ(r){switch(r){default:return lt();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(o=i.code)&&o!==fe.ABORTED){const s=n.Eu.shift();Al(n).Qo(),yield PJ(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Z5(n)}var o}),function(n,i){return t.apply(this,arguments)})(r,e)),SJ(r)&&OJ(r)}),hk.apply(this,arguments)}function TJ(r,e){return gk.apply(this,arguments)}function gk(){return gk=M(function*(r,e){const t=je(r);t.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const n=Nl(t);t.vu.add(3),yield j5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield l9(t)}),gk.apply(this,arguments)}function mk(){return mk=M(function*(r,e){const t=je(r);e?(t.vu.delete(2),yield l9(t)):e||(t.vu.add(2),yield j5(t),t.bu.set("Unknown"))}),mk.apply(this,arguments)}function Y5(r){return r.Su||(r.Su=function(e,t,n){const i=je(e);return i.fu(),new dxe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:vxe.bind(null,r),ao:Cxe.bind(null,r),nu:yxe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Su.Qo(),ik(r)?rk(r):r.bu.set("Unknown")):(yield r.Su.stop(),EJ(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function Al(r){return r.Du||(r.Du=function(e,t,n){const i=je(e);return i.fu(),new hxe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:Pxe.bind(null,r),ao:Txe.bind(null,r),au:Sxe.bind(null,r),cu:Oxe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Du.Qo(),yield Z5(r)):(yield r.Du.stop(),r.Eu.length>0&&(be("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class _k{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}static createAndSchedule(e,t,n,i,o){const s=Date.now()+n,a=new _k(e,t,s,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function K5(r,e){if(Fr("AsyncQueue",`${e}: ${r}`),vl(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class X5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ue.comparator(t.key,n.key):(t,n)=>Ue.comparator(t.key,n.key),this.keyedMap=Ud(),this.sortedSet=new A1(this.comparator)}static emptySet(e){return new X5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof X5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new X5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class bJ{constructor(){this.Cu=new A1(Ue.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):lt():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class Q5{constructor(e,t,n,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,o){const s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new Q5(e,t,X5.emptySet(t),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class bxe{constructor(){this.Nu=void 0,this.listeners=[]}}class wxe{constructor(){this.queries=new c4(e=>jX(e),Gd),this.onlineState="Unknown",this.ku=new Set}}function vk(r,e){return Ck.apply(this,arguments)}function Ck(){return Ck=M(function*(r,e){const t=je(r),n=e.query;let i=!1,o=t.queries.get(n);if(o||(i=!0,o=new bxe),i)try{o.Nu=yield t.onListen(n)}catch(s){const a=K5(s,`Initialization of query '${_I(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,o),o.listeners.push(e),e.Mu(t.onlineState),o.Nu&&e.$u(o.Nu)&&Ek(t)}),Ck.apply(this,arguments)}function yk(r,e){return Mk.apply(this,arguments)}function Mk(){return Mk=M(function*(r,e){const t=je(r),n=e.query;let i=!1;const o=t.queries.get(n);if(o){const s=o.listeners.indexOf(e);s>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),Mk.apply(this,arguments)}function Nxe(r,e){const t=je(r);let n=!1;for(const i of e){const s=t.queries.get(i.query);if(s){for(const a of s.listeners)a.$u(i)&&(n=!0);s.Nu=i}}n&&Ek(t)}function Axe(r,e,t){const n=je(r),i=n.queries.get(e);if(i)for(const o of i.listeners)o.onError(t);n.queries.delete(e)}function Ek(r){r.ku.forEach(e=>{e.next()})}class Pk{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new Q5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=Q5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class AJ{constructor(e){this.key=e}}class IJ{constructor(e){this.key=e}}class kJ{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=an(),this.mutatedKeys=an(),this.tc=YX(e),this.ec=new X5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new bJ,i=t?t.ec:this.ec;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),E=Bd(this.query,d)?d:null,T=!!m&&this.mutatedKeys.has(m.key),L=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;m&&E?m.data.isEqual(E.data)?T!==L&&(n.track({type:3,doc:E}),z=!0):this.rc(m,E)||(n.track({type:2,doc:E}),z=!0,(c&&this.tc(E,c)>0||l&&this.tc(E,l)<0)&&(a=!0)):!m&&E?(n.track({type:0,doc:E}),z=!0):m&&!E&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(E?(s=s.add(E),o=L?o.add(f):o.delete(f)):(s=s.delete(f),o=o.delete(f)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const f="F"===this.query.limitType?s.last():s.first();s=s.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{ec:s,ic:n,zi:a,mutatedKeys:o}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const o=e.ic.xu();o.sort((l,f)=>function(d,m){const E=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt()}};return E(d)-E(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const s=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==o.length||c?{snapshot:new Q5(this.query,e.ec,i,o,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new bJ,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=an(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new IJ(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new AJ(n))}),t}hc(e){this.Yu=e.ir,this.Zu=an();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Q5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class xxe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Lxe{constructor(e){this.key=e,this.fc=!1}}class Rxe{constructor(e,t,n,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new c4(a=>jX(a),Gd),this._c=new Map,this.mc=new Set,this.gc=new A1(Ue.comparator),this.yc=new Map,this.Ic=new DI,this.Tc={},this.Ec=new Map,this.Ac=p0.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function zxe(r,e){return Sk.apply(this,arguments)}function Sk(){return Sk=M(function*(r,e){const t=function jk(r){const e=je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=xJ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wxe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vxe.bind(null,e),e.dc.nu=Nxe.bind(null,e.eventManager),e.dc.Pc=Axe.bind(null,e.eventManager),e}(r);let n,i;const o=t.wc.get(e);if(o)n=o.targetId,t.sharedClientState.addLocalQueryTarget(n),i=o.view.lc();else{const s=yield function W5(r,e){const t=je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(o=>o?(i=o,ce.resolve(i)):t.Bs.allocateTargetId(n).next(s=>(i=new u4(e,s,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,Ms(e)),a=t.sharedClientState.addLocalQueryTarget(s.targetId);n=s.targetId,i=yield function Ok(r,e,t,n,i){return Tk.apply(this,arguments)}(t,e,n,"current"===a,s.resumeToken),t.isPrimaryClient&&_v(t.remoteStore,s)}return i}),Sk.apply(this,arguments)}function Tk(){return Tk=M(function*(r,e,t,n,i){r.Rc=(d,m,E)=>{return(T=M(function*(L,z,G,B){let de=z.view.sc(G);de.zi&&(de=yield dv(L.localStore,z.query,!1).then(({documents:tt})=>z.view.sc(tt,de)));const ye=B&&B.targetChanges.get(z.targetId),Le=z.view.applyChanges(de,L.isPrimaryClient,ye);return zk(L,z.targetId,Le.cc),Le.snapshot}),function(L,z,G,B){return T.apply(this,arguments)})(r,d,m,E);var T};const o=yield dv(r.localStore,e,!0),s=new kJ(e,o.ir),a=s.sc(o.documents),c=Kd.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=s.applyChanges(a,r.isPrimaryClient,c);zk(r,t,l.cc);const f=new xxe(e,t,s);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Tk.apply(this,arguments)}function Dxe(r,e){return bk.apply(this,arguments)}function bk(){return bk=M(function*(r,e){const t=je(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(o=>!Gd(o,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield q5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),u9(t.remoteStore,n.targetId),J5(t,n.targetId)}).catch(_l))):(J5(t,n.targetId),yield q5(t.localStore,n.targetId,!0))}),bk.apply(this,arguments)}function wk(){return wk=M(function*(r,e,t){const n=function Zk(r){const e=je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Fxe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$xe.bind(null,e),e}(r);try{const i=yield function(o,s){const a=je(o),c=sr.now(),l=s.reduce((m,E)=>m.add(E.key),an());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=Js(),T=an();return a.Zi.getEntries(m,l).next(L=>{E=L,E.forEach((z,G)=>{G.isValidDocument()||(T=T.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,E)).next(L=>{f=L;const z=[];for(const G of s){const B=dke(G,f.get(G.key).overlayedDocument);null!=B&&z.push(new l4(G.key,B,xX(B.value.mapValue),J1.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,s)}).next(L=>{d=L;const z=L.applyToLocalDocumentSet(f,T);return a.documentOverlayCache.saveOverlays(m,L.batchId,z)})}).then(()=>({batchId:d.batchId,changes:XX(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,s,a){let c=o.Tc[o.currentUser.toKey()];c||(c=new A1(Zt)),c=c.insert(s,a),o.Tc[o.currentUser.toKey()]=c}(n,i.batchId,t),yield f4(n,i.changes),yield Z5(n.remoteStore)}catch(i){const o=K5(i,"Failed to persist write");t.reject(o)}}),wk.apply(this,arguments)}function xJ(r,e){return Nk.apply(this,arguments)}function Nk(){return Nk=M(function*(r,e){const t=je(r);try{const n=yield function ixe(r,e){const t=je(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(o,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(o,f.addedDocuments,d)));let E=m.withSequenceNumber(o.currentSequenceNumber);var T,L,z;null!==e.targetMismatches.get(d)?E=E.withResumeToken(mi.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(d,E),L=E,z=f,(0===(T=m).resumeToken.approximateByteSize()||L.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(o,E))});let c=Js(),l=an();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,f))}),a.push(function fJ(r,e,t){let n=an(),i=an();return t.forEach(o=>n=n.add(o)),e.getEntries(r,n).next(o=>{let s=Js();return t.forEach((a,c)=>{const l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(vt.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):be("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:s,sr:i}})}(o,s,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(vt.min())){const f=t.Bs.getLastRemoteSnapshotVersion(o).next(d=>t.Bs.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.Ji=i,o))}(t.localStore,e);e.targetChanges.forEach((i,o)=>{const s=t.yc.get(o);s&&(pt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.fc=!0:i.modifiedDocuments.size>0?pt(s.fc):i.removedDocuments.size>0&&(pt(s.fc),s.fc=!1))}),yield f4(t,n,e)}catch(n){yield _l(n)}}),Nk.apply(this,arguments)}function LJ(r,e,t){const n=je(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((o,s)=>{const a=s.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(o,s){const a=je(o);a.onlineState=s;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(s)&&(c=!0)}),c&&Ek(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function Vxe(r,e,t){return Ak.apply(this,arguments)}function Ak(){return Ak=M(function*(r,e,t){const n=je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),o=i&&i.key;if(o){let s=new A1(Ue.comparator);s=s.insert(o,V1.newNoDocument(o,vt.min()));const a=an().add(o),c=new Yd(vt.min(),new Map,new A1(Zt),s,a);yield xJ(n,c),n.gc=n.gc.remove(o),n.yc.delete(e),Dk(n)}else yield q5(n.localStore,e,!1).then(()=>J5(n,e,t)).catch(_l)}),Ak.apply(this,arguments)}function Fxe(r,e){return Ik.apply(this,arguments)}function Ik(){return Ik=M(function*(r,e){const t=je(r),n=e.batch.batchId;try{const i=yield function rxe(r,e){const t=je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=t.Zi.newChangeBuffer({trackRemovals:!0});return function(s,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(E=>{m=m.next(()=>l.getEntry(a,E)).next(T=>{const L=c.docVersions.get(E);pt(null!==L),T.version.compareTo(L)<0&&(f.applyToRemoteDocument(T,c),T.isValidDocument()&&(T.setReadTime(c.commitVersion),l.addEntry(T)))})}),m.next(()=>s.mutationQueue.removeMutationBatch(a,f))}(t,n,e,o).next(()=>o.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(s){let a=an();for(let c=0;c<s.mutationResults.length;++c)s.mutationResults[c].transformResults.length>0&&(a=a.add(s.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);Rk(t,n,null),Lk(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield f4(t,i)}catch(i){yield _l(i)}}),Ik.apply(this,arguments)}function $xe(r,e,t){return kk.apply(this,arguments)}function kk(){return kk=M(function*(r,e,t){const n=je(r);try{const i=yield function(o,s){const a=je(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,s).next(f=>(pt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,s)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);Rk(n,e,t),Lk(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield f4(n,i)}catch(i){yield _l(i)}}),kk.apply(this,arguments)}function Lk(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function Rk(r,e,t){const n=je(r);let i=n.Tc[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function J5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||RJ(r,n)})}function RJ(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(u9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),Dk(r))}function zk(r,e,t){for(const n of t)n instanceof AJ?(r.Ic.addReference(n.key,e),Bxe(r,n)):n instanceof IJ?(be("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||RJ(r,n.key)):lt()}function Bxe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(be("SyncEngine","New document in limbo: "+t),r.mc.add(n),Dk(r))}function Dk(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Ue(Vn.fromString(e)),n=r.Ac.next();r.yc.set(n,new Lxe(t)),r.gc=r.gc.insert(t,n),_v(r.remoteStore,new u4(Ms(z5(t.path)),n,"TargetPurposeLimboResolution",A2.ct))}}function f4(r,e,t){return Hk.apply(this,arguments)}function Hk(){return Hk=M(function*(r,e,t){const n=je(r),i=[],o=[],s=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{s.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=GI.Li(c.targetId,l);o.push(f)}}))}),yield Promise.all(s),n.dc.nu(i),yield(a=M(function*(c,l){const f=je(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,E=>f.persistence.referenceDelegate.addReference(d,m.targetId,E)).next(()=>ce.forEach(m.Bi,E=>f.persistence.referenceDelegate.removeReference(d,m.targetId,E)))))}catch(d){if(!vl(d))throw d;be("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const E=f.Ji.get(m),L=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);f.Ji=f.Ji.insert(m,L)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,o))}),Hk.apply(this,arguments)}function Uxe(r,e){return Vk.apply(this,arguments)}function Vk(){return Vk=M(function*(r,e){const t=je(r);if(!t.currentUser.isEqual(e)){be("SyncEngine","User change. New user:",e.toKey());const n=yield lJ(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(s=>{s.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield f4(t,n.er)}var i}),Vk.apply(this,arguments)}function Wxe(r,e){const t=je(r),n=t.yc.get(e);if(n&&n.fc)return an().add(n.key);{let i=an();const o=t._c.get(e);if(!o)return i;for(const s of o){const a=t.wc.get(s);i=i.unionWith(a.view.nc)}return i}}class Cv{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return M(function*(){t.serializer=c9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function cJ(r,e,t,n){return new nxe(r,e,t,n)}(this.persistence,new aJ,e.initialUser,this.serializer)}createPersistence(e){return new HI(lv.zs,this.serializer)}createSharedClientState(e){return new _J}terminate(){var e=this;return M(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class eu{initialize(e,t){var n=this;return M(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>LJ(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=Uxe.bind(null,n.syncEngine),yield function pk(r,e){return mk.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new wxe}createDatastore(e){const t=c9(e.databaseInfo.databaseId),n=new fxe(e.databaseInfo);return new gxe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,o=a=>LJ(this.syncEngine,a,0),s=vJ.D()?new vJ:new cxe,new _xe(t,n,i,o,s);var t,n,i,o,s}createSyncEngine(e,t){return function(n,i,o,s,a,c,l){const f=new Rxe(n,i,o,s,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=M(function*(t){const n=je(t);be("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield j5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class yv{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Fr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class iLe{constructor(e,t,n,i){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Hi.UNAUTHENTICATED,this.clientId=uX.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var s=M(function*(a){be("FirestoreClient","Received user=",a.uid),yield o.authCredentialListener(a),o.user=a});return function(a){return s.apply(this,arguments)}}()),this.appCheckCredentials.start(n,s=>(be("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){var e=this;return M(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=K5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Mv(r,e){return Yk.apply(this,arguments)}function Yk(){return Yk=M(function*(r,e){r.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(o){n.isEqual(o)||(yield lJ(e.localStore,o),n=o)});return function(o){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),Yk.apply(this,arguments)}function Kk(r,e){return Xk.apply(this,arguments)}function Xk(){return Xk=M(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Qk(r){return Jk.apply(this,arguments)}(r);be("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>TJ(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,o)=>TJ(e.remoteStore,o)),r._onlineComponents=e}),Xk.apply(this,arguments)}function Jk(){return Jk=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Mv(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function $J(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;Ua("Error using user provided cache. Falling back to memory cache: "+t),yield Mv(r,new Cv)}}else be("FirestoreClient","Using default OfflineComponentProvider"),yield Mv(r,new Cv);return r._offlineComponents}),Jk.apply(this,arguments)}function Ev(r){return ex.apply(this,arguments)}function ex(){return ex=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),yield Kk(r,r._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),yield Kk(r,new eu))),r._onlineComponents}),ex.apply(this,arguments)}function tu(r){return nx.apply(this,arguments)}function nx(){return nx=M(function*(r){const e=yield Ev(r),t=e.eventManager;return t.onListen=zxe.bind(null,e.syncEngine),t.onUnlisten=Dxe.bind(null,e.syncEngine),t}),nx.apply(this,arguments)}function jJ(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const ZJ=new Map;function rx(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function YJ(r){if(!Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function KJ(r){if(Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Sv(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":lt()}function xn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Sv(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class QJ{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function hLe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=jJ(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class f9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QJ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QJ(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new fIe;switch(t.type){case"firstParty":return new pIe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=ZJ.get(e);t&&(be("ComponentProvider","Removing Datastore"),ZJ.delete(e),t.terminate())}(this),Promise.resolve()}}function JJ(r,e,t,n={}){var i;const o=(r=xn(r,f9))._getSettings(),s=`${e}:${t}`;if("firestore.googleapis.com"!==o.host&&o.host!==s&&Ua("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=Hi.MOCK_USER;else{a=function PMe(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Em(JSON.stringify({alg:"none",type:"JWT"})),Em(JSON.stringify(s)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Hi(l)}r._authCredentials=new dIe(new cX(a,c))}}class Br{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Br(this.firestore,e,this._key)}}class vo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new vo(this.firestore,e,this._query)}}class Jc extends vo{constructor(e,t,n){super(e,t,z5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Br(this.firestore,null,new Ue(e))}withConverter(e){return new Jc(this.firestore,e,this._path)}}function gLe(r,e,...t){if(r=_r(r),rx("collection","path",e),r instanceof f9){const n=Vn.fromString(e,...t);return KJ(n),new Jc(r,null,n)}{if(!(r instanceof Br||r instanceof Jc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Vn.fromString(e,...t));return KJ(n),new Jc(r.firestore,null,n)}}function eee(r,e,...t){if(r=_r(r),1===arguments.length&&(e=uX.A()),rx("doc","path",e),r instanceof f9){const n=Vn.fromString(e,...t);return YJ(n),new Br(r,null,new Ue(n))}{if(!(r instanceof Br||r instanceof Jc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Vn.fromString(e,...t));return YJ(n),new Br(r.firestore,r instanceof Jc?r.converter:null,new Ue(n))}}class pLe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new QI(this,"async_queue_retry"),this.Xc=()=>{const t=mv();t&&be("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=mv();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=mv();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new pi;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return M(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!vl(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,Fr("INTERNAL UNHANDLED ERROR: ",function(o){let s=o.message||"";return o.stack&&(s=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),s}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=_k.createAndSchedule(this,e,t,n,o=>this.na(o));return this.zc.push(i),i}Zc(){this.Wc&&lt()}verifyOperationInProgress(){}sa(){var e=this;return M(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function ix(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class F1 extends f9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new pLe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||nee(this),this._firestoreClient.terminate()}}function _Le(r,e){const n="string"==typeof r?r:e||"(default)",i=h5("object"==typeof r?r:xO(),"firestore").getImmediate({identifier:n});if(!i._initialized){const o=(r=>{const e=Bq("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();o&&JJ(i,...o)}return i}function si(r){return r._firestoreClient||nee(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function nee(r){var e,t,n;const i=r._freezeSettings(),o=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new WIe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,jJ(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new iLe(r._authCredentials,r._appCheckCredentials,r._queue,o),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class _0{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _0(mi.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _0(mi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class nu{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ov{constructor(e){this._methodName=e}}class ox{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Zt(this._lat,e._lat)||Zt(this._long,e._long)}}const CLe=/^__.*__$/;class yLe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new l4(e,this.data,this.fieldMask,t,this.fieldTransforms):new V5(e,this.data,t,this.fieldTransforms)}}class oee{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new l4(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function see(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt()}}class Tv{constructor(e,t,n,i,o,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===o&&this.ua(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Tv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return wv(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(see(this.ca)&&CLe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class MLe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||c9(e)}ya(e,t,n,i=!1){return new Tv({ca:e,methodName:t,ga:n,path:$r.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ru(r){const e=r._freezeSettings(),t=c9(r._databaseId);return new MLe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function sx(r,e,t,n,i,o={}){const s=r.ya(o.merge||o.mergeFields?2:0,e,t,i);cx("Data must be an object, but it was:",s,n);const a=fee(n,s);let c,l;if(o.merge)c=new Qs(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const f=[];for(const d of o.mergeFields){const m=g9(e,d,t);if(!s.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);hee(f,m)||f.push(m)}c=new Qs(f),l=s.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=s.fieldTransforms;return new yLe(new _o(a),c,l)}class h9 extends Ov{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof h9}}class ax extends Ov{_toFieldTransform(e){return new qd(e.path,new D5)}isEqual(e){return e instanceof ax}}function v0(r,e){if(dee(r=_r(r)))return cx("Unsupported field value:",e,r),fee(r,e);if(r instanceof Ov)return function(t,n){if(!see(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let o=0;for(const s of t){let a=v0(s,n.wa(o));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),o++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=_r(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return tQ(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=sr.fromDate(t);return{timestampValue:$5(n.serializer,i)}}if(t instanceof sr){const i=new sr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:$5(n.serializer,i)}}if(t instanceof ox)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof _0)return{bytesValue:EQ(n.serializer,t._byteString)};if(t instanceof Br){const i=n.databaseId,o=t.firestore._databaseId;if(!o.isEqual(i))throw n._a(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:TI(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${Sv(t)}`)}(r,e)}function fee(r,e){const t={};return SX(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cl(r,(n,i)=>{const o=v0(i,e.ha(n));null!=o&&(t[n]=o)}),{mapValue:{fields:t}}}function dee(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof sr||r instanceof ox||r instanceof _0||r instanceof Br||r instanceof Ov)}function cx(r,e,t){if(!dee(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=Sv(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function g9(r,e,t){if((e=_r(e))instanceof nu)return e._internalPath;if("string"==typeof e)return bv(r,e);throw wv("Field path arguments must be of type string or ",r,!1,void 0,t)}const OLe=new RegExp("[~\\*/\\[\\]]");function bv(r,e,t){if(e.search(OLe)>=0)throw wv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new nu(...e.split("."))._internalPath}catch{throw wv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function wv(r,e,t,n,i){const o=n&&!n.isEmpty(),s=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function hee(r,e){return r.some(t=>t.isEqual(e))}class lx{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Br(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new TLe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Nv("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class TLe extends lx{data(){return super.data()}}function Nv(r,e){return"string"==typeof e?bv(r,e):e instanceof nu?e._internalPath:e._delegate._internalPath}function gee(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ux{}class fx extends ux{}function bLe(r,e,...t){let n=[];e instanceof ux&&n.push(e),n=n.concat(t),function(i){const o=i.filter(a=>a instanceof iu).length,s=i.filter(a=>a instanceof p9).length;if(o>1||o>0&&s>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class p9 extends fx{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new p9(e,t,n)}_apply(e){const t=this._parse(e);return vee(e._query,t),new vo(e.firestore,e.converter,mI(e._query,t))}_parse(e){const t=ru(e.firestore);return function(i,o,s,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){_ee(f,l);const m=[];for(const E of f)m.push(mee(a,i,E));d={arrayValue:{values:m}}}else d=mee(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||_ee(f,l),d=function uee(r,e,t,n=!1){return v0(t,r.ya(n?4:3,e))}(s,"where",f,"in"===l||"not-in"===l);return Tn.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function wLe(r,e,t){const n=e,i=Nv("where",r);return p9._create(i,n,t)}class iu extends ux{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new iu(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:h1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let o=n;const s=i.getFlattenedFilters();for(const a of s)vee(o,a),o=mI(o,a)}(e._query,t),new vo(e.firestore,e.converter,mI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class dx extends fx{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dx(e,t)}_apply(e){const t=function(n,i,o){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new L5(i,o);return function(a,c){if(null===gI(a)){const l=Z_(a);null!==l&&Cee(0,l,c.field)}}(n,s),s}(e._query,this._field,this._direction);return new vo(e.firestore,e.converter,function(n,i){const o=n.explicitOrderBy.concat([i]);return new a4(n.path,n.collectionGroup,o,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function NLe(r,e="asc"){const t=e,n=Nv("orderBy",r);return dx._create(n,t)}class Av extends fx{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Av(e,t,n)}_apply(e){return new vo(e.firestore,e.converter,Y_(e._query,this._limit,this._limitType))}}function ALe(r){return function XJ(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),Av._create("limit",r,"F")}function mee(r,e,t){if("string"==typeof(t=_r(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pI(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Vn.fromString(t));if(!Ue.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return o0(r,new Ue(n))}if(t instanceof Br)return o0(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sv(t)}.`)}function _ee(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vee(r,e){if(e.isInequality()){const n=Z_(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const o=gI(r);null!==o&&Cee(0,i,o)}const t=function(n,i){for(const o of n)for(const s of o.getFlattenedFilters())if(i.indexOf(s.op)>=0)return s.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Cee(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class ILe{convertValue(e,t="none"){switch(El(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Er(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(s4(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw lt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Cl(e,(i,o)=>{n[i]=this.convertValue(o,t)}),n}convertGeoPoint(e){return new ox(Er(e.latitude),Er(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=G_(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Dd(e));default:return null}}convertTimestamp(e){const t=yl(e);return new sr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Vn.fromString(e);pt(kQ(n));const i=new r0(n.get(1),n.get(3)),o=new Ue(n.popFirst(5));return i.isEqual(t)||Fr(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function hx(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class C0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ou extends lx{constructor(e,t,n,i,o,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Nv("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class xv extends ou{data(e={}){return super.data(e)}}class su{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new C0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new xv(this._firestore,this._userDataWriter,n.key,n,new C0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let o=0;return n._snapshot.docChanges.map(s=>({type:"added",doc:new xv(n._firestore,n._userDataWriter,s.doc.key,s.doc,new C0(n._snapshot.mutatedKeys.has(s.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:o++}))}{let o=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(s=>i||3!==s.type).map(s=>{const a=new xv(n._firestore,n._userDataWriter,s.doc.key,s.doc,new C0(n._snapshot.mutatedKeys.has(s.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==s.type&&(c=o.indexOf(s.doc.key),o=o.delete(s.doc.key)),1!==s.type&&(o=o.add(s.doc),l=o.indexOf(s.doc.key)),{type:xLe(s.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function xLe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt()}}function LLe(r){r=xn(r,Br);const e=xn(r.firestore,F1);return function WJ(r,e,t={}){const n=new pi;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,o,s,a,c){const l=new yv({next:d=>{o.enqueueAndForget(()=>yk(i,f));const m=d.docs.has(s);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Pk(z5(s.path),l,{includeMetadataChanges:!0,Ku:!0});return vk(i,f)}(yield tu(r),r.asyncQueue,e,t,n)})),n.promise}(si(e),r._key).then(t=>gx(e,r,t))}class Il extends ILe{constructor(e){super(),this.firestore=e}convertBytes(e){return new _0(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Br(this.firestore,null,t)}}function RLe(r){r=xn(r,vo);const e=xn(r.firestore,F1),t=si(e),n=new Il(e);return gee(r._query),function qJ(r,e,t={}){const n=new pi;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,o,s,a,c){const l=new yv({next:d=>{o.enqueueAndForget(()=>yk(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Pk(s,l,{includeMetadataChanges:!0,Ku:!0});return vk(i,f)}(yield tu(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new su(e,n,r,i))}function zLe(r,e,t){r=xn(r,Br);const n=xn(r.firestore,F1),i=hx(r.converter,e,t);return m9(n,[sx(ru(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,J1.none())])}function DLe(r,e,t,...n){r=xn(r,Br);const i=xn(r.firestore,F1),o=ru(i);let s;return s="string"==typeof(e=_r(e))||e instanceof nu?function lee(r,e,t,n,i,o){const s=r.ya(1,e,t),a=[g9(e,n,t)],c=[i];if(o.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(g9(e,o[m])),c.push(o[m+1]);const l=[],f=_o.empty();for(let m=a.length-1;m>=0;--m)if(!hee(l,a[m])){const E=a[m];let T=c[m];T=_r(T);const L=s.da(E);if(T instanceof h9)l.push(E);else{const z=v0(T,L);null!=z&&(l.push(E),f.set(E,z))}}const d=new Qs(l);return new oee(f,d,s.fieldTransforms)}(o,"updateDoc",r._key,e,t,n):function cee(r,e,t,n){const i=r.ya(1,e,t);cx("Data must be an object, but it was:",i,n);const o=[],s=_o.empty();Cl(n,(c,l)=>{const f=bv(e,c,t);l=_r(l);const d=i.da(f);if(l instanceof h9)o.push(f);else{const m=v0(l,d);null!=m&&(o.push(f),s.set(f,m))}});const a=new Qs(o);return new oee(s,a,i.fieldTransforms)}(o,"updateDoc",r._key,e),m9(i,[s.toMutation(r._key,J1.exists(!0))])}function HLe(r){return m9(xn(r.firestore,F1),[new F5(r._key,J1.none())])}function VLe(r,e){const t=xn(r.firestore,F1),n=eee(r),i=hx(r.converter,e);return m9(t,[sx(ru(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,J1.exists(!1))]).then(()=>n)}function FLe(r,...e){var t,n,i;r=_r(r);let o={includeMetadataChanges:!1},s=0;"object"!=typeof e[s]||ix(e[s])||(o=e[s],s++);const a={includeMetadataChanges:o.includeMetadataChanges};if(ix(e[s])){const d=e[s];e[s]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[s+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[s+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof Br)l=xn(r.firestore,F1),f=z5(r._key.path),c={next:d=>{e[s]&&e[s](gx(l,r,d))},error:e[s+1],complete:e[s+2]};else{const d=xn(r,vo);l=xn(d.firestore,F1),f=d._query;const m=new Il(l);c={next:E=>{e[s]&&e[s](new su(l,m,d,E))},error:e[s+1],complete:e[s+2]},gee(r._query)}return function(d,m,E,T){const L=new yv(T),z=new Pk(m,L,E);return d.asyncQueue.enqueueAndForget(M(function*(){return vk(yield tu(d),z)})),()=>{L.Dc(),d.asyncQueue.enqueueAndForget(M(function*(){return yk(yield tu(d),z)}))}}(si(l),f,a,c)}function m9(r,e){return function(t,n){const i=new pi;return t.asyncQueue.enqueueAndForget(M(function*(){return function Hxe(r,e,t){return wk.apply(this,arguments)}(yield function tx(r){return Ev(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(si(r),e)}function gx(r,e,t){const n=t.docs.get(e._key),i=new Il(r);return new ou(r,i,e._key,n,new C0(t.hasPendingWrites,t.fromCache),e.converter)}function e3(){return new ax("serverTimestamp")}!function(r,e=!0){A5=$6,vs(new Bo("firestore",(t,{instanceIdentifier:n,options:i})=>{const o=t.getProvider("app").getImmediate(),s=new F1(new hIe(t.getProvider("auth-internal")),new mIe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new r0(a.options.projectId,c)}(o,n),o);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),vr(aX,"3.13.0",r),vr(aX,"3.13.0","esm2017")}();class kl{constructor(e){return e}}const px=new et("angularfire2.firestore-instances");function eRe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new kl(n)}}const tRe={provide:class QLe{constructor(){return zb("firestore")}},deps:[[new ds,px]]},nRe={provide:kl,useFactory:function JLe(r,e){const t=Rb("firestore",r,e);return t&&new kl(t)},deps:[[new ds,px],_5]};let rRe=(()=>{class r{constructor(){vr("angularfire",Dm.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({providers:[nRe,tRe]}),r})();const oRe=z1(VLe,!0),sRe=z1(gLe,!0),cRe=z1(HLe,!0),_9=z1(eee,!0),lRe=z1(LLe,!0),uRe=z1(RLe,!0),fRe=z1(_Le,!0),dRe=z1(ALe,!0),Pee=z1(FLe,!0),hRe=z1(NLe,!0),Rv=z1(bLe,!0),gRe=z1(zLe,!0),pRe=z1(DLe,!0),mRe=z1(wLe,!0),Ur=void 0,vRe=["fr",[["AM","PM"],Ur,Ur],Ur,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Ur,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Ur,[["av. J.-C.","ap. J.-C."],Ur,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Ur],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Ur,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Ur,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Ur,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Ur,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Ur,"\xa5"],KMF:[Ur,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Ur,"$C"],NZD:["$NZ","$"],PHP:[Ur,"\u20b1"],RHD:["$RH"],RON:[Ur,"L"],RWF:[Ur,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Ur,"$T"],TTD:["$TT","$"],TWD:[Ur,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Ur,"$"],XPF:["FCFP"],ZMW:[Ur,"Kw"]},"ltr",function _Re(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function See(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ut(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?See(Object(t),!0).forEach(function(n){_i(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):See(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function zv(r){return(zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function Oee(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _i(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function mx(r,e){return function PRe(r){if(Array.isArray(r))return r}(r)||function ORe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var s,a,n=[],i=!0,o=!1;try{for(t=t.call(r);!(i=(s=t.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(c){o=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(o)throw a}}return n}}(r,e)||Tee(r,e)||function bRe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C9(r){return function ERe(r){if(Array.isArray(r))return _x(r)}(r)||function SRe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Tee(r)||function TRe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tee(r,e){if(r){if("string"==typeof r)return _x(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _x(r,e)}}function _x(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var bee=function(){},vx={},wee={},Nee=null,Aee={mark:bee,measure:bee};try{typeof window<"u"&&(vx=window),typeof document<"u"&&(wee=document),typeof MutationObserver<"u"&&(Nee=MutationObserver),typeof performance<"u"&&(Aee=performance)}catch{}var Vv,Fv,$v,Gv,Bv,Iee=(vx.navigator||{}).userAgent,kee=void 0===Iee?"":Iee,xl=vx,$1=wee,xee=Nee,Hv=Aee,d4=!!$1.documentElement&&!!$1.head&&"function"==typeof $1.addEventListener&&"function"==typeof $1.createElement,Lee=~kee.indexOf("MSIE")||~kee.indexOf("Trident/"),h4="___FONT_AWESOME___",Ree="fa",zee="svg-inline--fa",y0="data-fa-i2svg",yx="data-fa-pseudo-element",NRe="data-fa-pseudo-element-pending",Mx="data-prefix",Ex="data-icon",Dee="fontawesome-i2svg",ARe="async",IRe=["HTML","HEAD","STYLE","SCRIPT"],Hee=function(){try{return!0}catch{return!1}}(),G1="classic",Pr="sharp",Px=[G1,Pr];function y9(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[G1]}})}var M9=y9((_i(Vv={},G1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),_i(Vv,Pr,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Vv)),E9=y9((_i(Fv={},G1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),_i(Fv,Pr,{solid:"fass",regular:"fasr",light:"fasl"}),Fv)),P9=y9((_i($v={},G1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),_i($v,Pr,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),$v)),kRe=y9((_i(Gv={},G1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),_i(Gv,Pr,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Gv)),xRe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,Vee="fa-layers-text",LRe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,RRe=y9((_i(Bv={},G1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),_i(Bv,Pr,{900:"fass",400:"fasr",300:"fasl"}),Bv)),Fee=[1,2,3,4,5,6,7,8,9,10],zRe=Fee.concat([11,12,13,14,15,16,17,18,19,20]),DRe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],M0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},S9=new Set;Object.keys(E9[G1]).map(S9.add.bind(S9)),Object.keys(E9[Pr]).map(S9.add.bind(S9));var HRe=[].concat(Px,C9(S9),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",M0.GROUP,M0.SWAP_OPACITY,M0.PRIMARY,M0.SECONDARY]).concat(Fee.map(function(r){return"".concat(r,"x")})).concat(zRe.map(function(r){return"w-".concat(r)})),O9=xl.FontAwesomeConfig||{};$1&&"function"==typeof $1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=mx(r,2),n=e[1],i=function FRe(r){return""===r||"false"!==r&&("true"===r||r)}(function VRe(r){var e=$1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(O9[n]=i)});var $ee={styleDefault:"solid",familyDefault:"classic",cssPrefix:Ree,replacementClass:zee,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};O9.familyPrefix&&(O9.cssPrefix=O9.familyPrefix);var au=ut(ut({},$ee),O9);au.autoReplaceSvg||(au.observeMutations=!1);var mt={};Object.keys($ee).forEach(function(r){Object.defineProperty(mt,r,{enumerable:!0,set:function(t){au[r]=t,T9.forEach(function(n){return n(mt)})},get:function(){return au[r]}})}),Object.defineProperty(mt,"familyPrefix",{enumerable:!0,set:function(e){au.cssPrefix=e,T9.forEach(function(t){return t(mt)})},get:function(){return au.cssPrefix}}),xl.FontAwesomeConfig=mt;var T9=[],t3={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},URe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function b9(){for(var r=12,e="";r-- >0;)e+=URe[62*Math.random()|0];return e}function cu(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function Sx(r){return r.classList?cu(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function Gee(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Uv(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function Ox(r){return r.size!==t3.size||r.x!==t3.x||r.y!==t3.y||r.rotate!==t3.rotate||r.flipX||r.flipY}var ZRe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function Bee(){var r=Ree,e=zee,t=mt.cssPrefix,n=mt.replacementClass,i=ZRe;if(t!==r||n!==e){var o=new RegExp("\\.".concat(r,"\\-"),"g"),s=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(o,".".concat(t,"-")).replace(s,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var Uee=!1;function Tx(){mt.autoAddCss&&!Uee&&(function BRe(r){if(r&&d4){var e=$1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=$1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var o=t[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(n=o)}$1.head.insertBefore(e,n)}}(Bee()),Uee=!0)}var YRe={mixout:function(){return{dom:{css:Bee,insertCss:Tx}}},hooks:function(){return{beforeDOMElementCreation:function(){Tx()},beforeI2svg:function(){Tx()}}}},g4=xl||{};g4[h4]||(g4[h4]={}),g4[h4].styles||(g4[h4].styles={}),g4[h4].hooks||(g4[h4].hooks={}),g4[h4].shims||(g4[h4].shims=[]);var qa=g4[h4],Wee=[],Wv=!1;function w9(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,o=void 0===i?[]:i;return"string"==typeof r?Gee(r):"<".concat(e," ").concat(function WRe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(Gee(r[t]),'" ')},"").trim()}(n),">").concat(o.map(w9).join(""),"</").concat(e,">")}function qee(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}d4&&((Wv=($1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test($1.readyState))||$1.addEventListener("DOMContentLoaded",function r(){$1.removeEventListener("DOMContentLoaded",r),Wv=1,Wee.map(function(e){return e()})}));var bx=function(e,t,n,i){var c,l,f,o=Object.keys(e),s=o.length,a=void 0!==i?function(e,t){return function(n,i,o,s){return e.call(t,n,i,o,s)}}(t,i):t;for(void 0===n?(c=1,f=e[o[0]]):(c=0,f=n);c<s;c++)f=a(f,e[l=o[c]],l,e);return f};function wx(r){var e=function JRe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var o=r.charCodeAt(t++);56320==(64512&o)?e.push(((1023&i)<<10)+(1023&o)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function jee(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function Nx(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,o=jee(e);"function"!=typeof qa.hooks.addPack||i?qa.styles[r]=ut(ut({},qa.styles[r]||{}),o):qa.hooks.addPack(r,jee(e)),"fas"===r&&Nx("fa",e)}var qv,jv,Zv,lu=qa.styles,tze=qa.shims,nze=(_i(qv={},G1,Object.values(P9[G1])),_i(qv,Pr,Object.values(P9[Pr])),qv),Ax=null,Zee={},Yee={},Kee={},Xee={},Qee={},rze=(_i(jv={},G1,Object.keys(M9[G1])),_i(jv,Pr,Object.keys(M9[Pr])),jv);var Jee=function(){var e=function(o){return bx(lu,function(s,a,c){return s[c]=bx(a,o,{}),s},{})};Zee=e(function(i,o,s){return o[3]&&(i[o[3]]=s),o[2]&&o[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=s}),i}),Yee=e(function(i,o,s){return i[s]=s,o[2]&&o[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=s}),i}),Qee=e(function(i,o,s){var a=o[2];return i[s]=s,a.forEach(function(c){i[c]=s}),i});var t="far"in lu||mt.autoFetchSvg,n=bx(tze,function(i,o){var s=o[0],a=o[1],c=o[2];return"far"===a&&!t&&(a="fas"),"string"==typeof s&&(i.names[s]={prefix:a,iconName:c}),"number"==typeof s&&(i.unicodes[s.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});Kee=n.names,Xee=n.unicodes,Ax=Yv(mt.styleDefault,{family:mt.familyDefault})};function Ix(r,e){return(Zee[r]||{})[e]}function E0(r,e){return(Qee[r]||{})[e]}function ete(r){return Kee[r]||{prefix:null,iconName:null}}function Rl(){return Ax}(function GRe(r){T9.push(r)})(function(r){Ax=Yv(r.styleDefault,{family:mt.familyDefault})}),Jee();var kx=function(){return{prefix:null,iconName:null,rest:[]}};function Yv(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?G1:t;return E9[n][r]||E9[n][M9[n][r]]||(r in qa.styles?r:null)||null}var tte=(_i(Zv={},G1,Object.keys(P9[G1])),_i(Zv,Pr,Object.keys(P9[Pr])),Zv);function Kv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,o=(_i(e={},G1,"".concat(mt.cssPrefix,"-").concat(G1)),_i(e,Pr,"".concat(mt.cssPrefix,"-").concat(Pr)),e),s=null,a=G1;(r.includes(o[G1])||r.some(function(l){return tte[G1].includes(l)}))&&(a=G1),(r.includes(o[Pr])||r.some(function(l){return tte[Pr].includes(l)}))&&(a=Pr);var c=r.reduce(function(l,f){var d=function oze(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function ize(r){return~HRe.indexOf(r)}(i)?null:i}(mt.cssPrefix,f);if(lu[f]?(f=nze[a].includes(f)?kRe[a][f]:f,s=f,l.prefix=f):rze[a].indexOf(f)>-1?(s=f,l.prefix=Yv(f,{family:a})):d?l.iconName=d:f!==mt.replacementClass&&f!==o[G1]&&f!==o[Pr]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===s?ete(l.iconName):{},E=E0(l.prefix,l.iconName);m.prefix&&(s=null),l.iconName=m.iconName||E||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!lu.far&&lu.fas&&!mt.autoFetchSvg&&(l.prefix="fas")}return l},kx());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===Pr&&(lu.fass||mt.autoFetchSvg)&&(c.prefix="fass",c.iconName=E0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===s)&&(c.prefix=Rl()||"fas"),c}var cze=function(){function r(){(function CRe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function yRe(r,e,t){e&&Oee(r.prototype,e),t&&Oee(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=i.reduce(this._pullDefinitions,{});Object.keys(s).forEach(function(a){t.definitions[a]=ut(ut({},t.definitions[a]||{}),s[a]),Nx(a,s[a]);var c=P9[G1][a];c&&Nx(c,s[a]),Jee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(o){var s=i[o],a=s.prefix,c=s.iconName,l=s.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),nte=[],uu={},fu={},lze=Object.keys(fu);function xx(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(uu[r]||[]).forEach(function(s){e=s.apply(null,[e].concat(n))}),e}function P0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(uu[r]||[]).forEach(function(o){o.apply(null,t)})}function p4(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return fu[r]?fu[r].apply(null,e):void 0}function Lx(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||Rl();if(e)return e=E0(t,e)||e,qee(rte.definitions,t,e)||qee(qa.styles,t,e)}var rte=new cze,dze={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d4?(P0("beforeI2svg",e),p4("pseudoElements2svg",e),p4("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===mt.autoReplaceSvg&&(mt.autoReplaceSvg=!0),mt.observeMutations=!0,function XRe(r){d4&&(Wv?setTimeout(r,0):Wee.push(r))}(function(){gze({autoReplaceSvgRoot:t}),P0("watch",e)})}},I2={noAuto:function(){mt.autoReplaceSvg=!1,mt.observeMutations=!1,P0("noAuto")},config:mt,dom:dze,parse:{icon:function(e){if(null===e)return null;if("object"===zv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:E0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Yv(e[0]);return{prefix:n,iconName:E0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(mt.cssPrefix,"-"))>-1||e.match(xRe))){var i=Kv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||Rl(),iconName:E0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var o=Rl();return{prefix:o,iconName:E0(o,e)||e}}}},library:rte,findIconDefinition:Lx,toHtml:w9},gze=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?$1:t;(Object.keys(qa.styles).length>0||mt.autoFetchSvg)&&d4&&mt.autoReplaceSvg&&I2.dom.i2svg({node:n})};function Xv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return w9(n)})}}),Object.defineProperty(r,"node",{get:function(){if(d4){var n=$1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function Rx(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,o=r.iconName,s=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,E=void 0!==m&&m,T=n.found?n:t,L=T.width,z=T.height,G="fak"===i,B=[mt.replacementClass,o?"".concat(mt.cssPrefix,"-").concat(o):""].filter(function(Et){return-1===d.classes.indexOf(Et)}).filter(function(Et){return""!==Et||!!Et}).concat(d.classes).join(" "),de={children:[],attributes:ut(ut({},d.attributes),{},{"data-prefix":i,"data-icon":o,class:B,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(L," ").concat(z)})},ye=G&&!~d.classes.indexOf("fa-fw")?{width:"".concat(L/z*16*.0625,"em")}:{};E&&(de.attributes[y0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||b9())},children:[c]}),delete de.attributes.title);var Le=ut(ut({},de),{},{prefix:i,iconName:o,main:t,mask:n,maskId:l,transform:s,symbol:a,styles:ut(ut({},ye),d.styles)}),tt=n.found&&t.found?p4("generateAbstractMask",Le)||{children:[],attributes:{}}:p4("generateAbstractIcon",Le)||{children:[],attributes:{}},Pn=tt.attributes;return Le.children=tt.children,Le.attributes=Pn,a?function mze(r){var t=r.iconName,n=r.children,i=r.attributes,o=r.symbol,s=!0===o?"".concat(r.prefix,"-").concat(mt.cssPrefix,"-").concat(t):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ut(ut({},i),{},{id:s}),children:n}]}]}(Le):function pze(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,o=r.styles,s=r.transform;if(Ox(s)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Uv(ut(ut({},o),{},{"transform-origin":"".concat(l.x+s.x/16,"em ").concat(l.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(Le)}function ite(r){var e=r.content,t=r.width,n=r.height,i=r.transform,o=r.title,s=r.extra,a=r.watchable,c=void 0!==a&&a,l=ut(ut(ut({},s.attributes),o?{title:o}:{}),{},{class:s.classes.join(" ")});c&&(l[y0]="");var f=ut({},s.styles);Ox(i)&&(f.transform=function jRe(r){var e=r.transform,t=r.width,i=r.height,o=void 0===i?16:i,s=r.startCentered,a=void 0!==s&&s,c="";return c+=a&&Lee?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-o/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Uv(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),o&&m.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),m}var zx=qa.styles;function Dx(r){var e=r[0],t=r[1],o=mx(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(o)?{tag:"g",attributes:{class:"".concat(mt.cssPrefix,"-").concat(M0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(mt.cssPrefix,"-").concat(M0.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(mt.cssPrefix,"-").concat(M0.PRIMARY),fill:"currentColor",d:o[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:o}}}}var vze={found:!1,width:512,height:512};function Hx(r,e){var t=e;return"fa"===e&&null!==mt.styleDefault&&(e=Rl()),new Promise(function(n,i){if(p4("missingIconAbstract"),"fa"===t){var s=ete(r)||{};r=s.iconName||r,e=s.prefix||e}if(r&&e&&zx[e]&&zx[e][r])return n(Dx(zx[e][r]));(function Cze(r,e){!Hee&&!mt.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(ut(ut({},vze),{},{icon:mt.showMissingIcons&&r&&p4("missingIconAbstract")||{}}))})}var ote=function(){},Vx=mt.measurePerformance&&Hv&&Hv.mark&&Hv.measure?Hv:{mark:ote,measure:ote},N9='FA "6.4.2"',ste=function(e){Vx.mark("".concat(N9," ").concat(e," ends")),Vx.measure("".concat(N9," ").concat(e),"".concat(N9," ").concat(e," begins"),"".concat(N9," ").concat(e," ends"))},Fx={begin:function(e){return Vx.mark("".concat(N9," ").concat(e," begins")),function(){return ste(e)}},end:ste},Qv=function(){};function ate(r){return"string"==typeof(r.getAttribute?r.getAttribute(y0):null)}function Sze(r){return $1.createElementNS("http://www.w3.org/2000/svg",r)}function Oze(r){return $1.createElement(r)}function cte(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?Sze:Oze:t;if("string"==typeof r)return $1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(s){i.setAttribute(s,r.attributes[s])}),(r.children||[]).forEach(function(s){i.appendChild(cte(s,{ceFn:n}))}),i}var Jv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(cte(i),t)}),null===t.getAttribute(y0)&&mt.keepOriginalSource){var n=$1.createComment(function Tze(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~Sx(t).indexOf(mt.replacementClass))return Jv.replace(e);var i=new RegExp("".concat(mt.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var o=n[0].attributes.class.split(" ").reduce(function(a,c){return c===mt.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=o.toSvg.join(" "),0===o.toNode.length?t.removeAttribute("class"):t.setAttribute("class",o.toNode.join(" "))}var s=n.map(function(a){return w9(a)}).join("\n");t.setAttribute(y0,""),t.innerHTML=s}};function lte(r){r()}function ute(r,e){var t="function"==typeof e?e:Qv;if(0===r.length)t();else{var n=lte;mt.mutateApproach===ARe&&(n=xl.requestAnimationFrame||lte),n(function(){var i=function Pze(){return!0===mt.autoReplaceSvg?Jv.replace:Jv[mt.autoReplaceSvg]||Jv.replace}(),o=Fx.begin("mutate");r.map(i),o(),t()})}}var $x=!1;function fte(){$x=!0}function Gx(){$x=!1}var eC=null;function dte(r){if(xee&&mt.observeMutations){var e=r.treeCallback,t=void 0===e?Qv:e,n=r.nodeCallback,i=void 0===n?Qv:n,o=r.pseudoElementsCallback,s=void 0===o?Qv:o,a=r.observeMutationsRoot,c=void 0===a?$1:a;eC=new xee(function(l){if(!$x){var f=Rl();cu(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!ate(d.addedNodes[0])&&(mt.searchPseudoElements&&s(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&mt.searchPseudoElements&&s(d.target.parentNode),"attributes"===d.type&&ate(d.target)&&~DRe.indexOf(d.attributeName))if("class"===d.attributeName&&function Mze(r){var e=r.getAttribute?r.getAttribute(Mx):null,t=r.getAttribute?r.getAttribute(Ex):null;return e&&t}(d.target)){var m=Kv(Sx(d.target)),T=m.iconName;d.target.setAttribute(Mx,m.prefix||f),T&&d.target.setAttribute(Ex,T)}else(function Eze(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(mt.replacementClass)})(d.target)&&i(d.target)})}}),d4&&eC.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function hte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function Nze(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=Kv(Sx(r));return i.prefix||(i.prefix=Rl()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function sze(r,e){return(Yee[r]||{})[e]}(i.prefix,r.innerText)||Ix(i.prefix,wx(r.innerText))),!i.iconName&&mt.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,o=t.rest,s=function Aze(r){var e=cu(r.attributes).reduce(function(i,o){return"class"!==i.name&&"style"!==i.name&&(i[o.name]=o.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return mt.autoA11y&&(t?e["aria-labelledby"]="".concat(mt.replacementClass,"-title-").concat(n||b9()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=xx("parseNodeAttributes",{},r),c=e.styleParser?function wze(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var o=i.split(":"),s=o[0],a=o.slice(1);return s&&a.length>0&&(n[s]=a.join(":").trim()),n},{})),t}(r):[];return ut({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:t3,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:c,attributes:s}},a)}var kze=qa.styles;function gte(r){var e="nest"===mt.autoReplaceSvg?hte(r,{styleParser:!1}):hte(r);return~e.extra.classes.indexOf(Vee)?p4("generateLayersText",r,e):p4("generateSvgReplacementMutation",r,e)}var zl=new Set;function pte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!d4)return Promise.resolve();var t=$1.documentElement.classList,n=function(d){return t.add("".concat(Dee,"-").concat(d))},i=function(d){return t.remove("".concat(Dee,"-").concat(d))},o=mt.autoFetchSvg?zl:Px.map(function(f){return"fa-".concat(f)}).concat(Object.keys(kze));o.includes("fa")||o.push("fa");var s=[".".concat(Vee,":not([").concat(y0,"])")].concat(o.map(function(f){return".".concat(f,":not([").concat(y0,"])")})).join(", ");if(0===s.length)return Promise.resolve();var a=[];try{a=cu(r.querySelectorAll(s))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=Fx.begin("onTree"),l=a.reduce(function(f,d){try{var m=gte(d);m&&f.push(m)}catch(E){Hee||"MissingIcon"===E.name&&console.error(E)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){ute(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function xze(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;gte(r).then(function(t){t&&ute([t],e)})}function Lze(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:Lx(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:Lx(i||{})),r(n,ut(ut({},t),{},{mask:i}))}}Px.map(function(r){zl.add("fa-".concat(r))}),Object.keys(M9[G1]).map(zl.add.bind(zl)),Object.keys(M9[Pr]).map(zl.add.bind(zl)),zl=C9(zl);var Rze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?t3:n,o=t.symbol,s=void 0!==o&&o,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,E=t.titleId,T=void 0===E?null:E,L=t.classes,z=void 0===L?[]:L,G=t.attributes,B=void 0===G?{}:G,de=t.styles,ye=void 0===de?{}:de;if(e){var Le=e.prefix,tt=e.iconName,gt=e.icon;return Xv(ut({type:"icon"},e),function(){return P0("beforeDOMElementCreation",{iconDefinition:e,params:t}),mt.autoA11y&&(m?B["aria-labelledby"]="".concat(mt.replacementClass,"-title-").concat(T||b9()):(B["aria-hidden"]="true",B.focusable="false")),Rx({icons:{main:Dx(gt),mask:c?Dx(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Le,iconName:tt,transform:ut(ut({},t3),i),symbol:s,title:m,maskId:f,titleId:T,extra:{attributes:B,styles:ye,classes:z}})})}},zze={mixout:function(){return{icon:Lze(Rze)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=pte,t.nodeCallback=xze,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,o=t.callback;return pte(void 0===n?$1:n,void 0===o?function(){}:o)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,o=n.title,s=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(E,T){Promise.all([Hx(i,a),f.iconName?Hx(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(L){var z=mx(L,2);E([t,Rx({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:o,titleId:s,extra:m,watchable:!0})])}).catch(T)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,o=t.main,s=t.transform,c=Uv(t.styles);return c.length>0&&(i.style=c),Ox(s)&&(l=p4("generateAbstractTransformGrouping",{main:o,transform:s,containerWidth:o.width,iconWidth:o.width})),n.push(l||o.icon),{children:n,attributes:i}}}},Dze={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,o=void 0===i?[]:i;return Xv({type:"layer"},function(){P0("beforeDOMElementCreation",{assembler:t,params:n});var s=[];return t(function(a){Array.isArray(a)?a.map(function(c){s=s.concat(c.abstract)}):s=s.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(mt.cssPrefix,"-layers")].concat(C9(o)).join(" ")},children:s}]})}}}},Hze={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,o=void 0===i?null:i,s=n.classes,a=void 0===s?[]:s,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return Xv({type:"counter",content:t},function(){return P0("beforeDOMElementCreation",{content:t,params:n}),function _ze(r){var e=r.content,t=r.title,n=r.extra,i=ut(ut(ut({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),o=Uv(n.styles);o.length>0&&(i.style=o);var s=[];return s.push({tag:"span",attributes:i,children:[e]}),t&&s.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),s}({content:t.toString(),title:o,extra:{attributes:l,styles:d,classes:["".concat(mt.cssPrefix,"-layers-counter")].concat(C9(a))}})})}}}},Vze={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,o=void 0===i?t3:i,s=n.title,a=void 0===s?null:s,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,E=void 0===m?{}:m;return Xv({type:"text",content:t},function(){return P0("beforeDOMElementCreation",{content:t,params:n}),ite({content:t,transform:ut(ut({},t3),o),title:a,extra:{attributes:d,styles:E,classes:["".concat(mt.cssPrefix,"-layers-text")].concat(C9(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,o=n.transform,s=n.extra,a=null,c=null;if(Lee){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return mt.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([t,ite({content:t.innerHTML,width:a,height:c,transform:o,title:i,extra:s,watchable:!0})])}}},Fze=new RegExp('"',"ug"),mte=[1105920,1112319];function _te(r,e){var t="".concat(NRe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var s=cu(r.children).filter(function(gt){return gt.getAttribute(yx)===e})[0],a=xl.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(LRe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(s&&!c)return r.removeChild(s),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?Pr:G1,E=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?E9[m][c[2].toLowerCase()]:RRe[m][l],T=function $ze(r){var e=r.replace(Fze,""),t=function eze(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=mte[0]&&t<=mte[1],i=2===e.length&&e[0]===e[1];return{value:wx(i?e[0]:e),isSecondary:n||i}}(d),L=T.value,z=T.isSecondary,G=c[0].startsWith("FontAwesome"),B=Ix(E,L),de=B;if(G){var ye=function aze(r){var e=Xee[r],t=Ix("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(L);ye.iconName&&ye.prefix&&(B=ye.iconName,E=ye.prefix)}if(!B||z||s&&s.getAttribute(Mx)===E&&s.getAttribute(Ex)===de)n();else{r.setAttribute(t,de),s&&r.removeChild(s);var Le=function Ize(){return{iconName:null,title:null,titleId:null,prefix:null,transform:t3,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),tt=Le.extra;tt.attributes[yx]=e,Hx(B,E).then(function(gt){var Pn=Rx(ut(ut({},Le),{},{icons:{main:gt,mask:kx()},prefix:E,iconName:de,extra:tt,watchable:!0})),Et=$1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Et,r.firstChild):r.appendChild(Et),Et.outerHTML=Pn.map(function(no){return w9(no)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function Gze(r){return Promise.all([_te(r,"::before"),_te(r,"::after")])}function Bze(r){return!(r.parentNode===document.head||~IRe.indexOf(r.tagName.toUpperCase())||r.getAttribute(yx)||r.parentNode&&"svg"===r.parentNode.tagName)}function vte(r){if(d4)return new Promise(function(e,t){var n=cu(r.querySelectorAll("*")).filter(Bze).map(Gze),i=Fx.begin("searchPseudoElements");fte(),Promise.all(n).then(function(){i(),Gx(),e()}).catch(function(){i(),Gx(),t()})})}var Cte=!1,yte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var o=i.toLowerCase().split("-"),s=o[0],a=o.slice(1).join("-");if(s&&"h"===a)return n.flipX=!0,n;if(s&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(s){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Bx={x:0,y:0,width:"100%",height:"100%"};function Mte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function jze(r){return"g"===r.tag?r.children:[r]}var Zze={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),o=i?Kv(i.split(" ").map(function(s){return s.trim()})):kx();return o.prefix||(o.prefix=Rl()),t.mask=o,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,o=t.main,s=t.mask,a=t.maskId,f=o.icon,m=s.icon,E=function qRe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},o="translate(".concat(32*e.x,", ").concat(32*e.y,") "),s="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(s," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:s.width,iconWidth:o.width}),T={tag:"rect",attributes:ut(ut({},Bx),{},{fill:"white"})},L=f.children?{children:f.children.map(Mte)}:{},z={tag:"g",attributes:ut({},E.inner),children:[Mte(ut({tag:f.tag,attributes:ut(ut({},f.attributes),E.path)},L))]},G={tag:"g",attributes:ut({},E.outer),children:[z]},B="mask-".concat(a||b9()),de="clip-".concat(a||b9()),ye={tag:"mask",attributes:ut(ut({},Bx),{},{id:B,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[T,G]},Le={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:jze(m)},ye]};return n.push(Le,{tag:"rect",attributes:ut({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(B,")")},Bx)}),{children:n,attributes:i}}}};!function uze(r,e){var t=e.mixoutsTo;nte=r,uu={},Object.keys(fu).forEach(function(n){-1===lze.indexOf(n)&&delete fu[n]}),nte.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(s){"function"==typeof i[s]&&(t[s]=i[s]),"object"===zv(i[s])&&Object.keys(i[s]).forEach(function(a){t[s]||(t[s]={}),t[s][a]=i[s][a]})}),n.hooks){var o=n.hooks();Object.keys(o).forEach(function(s){uu[s]||(uu[s]=[]),uu[s].push(o[s])})}n.provides&&n.provides(fu)})}([YRe,zze,Dze,Hze,Vze,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=vte,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;mt.searchPseudoElements&&vte(void 0===n?$1:n)}}},{mixout:function(){return{dom:{unwatch:function(){fte(),Cte=!0}}}},hooks:function(){return{bootstrap:function(){dte(xx("mutationObserverCallbacks",{}))},noAuto:function(){!function bze(){eC&&eC.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;Cte?Gx():dte(xx("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return yte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=yte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,s=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),E={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(s/2*-1," -256)")}};return{tag:"g",attributes:ut({},E.outer),children:[{tag:"g",attributes:ut({},E.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ut(ut({},n.icon.attributes),E.path)}]}]}}}},Zze,{provides:function(e){var t=!1;xl.matchMedia&&(t=xl.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ut(ut({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var s=ut(ut({},o),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ut(ut({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:ut(ut({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ut(ut({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ut(ut({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:ut(ut({},s),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:ut(ut({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ut(ut({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:I2});var Qze=I2.parse,Jze=I2.icon;const eDe=["*"],rDe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let sDe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),aDe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const o of i.icon[2])"string"==typeof o&&(this.definitions[i.prefix][o]=i)}}addIconPacks(...n){for(const i of n){const o=Object.keys(i).map(s=>i[s]);this.addIcons(...o)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),cDe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=zt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Do]}),e})(),lDe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Oc),U(Vo))},r.\u0275cmp=Fe({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Do],ngContentSelectors:eDe,decls:1,vars:0,template:function(n,i){1&n&&(function rF(r){const e=Pe()[Dr][zo];if(!e.projection){const n=e.projection=P7(r?r.length:1,null),i=n.slice();let o=e.child;for(;null!==o;){const s=r?Lue(o,r):0;null!==s&&(i[s]?i[s].projectionNext=o:n[s]=o,i[s]=o),o=o.next}}}(),function iF(r,e=0,t){const n=Pe(),i=Dn(),o=L8(i,yn+r,16,null,t||null);null===o.projection&&(o.projection=e),cM(),(!n[k3]||h8())&&32!=(32&o.flags)&&function $0e(r,e,t){dH(e[Kt],0,e,t,RM(r,t,e),sH(t.parent||e[zo],t,e))}(i,n,o)}(0))},encapsulation:2}),e})(),S0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,o,s,a){this.sanitizer=n,this.config=i,this.iconLibrary=o,this.stackItem=s,this.classes=[],null!=a&&null==s&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const o=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=o){const s=this.buildParams();this.renderIcon(o,s)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?Qze.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...rDe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const o=Jze(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(o.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(LB),U(sDe),U(aDe),U(cDe,8),U(lDe,8))},r.\u0275cmp=Fe({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(HE("innerHTML",i.renderedIconHTML,A7),A("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Do],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),uDe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Lo({type:r}),r.\u0275inj=oo({}),e})();function Ete(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===Ete(t[i],n[i]))return!1}return!0}}return r===e}function Ux(r){return null==r||function fDe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function _De(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function dDe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===Ux(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function k2(r,e){if(Ux(r)&&Ux(e))return Ete(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}class Ne{static fromFunctions(e,t){return new class extends Ne{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return Ne.fromFunctions(e,e)}static constant(e,t){return new class extends Ne{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends Ne{encode(i){const o=t(i),s={};return Object.keys(o).forEach(a=>{s[a]=e[a].encode(o[a])}),s}decode(i){const o={};return Object.keys(e).reverse().forEach(s=>{o[s]=e[s].decode(i[s])}),n(Object.values(o))}}}static disjunction(e,t){return H.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends Ne{encode(n){let i=0;for(const o of e){if(!0===o(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=H.getNonNullable(n).type,o=H.getNonNullable(n).encoded;return t[i].decode(o)}}}static list(e){return new class extends Ne{encode(t){return t.map(n=>{const i=e.encode(n);return H.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends Ne{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&k2(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class Q{static success(e){return new hDe(e)}static failure(e){return new gDe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&k2(this.get(),e.get())}}class hDe extends Q{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class gDe extends Q{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return Q.failure(this.reason)}}var w;!function(r){r.SUCCESS=Q.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return Q.failure(n)}}(w||(w={}));class O0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=sRe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return M(function*(){return(yield oRe(t.collection,e)).id})()}read(e){var t=this;return M(function*(){const n=yield lRe(_9(t.collection,e));return n.exists()?g.of(H.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return M(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return M(function*(){return pRe(_9(n.collection,e),t)})()}delete(e){return cRe(_9(this.collection,e))}set(e,t){return gRe(_9(this.collection,e),t)}subscribeToChanges(e,t){return new On(Pee(_9(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return M(function*(){const o=i.constructQuery(e,t,n);return(yield uRe(o)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new On(Pee(i,o=>{const s=[],a=[],c=[];o.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":s.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),s.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+s.length+" NEW "+this.collectionName),t.onDocumentCreated(s)),a.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=Rv(this.collection);null!=t&&(i=Rv(i,hRe(t))),null!=n&&(i=Rv(i,dRe(n)));for(const o of e)i=Rv(i,mRe(o[0],o[1],o[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends O0{constructor(o){super(n,o)}}(this.firestore);return this.subDAOs[n]=i,i}}}let pDe=(()=>{var r;class e extends O0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(kl))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var mDe=j2(1);let Ut=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const o=this.getDurationInMs(n);this.toast(n,i,o)}toast(n,i,o){(0,mDe.toast)({message:n,duration:o,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDurationInMs(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var tC,T0;class vi{static setSingletonInstance(e){vi.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw vi.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),w.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,vi.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const o=i.router.url,s=yield i.findErrors(e,o,t,n);if(0===s.length){const a={component:e,route:o,message:t,firstEncounter:e3(),lastEncounter:e3(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=s[0].id,c=s[0].data;yield i.errorDAO.update(a,{lastEncounter:e3(),occurences:c.occurences+1})}})()}}tC=vi,u(vi,"singleton",g.empty()),u(vi,"\u0275fac",function(e){return new(e||tC)(Oe(pDe),Oe(Un),Oe(Ut))}),u(vi,"\u0275prov",De({token:tC,factory:tC.\u0275fac,providedIn:"root"}));class we{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let o={};null!=i&&(o=JSON.parse(i)),void 0===n?o[t]=e:o[t+"."+n]=e;const s=we.getStringified(o);localStorage.setItem("verbosity",s)}static getStringified(e){try{return JSON.stringify(e)}catch{return"recursive and not stringifiable!"}}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];try{const n=JSON.parse(t);return null==n[e]?[!1,!1]:(H.assert(Array.isArray(n[e]),`malformed verbosity levels for ${e}: ${n[e]}`),n[e])}catch{throw new Error(`malformed verbosity object: ${t}`)}}static isMethodVerboseEntry(e,t){return we.isVerbose(e)[0]||we.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return we.isVerbose(e)[1]||we.isVerbose(e+"."+t)[1]}static display(e,t,n){we.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),o=H.getNonNullable(i);H.assert(o.value instanceof Function,"cannot add logging to properties that are not methods!");const a=o.value;o.value=function(...c){if(we.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(we.getStringified).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return we.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${we.getStringified(l)}`),l},Object.defineProperty(e.prototype,n,o)}}}window.enableLog=we.enableLog;class H{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw vi.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let Wx=(u(T0=class extends O0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||T0)(Oe(kl))}),u(T0,"\u0275prov",De({token:T0,factory:T0.\u0275fac,providedIn:"root"})),T0);var b0;Wx=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],Wx);let Pte=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),du=(b0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return M(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return M(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var o=this;return M(function*(){if(!1===o.userCanSendMessage(t.name,e))return w.failure(Pte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(n))return w.failure(Pte.FORBIDDEN_MESSAGE());const s={content:n,sender:t,postedTime:e3(),currentTurn:i};return yield o.addMessage(e,s),w.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(b0,"\u0275fac",function(e){return new(e||b0)(Oe(Wx))}),u(b0,"\u0275prov",De({token:b0,factory:b0.\u0275fac,providedIn:"root"})),b0);function nn(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),vi.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var m4,qx;du=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],du);let A9=(qx=m4=class extends O0{constructor(e){super(qx.COLLECTION_NAME,e)}},u(m4,"COLLECTION_NAME","users"),u(m4,"\u0275fac",function(e){return new(e||m4)(Oe(kl))}),u(m4,"\u0275prov",De({token:m4,factory:m4.\u0275fac,providedIn:"root"})),m4);A9=qx=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],A9);let hu=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return M(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var o=this;return M(function*(){yield o.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return M(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,o=>{o.isPresent()&&null===o.get().lastUpdateTime||i(o)})}getUserLastUpdateTime(n){var i=this;return M(function*(){const o=yield i.userDAO.read(n);if(o.isAbsent())return g.empty();{const s=o.get().lastUpdateTime;return nn(null!=s,"should not receive a lastUpdateTime equal to null"),g.of(s)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:e3()})}getServerTime(n){var i=this;return M(function*(){return new Promise(o=>{let s=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?s=!0:s&&(c.unsubscribe(),o(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(A9))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class Ste extends Vs{constructor(e=1/0,t=1/0,n=bb){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(n.push(e),!i&&n.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=n?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<n.length&&n.splice(0,n.length-o),!i){const s=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=s;c+=2)a=c;a&&n.splice(0,a+1)}}}var w0;let I9=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class Dl{static createUserWithEmailAndPassword(e,t,n){return KNe(e,t,n)}static sendEmailVerification(e){return JNe(e)}static sendPasswordResetEmail(e,t){return eAe(e,t)}static signInWithEmailAndPassword(e,t,n){return M(function*(){return(yield tAe(e,t,n)).user})()}static signInWithPopup(e,t){return M(function*(){return(yield nAe(e,t)).user})()}static updateProfile(e,t){return rAe(e,t)}}class N0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(N0,"NOT_CONNECTED",new N0("",g.empty(),g.empty(),!1));let ar=(w0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new On),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new Ste(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new On(QNe(this.auth,function(){var o=M(function*(s){null==s?(we.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(N0.NOT_CONNECTED),i.user=g.empty()):(nn(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(s.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;we.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(s)}`);const f=!0===i.emailVerified(s)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(s.uid);const d=new N0(s.uid,g.ofNullable(s.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(s){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return M(function*(){try{return yield Dl.sendPasswordResetEmail(t.auth,e),w.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}doRegister(e,t,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):Q.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return M(function*(){try{const o=yield Dl.createUserWithEmailAndPassword(i.auth,t,n);yield Dl.signInWithEmailAndPassword(i.auth,t,n);const s=H.getNonNullable(o.user);return yield i.createUser(s.uid,e),Q.success(s)}catch(o){return i.catchFirebaseError(o)}})()}catchFirebaseError(e){if(e instanceof T2)return Q.failure(this.mapFirebaseError(e));throw e}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return vi.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return M(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return vi.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return vi.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield Dl.sendEmailVerification(t.get()),w.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}doEmailLogin(e,t){var n=this;return M(function*(){try{return yield Dl.signInWithEmailAndPassword(n.auth,e,t),w.SUCCESS}catch(i){return n.catchFirebaseError(i)}})()}createUser(e,t){var n=this;return M(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return M(function*(){return w.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return M(function*(){try{const t=new Bbe;t.addScope("profile"),t.addScope("email");const n=yield Dl.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),Q.success(n)}catch(t){return e.catchFirebaseError(t)}})()}disconnect(){var e=this;return M(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),w.SUCCESS):w.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return M(function*(){if(""===e)return w.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return w.failure($localize`This username is already in use, please select a different one.`);const i=H.getNonNullable(t.auth.currentUser);return yield Dl.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),w.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}setPicture(e){var t=this;return M(function*(){try{const n=H.getNonNullable(t.auth.currentUser);return yield Dl.updateProfile(n,{photoURL:e}),w.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}reloadUser(){var e=this;return M(function*(){const t=H.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return nn(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(w0,"\u0275fac",function(e){return new(e||w0)(Oe(A9),Oe(hu),Oe(c_))}),u(w0,"\u0275prov",De({token:w0,factory:w0.\u0275fac,providedIn:"root"})),w0);var _4,rC,iC,k9,gu,W,A0;ar=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ar);class I1{constructor(e){u(this,"value",void 0),this.value=e}}u(I1,"HARD_DRAW",new(_4=I1)(0)),u(I1,"RESIGN",new _4(1)),u(I1,"ESCAPE",new _4(2)),u(I1,"VICTORY",new _4(3)),u(I1,"TIMEOUT",new _4(4)),u(I1,"UNACHIEVED",new _4(5)),u(I1,"AGREED_DRAW_BY_ZERO",new _4(6)),u(I1,"AGREED_DRAW_BY_ONE",new _4(7));class nC{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===I1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===I1.AGREED_DRAW_BY_ZERO.value||this.data.result===I1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===I1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(nn(this.data.result===I1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),H.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===I1.VICTORY.value}isTimeout(){return this.data.result===I1.TIMEOUT.value}isResign(){return this.data.result===I1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new nC(this.id,{...this.data,winner:e,loser:t})}}class $i{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return $i.CREATOR;case"RANDOM":return $i.RANDOM;default:return nn("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),$i.CHOSEN_PLAYER}}}u($i,"CREATOR",new(rC=$i)("CREATOR")),u($i,"RANDOM",new rC("RANDOM")),u($i,"CHOSEN_PLAYER",new rC("CHOSEN_PLAYER"));class cr{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return cr.STANDARD;case"BLITZ":return cr.BLITZ;case"CUSTOM":return cr.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(cr,"STANDARD",new(iC=cr)("STANDARD")),u(cr,"BLITZ",new iC("BLITZ")),u(cr,"CUSTOM",new iC("CUSTOM")),u(cr,"NORMAL_MOVE_DURATION",120),u(cr,"NORMAL_PART_DURATION",1800),u(cr,"BLITZ_MOVE_DURATION",30),u(cr,"BLITZ_PART_DURATION",900);class Co{constructor(e){u(this,"value",void 0),this.value=e}}u(Co,"PART_CREATED",new(k9=Co)(0)),u(Co,"CONFIG_PROPOSED",new k9(2)),u(Co,"PART_STARTED",new k9(3)),u(Co,"PART_FINISHED",new k9(4));class jx{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(jx,"NONE",new jx);class k{static of(e){return 0===e?k.ZERO:(H.expectToBe(e,1),k.ONE)}static ofTurn(e){return e%2==0?k.ZERO:k.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===k.ZERO?"PLAYER_ZERO":(H.expectToBe(this,k.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===k.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===k.ZERO?k.ONE:(H.expectToBe(this,k.ONE),k.ZERO)}}gu=k,u(k,"encoder",Ne.tuple([Ne.identity()],r=>[r.value],r=>gu.of(r[0]))),u(k,"ZERO",new gu(0)),u(k,"ONE",new gu(1)),u(k,"PLAYERS",[gu.ZERO,gu.ONE]),function(r){r.ZERO=k.ZERO,r.ONE=k.ONE,r.NONE=jx.NONE,r.encoder=new class extends Ne{encode(e){return e.value}decode(e){return 2===e?r.NONE:(H.assert(0===e||1===e,"Invalid encoded player: "+e),k.of(e))}}}(W||(W={}));let x9=(u(A0=class extends O0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||A0)(Oe(kl))}),u(A0,"\u0275prov",De({token:A0,factory:A0.\u0275fac,providedIn:"root"})),A0);x9=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],x9);class oC{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let Zx=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,o){return this.addEvent(n,{eventType:"Move",time:e3(),player:i.value,move:o})}addRequest(n,i,o){return this.addEvent(n,{eventType:"Request",time:e3(),player:i.value,requestType:o})}addReply(n,i,o,s,a=null){return this.addEvent(n,{eventType:"Reply",time:e3(),player:i.value,reply:o,requestType:s,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,o){return this.addEvent(n,{eventType:"Action",time:e3(),player:i.value,action:o})}subscribeToEvents(n,i){const o=new oC(s=>{const a=s.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},s=>{i(s.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],o,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(x9))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class yo{constructor(){u(this,"__nominal",void 0)}}var pu;class rn{static of(e){switch(e){case 0:return rn.ZERO;case 1:return rn.ONE;case 2:return rn.TWO;default:return nn(3===e,"Invalid Apagos Coord "+e),rn.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}pu=rn,u(rn,"encoder",Ne.tuple([Ne.identity()],r=>[r.x],r=>pu.of(r[0]))),u(rn,"ZERO",new pu(0)),u(rn,"ONE",new pu(1)),u(rn,"TWO",new pu(2)),u(rn,"THREE",new pu(3));let mu=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var Yo;class x2 extends yo{static drop(e,t){return H.getNonNullable(x2.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return Q.failure(mu.PIECE_SHOULD_MOVE_DOWNWARD());const n=H.getNonNullable(x2.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return Q.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(x2,"ALL_MOVES",[new(Yo=x2)(rn.ZERO,g.of(k.ZERO),g.empty()),new Yo(rn.ONE,g.of(k.ZERO),g.empty()),new Yo(rn.TWO,g.of(k.ZERO),g.empty()),new Yo(rn.THREE,g.of(k.ZERO),g.empty()),new Yo(rn.ZERO,g.of(k.ONE),g.empty()),new Yo(rn.ONE,g.of(k.ONE),g.empty()),new Yo(rn.TWO,g.of(k.ONE),g.empty()),new Yo(rn.THREE,g.of(k.ONE),g.empty()),new Yo(rn.TWO,g.empty(),g.of(rn.THREE)),new Yo(rn.ONE,g.empty(),g.of(rn.THREE)),new Yo(rn.ZERO,g.empty(),g.of(rn.THREE)),new Yo(rn.ONE,g.empty(),g.of(rn.TWO)),new Yo(rn.ZERO,g.empty(),g.of(rn.TWO)),new Yo(rn.ZERO,g.empty(),g.of(rn.ONE))]),u(x2,"encoder",Ne.tuple([rn.encoder,g.getEncoder(k.encoder),g.getEncoder(rn.encoder)],r=>[r.landing,r.piece,r.starting],r=>new Yo(r[0],r[1],r[2])));class sC{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return k.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?k.ZERO:k.ONE}}class bte{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>k2(i,n))&&t.push(n)}),t}}let wte,Nte;wte=Symbol.iterator;class it{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:bte.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(k2(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new it(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(k2(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new it(t)}flatMap(e){const t=new it;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new it;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new it;for(const n of e)this.contains(n)&&t.add(n);return t}getMissingElementFrom(e){for(const t of e)if(!1===this.contains(t))return g.of(t);return g.empty()}[wte](){return this.values.values()}}class Qt{static from(e){const t=Object.keys(e),n=new Qt;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(k2(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(k2(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>k2(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}listValues(){return this.map.map(e=>e.value)}getKeySet(){return new it(this.listKeys())}filter(e){const t=new Qt;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(k2(this.map[t].key,e)){const i=this.map[t].value,o=this.map.slice(0,t),s=this.map.slice(t+1);return this.map=o.concat(s),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const o=this.get(i).get(),s=e.get(i);if(nn(s.isPresent(),"value is absent in a map even though its key is present!"),!1===k2(o,s.get()))return!1}return!0}}class _u extends Qt{reverse(){const e=new _u;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new it;i.add(t),e.set(n,i)}}return e}}class Ct{static create(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copy(e){return e.map(t=>t)}static sortByDescending(e,t){e.sort((n,i)=>{const o=t(n),s=t(i);return o<s?1:o>s?-1:0})}static equals(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===k2(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&Ct.equals(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}static getRandomElement(e){return H.assert(e.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),e[Math.floor(Math.random()*e.length)]}static maximumsBy(e,t){let n=[],i=-1/0;for(const o of e){const s=t(o);s>=i&&(s>i&&(n=[]),i=s,n.push(o))}return n}static count(e,t){let n=0;for(const i of e)k2(i,t)&&n++;return n}static isLessThan(e,t){H.assert(e.length>0&&t.length>0,"ArrayUtils.isLessThan/isGreaterThan should have two non-empty list as parameter");const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)if(t[i]!==e[i])return e[i]<t[i];return!1}static isGreaterThan(e,t){return Ct.isLessThan(t,e)}static min(e,t){return Ct.isLessThan(e,t)?e:t}static max(e,t){return Ct.isGreaterThan(e,t)?e:t}}class wt{static create(e,t,n){const i=[];for(let o=0;o<t;o++)i.push(Ct.create(e,n));return i}static map(e,t){return e.map(n=>n.map(t))}static copy(e){return wt.map(e,t=>t)}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Ct.equals(e[n],t[n]))return!1;return!0}}Nte=Symbol.iterator;class Ate{constructor(){u(this,"content",new Qt)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new Qt,this.content.set(e.y,i)),i.set(e.x,t)}[Nte](){const e=[],t=this.content.getKeySet().toList();t.sort(Ct.smallerFirst);for(const n of t){const i=this.content.get(n).get(),o=i.getKeySet().toList();o.sort(Ct.smallerFirst);for(const s of o){const a=i.get(s).get();e.push({x:s,y:n,content:a})}}return e.values()}}class PDe{static create(e,t,n,i){const o=[];for(let s=0;s<e;s++)o.push(wt.create(t,n,i));return o}}class L9{static from(e,t,n){if(e+t>n)return Q.failure("invalid starting space");const i=new Qt([{key:k.ZERO,value:e},{key:k.ONE,value:t},{key:W.NONE,value:n}]);i.makeImmutable();const o=new L9(i);return Q.success(o)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){const e=this.count(k.ZERO),t=this.count(k.ONE);return this.count(W.NONE)<=e+t}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(W.NONE);return e===k.ZERO?t++:n++,L9.from(t,n,i).get()}substractPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(W.NONE);return e===k.ZERO?t--:n--,L9.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(k.ZERO),t=this.count(k.ONE);return e>t?k.ZERO:t>e?k.ONE:W.NONE}equals(e){return this.containing.equals(e.containing)}}class v4 extends sC{static fromRepresentation(e,t,n,i){const o=[];for(let a=0;a<4;a++){const d=L9.from(t[0][a],t[1][a],t[2][a]).get();o.push(d)}const s=new Qt;return s.set(k.ZERO,n),s.set(k.ONE,i),new v4(e,o,s)}constructor(e,t,n){super(e),u(this,"board",void 0),u(this,"remaining",void 0),this.board=t,this.remaining=n,this.remaining.makeImmutable()}getPieceAt(e){return this.board[e.x]}updateAt(e,t){const n=[];for(let o=0;o<4;o++)n.push(e.x===o?t:this.board[o]);const i=this.getRemainingCopy();return new v4(this.turn,n,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Ct.equals(e.board,this.board)&&this.remaining.equals(e.remaining)}}class j{static fromMove(e,t,n,i,o,s){return new SDe(e,t,n,i,o,s)}static forClick(e,t,n,i,o,s){return new TDe(e,t,n,i,o,s)}static anyMove(e,t,n,i,o){return new ODe(e,t,n,i,o)}static fromPredicate(e,t,n,i,o,s){return new bDe(e,t,n,i,o,s)}static informational(e,t,n){return new wDe(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class aC extends j{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class SDe extends aC{constructor(e,t,n,i,o,s){super(e,t,n,o),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=s,nn(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class ODe extends aC{constructor(e,t,n,i,o){super(e,t,n,o),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class TDe extends aC{constructor(e,t,n,i,o,s){super(e,t,n,o),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class bDe extends aC{constructor(e,t,n,i,o,s){super(e,t,n,s),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=o}getSolution(){return this.solutionMove}isPredicate(){return!0}}class wDe extends j{isInformation(){return!0}}class qn{}class un{static max(e,t){const n=Ct.max(e.metrics,t.metrics);return un.multiMetric(n)}static min(e,t){const n=Ct.min(e.metrics,t.metrics);return un.multiMetric(n)}static isVictory(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER}static isPreVictory(e){return e===Number.MAX_SAFE_INTEGER-1||e===Number.MIN_SAFE_INTEGER+1}static ofSingle(e,t){return un.ofMultiple([e],[t])}static ofMultiple(e,t){H.assert(e.length===t.length,"both player should have the same number of metric"),H.assert(e.length>=1,"scores list should be filled");const n=[];for(let i=0;i<e.length;i++){const o=e[i]*k.ZERO.getScoreModifier(),s=t[i]*k.ONE.getScoreModifier();n.push(o+s)}return new un(n)}static of(e){return new un([e])}static multiMetric(e){return new un(e)}static isLessThan(e,t){return Ct.isLessThan(e.metrics,t.metrics)}static isGreaterThan(e,t){return Ct.isGreaterThan(e.metrics,t.metrics)}constructor(e){u(this,"metrics",void 0),this.metrics=e}toMaximum(){const t=Ct.create(this.metrics.length,Number.MAX_SAFE_INTEGER);return un.multiMetric(t)}toMinimum(){const t=Ct.create(this.metrics.length,Number.MIN_SAFE_INTEGER);return un.multiMetric(t)}equals(e){return Ct.equals(this.metrics,e.metrics)}}var R9,cC,Yx;u(un,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class _e{static getVictory(e){return e===k.ZERO?_e.ZERO_WON:_e.ONE_WON}static getDefeat(e){return e===k.ZERO?_e.ONE_WON:_e.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?un.of(this.winner.getVictoryValue()):un.of(0)}}u(_e,"ZERO_WON",new(R9=_e)(!0,k.ZERO)),u(_e,"ONE_WON",new R9(!0,k.ONE)),u(_e,"DRAW",new R9(!0,W.NONE)),u(_e,"ONGOING",new R9(!1,W.NONE));let Ite=(()=>{class r{}return u(r,"createdNodes",0),r})(),L2=(cC=class{constructor(e,t=g.empty(),n=g.empty()){u(this,"gameState",void 0),u(this,"parent",void 0),u(this,"previousMove",void 0),u(this,"id",void 0),u(this,"children",new Qt),u(this,"cache",new Qt),this.gameState=e,this.parent=t,this.previousMove=n,this.id=Yx.ID++,Ite.createdNodes++}getChild(e){return this.children.get(e)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(e){H.assert(e.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(e.previousMove.get(),e)}printDot(e,t,n,i=0,o=0,s=g.empty()){0===i&&console.log("digraph G {");const a=e.getGameStatus(this,s);let c="white";if(a.isEndGame)switch(a.winner){case k.ZERO:c="#994d00";break;case k.ONE:c="#ffc34d";break;default:c="grey"}let l=`#${this.gameState.turn}: ${this.id}`;t&&(l+=` - ${t(this)}`),console.log(`    node_${o} [label="${l}", style=filled, fillcolor="${c}"];`);let f=o+1;if(void 0===n||i<n)for(const d of this.children.listValues())console.log(`    node_${o} -> node_${f} [label="${d.previousMove.get()}"];`),f=d.printDot(e,t,n,i+1,f);return 0===i&&console.log("}"),f}getCache(e){return this.cache.get(e)}setCache(e,t){this.cache.containsKey(e)?this.cache.replace(e,t):this.cache.set(e,t)}},Yx=cC,u(cC,"ID",0),cC);L2=Yx=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],L2);class kte{constructor(){}choose(e,t,n){we.display("Rules","choose",t.toString()+" was proposed");const i=this.isLegal(t,e.gameState,n);if(i.isFailure())return we.display("Rules","choose","Move is illegal: "+i.getReason()),Q.failure(i.getReason());const o=e.getChild(t);if(o.isPresent())return H.assert(i.isSuccess(),"Rules.choose: Move is illegal: "+i.getReasonOr("")),we.display("Rules","choose","and this proposed move is found in the list, so it is legal"),Q.success(o.get());const s=this.applyLegalMove(t,e.gameState,n,i.get()),a=new L2(s,g.of(e),g.of(t));return Q.success(a)}getInitialNode(e){const t=this.getInitialState(e);return new L2(t)}getDefaultRulesConfig(){const e=this.getRulesConfigDescription();return e.isPresent()?g.of(e.get().getDefaultConfig().config):g.empty()}}class ja extends kte{}class Sr extends kte{getRulesConfigDescription(){return g.empty()}}class R2 extends Sr{static get(){return R2.singleton.isAbsent()&&(R2.singleton=g.of(new R2)),R2.singleton.get()}getInitialState(){return v4.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],R2.PIECES_PER_PLAYER,R2.PIECES_PER_PLAYER)}applyLegalMove(e,t,n,i){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const o=new v4(t.turn+1,t.board,n),s=e.piece.get(),a=o.getPieceAt(e.landing).addPiece(s);if(e.landing===rn.THREE)return o.updateAt(e.landing,a);{const c=rn.of(e.landing.x+1),l=o.getPieceAt(c);return o.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),o=t.getPieceAt(i).substractPiece(n),s=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,o);return a=a.updateAt(e.landing,s),new v4(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?w.failure(mu.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?w.failure(mu.NO_PIECE_REMAINING_TO_DROP()):w.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?w.failure(mu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):w.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(rn.of(i)).isFull())return _e.ONGOING;const n=t.getPieceAt(rn.THREE).getDominatingPlayer();return H.assert(n.isPlayer(),"winner can only be a player if the game is finished"),_e.getVictory(n)}}u(R2,"PIECES_PER_PLAYER",10),u(R2,"singleton",g.empty());class ADe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,R2.get().getInitialState()),j.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,v4.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),x2.drop(rn.ZERO,k.ZERO),$localize`Congratulations!`),j.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,v4.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),x2.transfer(rn.TWO,rn.ZERO).get(),(t,n,i)=>t.isDrop()?w.failure($localize`This move is a drop, please do a transfer!`):w.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,v4.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),x2.drop(rn.TWO,k.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(k.ONE)?w.SUCCESS:w.failure($localize`You actively made your opponent win!`):w.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class lC{static gcd(e,t){return 0===t?Math.abs(e):lC.gcd(t,e%t)}static sum(e,t){return e+t}}class Vt{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isSingleOrthogonalStep(){const e=Math.abs(this.x)+Math.abs(this.y)===1;return this.isOrthogonal()&&e}isOrthogonal(){return 0===this.x||0===this.y}isDiagonal(){return 0!==this.x&&0!==this.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=lC.gcd(this.x,this.y);return new Vt(this.x/e,this.y/e)}combine(e,t=1){return new Vt(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var M1,Es;class Kx extends Vt{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class Xx{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return Q.success(n);return Q.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?Q.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):Q.failure(IDe.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return Q.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return Q.failure(`Invalid int direction: ${e}`)}}}class ve extends Kx{constructor(e,t){super(e,t)}getOpposite(){return ve.factory.from(-this.x,-this.y).get()}}u(ve,"UP",new(M1=ve)(0,-1)),u(ve,"UP_RIGHT",new M1(1,-1)),u(ve,"RIGHT",new M1(1,0)),u(ve,"DOWN_RIGHT",new M1(1,1)),u(ve,"DOWN",new M1(0,1)),u(ve,"DOWN_LEFT",new M1(-1,1)),u(ve,"LEFT",new M1(-1,0)),u(ve,"UP_LEFT",new M1(-1,-1)),u(ve,"factory",new class extends Xx{constructor(...r){super(...r),u(this,"all",[M1.UP,M1.UP_RIGHT,M1.RIGHT,M1.DOWN_RIGHT,M1.DOWN,M1.DOWN_LEFT,M1.LEFT,M1.UP_LEFT])}}),u(ve,"DIRECTIONS",M1.factory.all),u(ve,"DIAGONALS",[M1.UP_RIGHT,M1.DOWN_RIGHT,M1.DOWN_LEFT,M1.UP_LEFT]),u(ve,"ORTHOGONALS",[M1.UP,M1.RIGHT,M1.DOWN,M1.LEFT]),u(ve,"encoder",Ne.fromFunctions(r=>r.toString(),r=>(nn("string"==typeof r,"Invalid encoded direction"),M1.factory.fromString(r).get())));class Re extends Kx{constructor(e,t){super(e,t)}getOpposite(){return Re.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Re.factory.from(-this.y,this.x).get()}}u(Re,"UP",new(Es=Re)(0,-1)),u(Re,"RIGHT",new Es(1,0)),u(Re,"DOWN",new Es(0,1)),u(Re,"LEFT",new Es(-1,0)),u(Re,"factory",new class extends Xx{constructor(...r){super(...r),u(this,"all",[Es.UP,Es.RIGHT,Es.DOWN,Es.LEFT])}from(r,e){return 0===r&&-1===e?Q.success(Es.UP):1===r&&0===e?Q.success(Es.RIGHT):0===r&&1===e?Q.success(Es.DOWN):-1===r&&0===e?Q.success(Es.LEFT):Q.failure("Invalid orthogonal from x and y")}}),u(Re,"ORTHOGONALS",Es.factory.all),u(Re,"encoder",Ne.fromFunctions(r=>r.toString(),r=>(nn("string"==typeof r,"Invalid encoded orthogonal"),Es.factory.fromString(r).get())));let IDe=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var Qx,vu;class Ps{static OUT_OF_RANGE(e){return`The coordinate ${e.toString()} is not on the board`}}class v extends Vt{static getEncoder(e){return Ne.tuple([Ne.identity(),Ne.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new v(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new v(this.x+e.y,this.y+-e.x)}getRight(e){return new v(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||e<=this.x||t<=this.y)}isNotInRange(e,t){return this.x<0||this.y<0||e<=this.x||t<=this.y}getDirectionToward(e){return ve.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}isNeighborWith(e){return!!this.isAlignedWith(e)&&1===this.getDistance(e)}getVectorToward(e){return new Vt(e.x-this.x,e.y-this.y)}toVector(){return new Vt(this.x,this.y)}getCoordsToward(e){if(H.assert(e.isAlignedWith(this),"Should only call getCoordsTowards on aligned coords"),e.equals(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getAllCoordsToward(e){let t=[this];if(!1===this.equals(e)){const n=this.getCoordsToward(e);t=t.concat(n).concat(e)}return t}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}scale(e,t){return new v(this.x*e,this.y*t)}}u(v,"encoder",(Qx=v).getEncoder((r,e)=>new Qx(r,e)));class xte{getPlayerClass(e){switch(e){case k.ZERO:return"player0-fill";case k.ONE:return"player1-fill";default:return H.expectToBe(e,W.NONE),""}}}class uC extends xte{constructor(...e){super(...e),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"ArrayUtils",Ct)}getSVGTranslate(e,t){return"translate("+e+", "+t+")"}}class Lte extends xte{constructor(e){super(),u(this,"activatedRoute",void 0),this.activatedRoute=e}getGameName(){return H.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}}let n3=(vu=class extends uC{constructor(e){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",k),u(this,"rules",void 0),u(this,"node",void 0),u(this,"config",g.empty()),u(this,"availableAIs",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"pointOfView",k.ZERO),u(this,"interactive",!1),this.messageDisplayer=e}getPointOfView(){return this.pointOfView}setPointOfView(e){this.pointOfView=e,this.hasAsymmetricBoard&&(this.rotation="rotate("+180*e.value+")")}setInteractive(e){this.interactive=e}isInteractive(){return this.interactive}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.cancelMoveOnWrapper(e),t.node.previousMove.isPresent()&&(yield t.showLastMove(t.node.previousMove.get())),null==e?w.SUCCESS:(t.messageDisplayer.gameMessage(e),w.failure(e))})()}cancelMoveAttempt(){}pass(){var e=this;return M(function*(){return vi.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}showLastMove(e,t=g.empty()){return M(function*(){})()}hideLastMove(){}setRulesAndNode(e){const t=Ft.getByUrlName(e).get(),n=t.getRulesConfig();this.rules=t.rules,this.node=this.rules.getInitialNode(n),this.tutorial=t.tutorial.tutorial}getConfig(){return this.config}getTranslation(e){return this.getTranslationXY(e.x,e.y)}getTranslationXY(e,t){return`translate(${e*this.SPACE_SIZE} ${t*this.SPACE_SIZE})`}},u(vu,"\u0275fac",function(e){return new(e||vu)(U(Ut))}),u(vu,"\u0275cmp",Fe({type:vu,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),vu);n3=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],n3);let Cu=(()=>{var r;class e extends n3{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const o=new v(n,i);return this.getHexaPointsAt(o)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const o=new v(n,i);return this.getCenterAt(o)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var z9,Ci;class Me{static of(e){switch(e){case Me.ZERO.value:return Me.ZERO;case Me.ONE.value:return Me.ONE;case Me.EMPTY.value:return Me.EMPTY;case Me.UNREACHABLE.value:return Me.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===k.ZERO?Me.ZERO:(H.expectToBe(e,k.ONE),Me.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Me.ZERO||this===Me.ONE}}u(Me,"ZERO",new(z9=Me)(k.ZERO.value)),u(Me,"ONE",new z9(k.ONE.value)),u(Me,"EMPTY",new z9(W.NONE.value)),u(Me,"UNREACHABLE",new z9(3));class Ae extends Kx{static getAngle(e){switch(e){case Ae.UP:return 0;case Ae.UP_RIGHT:return 60;case Ae.RIGHT:return 120;case Ae.DOWN:return 180;case Ae.DOWN_LEFT:return 240;default:return H.expectToBe(e,Ae.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return Ae.factory.from(-this.x,-this.y).get()}}u(Ae,"UP",new(Ci=Ae)(0,-1)),u(Ae,"LEFT",new Ci(-1,0)),u(Ae,"UP_RIGHT",new Ci(1,-1)),u(Ae,"DOWN_LEFT",new Ci(-1,1)),u(Ae,"RIGHT",new Ci(1,0)),u(Ae,"DOWN",new Ci(0,1)),u(Ae,"factory",new class extends Xx{constructor(...r){super(...r),u(this,"all",[Ci.UP,Ci.UP_RIGHT,Ci.RIGHT,Ci.DOWN,Ci.DOWN_LEFT,Ci.LEFT])}}),u(Ae,"encoder",Ne.fromFunctions(r=>{switch(r){case Ci.UP:return 0;case Ci.UP_RIGHT:return 1;case Ci.RIGHT:return 2;case Ci.DOWN:return 3;case Ci.DOWN_LEFT:return 4;default:return 5}},r=>(H.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),Ci.factory.all[r])));class Dte{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class fC extends Dte{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(fC,"INSTANCE",new fC);class Wr extends Dte{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(Wr,"INSTANCE",new Wr);class yu{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new v(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new v(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const o=this.getCornerOffset(i);n.push(new v(t.x+o.x,t.y+o.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){H.assert(this.orientation===Wr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),o=this.getCornerOffset(1),s=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new v(n.x+a.x,n.y+a.y),new v(n.x+a.x,n.y+a.y+t),new v(n.x+s.x,n.y+s.y+t),new v(n.x+s.x,n.y+s.y)],[new v(n.x+i.x,n.y+i.y),new v(n.x+i.x,n.y+i.y+t),new v(n.x+o.x,n.y+o.y+t),new v(n.x+s.x,n.y+s.y+t),new v(n.x+s.x,n.y+s.y),new v(n.x+o.x,n.y+o.y)],[new v(n.x+a.x,n.y+a.y),new v(n.x+a.x,n.y+a.y+t),new v(n.x+s.x,n.y+s.y+t),new v(n.x+o.x,n.y+o.y+t),new v(n.x+i.x,n.y+i.y+t),new v(n.x+i.x,n.y+i.y),new v(n.x+o.x,n.y+o.y),new v(n.x+s.x,n.y+s.y)]]}}let Hte,Ee=(()=>{class r{}return u(r,"MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT",()=>$localize`You have selected a piece of the opponent. You must pick one of your pieces.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),u(r,"MUST_MOVE_ON_NEIGHBOR",()=>$localize`You must move on a direct neighboring space.`),r})(),Hl=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();Hte=Symbol.iterator;class k1 extends sC{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new v(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.board[t].length;n++){const i=new v(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return wt.copy(this.board)}toMap(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.getWidth();n++){const i=new v(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}getWidth(){return this.board[0].length}getHeight(){return this.board.length}isHorizontalEdge(e){const t=this.getHeight()-1;return 0===e.y||e.y===t}isVerticalEdge(e){const t=this.getWidth()-1;return 0===e.x||e.x===t}isEdge(e){return this.isHorizontalEdge(e)||this.isVerticalEdge(e)}isCorner(e){return this.isHorizontalEdge(e)&&this.isVerticalEdge(e)}[Hte](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class e2 extends Sr{static get(){return e2.singleton.isAbsent()&&(e2.singleton=g.of(new e2)),e2.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new Za([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isLegalRealPush(e,t,n,i,o){let s=0;const a=Me.ofPlayer(n.getCurrentOpponent()),c=Me.ofPlayer(n.getCurrentPlayer());for(;s<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)s++,e=e.getNext(t.dir);return i<=s?Q.failure(Hl.NOT_ENOUGH_PIECE_TO_PUSH()):Za.isOnBoard(e)&&(n.getPieceAt(e)===Me.EMPTY&&(o[e.y][e.x]=a),n.getPieceAt(e)===c)?Q.failure(Hl.CANNOT_PUSH_YOUR_OWN_PIECES()):Q.success(o)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?_e.ZERO_WON:t[1]>5?_e.ONE_WON:_e.ONGOING}applyLegalMove(e,t,n,i){return new Za(i,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Me.ofPlayer(t.getCurrentOpponent())?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):w.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const o=Me.ofPlayer(t.getCurrentPlayer()),s=Me.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=s;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===o;)n++,i=i.getNext(e.dir);return n>3?Q.failure(Hl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Za.isOnBoard(i)||(a[i.y][i.x]=o,t.getPieceAt(i)===s)?Q.success(a):e2.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let o=e.coord;const s=Me.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===o.equals(n)&&Za.isOnBoard(o);){if(t.getPieceAt(o)!==s)return Q.failure(Hl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=o.getNext(e.dir);if(a[o.y][o.x]=Me.EMPTY,Za.isOnBoard(c)){if(t.isPiece(c))return Q.failure(Hl.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Me.EMPTY&&(a[c.y][c.x]=s)}o=o.getNext(i)}return Q.success(a)}getGameStatus(e){return e2.getGameStatus(e)}}u(e2,"singleton",g.empty());class Za extends k1{static isOnBoard(e){return e.isInRange(9,9)&&e2.get().getInitialState().getPieceAt(e)!==Me.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===Me.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Me.ONE&&(e[0]=e[0]-1);return e}}class Or extends yo{static getFallibleEncoder(e){return Ne.tuple([v.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return Ne.tuple([v.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new v(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Vte;class Gi extends Or{static ofSingleCoord(e,t){return H.assert(e.isInRange(9,9),Ps.OUT_OF_RANGE(e)),new Gi(e,t,g.empty())}static ofDoubleCoord(e,t,n){const i=[e,t];Ct.sortByDescending(i,Gi.sortCoord);const o=i[1].getDirectionToward(i[0]).get(),s=Ae.factory.fromDelta(o.x,o.y);H.assert(s.isSuccess(),"Invalid direction");const a=s.get(),c=i[1].getDistance(i[0]);return H.assert(c<=2,"Distance between first coord and last coord is too big"),a.equals(n)?Gi.ofSingleCoord(i[1],n):a.getOpposite().equals(n)?Gi.ofSingleCoord(i[0],n):new Gi(i[1],n,g.of(i[0]))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Vte=Gi,u(Gi,"encoder",Ne.tuple([v.encoder,Ae.encoder,g.getEncoder(v.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Vte(r[0],r[1],r[2])));class bn{constructor(e,t,n){u(this,"name",void 0),u(this,"moveGenerator",void 0),u(this,"rules",void 0),u(this,"explorationParameter",Math.sqrt(2)),u(this,"maxGameLength",8),u(this,"availableOptions",[]),this.name=e,this.moveGenerator=t,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(e,t,n){H.assert(!1===this.rules.getGameStatus(e,n).isEndGame,"cannot search from a finished game");const i=e.gameState.getCurrentPlayer(),o=Date.now(),s=Date.now()+1e3*t.maxSeconds;let a=0;for(;Date.now()<s;){const d=this.expand(this.select({node:e,path:[e]}),n),m=this.simulate(d.node,s,n);this.backpropagate(d.path,this.winScore(m,i)),a++}we.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(e)),we.display("MCTS","chooseNextMove","children winRatio: "+e.getChildren().map(d=>d.id+": "+this.winRatio(d)));const c=Ct.maximumsBy(e.getChildren(),d=>this.winRatio(d)),l=Ct.getRandomElement(c),f=(Date.now()-o)/1e3;return we.display("MCTS","chooseNextMove",`Computed ${a} in ${f} (rate: ${a/f} it/s)`),we.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(l)),l.previousMove.get()}winScore(e,t){switch(e){case _e.DRAW:case _e.ONGOING:return.5;default:return e.winner===t?1:0}}ucb(e,t){const n=this.simulations(e);return 0===t||0===n?Number.MAX_SAFE_INTEGER:this.wins(e)/n+this.explorationParameter*Math.sqrt(Math.log(t)/n)}winRatio(e){const t=this.simulations(e);return 0===this.simulations(e)?1:this.wins(e)/t}wins(e){return this.getCounterFromCache(e,"wins")}simulations(e){return this.getCounterFromCache(e,"simulations")}getCounterFromCache(e,t){const n=e.getCache(t);return n.isPresent()?n.get():(e.setCache(t,0),0)}select(e){const t=e.node;if(we.display("MCTS","select","Exploring node: "+t.id),t.hasChildren()){const n=this.simulations(t);we.display("MCTS","select","UCB values: "+t.getChildren().map(s=>s.id+": "+this.ucb(t,n)));const i=Ct.maximumsBy(t.getChildren(),s=>this.ucb(s,n)),o=Ct.getRandomElement(i);return we.display("MCTS","select","selecting children "+o.id),this.select({node:o,path:e.path.concat([o])})}return we.display("MCTS","select","this is a leaf node, we select it"),e}expand(e,t){if(this.rules.getGameStatus(e.node,t).isEndGame)return e;const n=e.node,i=this.moveGenerator.getListMoves(n,t);H.assert(i.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of i)n.addChild(this.play(n,s,t));const o=Ct.getRandomElement(n.getChildren());return{node:o,path:e.path.concat([o])}}simulate(e,t,n){we.display("MCTS","simulate","simulate from node which has a last move of "+e.previousMove.get().toString());let i=e,o=0;for(;o<this.maxGameLength&&Date.now()<t;){const s=this.rules.getGameStatus(i,n);if(s.isEndGame)return we.display("MCTS","simulate",`end game in ${o} steps, winner is ${s.winner}`),s;o++,i=this.playRandomStep(i,n)}return _e.ONGOING}playRandomStep(e,t){const n=Ct.getRandomElement(this.moveGenerator.getListMoves(e,t));return this.play(e,n,t)}play(e,t,n){const i=this.rules.isLegal(t,e.gameState,n);H.assert(i.isSuccess(),"heuristic returned illegal move");const o=this.rules.applyLegalMove(t,e.gameState,n,i.get());return new L2(o,g.of(e),g.of(t))}backpropagate(e,t){for(const n of e)this.addSimulationResult(n,t),we.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(e,t){const n=this.simulations(e)+1,i=this.wins(e)+t;e.setCache("wins",i),e.setCache("simulations",n)}getInfo(e){return`wins/simulations=${this.getCounterFromCache(e,"wins")}/${this.getCounterFromCache(e,"simulations")}`}}class g1 extends Qt{static of(e,t){return new g1([{key:k.ZERO,value:e},{key:k.ONE,value:t}])}add(e,t,n){const i=Ct.copy(this.get(e).get());return i[t]+=n,this.put(e,i)}concat(e){const t=this.get(k.ZERO).get(),n=this.get(k.ONE).get(),i=e.get(k.ZERO).get(),o=e.get(k.ONE).get();return g1.of(t.concat(i),n.concat(o))}}class Ya{}class B1 extends Ya{getBoardValue(e,t){const n=this.getMetrics(e,t);return un.ofMultiple(n.get(k.ZERO).get(),n.get(k.ONE).get())}}class Jx extends B1{getMetrics(e,t){return g1.of([0],[0])}}class cn{constructor(e,t,n,i){u(this,"name",void 0),u(this,"rules",void 0),u(this,"heuristic",void 0),u(this,"moveGenerator",void 0),u(this,"random",!1),u(this,"prune",!0),u(this,"availableOptions",[]),this.name=e,this.rules=t,this.heuristic=n,this.moveGenerator=i;for(let o=1;o<10;o++)this.availableOptions.push({name:`Level ${o}`,maxDepth:o})}toString(){return this.name}chooseNextMove(e,t,n){H.assert(!1===this.rules.getGameStatus(e,n).isEndGame,"Minimax has been asked to choose a move from a finished game");const i=this.getExpectedExtremum(e,n);let o=this.alphaBeta(e,t.maxDepth,i.toMinimum(),i.toMaximum(),n);for(;o.gameState.turn>e.gameState.turn+1;)o=o.parent.get();return o.previousMove.get()}alphaBeta(e,t,n,i,o){if(t<1)return e;if(this.rules.getGameStatus(e,o).isEndGame)return e;const s=this.getPossibleMoves(e,o);H.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const a=this.getBestChildren(e,s,t,n,i,o),c=this.getBestChildAmong(a),l=this.getScore(c,o);return this.setScore(e,l),c}getPossibleMoves(e,t){const n=this.getMoves(e);if(n.isAbsent()){const i=this.moveGenerator.getListMoves(e,t);return this.setMoves(e,new it(i)),new it(i)}return n.get()}getBestChildren(e,t,n,i,o,s){let a=[];const c=e.gameState.getCurrentPlayer();let l=this.getExpectedExtremum(e,s);const f=c===k.ZERO?un.isLessThan:un.isGreaterThan;for(const d of t){const m=this.getOrCreateChild(e,d,s),E=this.alphaBeta(m,n-1,i,o,s),T=this.getScore(E,s);if(f(T,l)||0===a.length?(l=T,a=[E]):T.equals(l)&&a.push(E),this.prune&&f(l,c===k.ZERO?i:o))break;c===k.ZERO?o=un.min(l,o):i=un.max(l,i)}return a}getExpectedExtremum(e,t){const n=this.getScore(e,t);return e.gameState.getCurrentPlayer()===k.ZERO?n.toMaximum():n.toMinimum()}getBestChildAmong(e){return this.random?Ct.getRandomElement(e):e[0]}getOrCreateChild(e,t,n){const i=e.getChild(t);if(i.isAbsent()){const o=this.rules.isLegal(t,e.gameState,n),s=t.toString();H.assert(o.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+o.getReasonOr("")+" this should not happen.");const a=this.rules.applyLegalMove(t,e.gameState,n,o.get()),c=new L2(a,g.of(e),g.of(t));return e.addChild(c),this.setScore(c,this.computeBoardValue(c,n)),c}return i.get()}setScore(e,t){e.setCache(this.name+"-score",t)}getScore(e,t){const n=e.getCache(this.name+"-score");if(n.isPresent())return n.get();{const i=this.computeBoardValue(e,t);return this.setScore(e,i),i}}computeBoardValue(e,t){const n=this.rules.getGameStatus(e,t);return n.isEndGame?n.toBoardValue():this.heuristic.getBoardValue(e,t)}setMoves(e,t){e.setCache(this.name+"-moves",t)}getMoves(e){return e.getCache(this.name+"-moves")}getInfo(e,t){return"BoardValue="+this.heuristic.getBoardValue(e,t).metrics}}class xDe extends B1{getMetrics(e,t){const n=e.gameState.getScores();return g1.of([n[0]],[n[1]])}}class jn{}let LDe=(()=>{class r{}return u(r,"aiTime",0),r})();class Fte extends jn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCurrentPlayer();for(let s=0;s<9;s++)for(let a=0;a<9;a++){const c=new v(a,s);if(!1!==i.getPieceAt(c).is(o))for(const l of Ae.factory.all){const f=Gi.ofSingleCoord(c,l);if(this.isAcceptablePush(f,i)){n.push(f);for(const d of Ae.factory.all)for(let m=1;m<=2&&!d.equals(l);m++){const E=c.getNext(d,m);if(!Za.isOnBoard(E))break;{const T=Gi.ofDoubleCoord(c,E,l);e2.get().isLegal(T,i).isSuccess()&&n.push(T)}}}}}return new it(n).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=e2.get().isLegal(e,t);if(i.isSuccess()){const o=t.getCurrentOpponent().value;return!(new Za(i.get(),t.turn+1).getScores()[o]>n[o])}return!1}}function RDe(r,e){if(1&r){const t=ge();I(),P(0,"circle",6),q("click",function(){ee(t);const i=p(2).index,o=p().index;return te(p().onPieceClick(i,o))}),S()}if(2&r){const t=p(2).index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),A("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function zDe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"polygon",4),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().onSpaceClick(i,o))}),S(),O(2,RDe,1,6,"circle",5),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();_(1),Ce("id","space_",n,"_",o,""),y("ngClass",s.getSquareClasses(n,o)),A("points",s.getHexaPointsAtXY(n,o)),_(1),y("ngIf",s.isPiece(i))}}function DDe(r,e){if(1&r&&(I(),P(0,"g"),O(1,zDe,3,5,"g",3),S()),2&r){const t=e.$implicit,n=p(2);_(1),y("ngIf",n.isBoard(t))}}function HDe(r,e){if(1&r&&(I(),P(0,"g"),O(1,DDe,2,1,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function VDe(r,e){1&r&&(I(),P(0,"marker",7),V(1,"polygon",8),S()),2&r&&hn("id","arrowhead_",e.$implicit.dir.toString(),"")}function FDe(r,e){if(1&r){const t=ge();I(),P(0,"g"),V(1,"line",9),P(2,"line",10),q("click",function(){const o=ee(t).$implicit;return te(p().chooseDirection(o.dir))}),S(),P(3,"polygon",11),q("click",function(){const o=ee(t).$implicit;return te(p().chooseDirection(o.dir))}),S()()}if(2&r){const t=e.$implicit;_(1),hn("id","line_start_",t.dir.toString(),""),A("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),_(1),hn("id","line_end_",t.dir.toString(),""),A("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),_(1),hn("id","direction_",t.dir.toString(),""),A("transform",t.transformation)}}class $De{constructor(e,t,n,i,o,s){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=o,this.transformation=s}}let GDe=(()=>{var r;class e extends Cu{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.setRulesAndNode("Abalone"),this.availableAIs=[new cn($localize`Score`,this.rules,new xDe,new Fte),new bn($localize`MCTS`,new Fte,this.rules)],this.encoder=Gi.encoder,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new yu(this.SPACE_SIZE,new v(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),fC.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.hexaBoard=i.getState().getCopiedBoard(),i.scores=g.of(i.getState().getScores())})()}hideLastMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){var i=this;return M(function*(){n.isSingleCoord()?i.showPushingMove(n):i.showSideStepMove(n)})()}showPushingMove(n){const i=this.getPreviousState();let o=n.coord;for(this.moveds=[o],o=o.getNext(n.dir);Za.isOnBoard(o)&&i.isPiece(o);)this.moveds.push(o),o=o.getNext(n.dir);Za.isOnBoard(o)&&this.moveds.push(o)}showSideStepMove(n){let i=n.lastPiece.get();const o=n.coord.getDirectionToward(i).get();i=i.getNext(o);let s=n.coord;for(;!1===s.equals(i);)this.moveds.push(s),this.moveds.push(s.getNext(n.dir)),s=s.getNext(o)}onPieceClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#piece_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState().getCurrentOpponent();return o.hexaBoard[i][n].is(a)?o.opponentClick(n,i):0===o.selecteds.length?o.firstClick(n,i):1===o.selecteds.length?o.secondClick(n,i):o.thirdClick(n,i)})()}opponentClick(n,i){var o=this;return M(function*(){return(yield o.tryChoosingDirection(n,i)).isSuccess()?w.SUCCESS:o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}firstClick(n,i){var o=this;return M(function*(){return o.selecteds=[new v(n,i)],o.showPossibleDirections(),w.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),o=Me.ofPlayer(i.getCurrentPlayer()),s=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of Ae.factory.all){let f,l=s.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===o){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===o)continue}if(f=n?Gi.ofSingleCoord(s,c):Gi.ofDoubleCoord(s,a,c),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(s),E=this.getCenterAt(l),T=this.getMiddleOfArrow(c,l,E),L=E.x+" "+E.y,G="rotate("+(Ae.getAngle(c)+150)+" "+L+")",ye=new $De(m,T,E,l,c,G+" translate("+L+")");this.directions.push(ye)}}}getMiddleOfArrow(n,i,o){const s=i.getPrevious(n),a=this.getCenterAt(s);return new v(a.x+(o.x-a.x)/2,a.y+(o.y-a.y)/2)}isBoard(n){return n!==Me.UNREACHABLE}isPiece(n){return n!==Me.EMPTY}secondClick(n,i){var o=this;return M(function*(){const s=o.selecteds[0],a=new v(n,i);if(a.equals(s))return o.cancelMoveAttempt(),w.SUCCESS;if(!1===a.isHexagonallyAlignedWith(s))return o.cancelMoveAttempt(),o.firstClick(n,i);const c=a.getDistance(s);if(c>2)return o.cancelMove(Hl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=s.getDirectionToward(a).get();o.selecteds=[s];for(let f=0;f<c;f++)o.selecteds.push(s.getNext(l,f+1));if(3===o.selecteds.length){const f=o.selecteds[1],d=o.getState().getCurrentPlayer();if(!1===o.hexaBoard[f.y][f.x].is(d))return o.cancelMoveAttempt(),o.firstClick(n,i)}return o.showPossibleDirections(),w.SUCCESS})()}thirdClick(n,i){var o=this;return M(function*(){const s=new v(n,i),a=o.selecteds[0];if(s.equals(a))return o.deselectExtremity(!0);const c=o.selecteds[o.selecteds.length-1];return s.equals(c)?o.deselectExtremity(!1):3===o.selecteds.length&&s.equals(o.selecteds[1])?(o.cancelMoveAttempt(),w.SUCCESS):o.tryExtension(s,a,c)})()}tryExtension(n,i,o){var s=this;return M(function*(){const a=ve.factory.fromMove(i,n);if(a.isSuccess()){const l=ve.factory.fromMove(o,n);if(a.equals(l)){const f=i.getDistance(n),d=o.getDistance(n);return 2===Math.max(f,d)?(s.selecteds.push(n),Ct.sortByDescending(s.selecteds,Gi.sortCoord),s.showPossibleDirections(),w.SUCCESS):s.cancelMove(Hl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=yield s.cancelMove(Hl.LINE_AND_COORD_NOT_ALIGNED());return yield s.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return M(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),w.SUCCESS})()}chooseDirection(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#direction_"+n.toString());return o.isFailure()?i.cancelMove(o.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return M(function*(){const o=i.selecteds[0];if(1===i.selecteds.length){const s=Gi.ofSingleCoord(o,n);return i.chooseMove(s)}{const a=Gi.ofDoubleCoord(o,i.selecteds[i.selecteds.length-1],n);return i.chooseMove(a)}})()}onSpaceClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#space_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var o=this;return M(function*(){const s=new v(n,i);for(const a of o.directions)if(a.landing.equals(s))return o._chooseDirection(a.dir);return w.failure("not a direction")})()}getSquareClasses(n,i){const o=new v(n,i),s=[];return this.moveds.some(a=>a.equals(o))&&s.push("moved-fill"),s}getPieceClasses(n,i){const o=new v(n,i),s=k.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(s)];return this.selecteds.some(c=>c.equals(o))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-abalone"]],features:[Ge],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,HDe,2,1,"g",1),P(2,"defs"),O(3,VDe,2,1,"marker",2),S(),O(4,FDe,4,12,"g",1),S()),2&n&&(_(1),y("ngForOf",i.hexaBoard),_(2),y("ngForOf",i.directions),_(1),y("ngForOf",i.directions))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class eL extends jn{getListMoves(e,t){const n=e.gameState;return x2.ALL_MOVES.filter(function i(o){return R2.get().isLegal(o,n).isSuccess()})}}class BDe extends B1{getMetrics(e,t){const n=g1.of([0,0,0,0],[0,0,0,0]);for(let i=0;i<4;i++){const o=e.gameState.board[3-i].getDominatingPlayer();o.isPlayer()&&n.add(o,i,1)}return n}}class UDe extends B1{getMetrics(e,t){const n=e.gameState.board[3].getDominatingPlayer(),i=g1.of([0],[0]);return n.isPlayer()&&i.add(n,0,1),i}}function WDe(r,e){if(1&r&&(I(),V(0,"circle",5)),2&r){const t=e.$implicit,n=p();A("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function qDe(r,e){if(1&r&&(I(),V(0,"circle",6)),2&r){const t=e.$implicit,n=p();A("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function jDe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",9),q("click",function(){ee(t);const i=p().index,o=p();return te(o.onArrowClick(i,o.PlayerOrNone.ZERO))}),S()}if(2&r){const t=p().index,n=p();hn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),A("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function ZDe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",9),q("click",function(){ee(t);const i=p().index,o=p();return te(o.onArrowClick(i,o.PlayerOrNone.ONE))}),S()}if(2&r){const t=p().index,n=p();hn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),A("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function YDe(r,e){if(1&r){const t=ge();I(),qt(0),P(1,"circle",10),q("click",function(){ee(t);const i=p().index;return te(p().onSquareClick(i))}),S(),jt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,o=n.$implicit,s=p();_(1),Hr("id","square_",i,"_piece_",t,"_out_of_",o.count(s.PlayerOrNone.NONE),""),y("ngClass",s.getPieceClasses(i,t,o)),A("cx",s.getCircleCenter(i,t,o).x)("cy",s.getCircleCenter(i,t,o).y)}}function KDe(r,e){if(1&r){const t=ge();I(),P(0,"g"),O(1,jDe,1,4,"polygon",7),O(2,ZDe,1,4,"polygon",7),P(3,"rect",8),q("click",function(){const o=ee(t).index;return te(p().onSquareClick(o))}),S(),O(4,YDe,2,6,"ng-container",4),S()}if(2&r){const t=e.$implicit,n=e.index,i=p();A("transform",i.getBlockTransform(n)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),_(1),hn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let XDe=(()=>{var r;class e extends n3{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",W),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",R2.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.setRulesAndNode("Apagos"),this.availableAIs=[new cn($localize`Rightmost Focus`,this.rules,new UDe,new eL),new cn($localize`Full Board`,this.rules,new BDe,new eL),new bn($localize`MCTS`,new eL,this.rules)],this.encoder=x2.encoder,this.hasAsymmetricBoard=!0,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.board,i.remainingZero=o.remaining.get(k.ZERO).get(),i.remainingOne=o.remaining.get(k.ONE).get(),i.hideLastMove(),i.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){var i=this;return M(function*(){n.isDrop()?i.showLastDrop(n):i.showLastTransfer(n)})()}showLastDrop(n){const i=n.piece.get();let o=n.landing.x;this.movedSquare=[o],3!==n.landing.x&&(o+=1,this.movedSquare.push(o));const a=this.getLowestPlayerPiece(this.board[o],i);this.droppedPiece=g.of({square:o,piece:a})}getLowestPlayerPiece(n,i){const o=n.count(i);return i===k.ZERO?o-1:n.count(W.NONE)-o}showLastTransfer(n){const i=this.getPreviousState(),o=i.getCurrentPlayer(),s=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[s],o);this.leftPiece=g.of({square:s,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],o);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(k.ZERO).get()>0&&this.displayableArrow.push({x:i,player:k.ZERO}),n.remaining.get(k.ONE).get()>0&&this.displayableArrow.push({x:i,player:k.ONE}))}getCircleCenter(n,i,o){const s=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===o.count(W.NONE))return new v(s,a);const c=o.count(W.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new v(s+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(o=>o.x===n&&o.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var o=this;return M(function*(){const s=i===k.ZERO?"zero":"one",a=yield o.canUserPlay("#dropArrow_"+s+"_"+n);if(a.isFailure())return o.cancelMove(a.getReason());const c=rn.of(n);if(o.selectedPiece.isPresent()){const l=o.selectedPiece.get().square,f=x2.transfer(rn.of(l),c).get();return o.chooseMove(f)}{const l=x2.drop(c,i);return o.chooseMove(l)}})()}getPieceClasses(n,i,o){const s={square:n,piece:i},a=[];let c=o.count(k.ZERO),l=o.count(k.ONE);if(this.selectedPiece.equalsValue(s))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(s))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===k.ZERO?c++:l++}const f=o.count(W.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,o){return n<i?"player0-fill":n<i+o?"":"player1-fill"}onSquareClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#square_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),w.SUCCESS;const s=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(s)<=0?i.cancelMove(mu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,s)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(mu.NO_POSSIBLE_TRANSFER_REMAINS()):w.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-apagos"]],features:[Ge],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"g"),O(2,WDe,1,3,"circle",1),O(3,qDe,1,3,"circle",2),S(),P(4,"g",3),O(5,KDe,5,8,"g",4),S()()),2&n&&(A("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),_(1),A("transform","rotate("+180*i.getPointOfView().value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),_(2),y("ngForOf",i.board))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class yi extends k1{constructor(e,t,n){super(e,t),u(this,"scores",void 0),this.scores=n}getScoresCopy(){return[this.scores[0],this.scores[1]]}equals(e){return!1!==wt.compare(this.board,e.board)&&!1!==Ct.equals(this.scores,e.scores)&&this.turn===e.turn}getCurrentPlayerY(){return this.getCurrentOpponent().value}getOpponentY(){return this.getCurrentPlayer().value}}let D9=(()=>{class r{}return u(r,"MUST_DISTRIBUTE_YOUR_OWN_HOUSES",()=>$localize`You must distribute one of your houses.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should feed but you do not.`),r})();class Jn extends ja{static isStarving(e,t){let n=0;const i=e.getOpponent().value;for(;n<t[0].length;)if(t[i][n++]>0)return!1;return!0}static getInitialState(e){const t=e.get(),n=wt.create(t.width,2,t.seedsByHouse);return new yi(n,0,[0,0])}constructor(){super()}isLegal(e,t,n){const i=n.get(),o=t.getCurrentPlayerY();let s=!0;for(const a of e){H.assert(s,"Cannot play after non kalah move");const c=this.isLegalDistribution(a,t,i);if(c.isFailure())return w.ofFallible(c);t=this.distributeHouse(a.x,o,t,i).resultingState,s=c.get()}if(i.mustContinueDistributionAfterStore&&H.assert(!1===s,"Must continue playing after kalah move"),i.mustFeed){const a=t.getCurrentOpponent(),c=Jn.isStarving(a,t.board),l=this.canDistribute(t.getCurrentPlayer(),t,i);if(c&&l)return w.failure(D9.SHOULD_DISTRIBUTE())}return w.SUCCESS}getInitialState(e){return Jn.getInitialState(e)}isLegalDistribution(e,t,n){const i=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,i))return Q.failure(D9.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=this.distributeHouse(e.x,i,t,n),s=Jn.isStarving(o.resultingState.getCurrentPlayer(),o.resultingState.board);return Q.success(o.endsUpInStore&&!1===s)}distributeMove(e,t,n){const i=t.getCurrentPlayer().value,o=t.getCurrentPlayerY(),s=[];let a=0,c=!1,l=t;for(const m of e){const E=this.distributeHouse(m.x,o,l,n);l.getScoresCopy()[i]+=E.passedByStoreNTimes,l=E.resultingState,s.push(...E.filledCoords),a+=E.passedByStoreNTimes,c=E.endsUpInStore}const f=l.getScoresCopy();return{endsUpInStore:c,filledCoords:s,passedByStoreNTimes:a,resultingState:new yi(l.getCopiedBoard(),l.turn,f)}}mustMansoon(e,t){const n=e.getCopiedBoard(),i=e.getCurrentOpponent(),o=e.getCurrentPlayer();if(t.mustFeed){if(Jn.isStarving(o,n)&&!1===this.canDistribute(i,e,t))return i}else{if(Jn.isStarving(i,n))return o;if(Jn.isStarving(o,n))return i}return W.NONE}getGameStatus(e,t){const n=e.gameState,s=e.gameState.getWidth()*t.get().seedsByHouse;return n.scores[0]>s?_e.ZERO_WON:n.scores[1]>s?_e.ONE_WON:n.scores[0]===s&&n.scores[1]===s?_e.DRAW:_e.ONGOING}applyLegalMove(e,t,n,i){const o=this.distributeMove(e,t,n.get()),s=this.applyCapture(o);let a=s.resultingState;const c=this.mustMansoon(a,n.get());return c!==W.NONE&&(a=this.monsoon(c,s).resultingState),new yi(a.board,a.turn+1,a.scores)}distributeHouse(e,t,n,i){let o=new v(e,t);const s=n.getCopiedBoard(),a=n.getCurrentPlayer(),c=new v(e,t);let l=s[t][e];const f=[];s[t][e]=0;let d=0,m=!1,E=!1;for(;l>0;){m=E,E=!1;const L=this.getNextCoord(o,a,m,n,i);E=L.isAbsent(),E?(d++,l--,f.push(Jn.FAKE_STORE_COORD.get(a).get())):(o=L.get(),(!1===c.equals(o)||i.feedOriginalHouse)&&(s[o.y][o.x]+=1,f.push(o),l--))}const T=n.getScoresCopy();return T[a.value]+=d,{filledCoords:f,passedByStoreNTimes:d,endsUpInStore:E,resultingState:new yi(s,n.turn,T)}}getNextCoord(e,t,n,i,o){return 0===e.y?e.x===i.getWidth()-1?o.passByPlayerStore&&t===k.ONE&&!1===n?g.empty():g.of(new v(e.x,1)):g.of(new v(e.x+1,0)):0===e.x?o.passByPlayerStore&&t===k.ZERO&&!1===n?g.empty():g.of(new v(0,0)):g.of(new v(e.x-1,1))}doesDistribute(e,t,n,i){const o=n.board;let s;return s=0===t?n.getWidth()-(e+1):e+1,s+(i.passByPlayerStore?1:0)<=o[t][e]}canDistribute(e,t,n){for(let i=0;i<t.getWidth();i++)if(this.doesDistribute(i,e.getOpponent().value,t,n))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=n.getCopiedBoard(),o=n.getScoresCopy();let s=0;const a=wt.copy(t.captureMap);let c=0;const l=e.getOpponent().value;for(;c<n.getWidth();)s+=i[l][c],a[l][c]+=i[l][c],i[l][c]=0,c++;return o[e.value]+=s,{capturedSum:s,captureMap:a,resultingState:new yi(i,n.turn,o)}}}u(Jn,"FEED_ORIGINAL_HOUSE",()=>$localize`Feed original house`),u(Jn,"MUST_FEED",()=>$localize`Must feed`),u(Jn,"PASS_BY_PLAYER_STORE",()=>$localize`Pass by player store`),u(Jn,"MULTIPLE_SOW",()=>$localize`Must continue distribution after last seed ends in store`),u(Jn,"SEEDS_BY_HOUSE",()=>$localize`Seeds by house`),u(Jn,"FAKE_STORE_COORD",new _u([{key:k.ZERO,value:new v(-1,-1)},{key:k.ONE,value:new v(2,2)}]));class Tr{static range(e,t){return n=>null==n?w.failure($localize`This value is mandatory`):n<e?w.failure($localize`${n} is too small, the minimum is ${e}`):t<n?w.failure($localize`${n} is too big, the maximum is ${t}`):w.SUCCESS}}let Gte,Ss=(()=>{class r{}return u(r,"WIDTH",()=>$localize`Width`),u(r,"HEIGHT",()=>$localize`Height`),r})();class $te{constructor(e,t,n){u(this,"value",void 0),u(this,"title",void 0),u(this,"validator",void 0),this.value=e,this.title=t,this.validator=n}}class br extends $te{constructor(e,t,n){super(e,t,n)}}class er extends $te{constructor(e,t){super(e,t)}}class z2{constructor(e,t=[]){u(this,"defaultConfigDescription",void 0),u(this,"nonDefaultStandardConfigs",void 0),u(this,"defaultConfig",void 0),this.defaultConfigDescription=e,this.nonDefaultStandardConfigs=t;const n={};for(const o of this.getFields())n[o]=e.config[o].value;this.defaultConfig={name:e.name,config:n};const i=new it(Object.keys(e.config));for(const o of t){const s=new it(Object.keys(o.config));H.assert(s.equals(i),`Field missing in ${o.name()} config!`)}}getStandardConfigs(){return[this.defaultConfig].concat(this.nonDefaultStandardConfigs)}getDefaultConfig(){return this.defaultConfig}getFields(){return Object.keys(this.defaultConfigDescription.config)}getNonDefaultStandardConfigs(){return this.nonDefaultStandardConfigs}getI18nName(e){return this.defaultConfigDescription.config[e].title()}getConfig(e){return this.getStandardConfigs().filter(n=>n.name()===e)[0].config}getValidator(e){return H.assert(e in this.defaultConfigDescription.config,e+" is not a validator!"),this.defaultConfigDescription.config[e].validator}}class tL{}u(tL,"GOBAN",new z2({name:()=>$localize`Default`,config:{width:new br(19,Ss.WIDTH,Tr.range(1,99)),height:new br(19,Ss.HEIGHT,Tr.range(1,99))}}));class t2 extends Jn{static get(){return t2.singleton.isAbsent()&&(t2.singleton=g.of(new t2)),t2.singleton.get()}getRulesConfigDescription(){return g.of(t2.RULES_CONFIG_DESCRIPTION)}applyCapture(e){const t=e.filledCoords,n=t[t.length-1];return this.captureIfLegal(n.x,n.y,e.resultingState)}capture(e,t,n){const i=n.getCurrentPlayerY();H.assert(t!==i,"AwaleRules.capture cannot capture the players house");const o=n.getCopiedBoard();let s=o[t][e],a=0;const c=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(s<2||s>3)return{capturedSum:0,captureMap:c,resultingState:n};let l=-1,f=-1;n.getCurrentPlayer()===k.ONE&&(l=1,f=n.getWidth());do{c[t][e]=s,a+=s,o[t][e]=0,s=o[t][e+=l]}while(e!==f&&(2===s||3===s));const d=n.getScoresCopy();return d[n.getCurrentPlayer().value]+=a,{capturedSum:a,captureMap:c,resultingState:new yi(o,n.turn,d)}}captureIfLegal(e,t,n){const i=n.getCurrentPlayer(),o={capturedSum:0,resultingState:n,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]};if(t===i.value){const s=this.capture(e,t,n),a=Jn.isStarving(i.getOpponent(),s.resultingState.board);return s.capturedSum>0&&a?o:s}return o}}var Bte,Ute;u(t2,"singleton",g.empty()),u(t2,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Awalé`,config:{feedOriginalHouse:new er(!1,Jn.FEED_ORIGINAL_HOUSE),mustFeed:new er(!0,Jn.MUST_FEED),passByPlayerStore:new er(!1,Jn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new er(!1,Jn.MULTIPLE_SOW),seedsByHouse:new br(4,Jn.SEEDS_BY_HOUSE,Tr.range(1,99)),width:new br(6,Ss.WIDTH,Tr.range(1,99))}}));class x1{static of(e){return H.assert(0<=e,"MancalaDistribution should be a positive integer!"),new x1(e)}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}}Bte=x1,u(x1,"encoder",Ne.tuple([Ne.identity()],r=>[r.x],r=>Bte.of(r[0]))),Gte=Symbol.iterator;class wr extends yo{static of(e,t=[]){const n=[e];return n.push(...t),new wr(n)}constructor(e){super(),u(this,"distributions",void 0),this.distributions=e,H.assert(e.length>0,"Move should have distribution ")}add(e){return wr.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"MancalaMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return Ct.equals(this.distributions,e.distributions)}getFirstDistribution(){return this.distributions[0]}[Gte](){return this.distributions.values()}}Ute=wr,u(wr,"encoder",Ne.tuple([Ne.list(x1.encoder)],r=>[r.distributions],r=>Ute.of(r[0][0],r[0].slice(1))));class Wte extends jn{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getListMoves(e,t){const n=[],i=e.gameState,o=i.getCurrentPlayerY();for(let s=0;s<i.getWidth();s++)if(i.getPieceAtXY(s,o)>0){const a=wr.of(x1.of(s));t.get().mustContinueDistributionAfterStore?n.push(...this.getPossibleMoveContinuations(i,s,o,a,t.get())):this.rules.isLegal(a,i,t).isSuccess()&&n.push(a)}return n}getPossibleMoveContinuations(e,t,n,i,o){const s=[],a=this.rules.distributeHouse(t,n,e,o),c=a.resultingState,f=!1===Jn.isStarving(c.getCurrentPlayer(),c.board);if(a.endsUpInStore&&f){for(let d=0;d<c.getWidth();d++)if(c.getPieceAtXY(d,n)>0){const m=i.add(x1.of(d));s.push(...this.getPossibleMoveContinuations(c,d,n,m,o))}return s}return[i]}}class QDe extends Wte{constructor(){super(t2.get())}}class sa{static fromLimits(e,t,n,i){return new sa(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),o=sa.getLimits(i);return new sa(o.minX-n/2,o.minY-n/2,n+o.maxX-o.minX,n+o.maxY-o.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;for(const s of e)i=Math.min(i,s.x),o=Math.min(o,s.y),t=Math.max(t,s.x),n=Math.max(n,s.y);return{minX:i,minY:o,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new v(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new sa(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),o=Math.max(this.bottom(),e.bottom());return sa.fromLimits(t,n,i,o)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class JDe{static getArrowTransform(e,t,n){let i,o,s;switch(n){case Re.UP:i=1,o=0,s=-90;break;case Re.DOWN:i=1,o=2,s=90;break;case Re.LEFT:i=0,o=1,s=180;break;default:H.expectToBe(n,Re.RIGHT),i=2,o=1,s=0}return[`scale( ${e/300} ${t/300} )`,`translate(${100*i} ${100*o})`,"rotate("+s+" 50 50)"].join(" ")}}let Mo=(()=>{var r;class e extends n3{constructor(...n){super(...n),u(this,"board",void 0)}getWidth(){return this.getState().getWidth()}getHeight(){return this.getState().getHeight()}getViewBox(){const n=this.getWidth()*this.SPACE_SIZE,i=this.getHeight()*this.SPACE_SIZE,o=.5*this.STROKE_WIDTH;return sa.fromLimits(0,n,0,i).expand(o,o,o,o)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();function qte(r){return 1e3*r.seconds+r.nanoseconds/1e6}function jte(r,e){return qte(e)-qte(r)}class nL{static sleep(e){return M(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}class eHe extends B1{getMetrics(e,t){const n=e.gameState.getScoresCopy();return g1.of([n[0]],[n[1]])}}class tHe extends cn{constructor(e,t){super($localize`Score`,e,new eHe,t)}}let Zte=(()=>{class r extends Mo{constructor(t,n){super(t),u(this,"cdr",void 0),u(this,"MGPOptional",g),u(this,"lastDistributedHouses",[]),u(this,"currentMove",g.empty()),u(this,"clickOngoing",!1),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"droppedInStore",[0,0]),u(this,"filledCoords",[]),u(this,"constructedState",void 0),u(this,"opponentMoveIsBeingAnimated",!1),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0])}getMancalaViewBox(){return-this.STROKE_WIDTH/2+" "+-this.STROKE_WIDTH/2+" "+(this.getViewBoxWidth()+this.STROKE_WIDTH)+" "+(2*this.SPACE_SIZE+50)}getViewBoxWidth(){return 60+(2+this.getState().getWidth())*this.SPACE_SIZE}showLastMove(t){var n=this;return M(function*(){n.droppedInStore=[0,0];const i=n.getPreviousState(),o=n.getConfig().get(),s=n.rules.distributeMove(t,i,o);n.filledCoords=s.filledCoords;let a=n.rules.applyCapture(s);n.captured=a.captureMap;const c=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(f=>new v(f.x,c));const l=n.rules.mustMansoon(a.resultingState,o);l!==W.NONE&&(a=n.rules.monsoon(l,a),n.captured=a.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return M(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,H.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let o=0;const s=n.node.previousMove.get();for(const a of s)yield n.showSimpleDistribution(a),o+1<s.distributions.length&&(yield nL.sleep(r.TIMEOUT_BETWEEN_LAPS)),o++;n.opponentMoveIsBeingAnimated=!1}n.scores=g.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(!0===i.clickOngoing)return w.SUCCESS;if(!0===i.opponentMoveIsBeingAnimated)return w.SUCCESS;{i.clickOngoing=!0;const s=yield i.onLegalClick(t,n);return i.clickOngoing=!1,s}})()}onLegalClick(t,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().value?i.cancelMove(D9.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(D9.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(x1.of(t)),o=n.getConfig().get();if(i.endsUpInStore&&o.mustContinueDistributionAfterStore){const s=n.constructedState.getCurrentPlayer();return Jn.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):w.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return M(function*(){const i=n.constructedState,o=i.getCurrentPlayerY(),s=new v(t.x,o);n.lastDistributedHouses.push(s);const a=n.getConfig().get();return yield n.showSeedBySeed(s,i,a),n.rules.distributeHouse(t.x,o,i,a)})()}showSeedBySeed(t,n,i){var o=this;return M(function*(){const s=n.getCopiedBoard(),a=n.getCurrentPlayer(),c=t;let l=s[t.y][t.x],f=!1;const d=n.getScoresCopy();for(s[t.y][t.x]=0,o.changeVisibleState(new yi(s,n.turn,d)),yield nL.sleep(r.TIMEOUT_BETWEEN_SEED);l>0;){const m=o.rules.getNextCoord(t,a,f,n,i);f=m.isAbsent(),f?(l--,o.filledCoords.push(Jn.FAKE_STORE_COORD.get(a).get()),o.droppedInStore[a.value]+=1,d[a.value]+=1):(t=m.get(),(!1===c.equals(t)||i.feedOriginalHouse)&&(s[t.y][t.x]+=1,o.filledCoords.push(t),l--)),o.changeVisibleState(new yi(s,n.turn,d)),yield nL.sleep(r.TIMEOUT_BETWEEN_SEED)}})()}hideLastMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=g.empty(),this.droppedInStore=[0,0],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new v(t,n),o=this.getSpaceOwner(i),s=this.getPlayerClass(o);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",s]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",s]:[s]}getStoreOwner(t){return Jn.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():k.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.getPointOfView().value+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),s=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?g.of("-"+this.captured[n][t]):s>0?g.of("+"+s):s<0?g.of(""+s):g.empty()}getStoreContent(t){return this.scores.get()[t.value]+this.droppedInStore[t.value]}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores[t.value],o=this.constructedState.scores[t.value]-n;return o>0?g.of("+"+o):g.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(H.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(t){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+t.value);return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(D9.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(t){return[new tHe(this.rules,t),new bn($localize`MCTS`,t,this.rules)]}updateOrCreateCurrentMove(t){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=g.of(this.generateMove(t));else{const n=this.addToMove(t);this.currentMove=g.of(n)}}generateMove(t){return wr.of(x1.of(t))}addToMove(t){return this.currentMove.get().add(x1.of(t))}}return u(r,"TIMEOUT_BETWEEN_SEED",200),u(r,"TIMEOUT_BETWEEN_LAPS",1e3),r})();const nHe=["app-numbered-circle",""];function rHe(r,e){if(1&r&&(I(),P(0,"text",3),rt(1),S()),2&r){const t=p();Ce("id","secondary_message_",t.x,"_",t.y,""),A("x",15)("y",31)("transform",t.rotation),_(1),ni(" ",t.secondaryContent.get()," ")}}let Yte=(()=>{var r;class e{constructor(){u(this,"x",void 0),u(this,"y",void 0),u(this,"spaceClasses",void 0),u(this,"content",void 0),u(this,"secondaryContent",void 0),u(this,"rotation",void 0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:nHe,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(I(),V(0,"circle",0),P(1,"text",1),rt(2),S(),O(3,rHe,2,6,"text",2)),2&n&&(Ce("id","circle_",i.x,"_",i.y,""),y("ngClass",i.spaceClasses),_(1),Ce("id","number_",i.x,"_",i.y,""),A("x",0)("y",16)("transform",i.rotation),_(1),ni(" ",i.content," "),_(1),y("ngIf",i.secondaryContent.isPresent()))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function iHe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",8),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),A("transform",o.getPieceTransform(n,i))}}function oHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,iHe,2,9,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let sHe=(()=>{var r;class e extends Zte{constructor(n,i){super(n,i),this.setRulesAndNode("Awale"),this.availableAIs=this.createAIs(new QDe),this.encoder=wr.encoder}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut),U(xc))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-awale-component"]],features:[Ge],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),V(1,"rect",1),O(2,oHe,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),P(6,"g",6),q("click",function(){return i.onStoreClick(i.Player.ZERO)}),S(),P(7,"g",7),q("click",function(){return i.onStoreClick(i.Player.ONE)}),S()()),2&n&&(A("viewBox",i.getMancalaViewBox())("transform",i.rotation),_(1),A("width",i.getViewBoxWidth())("height",240),_(1),y("ngForOf",i.board),_(1),A("x2",i.getViewBoxWidth()-120),_(2),A("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),_(1),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),A("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Dt,Yte],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Kte{static sowing(e,t){return j.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,e,[t],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)}}const rL=t2.get().getDefaultRulesConfig();class aHe extends qn{constructor(...e){super(...e),u(this,"gameName",$localize`Awalé`),u(this,"tutorial",[j.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,t2.get().getInitialState(rL)),j.informational($localize`Awalé`,$localize`Bonus fact: Awalé is the most common of all Mancalas.`,t2.get().getInitialState(rL)),Kte.sowing(t2.get().getInitialState(rL),wr.of(x1.of(5))),j.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new yi([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),wr.of(x1.of(1)),$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),j.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there are now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new yi([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[wr.of(x1.of(0))],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),j.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new yi([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[wr.of(x1.of(0))],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),j.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new yi([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[wr.of(x1.of(0))],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),j.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new yi([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[wr.of(x1.of(1))],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),j.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new yi([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[wr.of(x1.of(0))],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),j.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new yi([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),wr.of(x1.of(3)),$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),j.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new yi([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[23,10]),wr.of(x1.of(0)),$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}const on=Me.EMPTY,ai=Me.UNREACHABLE,aa=Me.ZERO,Mu=Me.ONE;class cHe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,e2.get().getInitialState()),j.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,e2.get().getInitialState(),Gi.ofSingleCoord(new v(2,6),Ae.UP),$localize`Congratulations!`),j.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Za([[ai,ai,ai,ai,on,aa,aa,Mu,Mu],[ai,ai,ai,on,on,on,on,on,on],[ai,ai,on,aa,aa,aa,Mu,aa,on],[ai,on,on,on,on,on,on,on,on],[on,on,on,on,aa,aa,aa,Mu,Mu],[on,on,on,on,on,on,on,on,ai],[on,on,on,on,aa,Mu,on,ai,ai],[on,on,on,aa,on,on,ai,ai,ai],[on,on,aa,on,on,ai,ai,ai,ai]],0),[Gi.ofSingleCoord(new v(4,4),Ae.RIGHT)],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}class Ko extends yo{static getFallibleEncoder(e){return Ne.tuple([v.encoder,v.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return Ne.tuple([v.encoder,v.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}getCoords(){return[this.first,this.second]}}class n2 extends Ko{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Ee.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return ve.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}getMovedOverCoords(){return this.getStart().getAllCoordsToward(this.getEnd())}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}toString(){return`${this.getStart().toString()} -> ${this.getEnd().toString()}`}}let dC=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class Eu extends n2{static isValidDirection(e,t){const n=e.getDirectionToward(t);return n.isFailure()||n.get().isDiagonal()?w.failure(dC.MOVE_MUST_BE_ORTHOGONAL()):w.SUCCESS}constructor(e,t){super(e,t);const n=this.getMaximalDistance();H.assert(e.isInRange(n,n),"Starting coord of TaflMove must be on the board, not at "+e.toString()+"."),H.assert(t.isInRange(n,n),"Landing coord of TaflMove must be on the board, not at "+t.toString()+".")}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}var hC,Pu;class r2 extends Eu{static from(e,t){const n=Eu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new r2(e,t))}getMaximalDistance(){return 7}}u(r2,"encoder",Ko.getFallibleEncoder(r2.from));class E1{constructor(e){u(this,"value",void 0),this.value=e}}u(E1,"NONE",new(hC=E1)("NONE")),u(E1,"OPPONENT",new hC("OPPONENT")),u(E1,"PLAYER",new hC("PLAYER"));class At{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(At,"UNOCCUPIED",new(Pu=At)(W.NONE,!1)),u(At,"PLAYER_ONE_KING",new Pu(W.ONE,!0)),u(At,"PLAYER_ONE_PAWN",new Pu(W.ONE,!1)),u(At,"PLAYER_ZERO_KING",new Pu(W.ZERO,!0)),u(At,"PLAYER_ZERO_PAWN",new Pu(W.ZERO,!1));let Jte,I0=class extends jn{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getListMoves(e,t){const n=e.gameState,i=n.getCurrentPlayer(),o=this.rules.getPlayerListMoves(i,n,t.get());return this.orderMoves(n,o,t.get())}orderMoves(e,t,n){const i=this.rules.getKingCoord(e).get(),o=this.rules.getInvader(n);return e.getCurrentPlayer()===o?Ct.sortByDescending(t,s=>-s.getEnd().getOrthogonalDistance(i)):Ct.sortByDescending(t,s=>s.getStart().equals(i)?this.rules.isExternalThrone(e,s.getEnd())?2:1:0),t}};I0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],I0);class gC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class Qte extends gC{constructor(e,t){super(new it([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}Jte=Symbol.iterator;class uHe extends it{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0])void 0===n[o]&&(n[o]=[]),n=n[o];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0]){if(void 0===n[o])return!1;n=n[o]}return void 0!==n[t[1]]}[Jte](){return this.values.values()}}class U1 extends uHe{toFields(e){return[[e.y],e.x]}}class ene extends B1{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getMetrics(e,t){const n=e.gameState,i=t.get(),o=this.rules.getPlayerListPawns(k.ZERO,n).length,s=this.rules.getPlayerListPawns(k.ONE,n).length,a=this.rules.getInvader(i);return g1.of([o*[1,2][a.value]],[s*[2,1][a.value]])}}class tne extends ene{getBoardValue(e,t){const n=this.rules.getGameStatus(e,t);if(n.isEndGame)return n.toBoardValue();const i=e.gameState,o=At.UNOCCUPIED,s=this.getPiecesMap(i),a=this.getThreatMap(e,s),c=this.filterThreatMap(a,i);let l=0,f=0,d=0;for(const m of k.PLAYERS)for(const E of s.get(m).get())if(c.get(E).isPresent())l+=m.getScoreModifier();else{f+=m.getScoreModifier();let T=0;for(const L of Re.ORTHOGONALS){let z=E.getNext(L,1);for(;i.isOnBoard(z)&&i.getPieceAt(z)===o;)T++,z=z.getNext(L,1)}d+=T*m.getScoreModifier()}return un.multiMetric([f,l,d])}getPiecesMap(e){const t=At.UNOCCUPIED,n=[],i=[];for(let s=0;s<e.getHeight();s++)for(let a=0;a<e.getWidth();a++){const c=new v(a,s);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===k.ZERO?n.push(c):i.push(c))}return new Qt([{key:k.ZERO,value:new U1(n)},{key:k.ONE,value:new U1(i)}])}getThreatMap(e,t){const n=new Qt;for(const i of k.PLAYERS)for(const o of t.get(i).get()){const s=this.getThreats(o,e.gameState);this.isThreatReal(o,e.gameState,s)&&n.set(o,new it(s))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);H.assert(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),o=[];for(const s of Re.ORTHOGONALS){const a=e.getPrevious(s,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of Re.ORTHOGONALS){if(l===s.getOpposite())continue;let f=e.getNext(s,1);for(;t.isOnBoard(f)&&t.getPieceAt(f)===At.UNOCCUPIED;)f=f.getNext(l);t.isOnBoard(f)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(s,1).equals(f)&&c.push(f)}o.push(new Qte(a,new U1(c)))}}return o}isAThreat(e,t,n){return!1!==t.isOnBoard(e)&&(t.getAbsoluteOwner(e)===n||!!this.rules.isThrone(t,e)&&(n===k.ONE||t.getPieceAt(e)===At.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new Qt,i=e.listKeys(),o=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),s=new U1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of o){const c=e.get(a).get(),l=[];for(const f of c)if(!1===s.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===s.contains(m)&&d.push(m);d.length>0&&l.push(new Qte(f.directThreat,new U1(d)))}l.length>0&&n.set(a,new it(l))}for(const a of s){const c=e.get(a).get();n.set(a,c)}return n}}class fHe extends cn{constructor(e){super($localize`Pieces > Influence`,e,new tne(e),new I0(e))}}class dHe extends cn{constructor(e){super($localize`Pieces`,e,new ene(e),new I0(e))}}class nne extends tne{getBoardValue(e,t){const n=this.getControlScoreAndPieceScores(e,t);return un.multiMetric([n.safeScore,n.threatenedScore,n.controlScore])}getControlScoreAndPieceScores(e,t){const n=e.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(e,i),s=this.filterThreatMap(o,n),a={safeScore:0,threatenedScore:0,controlScore:0};for(const c of k.PLAYERS){const l=new U1;for(const f of i.get(c).get())if(s.get(f).isPresent())a.threatenedScore+=c.getScoreModifier();else{a.safeScore+=c.getScoreModifier();for(const d of Re.ORTHOGONALS){let m=f.getNext(d,1);for(;n.isOnBoard(m)&&n.getPieceAt(m)===At.UNOCCUPIED;)l.add(m),m=m.getNext(d,1)}}for(const f of l){const d=this.getControlledPieceValue(f,n);a.controlScore+=c.getScoreModifier()*d}}return a}getControlledPieceValue(e,t){let n=1;return t.isHorizontalEdge(e)&&(n*=t.getWidth()),t.isVerticalEdge(e)&&(n*=t.getWidth()),n}}class hHe extends cn{constructor(e){super($localize`Pieces > Control`,e,new nne(e),new I0(e))}}class gHe extends nne{getBoardValue(e,t){const n=this.getControlScoreAndPieceScores(e,t),i=this.getStepForEscapeMetric(e.gameState);return un.multiMetric([i,n.safeScore,n.threatenedScore,n.controlScore])}getStepForEscapeMetric(e){const t=e.getPieceAt(this.rules.getKingCoord(e).get()).getOwner(),n=this.getStepForEscape(e)*t.getScoreModifier();return-1===n?t.getOpponent().getPreVictory():-1*n}getStepForEscape(e){const t=this.rules.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const o=this.getNextGen(e,n,i);return 0===o.length?g.empty():o.some(s=>this.rules.isExternalThrone(e,s))?g.of(t):(t++,i.push(...o),this._getStepForEscape(e,t,o,i))}getNextGen(e,t,n){const i=[];for(const o of t)for(const s of Re.ORTHOGONALS){let a=o.getNext(s,1);for(;e.isOnBoard(a)&&e.getPieceAt(a)===At.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(s,1)}return i}}class pHe extends cn{constructor(e){super($localize`Escape > Pieces > Control`,e,new gHe(e),new I0(e))}}class iL extends Mo{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",At.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"passedByCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}updateBoard(e){var t=this;return M(function*(){t.board=t.getState().getCopiedBoard(),t.capturedCoords=[],t.updateViewInfo()})()}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const o of Re.ORTHOGONALS){const s=e.getEnd().getNext(o,1);if(n.isOnBoard(s)){const c=n.getRelativeOwner(i,s)===E1.OPPONENT,f=t.getState().getPieceAt(s)===At.UNOCCUPIED;c&&f&&t.capturedCoords.push(s)}}t.passedByCoords=t.node.previousMove.get().getMovedOverCoords()})()}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.getHeight();t++){const n=[];for(let i=0;i<this.getWidth();i++){let o=[];o=this.board[t][i].getOwner()===W.NONE?[""]:this.getPieceClasses(i,t),n.push(o)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new v(e,t);return n.chosen.equalsValue(o)?(n.cancelMoveAttempt(),w.SUCCESS):n.chosen.isAbsent()||n.pieceBelongsToCurrentPlayer(o)?n.choosePiece(o):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return M(function*(){const i=n.chosen.get(),o=new v(e,t),s=n.generateMove(i,o);return s.isSuccess()?yield n.chooseMove(s.get()):n.cancelMove(s.getReason())})()}choosePiece(e){var t=this;return M(function*(){return t.board[e.y][e.x]===At.UNOCCUPIED?t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):!1===t.pieceBelongsToCurrentPlayer(e)?t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(t.chosen=g.of(e),t.updateViewInfo(),w.SUCCESS)})()}pieceBelongsToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===E1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new v(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new v(e,t))}getPieceClasses(e,t){const n=[],i=new v(e,t),o=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(o)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new v(e,t);return this.capturedCoords.some(o=>o.equals(i))?n.push("captured-fill"):this.node.previousMove.isPresent()&&this.passedByCoords.some(o=>o.equals(i))&&n.push("moved-fill"),n}getClickables(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.board[t].length;n++){const i=new v(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.interactive&&this.pieceBelongsToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===At.PLAYER_ZERO_PAWN}isKing(e,t){return this.board[t][e].isKing()}createAIs(){const e=new I0(this.rules);return[new dHe(this.rules),new fHe(this.rules),new hHe(this.rules),new pHe(this.rules),new bn($localize`MCTS`,e,this.rules)]}}function mHe(r,e){1&r&&(I(),V(0,"polygon",8))}function _He(r,e){1&r&&(I(),V(0,"rect",9))}function vHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,mHe,1,0,"polygon",6),O(2,_He,1,0,"ng-template",null,7,mn),S()),2&r){const t=dn(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function CHe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function yHe(r,e){if(1&r&&(I(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function MHe(r,e){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function EHe(r,e){if(1&r&&(I(),O(0,yHe,1,1,"polyline",14),O(1,MHe,4,20,"ng-template",null,15,mn)),2&r){const t=dn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function PHe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",10),O(2,CHe,6,25,"g",11),O(3,EHe,3,2,"ng-template",null,12,mn),S()),2&r){const t=dn(4),n=p().index,i=p().index,o=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function SHe(r,e){if(1&r){const t=ge();I(),P(0,"g",3),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",4),O(2,vHe,4,2,"g",5),O(3,PHe,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),A("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function OHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,SHe,4,10,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function THe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",17),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let bHe=(()=>{var r;class e extends iL{constructor(n){super(n,r2.from),this.setRulesAndNode("Brandhub"),this.availableAIs=this.createAIs(),this.encoder=r2.encoder}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-brandhub"]],features:[Ge],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,OHe,2,1,"g",1),O(2,THe,2,6,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Eo extends k1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.getSize()-1)/2;return new v(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===W.NONE?E1.NONE:e===n?E1.PLAYER:E1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}getSize(){return this.getHeight()}}let Bi=(()=>{class r extends ja{constructor(t){super(),u(this,"generateMove",void 0),this.generateMove=t}isLegal(t,n,i){const o=i.get(),s=n.getCurrentPlayer(),a=this.getMoveValidity(s,t,n,o);return a.isFailure()?w.failure(a.getReason()):w.SUCCESS}getMoveValidity(t,n,i,o){const s=i.getRelativeOwner(t,n.getStart());if(s===E1.NONE)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===E1.OPPONENT)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(i.getRelativeOwner(t,n.getEnd())!==E1.NONE)return w.failure(dC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(i,n.getEnd())){if(!i.getPieceAt(n.getStart()).isKing())return w.failure(dC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(i.isCentralThrone(n.getEnd())&&o.castleIsLeftForGood)return w.failure(dC.THRONE_IS_LEFT_FOR_GOOD())}const c=n.getStart().getDirectionToward(n.getEnd()).get(),l=n.getStart().getOrthogonalDistance(n.getEnd());let f=n.getStart().getNext(c);for(let d=1;d<l;d++){if(i.getPieceAt(f)!==At.UNOCCUPIED)return w.failure(Ee.SOMETHING_IN_THE_WAY());f=f.getNext(c)}return w.SUCCESS}isThrone(t,n){return!!this.isExternalThrone(t,n)||t.isCentralThrone(n)}isExternalThrone(t,n){return t.isCorner(n)}tryCapture(t,n,i,o,s){const a=n.getNext(i);return!1===o.isOnBoard(a)||o.getRelativeOwner(t,a)!==E1.OPPONENT?g.empty():o.getPieceAt(a).isKing()?this.captureKing(t,n,i,o,s):this.capturePawn(t,n,i,o)}captureKing(t,n,i,o,s){const a=n.getNext(i),{backCoord:c,back:l,backInRange:f,left:d,leftCoord:m,right:E,rightCoord:T}=this.getSurroundings(a,i,t,o);return!1===f?this.captureKingAgainstTheWall(d,E,a,s):l===E1.NONE&&this.isThrone(o,c)?this.captureKingAgainstThrone(o,c,a,d,E,s):l===E1.PLAYER?this.captureKingWithAtLeastASandwich(o,a,d,m,E,T,s):g.empty()}getSurroundings(t,n,i,o){const s=t.getNext(n),a=o.isOnBoard(s),c=a?o.getRelativeOwner(i,s):E1.NONE,l=t.getLeft(n),d=o.isOnBoard(l)?o.getRelativeOwner(i,l):E1.NONE,m=t.getRight(n);return{backCoord:s,back:c,backInRange:a,leftCoord:l,left:d,rightCoord:m,right:o.isOnBoard(m)?o.getRelativeOwner(i,m):E1.NONE}}captureKingAgainstTheWall(t,n,i,o){let s=t===E1.PLAYER?1:0;return s+=n===E1.PLAYER?1:0,2===s&&o.edgesAreKingsEnnemy?g.of(i):g.empty()}captureKingAgainstThrone(t,n,i,o,s,a){if(this.isExternalThrone(t,n)){if(a.kingFarFromHomeCanBeSandwiched)return g.of(i)}else if(a.centralThroneCanSurroundKing&&(o===E1.PLAYER||s===E1.PLAYER))return g.of(i);return g.empty()}capturePawn(t,n,i,o){const s=n.getNext(i),a=s.getNext(i);let c=E1.NONE;return o.isOnBoard(a)&&(c=o.getRelativeOwner(t,a)),c===E1.NONE?!1===this.isThrone(o,a)?(we.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")cannot capture a pawn without an ally behind"),g.empty()):(we.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),g.of(s)):c===E1.PLAYER?(we.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),g.of(s)):(we.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),g.empty())}captureKingWithAtLeastASandwich(t,n,i,o,s,a,c){if(!1===this.kingTouchCentralThrone(t,n)&&c.kingFarFromHomeCanBeSandwiched)return g.of(n);const l=c.centralThroneCanSurroundKing,f=this.isThrone(t,o),d=i===E1.PLAYER||f&&l,m=this.isThrone(t,a);return d&&(s===E1.PLAYER||m&&l)?g.of(n):g.empty()}kingTouchCentralThrone(t,n){const i=t.getCentralThrone();return n.getOrthogonalDistance(i)<=1}applyLegalMove(t,n,i,o){const s=n.turn,a=n.getCopiedBoard(),c=n.getCurrentPlayer(),l=t.getStart(),f=t.getEnd();a[f.y][f.x]=a[l.y][l.x],a[l.y][l.x]=At.UNOCCUPIED;for(const d of Re.ORTHOGONALS){const m=this.tryCapture(c,t.getEnd(),d,n,i.get());m.isPresent()&&(a[m.get().y][m.get().x]=At.UNOCCUPIED)}return new Eo(a,s+1)}getGameStatus(t,n){const i=t.gameState,o=n.get(),s=this.getWinner(i,o);return s.isPresent()?_e.getVictory(s.get()):_e.ONGOING}getWinner(t,n){const i=this.getKingCoord(t);if(i.isAbsent())return we.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader(n));const o=i.get();return this.isExternalThrone(t,o)?(we.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender(n))):this.isPlayerImmobilized(k.ZERO,t,n)?(we.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(k.ONE)):this.isPlayerImmobilized(k.ONE,t,n)?(we.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(k.ZERO)):(we.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(t){const n=t.getSize();for(let i=0;i<n;i++)for(let o=0;o<n;o++)if(t.getPieceAtXY(o,i).isKing())return g.of(new v(o,i));return g.empty()}getInvader(t){return t.invaderStarts?k.ZERO:k.ONE}getDefender(t){return this.getInvader(t).getOpponent()}isPlayerImmobilized(t,n,i){return 0===this.getPlayerListMoves(t,n,i).length}getPlayerListMoves(t,n,i){const o=[],s=this.getPlayerListPawns(t,n);for(const a of s){const c=this.getPossibleDestinations(a,n,i);for(const l of c){const f=this.generateMove(a,l).get();o.push(f)}}return o}getPlayerListPawns(t,n){const i=n.getSize(),o=[];for(let s=0;s<i;s++)for(let a=0;a<i;a++){const c=new v(a,s);n.getAbsoluteOwner(c)===t&&o.push(c)}return o}getPossibleDestinations(t,n,i){const o=[];let s;for(const a of Re.ORTHOGONALS){s=t.getNext(a,1);let c=!1;for(;n.isOnBoard(s)&&!1===c;)n.getAbsoluteOwner(s)===W.NONE?this.isExternalThrone(n,s)?n.getPieceAt(t).isKing()&&o.push(s):n.isCentralThrone(s)?n.getPieceAt(t).isKing()&&!1===i.castleIsLeftForGood&&o.push(s):o.push(s):c=!0,s=s.getNext(a,1)}return o}}return u(r,"CASTLE_IS_LEFT_FOR_GOOD",()=>$localize`Central throne is left for good`),u(r,"EDGE_ARE_KING_S_ENNEMY",()=>$localize`Edges are king's ennemy`),u(r,"CENTRAL_THRONE_CAN_SURROUND_KING",()=>$localize`Central throne can surround king`),u(r,"KING_FAR_FROM_HOME_CAN_BE_SANDWICHED",()=>$localize`King far from home can be sandwiched`),u(r,"INVADER_STARTS",()=>$localize`Invader starts`),r})();class ca extends Bi{static get(){return ca.singleton.isAbsent()&&(ca.singleton=g.of(new ca)),ca.singleton.get()}constructor(){super(r2.from)}getInitialState(e){const t=At.UNOCCUPIED;let n=At.PLAYER_ZERO_PAWN,i=At.PLAYER_ONE_PAWN,o=At.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=At.PLAYER_ONE_PAWN,i=At.PLAYER_ZERO_PAWN,o=At.PLAYER_ZERO_KING),new Eo([[t,t,t,n,t,t,t],[t,t,t,n,t,t,t],[t,t,t,i,t,t,t],[n,n,i,o,i,n,n],[t,t,t,i,t,t,t],[t,t,t,n,t,t,t],[t,t,t,n,t,t,t]],0)}getRulesConfigDescription(){return g.of(ca.RULES_CONFIG_DESCRIPTION)}}u(ca,"singleton",g.empty()),u(ca,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Brandhub`,config:{castleIsLeftForGood:new er(!0,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new er(!1,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new er(!0,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new er(!0,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new er(!0,Bi.INVADER_STARTS)}}));const Z=At.UNOCCUPIED,p1=At.PLAYER_ZERO_PAWN,o2=At.PLAYER_ONE_PAWN,H9=At.PLAYER_ONE_KING,rne=ca.get().getDefaultRulesConfig();class wHe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,ca.get().getInitialState(rne)),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,ca.get().getInitialState(rne),r2.from(new v(3,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Eo([[Z,Z,Z,p1,Z,Z,Z],[Z,Z,Z,p1,Z,Z,Z],[p1,Z,Z,o2,Z,Z,Z],[Z,Z,o2,H9,o2,p1,p1],[Z,Z,p1,Z,Z,Z,Z],[Z,Z,Z,o2,Z,p1,Z],[Z,Z,Z,p1,Z,Z,Z]],1),[r2.from(new v(3,5),new v(2,5)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Eo([[Z,Z,Z,p1,Z,Z,Z],[Z,Z,p1,Z,Z,Z,Z],[Z,Z,Z,o2,Z,Z,Z],[p1,o2,Z,Z,o2,p1,p1],[Z,o2,Z,Z,Z,Z,Z],[Z,p1,Z,H9,Z,p1,Z],[Z,Z,Z,p1,Z,Z,Z]],12),[r2.from(new v(2,1),new v(3,1)).get(),r2.from(new v(3,0),new v(3,1)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new Eo([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,o2,Z,Z,Z],[Z,Z,Z,p1,Z,Z,Z],[Z,p1,Z,H9,p1,Z,Z],[Z,Z,Z,p1,Z,Z,Z],[Z,o2,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],72),[r2.from(new v(1,3),new v(2,3)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new Eo([[Z,Z,p1,Z,Z,Z,Z],[Z,Z,Z,p1,Z,Z,Z],[Z,Z,Z,H9,p1,Z,Z],[Z,p1,o2,Z,o2,Z,Z],[Z,Z,Z,p1,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],72),[r2.from(new v(2,0),new v(2,2)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),j.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new Eo([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,p1,Z,p1,Z,Z,Z],[p1,Z,Z,Z,o2,Z,Z],[Z,Z,Z,o2,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,H9,Z,p1,Z,Z,Z]],72),[r2.from(new v(3,6),new v(2,6)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}class V9 extends k1{}var oL;class Ka extends Or{static of(e){return new Ka(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(Ka,"encoder",Or.getEncoder(Ka.of));class r3 extends Ko{static of(e,t){return H.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new r3(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),o=e.getSecond();return!(!t.equals(n)||!i.equals(o))||!(!t.equals(o)||!i.equals(n))}}u(r3,"encoder",Ko.getEncoder(r3.of)),function(r){r.isFirstMove=function e(n){return n instanceof Ka},r.isDrop=function t(n){return n instanceof r3},r.encoder=Ne.disjunction([r.isFirstMove,r.isDrop],[Ka.encoder,r3.encoder])}(oL||(oL={}));class Su{constructor(e,t){u(this,"getOwner",void 0),u(this,"N",void 0),this.getOwner=e,this.N=t}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const o=n.coord;if(this.getOwner(n.content,e).isPlayer()){const s=this.getSquareScore(e,o);if(un.VICTORIES.some(a=>a===s))return un.of(s);t+=s}}return un.of(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);H.assert(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const o=new Qt,s=new Qt;for(const c of ve.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);o.set(c,l[0]),s.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(s,o)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[ve.UP,ve.UP_RIGHT,ve.RIGHT,ve.DOWN_RIGHT]){const o=e.get(i).get(),s=e.get(i.getOpposite()).get();if(this.N<=o+s+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let o=0,s=0,a=!0,c=new v(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;e.isOnBoard(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[o,s];this.getOwner(d,e)===i&&a?s++:a=!1,d!==f&&d!==i&&o++,c=c.getNext(n),l++}return[o,s]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,o=this.getSquareScore(e,i);un.isVictory(o)&&(o===k.ZERO.getVictoryValue()||o===k.ONE.getVictoryValue())&&t.push(i)}return t}}class Ui extends ja{static get(){return Ui.singleton.isAbsent()&&(Ui.singleton=g.of(new Ui)),Ui.singleton.get()}static getVictoriousCoords(e){return Ui.CONNECT_SIX_HELPER.getVictoriousCoord(e)}getRulesConfigDescription(){return g.of(Ui.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=wt.create(e.get().width,e.get().height,W.NONE);return new V9(t,0)}applyLegalMove(e,t,n,i){return e instanceof r3?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),o=e.getSecond(),s=t.getCopiedBoard();return s[i.y][i.x]=n,s[o.y][o.x]=n,new V9(s,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new V9(i,t.turn+1)}isLegal(e,t){return e instanceof Ka?(H.assert(0===t.turn,"ConnectSixFirstMove should only be used at first move"),!1===t.isOnBoard(e.coord)?w.failure(Ps.OUT_OF_RANGE(e.coord)):w.SUCCESS):(H.assert(t.turn>0,"ConnectSixDrops should only be used after first move"),!1===t.isOnBoard(e.getFirst())?w.failure(Ps.OUT_OF_RANGE(e.getFirst())):!1===t.isOnBoard(e.getSecond())?w.failure(Ps.OUT_OF_RANGE(e.getSecond())):this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}getGameStatus(e){const t=e.gameState;return Ui.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):181===t.turn?_e.DRAW:_e.ONGOING}}u(Ui,"singleton",g.empty()),u(Ui,"RULES_CONFIG_DESCRIPTION",tL.GOBAN),u(Ui,"CONNECT_SIX_HELPER",new Su(H.identity,6));class Xo{static getHoshis(e,t){const n=[],i=Xo.getHorizontalCenter(e),o=Xo.getVerticalCenter(t),s=Xo.getHorizontalLeft(e),a=Xo.getVerticalUp(t),c=Xo.getHorizontalRight(e),l=Xo.getVerticalDown(t);return 12<t&&t%2==1&&n.push(new v(s,o),new v(c,o)),12<e&&e%2==1&&n.push(new v(i,a),new v(i,l)),e%2==1&&t%2==1&&n.push(new v(i,o)),n.push(new v(s,a),new v(s,l),new v(c,a),new v(c,l)),n}static getHorizontalLeft(e){return e<12?2:3}static getHorizontalCenter(e){return Math.floor(e/2)}static getHorizontalRight(e){return e-(Xo.getHorizontalLeft(e)+1)}static getVerticalUp(e){return e<12?2:3}static getVerticalCenter(e){return Math.floor(e/2)}static getVerticalDown(e){return e-(Xo.getVerticalUp(e)+1)}}let sL=(()=>{var r;class e extends Mo{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.getHeight(),i=this.getWidth();this.hoshis=Xo.getHoshis(i,n)}isHoshi(n,i){return this.hoshis.some(o=>o.x===n&&o.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class sne extends jn{getListMoves(e,t){return 0===e.gameState.turn?this.getFirstMove(e.gameState):this.getListDrops(e)}getFirstMove(e){const t=e.getWidth(),n=e.getHeight(),i=Math.floor(t/2),o=Math.floor(n/2),s=new v(i,o);return[Ka.of(s)]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const o=e.gameState.getCopiedBoard();o[i.y][i.x]=e.gameState.getCurrentPlayer();const s=new V9(o,e.gameState.turn),a=this.getAvailableCoords(s);for(const c of a){const l=r3.of(i,c);n.push(l)}}return new it(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const o=i.coord;!0===t[o.y][o.x]&&!1===i.content.isPlayer()&&n.push(o)}return n}getUsefulCoordsMap(e){const t=e.getWidth(),n=e.getHeight(),i=wt.create(t,n,!1);for(const o of e.getCoordsAndContents())o.content.isPlayer()&&this.addNeighboringCoord(i,o.coord);return i}addNeighboringCoord(e,t){const i=e[0].length,o=e.length,s=Math.max(0,t.x-1),a=Math.max(0,t.y-1),c=Math.min(i-1,t.x+1),l=Math.min(o-1,t.y+1);for(let f=a;f<=l;f++)for(let d=s;d<=c;d++)e[f][d]=!0}}class NHe extends Ya{getBoardValue(e,t){const n=e.gameState;let i=0;for(const o of n.getCoordsAndContents())o.content.isPlayer()&&(i+=Ui.CONNECT_SIX_HELPER.getSquareScore(n,o.coord));return un.of(i)}}class AHe extends cn{constructor(){super($localize`Alignment`,Ui.get(),new NHe,new sne)}}function IHe(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE)}}function kHe(r,e){if(1&r&&(I(),V(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();Ce("id","hoshi_",t,"_",n,""),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.2*i.SPACE_SIZE)}}function xHe(r,e){if(1&r&&(I(),V(0,"rect",9)(1,"line",10)(2,"line",10),O(3,kHe,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n),_(1),A("x1",i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+i.SPACE_SIZE*n),_(1),A("x1",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y1",i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function LHe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),O(1,IHe,1,6,"circle",6),O(2,xHe,4,13,"ng-template",null,7,mn),S()}if(2&r){const t=e.$implicit,n=e.index,i=dn(3);Ce("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function RHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,LHe,4,4,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function zHe(r,e){if(1&r){const t=ge();I(),P(0,"circle",13),q("click",function(){ee(t);const i=p();return te(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),S()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),A("cx",.5*t.SPACE_SIZE+t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.5*t.SPACE_SIZE+t.SPACE_SIZE*t.droppedCoord.get().y)("r",.44*t.SPACE_SIZE)}}let DHe=(()=>{var r;class e extends sL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.setRulesAndNode("ConnectSix"),this.availableAIs=[new AHe,new bn($localize`MCTS`,new sne,this.rules)],this.encoder=oL.encoder}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.victoryCoords=Ui.getVictoriousCoords(o),i.createHoshis()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=n instanceof Ka?[n.coord]:[n.getFirst(),n.getSecond()]})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);if(0===o.getState().turn){const c=Ka.of(a);return o.chooseMove(c)}if(o.getState().getPieceAt(a).isPlayer())return o.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SQUARE());if(o.droppedCoord.isPresent()){if(o.droppedCoord.equalsValue(a))return o.droppedCoord=g.empty(),w.SUCCESS;{const c=r3.of(o.droppedCoord.get(),a);return o.chooseMove(c)}}return o.droppedCoord=g.of(a),w.SUCCESS})()}getSpaceClass(n,i){const o=new v(n,i),s=this.getState().getPieceAt(o),a=[];return this.droppedCoord.equalsValue(o)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(s)),this.victoryCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(o))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-connect-six"]],features:[Ge],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),V(1,"rect",1),O(2,RHe,2,1,"g",2),O(3,zHe,1,4,"circle",3),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),A("width",i.getState().getWidth()*i.SPACE_SIZE)("height",i.getState().getHeight()*i.SPACE_SIZE),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const R=W.NONE,Po=W.ZERO,Wi=W.ONE,ane=Ui.get().getDefaultRulesConfig();class HHe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,Ui.get().getInitialState(ane)),j.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,Ui.get().getInitialState(ane),Ka.of(new v(9,9)),$localize`Congratulations!`),j.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new V9([[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,Wi,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,Po,R,Wi,Po,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,Po,Po,R,R,Wi,R,R,R,R,R,R],[R,R,R,R,R,R,R,Wi,Po,Po,Po,Po,Wi,R,R,R,R,R,R],[R,R,R,R,R,R,Wi,Po,Po,Po,Po,Wi,R,R,R,R,R,R,R],[R,R,R,R,R,R,Wi,R,Wi,Po,Wi,Wi,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,Po,Wi,Po,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,Wi,R,Wi,R,Po,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,Wi,Wi,R,Wi,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,Wi,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,Po,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R]],20),r3.of(new v(4,11),new v(5,10)),$localize`Congratulations!`)])}}let C4=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var une,Mi,pC;class y4 extends Or{static of(e){return new y4(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!Mi.isDrop(e)&&this.coord.equals(e.coord)}}u(y4,"encoder",Or.getEncoder(y4.of));class M4 extends n2{static from(e,t){return e.isAlignedWith(t)&&1===e.getDistance(t)?Q.success(new M4(e,t)):Q.failure(C4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!Mi.isSimple(e)&&super.equals(e)}}u(M4,"encoder",Ko.getFallibleEncoder(M4.from));class la extends yo{static from(e){if(e.length<2)return Q.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return Q.failure(C4.INVALID_JUMP());return new U1(e).size()===e.length?Q.success(new la(e)):Q.failure(C4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=Ct.copy(this.coords);return t.push(e),la.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(Mi.isSimple(e)||Mi.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}une=la,u(la,"encoder",Ne.tuple([Ne.list(v.encoder)],r=>[Ct.copy(r.coords)],r=>une.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof y4},r.isSimple=function t(i){return i instanceof M4},r.isJump=function n(i){return i instanceof la},r.encoder=Ne.disjunction([r.isDrop,r.isSimple,r.isJump],[y4.encoder,M4.encoder,la.encoder])}(Mi||(Mi={}));class Kn extends k1{isShelter(e){return this.isVerticalEdge(e)?Kn.SHELTERS_INDICES.some(t=>e.y===t):!!this.isHorizontalEdge(e)&&Kn.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return Kn.CENTRAL_ZONE_TOP_LEFT.x<=e.x&&e.x<=Kn.CENTRAL_ZONE_BOTTOM_RIGHT.x&&Kn.CENTRAL_ZONE_TOP_LEFT.y<=e.y&&e.y<=Kn.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}pC=Kn,u(Kn,"WIDTH",17),u(Kn,"HEIGHT",17),u(Kn,"CENTRAL_ZONE_TOP_LEFT",new v(4,6)),u(Kn,"CENTRAL_ZONE_BOTTOM_RIGHT",new v(12,10)),u(Kn,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(Kn,"ALL_SHELTERS",new it(pC.SHELTERS_INDICES.flatMap(r=>[new v(r,0),new v(r,pC.HEIGHT-1),new v(0,r),new v(pC.WIDTH-1,r)])).toList());class Os extends Sr{static get(){return Os.singleton.isAbsent()&&(Os.singleton=g.of(new Os)),Os.singleton.get()}getInitialState(){const e=wt.create(Kn.WIDTH,Kn.HEIGHT,W.NONE);return new Kn(e,0)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();if(Mi.isDrop(e))o[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(Mi.isSimple(e))o[e.getStart().y][e.getStart().x]=W.NONE,o[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),a=e.getEndingCoord();o[s.y][s.x]=W.NONE,o[a.y][a.x]=t.getCurrentPlayer()}return new Kn(o,t.turn+1)}isLegal(e,t){return Mi.isDrop(e)?this.dropLegality(e,t):Mi.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return H.assert(t.isOnBoard(e.coord),"Move out of board"),40<=t.turn?w.failure(C4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?w.failure(C4.MUST_DROP_IN_CENTRAL_ZONE()):w.SUCCESS}simpleMoveLegality(e,t){const n=t.isOnBoard(e.getStart()),i=t.isOnBoard(e.getEnd());if(H.assert(n&&i,"Move out of board"),t.turn<40)return w.failure(C4.CANNOT_MOVE_BEFORE_TURN_40());const o=t.getPieceAt(e.getStart());return o===W.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):o===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}jumpLegality(e,t){for(const i of e.coords)if(!1===t.isOnBoard(i))return Q.failure(Ps.OUT_OF_RANGE(i));if(t.turn<40)return w.failure(C4.CANNOT_MOVE_BEFORE_TURN_40());const n=t.getPieceAt(e.getStartingCoord());if(n===W.NONE)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());for(const i of e.getJumpedOverCoords())if(t.getPieceAt(i)===W.NONE)return w.failure(C4.MUST_JUMP_OVER_PIECES());for(const i of e.getLandingCoords())if(t.getPieceAt(i).isPlayer())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());return w.SUCCESS}jumpTargetsFrom(e,t){const n=[new v(t.x+2,t.y),new v(t.x-2,t.y),new v(t.x,t.y+2),new v(t.x,t.y-2),new v(t.x+2,t.y+2),new v(t.x+2,t.y-2),new v(t.x-2,t.y+2),new v(t.x-2,t.y-2)],i=[];for(const o of n)e.isOnBoard(o)&&la.from([t,o]).isSuccess()&&i.push(o);return i}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const o of this.jumpTargetsFrom(t,n)){const s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of Kn.ALL_SHELTERS){const o=t.getPieceAt(i);if(o.isPlayer()&&(n[o.value]+=1,20===n[o.value]))return _e.getVictory(o)}return _e.ONGOING}}u(Os,"singleton",g.empty());const C=W.NONE,_t=W.ZERO,ht=W.ONE;class VHe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Os.get().getInitialState()),j.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Os.get().getInitialState(),y4.of(new v(7,7)),$localize`Congratulations!`),j.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Kn([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,_t,_t,ht,ht,_t,_t,ht,_t,ht,C,C,C,C],[C,C,C,C,_t,ht,_t,ht,_t,_t,_t,_t,ht,C,C,C,C],[C,C,C,C,_t,ht,C,C,C,C,C,ht,_t,C,C,C,C],[C,C,C,C,ht,_t,_t,ht,ht,ht,_t,_t,_t,C,C,C,C],[C,C,C,C,ht,_t,ht,ht,ht,ht,ht,ht,_t,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),M4.from(new v(4,6),new v(3,5)).get(),(t,n,i)=>Mi.isSimple(t)?w.SUCCESS:w.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),j.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Kn([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,_t,_t,ht,ht,_t,_t,ht,_t,ht,C,C,C,C],[C,C,C,C,_t,ht,_t,ht,_t,_t,_t,_t,ht,C,C,C,C],[C,C,C,C,_t,ht,C,C,C,C,C,ht,_t,C,C,C,C],[C,C,C,C,ht,_t,_t,ht,ht,ht,_t,_t,_t,C,C,C,C],[C,C,C,C,ht,_t,ht,ht,ht,ht,ht,ht,_t,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),la.from([new v(6,7),new v(6,5)]).get(),(t,n,i)=>Mi.isJump(t)?w.SUCCESS:w.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),j.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Kn([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,ht,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,ht,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,ht,C,C,C,C,C,C,C,C,C],[C,C,C,C,_t,_t,C,ht,_t,_t,ht,_t,ht,C,C,C,C],[C,C,C,C,_t,C,_t,ht,_t,_t,_t,_t,ht,C,C,C,C],[C,C,C,C,_t,ht,C,C,C,C,C,ht,_t,C,C,C,C],[C,C,C,C,ht,_t,_t,ht,ht,ht,_t,_t,_t,C,C,C,C],[C,C,C,C,ht,_t,ht,ht,ht,ht,ht,ht,_t,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),[la.from([new v(8,6),new v(6,4),new v(6,2),new v(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}let F9=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var Xa,fne,dne;class wn{static of(e,t){return e===k.ZERO?t?wn.ZERO_SECOND:wn.ZERO_FIRST:e===k.ONE?t?wn.ONE_SECOND:wn.ONE_FIRST:wn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}Xa=wn,u(wn,"encoder",Ne.tuple([W.encoder,Ne.identity()],r=>[r.owner,r.otherPieceType],r=>Xa.of(r[0],r[1]))),u(wn,"EMPTY",new Xa(W.NONE,!1)),u(wn,"ZERO_FIRST",new Xa(k.ZERO,!1)),u(wn,"ZERO_SECOND",new Xa(k.ZERO,!0)),u(wn,"ONE_FIRST",new Xa(k.ONE,!1)),u(wn,"ONE_SECOND",new Xa(k.ONE,!0)),u(wn,"PLAYER_PIECES",[Xa.ZERO_FIRST,Xa.ZERO_SECOND,Xa.ONE_FIRST,Xa.ONE_SECOND]);class hne extends yo{isDrop(){return this instanceof E4}isShift(){return this instanceof qi}}class E4 extends hne{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===wn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof E4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}fne=E4,u(E4,"encoder",Ne.tuple([Ne.identity(),wn.encoder],r=>[r.target,r.piece],r=>new fne(r[0],r[1])));class qi extends hne{static ofRepresentation(e,t){return new qi(new v(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof qi&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}dne=qi,u(qi,"encoder",Ne.tuple([v.encoder,Ne.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new dne(r[0],r[1]?"clockwise":"counterclockwise")));const FHe=Ne.disjunction([r=>r.isDrop(),r=>r.isShift()],[E4.encoder,qi.encoder]);let tr=(()=>{class r extends k1{static ofRepresentation(t,n){const i=t.reverse(),o=[4,4,4,4];for(let s=0;s<r.HEIGHT;s++)for(let a=0;a<r.WIDTH;a++)i[s][a]!==wn.EMPTY&&o[r.pieceIndex(i[s][a])]--;return nn(o.every(s=>0<=s),"Invalid DiamState representation uses too many pieces"),new r(i,o,n)}static pieceIndex(t){switch(t){case wn.ZERO_FIRST:return 0;case wn.ZERO_SECOND:return 1;case wn.ONE_FIRST:return 2;default:return H.expectToBe(t,wn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==wn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class i3 extends Sr{static get(){return i3.singleton.isAbsent()&&(i3.singleton=g.of(new i3)),i3.singleton.get()}getInitialState(){const e=wn.EMPTY;return new tr([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}applyLegalMove(e,t,n,i){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=wt.copy(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=Ct.copy(t.remainingPieces);return i[tr.pieceIndex(e.piece)]-=1,new tr(n,i,t.turn+1)}applyLegalShift(e,t){const n=wt.copy(t.board),i=e.getTarget();let o=t.getStackHeight(i),s=e.start.y;for(;s<tr.HEIGHT&&t.getPieceAtXY(e.start.x,s)!==wn.EMPTY;)n[o][i]=t.getPieceAtXY(e.start.x,s),n[s][e.start.x]=wn.EMPTY,o++,s++;return new tr(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return H.assert(e.target<tr.WIDTH,"DiamMoveDrop out of board"),H.assert(e.piece.owner!==W.NONE,"DiamMoveDrop cannot contain an empty piece"),e.piece.owner===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===t.getRemainingPiecesOf(e.piece)?w.failure(F9.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===tr.HEIGHT?w.failure(F9.SPACE_IS_FULL()):w.SUCCESS}isShiftLegal(e,t){const n=t.getPieceAt(e.start);return n.owner===W.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.owner===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>tr.HEIGHT?w.failure(F9.TARGET_STACK_TOO_HIGH()):w.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return H.assert(n.owner.isPlayer(),"highest alignment is owned by a player"),_e.getVictory(n.owner)}return _e.ONGOING}findHighestAlignment(e){for(let t=0;t<tr.WIDTH/2;t++)for(let n=tr.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),o=e.getPieceAtXY(t+tr.WIDTH/2,n);if(i!==wn.EMPTY&&i===o)return g.of(new v(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new qi(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new qi(t,"counterclockwise"),e).isSuccess()}}u(i3,"singleton",g.empty());const $e=wn.EMPTY,Ou=wn.ZERO_FIRST,gne=wn.ZERO_SECOND,mC=wn.ONE_FIRST,aL=wn.ONE_SECOND;class $He{constructor(){u(this,"tutorial",[j.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,i3.get().getInitialState()),j.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,tr.ofRepresentation([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,mC,$e,$e,$e],[Ou,$e,$e,$e,Ou,$e,$e,$e]],3),[new E4(0,wn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),j.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,tr.ofRepresentation([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,aL,$e,$e,$e],[$e,$e,$e,$e,Ou,$e,$e,$e],[mC,$e,$e,$e,gne,$e,$e,$e]],4),[qi.ofRepresentation(new v(4,3),"counterclockwise"),qi.ofRepresentation(new v(4,3),"clockwise"),qi.ofRepresentation(new v(4,2),"counterclockwise"),qi.ofRepresentation(new v(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),j.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,tr.ofRepresentation([[$e,$e,$e,$e,Ou,$e,$e,$e],[$e,$e,$e,$e,aL,$e,$e,Ou],[$e,$e,$e,$e,Ou,$e,$e,aL],[$e,mC,$e,$e,gne,$e,$e,mC]],8),[qi.ofRepresentation(new v(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let pne=(()=>{var r;class e extends n3{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new v(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const o=this.getTriangleTranslateCoord(n,i);return"translate("+o.x+", "+o.y+")"}getDownwardCoordinate(){const o=this.SPACE_SIZE/2,s=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new v(-this.SPACE_SIZE/2,s);return[c,new v(0,a),new v(o,s),c]}getUpwardCoordinate(){const o=this.SPACE_SIZE/2,s=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new v(-this.SPACE_SIZE/2,a);return[c,new v(0,s),new v(o,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,o=n+", "+-n,s="0, "+n,a="0, 0";return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,o=n+", "+n,s="0, "+-n,a="0, 0";return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),$9=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class ua{static getNeighbors(e){let t;const n=new v(e.x-1,e.y),i=new v(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new v(e.x,e.y-1)]:[n,i,new v(e.x,e.y+1)],t}static getFakeNeighbors(e){return new v(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=ua.getNeighbors(e),i=ua.getNeighbors(t);let o=0;for(;o<n.length;){const s=n[o];let a=0;for(;a<i.length;){if(s.equals(i[a]))return g.of(s);a++}o++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class k0 extends k1{static getEmptyNeighbors(e,t,n){const i=[];for(const o of ua.getNeighbors(t))o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o);return i}getEmptyNeighbors(e,t){return k0.getEmptyNeighbors(this.board,e,t)}}var _C,o3;let Ei=(_C=class extends k0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new v(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new v(e.x+1,e.y-1),new v(e.x+3,e.y+0),new v(e.x+3,e.y+1),new v(e.x+1,e.y+2),new v(e.x-1,e.y+1),new v(e.x-1,e.y+0)].filter(o3.isOnBoard)}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Me.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Me.EMPTY,new o3(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return ua.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Me.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Me.EMPTY,n[this.getCurrentPlayer().value]+=1,new o3(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=o3.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const o=o3.getPresentNeighborEntrances(i);for(const s of o){const a=n.getPieceAt(s);a===Me.EMPTY?n=n.removeTilesIfNeeded(s,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(s)&&(n=n.capture(s))}}return n}isTileEmpty(e){H.assert(this.getPieceAt(e)!==Me.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new Vt(n,t),1);if(this.getPieceAt(i)!==Me.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndices(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndices(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const s=e.getNext(o3.NEIGHBORS_TILES_DIRECTIONS[i],1);o3.isOnBoard(s)&&this.getPieceAt(s)!==Me.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,o=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[o+a][i+c]=Me.UNREACHABLE;const s=[this.tiles[0],this.tiles[1]];return t&&(s[this.getCurrentPlayer().value]+=1),new o3(n,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of Ts.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Me.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const o=this.getEmptyNeighbors(new v(n,t),Me.EMPTY).length;e[i.value][o]=e[i.value][o]+1}}return e}},o3=_C,u(_C,"NEIGHBORS_TILES_DIRECTIONS",[new Vt(0,-2),new Vt(3,-1),new Vt(3,1),new Vt(0,2),new Vt(-3,1),new Vt(-3,-1)]),_C);var D2,Vl;Ei=o3=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],Ei);class Ts{static ofCoords(e,t){const n=e.getVectorToward(t),i=Ts.STEPS.findIndex(o=>o.direction.equals(n));return H.assert(-1!==i,$9.INVALID_DISTANCE()),Ts.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(Ts,"LEFT",new(D2=Ts)(new Vt(-2,0),"LEFT")),u(Ts,"UP_LEFT",new D2(ve.UP_LEFT,"UP_LEFT")),u(Ts,"UP_RIGHT",new D2(ve.UP_RIGHT,"UP_RIGHT")),u(Ts,"RIGHT",new D2(new Vt(2,0),"RIGHT")),u(Ts,"DOWN_LEFT",new D2(ve.DOWN_LEFT,"DOWN_LEFT")),u(Ts,"DOWN_RIGHT",new D2(ve.DOWN_RIGHT,"DOWN_RIGHT")),u(Ts,"STEPS",[D2.LEFT,D2.UP_LEFT,D2.UP_RIGHT,D2.RIGHT,D2.DOWN_LEFT,D2.DOWN_RIGHT]);class ji extends n2{static of(e,t){const n=Ts.ofCoords(e,t);return ji.ofMovement(e,n)}static ofMovement(e,t){H.assert(Ei.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new v(e.x+t.direction.x,e.y+t.direction.y);return H.assert(Ei.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new ji(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!Vl.isTileExchange(e)&&super.equals(e)}}u(ji,"encoder",n2.getEncoder(ji.of));class P4 extends Or{static of(e){return H.assert(Ei.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new P4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!Vl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(P4,"encoder",Or.getEncoder(P4.of)),function(r){r.isNormalMove=function e(n){return n instanceof ji},r.isTileExchange=function t(n){return n instanceof P4},r.encoder=Ne.disjunction([r.isNormalMove,r.isTileExchange],[ji.encoder,P4.encoder])}(Vl||(Vl={}));class BHe extends B1{getMetrics(e,t){const n=e.gameState,i=n.getPiecesByFreedom(),o=this.getPiecesScore(i);return g1.of([2*n.captures[0]+o[0]],[2*n.captures[1]+o[1]])}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}}class cL extends jn{getListMoves(e,t){let n=this.getListExchanges(e);return n=n.concat(this.getListMovement(e)),n}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,o=Me.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const s of n.getCoordsAndContents())if(s.content===o){const a=P4.of(s.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const o of n.getCoordsAndContents()){const s=o.coord;if(o.content.is(i)){const a=n.getLegalLandings(s);for(const c of a){const l=ji.of(s,c);t.push(l)}}}return t}}class UHe extends B1{getMetrics(e,t){const n=e.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(n,i),s=this.filterThreatMap(o,n),f=g1.of([0,0,0],[0,0,0]);for(const d of k.PLAYERS){for(const m of i.get(d).get())s.get(m).isPresent()?f.add(d,1,1):f.add(d,0,1);f.add(d,2,n.tiles[d.value])}return f}getPiecesMap(e){const t=new Qt,n=[],i=[];for(const o of e.getCoordsAndContents()){const s=o.coord,a=e.getPieceAt(s);a===Me.ZERO?n.push(s):a===Me.ONE&&i.push(s)}return t.set(k.ZERO,new U1(n)),t.set(k.ONE,new U1(i)),t}getThreatMap(e,t){const n=new Qt;for(const i of k.PLAYERS)for(const o of t.get(i).get()){const s=this.getThreat(o,e);s.isPresent()&&n.set(o,s.get())}return n}getThreat(e,t){const i=k.of(t.getPieceAt(e).value).getOpponent();let o=g.empty(),s=g.empty(),a=[];const c=ua.getNeighbors(e).filter(Ei.isOnBoard);for(const l of c){const f=t.getPieceAt(l);if(f.is(i))a.push(l),this.tileCouldBeRemovedThisTurn(l,t,i)&&(s=g.of(l));else if(f===Me.EMPTY){if(o.isPresent())return g.empty();o=g.of(l)}}if(o.isPresent()){const l=[];for(const f of Ts.STEPS){const d=o.get().getNext(f.direction,1);Ei.isOnBoard(d)&&t.getPieceAt(d).is(i)&&!1===a.some(m=>m.equals(d))&&l.push(d)}if(l.length>0)return g.of(new gC(new U1(a),new U1(l)))}if(s.isPresent()){a=a.filter(f=>f.equals(s.get()));const l=new U1(a);return g.of(new gC(l,new U1([s.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(e,t,n){const i=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;let s=g.empty();const a=Ei.getTilesUpperLeftCoord(e);for(let c=0;c<2;c++)for(let l=0;l<3;l++){const f=a.getNext(new Vt(l,c),1);if(t.getPieceAt(f).is(n)){if(!this.pieceCouldLeaveTheTile(f,t))return!1;s=g.of(f)}else if(t.getPieceAt(f).is(i))return!1}return s.isPresent()}pieceCouldLeaveTheTile(e,t){const n=Ei.getTilesUpperLeftCoord(e);for(const i of Ts.STEPS){const o=e.getNext(i.direction,1),s=Ei.getTilesUpperLeftCoord(o);if(!1===n.equals(s)&&Ei.isOnBoard(o)&&t.getPieceAt(o)===Me.EMPTY)return!0}return!1}filterThreatMap(e,t){const n=new Qt,i=e.listKeys(),o=i.filter(a=>t.getPieceAt(a).is(t.getCurrentPlayer())),s=new U1(i.filter(a=>t.getPieceAt(a).is(t.getCurrentOpponent())));for(const a of o){const c=e.get(a).get();let l=g.empty();for(const f of c.directThreats)if(!1===s.contains(f)){const d=[];for(const m of c.mover)!1===s.contains(m)&&d.push(m);d.length>0&&(l=g.of(new gC(c.directThreats,new U1(d))))}l.isPresent()&&n.set(a,l.get())}for(const a of s){const c=e.get(a).get();n.set(a,c)}return n}}class WHe extends cL{getListMoves(e,t){const n=super.getListMoves(e,t);return this.putCaptureFirst(e,n)}putCaptureFirst(e,t){return Ct.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return Vl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}function qHe(r,e){if(1&r&&(I(),V(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();Ce("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),A("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function jHe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),O(1,qHe,1,5,"polygon",6),S()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),_(1),y("ngIf",i.mustDraw(t,n))}}function ZHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,jHe,2,3,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function YHe(r,e){if(1&r&&(I(),V(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();Ce("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),A("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function KHe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),O(1,YHe,1,5,"polygon",8),S()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),_(1),y("ngIf",i.isPyramid(t,n))}}function XHe(r,e){if(1&r&&(I(),P(0,"g"),O(1,KHe,2,3,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function QHe(r,e){if(1&r){const t=ge();I(),P(0,"rect",12),q("click",function(){const o=ee(t).$implicit;return te(p(2).onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p(2);A("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function JHe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"polygon",10),O(2,QHe,1,5,"rect",11),S()),2&r){const t=p();_(1),Ce("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),A("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),_(1),y("ngForOf",t.possibleLandings)}}function eVe(r,e){if(1&r&&(I(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),A("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function tVe(r,e){if(1&r&&(I(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),A("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function nVe(r,e){if(1&r&&(I(),O(0,eVe,1,4,"polygon",13),O(1,tVe,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),_(1),y("ngIf",t.lastEnd.isPresent())}}const rVe=function(r){return["base",r]};function iVe(r,e){if(1&r&&(I(),P(0,"g",16),V(1,"polygon",17),P(2,"text",18),rt(3),S()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),A("transform",n.getTilesCountTranslate(t)),_(1),y("ngClass",Ra(7,rVe,"player"+t.value+"-fill")),A("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),_(1),A("font-size",n.SPACE_SIZE/2),_(1),gn(n.tiles[t.value])}}function oVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,iVe,4,9,"g",15),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngIf",n.mustShowTilesOf(t))}}let sVe=(()=>{var r;class e extends pne{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",Me.UNREACHABLE),u(this,"INDICATOR_SIZE",10),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),this.setRulesAndNode("Coerceo"),this.availableAIs=[new cn($localize`Pieces > Threats > Tiles`,this.rules,new UHe,new WHe),new cn($localize`Captures > Freedom`,this.rules,new BHe,new cL),new bn($localize`MCTS`,new cL,this.rules)],this.encoder=Vl.encoder,this.scores=g.of([0,0])}updateBoard(n){var i=this;return M(function*(){i.chosenCoord=g.empty(),i.state=i.getState(),i.scores=g.of(i.state.captures),i.tiles=i.state.tiles,i.board=i.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){var i=this;return M(function*(){n instanceof ji?(i.lastStart=g.of(n.getStart()),i.lastEnd=g.of(n.getEnd())):(i.lastStart=g.empty(),i.lastEnd=g.empty())})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i),c=o.state.getCurrentPlayer();return o.chosenCoord.equalsValue(a)?(o.cancelMoveAttempt(),w.SUCCESS):o.chosenCoord.isAbsent()||o.state.getPieceAt(a).is(c)?o.firstClick(a):o.secondClick(a)})()}firstClick(n){var i=this;return M(function*(){const o=i.state.getPieceAt(n);if(o.is(i.state.getCurrentOpponent())){const s=P4.of(n);return i.chooseMove(s)}return o.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),w.SUCCESS):i.cancelMove($9.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return M(function*(){if(i.possibleLandings.some(o=>o.equals(n))){const o=ji.of(i.chosenCoord.get(),n);return i.chooseMove(o)}return i.cancelMove($9.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const o=this.node.parent;if(o.isPresent()){const s=o.get().gameState.getCurrentOpponent();return o.get().gameState.getPieceAtXY(n,i).is(s)}return!1}getPyramidClass(n,i){const o=this.board[i][n];return o===Me.ZERO?this.getPlayerClass(k.ZERO):o===Me.ONE?this.getPlayerClass(k.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==Me.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const s=this.node.parent;if(this.board[i][n]===Me.UNREACHABLE&&s.isPresent()){const a=s.get().gameState.getPieceAtXY(n,i);return a===Me.EMPTY||a.is(s.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const o=this.getTriangleTranslateCoord(n,i),s=o.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=o.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+s+", "+a+")"}getTilesCountTranslate(n){let i,o;return n===k.ZERO?(i=-.05,o=-.1):(i=7.5,o=9.45),i*=this.SPACE_SIZE,o*=this.SPACE_SIZE,"translate("+i+", "+o+")"}getViewBox(){const a=this.STROKE_WIDTH/2;return new sa(-this.SPACE_SIZE/2,-this.SPACE_SIZE/2,8.5*this.SPACE_SIZE+2*this.STROKE_WIDTH,10.5*this.SPACE_SIZE+2*this.STROKE_WIDTH).expand(a,a,a,a)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-coerceo"]],features:[Ge],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base normal-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","normal-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","normal-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill normal-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","normal-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(I(),P(0,"svg",0),O(1,ZHe,2,1,"g",1),O(2,XHe,2,1,"g",1),O(3,JHe,3,5,"g",2),O(4,nVe,2,2,"ng-template",null,3,mn),O(6,oVe,2,1,"g",1),S()),2&n){const o=dn(5);A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",o),_(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var vC,x0;let G9=(vC=class extends Sr{static get(){return x0.singleton.isAbsent()&&(x0.singleton=g.of(new x0)),x0.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new Ei([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}applyLegalMove(e,t,n,i){return Vl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Me.EMPTY;const o=[t.captures[0],t.captures[1]];o[t.getCurrentPlayer().value]+=1;const s=[t.tiles[0],t.tiles[1]];s[t.getCurrentPlayer().value]-=2;const c=new Ei(n,t.turn,s,o).removeTilesIfNeeded(i,!1);return new Ei(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const o=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new Ei(o.board,t.turn+1,o.tiles,o.captures)}isLegal(e,t){return Vl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return w.failure($9.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Me.UNREACHABLE||n===Me.EMPTY?w.failure($9.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?w.failure(Ee.CANNOT_SELF_CAPTURE()):w.SUCCESS}isLegalMovement(e,t){H.assert(t.getPieceAt(e.getStart())!==Me.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),H.assert(t.getPieceAt(e.getEnd())!==Me.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Me.EMPTY?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}static getGameStatus(e){const t=e.gameState;return 18<=t.captures[0]?_e.ZERO_WON:18<=t.captures[1]?_e.ONE_WON:_e.ONGOING}getGameStatus(e){return x0.getGameStatus(e)}},x0=vC,u(vC,"singleton",g.empty()),vC);G9=x0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],G9);const re=Me.EMPTY,x=Me.UNREACHABLE,i1=Me.ZERO,Mn=Me.ONE;class cVe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,G9.get().getInitialState()),j.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,G9.get().getInitialState(),ji.of(new v(3,5),new v(5,5)),$localize`Congratulations! Let's see captures now.`),j.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Ei([[x,x,x,x,x,x,i1,re,i1,x,x,x,x,x,x],[x,x,x,i1,re,re,re,re,re,i1,re,re,x,x,x],[re,Mn,re,Mn,i1,Mn,re,re,i1,re,re,Mn,re,Mn,re],[Mn,re,re,re,re,re,re,re,re,re,Mn,re,re,re,Mn],[re,Mn,re,Mn,re,re,re,re,re,re,re,Mn,re,Mn,re],[re,i1,re,i1,re,re,re,re,re,re,re,i1,re,i1,re],[i1,re,re,re,i1,re,re,re,re,re,i1,re,re,re,i1],[re,i1,re,i1,re,re,Mn,re,Mn,re,re,i1,re,i1,re],[x,x,x,re,re,Mn,re,re,re,Mn,re,re,x,x,x],[x,x,x,x,x,x,Mn,re,Mn,x,x,x,x,x,x]],3,[0,0],[0,0]),[ji.of(new v(5,2),new v(4,1)),ji.of(new v(3,4),new v(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),j.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Ei([[x,x,x,x,x,x,re,re,re,x,x,x,x,x,x],[x,x,x,x,x,x,Mn,re,re,x,x,x,x,x,x],[re,re,re,x,x,x,re,re,re,x,x,x,x,x,x],[re,re,Mn,re,re,re,re,i1,re,x,x,x,x,x,x],[re,re,re,Mn,re,re,re,re,re,x,x,x,x,x,x],[re,re,re,re,re,re,re,re,re,re,re,i1,x,x,x],[re,re,i1,re,re,Mn,re,re,re,re,i1,re,re,re,i1],[re,re,re,re,re,re,Mn,re,Mn,re,re,i1,re,i1,re],[x,x,x,re,re,Mn,re,re,re,Mn,re,re,x,x,x],[x,x,x,x,x,x,Mn,re,Mn,x,x,x,x,x,x]],2,[0,0],[0,0]),[ji.of(new v(2,6),new v(4,6)),ji.of(new v(2,6),new v(3,5)),ji.of(new v(2,6),new v(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),j.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Ei([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,re,re,i1,x,x,x,x,x,x,x,x,x],[x,x,x,re,re,re,re,re,re,x,x,x,x,x,x],[x,x,x,re,re,re,Mn,re,Mn,x,x,x,x,x,x],[x,x,x,re,re,Mn,re,re,re,x,x,x,x,x,x],[x,x,x,x,x,x,Mn,re,Mn,x,x,x,x,x,x]],1,[0,2],[0,0]),[P4.of(new v(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),j.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Ei([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,re,re,i1,x,x,x,x,x,x],[x,x,x,re,re,i1,re,re,re,x,x,x,x,x,x],[x,x,x,re,i1,Mn,re,Mn,re,x,x,x,x,x,x],[x,x,x,re,Mn,i1,re,re,re,x,x,x,x,x,x],[x,x,x,re,re,Mn,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[ji.of(new v(7,6),new v(6,5)),ji.of(new v(7,6),new v(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}class vne extends jn{getListMoves(e,t){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=Kn.CENTRAL_ZONE_TOP_LEFT,i=Kn.CENTRAL_ZONE_BOTTOM_RIGHT;for(let o=n.y;o<=i.y;o++)for(let s=n.x;s<=i.x;s++)e.getPieceAtXY(s,o)===W.NONE&&t.push(y4.of(new v(s,o)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(const i of e.getCoordsAndContents())i.content===n&&(t=t.concat(this.getListSimpleMoves(e,i.coord)),t=t.concat(this.getListJumps(e,i.coord)));return t}getListSimpleMoves(e,t){const n=[],i=[new v(t.x+1,t.y),new v(t.x-1,t.y),new v(t.x,t.y+1),new v(t.x,t.y-1),new v(t.x+1,t.y+1),new v(t.x+1,t.y-1),new v(t.x-1,t.y+1),new v(t.x-1,t.y-1)].filter(o=>e.isOnBoard(o));for(const o of i){const s=M4.from(t,o);s.isSuccess()&&Os.get().simpleMoveLegality(s.get(),e).isSuccess()&&n.push(s.get())}return n}getListJumps(e,t){const n=new it;for(const i of Os.get().jumpTargetsFrom(e,t)){const o=la.from([t,i]).get();Os.get().jumpLegality(o,e).isSuccess()&&(n.add(o),n.addAll(this.getListJumpStartingFrom(e,o)))}return n.toList()}getListJumpStartingFrom(e,t){const n=Os.get().nextJumps(t,e),i=new it(n);for(const o of n)i.addAll(this.getListJumpStartingFrom(e,o));return i}}class lVe extends B1{getMetrics(e,t){const n=e.gameState,i=g1.of([0,0],[0,0]);for(const a of n.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer())if(n.isShelter(c))i.add(l,0,1);else{let f=n.getWidth()+n.getHeight();for(const d of Kn.ALL_SHELTERS)if(n.getPieceAt(d)===W.NONE){const m=c.getOrthogonalDistance(d);f=Math.min(f,m)}i.add(l,1,-f)}}return i}}class uVe extends vne{getListMoves(e,t){return this.sortByNumberOfJumps(super.getListMoves(e,t))}sortByNumberOfJumps(e){return e.sort((t,n)=>{const i=Mi.isDrop(t)?1:Mi.isSimple(t)?2:t.coords.length;return(Mi.isDrop(n)?1:Mi.isSimple(n)?2:n.coords.length)-i})}}class fVe extends cn{constructor(){super($localize`Jump`,Os.get(),new lVe,new uVe)}}function dVe(r,e){if(1&r){const t=ge();I(),P(0,"rect",9),q("click",function(){ee(t);const i=p().$implicit;return te(p(2).onClick(i.coord))}),S()}if(2&r){const t=p().$implicit,n=p(2);A("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function hVe(r,e){if(1&r){const t=ge();I(),P(0,"circle",6),q("click",function(){ee(t);const i=p().$implicit;return te(p(2).onClick(i.coord))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),y("ngClass",i.pieceClasses),A("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*n+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function gVe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",6),q("click",function(){const o=ee(t).$implicit;return te(p(2).onClick(o.coord))}),S(),O(2,dVe,1,4,"rect",7),O(3,hVe,1,6,"circle",8),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),A("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isShelter),_(1),y("ngIf",t.hasPieceToDraw)}}function pVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,gVe,4,9,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function mVe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",10),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),A("x",n.SPACE_SIZE*t.x+2.5*n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+2.5*n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function _Ve(r,e){if(1&r&&(I(),V(0,"circle",11)),2&r){const t=e.$implicit,n=p();hn("id","sidePiece_0_",t,""),A("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function vVe(r,e){if(1&r&&(I(),V(0,"circle",12)),2&r){const t=e.$implicit,n=p();hn("id","sidePiece_1_",t,""),A("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function CVe(r,e){if(1&r&&(I(),V(0,"rect",13)),2&r){const t=p();A("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let yVe=(()=>{var r;class e extends n3{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",Kn.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",Kn.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new Vt(Kn.CENTRAL_ZONE_BOTTOM_RIGHT.x-Kn.CENTRAL_ZONE_TOP_LEFT.x+1,Kn.CENTRAL_ZONE_BOTTOM_RIGHT.y-Kn.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.setRulesAndNode("Conspirateurs"),this.availableAIs=[new fVe,new bn($localize`MCTS`,new vne,this.rules)],this.encoder=Mi.encoder,this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH}updateBoard(n){var i=this;return M(function*(){i.updateViewInfo()})()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<n.getHeight();i++){this.viewInfo.boardInfo.push([]);for(let o=0;o<n.getWidth();o++){const s=new v(o,i),a=n.getPieceAt(s),c={coord:s,squareClasses:[],shelterClasses:["no-fill"],pieceClasses:[this.getPlayerClass(a)],hasPieceToDraw:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateSelected(),this.updateShelterHighlights()}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),o=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPieceToDraw=!1,this.viewInfo.boardInfo[o.y][o.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[o.y][o.x].hasPieceToDraw=!0;for(const s of n.coords)this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateShelterHighlights(){const n=this.getState(),i=Os.get().getGameStatus(this.node),o=!0===i.isEndGame;for(const s of Kn.ALL_SHELTERS){const a=this.viewInfo.boardInfo[s.y][s.x],c=n.getPieceAt(s),l=!1===o&&c.isPlayer();(o&&c===i.winner||l)&&(a.shelterClasses.push("selectable-stroke"),a.pieceClasses.push("victory-stroke"),a.squareClasses.push("victory-fill"))}}showLastMove(n){var i=this;return M(function*(){if(Mi.isDrop(n))i.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(Mi.isSimple(n))i.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),i.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{i.viewInfo.lastMoveArrow="";for(const o of n.coords)i.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill"),i.viewInfo.lastMoveArrow+=o.x*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" ",i.viewInfo.lastMoveArrow+=o.y*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" "}})()}cancelMoveAttempt(){var n=this;return M(function*(){n.jumpInConstruction=g.empty(),n.selected=g.empty(),yield n.updateBoard(!1)})()}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState(),a=s.getPieceAt(n);if(s.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?yield i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),w.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(s.isDropPhase()){const c=y4.of(n);return i.chooseMove(c)}return i.cancelMove(a===W.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}constructJump(n){var i=this;return M(function*(){const o=i.jumpInConstruction.get(),s=i.getState();if(n.equals(o.getEndingCoord()))return i.chooseMove(o);{const a=o.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),s);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return M(function*(){const o=i.getState();return i.rules.jumpHasPossibleNextTargets(n,o)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),w.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return M(function*(){const o=i.selected.get(),s=M4.from(o,n);if(s.isSuccess())return i.chooseMove(s.get());{const a=la.from([o,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-conspirateurs"]],features:[Ge],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke big-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","big-stroke"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,pVe,2,1,"g",1),O(2,mVe,2,5,"g",1),O(3,_Ve,1,4,"circle",2),O(4,vVe,1,4,"circle",3),O(5,CVe,1,4,"rect",4),V(6,"polyline",5),S()),2&n&&(_(1),y("ngForOf",i.viewInfo.boardInfo),_(1),y("ngForOf",i.ALL_SHELTERS),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),_(1),y("ngIf",i.viewInfo.dropPhase),_(1),A("points",i.viewInfo.lastMoveArrow))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),L0=(()=>{class r{}return u(r,"CANNOT_MOVE_WITH_BALL",()=>$localize`You cannot move the piece holding the ball.`),u(r,"MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE",()=>$localize`You must move by exactly one orthogonal space.`),u(r,"PASS_PATH_OBSTRUCTED",()=>$localize`The path of this pass is obstructed.`),u(r,"PASS_MUST_BE_IN_STRAIGHT_LINE",()=>$localize`A pass must be done in a straight line, orthogonally or diagonally.`),u(r,"CAN_ONLY_DO_ONE_PASS",()=>$localize`You can only perform one pass per turn.`),u(r,"CAN_ONLY_TRANSLATE_TWICE",()=>$localize`You can only perform two translations per turn, not three.`),u(r,"CANNOT_PASS_TO_OPPONENT",()=>$localize`You cannot pass the ball to the opponent. You must pick one of your pieces.`),r})();var Tu,bu;class bs extends n2{static from(e,t){return ve.factory.fromMove(e,t).isFailure()?Q.failure(L0.PASS_MUST_BE_IN_STRAIGHT_LINE()):Q.success(new bs(e,t))}constructor(e,t){super(e,t)}equals(e){return e instanceof bs&&super.equals(e)}}u(bs,"encoder",Ko.getFallibleEncoder(bs.from));class So extends n2{static from(e,t){return e.getVectorToward(t).isSingleOrthogonalStep()?Q.success(new So(e,t)):Q.failure(L0.MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE())}constructor(e,t){super(e,t)}equals(e){return e instanceof So&&super.equals(e)}}function lL(r){return r instanceof So}u(So,"encoder",Ko.getFallibleEncoder(So.from));class ws extends yo{static countPassesAndTranslations(e,t){e instanceof bs?t.passes++:t.translations++}constructor(e,t,n){super(),u(this,"first",void 0),u(this,"second",void 0),u(this,"third",void 0),this.first=e,this.second=t,this.third=n,n.isPresent()&&H.assert(t.isPresent(),"DiaballikMove should have two first actions to have a third one");const i={passes:0,translations:0};ws.countPassesAndTranslations(e,i),t.isPresent()&&ws.countPassesAndTranslations(t.get(),i),n.isPresent()&&ws.countPassesAndTranslations(n.get(),i),H.assert(i.passes<=1,"DiaballikMove should have at most one pass"),H.assert(i.translations<=2,"DiaballikMove should have at most two translations")}toString(){return`DiaballikMove(${this.first.toString()}, ${this.second.toString()}, ${this.third.toString()})`}equals(e){return!(!1===this.first.equals(e.first)||!1===this.second.equals(e.second)||!1===this.third.equals(e.third))}getSubMoves(){const e=[this.first];return this.second.isPresent()&&e.push(this.second.get()),this.third.isPresent()&&e.push(this.third.get()),e}}Tu=ws,u(ws,"subMoveEncoder",Ne.disjunction([lL,function MVe(r){return r instanceof bs}],[So.encoder,bs.encoder])),u(ws,"subMoveOptionalEncoder",g.getEncoder(Tu.subMoveEncoder)),u(ws,"encoder",Ne.tuple([Tu.subMoveEncoder,Tu.subMoveOptionalEncoder,Tu.subMoveOptionalEncoder],r=>[r.first,r.second,r.third],r=>new Tu(r[0],r[1],r[2])));class Zi{constructor(e,t){u(this,"owner",void 0),u(this,"holdsBall",void 0),this.owner=e,this.holdsBall=t}equals(e){return this===e}}u(Zi,"NONE",new(bu=Zi)(W.NONE,!1)),u(Zi,"ZERO",new bu(k.ZERO,!1)),u(Zi,"ZERO_WITH_BALL",new bu(k.ZERO,!0)),u(Zi,"ONE",new bu(k.ONE,!1)),u(Zi,"ONE_WITH_BALL",new bu(k.ONE,!0));class wu extends k1{equals(e){return wt.compare(this.board,e.board)}}class Mne{constructor(e){u(this,"winner",void 0),this.winner=e}}class uL extends Mne{constructor(e,t){super(e),u(this,"coord",void 0),this.coord=t}}class Ene extends Mne{constructor(e,t,n){super(e.getOpponent()),u(this,"allLoserPieces",void 0),u(this,"opponentPiecesInContact",void 0),this.allLoserPieces=t,this.opponentPiecesInContact=n}}class s2 extends Sr{static get(){return s2.singleton.isAbsent()&&(s2.singleton=g.of(new s2)),s2.singleton.get()}getInitialState(){const e=Zi.ZERO,n=Zi.ONE,o=Zi.NONE;return new wu([[n,n,n,Zi.ONE_WITH_BALL,n,n,n],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[e,e,e,Zi.ZERO_WITH_BALL,e,e,e]],0)}isLegal(e,t){let n=t;for(const i of e.getSubMoves()){const o=i.getStart();if(!1===t.isOnBoard(o))return Q.failure(Ps.OUT_OF_RANGE(o));const s=i.getEnd();if(!1===t.isOnBoard(s))return Q.failure(Ps.OUT_OF_RANGE(s));const a=this.isLegalSubMove(n,i);if(a.isFailure())return a;n=a.get()}return Q.success(n)}isLegalSubMove(e,t){return t instanceof So?this.isLegalTranslation(e,t):this.isLegalPass(e,t)}isLegalTranslation(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!0===i.holdsBall)return Q.failure(L0.CANNOT_MOVE_WITH_BALL());const o=t.getEnd();if(e.getPieceAt(o).owner.isPlayer())return Q.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const s=e.getCopiedBoard();s[n.y][n.x]=Zi.NONE,s[o.y][o.x]=i;const a=new wu(s,e.turn);return Q.success(a)}isLegalPass(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());H.assert(i.holdsBall,"DiaballikRules: cannot pass without the ball");const o=t.getEnd(),s=e.getPieceAt(o);if(s.owner===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.owner===e.getCurrentOpponent())return Q.failure(L0.CANNOT_PASS_TO_OPPONENT());const a=ve.factory.fromMove(n,o).get();for(let m=n.getNext(a);!1===m.equals(o);m=m.getNext(a))if(e.getPieceAt(m)!==Zi.NONE)return Q.failure(L0.PASS_PATH_OBSTRUCTED());const l=e.getCopiedBoard(),f=l[n.y][n.x];return l[n.y][n.x]=l[o.y][o.x],l[o.y][o.x]=f,Q.success(new wu(l,e.turn))}applyLegalMove(e,t,n,i){return new wu(i.board,t.turn+1)}getGameStatus(e){const n=this.getVictoryOrDefeatCoords(e.gameState);return n.isPresent()?_e.getVictory(n.get().winner):_e.ONGOING}getVictoryOrDefeatCoords(e){const t=this.getBallCoordInRow(e,0,k.ZERO);if(t.isPresent())return g.of(new uL(k.ZERO,t.get()));const n=this.getBallCoordInRow(e,e.getHeight()-1,k.ONE);return n.isPresent()?g.of(new uL(k.ONE,n.get())):this.getBlockerAndCoords(e)}getBallCoordInRow(e,t,n){for(let i=0;i<e.getHeight();i++){const o=e.getPieceAtXY(i,t);if(!0===o.holdsBall&&o.owner===n)return g.of(new v(i,t))}return g.empty()}getBlockerAndCoords(e){const t=[this.getBlockerCoords(e,k.ZERO),this.getBlockerCoords(e,k.ONE)];return t[0].isPresent()&&t[1].isPresent()?t[e.getCurrentPlayer().value]:t[0].isPresent()?t[0]:t[1].isPresent()?t[1]:g.empty()}getBlockerCoords(e,t){const n=new it,i=[];for(let o=0;o<e.getWidth();o++){const s=this.getConnectedPieceCoord(o,n,e,t);if(!s.isPresent())return g.empty();i.push(s.get())}return n.size()>=3?g.of(new Ene(t,i,n.toList())):g.empty()}getConnectedPieceCoord(e,t,n,i){for(let o=0;o<n.getHeight();o++){const s=new v(e,o);if(n.getPieceAt(s).owner===i)return this.isConnectedOnTheLeft(s,n,i)?(this.addConnectedOpponents(s,t,n,i),g.of(s)):g.empty()}return g.empty()}isConnectedOnTheLeft(e,t,n){if(0===e.x)return!0;for(const i of[ve.LEFT,ve.UP_LEFT,ve.DOWN_LEFT]){const o=e.getNext(i);if(t.isOnBoard(o)&&t.getPieceAt(o).owner===n)return!0}return!1}addConnectedOpponents(e,t,n,i){for(const o of Re.factory.all){const s=e.getNext(o);n.isOnBoard(s)&&n.getPieceAt(s).owner===i.getOpponent()&&t.add(s)}}}u(s2,"singleton",g.empty());class EVe extends B1{getMetrics(e,t){const n=e.gameState,i=new g1;for(const o of n.getCoordsAndContents()){const s=o.content;s.holdsBall&&(s.owner===k.ZERO?i.set(k.ZERO,[n.getHeight()-1-o.coord.y]):i.set(k.ONE,[o.coord.y]))}return i}}class Pne extends cn{constructor(e,t){super(e,s2.get(),new EVe,t)}}class Nu{static finalize(e){return e.finalize()}constructor(e,t,n){u(this,"subMoves",void 0),u(this,"stateBefore",void 0),u(this,"stateAfterSubMoves",void 0),u(this,"hasPass",void 0),u(this,"translations",void 0),this.subMoves=e,this.stateBefore=t,this.stateAfterSubMoves=n,H.assert(this.subMoves.length<=3,"DiaballikMoveInConstruction can have at most 3 submoves");let i=!1,o=0;for(const s of e)s instanceof bs?(H.assert(!1===i,"DiaballikMoveInConstruction can have at most one pass"),i=!0):(H.assert(o<2,"DiaballikMoveInConstruction can have at most two translations"),o++);this.hasPass=i,this.translations=o}equals(e){return Ct.equals(this.subMoves,e.subMoves)}addIfLegal(e,t){const n=s2.get().isLegalSubMove(this.stateAfterSubMoves,e);if(n.isSuccess()){const i=this.subMoves.concat([e]);this.sortIfNeeded(i);const o=new Nu(i,this.stateBefore,n.get());t.push(o)}}sortIfNeeded(e){const t=this.getFirstTranslationIndex(e);if(t.isAbsent())return;const n=t.get();if(n+1>=e.length||!1===lL(e[n+1]))return;const i=e[n],o=new it(i.getCoords()),s=e[n+1],a=new it(s.getCoords());o.intersection(a).size()>0||i.getStart().compareTo(s.getStart())>0&&(e[n]=s,e[n+1]=i)}getFirstTranslationIndex(e){for(let t=0;t<e.length;t++)if(lL(e[t]))return g.of(t);return g.empty()}getPassEnd(){for(const e of this.subMoves)if(e instanceof bs)return g.of(e.getEnd());return g.empty()}passPathContains(e){for(const t of this.subMoves)if(t instanceof bs)return t.getStart().getCoordsToward(t.getEnd()).some(i=>i.equals(e));return!1}getPreviousTranslation(){for(const e of this.subMoves)if(e instanceof So)return g.of(e);return g.empty()}hasOppositeTranslation(e,t){if(this.translations>0){const n=this.getPreviousTranslation().get();return n.getStart().equals(t)&&n.getEnd().equals(e)}return!1}finalize(){H.assert(this.subMoves.length>0,"DiaballikMoveInConstruction can only be finalized if it contains something");const e=this.subMoves[0];let t=g.empty();this.subMoves.length>1&&(t=g.of(this.subMoves[1]));let n=g.empty();this.subMoves.length>2&&(n=g.of(this.subMoves[2]));const i=new ws(e,t,n);return H.assert(s2.get().isLegal(i,this.stateBefore).isSuccess(),"DiaballikMoveGenerator should only generate legal moves"),i}}class CC extends jn{constructor(e=!0){super(),u(this,"avoidDuplicates",void 0),this.avoidDuplicates=e}getListMoves(e,t){let i=[new Nu([],e.gameState,e.gameState)];const o=new it;for(let s=0;s<3;s++){let a=[];for(const c of i){const l=this.addAllPossibleSubMoves(c);o.addAll(new it(l.map(Nu.finalize))),a=a.concat(l)}i=a}return this.removeDuplicates(e.gameState,o,t)}removeDuplicates(e,t,n){if(!1===this.avoidDuplicates)return t.toList();const i=new it,o=[],s=s2.get();for(const a of t){const c=s2.get().isLegal(a,e),l=s.applyLegalMove(a,e,n,c.get());!1===i.contains(l)&&(o.push(a),i.add(l))}return o}addAllPossibleSubMoves(e){const t=e.stateAfterSubMoves,n=t.getCurrentPlayer(),i=[];for(const o of t.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.owner===n)if(a.holdsBall&&!1===e.hasPass)for(const c of this.getPassEnds(t,o.coord)){const l=bs.from(s,c).get();e.addIfLegal(l,i)}else if(e.translations<2)for(const l of this.getTranslationEnds(t,o.coord))if(!1===e.hasOppositeTranslation(o.coord,l)||!1===this.avoidDuplicates){let d=!0;if(e.hasPass){const m=e.getPassEnd().equalsValue(s),E=e.passPathContains(l);d=m||E}if(d||!1===this.avoidDuplicates){const m=So.from(s,l).get();e.addIfLegal(m,i)}}}return i}getPassEnds(e,t){const n=e.getCurrentPlayer(),i=[];for(const o of ve.factory.all){let s=t.getNext(o);for(;e.isOnBoard(s);){const a=e.getPieceAt(s);if(a.owner===n){i.push(s);break}if(a.owner!==W.NONE)break;s=s.getNext(o)}}return i}getTranslationEnds(e,t){const n=[];for(const i of Re.factory.all){const o=t.getNext(i);e.isOnBoard(o)&&e.getPieceAt(o).owner===W.NONE&&n.push(o)}return n}}class Sne{constructor(e,t,n,i){u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.x1=e,this.y1=t,this.x2=n,this.y2=i}}class fL extends CC{constructor(e,t=!0){super(t),u(this,"moveLength",void 0),this.moveLength=e,H.assert(1<=e&&e<=3,"Diaballik moves should be of length [1,3]")}getListMoves(e,t){let i=[new Nu([],e.gameState,e.gameState)];for(let o=0;o<this.moveLength;o++){let s=[];for(const a of i)s=s.concat(this.addAllPossibleSubMoves(a));i=s}return i.map(Nu.finalize)}}function PVe(r,e){if(1&r&&(I(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),y("ngClass",s.getPieceClasses(n,o,i)),A("r",42)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function SVe(r,e){if(1&r&&(I(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","ball_",n,"_",o,""),y("ngClass",s.getBallClasses(n,o,i)),A("r",22)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function OVe(r,e){if(1&r){const t=ge();I(),P(0,"g",9),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",10),O(2,PVe,1,6,"circle",11),O(3,SVe,1,6,"circle",11),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),A("transform",o.getTranslationXY(n,i)),_(1),Ce("id","space_",n,"_",i,""),y("ngClass",o.getSpaceClasses(n,i)),A("x",0)("y",0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.owner.isPlayer()),_(1),y("ngIf",t.holdsBall)}}function TVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,OVe,4,12,"g",8),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function bVe(r,e){if(1&r&&(I(),V(0,"line",12)),2&r){const t=e.$implicit;A("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function wVe(r,e){if(1&r){const t=ge();I(),P(0,"rect",13),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","indicator_",t.x,"_",t.y,""),A("transform",n.getTranslation(t))("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function NVe(r,e){if(1&r&&(I(),P(0,"g")(1,"g",14),V(2,"rect",15)(3,"circle",16)(4,"rect",15)(5,"line",17),P(6,"text",18),rt(7),S()(),P(8,"g",19),V(9,"rect",15)(10,"circle",16)(11,"circle",16)(12,"rect",15)(13,"circle",16)(14,"line",17),P(15,"text",20),rt(16),S()()()),2&r){const t=p();_(1),A("transform",t.getTranslationXY(0,t.HEIGHT+.3)+" scale(0.5)"),_(1),A("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),A("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),A("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),A("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),_(1),A("x",2.3*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),_(1),gn(t.translationsMade),_(1),A("transform",t.getTranslationXY(t.WIDTH-1,t.HEIGHT+.3)+" scale(0.5)"),_(1),A("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),A("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),A("r",22)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),A("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),A("r",42)("cx",t.SPACE_SIZE+t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),A("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),_(1),A("x",-.6*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),_(1),gn(t.hasMadePass?1:0)}}function AVe(r,e){if(1&r){const t=ge();I(),P(0,"g",21),q("click",function(){return ee(t),te(p().done())}),V(1,"circle",22)(2,"polygon",23),S()}if(2&r){const t=p();A("transform",t.getTranslationXY(t.WIDTH/2,t.HEIGHT+.5)),_(1),A("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2.5)}}let IVe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"stateInConstruction",void 0),u(this,"WIDTH",void 0),u(this,"HEIGHT",void 0),u(this,"INDICATOR_SIZE",20),u(this,"victoryCoord",g.empty()),u(this,"loserCoords",[]),u(this,"blockedLines",[]),u(this,"indicators",[]),u(this,"currentSelection",g.empty()),u(this,"hasMadePass",!1),u(this,"translationsMade",0),u(this,"subMoves",[]),u(this,"highlightedBallCoords",[]),u(this,"highlightedPiecesCoords",[]),u(this,"moveGenerator",new CC(!1)),this.setRulesAndNode("Diaballik"),this.hasAsymmetricBoard=!0,this.WIDTH=this.getState().getWidth(),this.HEIGHT=this.getState().getHeight(),this.encoder=ws.encoder,this.availableAIs=[new Pne($localize`AllMoves`,new CC(!0)),new bn($localize`MCTS`,this.moveGenerator,this.rules),new bn($localize`MCTS (3 only)`,new fL(3,!1),this.rules),new bn($localize`MCTS (without dups)`,new CC(!0),this.rules),new bn($localize`MCTS (3, no dups)`,new fL(3,!1),this.rules)];for(let i=1;i<=3;i++)this.availableAIs.push(new Pne($localize`Distance (${i})`,new fL(i)))}updateBoard(n){var i=this;return M(function*(){const o=i.node.gameState;i.board=o.board,i.stateInConstruction=o;const s=i.rules.getVictoryOrDefeatCoords(o);if(i.victoryCoord=g.empty(),i.loserCoords=[],i.blockedLines=[],s.isPresent()){const a=s.get();if(a instanceof uL)i.victoryCoord=g.of(a.coord);else if(a instanceof Ene){i.loserCoords=a.allLoserPieces;const c=a.winner===k.ZERO?0:i.SPACE_SIZE;for(const l of a.opponentPiecesInContact){const f=l.x*i.SPACE_SIZE,d=l.y*i.SPACE_SIZE+c,m=new Sne(f,d,f+i.SPACE_SIZE,d);i.blockedLines.push(m)}}}})()}showLastMove(n){var i=this;return M(function*(){for(const o of n.getSubMoves())i.showSubMove(o)})()}showSubMove(n){n instanceof So?this.highlightedPiecesCoords.push(n.getStart(),n.getEnd()):(H.assert(n instanceof bs,"DiaballikMove can only be a translation or a pass"),this.highlightedBallCoords.push(n.getStart(),n.getEnd()))}hideLastMove(){this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}cancelMoveAttempt(){this.stateInConstruction=this.getState(),this.currentSelection=g.empty(),this.hasMadePass=!1,this.translationsMade=0,this.subMoves=[],this.indicators=[],this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}getSpaceClasses(n,i){const o=new v(n,i),s=[];return this.highlightedPiecesCoords.some(a=>a.equals(o))&&s.push("moved-fill"),this.highlightedBallCoords.some(a=>a.equals(o))&&s.push("moved-fill"),s}getPieceClasses(n,i,o){const s=new v(n,i),a=[this.getPlayerClass(o.owner)];return this.highlightedPiecesCoords.some(c=>c.equals(s))&&a.push("last-move-stroke"),!1===o.holdsBall&&this.currentSelection.equalsValue(new v(n,i))&&a.push("selected-stroke"),this.victoryCoord.equalsValue(s)&&a.push("victory-stroke"),this.loserCoords.some(c=>c.equals(s))&&a.push("defeat-stroke"),a}getBallClasses(n,i,o){const s=new v(n,i),a=[this.getPlayerClass(o.owner)];return this.highlightedBallCoords.some(c=>c.equals(s))&&a.push("last-move-stroke"),this.currentSelection.equalsValue(new v(n,i))&&a.push("selected-stroke"),a}addSubMove(n,i){var o=this;return M(function*(){if(o.currentSelection=g.empty(),o.indicators=[],o.subMoves.push(n),o.stateInConstruction=i,3===o.subMoves.length){const s=new ws(o.subMoves[0],g.of(o.subMoves[1]),g.of(o.subMoves[2]));return o.chooseMove(s)}return o.showSubMove(n),w.SUCCESS})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);return o.onLegalClick(a)})()}onLegalClick(n){const i=this.stateInConstruction.getPieceAt(n);if(0===this.subMoves.length&&this.hideLastMove(),this.currentSelection.isPresent()){const o=this.currentSelection.get();return o.equals(n)?(this.currentSelection=g.empty(),this.indicators=[],0===this.subMoves.length?this.cancelMove():w.SUCCESS):this.stateInConstruction.getPieceAt(o).holdsBall?this.performPass(o,n):this.performTranslation(o,n)}return i.owner===this.getCurrentPlayer()?this.hasMadePass&&i.holdsBall?this.cancelMove(L0.CAN_ONLY_DO_ONE_PASS()):2===this.translationsMade&&!1===i.holdsBall?this.cancelMove(L0.CAN_ONLY_TRANSLATE_TWICE()):(this.currentSelection=g.of(n),this.indicators=i.holdsBall?this.moveGenerator.getPassEnds(this.stateInConstruction,n):this.moveGenerator.getTranslationEnds(this.stateInConstruction,n),w.SUCCESS):this.cancelMove(i.owner===W.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}performPass(n,i){const o=bs.from(n,i);if(o.isSuccess()){const s=this.rules.isLegalPass(this.stateInConstruction,o.get());return s.isSuccess()?(this.hasMadePass=!0,this.addSubMove(o.get(),s.get())):this.cancelMove(s.getReason())}return this.cancelMove(o.getReason())}performTranslation(n,i){const o=So.from(n,i);if(o.isSuccess()){const s=this.rules.isLegalTranslation(this.stateInConstruction,o.get());return s.isSuccess()?(this.translationsMade++,this.addSubMove(o.get(),s.get())):this.cancelMove(s.getReason())}return this.cancelMove(o.getReason())}showDoneButton(){return this.interactive&&this.subMoves.length>=1}done(){var n=this;return M(function*(){const i=yield n.canUserPlay("#done");if(i.isFailure())return n.cancelMove(i.getReason());let o=g.empty();n.subMoves.length>=2&&(o=g.of(n.subMoves[1]));const s=new ws(n.subMoves[0],o,g.empty());return n.chooseMove(s)})()}getBoardRotation(){return`rotate(${180*this.getPointOfView().value} ${(this.getState().getWidth()*this.SPACE_SIZE+this.STROKE_WIDTH)/2} ${(this.getState().getHeight()*this.SPACE_SIZE+this.STROKE_WIDTH)/2})`}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-diaballik"]],features:[Ge],decls:10,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],[4,"ngFor","ngForOf"],["class","defeat-stroke normal-stroke",4,"ngFor","ngForOf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["id","done",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"defeat-stroke","normal-stroke"],[1,"indicator",3,"id","click"],["id","translationCountIndicator"],[1,"base"],[1,"base",3,"ngClass"],["marker-end","url(#arrowhead)",1,"arrow"],["id","translationCount",1,"base-no-stroke","text-giant"],["id","passCountIndicator"],["id","passCount",1,"base-no-stroke","text-giant"],["id","done",3,"click"],["fill","green",1,"base-no-fill","small-stroke"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","black",1,"base-no-fill","small-stroke"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),S()(),P(4,"g"),O(5,TVe,2,1,"g",3),O(6,bVe,1,4,"line",4),O(7,wVe,1,7,"rect",5),S(),O(8,NVe,17,50,"g",6),O(9,AVe,3,4,"g",7),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(4),A("transform",i.getBoardRotation()),_(1),y("ngForOf",i.stateInConstruction.board),_(1),y("ngForOf",i.blockedLines),_(1),y("ngForOf",i.indicators),_(1),y("ngIf",i.isInteractive()),_(1),y("ngIf",i.showDoneButton()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const fa=Zi.ZERO,One=Zi.ZERO_WITH_BALL,da=Zi.ONE,Tne=Zi.ONE_WITH_BALL,ot=Zi.NONE;class kVe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Diaballik is to bring your ball, represented by the small circle, into the home line of the opponent (i.e, its starting position). The ball is currently being held by your center piece.`,s2.get().getInitialState()),j.fromMove($localize`Translations`,$localize`During a turn, you are allowed up to three actions, including at most two translations. A translation is an orthogonal step of any piece that does not hold the ball.<br/><br/>Move your leftmost piece by one step. Once you are done, click on the green button that will appear on the bottom right of the board to indicate that you are done with your turn.`,s2.get().getInitialState(),[new ws(So.from(new v(0,6),new v(0,5)).get(),g.empty(),g.empty())],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Pass`,$localize`Another action that you are allowed to do at most once per turn is a pass. You can pass the ball by clicking on the piece that holds the ball, then on another one of your piece that can receive it. A pass must be made in a straight line along an unobstructed path.<br/><br/>Here, playing Dark, you can make two moves and a pass to win the game, do it!`,new wu([[da,da,da,Tne,ot,da,da],[ot,ot,ot,fa,ot,ot,ot],[ot,ot,ot,ot,ot,ot,ot],[ot,ot,ot,ot,ot,ot,ot],[One,ot,ot,da,ot,ot,ot],[ot,ot,ot,ot,ot,ot,ot],[ot,fa,fa,ot,fa,fa,fa]],0),[new ws(So.from(new v(3,1),new v(4,1)).get(),g.of(So.from(new v(4,1),new v(4,0)).get()),g.of(bs.from(new v(0,4),new v(4,0)).get()))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Blocking the opponent`,$localize`There is a special anti-game rule. If a player forms a contiguous line, with one piece in each column, they block the opponent from reaching their home line. If the opponent is in contact with three pieces in this case, they win instantaneously.<br/><br/>Here, playing Light, your opponent is blocking you and you already have two pieces in contact with their line. If you can connect a third piece, you win. Do it!`,new wu([[da,da,da,ot,ot,ot,ot],[da,ot,ot,ot,ot,ot,Tne],[ot,ot,ot,ot,ot,ot,ot],[ot,ot,ot,ot,ot,ot,ot],[fa,da,ot,ot,ot,ot,ot],[ot,fa,ot,da,ot,ot,ot],[ot,ot,fa,One,fa,fa,fa]],1),[new ws(So.from(new v(0,1),new v(0,2)).get(),g.of(So.from(new v(0,2),new v(0,3)).get()),g.empty())],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class bne extends jn{getListMoves(e,t){const n=e.gameState,i=this.getListDrops(n),o=this.getListShifts(n);return i.concat(o)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const o of[new qi(i,"clockwise"),new qi(i,"counterclockwise")])i3.get().shiftHeightValidity(o,e).isSuccess()&&t.push(o);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<tr.WIDTH;i++)for(const o of t){const s=new E4(i,o);i3.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of wn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<tr.HEIGHT;i++)for(let o=0;o<tr.WIDTH;o++)e.getPieceAtXY(o,i).owner===n&&t.push(new v(o,i));return t}}var dL;function xVe(r,e){if(1&r){const t=ge();I(),P(0,"g",6)(1,"path",7),q("click",function(){const o=ee(t).$implicit;return te(p().onSpaceClick(o))}),S(),P(2,"path",8),q("click",function(){const o=ee(t).$implicit;return te(p().onSpaceClick(o))}),S()()}if(2&r){const t=e.$implicit,n=p();hn("id","board_space_",t,""),_(1),hn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),A("d",n.BOARD_PATHS[t]),_(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),A("d",n.DECORATION_PATHS[t])}}function LVe(r,e){if(1&r){const t=ge();I(),P(0,"g",10),q("click",function(){const o=ee(t).$implicit,s=p().$implicit;return te(p().onPieceInGameClick(s,o.y))}),V(1,"use",11)(2,"use",12),S()}if(2&r){const t=e.$implicit;Ce("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),A("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),A("x",t.drawPosition.x)("y",t.drawPosition.y)}}function RVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,LVe,3,8,"g",9),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function zVe(r,e){if(1&r){const t=ge();I(),P(0,"g",14),q("click",function(){const i=ee(t),o=i.$implicit,s=i.index;return te(p(2).onRemainingPieceClick(o.actualPiece,s))}),V(1,"use",11)(2,"use",12),S()}if(2&r){const t=e.$implicit,n=e.index;Hr("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),A("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),A("x",t.drawPosition.x)("y",t.drawPosition.y)}}function DVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,zVe,3,9,"g",13),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const HVe=function(){return[0,1,2,3,4,5,6,7]},VVe=function(){return[2,1,3,0,4,7,5,6]};class s3 extends n3{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new Qt([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}])}),this.setRulesAndNode("Diam"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new Jx,new bne),new bn($localize`MCTS`,new bne,this.rules)],this.encoder=FHe}onSpaceClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return M(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new E4(e,n.piece);else if((n.position.x+1)%tr.WIDTH===e)i=new qi(n.position,"clockwise");else{if((n.position.x+(tr.WIDTH-1))%tr.WIDTH!==e)return t.cancelMove(F9.MUST_SHIFT_TO_NEIGHBOR());i=new qi(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(F9.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new v(e,t);return n.getState().getPieceAt(o).owner===n.getCurrentPlayer()?(n.isSelected(null,o)?yield n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:o}),n.updateViewInfo(),w.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}onRemainingPieceClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentOpponent()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),w.SUCCESS)})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return M(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),o=t.getStackHeight(e.getTarget()),s=this.getDrawPositionOnBoard(i,o),a=new v(i,o);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let o=t.getStackHeight(i);const s=[];for(let a=e.start.y;a<tr.HEIGHT&&t.getPieceAtXY(n,a)!==wn.EMPTY;a++,o++)s.push({start:g.of(new v(n,a)),end:new v(i,o),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,o)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<tr.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return M(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}showLastMoveOnSpaces(e){for(let t=0;t<tr.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Qt([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of wn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let o=0;o<i;o++){const s=[];this.isTopPieceOfReserveAndSelected(o,i,n)&&s.push("selected-stroke"),t&&o===i-1&&n.owner===e&&s.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(n,o),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===k.ZERO?-100:600,i=e.otherPieceType?100:450,new v(n,i).getNext(new Vt(0,-t*s3.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let o=0;o<tr.HEIGHT;o++){const s=this.getState().getPieceAtXY(e,o),a=new v(e,o);if(s!==wn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,o)&&c.push("selected-stroke"),this.isVictory(e,o,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+s.owner.value+(s.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:o,drawPosition:this.getDrawPositionOnBoard(e,o),actualPiece:s})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return s3.CENTER[e].getNext(new Vt(0,-t*s3.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return M(function*(){e.selected=g.empty(),yield e.updateBoard(!1)})()}}dL=s3,u(s3,"CENTER",[new v(40,160),new v(100,50),new v(255,2),new v(400,50),new v(460,160),new v(400,270),new v(255,320),new v(100,270)]),u(s3,"PIECE_HEIGHT",36),u(s3,"\u0275fac",function(e){return new(e||dL)(U(Ut))}),u(s3,"\u0275cmp",Fe({type:dL,selectors:[["app-diam"]],features:[Ge],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(I(),P(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),S()(),O(5,xVe,3,6,"g",4),O(6,RVe,2,1,"g",5),O(7,DVe,2,1,"g",5),S()),2&e&&(_(5),y("ngForOf",Q1(3,HVe)),_(1),y("ngForOf",Q1(4,VVe)),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Lt,Dt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class H2{static fromTwoCoords(e,t){const n=e.x,i=t.x,o=e.y,s=t.y,a=n+o,c=i+s;return n===i&&o!==s&&a!==c?g.of(H2.constantQ(n)):n!==i&&o===s&&a!==c?g.of(H2.constantR(o)):n!==i&&o!==s&&a===c?g.of(H2.constantS(a)):g.empty()}static constantQ(e){return new H2(e,"q")}static constantR(e){return new H2(e,"r")}static constantS(e){return new H2(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=H2.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return Ae.DOWN;case"r":return Ae.RIGHT;case"s":return Ae.DOWN_LEFT}}}class hL extends k1{constructor(e,t,n,i,o,s){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=o,this.empty=s,nn(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(H2.constantQ(t));for(let t=0;t<this.height;t++)e.push(H2.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(H2.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new v(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new v(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new v(e.offset,0):new v(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const o=vi.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(o.getReason())}}class Pi{static getNeighbors(e,t=1){const n=[];for(const i of Ae.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of Ae.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var R0;class m1{static append(e,t){return new m1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}R0=m1,u(m1,"encoder",Ne.tuple([Ne.identity(),k.encoder,Ne.identity()],r=>[r.source,r.owner,r.size],r=>new R0(r[1],r[2],r[0]))),u(m1,"MAX_SIZE",49),u(m1,"EMPTY",new R0(W.NONE,0,!1)),u(m1,"UNREACHABLE",new R0(W.NONE,-1,!1)),u(m1,"PLAYER_ZERO",new R0(k.ZERO,1,!1)),u(m1,"PLAYER_ONE",new R0(k.ONE,1,!1)),u(m1,"SOURCE",new R0(W.NONE,1,!0));let ha=(()=>{class r extends hL{static balancedBoard(){const t=m1.UNREACHABLE,n=m1.PLAYER_ZERO,i=m1.PLAYER_ONE,o=m1.SOURCE;return[[t,t,n,i,i,i,n,n,i,o,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,o,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,o,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==m1.UNREACHABLE}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,m1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const o=new v(i,n);this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()&&t.push(o)}return t}numberOfNeighbors(t){return Pi.getNeighbors(t,1).filter(o=>this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()).length}setAtUnsafe(t,n){const i=wt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==m1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),z0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var gL;class lr extends n2{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?Q.success(lr.PASS):!1===ha.isOnBoard(e)?Q.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===ha.isOnBoard(t)?Q.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?Q.success(new lr(e,t)):Q.failure(z0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===lr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(lr,"PASS",new(gL=lr)(new v(-1,-1),new v(-2,-2))),u(lr,"encoder",Ko.getFallibleEncoder(gL.from));class Nr extends Sr{static get(){return Nr.singleton.isAbsent()&&(Nr.singleton=g.of(new Nr)),Nr.singleton.get()}getInitialState(){return new ha(ha.balancedBoard(),0,!1)}static getGameStatus(e){const t=e.gameState,n=Nr.getScores(t);return 0===Nr.getMovablePieces(t).length?n[0]>n[1]?_e.ZERO_WON:n[0]<n[1]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static getMovablePieces(e){return Nr.getFreePieces(e).filter(t=>Nr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==Pi.getNeighbors(t,n).find(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return Pi.getNeighbors(t,n).filter(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const o=e.getPieceAt(i);o.belongsTo(k.ZERO)?t+=o.getSize():o.belongsTo(k.ONE)&&(n+=o.getSize())}),[t,n]}isMovablePiece(e,t){H.assert(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?w.failure(z0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?w.failure(z0.NOT_PLAYER_PIECE()):6<=e.numberOfNeighbors(t)?w.failure(z0.TOO_MANY_NEIGHBORS()):!1===Nr.pieceHasTarget(e,t)?w.failure(z0.CANT_REACH_TARGET()):w.SUCCESS}canOnlyPass(e){return 0===Nr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){Pi.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=wt.create(ha.WIDTH,ha.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,m1.EMPTY))}),n}applyLegalMove(e,t,n,i){if(e===lr.PASS)return new ha(t.board,t.turn+1,!0);{const o=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),a=t.setAt(e.getStart(),m1.EMPTY).setAt(e.getEnd(),m1.append(o,s));return this.removeDisconnectedPieces(new ha(a.board,t.turn+1,!1))}}isLegal(e,t,n){if(0===Nr.getMovablePieces(t).length)return e===lr.PASS&&!1===t.alreadyPassed?w.SUCCESS:w.failure(Ee.MUST_PASS());if(e===lr.PASS)return w.failure(Ee.CANNOT_PASS());const i=this.isMovablePiece(t,e.getStart());if(i.isFailure())return i;const o=t.getPieceAt(e.getStart());return e.length()!==o.getSize()?Q.failure(z0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?Q.failure(z0.EMPTY_TARGET_STACK()):Q.success(void 0)}getGameStatus(e){return Nr.getGameStatus(e)}}u(Nr,"singleton",g.empty());const oe=m1.EMPTY,nr=m1.UNREACHABLE,Fl=m1.SOURCE,Au=m1.PLAYER_ZERO,Iu=m1.PLAYER_ONE,FVe=new m1(k.ZERO,2,!1),pL=new m1(k.ONE,2,!1),wne=new m1(k.ZERO,4,!1),$Ve=new m1(k.ONE,4,!1);class GVe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Nr.get().getInitialState(),lr.from(new v(2,0),new v(3,0)).get(),$localize`Congratulations!`),j.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new ha([[nr,nr,Iu,Fl,oe,oe,oe,oe,oe,oe,oe],[nr,oe,Au,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,$Ve,oe,oe,oe,oe,Iu,Fl,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,nr],[oe,oe,oe,oe,oe,oe,oe,oe,oe,nr,nr]],0,!1),lr.from(new v(2,1),new v(2,0)).get(),(t,n,i)=>t.getEnd().equals(new v(3,0))?w.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(nn(t.getEnd().equals(new v(2,0)),"player made an impossible move"),w.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),j.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new ha([[nr,nr,Fl,Iu,oe,oe,oe,oe,oe,oe,oe],[nr,Au,Au,oe,oe,oe,oe,oe,oe,oe,oe],[oe,Iu,Au,Iu,oe,oe,Au,pL,Fl,oe,oe],[oe,oe,Iu,oe,oe,oe,oe,oe,oe,oe,nr],[oe,oe,oe,oe,oe,oe,oe,oe,oe,nr,nr]],0,!1),lr.from(new v(2,1),new v(2,0)).get(),(t,n,i)=>t.getEnd().equals(new v(2,0))?w.SUCCESS:w.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),j.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new ha([[nr,nr,Fl,oe,oe,oe,oe,oe,oe,oe,oe],[nr,oe,FVe,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,pL,oe,oe,oe,oe,pL,Fl,wne,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,nr],[oe,oe,oe,oe,oe,oe,oe,oe,oe,nr,nr]],0,!1)),j.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new ha([[nr,nr,Fl,oe,oe,oe,oe,oe,oe,oe,oe],[nr,oe,Au,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe,Fl,wne,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,nr],[oe,oe,oe,oe,oe,oe,oe,oe,oe,nr,nr]],0,!1),[lr.from(new v(2,1),new v(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class BVe extends B1{getMetrics(e,t){const n=Nr.getScores(e.gameState);return g1.of([n[0]],[n[1]])}}class Nne extends jn{getListMoves(e,t){const n=e.previousMove,i=e.gameState,o=[];return Nr.getMovablePieces(i).forEach(s=>Nr.pieceTargets(i,s).forEach(a=>{const c=lr.from(s,a).get();o.push(c)})),0===o.length&&!1===n.equalsValue(lr.PASS)&&o.push(lr.PASS),o}}class Ane extends Nne{getListMoves(e,t){const n=e.gameState,i=super.getListMoves(e,t),o=n.getCurrentOpponent();return Ct.sortByDescending(i,s=>{nn(s!==lr.PASS,"Cannot sort with DvonnMove.PASS");const a=n.getPieceAt(s.getEnd());return a.belongsTo(o)?a.getSize():0}),i}}class UVe extends B1{getMetrics(e,t){const n=e.gameState,i=Nr.getScores(n),o=new g1,s=n.getAllPieces(),a=s.length;for(const c of k.PLAYERS){const l=s.filter(f=>n.getPieceAt(f).belongsTo(c)).length;o.set(c,[i[c.value]*l/a])}return o}}function WVe(r,e){if(1&r&&(I(),V(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),A("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function qVe(r,e){if(1&r&&(I(),V(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();A("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function jVe(r,e){if(1&r){const t=ge();I(),P(0,"text",13),q("click",function(){ee(t);const i=p(2).$implicit;return te(p().onClick(i.x,i.y))}),rt(1),S()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();A("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),_(1),gn(t.getSize())}}function ZVe(r,e){if(1&r){const t=ge();I(),P(0,"g",6),q("click",function(){ee(t);const i=p().$implicit;return te(p().onClick(i.x,i.y))}),V(1,"polygon",7),O(2,WVe,1,6,"circle",8),O(3,qVe,1,1,"polygon",9),O(4,jVe,2,3,"text",10),S()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","click_",n.x,"_",n.y,""),_(1),A("points",i.getHexaPointsAt(n)),_(1),y("ngIf",t.getSize()>0),_(1),y("ngIf",t.containsSource()),_(1),y("ngIf",t.getSize()>1)}}const YVe=function(r){return[r]};function KVe(r,e){if(1&r&&(I(),P(0,"g"),O(1,ZVe,5,6,"g",5),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",Ra(1,YVe,n.state.getPieceAt(t)))}}function XVe(r,e){if(1&r&&(I(),P(0,"text",18),rt(1),S()),2&r){const t=p().$implicit,n=p();A("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),_(1),gn(t.spaceContent.getSize())}}function QVe(r,e){if(1&r&&(I(),P(0,"g",14),V(1,"polygon",15)(2,"circle",16),O(3,XVe,2,3,"text",17),S()),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.coord.x,"_",t.coord.y,""),_(1),A("points",n.getHexaPointsAt(t.coord)),_(1),Ce("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),A("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),_(1),y("ngIf",t.spaceContent.getSize()>1)}}function JVe(r,e){if(1&r&&(I(),qt(0),V(1,"polygon",19)(2,"polygon",19),jt()),2&r){const t=p();_(1),A("points",t.getHexaPointsAt(t.lastMove.get().getStart())),_(1),A("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function eFe(r,e){if(1&r&&(I(),V(0,"polygon",20)),2&r){const t=p();Ce("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),A("points",t.getHexaPointsAt(t.chosen.get()))}}let tFe=(()=>{var r;class e extends Cu{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.setRulesAndNode("Dvonn"),this.availableAIs=[new cn($localize`Stacks`,this.rules,new UVe,new Ane),new cn($localize`Score`,this.rules,new BVe,new Ane),new bn($localize`MCTS`,new Nne,this.rules)],this.encoder=lr.encoder,this.scores=g.of(Nr.getScores(this.getState())),this.SPACE_SIZE=30,this.hexaLayout=new yu(1.5*this.SPACE_SIZE,new v(-this.SPACE_SIZE,2*this.SPACE_SIZE),fC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.state=i.getState(),i.disconnecteds=[],i.hideLastMove(),i.canPass=i.rules.canOnlyPass(i.state),i.scores=g.of(Nr.getScores(i.state))})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=g.of(n);const o=i.getPreviousState(),s=i.getState();for(let a=0;a<s.getHeight();a++)for(let c=0;c<s.board[a].length;c++){const l=new v(c,a);if(!0===s.isOnBoard(l)&&!1===l.equals(i.lastMove.get().getStart())){const f=s.getPieceAt(l),d=o.getPieceAt(l);if(f.isEmpty()&&d.hasPieces()){const E={coord:new v(c,a),spaceContent:d};i.disconnecteds.push(E)}}}})()}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return M(function*(){return nn(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(lr.PASS)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.chosen.isAbsent()?o.choosePiece(n,i):o.chosen.equalsValue(new v(n,i))?(o.cancelMoveAttempt(),w.SUCCESS):yield o.chooseDestination(n,i)})()}choosePiece(n,i){var o=this;return M(function*(){const s=new v(n,i),a=o.rules.isMovablePiece(o.getState(),s);return a.isSuccess()?(o.chosen=g.of(s),w.SUCCESS):o.cancelMove(a.getReason())})()}chooseDestination(n,i){var o=this;return M(function*(){const s=o.getState(),a=o.chosen.get(),c=new v(n,i),l=lr.from(a,c);return l.isFailure()?o.rules.isMovablePiece(s,c).isSuccess()?o.choosePiece(n,i):o.cancelMove(l.getReason()):o.rules.isLegal(l.get(),s,o.config).isFailure()&&o.rules.isMovablePiece(s,c).isSuccess()?o.choosePiece(n,i):o.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-dvonn"]],features:[Ge],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,KVe,2,3,"g",1),O(2,QVe,4,10,"g",2),O(3,JVe,3,2,"ng-container",3),O(4,eFe,1,3,"polygon",4),S()),2&n&&(_(1),y("ngForOf",i.state.allCoords()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.lastMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var S4,Ine,L1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(L1||{});class We{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===k.ZERO&&e===L1.BIG?We.BIG_DARK:t===k.ZERO&&e===L1.MEDIUM?We.MEDIUM_DARK:t===k.ZERO&&e===L1.SMALL?We.SMALL_DARK:t===k.ONE&&e===L1.BIG?We.BIG_LIGHT:t===k.ONE&&e===L1.MEDIUM?We.MEDIUM_LIGHT:t===k.ONE&&e===L1.SMALL?We.SMALL_LIGHT:We.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case We.SMALL_DARK:case We.MEDIUM_DARK:case We.BIG_DARK:return k.ZERO;case We.SMALL_LIGHT:case We.MEDIUM_LIGHT:case We.BIG_LIGHT:return k.ONE;default:return W.NONE}}getSize(){switch(this){case We.BIG_DARK:case We.BIG_LIGHT:return L1.BIG;case We.MEDIUM_DARK:case We.MEDIUM_LIGHT:return L1.MEDIUM;case We.SMALL_DARK:case We.SMALL_LIGHT:return L1.SMALL;default:return H.expectToBe(this,We.NONE),L1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case We.BIG_DARK:return"BIG_DARK";case We.BIG_LIGHT:return"BIG_LIGHT";case We.MEDIUM_DARK:return"MEDIUM_DARK";case We.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case We.SMALL_DARK:return"SMALL_DARK";case We.SMALL_LIGHT:return"SMALL_LIGHT";default:return H.expectToBe(this,We.NONE),"EMPTY"}}}S4=We,u(We,"encoder",Ne.tuple([Ne.identity()],r=>[r.value],r=>S4.of(r[0]))),u(We,"SMALL_DARK",new S4(0)),u(We,"SMALL_LIGHT",new S4(1)),u(We,"MEDIUM_DARK",new S4(2)),u(We,"MEDIUM_LIGHT",new S4(3)),u(We,"BIG_DARK",new S4(4)),u(We,"BIG_LIGHT",new S4(5)),u(We,"NONE",new S4(6));class Si extends yo{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return H.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new Si(g.of(e),t,g.empty())}static ofDrop(e,t){return new Si(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Ine=Si,u(Si,"encoder",Ne.tuple([g.getEncoder(v.encoder),v.encoder,g.getEncoder(We.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new Ine(r[0],r[1],r[2])));let B9=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();class U9 extends k1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPieces(){return Ct.copy(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class Yi{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===W.NONE&&this.medium===W.NONE&&this.big===W.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(We.ofSizeAndPlayer(L1.SMALL,this.small)),this.medium.isPlayer()&&e.push(We.ofSizeAndPlayer(L1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(We.ofSizeAndPlayer(L1.BIG,this.big)),e}toOrderedPieceNames(){const e=We.ofSizeAndPlayer(L1.SMALL,this.small),t=We.ofSizeAndPlayer(L1.MEDIUM,this.medium),n=We.ofSizeAndPlayer(L1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===k.ZERO?We.BIG_DARK:this.big===k.ONE?We.BIG_LIGHT:this.medium===k.ZERO?We.MEDIUM_DARK:this.medium===k.ONE?We.MEDIUM_LIGHT:this.small===k.ZERO?We.SMALL_DARK:this.small===k.ONE?We.SMALL_LIGHT:We.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===We.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===We.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case L1.BIG:t=new Yi(this.small,this.medium,W.NONE);break;case L1.MEDIUM:t=new Yi(this.small,W.NONE,W.NONE);break;default:H.expectToBe(n,L1.SMALL),t=new Yi(W.NONE,W.NONE,W.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===We.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case L1.BIG:return new Yi(this.small,this.medium,t);case L1.MEDIUM:return nn(this.big===W.NONE,"Cannot put a piece on top of a bigger one"),new Yi(this.small,t,this.big);default:return H.expectToBe(n,L1.SMALL),nn(this.big===W.NONE,"Cannot put a piece on top of a bigger one"),nn(this.medium===W.NONE,"Cannot put a piece on top of a bigger one"),new Yi(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}var W9,Qa;u(Yi,"EMPTY",new Yi(W.NONE,W.NONE,W.NONE));let ku=(W9=class extends Sr{static get(){return Qa.singleton.isAbsent()&&(Qa.singleton=g.of(new Qa)),Qa.singleton.get()}getInitialState(){const e=new Yi(W.NONE,W.NONE,W.NONE),t=wt.create(3,3,e);return new U9(t,0,[We.BIG_DARK,We.BIG_DARK,We.BIG_LIGHT,We.BIG_LIGHT,We.MEDIUM_DARK,We.MEDIUM_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.SMALL_DARK,We.SMALL_DARK,We.SMALL_LIGHT,We.SMALL_LIGHT])}static isVictory(e){const t=e.getCopiedBoard();for(const n of Qa.LINES){const o=Qa.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(o.isPresent())return o}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===W.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){n=e.piece.get();const s=n.getPlayer();if(s===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.isInRemainingPieces(n))return Q.failure(B9.PIECE_OUT_OF_STOCK())}else{const s=e.startingCoord.get();n=t.getPieceAt(s).getBiggest();const c=n.getPlayer();if(c===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(c===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}const o=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return o.isPresent()?Q.success(o.get()):Q.failure(B9.INVALID_PLACEMENT())}isLegal(e,t){return Qa.isLegal(e,t)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();let s=t.getRemainingPieces();const a=t.turn+1;let c;if(o[e.landingCoord.y][e.landingCoord.x]=i,e.isDropping()){c=e.piece.get();const f=s.indexOf(c);s=s.slice(0,f).concat(s.slice(f+1))}else{const f=e.startingCoord.get(),m=o[f.y][f.x].removeBiggest();o[f.y][f.x]=m.removedSpace,c=m.removedPiece}return new U9(o,a,s)}static getGameStatus(e){const n=Qa.isVictory(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getGameStatus(e){return Qa.getGameStatus(e)}},Qa=W9,u(W9,"singleton",g.empty()),u(W9,"LINES",[[new v(0,0),new v(0,1),new v(0,2)],[new v(1,0),new v(1,1),new v(1,2)],[new v(2,0),new v(2,1),new v(2,2)],[new v(0,0),new v(1,0),new v(2,0)],[new v(0,1),new v(1,1),new v(2,1)],[new v(0,2),new v(1,2),new v(2,2)],[new v(0,0),new v(1,1),new v(2,2)],[new v(0,2),new v(1,1),new v(2,0)]]),W9);ku=Qa=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ku);class xne extends jn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCopiedBoard(),s=i.getCurrentPlayer(),a=bte.toComparableObjectSet(i.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let l=0;l<3;l++){const f=new v(l,c);for(const d of a){const m=Si.ofDrop(d,f);ku.isLegal(m,i).isSuccess()&&n.push(m)}if(o[c][l].belongsTo(s))for(let d=0;d<3;d++)for(let m=0;m<3;m++){const E=new v(m,d);if(!1===E.equals(f)){const T=Si.ofMove(f,E);ku.isLegal(T,i).isSuccess()&&n.push(T)}}}return n}}function rFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"circle",5),q("click",function(){const i=ee(t),o=i.$implicit,s=i.index,a=p().$implicit;return te(p().onPieceClick(a.value,o,s))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p();_(1),Hr("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",o.getSidePieceClasses(t,n)),A("transform","rotate("+180*(o.getPointOfView().value+i.value)+" "+o.CENTER+" "+o.CENTER+")")("r",o.getPieceRadius(t))("cx",o.getRemainingPieceCenterCoord(i,n).x)("cy",o.getRemainingPieceCenterCoord(i,n).y)}}function iFe(r,e){if(1&r&&(I(),P(0,"g",null,4),O(2,rFe,2,8,"g",1),S()),2&r){const t=e.$implicit,n=p();_(2),y("ngForOf",n.getRemainingPieces(t))}}function oFe(r,e){if(1&r){const t=ge();I(),P(0,"circle",8),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().onBoardClick(i,o))}),S()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,o=p();y("ngClass",o.getPieceClasses(t)),A("r",o.getPieceRadius(t))("cx",o.getPieceCenter(n))("cy",o.getPieceCenter(i))}}function sFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",6),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onBoardClick(o,s))}),S(),O(2,oFe,1,4,"circle",7),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),y("ngClass",o.getRectClasses(n,i)),A("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngForOf",o.getListPieces(t))}}function aFe(r,e){if(1&r&&(I(),P(0,"g"),O(1,sFe,3,8,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function cFe(r,e){if(1&r){const t=ge();I(),P(0,"rect",9),q("click",function(){ee(t);const i=p();return te(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),S()}if(2&r){const t=p();Ce("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),A("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let lFe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new Qt),this.setRulesAndNode("Encapsule"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new Jx,new xne),new bn($localize`MCTS`,new xne,this.rules)],this.encoder=Si.encoder}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard();const s=i.node.previousMove;i.calculateLeftPieceCoords(),s.isPresent()?(i.lastLandingCoord=g.of(s.get().landingCoord),i.lastStartingCoord=s.get().startingCoord):(i.lastLandingCoord=g.empty(),i.lastStartingCoord=g.empty())})()}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i),c=o.getState();if(o.chosenCoord.isAbsent()){if(o.chosenCoord=g.of(a),o.chosenPiece.isPresent()){const l=Si.ofDrop(o.chosenPiece.get(),a);return o.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?o.cancelMove(B9.INVALID_PIECE_SELECTED()):w.SUCCESS}if(o.chosenCoord.equalsValue(a))return o.cancelMoveAttempt(),w.SUCCESS;{const l=Si.ofMove(o.chosenCoord.get(),a);return o.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,o){var s=this;return M(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+o,c=yield s.canUserPlay(a);return c.isFailure()?s.cancelMove(c.getReason()):!1===s.getState().isDroppable(i)?s.cancelMove(B9.NOT_DROPPABLE()):s.chosenCoord.isAbsent()?(s.chosenPiece.equalsValue(i)&&s.chosenPieceIndex.equalsValue(o)?(s.chosenPiece=g.empty(),s.chosenPieceIndex=g.empty()):(s.chosenPiece=g.of(i),s.chosenPieceIndex=g.of(o)),w.SUCCESS):s.cancelMove(B9.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const o=new v(n,i);return!(!this.lastStartingCoord.equalsValue(o)&&!this.lastLandingCoord.equalsValue(o))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return nn(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case L1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case L1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return H.expectToBe(n.getSize(),L1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const o=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&o.push("selected-stroke"),o}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Qt;for(const n of k.PLAYERS){const i=[],o=this.getRemainingPieces(n);for(let s=0;s<o.length;s++){let a,c=0,l=0;s<=2?(a=new v(2-s,3),l=this.STROKE_WIDTH):(a=new v(-1,5-s),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new v(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-encapsule"]],features:[Ge],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,iFe,3,1,"g",1),P(2,"g",null,2),O(4,aFe,2,1,"g",1),O(5,cFe,1,6,"rect",3),S()()),2&n&&(A("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),_(1),y("ngForOf",i.Player.PLAYERS),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const Ns=new Yi(W.NONE,W.NONE,W.NONE),Lne=new Yi(k.ZERO,W.NONE,W.NONE),uFe=new Yi(W.NONE,k.ZERO,W.NONE),fFe=new Yi(W.NONE,W.NONE,k.ZERO),Rne=new Yi(k.ONE,W.NONE,W.NONE),yC=new Yi(W.NONE,W.NONE,k.ONE),dFe=new Yi(k.ONE,k.ZERO,W.NONE),hFe=new Yi(k.ZERO,k.ZERO,W.NONE);class gFe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new U9([[Lne,Rne,yC],[Ns,uFe,Ns],[Ns,Ns,fFe]],0,[We.SMALL_DARK,We.MEDIUM_DARK,We.BIG_DARK,We.SMALL_LIGHT,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.BIG_LIGHT])),j.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,ku.get().getInitialState(),Si.ofDrop(We.SMALL_DARK,new v(1,1)),$localize`Congratulations!`),j.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new U9([[Lne,yC,Ns],[Ns,Ns,Ns],[Ns,Ns,Ns]],0,[]),[Si.ofMove(new v(0,0),new v(2,0)),Si.ofMove(new v(0,0),new v(0,1)),Si.ofMove(new v(0,0),new v(1,1)),Si.ofMove(new v(0,0),new v(2,1)),Si.ofMove(new v(0,0),new v(0,2)),Si.ofMove(new v(0,0),new v(1,2)),Si.ofMove(new v(0,0),new v(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new U9([[dFe,Ns,Rne],[hFe,yC,yC],[Ns,Ns,Ns]],0,[We.MEDIUM_DARK,We.BIG_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT]),Si.ofMove(new v(0,1),new v(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new v(0,2))){if(t.isDropping())return w.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new v(0,1)))return w.SUCCESS}return w.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}var zne;class ga extends Or{constructor(e,t,n,i,o){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=o,H.assert(n>0,"Must select minimum one piece (got "+n+")."),H.assert(i>0,"Step size must be minimum one (got "+i+")."),H.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}zne=ga,u(ga,"encoder",Ne.tuple([v.encoder,Ne.identity(),Ne.identity(),ve.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new zne(r[0].x,r[0].y,r[1],r[2],r[3])));class q9 extends k1{countRow(e,t){let n=0;for(let i=0;i<this.getWidth();i++)this.board[t][i]===e&&n++;return n}count(e){let t=0;for(const n of this.getCoordsAndContents())n.content===e&&t++;return t}doesOwnPiece(e){for(const t of this.getCoordsAndContents())if(t.content===e)return!0;return!1}}let pa=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class qr extends ja{static get(){return qr.singleton.isAbsent()&&(qr.singleton=g.of(new qr)),qr.singleton.get()}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return Q.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const o=wt.copy(i.get()),s=t.getCurrentOpponent(),a=qr.getCaptureValidity(t,o,e,s);return a.isFailure()?a:Q.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord;if(!1===e.isOnBoard(n))return w.failure(Ps.OUT_OF_RANGE(n));let i=0;const o=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===e.isOnBoard(n))return w.failure(pa.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=e.getPieceAt(n);if(s===W.NONE)return w.failure(pa.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===o)return w.failure(pa.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return w.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let o=t.coord,s=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[o.y][o.x]=W.NONE,n[s.y][s.x]=i,!1===e.isOnBoard(s))return Q.failure(pa.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(s).isPlayer())return Q.failure(pa.SOMETHING_IN_PHALANX_WAY());a++,s=s.getNext(t.direction,1),o=o.getNext(t.direction,1)}return!1===e.isOnBoard(s)?Q.failure(pa.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(s)===i?Q.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[o.y][o.x]=W.NONE,n[s.y][s.x]=i,Q.success(n))}static getCaptureValidity(e,t,n,i){let o=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;e.isOnBoard(o)&&e.getPieceAt(o)===i;){if(s>0&&(t[o.y][o.x]=W.NONE),s++,n.movedPieces<=s)return Q.failure(pa.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());o=o.getNext(n.direction,1)}return Q.success(t)}getInitialState(e){const t=e.get(),n=W.NONE,i=W.ZERO,s=wt.create(t.width,t.rowsOfSoldiers,W.ONE),a=wt.create(t.width,t.emptyRows,n),c=wt.create(t.width,t.rowsOfSoldiers,i),l=s.concat(a).concat(c);return new q9(l,0)}getRulesConfigDescription(){return g.of(qr.RULES_CONFIG_DESCRIPTION)}isLegal(e,t){return qr.isLegal(e,t)}applyLegalMove(e,t,n,i){return new q9(i,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.countRow(k.ZERO,0),i=t.getHeight(),o=t.countRow(k.ONE,i-1);if(t.turn%2==0){if(n>o)return _e.ZERO_WON}else if(o>n)return _e.ONE_WON;return!1===t.doesOwnPiece(k.ZERO)?_e.ONE_WON:!1===t.doesOwnPiece(k.ONE)?_e.ZERO_WON:_e.ONGOING}}u(qr,"singleton",g.empty()),u(qr,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Epaminondas`,config:{width:new br(14,Ss.WIDTH,Tr.range(1,99)),emptyRows:new br(8,()=>$localize`Number of empty rows`,Tr.range(1,99)),rowsOfSoldiers:new br(2,()=>$localize`Number of soldier rows`,Tr.range(1,99))}}));class Dne extends jn{getListMoves(e,t){const n=e.gameState.getCurrentPlayer(),i=e.gameState.getCurrentOpponent(),o=W.NONE;let s=[];const a=e.gameState;for(const c of a.getCoordsAndContents()){const l=c.coord;if(c.content===n){let f;for(const d of ve.DIRECTIONS){let m=1,E=l.getNext(d,1);for(;a.isOnBoard(E)&&a.getPieceAt(E)===n;)m+=1,E=E.getNext(d,1);let T=1;for(;a.isOnBoard(E)&&T<=m&&a.getPieceAt(E)===o;)f=new ga(l.x,l.y,m,T,d),s=this.addMove(s,f,a),T++,E=E.getNext(d,1);a.isOnBoard(E)&&T<=m&&a.getPieceAt(E)===i&&(f=new ga(l.x,l.y,m,T,d),s=this.addMove(s,f,a))}}}return s}addMove(e,t,n){return qr.isLegal(t,n).isSuccess()&&e.push(t),e}}class Hne extends Ya{}class pFe extends Hne{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getBoardValue(e,t){const n=e.gameState,i=this.getDominance(n),o=this.getDefense(n),s=this.getTerritory(n),a=this.getCenter(n),c=this.getOffense(n),l=this.getMobility(n);return un.of(i+o+s+a+c+l)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;const n=e.getWidth(),i=e.getHeight();for(let o=0;o<n;o++)e.getPieceAtXY(o,i-1)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(o,0)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++){const a=n.coord.getNext(new v(o,s),1);if(e.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===W.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;const n=e.getWidth(),i=e.getHeight();for(let o=0;o<n;o++)e.getPieceAtXY(o,0)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(o,i-1)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const i=(e.getWidth()-1)/2;for(const o of e.getCoordsAndContents()){const s=o.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(o.coord.x-i))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const o of e.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.isPlayer())for(const c of ve.DIRECTIONS){let l=1,f=s.getNext(c,1);for(;e.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;e.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===W.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===k.ZERO?n=Math.max(n,d):a===k.ONE&&(i=Math.max(i,d))}}return(t+n*k.ZERO.getScoreModifier()+i*k.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class mL extends Dne{getListMoves(e,t){const n=super.getListMoves(e,t);return this.orderMovesByPhalanxSizeAndFilter(n,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return Ct.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}}class mFe extends cn{constructor(){super($localize`Attack`,qr.get(),new pFe,new mL)}}class _Fe extends Ya{getBoardValue(e,t){return un.of(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const t=e.getWidth(),n=e.getHeight(),o=28*t+1,a=444*o+1;let c=0;for(const l of e.getCoordsAndContents()){const f=l.coord,d=l.content;if(d.isPlayer()){let m,E;d===k.ZERO?(m=n-f.y,E=[ve.UP_LEFT,ve.UP,ve.UP_RIGHT]):(m=f.y+1,E=[ve.DOWN_LEFT,ve.DOWN,ve.DOWN_RIGHT]);const T=d.getScoreModifier();c+=m*T,c+=a*T;for(const L of E){let z=f.getNext(L,1);for(;e.isOnBoard(z)&&e.getPieceAt(z)===d;)c+=T*o,z=z.getNext(L,1)}}}return c}}class vFe extends cn{constructor(){super($localize`Positional`,qr.get(),new _Fe,new mL)}}class CFe extends Hne{getBoardValue(e,t){const n=e.gameState.getWidth(),i=e.gameState.getHeight();let o=0,s=0,a=0,c=0;for(let l=0;l<i;l++){let f=0;const d=[0,0];for(let m=0;m<n;m++){const E=new v(m,l),T=e.gameState.getPieceAt(E);if(T.isPlayer()){const L=T.getScoreModifier();o+=L,d[T.value]=L,f+=L;for(const z of[ve.UP_LEFT,ve.UP,ve.UP_RIGHT]){let G=E.getNext(z,1);for(;e.gameState.isOnBoard(G)&&e.gameState.getPieceAt(G)===T;)s+=L,G=G.getNext(z,1)}}}0!==f&&(a+=Math.abs(f)/f),c+=d.reduce(lC.sum)}return un.multiMetric([o,a,s,c])}}class yFe extends cn{constructor(){super($localize`Piece > Row Domination > Alignement > Row Presence`,qr.get(),new CFe,new mL)}}function MFe(r,e){if(1&r){const t=ge();I(),P(0,"circle",4),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().onClick(i,o))}),S()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),A("cx",i.SPACE_SIZE/2)("cy",i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function EFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",2),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S(),O(2,MFe,1,4,"circle",3),S()}if(2&r){const t=e.index,n=p().index,i=p();A("transform",i.getTranslationXY(t,n)),_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.NONE)}}function PFe(r,e){if(1&r&&(I(),P(0,"g"),O(1,EFe,3,7,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function SFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",5),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let OFe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"NONE",W.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.setRulesAndNode("Epaminondas"),this.availableAIs=[new yFe,new vFe,new mFe,new bn($localize`MCTS`,new Dne,this.rules)],this.encoder=ga.encoder,this.hasAsymmetricBoard=!0}updateBoard(n){var i=this;return M(function*(){i.firstPiece=g.empty(),i.lastPiece=g.empty(),i.hideLastMove(),i.board=i.getState().getCopiedBoard(),i.scores=i.getScores()})()}getScores(){const n=this.getState();return g.of([n.count(k.ZERO),n.count(k.ONE)])}showLastMove(n){var i=this;return M(function*(){let o=n.coord;i.moveds=[o];for(let c=1;c<n.stepSize+n.movedPieces;c++)o=o.getNext(n.direction,1),i.moveds.push(o);const s=i.node.parent.get(),a=s.gameState.getCurrentOpponent();for(;s.gameState.isOnBoard(o)&&s.gameState.getPieceAt(o)===a;)i.capturedCoords.push(o),o=o.getNext(n.direction,1)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.firstPiece.isAbsent()?o.firstClick(n,i):o.lastPiece.isAbsent()?o.secondClick(n,i):o.thirdClick(n,i)})()}firstClick(n,i){var o=this;return M(function*(){const s=o.getState().getCurrentOpponent(),a=o.getState().getCurrentPlayer();switch(o.board[i][n]){case a:return o.firstPiece=g.of(new v(n,i)),o.validExtensions=o.getValidExtensions(a),o.phalanxValidLandings=o.getPhalanxValidLandings(),w.SUCCESS;case s:return o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());default:return H.expectToBe(o.board[i][n],W.NONE),o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const o of ve.DIRECTIONS){let s=this.firstPiece.get().getNext(o,1);for(;this.getState().isOnBoard(s)&&this.board[s.y][s.x]===n;)i.push(s),s=s.getNext(o,1)}return i}getPhalanxValidExtensions(n){let i=ve.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const o=this.lastPiece.get().getNext(i,1),s=this.getExtensionsToward(o,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return s.concat(c)}getExtensionsToward(n,i,o){const s=[];for(;this.getState().isOnBoard(n)&&this.board[n.y][n.x]===o;)s.push(n),n=n.getNext(i,1);return s}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),o=Math.abs(n.x-i.x),s=Math.abs(n.y-i.y),a=Math.max(o,s)+1;let c=ve.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of ve.DIRECTIONS){const o=this.firstPiece.get().getNext(i,1);this.getState().isOnBoard(o)&&this.board[o.y][o.x]===W.NONE&&n.push(o)}return n}getLandingsToward(n,i,o){const s=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;this.getState().isOnBoard(n)&&c.length<o&&this.board[n.y][n.x]!==s;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<o&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,o){let s=0;for(;this.getState().isOnBoard(n)&&this.board[n.y][n.x]===o;)s++,n=n.getNext(i,1);return s}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(n,i){var o=this;return M(function*(){const s=new v(n,i),a=o.firstPiece.get();if(s.equals(a))return o.cancelMoveAttempt(),w.SUCCESS;const c=o.getState().getCurrentOpponent(),l=o.getState().getCurrentPlayer();if(!1===s.isAlignedWith(a))return o.cancelMove(pa.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=s.getDistance(a),d=a.getDirectionToward(s).get();switch(o.board[i][n]){case W.NONE:return 1===f?o.chooseMove(new ga(a.x,a.y,1,1,d)):o.cancelMove(pa.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return o.cancelMove(pa.SINGLE_PIECE_CANNOT_CAPTURE());default:H.expectToBe(o.board[i][n],l);const m=new ga(a.x,a.y,f,1,d),E=o.getState(),T=qr.getPhalanxValidity(E,m);return T.isFailure()?o.cancelMove(T.getReason()):(o.lastPiece=g.of(s),o.validExtensions=o.getValidExtensions(l),o.phalanxValidLandings=o.getPhalanxValidLandings(),o.phalanxMiddles=a.getCoordsToward(s),o.phalanxDirection=g.of(d),w.SUCCESS)}})()}thirdClick(n,i){var o=this;return M(function*(){const s=o.getState().getCurrentPlayer(),a=new v(n,i);if(o.firstPiece.equalsValue(a))return o.moveFirstPiece(s);if(o.lastPiece.equalsValue(a))return o.moveLastPiece(s);const c=o.firstPiece.get(),l=o.lastPiece.get();if(!1===a.isAlignedWith(c))return o.cancelMove(pa.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=ve.factory.fromMove(c,l).get();const d=ve.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(o.firstPiece=g.of(l),o.lastPiece=g.of(c),f=d),f!==d)return o.cancelMove(pa.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(o.board[i][n]===s)return o.thirdClickOnPlayerPiece(a,f,s);{const m=o.firstPiece.get().getDistance(o.lastPiece.get())+1,E=o.lastPiece.get().getDistance(a),T=new ga(o.firstPiece.get().x,o.firstPiece.get().y,m,E,f);return o.chooseMove(T)}})()}thirdClickOnPlayerPiece(n,i,o){var s=this;return M(function*(){s.lastPiece=g.of(n);const a=s.firstPiece.get().getDistance(n)+1,c=new ga(s.firstPiece.get().x,s.firstPiece.get().y,a,1,i),l=qr.getPhalanxValidity(s.node.gameState,c);return l.isFailure()?s.cancelMove(l.getReason()):(s.phalanxMiddles=s.firstPiece.get().getCoordsToward(s.lastPiece.get()),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),w.SUCCESS)})()}moveFirstPiece(n){var i=this;return M(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),w.SUCCESS})()}moveLastPiece(n){var i=this;return M(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),w.SUCCESS)})()}moveOnlyPiece(n){var i=this;return M(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),w.SUCCESS})()}getPieceClasses(n,i){const o=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([o])}getPieceStrokeClasses(n,i){const o=new v(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(o)||this.lastPiece.equalsValue(o)||this.phalanxMiddles.some(s=>s.equals(o))?["selected-stroke"]:[]}getRectClasses(n,i){const o=new v(n,i);return this.capturedCoords.some(s=>s.equals(o))?["captured-fill"]:this.moveds.some(s=>s.equals(o))?["moved-fill"]:[]}getHighlightedCoords(){return!1===this.interactive?[]:this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],o=this.getState().getCurrentPlayer();for(let s=0;s<this.getHeight();s++)for(let a=0;a<this.getWidth();a++)this.board[s][a]===o&&n.push(new v(a,s));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-epaminondas"]],features:[Ge],decls:3,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0",1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,PFe,2,1,"g",1),O(2,SFe,2,4,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const b=W.NONE,W1=W.ZERO,o1=W.ONE,_L=qr.get().getDefaultRulesConfig();class TFe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,qr.get().getInitialState(_L)),j.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new q9([[b,b,b,b,b,W1,b,b,o1,o1,o1,o1,o1,o1],[b,b,b,b,b,W1,b,b,b,b,b,b,o1,o1],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,o1,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,W1,W1,W1,W1,b,b,b]],0)),j.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new q9([[b,b,b,b,b,W1,b,b,b,b,o1,o1,o1,o1],[b,b,b,b,b,W1,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,o1,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,o1,o1,b,b,b,W1,W1,b,W1,W1,W1,W1]],1)),j.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,qr.get().getInitialState(_L),new ga(0,10,1,1,ve.UP),(t,n,i)=>1===t.movedPieces?w.SUCCESS:w.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),j.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,qr.get().getInitialState(_L),new ga(0,11,2,1,ve.UP),(t,n,i)=>t.movedPieces>1?w.SUCCESS:w.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),j.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new q9([[b,b,b,b,b,b,b,b,o1,o1,o1,o1,o1,o1],[b,b,b,b,b,b,o1,b,b,b,b,b,b,b],[b,b,b,b,b,o1,b,b,b,b,b,b,b,b],[b,b,o1,b,o1,b,b,b,b,b,b,b,b,b],[b,b,o1,o1,b,b,b,b,b,b,b,b,b,b],[b,b,o1,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,W1,b,b,b,b,b,b,b,b,b,b,b],[b,b,W1,b,b,b,b,o1,b,b,b,b,b,b],[b,b,W1,b,b,b,b,b,b,b,b,b,b,b],[b,b,W1,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,W1,W1,W1,W1,W1,W1,W1]],0),[new ga(2,10,4,2,ve.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}var vL,Vne,Fne;class Ki{constructor(e){u(this,"capturedSpaces",void 0),H.assert(4<=e.length,"Cannot create a GipfCapture with less than 4 captured pieces"),H.assert(H2.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Ct.copy(e).sort((n,i)=>n.x===i.x?(H.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)H.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return H2.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}vL=Ki,u(Ki,"encoder",Ne.tuple([Ne.list(v.encoder)],r=>[r.capturedSpaces],r=>new vL(r[0]))),u(Ki,"listEncoder",Ne.list(vL.encoder));class MC{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=MC.computeIntersections(e);let n=[[]];return e.forEach((i,o)=>{if(0===t[o].length)n.forEach(s=>{s.push(o)});else{const s=[],a=t[o].some(c=>c>o);for(const c of n)!0===c.some(f=>t[o].some(d=>f===d))?s.push(Ct.copy(c)):a?(s.push(Ct.copy(c)),c.push(o),s.push(Ct.copy(c))):(c.push(o),s.push(Ct.copy(c)));n=s}}),n.map(i=>i.map(o=>e[o]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((o,s)=>{i!==s&&n.intersectsWith(o)&&t[i].push(s)})}),t}}class ma{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}Vne=ma,u(ma,"encoder",Ne.tuple([v.encoder,g.getEncoder(Ae.encoder)],r=>[r.coord,r.direction],r=>new Vne(r[0],r[1])));class Ja extends yo{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===Ct.equals(this.initialCaptures,e.initialCaptures)||!1===Ct.equals(this.finalCaptures,e.finalCaptures))}}Fne=Ja,u(Ja,"encoder",Ne.tuple([ma.encoder,Ki.listEncoder,Ki.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new Fne(r[0],r[1],r[2])));class O4 extends hL{constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Me.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&wt.compare(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=wt.copy(this.board);return n[e.y][e.x]=t,new O4(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Me.UNREACHABLE}}let _a=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Jt extends Sr{static get(){return Jt.singleton.isAbsent()&&(Jt.singleton=g.of(new Jt)),Jt.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new O4([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}applyLegalMove(e,t,n,i){return new O4(i.board,i.turn+1,i.sidePieces,i.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Jt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const o=[t.sidePieces[0],t.sidePieces[1]],s=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Me.EMPTY),c.is(n)?o[n.value]+=1:s[n.value]+=1}),new O4(i.board,t.turn,o,s)}static getPlacements(e){const t=[];return Wr.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Me.EMPTY?t.push(new ma(n,g.empty())):Jt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Jt.isLineComplete(e,n,i)&&t.push(new ma(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Jt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Me.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,o=Me.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Me.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,o)}else for(let a=e.coord;i.isOnBoard(a)&&o!==Me.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,o),o=c}const s=[t.sidePieces[0],t.sidePieces[1]];return s[n.value]-=1,new O4(i.board,t.turn,s,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Jt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const o=n.direction.get(),s=[];s.push(n.coord);let a=n.coord.getNext(o);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Me.EMPTY;)s.push(a),a=a.getNext(o);return H.assert(i.isOnBoard(a)&&i.getPieceAt(a)===Me.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),s.push(a),s}}static getAllDirectionsForEntrance(e,t){if(Wr.INSTANCE.isTopLeftCorner(e,t))return[Ae.RIGHT,Ae.DOWN,Ae.UP_RIGHT];if(Wr.INSTANCE.isTopCorner(e,t))return[Ae.DOWN,Ae.DOWN_LEFT,Ae.RIGHT];if(Wr.INSTANCE.isTopRightCorner(e,t))return[Ae.DOWN_LEFT,Ae.DOWN,Ae.LEFT];if(Wr.INSTANCE.isBottomLeftCorner(e,t))return[Ae.UP_RIGHT,Ae.UP,Ae.RIGHT];if(Wr.INSTANCE.isBottomCorner(e,t))return[Ae.UP,Ae.LEFT,Ae.UP_RIGHT];if(Wr.INSTANCE.isBottomRightCorner(e,t))return[Ae.LEFT,Ae.UP,Ae.DOWN_LEFT];if(Wr.INSTANCE.isOnTopLeftBorder(e,t))return[Ae.RIGHT,Ae.DOWN];if(Wr.INSTANCE.isOnLeftBorder(e,t))return[Ae.UP_RIGHT,Ae.RIGHT];if(Wr.INSTANCE.isOnBottomLeftBorder(e,t))return[Ae.UP,Ae.UP_RIGHT];if(Wr.INSTANCE.isOnBottomRightBorder(e,t))return[Ae.LEFT,Ae.UP];if(Wr.INSTANCE.isOnRightBorder(e,t))return[Ae.LEFT,Ae.DOWN_LEFT];if(Wr.INSTANCE.isOnTopRightBorder(e,t))return[Ae.DOWN_LEFT,Ae.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Jt.applyCaptures(e.initialCaptures,t),o=this.noMoreCapturesValidity(i);if(o.isFailure())return o.toOtherFallible();const s=this.placementValidity(i,e.placement);if(s.isFailure())return s.toOtherFallible();const a=Jt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Jt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():Q.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=Jt.applyCapture(i,n)}return w.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Jt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return w.failure(_a.CAPTURE_MUST_BE_ALIGNED());const o=i.get();return Jt.getCapturable(e,o).equals(t)?w.SUCCESS:w.failure(_a.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=Jt.getLinePortionWithFourPiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let a=o;for(let c=o;e.isOnBoard(c);c=c.getNext(s))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:s});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Jt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?w.SUCCESS:w.failure(_a.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Me.EMPTY){if(t.direction.isAbsent())return w.failure(_a.PLACEMENT_WITHOUT_DIRECTION());if(Jt.isLineComplete(e,t.coord,t.direction.get()))return w.failure(_a.PLACEMENT_ON_COMPLETE_LINE());for(const i of Jt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return w.SUCCESS;return w.failure(_a.INVALID_PLACEMENT_DIRECTION())}return w.SUCCESS}placementCoordValidity(e,t){return Wr.INSTANCE.isOnBorder(e,t)?w.SUCCESS:w.failure(_a.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],o=t[1],s=t[2],a=s.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Me.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(o);l=l.getNext(s))n.push(l);for(let l=o;e.isOnBoard(l)&&e.getPieceAt(l)!==Me.EMPTY;l=l.getNext(s))n.push(l);return new Ki(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Jt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Jt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Jt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Jt.getPlayerScore(e,k.ZERO),n=Jt.getPlayerScore(e,k.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Jt.getPlayerScore(t,k.ZERO),i=Jt.getPlayerScore(t,k.ONE);return n.isAbsent()?_e.ONE_WON:i.isAbsent()?_e.ZERO_WON:_e.ONGOING}}u(Jt,"singleton",g.empty());class $ne extends Sne{constructor(e,t,n,i,o,s){super(n,i,o,s),u(this,"source",void 0),u(this,"destination",void 0),this.source=e,this.destination=t}}class Gne extends jn{getListMoves(e,t){const n=e.gameState,i=[];return Jt.isGameOver(n)||this.getPossibleCaptureCombinations(n).forEach(o=>{const s=Jt.applyCaptures(o,n);Jt.getPlacements(s).forEach(a=>{const c=Jt.applyPlacement(a,s);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new Ja(a,o,l);i.push(f)})})}),i}getPossibleCaptureCombinations(e){const t=Jt.getPossibleCaptures(e);return MC.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class bFe extends B1{getMetrics(e,t){const n=e.gameState;return g1.of([Jt.getPlayerScore(n,k.ZERO).get()],[Jt.getPlayerScore(n,k.ONE).get()])}}function wFe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),A("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function NFe(r,e){if(1&r){const t=ge();I(),P(0,"g",10),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o))}),V(1,"polygon",11),O(2,wFe,1,4,"circle",12),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","click_",t.x,"_",t.y,""),_(1),Ce("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),A("points",n.getHexaPointsAt(t)),_(1),y("ngIf",n.isPiece(t))}}function AFe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",16),q("click",function(){const o=ee(t).$implicit;return te(p(2).onClick(o))}),S()}if(2&r){const t=e.$implicit;A("points",p(2).getHexaPointsAt(t))}}function IFe(r,e){if(1&r&&(I(),P(0,"g",14),O(1,AFe,1,1,"polygon",15),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.capturedSpaces)}}function kFe(r,e){if(1&r){const t=ge();I(),P(0,"line",17),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.destination))}),S()}if(2&r){const t=e.$implicit;A("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function xFe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",18),S()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),Ce("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),A("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function LFe(r,e){if(1&r&&(I(),P(0,"g"),O(1,xFe,2,6,"g",8),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function RFe(r,e){if(1&r&&(I(),V(0,"line",19)),2&r){const t=p();A("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let zFe=(()=>{var r;class e extends Cu{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.setRulesAndNode("Gipf"),this.availableAIs=[new cn($localize`Score`,this.rules,new bFe,new Gne),new bn($localize`MCTS`,new Gne,this.rules)],this.encoder=Ja.encoder,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new yu(1.5*this.SPACE_SIZE,new v(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Wr.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){if(i.inserted=g.empty(),n.placement.direction.isPresent()){const o=n.placement;i.inserted=g.of(i.arrowTowards(o.coord,o.direction.get()))}i.cancelMoveAttempt()})()}arrowTowards(n,i){const o=n.getNext(i.getOpposite()),s=this.getCenterAt(n),a=this.getCenterAt(o);return new $ne(o,n,a.x,a.y,s.x,s.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),o=[];for(let s=0;s<i;s+=1)o.push(s);return o}isPiece(n){return this.getPiece(n)!==Me.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return H.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return M(function*(){const o=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&o.push(a)}),o.length>1)return i.cancelMove(_a.AMBIGUOUS_CAPTURE_COORD());if(0===o.length)return i.cancelMove(_a.MISSING_CAPTURES());const s=o[0];return i.constructedState=Jt.applyCapture(s,i.constructedState),i.markCapture(s),i.possibleCaptures=Jt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(s),0===i.possibleCaptures.length?i.moveToPlacementPhase():w.SUCCESS):(H.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(s),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):w.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,w.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Jt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,w.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return M(function*(){return n.possibleCaptures=Jt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,w.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Jt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Jt.isLineComplete(this.constructedState,n,i)){const o=n.getNext(i),s=this.getCenterAt(n),a=this.getCenterAt(o);this.arrows.push(new $ne(n,o,s.x,s.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return M(function*(){const o=i.rules.placementCoordValidity(i.constructedState,n);return o.isFailure()?i.cancelMove(o.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),w.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===Me.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&(yield i.cancelMove(_a.NO_DIRECTIONS_AVAILABLE())),w.SUCCESS))})()}selectPlacementDirection(n){var i=this;return M(function*(){i.placement=g.of(new ma(i.placementEntrance.get(),n));const o=i.rules.placementValidity(i.constructedState,i.placement.get());return o.isFailure()?i.cancelMove(o.getReason()):(i.arrows=[],i.constructedState=Jt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return M(function*(){const o=i.placementEntrance.get();if(!1===o.isAlignedWith(n)||1!==o.getDistance(n))return i.selectPlacementCoord(n);const s=Ae.factory.fromMove(o,n);return i.selectPlacementDirection(s.toOptional())})()}tryMove(n,i,o){const s=new Ja(i,n,o);return this.chooseMove(s)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.previousMove;if(n.isPresent()){const i=n.get(),o=this.getPreviousState();i.initialCaptures.forEach(s=>this.markCapture(s)),i.finalCaptures.forEach(s=>this.markCapture(s)),this.moved=this.rules.getPiecesMoved(o,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(k.of(i.value))}getRemainingPieceCy(n){return n===k.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const o=20+i*this.SPACE_SIZE*.5;return n===k.ONE?o:this.boardWidth-(15+o)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-gipf"]],features:[Ge],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),S(),P(4,"marker",3),V(5,"polygon",4),S()(),O(6,NFe,3,7,"g",5),O(7,IFe,2,1,"g",6),O(8,kFe,1,4,"line",7),O(9,LFe,2,1,"g",8),O(10,RFe,1,4,"line",9),S()),2&n&&(A("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),_(6),y("ngForOf",i.getAllCoords()),_(1),y("ngForOf",i.possibleCaptures),_(1),y("ngForOf",i.arrows),_(1),y("ngForOf",i.Player.PLAYERS),_(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var EC,$l;class rr extends Or{static of(e){return new rr(e.x,e.y)}toString(){return this===rr.PASS?"GoMove.PASS":this===rr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(rr,"PASS",new(EC=rr)(-1,0)),u(rr,"ACCEPT",new EC(-2,0)),u(rr,"encoder",Or.getEncoder(EC.of));class ke{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case ke.DARK:return"GoPiece.DARK";case ke.LIGHT:return"GoPiece.LIGHT";case ke.EMPTY:return"GoPiece.EMPTY";case ke.DEAD_DARK:return"GoPiece.DEAD_DARK";case ke.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case ke.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return nn(this===ke.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===k.ZERO?ke.DARK:ke.LIGHT}isOccupied(){return[ke.DARK,ke.LIGHT,ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isEmpty(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY,ke.EMPTY].includes(this)}isDead(){return[ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isTerritory(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return nn(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),ke.EMPTY}}u(ke,"DARK",new($l=ke)(k.ZERO,"alive")),u(ke,"LIGHT",new $l(k.ONE,"alive")),u(ke,"EMPTY",new $l(W.NONE,"empty")),u(ke,"DEAD_DARK",new $l(k.ZERO,"dead")),u(ke,"DEAD_LIGHT",new $l(k.ONE,"dead")),u(ke,"DARK_TERRITORY",new $l(W.NONE,"territory")),u(ke,"LIGHT_TERRITORY",new $l(W.NONE,"territory"));var _n=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(_n||{});class Ar extends k1{constructor(e,t,n,i,o){super(e,n),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=t,this.koCoord=i,this.phase=o}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(e){return wt.create(e.width,e.height,ke.EMPTY)}copy(){return new Ar(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}let CL=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const o of this.getDirections()){const s=e.getNext(o);s.isInRange(t[0].length,t.length)&&!1===n.contains(s)&&(n=this._getGroupDatas(s,t,n))}return n}};CL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],CL);class xu{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class VFe extends xu{constructor(e,t,n,i,o,s){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=o,this.deadLightCoords=s}getCoords(){return this.color===ke.DARK?this.darkCoords:this.color===ke.LIGHT?this.lightCoords:this.color===ke.DEAD_DARK?this.deadDarkCoords:this.color===ke.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(nn(!1===this.contains(e),"This group already contains "+e.toString()),t){case ke.DARK:this.darkCoords=xu.insertAsEntryPoint(this.darkCoords,e);break;case ke.LIGHT:this.lightCoords=xu.insertAsEntryPoint(this.lightCoords,e);break;case ke.DEAD_DARK:this.deadDarkCoords=xu.insertAsEntryPoint(this.deadDarkCoords,e);break;case ke.DEAD_LIGHT:this.deadLightCoords=xu.insertAsEntryPoint(this.deadLightCoords,e);break;default:H.expectToBeMultiple(t,[ke.EMPTY,ke.DARK_TERRITORY,ke.LIGHT_TERRITORY]),this.emptyCoords=xu.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new Qt;e.set(ke.EMPTY,this.emptyCoords.length),e.set(ke.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(ke.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);return H.assert(1===t.size(),"Can't call getWrapper on non-mono-wrapped group"),t.getAnyPair().get().key}getNeighborsEntryPoints(){const e=[];return this.color!==ke.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==ke.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==ke.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==ke.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==ke.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class j9 extends CL{getNewInstance(e){return new VFe(e,[],[],[],[],[])}getDirections(){return Re.ORTHOGONALS}}let Z9=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var Y9,vn;let ec=(Y9=class extends ja{static get(){return vn.singleton.isAbsent()&&(vn.singleton=g.of(new vn)),vn.singleton.get()}getInitialState(e){const t=e.get(),n=Ar.getStartingBoard(t);let i=0;const o=Xo.getHorizontalLeft(t.width),s=Xo.getHorizontalRight(t.width),a=Xo.getVerticalUp(t.height),c=Xo.getVerticalDown(t.height),l=Xo.getHorizontalCenter(t.width),f=Xo.getVerticalCenter(t.height),d=[new v(o,a),new v(s,c),new v(s,a),new v(o,c),new v(l,f),new v(l,a),new v(l,c),new v(o,f),new v(s,f)];1<=t.handicap&&(i=1);for(let m=0;m<t.handicap;m++){const E=d[m];n[E.y][E.x]=ke.DARK}return new Ar(n,[0,0],i,g.empty(),_n.PLAYING)}static isLegal(e,t){if(vn.isPass(e)){const n=t.phase===_n.PLAYING,i=t.phase===_n.PASSED;return we.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?Q.success([]):Q.failure(Z9.CANNOT_PASS_AFTER_PASSED_PHASE())}return vn.isAccept(e)?t.phase===_n.COUNTING||t.phase===_n.ACCEPT?Q.success([]):Q.failure(Z9.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):vn.isOccupied(e.coord,t.getCopiedBoard())?(we.display("GoRules","isLegal","move is marking"),vn.isLegalDeadMarking(e,t)?Q.success([]):Q.failure(Z9.OCCUPIED_INTERSECTION())):(we.display("GoRules","isLegal","move is normal stuff: "+e.toString()),vn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],o=e.coord,s=t[o.y][o.x],c=(new j9).getGroupDatas(o,t),l=c.emptyCoords,f=ke.pieceBelongTo(s,k.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=vn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of n){const s=o.getWrapper();if(s===ke.LIGHT){i[1]+=o.emptyCoords.length;for(const a of o.getCoords())t[a.y][a.x]=ke.LIGHT_TERRITORY}else{H.assert(s===ke.DARK,"territory should be wrapped by dark or light, not by "+s.toString()),i[0]+=o.emptyCoords.length;for(const a of o.getCoords())t[a.y][a.x]=ke.DARK_TERRITORY}}return new Ar(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let o=0;o<e.getHeight();o++)for(let s=0;s<e.getWidth();s++)i=t[o][s],i===ke.DARK_TERRITORY?(t[o][s]=ke.EMPTY,n[0]=n[0]-1):i===ke.LIGHT_TERRITORY&&(t[o][s]=ke.EMPTY,n[1]=n[1]-1);return new Ar(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return vn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,o,s;const a=new j9;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new v(l,c),s=e[c][l],t(s)&&!1===n.some(f=>f.selfContains(i))&&(o=a.getGroupDatas(i,e),n.push(o));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let o,n=t[1],i=t[0];for(let s=0;s<e.getHeight();s++)for(let a=0;a<e.getWidth();a++)o=e.getPieceAtXY(a,s),o===ke.DEAD_DARK?n++:o===ke.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();H.assert(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const s=(new j9).getGroupDatas(e,n),a=t.getCapturedCopy();switch(s.color){case ke.DEAD_DARK:a[1]-=2*s.deadDarkCoords.length;for(const c of s.deadDarkCoords)n[c.y][c.x]=ke.DARK;break;case ke.DEAD_LIGHT:a[0]-=2*s.deadLightCoords.length;for(const c of s.deadLightCoords)n[c.y][c.x]=ke.LIGHT;break;case ke.LIGHT:a[0]+=2*s.lightCoords.length;for(const c of s.lightCoords)n[c.y][c.x]=ke.DEAD_LIGHT;break;default:H.expectToBe(s.color,ke.DARK),a[1]+=2*s.darkCoords.length;for(const c of s.darkCoords)n[c.y][c.x]=ke.DEAD_DARK}return new Ar(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===_n.FINISHED?t.captured[0]>t.captured[1]?_e.ZERO_WON:t.captured[1]>t.captured[0]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static isPass(e){return e.equals(rr.PASS)}static isAccept(e){return e.equals(rr.ACCEPT)}static isLegalDeadMarking(e,t){return vn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===_n.COUNTING||t.phase===_n.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(vn.isKo(e,t))return Q.failure(Z9.ILLEGAL_KO());[_n.COUNTING,_n.ACCEPT].includes(t.phase)&&(t=vn.resurrectStones(t));const i=vn.getCaptureState(e,t);if(Une.isCapturing(i))return Q.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?ke.DARK:ke.LIGHT;const a=0===(new j9).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=ke.EMPTY,a?Q.failure(Z9.CANNOT_COMMIT_SUICIDE()):Q.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new Une;let i;for(const o of Re.ORTHOGONALS)i=vn.getCapturedInDirection(e.coord,o,t),i.length>0&&n.capturedCoords.every(s=>!1===i[0].equals(s))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),o=e.getNext(t);if(o.isInRange(n.getWidth(),n.getHeight())&&i[o.y][o.x]===(n.turn%2==0?ke.LIGHT:ke.DARK)){we.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new j9).getGroupDatas(o,i);if(vn.isCapturableGroup(c,n.koCoord))return we.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return vn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let o,s;return e.phase===_n.PASSED?(o=_n.COUNTING,s=new Ar(t,n,i+1,g.empty(),o),s=vn.markTerritoryAndCount(s)):(H.assert(e.phase===_n.PLAYING,"Cannot pass in counting phase!"),o=_n.PASSED,s=new Ar(t,n,i+1,g.empty(),o)),s}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===_n.COUNTING?_n.ACCEPT:_n.FINISHED,new Ar(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[_n.COUNTING,_n.ACCEPT].includes(t.phase)?vn.resurrectStones(t):t.copy();const o=e.coord.x,s=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=ke.ofPlayer(i.getCurrentPlayer()),f=c+1;a[s][o]=l;for(const E of n)a[E.y][E.x]=ke.EMPTY;const d=vn.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Ar(a,m,f,d,_n.PLAYING)}static resurrectStones(e){for(let t=0;t<e.getHeight();t++)for(let n=0;n<e.getWidth();n++)e.getPieceAtXY(n,t).isDead()&&(e=vn.switchAliveness(new v(n,t),e));return vn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=vn.removeAndSubstractTerritory(t),i=vn.switchAliveness(e.coord,n),o=new Ar(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),_n.COUNTING);return vn.markTerritoryAndCount(o)}isLegal(e,t){return vn.isLegal(e,t)}applyLegalMove(e,t,n,i){return vn.isPass(e)?(we.display("GoRules","applyLegalMove","isPass"),vn.applyPass(t)):vn.isAccept(e)?(we.display("GoRules","applyLegalMove","isAccept"),vn.applyLegalAccept(t)):vn.isLegalDeadMarking(e,t)?(we.display("GoRules","applyLegalMove","isDeadMarking"),vn.applyDeadMarkingMove(e,t)):(we.display("GoRules","applyLegalMove","else it is normal move"),vn.applyNormalLegalMove(e,t,i))}getGameStatus(e){return vn.getGameStatus(e)}getRulesConfigDescription(){return g.of(vn.RULES_CONFIG_DESCRIPTION)}},vn=Y9,u(Y9,"singleton",g.empty()),u(Y9,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`19 x 19`,config:{width:new br(19,Ss.WIDTH,Tr.range(1,99)),height:new br(19,Ss.HEIGHT,Tr.range(1,99)),handicap:new br(0,()=>$localize`Handicap`,Tr.range(0,9))}},[{name:()=>$localize`13 x 13`,config:{width:13,height:13,handicap:0}},{name:()=>$localize`9 x 9`,config:{width:9,height:9,handicap:0}}])),Y9);ec=vn=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ec);class Une{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}const qe=ke.LIGHT,Ve=ke.DARK,yL=ke.DEAD_LIGHT,Lu=ke.LIGHT_TERRITORY,va=ke.DARK_TERRITORY,le=ke.EMPTY,$Fe=ec.get().getDefaultRulesConfig();class GFe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,ec.get().getInitialState($Fe)),j.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Ar([[le,Ve,le,le,qe,qe],[le,Ve,le,le,qe,le],[le,Ve,Ve,qe,qe,le],[le,le,Ve,qe,le,le],[le,le,Ve,qe,le,le],[le,le,Ve,qe,le,le]],[0,0],0,g.empty(),_n.PLAYING)),j.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Ar([[le,le,le,le,le],[le,le,Ve,le,le],[le,Ve,qe,le,le],[le,le,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),_n.PLAYING),[new rr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),j.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Ar([[le,Ve,le,le,le],[Ve,qe,le,le,le],[Ve,qe,qe,Ve,le],[le,Ve,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),_n.PLAYING),[new rr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),j.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Ar([[le,Ve,le,le,le],[Ve,le,le,le,le],[Ve,le,le,le,qe],[qe,Ve,le,qe,le],[le,qe,le,qe,Ve]],[0,0],0,g.empty(),_n.PLAYING)),j.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Ar([[le,le,le,le,le],[Ve,Ve,Ve,le,le],[qe,qe,Ve,le,le],[le,qe,Ve,le,le],[qe,qe,Ve,le,le]],[0,0],0,g.empty(),_n.PLAYING)),j.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Ar([[le,Ve,qe,le,le],[qe,Ve,qe,le,le],[Ve,Ve,qe,le,le],[qe,Ve,qe,le,le],[le,Ve,qe,le,le]],[0,0],0,g.empty(),_n.PLAYING)),j.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Ar([[le,qe,Ve,le,qe,Ve,le],[le,qe,Ve,Ve,qe,Ve,le],[le,qe,Ve,Ve,qe,Ve,le],[le,qe,Ve,Ve,qe,Ve,le],[le,qe,Ve,qe,qe,Ve,le],[le,qe,Ve,qe,qe,Ve,le],[le,qe,Ve,le,qe,Ve,le]],[0,0],0,g.empty(),_n.PLAYING)),j.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Ar([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,Ve,qe,le,le],[le,le,Ve,qe,le,qe,le],[le,le,le,Ve,qe,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),_n.PLAYING),[new rr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),j.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Ar([[qe,Ve,Ve,Ve,Ve,Ve,va,va,va],[qe,qe,qe,qe,Ve,Ve,Ve,va,va],[qe,Lu,qe,qe,Ve,yL,yL,Ve,va],[Ve,qe,qe,qe,qe,Ve,va,va,va],[le,qe,Lu,qe,Ve,Ve,yL,Ve,va],[qe,Lu,qe,qe,Ve,Ve,Ve,Ve,Ve],[qe,qe,Ve,Ve,Ve,qe,qe,Ve,qe],[Ve,Ve,Ve,qe,qe,qe,Lu,qe,qe],[va,va,Ve,Ve,Ve,qe,qe,Lu,Lu]],[0,0],0,g.empty(),_n.COUNTING),[new rr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}class BFe extends B1{getMetrics(e,t){const n=ec.markTerritoryAndCount(e.gameState),i=n.getCapturedCopy(),o=this.getDeadStones(n);return g1.of([i[0]+2*o[1]],[i[1]+2*o[0]])}getDeadStones(e){const t=[0,0];for(const n of e.getCoordsAndContents()){const i=n.content;"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}let PC=class extends jn{getListMoves(e,t){const n=e.gameState,i=this.getPlayingMovesList(n);if(n.phase===_n.PLAYING||n.phase===_n.PASSED)return i.push(rr.PASS),i;{const o=this.getCountingMovesList(n);return 0===o.length?[rr.ACCEPT]:o}}getPlayingMovesList(e){const t=[];let n;for(const i of e.getCoordsAndContents()){const o=i.coord,s=i.content;n=new rr(o.x,o.y),s===ke.EMPTY&&ec.isLegal(n,e).isSuccess()&&t.push(n)}return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=ec.getGroupsDatasWhere(n,o=>o!==ke.EMPTY);for(const o of i){const s=o.getCoords()[0],a=n[s.y][s.x];if(e.getPieceAt(s)!==a){const l=new rr(s.x,s.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),s=>s===ke.DARK?ke.DEAD_DARK:s===ke.LIGHT?ke.DEAD_LIGHT:s.isTerritory()?ke.EMPTY:s),i=new Ar(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),o=ec.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,o)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let o=0;o<e[0].length;o++)n[i][o]=t(e[i][o])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const o of t){i=o.deadDarkCoords.concat(o.deadLightCoords);for(const s of i)n.isDead(s)&&(n=ec.switchAliveness(s,n))}return n}};var Ru;function qFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",8),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S(),P(2,"line",9),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S(),P(3,"line",9),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n),_(1),A("x1",i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+i.SPACE_SIZE*n),_(1),A("x1",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y1",i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n)}}function jFe(r,e){if(1&r&&(I(),P(0,"g"),O(1,qFe,4,14,"g",3),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ZFe(r,e){if(1&r){const t=ge();I(),P(0,"circle",10),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","hoshi_",t.x,"_",t.y,""),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.2*n.SPACE_SIZE)}}function YFe(r,e){if(1&r&&(I(),V(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE)}}function KFe(r,e){if(1&r){const t=ge();I(),P(0,"line",17),q("click",function(){ee(t);const i=p(2).index,o=p().index;return te(p().onClick(i,o))}),S()}if(2&r){const t=p(2).index,n=p().index,i=p();A("x1",i.SPACE_SIZE*t)("y1",i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n)}}function XFe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"circle",13),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().onClick(i,o))}),S(),O(2,YFe,1,3,"circle",14),O(3,KFe,1,4,"line",15),S()}if(2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getSpaceClass(t,n)),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE),_(1),y("ngIf",i.isLastSpace(t,n)),_(1),y("ngIf",i.isDead(t,n))}}function QFe(r,e){if(1&r){const t=ge();I(),P(0,"circle",19),q("click",function(){ee(t);const i=p(2).index,o=p().index;return te(p().onClick(i,o))}),S()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();A("cx",.5*s.SPACE_SIZE+s.SPACE_SIZE*n)("cy",.5*s.SPACE_SIZE+s.SPACE_SIZE*o)("r",.2*s.SPACE_SIZE)("class",i===s.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function JFe(r,e){if(1&r&&(I(),O(0,QFe,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function e$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,XFe,4,6,"g",11),O(2,JFe,1,1,"ng-template",null,12,mn),S()),2&r){const t=e.index,n=dn(3),i=p().index,o=p();_(1),y("ngIf",o.spaceIsFull(t,i))("ngIfElse",n)}}function t$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,e$e,4,2,"g",3),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function n$e(r,e){if(1&r&&(I(),V(0,"rect",20)),2&r){const t=p();A("width",.5*t.SPACE_SIZE)("height",.5*t.SPACE_SIZE)("x",.25*t.SPACE_SIZE+t.SPACE_SIZE*t.ko.get().x)("y",.25*t.SPACE_SIZE+t.SPACE_SIZE*t.ko.get().y)}}function r$e(r,e){if(1&r){const t=ge();I(),P(0,"circle",21),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p();A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.14*n.SPACE_SIZE)}}PC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],PC);let ML=(Ru=class extends sL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",ke),this.setRulesAndNode("Go"),this.availableAIs=[new cn($localize`Minimax`,ec.get(),new BFe,new PC),new bn($localize`MCTS`,new PC,this.rules)],this.encoder=rr.encoder,this.canPass=!0,this.scores=g.of([0,0])}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const o=new rr(e,t);return n.chooseMove(o)})()}updateBoard(e){var t=this;return M(function*(){const n=t.getState(),i=t.node.previousMove,o=n.phase;t.board=n.getCopiedBoard(),t.scores=g.of(n.getCapturedCopy()),t.ko=n.koCoord,i.isPresent()?t.showCaptures():t.captures=[],t.last=i.map(s=>s.coord),t.canPass=o!==_n.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.getWidth();n++){const i=new v(n,t),o=e.getPieceAt(i).isOccupied(),s=this.board[t][n]===ke.EMPTY,a=!1===this.ko.equalsValue(i);o&&s&&a&&this.captures.push(i)}}pass(){var e=this;return M(function*(){const t=e.getState().phase;return t===_n.PLAYING||t===_n.PASSED?e.onClick(rr.PASS.coord.x,rr.PASS.coord.y):(H.assert(t===_n.COUNTING||t===_n.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(rr.ACCEPT.coord.x,rr.ACCEPT.coord.y))})()}getSpaceClass(e,t){const i=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(i.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==ke.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new v(e,t))}isTerritory(e,t){return this.getState().isTerritory(new v(e,t))}},u(Ru,"\u0275fac",function(e){return new(e||Ru)(U(Ut))}),u(Ru,"\u0275cmp",Fe({type:Ru,selectors:[["app-go"]],features:[Ge],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base",3,"ngClass","click"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(I(),P(0,"svg",0),V(1,"rect",1),P(2,"g",2),O(3,jFe,2,1,"g",3),O(4,ZFe,1,5,"circle",4),S(),P(5,"g",5),O(6,t$e,2,1,"g",3),S(),O(7,n$e,1,4,"rect",6),O(8,r$e,1,3,"circle",7),S()),2&e&&(A("viewBox",t.getViewBox().toSVGString()),_(1),A("width",t.getState().getWidth()*t.SPACE_SIZE)("height",t.getState().getHeight()*t.SPACE_SIZE),_(2),y("ngForOf",t.board),_(1),y("ngForOf",t.hoshis),_(2),y("ngForOf",t.board),_(1),y("ngIf",t.ko.isPresent()),_(1),y("ngForOf",t.captures))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Ru);ML=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ML);const Nn=Me.UNREACHABLE,Ke=Me.EMPTY,q1=Me.ZERO,a3=Me.ONE;class i$e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Jt.get().getInitialState()),j.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Jt.get().getInitialState(),new Ja(new ma(new v(3,0),g.of(Ae.DOWN)),[],[]),$localize`Congratulations!`),j.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new O4([[Nn,Nn,Nn,q1,a3,Ke,Ke],[Nn,Nn,Ke,Ke,Ke,Ke,Ke],[Nn,Ke,Ke,Ke,Ke,Ke,Ke],[q1,q1,q1,Ke,Ke,Ke,Ke],[a3,Ke,Ke,Ke,Ke,Ke,Nn],[Ke,Ke,Ke,a3,Ke,Nn,Nn],[Ke,Ke,Ke,a3,Nn,Nn,Nn]],42,[8,8],[0,0]),[new Ja(new ma(new v(0,3),g.of(Ae.RIGHT)),[],[new Ki([new v(0,3),new v(1,3),new v(2,3),new v(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),j.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new O4([[Nn,Nn,Nn,Ke,Ke,Ke,Ke],[Nn,Nn,Ke,a3,Ke,Ke,Ke],[Nn,Ke,Ke,q1,Ke,Ke,Ke],[q1,q1,q1,a3,Ke,Ke,Ke],[Ke,Ke,Ke,q1,Ke,Ke,Nn],[Ke,Ke,Ke,q1,Ke,Nn,Nn],[Ke,Ke,Ke,a3,Nn,Nn,Nn]],42,[8,4],[2,3]),[new Ja(new ma(new v(0,3),g.of(Ae.RIGHT)),[],[new Ki([new v(3,1),new v(3,2),new v(3,3),new v(3,4),new v(3,5),new v(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),j.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new O4([[Nn,Nn,Nn,q1,Ke,Ke,q1],[Nn,Nn,Ke,q1,Ke,Ke,q1],[Nn,q1,q1,Ke,q1,a3,q1],[Ke,Ke,Ke,q1,Ke,Ke,q1],[Ke,Ke,Ke,q1,Ke,Ke,Nn],[q1,q1,q1,a3,a3,Nn,Nn],[Ke,Ke,Ke,q1,Nn,Nn,Nn]],42,[3,4],[2,3]),[new Ja(new ma(new v(3,6),g.of(Ae.UP)),[new Ki([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new Ki([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)]),new Ki([new v(1,2),new v(2,2),new v(3,2),new v(4,2),new v(5,2)])]),new Ja(new ma(new v(4,6),g.of(Ae.UP)),[new Ki([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new Ki([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)]),new Ki([new v(3,0),new v(3,1),new v(3,2),new v(3,3),new v(3,4)])]),new Ja(new ma(new v(3,6),g.of(Ae.UP)),[new Ki([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new Ki([new v(1,2),new v(2,2),new v(3,2),new v(4,2),new v(5,2)]),new Ki([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}let ur=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var Wne;const o$e=Ne.fromFunctions(r=>r,r=>r);class ci{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}Wne=ci,u(ci,"encoder",Ne.tuple([k.encoder,o$e],r=>[r.owner,r.kind],r=>new Wne(r[0],r[1])));class c3{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&Ct.equals(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new c3([e,...this.pieces])}topPiece(){return H.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new c3(e)}size(){return this.pieces.length}}var jne,Yne,Oi;u(c3,"EMPTY",new c3([]));class Ca extends Or{static of(e,t){return new Ca(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Ca&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}jne=Ca,u(Ca,"encoder",Ne.tuple([ci.encoder,v.encoder],r=>[r.piece,r.coord],r=>new jne(r[0],r[1].x,r[1].y)));class Qo extends n2{static from(e,t){return e.equals(t)?Q.failure(Ee.MOVE_CANNOT_BE_STATIC()):Q.success(new Qo(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof tc)&&e instanceof Qo&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u(Qo,"encoder",Ko.getFallibleEncoder(Qo.from));class tc extends Qo{static ofCoords(e){return new tc(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof tc&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}Yne=tc,u(tc,"encoder",Ne.tuple([v.encoder,v.encoder,v.encoder,v.encoder],r=>r.coords,r=>new Yne(r)));class D0 extends yo{toString(){return"HiveMovePass"}equals(e){return e instanceof D0}}function s$e(r){return r instanceof Ca}function a$e(r){return r instanceof tc}function c$e(r){return r instanceof Qo}function l$e(r){return r instanceof D0}u(D0,"encoder",Ne.constant("HiveMovePass",new D0)),function(r){r.PASS=new D0,r.drop=function e(i,o){return Ca.of(i,o)},r.move=function t(i,o){return Qo.from(i,o)},r.spiderMove=function n(i){return tc.ofCoords(i)},r.encoder=Ne.disjunction([s$e,a$e,c$e,l$e],[Ca.encoder,tc.encoder,Qo.encoder,D0.encoder])}(Oi||(Oi={}));class ya{static of(e){return ya.INSTANCES.isAbsent()&&(ya.INSTANCES=g.of({QueenBee:SC.get(),Beetle:OC.get(),Grasshopper:TC.get(),Spider:K9.get(),SoldierAnt:bC.get()})),ya.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?w.failure(ur.THIS_PIECE_CANNOT_CLIMB()):w.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new it(Pi.getNeighbors(t)),o=new it(Pi.getNeighbors(n)),s=i.intersection(o);for(const a of s)if(e.getAt(a).isEmpty())return!0;return!1}}u(ya,"INSTANCES",g.empty());class SC extends ya{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new SC)),this.INSTANCE.get()}moveValidity(e,t){return!1===Pi.areNeighbors(e.getStart(),e.getEnd())?w.failure(ur.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?w.failure(ur.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of Pi.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Qo.from(e,i).get());return n}}u(SC,"INSTANCE",g.empty());class OC extends ya{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new OC)),this.INSTANCE.get()}moveValidity(e,t){return!1===Pi.areNeighbors(e.getStart(),e.getEnd())?w.failure(ur.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):w.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of Pi.getNeighbors(e))n.push(Qo.from(e,i).get());return n}}u(OC,"INSTANCE",g.empty());class TC extends ya{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new TC)),this.INSTANCE.get()}moveValidity(e,t){if(Ae.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return w.failure(ur.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return w.failure(ur.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const o of i)if(t.getAt(o).isEmpty())return w.failure(ur.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of Ae.factory.all){const o=e.getNext(i);if(t.getAt(o).hasPieces()){let s=o;for(;t.getAt(s).hasPieces();)s=s.getNext(i);n.push(Qo.from(e,s).get())}}return n}}u(TC,"INSTANCE",g.empty());class K9 extends ya{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new K9)),this.INSTANCE.get()}prefixLegality(e,t){const n=new it,i=t.update().setAt(e[0],c3.EMPTY).increaseTurnAndFinalizeUpdate();for(let o=1;o<e.length;o++){if(i.getAt(e[o]).hasPieces())return w.failure(ur.THIS_PIECE_CANNOT_CLIMB());if(!1===Pi.areNeighbors(e[o-1],e[o]))return w.failure(ur.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[o],e[o-1]))return w.failure(ur.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[o-1],e[o]))return w.failure(ur.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[o]))return w.failure(ur.SPIDER_CANNOT_BACKTRACK());n.add(e[o])}return w.SUCCESS}moveValidity(e,t){H.assert(e instanceof tc,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,c3.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new it(i.map(function o(a){return tc.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new it(Pi.getNeighbors(n)).filter(function i(s){return!e.getAt(s).hasPieces()&&void 0===t.find(a=>s.equals(a))&&e.haveCommonNeighbor(s,n)}).toList().map(s=>[...t,s])}}u(K9,"INSTANCE",g.empty());class bC extends ya{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new bC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new it,o=[t];for(;o.length>0;){const s=o.pop();if(!i.contains(s)){if(i.add(s),s.equals(n))return!0;for(const a of Pi.getNeighbors(s)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,s,a);c&&l&&f&&o.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?w.failure(ur.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new it;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const o of t.emptyNeighbors(i))n.add(Qo.from(e,o).get());return n.toList()}}u(bC,"INSTANCE",g.empty());class Xne extends sC{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())e=Math.min(o.x,e),t=Math.max(o.x,t),n=Math.min(o.y,n),i=Math.max(o.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new it(Pi.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new it,t=new it;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new it,o=new it([n.key]);for(;o.hasElements();){const s=o.getAnyElement().get();o.remove(s),e.add(s),i.add(s),o.addAll(this.getOccupiedNeighbors(s).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class wC{static getInitial(){const e=new Qt;for(const t of k.PLAYERS)e.set(new ci(t,"QueenBee"),1),e.set(new ci(t,"Beetle"),2),e.set(new ci(t,"Spider"),2),e.set(new ci(t,"Grasshopper"),3),e.set(new ci(t,"SoldierAnt"),3);return e.makeImmutable(),new wC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();H.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new wC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new c3(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class X9{static of(e){return new X9(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const o of k.PLAYERS)n.get(o).equalsValue(e)&&n.delete(o);for(const o of t.pieces)"QueenBee"===o.kind&&n.put(o.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new X9(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new X9(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new As(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class As extends Xne{static fromRepresentation(e,t,n=new Vt(0,0)){const i=new _u;let o=wC.getInitial();const s=new Qt;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new v(c,a).getNext(n,1);i.set(l,new c3(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&s.set(f.get().owner,l);for(const d of e[a][c])o=o.remove(d)}return new As(i,o,s,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const o of n.listKeys()){const s=n.get(o).get();this.queenBees.replace(o,s)}this.queenBees.makeImmutable()}update(){return X9.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():c3.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of Pi.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of Pi.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class Ti extends Sr{static get(){return Ti.singleton.isAbsent()&&(Ti.singleton=g.of(new Ti)),Ti.singleton.get()}getInitialState(){return As.fromRepresentation([],0)}applyLegalMove(e,t,n,i){return e instanceof Ca?this.applyLegalDrop(e,t):e instanceof Qo?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Ca?this.isLegalDrop(e,t):e instanceof Qo?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?w.SUCCESS:w.failure(Ee.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return w.failure(ur.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const o=ya.of(i).moveValidity(e,t);if(o.isFailure())return o;const s=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(s.isDisconnected())return w.failure(ur.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===s.numberOfNeighbors(a)?w.failure(ur.CANNOT_DISCONNECT_HIVE()):w.SUCCESS}mustPlaceQueenBee(e){return 6<=e.turn&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.remainingPieces.hasRemaining(e.piece))return w.failure(ur.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return w.failure(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?w.failure(ur.MUST_DROP_ON_EMPTY_SPACE()):w.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const o of Pi.getNeighbors(e.coord)){const s=t.getAt(o);if(s.hasPieces()&&(i=!0,1!==t.turn&&s.topPiece().owner===n.getOpponent()))return w.failure(ur.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?w.failure(ur.MUST_BE_CONNECTED_TO_HIVE()):w.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new it([new v(0,0)]);if(1===e.turn)return new it(Pi.getNeighbors(new v(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new it;const i=n.get(),o=new it;for(const s of e.occupiedSpaces())if(e.getAt(s).topPiece().owner===t)for(const a of e.emptyNeighbors(s)){const c=Ca.of(i,a);this.isLegalDrop(c,e).isSuccess()&&o.add(a)}return o}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new it,o=e.getAt(t).topPiece();if(o.owner===n)for(const s of ya.of(o).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(s,e).isSuccess()&&i.add(s);return i}getPossibleMovesOnBoard(e){const t=new it;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of k.PLAYERS){const o=t.queenBeeLocation(i);o.isPresent()&&(n[i.value]=t.numberOfNeighbors(o.get()))}return 6===n[0]&&6===n[1]?_e.DRAW:6===n[0]?_e.getVictory(k.ONE):6===n[1]?_e.getVictory(k.ZERO):_e.ONGOING}}u(Ti,"singleton",g.empty());class u$e extends B1{getMetrics(e,t){const n=this.queenBeeMobility(e.gameState,k.ZERO),i=this.queenBeeMobility(e.gameState,k.ONE);return g1.of([n],[i])}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?Ti.get().getPossibleMovesFrom(e,n.get()).size():0}}class Qne extends jn{getListMoves(e,t){const n=this.getListDrops(e.gameState),i=this.getListOfOnBoardMoves(e.gameState),o=n.concat(i);return 0===o.length?[Oi.PASS]:o}getListOfOnBoardMoves(e){return Ti.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new ci(n,"QueenBee");for(const o of Ti.get().getPossibleDropLocations(e))if(Ti.get().mustPlaceQueenBee(e))t.push(Oi.drop(i,o));else for(const s of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(Oi.drop(s,o));return t}}function f$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"polygon",4),q("click",function(){const o=ee(t).$implicit;return te(p().selectSpace(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),A("points",n.getHexaPointsAtXY(t.x,t.y))}}function d$e(r,e){if(1&r){const t=ge();I(),P(0,"polygon",6),q("click",function(){ee(t);const i=p().$implicit;return te(p().selectSpace(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),A("points",n.getHexaPointsAtXY(t.x,t.y))}}function h$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,d$e,1,4,"polygon",5),S()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function g$e(r,e){if(1&r){const t=ge();I(),P(0,"polygon",8),q("click",function(){ee(t);const i=p().$implicit;return te(p().selectSpace(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),A("points",n.getHexaPointsAtXY(t.x,t.y))}}function p$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,g$e,1,3,"polygon",7),S()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.selected)}}function m$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",9),q("click",function(){const o=ee(t).$implicit;return te(p(2).selectStack(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p().index,i=p();_(1),Ce("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function _$e(r,e){if(1&r){const t=ge();I(),P(0,"polygon",6),q("click",function(){ee(t);const i=p().$implicit;return te(p(2).selectStack(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p().index,i=p();Ce("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),A("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function v$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,_$e,1,5,"polygon",5),S()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function C$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,m$e,2,8,"g",1),O(2,v$e,2,1,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t),_(1),y("ngForOf",t)}}function y$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",10),q("click",function(){const o=ee(t).$implicit;return te(p(2).selectRemaining(o))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),hn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),A("transform",i.getRemainingPieceTransform(t))}}function M$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,y$e,2,8,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.pieces)}}function E$e(r,e){if(1&r&&(I(),V(0,"polygon",11)),2&r){const t=p();A("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function P$e(r,e){if(1&r&&(I(),V(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);hn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),A("transform",i.inspectedStackTransform)}}function S$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,P$e,1,8,"g",12),S()),2&r){const t=p();_(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class Jne extends Ate{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class O$e extends Ate{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let e1e=(()=>{var r;class e extends Cu{constructor(n){super(n),u(this,"ORIGIN",new v(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new Jne),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.setRulesAndNode("Hive"),this.availableAIs=[new cn($localize`Minimax`,Ti.get(),new u$e,new Qne),new bn($localize`MCTS`,new Qne,this.rules)],this.encoder=Oi.encoder,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new yu(1.5*this.SPACE_SIZE,new v(2*this.SPACE_SIZE,0),Wr.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.layers=[];for(const s of i.getState().occupiedSpaces()){const a=i.getState().getAt(s),c=s.x,l=s.y;for(let f=0;f<a.size();f++){f in i.layers||(i.layers[f]=new O$e);const d=a.pieces[a.size()-1-f];i.layers[f].initialize(new v(c,l),d)}}i.ground=i.getGround(),i.computeViewBox(),i.remainingStacks=i.getState().remainingPieces.toListOfStacks(),i.canPass=Ti.get().shouldPass(i.getState());const o=Ti.get().getGameStatus(i.node);switch(o){case _e.ONGOING:break;case _e.DRAW:i.highlight(i.getState().queenBeeLocation(k.ZERO).get(),"victory-stroke"),i.highlight(i.getState().queenBeeLocation(k.ONE).get(),"victory-stroke");break;default:const a=o.winner.getOpponent();i.highlight(i.getState().queenBeeLocation(a).get(),"victory-stroke")}})()}highlight(n,i){const o=this.getState().getAt(n).size();o-1 in this.layers&&this.layers[o-1].highlight(n,i)}pass(){var n=this;return M(function*(){return H.assert(n.canPass,"HiveComponent: pass() can only be called if canPass is true"),yield n.chooseMove(Oi.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new v(0,0)),this.boardViewBox=sa.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new sa(this.getRemainingPieceTransformAsCoord(new ci(k.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),o=5*this.SPACE_SIZE;let s=0;this.getState().remainingPieces.getAny(k.ZERO).isPresent()&&(s=o);let a=0;this.getState().remainingPieces.getAny(k.ONE).isPresent()&&(a=o);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,s,a);if(this.inspectedStack.isPresent()){const l=new v(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new Jne;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new it;for(const i of this.getPieceCoords())n.addAll(new it(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new v(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){var i=this;return M(function*(){for(const o of i.getLastMoveCoords(n))i.highlight(o,"last-move-stroke"),i.ground.highlightStroke(o,"last-move-stroke"),i.ground.highlightFill(o,"moved-fill")})()}getLastMoveCoords(n){let i=[];return n instanceof Ca?i=[n.coord]:n instanceof Qo&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),o=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let s;return s=n.owner===this.getPointOfView()?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new v(o,s)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),o=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*o})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return H.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return M(function*(){const o=yield i.canUserPlay(`#remainingPiece_${n.toString()}`);if(o.isFailure())return i.cancelMove(o.getReason());if(n.owner===i.getCurrentOpponent())return i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if("QueenBee"!==n.kind&&Ti.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const s=Ti.get().getPossibleDropLocations(i.getState()).toList();for(const a of s)i.ground.highlightStroke(a,"clickable-stroke")}return w.SUCCESS})()}selectStack(n,i){var o=this;return M(function*(){return yield o.select(new v(n,i),"piece")})()}selectSpace(n,i){var o=this;return M(function*(){return yield o.select(new v(n,i),"space")})()}select(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay(`#${i}_${n.x}_${n.y}`);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState(),c=a.getAt(n);if(o.selectedRemaining.isPresent()){const l=Oi.drop(o.selectedRemaining.get(),n);return o.chooseMove(l)}if(o.selectedStart.isPresent()){const l=a.getAt(o.selectedStart.get()).topPiece();return o.selectedStart.equalsValue(n)?o.cancelMove():o.selectTarget(n,l)}return 0===c.size()?o.cancelMove():o.selectStart(n,c)})()}selectTarget(n,i){var o=this;return M(function*(){if("Spider"===i.kind)return o.selectNextSpiderSpace(n);{const s=Oi.move(o.selectedStart.get(),n);return nn(s.isSuccess(),"Hive: the only forbidden moves are static moves"),o.chooseMove(s.get())}})()}selectStart(n,i){var o=this;return M(function*(){const s=o.getState(),a=i.topPiece();return a.owner===s.getCurrentOpponent()?1===i.size()?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):o.inspectedStack.isPresent()?(o.cancelMoveAttempt(),o.clearHighlights(),w.SUCCESS):(o.highlight(n,"selected-stroke"),o.inspectedStack=g.of(i),o.inspectedStackCoord=g.of(n),o.computeViewBox(),w.SUCCESS):(o.cancelMoveAttempt(),o.clearHighlights(),"QueenBee"!==a.kind&&Ti.get().mustPlaceQueenBee(s)?o.cancelMove(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(o.selectedStart=g.of(n),o.highlight(n,"selected-stroke"),"Spider"===a.kind&&o.selectedSpiderCoords.push(o.selectedStart.get()),i.size()>1&&(o.inspectedStack=g.of(i),o.inspectedStackCoord=g.of(n),o.computeViewBox()),o.highlightNextPossibleCoords(n),w.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),o=i.getAt(n).topPiece(),s=Ti.get().getPossibleMovesFrom(i,n);return"Spider"===o.kind?s.filter(c=>Ct.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():s.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return M(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const s=Oi.spiderMove(i.selectedSpiderCoords);return i.chooseMove(s)}const o=K9.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(o.isFailure())return i.cancelMove(o.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const s of i.selectedSpiderCoords)i.ground.select(s);return i.highlightNextPossibleCoords(i.selectedStart.get()),w.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-hive"]],features:[Ge],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,f$e,2,4,"g",1),O(2,h$e,2,1,"g",1),O(3,p$e,2,1,"g",1),O(4,C$e,3,2,"g",1),O(5,M$e,2,1,"g",1),O(6,E$e,1,2,"polygon",2),O(7,S$e,2,1,"g",3),S()),2&n&&(A("viewBox",i.viewBox),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.layers),_(1),y("ngForOf",i.remainingStacks),_(1),y("ngIf",i.selectedRemaining.isPresent()),_(1),y("ngIf",i.inspectedStack.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const l3=new ci(k.ZERO,"QueenBee"),H0=new ci(k.ZERO,"Beetle"),zu=new ci(k.ZERO,"Grasshopper"),NC=new ci(k.ZERO,"Spider"),AC=new ci(k.ZERO,"SoldierAnt"),V0=new ci(k.ONE,"QueenBee"),V2=new ci(k.ONE,"Beetle"),EL=new ci(k.ONE,"Grasshopper"),PL=new ci(k.ONE,"Spider"),Q9=new ci(k.ONE,"SoldierAnt");class T$e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,As.fromRepresentation([[[V0],[V2],[PL],[zu]],[[zu],[],[AC],[]],[[AC],[],[],[]]],8)),j.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,As.fromRepresentation([[[],[V2],[NC]],[[Q9],[V0],[l3]],[[zu],[H0],[]]],7)),j.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,Ti.get().getInitialState(),Oi.drop(H0,new v(0,0)),$localize`Congratulations!`),j.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,As.fromRepresentation([[[V2],[zu]]],2),Oi.drop(l3,new v(2,0)),$localize`Congratulations!`),j.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,As.fromRepresentation([[[],[NC],[EL],[V0],[V2]],[[V2],[l3],[H0],[],[]]],4),[Oi.move(new v(1,1),new v(0,2)).get(),Oi.move(new v(1,1),new v(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,As.fromRepresentation([[[l3],[V0],[H0]],[[V2],[],[]]],6),[Oi.move(new v(2,0),new v(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,As.fromRepresentation([[[V2,l3],[V0],[H0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,As.fromRepresentation([[[zu],[l3],[V2],[Q9]],[[EL],[],[],[]]],6),[Oi.move(new v(0,0),new v(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,As.fromRepresentation([[[],[AC],[V0]],[[],[l3],[V2]],[[Q9],[PL],[]]],6),Oi.move(new v(1,0),new v(3,1)).get(),(t,n,i)=>t.equals(Oi.move(new v(1,0),new v(0,1)).get())?w.failure($localize`You have not freed your queen, try again!`):w.SUCCESS,$localize`Congratulations!`),j.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,As.fromRepresentation([[[],[NC],[PL],[V2]],[[],[],[],[H0]],[[V2],[],[],[Q9]],[[AC],[],[zu],[]],[[l3],[EL],[],[]]],6),Oi.spiderMove([new v(1,0),new v(1,1),new v(2,1),new v(2,2)]),$localize`Congratulations!`),j.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,As.fromRepresentation([[[],[NC],[]],[[],[l3],[V2]],[[Q9],[],[]]],6)),j.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,As.fromRepresentation([[[V2,H0],[l3],[V0]]],4))])}}class a2 extends Eu{static from(e,t){const n=Eu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new a2(e,t))}getMaximalDistance(){return 11}}u(a2,"encoder",Ko.getFallibleEncoder(a2.from));class Ma extends Bi{static get(){return Ma.singleton.isAbsent()&&(Ma.singleton=g.of(new Ma)),Ma.singleton.get()}constructor(){super(a2.from)}getInitialState(e){const t=At.UNOCCUPIED;let n=At.PLAYER_ZERO_PAWN,i=At.PLAYER_ONE_PAWN,o=At.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=At.PLAYER_ONE_PAWN,i=At.PLAYER_ZERO_PAWN,o=At.PLAYER_ZERO_KING),new Eo([[t,t,t,n,n,n,n,n,t,t,t],[t,t,t,t,t,n,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,i,t,t,t,t,n],[n,t,t,t,i,i,i,t,t,t,n],[n,n,t,i,i,o,i,i,t,n,n],[n,t,t,t,i,i,i,t,t,t,n],[n,t,t,t,t,i,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,n,t,t,t,t,t],[t,t,t,n,n,n,n,n,t,t,t]],0)}getRulesConfigDescription(){return g.of(Ma.RULES_CONFIG_DESCRIPTION)}}u(Ma,"singleton",g.empty()),u(Ma,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Hnefatafl`,config:{castleIsLeftForGood:new er(!1,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new er(!0,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new er(!1,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new er(!1,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new er(!0,Bi.INVADER_STARTS)}}));const N=At.UNOCCUPIED,It=At.PLAYER_ZERO_PAWN,fr=At.PLAYER_ONE_PAWN,IC=At.PLAYER_ONE_KING,n1e=Ma.get().getDefaultRulesConfig();class b$e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Ma.get().getInitialState(n1e)),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Ma.get().getInitialState(n1e),a2.from(new v(5,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Eo([[N,N,N,N,It,It,It,It,N,N,N],[N,N,N,N,N,It,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[It,N,N,N,N,fr,N,N,N,N,It],[It,N,N,It,fr,fr,fr,N,N,N,It],[It,It,N,fr,fr,IC,fr,fr,N,It,It],[It,N,N,N,fr,fr,fr,N,N,N,It],[It,N,N,N,N,fr,N,N,N,N,It],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,It,N,N,N,N,N],[N,N,N,It,It,It,It,It,N,N,N]],1),[a2.from(new v(5,3),new v(3,3)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(a2.from(new v(3,0),new v(3,4)).get()),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Eo([[N,N,N,It,It,It,It,It,N,N,N],[N,fr,N,N,N,It,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,fr,N,N,N,N,It],[It,N,N,N,N,fr,fr,N,N,N,It],[It,It,IC,N,fr,N,fr,fr,N,N,It],[N,N,It,N,N,fr,fr,N,N,N,It],[It,N,N,N,N,fr,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,It,N,N,N,N,N,N,N,N,N],[N,N,N,It,It,It,It,N,It,N,N]],12),[a2.from(new v(3,0),new v(3,5)).get(),a2.from(new v(3,10),new v(3,5)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Eo([[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,It,N,N,N,N,N,N,N,N,N],[It,IC,N,It,N,N,N,N,N,N,N],[N,It,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[a2.from(new v(3,4),new v(2,4)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Eo([[N,N,It,IC,It,N,N,N,N,N,N],[N,N,N,N,N,N,fr,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,It,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[a2.from(new v(3,3),new v(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function w$e(r,e){1&r&&(I(),V(0,"polygon",8))}function N$e(r,e){1&r&&(I(),V(0,"rect",9))}function A$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,w$e,1,0,"polygon",6),O(2,N$e,1,0,"ng-template",null,7,mn),S()),2&r){const t=dn(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function I$e(r,e){if(1&r&&(I(),P(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function k$e(r,e){if(1&r&&(I(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function x$e(r,e){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function L$e(r,e){if(1&r&&(I(),O(0,k$e,1,1,"polyline",14),O(1,x$e,4,20,"ng-template",null,15,mn)),2&r){const t=dn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function R$e(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",10),O(2,I$e,6,25,"g",11),O(3,L$e,3,2,"ng-template",null,12,mn),S()),2&r){const t=dn(4),n=p().index,i=p().index,o=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function z$e(r,e){if(1&r){const t=ge();I(),P(0,"g",3),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",4),O(2,A$e,4,2,"g",5),O(3,R$e,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),A("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function D$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,z$e,4,10,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function H$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",17),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let V$e=(()=>{var r;class e extends iL{constructor(n){super(n,a2.from),this.setRulesAndNode("Hnefatafl"),this.availableAIs=this.createAIs(),this.encoder=a2.encoder}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-hnefatafl"]],features:[Ge],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,D$e,2,1,"g",1),O(2,H$e,2,6,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Jo extends Jn{static get(){return Jo.singleton.isAbsent()&&(Jo.singleton=g.of(new Jo)),Jo.singleton.get()}getRulesConfigDescription(){return g.of(Jo.RULES_CONFIG_DESCRIPTION)}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]],resultingState:t};if(e.endsUpInStore)return n;{const i=e.filledCoords[e.filledCoords.length-1],o=e.resultingState.getCurrentPlayerY(),s=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,s);if(i.y===o&&1===a&&c>0){const l=t.getCopiedBoard(),f=l[0][i.x]+l[1][i.x],d=wt.create(t.getWidth(),2,0);d[0][i.x]=l[0][i.x],d[1][i.x]=l[1][i.x],l[0][i.x]=0,l[1][i.x]=0;const m=t.getScoresCopy();return m[t.getCurrentPlayer().value]+=f,{capturedSum:f,captureMap:d,resultingState:new yi(l,t.turn,m)}}return n}}}u(Jo,"singleton",g.empty()),u(Jo,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Awalé`,config:{feedOriginalHouse:new er(!0,Jn.FEED_ORIGINAL_HOUSE),mustFeed:new er(!1,Jn.MUST_FEED),passByPlayerStore:new er(!0,Jn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new er(!0,Jn.MULTIPLE_SOW),seedsByHouse:new br(4,Jn.SEEDS_BY_HOUSE,Tr.range(1,99)),width:new br(6,Ss.WIDTH,Tr.range(1,99))}}));class F$e extends Wte{constructor(){super(Jo.get())}}function $$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",8),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),A("transform",o.getPieceTransform(n,i))}}function G$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,$$e,2,9,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let B$e=(()=>{var r;class e extends Zte{constructor(n,i){super(n,i),this.setRulesAndNode("Kalah"),this.availableAIs=this.createAIs(new F$e),this.encoder=wr.encoder}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut),U(xc))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-kalah-component"]],features:[Ge],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),V(1,"rect",1),O(2,G$e,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),P(6,"g",6),q("click",function(){return i.onStoreClick(i.Player.ZERO)}),S(),P(7,"g",7),q("click",function(){return i.onStoreClick(i.Player.ONE)}),S()()),2&n&&(A("viewBox",i.getMancalaViewBox())("transform",i.rotation),_(1),A("width",i.getViewBoxWidth())("height",240),_(1),y("ngForOf",i.board),_(1),A("x2",i.getViewBoxWidth()-120),_(2),A("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),_(1),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),A("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Dt,Yte],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})),e})();const J9=Jo.get().getDefaultRulesConfig();class U$e extends qn{constructor(...e){super(...e),u(this,"gameName",$localize`Kalah`),u(this,"tutorial",[j.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,Jo.get().getInitialState(J9)),j.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,Jo.get().getInitialState(J9)),Kte.sowing(Jo.get().getInitialState(J9),wr.of(x1.of(5))),j.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your last house to the first of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,Jo.get().getInitialState(J9),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),j.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,Jo.get().getInitialState(J9),wr.of(x1.of(3),[x1.of(1)]),(t,n,i)=>1===t.distributions.length?w.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):w.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Capture`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new yi([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,[0,0]),wr.of(x1.of(1),[x1.of(0),x1.of(3)]),(t,n,i)=>0===i.getPieceAtXY(1,0)?w.SUCCESS:w.failure($localize`You did not capture, try again!`),$localize`Congratulations!`),j.fromMove($localize`End of the game`,$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new yi([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,[19,24]),[wr.of(x1.of(5))],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)])}}var u3,kC,SL,bi;class En{static of(e){switch(e){case 0:return En.ANY;case 1:return En.ORANGE;case 2:return En.BLUE;case 3:return En.PURPLE;case 4:return En.PINK;case 5:return En.YELLOW;case 6:return En.RED;case 7:return En.GREEN;default:return H.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),En.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(En,"ANY",new(u3=En)(0,"any","#000")),u(En,"ORANGE",new u3(1,"orange","#d67421")),u(En,"BLUE",new u3(2,"blue","#006bac")),u(En,"PURPLE",new u3(3,"purple","#6f3787")),u(En,"PINK",new u3(4,"pink","#d2719e")),u(En,"YELLOW",new u3(5,"yellow","#e2c200")),u(En,"RED",new u3(6,"red","#d23339")),u(En,"GREEN",new u3(7,"green","#009157")),u(En,"BROWN",new u3(8,"brown","#562500"));class Cn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new Cn(e,En.of(t))}static createPlayerColors(e){return{ORANGE:new Cn(e,En.ORANGE),BLUE:new Cn(e,En.BLUE),PURPLE:new Cn(e,En.PURPLE),PINK:new Cn(e,En.PINK),YELLOW:new Cn(e,En.YELLOW),RED:new Cn(e,En.RED),GREEN:new Cn(e,En.GREEN),BROWN:new Cn(e,En.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(W.NONE)}belongsTo(e){return this.player===e}}u(Cn,"EMPTY",new(kC=Cn)(W.NONE,En.ANY)),u(Cn,"ZERO",kC.createPlayerColors(k.ZERO)),u(Cn,"ONE",kC.createPlayerColors(k.ONE));class Oo{static getColorAt(e,t){return Oo.COLORS[t][e]}static getInitialBoard(){const e=Cn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>Cn.of(k.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>Cn.of(k.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(Cn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const o=new v(i,n);!1===Oo.isEmptyAt(e,o)&&t.push(o)}return t}}u(Oo,"INITIAL",Oo.getInitialBoard()),u(Oo,"SIZE",8),u(Oo,"COLORS",wt.map([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],En.of));class T4 extends k1{static isOnBoard(e){return e.isInRange(Oo.SIZE,Oo.SIZE)}constructor(e,t,n,i,o){super(wt.copy(o),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class Du extends yo{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(Du,"PASS",new(SL=Du)),u(Du,"encoder",Ne.constant("PASS",SL.PASS));class F0 extends n2{static of(e,t){return H.assert(T4.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),H.assert(T4.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new F0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!bi.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function W$e(r){return r instanceof Du}u(F0,"encoder",Ko.getEncoder(F0.of)),function(r){r.PASS=Du.PASS,r.of=function e(n,i){return F0.of(n,i)},r.isPiece=function t(n){return n instanceof F0},r.encoder=Ne.disjunction([r.isPiece,W$e],[F0.encoder,Du.encoder])}(bi||(bi={}));let eh=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class Xi extends Sr{static get(){return Xi.singleton.isAbsent()&&(Xi.singleton=g.of(new Xi)),Xi.singleton.get()}getInitialState(){return new T4(0,En.ANY,g.empty(),!1,Oo.INITIAL)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new v(0,7),new v(1,7),new v(2,7),new v(3,7),new v(4,7),new v(5,7),new v(6,7),new v(7,7)]}static getMovablePieces(e){return Xi.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&Oo.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===k.ONE?[ve.DOWN,ve.DOWN_LEFT,ve.DOWN_RIGHT]:[ve.UP,ve.UP_LEFT,ve.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===k.ZERO?e.y<0:e.y>0}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return Oo.allPieceCoords(e.board).forEach(i=>{const o=e.getPieceAt(i);H.assert(o!==Cn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),o.player===k.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(bi.isPiece(e)){const n=e.getStart(),i=e.getEnd(),o=t.colorToPlay,s=t.getPieceAt(n);if(s.isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.belongsTo(t.getCurrentOpponent()))return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o!==En.ANY&&s.color!==o)return w.failure(eh.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return w.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const c=ve.factory.fromMove(n,i);if(c.isFailure())return w.failure(eh.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===Xi.directionAllowedForPlayer(l,t.getCurrentPlayer()))return w.failure(eh.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return w.failure(eh.MOVE_BLOCKED());return w.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?w.SUCCESS:w.failure(Ee.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(Oo.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n,i){if(bi.isPiece(e)){const o=e.getStart(),s=e.getEnd(),a=t.getCopiedBoard();a[s.y][s.x]=a[o.y][o.x],a[o.y][o.x]=Cn.EMPTY;const c=Oo.getColorAt(s.x,s.y),l=this.nextCoordToPlay(t,c);return new T4(t.turn+1,c,l,!1,a)}{const o=this.nextCoordToPlay(t,t.colorToPlay);return new T4(t.turn+1,t.colorToPlay,o,!0,t.board)}}isLegal(e,t){return Xi.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(Xi.mustPass(t)&&t.alreadyPassed)return _e.getDefeat(n);const[i,o]=Xi.getFurthestPiecePositions(t);return 7===o?_e.ONE_WON:0===i?_e.ZERO_WON:_e.ONGOING}}u(Xi,"singleton",g.empty());class q$e extends B1{getMetrics(e,t){const n=e.gameState,[i,o]=Xi.getFurthestPiecePositions(n);return g1.of([7-i],[o])}}class o1e extends jn{getListMoves(e,t){const n=e.gameState,i=Xi.getMovablePieces(n);if(0===i.length)return H.assert(!1===n.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[bi.PASS];{const o=this.getListMovesFromNonBlockedState(n,i);return Ct.sortByDescending(o,s=>s.length()),o}}getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const o of t)for(const s of Xi.playerDirections(i))for(let a=1;a<Oo.SIZE;a++){const c=o.getNext(s,a);if(!e.isOnBoard(c)||!Oo.isEmptyAt(e.board,c))break;{const l=bi.of(o,c);n.push(l)}}return n}}function j$e(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.piecePlayerClass(n)),A("cx",s.SPACE_SIZE/2+i*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+o*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Z$e(r,e){if(1&r&&(I(),V(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();A("x",s.SPACE_SIZE/2+n*s.SPACE_SIZE-s.SPACE_SIZE/8)("y",s.SPACE_SIZE/2+o*s.SPACE_SIZE-s.SPACE_SIZE/8)("rx",s.isPlayerZero(i)?s.SPACE_SIZE:0)("ry",s.isPlayerZero(i)?s.SPACE_SIZE:0)("width",s.SPACE_SIZE/4)("height",s.SPACE_SIZE/4)("fill",s.pieceColor(i))}}function Y$e(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",4),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(2,"rect",5),O(3,j$e,1,4,"circle",6),O(4,Z$e,1,7,"rect",7),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),_(1),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(n,i)),_(1),y("ngIf",t!==o.UNOCCUPIED),_(1),y("ngIf",t!==o.UNOCCUPIED)}}function K$e(r,e){if(1&r&&(I(),P(0,"g"),O(1,Y$e,5,9,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function X$e(r,e){if(1&r&&(I(),P(0,"g"),V(1,"rect",10)(2,"rect",10),S()),2&r){const t=p();_(1),Ce("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),A("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),Ce("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),A("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Q$e(r,e){if(1&r&&(I(),V(0,"circle",11)),2&r){const t=p();A("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let J$e=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"UNOCCUPIED",Cn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.setRulesAndNode("Kamisado"),this.availableAIs=[new cn($localize`Minimax`,Xi.get(),new q$e,new o1e),new bn($localize`MCTS`,new o1e,this.rules)],this.encoder=bi.encoder,this.hasAsymmetricBoard=!0}backgroundColor(n,i){return Oo.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===k.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.lastPieceMove=g.empty(),i.canPass=Xi.mustPass(o);const s=i.rules.getGameStatus(i.node)!==_e.ONGOING;i.canPass||o.coordToPlay.isAbsent()||s?(i.chosenAutomatically=!1,i.chosen=g.empty()):(i.chosenAutomatically=!0,i.chosen=o.coordToPlay)})()}showLastMove(n){var i=this;return M(function*(){bi.isPiece(n)&&(i.lastPieceMove=g.of(n))})()}pass(){var n=this;return M(function*(){return nn(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(bi.PASS)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);if(o.canPass)return o.cancelMove(Ee.MUST_PASS());if(o.chosen.isAbsent())return o.choosePiece(n,i);if(!1===o.chosenAutomatically&&o.chosen.equalsValue(a))return o.cancelMoveAttempt(),w.SUCCESS;{const c=o.getState().getPieceAtXY(n,i),l=o.getState().getCurrentPlayer();return c.belongsTo(l)?o.chosenAutomatically?o.cancelMove(eh.PLAY_WITH_SELECTED_PIECE()):(o.chosen=g.of(a),w.SUCCESS):yield o.chooseDestination(n,i)}})()}choosePiece(n,i){var o=this;return M(function*(){const s=o.getState().getPieceAtXY(n,i),a=o.getState().getCurrentOpponent();return s.belongsTo(a)?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(o.chosen=g.of(new v(n,i)),w.SUCCESS)})()}chooseDestination(n,i){var o=this;return M(function*(){const s=o.chosen.get(),a=new v(n,i),c=bi.of(s,a);return o.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-kamisado"]],features:[Ge],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,K$e,2,1,"g",1),O(2,X$e,3,12,"g",2),O(3,Q$e,1,3,"circle",3),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.lastPieceMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const K=Cn.EMPTY,xC=Cn.ZERO.ORANGE,LC=Cn.ONE.ORANGE,RC=Cn.ZERO.BLUE,zC=Cn.ONE.BLUE,OL=Cn.ZERO.PURPLE,th=Cn.ONE.PURPLE,DC=Cn.ZERO.PINK,HC=Cn.ONE.PINK,VC=Cn.ZERO.YELLOW,FC=Cn.ONE.YELLOW,$C=Cn.ZERO.RED,GC=Cn.ONE.RED,BC=Cn.ZERO.GREEN,UC=Cn.ONE.GREEN,WC=Cn.ZERO.BROWN,qC=Cn.ONE.BROWN;class eGe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new T4(5,En.ORANGE,g.empty(),!1,[[WC,zC,th,HC,FC,GC,UC,qC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,LC,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,BC,$C,VC,DC,OL,RC,xC]])).withPreviousMove(bi.of(new v(0,7),new v(0,0))),j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,Xi.get().getInitialState(),bi.of(new v(7,7),new v(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),j.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new T4(1,En.PINK,g.of(new v(3,0)),!1,[[LC,zC,th,HC,FC,GC,UC,qC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,RC,K],[K,K,K,K,K,K,K,K],[WC,BC,$C,VC,DC,OL,K,xC]]),[bi.of(new v(3,0),new v(3,6)),bi.of(new v(3,0),new v(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(bi.of(new v(6,7),new v(6,5))),j.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new T4(1,En.PINK,g.of(new v(3,6)),!1,[[LC,zC,th,K,FC,GC,UC,qC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,RC],[K,K,K,K,K,K,K,K],[K,K,K,HC,K,K,K,K],[WC,BC,$C,VC,DC,OL,K,xC]])).withPreviousMove(bi.of(new v(6,5),new v(7,4))),j.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new T4(2,En.RED,g.of(new v(2,4)),!1,[[K,zC,th,K,K,GC,K,K],[K,K,K,FC,K,K,K,K],[K,K,K,HC,K,th,K,K],[K,K,K,VC,K,K,K,K],[K,K,$C,K,K,K,K,K],[K,K,K,K,K,K,UC,K],[LC,K,K,K,K,DC,K,qC],[WC,BC,K,K,K,K,RC,xC]]),[bi.of(new v(2,4),new v(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(bi.of(new v(4,0),new v(3,1)))])}}let s1e=(()=>{var r;class e extends Mo{getParallelogramCoords(n){const i=n.parallelogramHeight,o=i*n.horizontalWidthRatio,s=i*n.offsetRatio,a=o,l=o-s,f=i,d=-s,m=i;return[new v(0,0),new v(a,0),new v(l,f),new v(d,m)]}getCoordTranslate(n,i,o,s){const a=s.parallelogramHeight;return new v(n*(a*s.horizontalWidthRatio)+s.offsetRatio*a*(s.abstractBoardSize-i),i*a-s.pieceHeightRatio*a*o)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),b4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var nh;class Qi{static getPlayerOfficer(e){return e===k.ZERO?Qi.ZERO_OFFICER:Qi.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case Qi.ZERO:return"u";case Qi.ONE:return"v";case Qi.ZERO_OFFICER:return"O";default:return H.expectToBe(this,Qi.ONE_OFFICER),"X"}}equals(e){return this===e}}u(Qi,"ZERO",new(nh=Qi)(k.ZERO,!1)),u(Qi,"ONE",new nh(k.ONE,!1)),u(Qi,"ZERO_OFFICER",new nh(k.ZERO,!0)),u(Qi,"ONE_OFFICER",new nh(k.ONE,!0));class Is{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Is(this.pieces.slice(1))}capturePiece(e){return new Is(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=Qi.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new Is([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(Is,"EMPTY",new Is([]));let jr=(()=>{class r extends k1{static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++)this.getPieceAtXY(o,i).isCommandedBy(t)&&n.push(new v(o,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,Is.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===k.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++){const s=this.getPieceAtXY(o,i).getStackSize();t=Math.max(t,s)}const n=[];for(let i=0;i<r.SIZE;i++){const o=[];for(let s=0;s<r.SIZE;s++)o.push(this.getPieceAtXY(s,i).toString(t));n.push(o.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class tGe extends it{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===k2(e.get(t),this.get(t)))return!1;return!0}get(e){return H.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return H.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var c1e;class Zr extends yo{static of(e,t){return new Zr(e,t)}static fromCapture(e){const t=Zr.getSteppedOverCoords(e);return t.isSuccess()?Q.success(new Zr(e,!1)):Q.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new it;for(const i of e){if(jr.isNotOnBoard(i))return Q.failure(Ps.OUT_OF_RANGE(i));if(t.isPresent()){const o=t.get();if(!1===o.getVectorToward(i).isDiagonalOfLength(2))return Q.failure(b4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=o.getCoordsToward(i)[0];if(n.contains(a))return Q.failure(b4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return Q.success(n)}static fromStep(e,t){return jr.isNotOnBoard(e)?Q.failure(Ps.OUT_OF_RANGE(e)):jr.isNotOnBoard(t)?Q.failure(Ps.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?Q.failure(b4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):Q.success(new Zr([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new tGe(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let o=0;o<i;o++)if(!1===this.coords.toList()[o].equals(e.coords.toList()[o]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Zr.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];nn(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),o=Ct.copy(i),s=e.coords.toList(),a=Ct.copy(s).slice(1);return Zr.fromCapture(o.concat(a)).get()}}c1e=Zr,u(Zr,"encoder",Ne.tuple([Ne.list(v.encoder),Ne.identity()],r=>[r.coords.toList(),r.isStep],r=>c1e.of(r[0],r[1])));class c2 extends Sr{static get(){return c2.singleton.isAbsent()&&(c2.singleton=g.of(new c2)),c2.singleton.get()}getInitialState(){const e=new Is([Qi.ZERO]),t=new Is([Qi.ONE]),n=Is.EMPTY;return new jr([[t,n,t,n,t,n,t],[n,t,n,t,n,t,n],[t,n,t,n,t,n,t],[n,n,n,n,n,n,n],[e,n,e,n,e,n,e],[n,e,n,e,n,e,n],[e,n,e,n,e,n,e]],0)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceCaptures(e,o));return n}getPieceCaptures(e,t){let n=[];const s=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(jr.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(s)){const d=f.getNext(l,1);if(jr.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),E=Zr.fromCapture([t,d]).get(),T=this.getPieceCaptures(m,d);if(0===T.length)n=n.concat(E);else{const L=T.map(z=>E.concatenate(z));n=n.concat(L)}}}}return n}getPieceDirections(e,t){const o=e.getPieceAt(t).getCommander().player.getScoreModifier(),s=[ve.factory.fromDelta(-1,o).get(),ve.factory.fromDelta(1,o).get()];return e.getPieceAt(t).getCommander().isOfficer&&s.push(ve.factory.fromDelta(-1,-o).get(),ve.factory.fromDelta(1,-o).get()),s}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceSteps(e,o));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const o of i){const s=t.getNext(o,1);if(jr.isOnBoard(s)&&e.getPieceAt(s).isEmpty()){const a=Zr.fromStep(t,s).get();n.push(a)}}return n}applyLegalMove(e,t,n,i){const o=e.getStartingCoord(),s=e.getEndingCoord();let a=t.getPieceAt(o),c=t.remove(o);if(!1===e.isStep)for(const l of e.getCapturedCoords().get()){const f=t.getPieceAt(l),d=f.getCommander();a=a.capturePiece(d);const m=f.getPiecesUnderCommander();c=c.set(l,m)}if(c=c.set(s,a),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const l=a.promoteCommander();c=c.set(s,l)}return c.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),o=t.getCurrentOpponent();if(i.isCommandedBy(o))return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const s=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(s).get().y===o.getScoreModifier())return w.failure(b4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(s).isEmpty())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?w.failure(b4.CANNOT_SKIP_CAPTURE()):w.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),o=e.getCapturedCoords().get();for(const s of o){const a=t.getPieceAt(s);if(a.isCommandedBy(i))return w.failure(Ee.CANNOT_SELF_CAPTURE());if(a.isEmpty())return w.failure(b4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(s=>s.equals(e))?w.SUCCESS:w.failure(b4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?_e.ONGOING:_e.getVictory(t.getCurrentOpponent())}}u(c2,"singleton",g.empty());class l1e extends B1{getMetrics(e,t){return this.getControlScore(e)}getControlScore(e){const t=e.gameState,n=g1.of([0],[0]);for(const i of k.PLAYERS)n.add(i,0,this.getNumberOfMobileCoords(t,i));return n}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(s=>s.getStartingCoord());return new it(i).size()}getCapturesAndSteps(e,t){const n=c2.get().getCapturesOf(e,t),i=c2.get().getStepsOf(e,t);return n.concat(i)}}class nGe extends jn{getListMoves(e,t){const n=c2.get().getCaptures(e.gameState);return n.length>0?n:c2.get().getSteps(e.gameState)}}class rGe extends l1e{getMetrics(e,t){const n=this.getControlScore(e),i=this.getDominatedPieceScore(e);return n.concat(i)}getDominatedPieceScore(e){const t=g1.of([0],[0]),n=e.gameState,i=n.getWidth(),o=n.getHeight();for(let s=0;s<o;s++)for(let a=0;a<i;a++){const c=n.getPieceAtXY(a,s);if(c.getStackSize()>0){const l=c.getStackSize();let f=0;const d=c.getCommander().player;for(;f<l&&c.get(f).player===d;)f++;t.add(d,0,f)}}return t}}function iGe(r,e){if(1&r&&(I(),V(0,"circle",15)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p(2);Hr("id","square_",o.x,"_",o.y,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),A("cx",.4*s.SPACE_SIZE)("cy",.575*s.SPACE_SIZE)("r",.045*s.SPACE_SIZE)}}function oGe(r,e){if(1&r&&(I(),P(0,"g",12),V(1,"use",13),O(2,iGe,1,7,"circle",14),S()),2&r){const t=e.$implicit,n=e.index,i=p().$implicit;A("transform",p(2).getPieceTranslate(n)),_(1),Hr("id","square_",i.x,"_",i.y,"_piece_",n,""),y("ngClass",t.classes),_(1),y("ngIf",t.isOfficer)}}function sGe(r,e){if(1&r){const t=ge();I(),P(0,"g",8)(1,"g",9),q("click",function(){const o=ee(t).$implicit;return te(p(2).onClick(o.x,o.y))}),V(2,"polygon",10),O(3,oGe,3,6,"g",11),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","square_at_",n,"_",i,""),_(1),Ce("id","coord_",t.x,"_",t.y,""),A("transform",o.getTranslate(n,i,0)),_(1),Ce("id","square_",t.x,"_",t.y,""),y("ngClass",t.squareClasses),A("points",o.getParallelogramPoints()),_(1),y("ngForOf",t.pieceInfos)}}function aGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,sGe,4,10,"g",7),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let cGe=(()=>{var r;class e extends s1e{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:jr.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),u(this,"moveGenerator",new nGe),this.setRulesAndNode("Lasca"),this.availableAIs=[new cn($localize`Control`,this.rules,new l1e,this.moveGenerator),new cn($localize`Control and Domination`,this.rules,new rGe,this.moveGenerator),new bn($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=Zr.encoder,this.hasAsymmetricBoard=!0}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.legalMoves=i.moveGenerator.getListMoves(i.node,i.config),i.createAdaptedBoardFrom(o),i.showPossibleMoves(),i.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let s=0;s<jr.SIZE;s++){const a=[];for(let c=0;c<jr.SIZE;c++){const l=this.getSpaceInfo(n,c,s);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const o=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(o.isPresent()){const s=o.get();for(const a of this.getSpaceInfoAt(s).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(s,n)}for(const s of this.capturedCoords)this.getSpaceInfoAt(s).squareClasses.push("captured-fill");for(const s of this.currentMoveClicks)this.getSpaceInfoAt(s).squareClasses.push("moved-fill")}getSpaceInfo(n,i,o){const s=n.getPieceAtXY(i,o),a=[];for(let c=s.getStackSize()-1;0<=c;c--){const l=s.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,x:i,y:o,squareClasses:[]}}showLastMove(n){var i=this;return M(function*(){i.showLastCapture(n),i.showSteppedOnCoord(n)})()}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();H.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const o of i.get())this.getSpaceInfoAt(o).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){if(this.interactive)for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.getPointOfView()===k.ONE&&this.adaptedBoard.isAlreadySwitched){const i=jr.SIZE-1,o=new v(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[o.y][o.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.getPointOfView()===k.ONE){const n=[];for(let i=0;i<jr.SIZE;i++){n[jr.SIZE-1-i]=[];for(let o=0;o<jr.SIZE;o++)n[jr.SIZE-1-i][jr.SIZE-1-o]=this.getSpaceInfoAt(new v(o,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#coord_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i),c=o.getState().getPieceAt(a),l=o.getState().getCurrentOpponent();return c.isCommandedBy(l)?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===o.currentMoveClicks.length?o.trySelectingPiece(a):o.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return M(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),w.SUCCESS;const o=i.getState().getPieceAt(n),s=i.getState().getCurrentPlayer();if(o.isCommandedBy(s))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=Zr.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return M(function*(){const s=i.currentMoveClicks[i.currentMoveClicks.length-1],a=s.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new v(s.x+a.x/2,s.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=Zr.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(b4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const s of this.capturedCoords){const a=this.getState().getPieceAt(s),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(s,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),w.SUCCESS}trySelectingPiece(n){var i=this;return M(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){var i=this;return M(function*(){return i.capturedCoords=[],i.legalMoves.some(o=>o.getStartingCoord().equals(n))?(i.currentMoveClicks=[n],i.hideLastMove(),w.SUCCESS):i.cancelMove(b4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(n,i){const o=this.rules.getPieceCaptures(i,n);if(0===o.length){const s=this.rules.getPieceSteps(i,n);for(const a of s)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const s=o.map(a=>a.coords.get(1));for(const a of s)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,o){const s=this.getCoordTranslate(n,i,o,this.mode);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,o,s){const a=Math.max(n.x,i.x,o.x,s.x),c=Math.max(n.y,i.y,o.y,s.y),l=Math.min(n.x,i.x,o.x,s.x),f=Math.min(n.y,i.y,o.y,s.y);return new v((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-lasca"]],features:[Ge],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),S()(),O(5,aGe,2,1,"g",4),V(6,"rect",5)(7,"polygon",6),S()),2&n&&(A("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(5),y("ngForOf",i.adaptedBoard.spaceInfo),_(1),A("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),_(1),A("points",i.getRightEdge()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const u1e=Qi.ZERO,TL=Qi.ONE,Yr=new Is([u1e]),R1=new Is([TL]),lGe=new Is([u1e,TL]),uGe=new Is([Qi.ZERO_OFFICER,TL]),Y=Is.EMPTY;class fGe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,c2.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,c2.get().getInitialState()),j.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,c2.get().getInitialState(),Zr.fromStep(new v(4,4),new v(3,3)).get(),$localize`Congratulations!`),j.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,jr.of([[R1,Y,Y,Y,R1,Y,R1],[Y,Y,Y,R1,Y,R1,Y],[Y,Y,R1,Y,R1,Y,R1],[Y,R1,Y,Y,Y,Y,Y],[Yr,Y,Yr,Y,Yr,Y,Yr],[Y,Yr,Y,Yr,Y,Yr,Y],[Yr,Y,Yr,Y,Yr,Y,Yr]],2),Zr.fromCapture([new v(2,4),new v(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),j.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,jr.of([[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[R1,Y,Y,Y,R1,Y,R1],[Y,R1,Y,R1,Y,R1,Y],[Y,Y,R1,Y,R1,Y,R1],[Y,R1,Y,Y,Y,Y,Y],[Y,Y,Yr,Y,Yr,Y,Yr]],2),Zr.fromCapture([new v(2,6),new v(0,4),new v(2,2)]).get(),$localize`Congratulations!`),j.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,jr.of([[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,R1,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,R1,Y,R1,Y,Y,Y],[Y,Y,Yr,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y]],2)),j.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,jr.of([[Y,Y,Y,Y,Y,Y,R1],[Y,Y,Y,lGe,Y,R1,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Yr,Y,Yr,Y,Yr]],2),[Zr.fromStep(new v(3,1),new v(2,0)).get(),Zr.fromStep(new v(3,1),new v(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),j.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,jr.of([[Y,Y,Y,Y,uGe,Y,R1],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,R1,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Yr,Y,Yr,Y,Yr]],2),[Zr.fromStep(new v(4,0),new v(3,1)).get(),Zr.fromStep(new v(4,0),new v(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}let es=(()=>{class r extends k1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class ts extends n2{static from(e,t){const n=ve.factory.fromMove(e,t);return n.isFailure()?Q.failure(n.getReason()):e.isNotInRange(es.SIZE,es.SIZE)?Q.failure("start coord is not in range"):t.isNotInRange(es.SIZE,es.SIZE)?Q.failure("end coord is not in range"):Q.success(new ts(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=ve.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u(ts,"encoder",Ko.getFallibleEncoder(ts.from));let bL=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class li extends Sr{static get(){return li.singleton.isAbsent()&&(li.singleton=g.of(new li)),li.singleton.get()}getInitialState(){const e=W.NONE,t=W.ZERO,n=W.ONE;return new es([[e,t,t,t,t,t,t,e],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[e,t,t,t,t,t,t,e]],0)}static getNumberOfGroups(e){const t=wt.create(es.SIZE,es.SIZE,-1),n=[0,0];let i=0;for(const o of e.getCoordsAndContents())-1===t[o.coord.y][o.coord.x]&&o.content.isPlayer()&&(i+=1,li.markGroupStartingAt(e,t,o.coord,i),n[o.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const o=[n],s=e.getPieceAt(n);for(;o.length>0;){const a=H.getNonNullable(o.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===s){t[a.y][a.x]=i;for(const l of ve.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&o.push(f)}}else c===W.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.getStart().y][e.getStart().x]=W.NONE,o[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new es(o,t.turn+1)}static isLegal(e,t){const n=t.getPieceAt(e.getStart());return n===W.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?w.failure(bL.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(i=>t.getPieceAt(i)===t.getCurrentOpponent())?w.failure(bL.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?w.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):w.SUCCESS}isLegal(e,t){return li.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const o of li.getLineCoords(t,n))e.getPieceAt(o).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=li.getEntranceAndForwardDirection(e,t);let i=n[0];const o=n[1],s=[];for(;es.isOnBoard(i);)s.push(i),i=i.getNext(o);return s}static getEntranceAndForwardDirection(e,t){switch(t){case ve.UP:case ve.DOWN:return[new v(e.x,0),ve.DOWN];case ve.LEFT:case ve.RIGHT:return[new v(0,e.y),ve.RIGHT];case ve.UP_RIGHT:case ve.DOWN_LEFT:return[new v(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),ve.UP_RIGHT];default:return H.expectToBeMultiple(t,[ve.UP_LEFT,ve.DOWN_RIGHT]),[new v(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),ve.DOWN_RIGHT]}}static getVictory(e){const[t,n]=li.getNumberOfGroups(e);return 1===t&&1===n?g.of(W.NONE):1===t?g.of(k.ZERO):1===n?g.of(k.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of ve.DIRECTIONS){const o=li.numberOfPiecesOnLine(e,t,i),s=t.getNext(i,o);if(e.isOnBoard(s)){const a=ts.from(t,s).get();li.isLegal(a,e).isSuccess()&&n.push(s)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=li.getNumberOfGroups(t);return 1===n&&i>1?_e.ZERO_WON:n>1&&1===i?_e.ONE_WON:_e.ONGOING}}u(li,"singleton",g.empty());class dGe extends B1{getMetrics(e,t){const n=e.gameState,[i,o]=li.getNumberOfGroups(n);return g1.of([100/i],[100/o])}}class d1e extends jn{getListMoves(e,t){const n=e.gameState,i=[];if(li.getVictory(n).isPresent())return i;for(let o=0;o<es.SIZE;o++)for(let s=0;s<es.SIZE;s++){const a=new v(s,o);if(n.getPieceAt(a).isPlayer())for(const l of li.possibleTargets(n,a)){const f=ts.from(a,l).get();i.push(f)}}return i}}function hGe(r,e){if(1&r&&(I(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),A("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function gGe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",3),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(2,"rect",4),O(3,hGe,1,6,"circle",5),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","click_",n,"_",i,""),_(1),Ce("id","space_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function pGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,gGe,4,10,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function mGe(r,e){if(1&r){const t=ge();I(),P(0,"rect",6),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p();A("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let _Ge=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",W.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.setRulesAndNode("LinesOfAction"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new dGe,new d1e),new bn($localize`MCTS`,new d1e,this.rules)],this.encoder=ts.encoder}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);if(o.selected.equalsValue(a))return o.cancelMoveAttempt(),w.SUCCESS;const c=o.getState().getCurrentPlayer();return o.selected.isAbsent()||o.getState().getPieceAt(a)===c?o.select(a):o.concludeMove(a)})()}concludeMove(n){var i=this;return M(function*(){const o=ts.from(i.selected.get(),n);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())})()}select(n){var i=this;return M(function*(){const o=i.getState().getPieceAt(n);return o===W.NONE?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):o===i.getState().getCurrentOpponent()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.selected=g.of(n),i.targets=li.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(bL.PIECE_CANNOT_MOVE()):w.SUCCESS)})()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.board=i.getState().board,i.lastMove=i.node.previousMove})()}showLastMove(n){var i=this;return M(function*(){i.captured=i.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()})()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const o=new v(n,i);if(this.lastMove.isPresent()){const s=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&o.equals(this.captured.get()))return["captured-fill"];if(o.equals(s)||o.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const o=this.board[i][n],s=new v(n,i),a=[this.getPlayerClass(o)];return this.selected.isPresent()&&this.selected.get().equals(s)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-linesofaction"]],features:[Ge],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,pGe,2,1,"g",1),O(2,mGe,1,4,"rect",2),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.targets))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const $=W.NONE,P1=W.ZERO,v1=W.ONE;class vGe{constructor(){u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new es([[$,$,$,$,$,$,$,$],[v1,$,$,$,P1,$,$,v1],[$,$,P1,P1,v1,$,$,$],[$,$,$,P1,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$]],0)),j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,li.get().getInitialState(),ts.from(new v(1,7),new v(1,5)).get(),$localize`Congratulations!`),j.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new es([[$,$,$,$,$,$,$,$],[$,$,v1,P1,P1,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,v1],[$,$,$,$,$,$,$,P1]],0),[ts.from(new v(3,1),new v(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),j.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new es([[$,$,$,$,$,$,v1,$],[$,$,$,$,$,P1,$,$],[$,$,$,$,v1,$,$,$],[$,$,$,P1,$,$,$,$],[$,$,$,$,$,$,$,v1],[$,$,$,$,$,v1,$,v1],[$,$,$,P1,$,$,v1,v1],[$,$,$,P1,$,$,$,$]],0),[ts.from(new v(3,3),new v(3,0)).get(),ts.from(new v(3,3),new v(0,0)).get(),ts.from(new v(3,3),new v(2,3)).get(),ts.from(new v(3,3),new v(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),j.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new es([[$,P1,$,P1,P1,P1,P1,$],[v1,$,$,$,$,$,$,v1],[$,$,P1,$,v1,$,$,$],[v1,$,$,$,$,$,$,v1],[v1,$,$,$,$,$,$,v1],[v1,$,$,$,$,$,$,v1],[v1,$,$,$,$,$,$,v1],[$,P1,P1,P1,P1,P1,P1,$]],0),ts.from(new v(2,2),new v(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===W.ONE?w.SUCCESS:w.failure($localize`Failed. Try again.`),$localize`Congratulations!`),j.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new es([[$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$],[P1,$,$,P1,v1,P1,$,$],[$,$,$,P1,$,$,$,v1],[$,$,$,$,$,$,$,v1],[$,$,$,$,$,$,$,v1],[$,$,$,$,$,$,$,v1],[$,$,$,$,$,$,$,$]],0),[ts.from(new v(0,2),new v(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}var h1e,wL,NL,To;class nc extends Or{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}h1e=nc,u(nc,"encoder",new class extends Ne{encode(r){return{coord:v.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return nn(null!=e.coord,"Invalid encoded LodestoneMove"),nn(null!=e.direction,"Invalid encoded LodestoneMove"),nn(null!=e.orientation,"Invalid encoded LodestoneMove"),nn(null!=e.captures,"Invalid encoded LodestoneMove"),new h1e(v.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class ks{constructor(e){u(this,"unreachable",void 0),u(this,"owner",W.NONE),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(ks,"UNREACHABLE",new(wL=ks)(!0)),u(ks,"EMPTY",new wL(!1));class rc{static of(e){return e===k.ZERO?rc.ZERO:rc.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(rc,"ZERO",new(NL=rc)(k.ZERO)),u(rc,"ONE",new NL(k.ONE));class bo{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return bo.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(bo,"ZERO_PUSH_DIAGONAL",new(To=bo)(k.ZERO,"push","diagonal")),u(bo,"ZERO_PUSH_ORTHOGONAL",new To(k.ZERO,"push","orthogonal")),u(bo,"ZERO_PULL_DIAGONAL",new To(k.ZERO,"pull","diagonal")),u(bo,"ZERO_PULL_ORTHOGONAL",new To(k.ZERO,"pull","orthogonal")),u(bo,"ONE_PUSH_DIAGONAL",new To(k.ONE,"push","diagonal")),u(bo,"ONE_PUSH_ORTHOGONAL",new To(k.ONE,"push","orthogonal")),u(bo,"ONE_PULL_DIAGONAL",new To(k.ONE,"pull","diagonal")),u(bo,"ONE_PULL_ORTHOGONAL",new To(k.ONE,"pull","orthogonal")),u(bo,"LODESTONES",{0:{push:{diagonal:To.ZERO_PUSH_DIAGONAL,orthogonal:To.ZERO_PUSH_ORTHOGONAL},pull:{diagonal:To.ZERO_PULL_DIAGONAL,orthogonal:To.ZERO_PULL_ORTHOGONAL}},1:{push:{diagonal:To.ONE_PUSH_DIAGONAL,orthogonal:To.ONE_PUSH_ORTHOGONAL},pull:{diagonal:To.ONE_PULL_DIAGONAL,orthogonal:To.ONE_PULL_ORTHOGONAL}}});class xs{static of(e){let t=[];for(const n of e){const i=new w4(n,[]);t=t.concat(i)}return new xs(t)}constructor(e){u(this,"plates",void 0),this.plates=e}getCrumbledPlates(){const e=[];for(const t of this.plates){if(0!==t.getRemainingSpaces())return e;e.push(t)}return e}getCurrentPlate(){for(const e of this.plates)if(e.getRemainingSpaces()>0)return g.of(e);return g.empty()}getFollowingPlates(){const e=[];let t=!1;for(const n of this.plates)t?e.push(n):n.getRemainingSpaces()>0&&(t=!0);return e}getCurrentPlateWidth(){const e=this.getCurrentPlate(),t=new w4(0,[]);return e.getOrElse(t).width}getGroupRemainingSpaces(){return this.plates.map(n=>n.getRemainingSpaces()).reduce((n,i)=>n+i)}addCaptured(e,t){if(0===t)return this;const n=this.getGroupRemainingSpaces();H.assert(t<=n,`should never put more pieces than the plate can support (${n} > ${t})`);const i=this.getCrumbledPlates(),o=this.getCurrentPlate().get(),s=this.getFollowingPlates(),a=Ct.copy(o.getPiecesCopy()),c=Math.min(t,o.getRemainingSpaces());for(let d=0;d<c;d++)a.push(rc.of(e)),t--;const l=new w4(o.width,a);return new xs(i.concat(l).concat(s)).addCaptured(e,t)}getFillablePlateIndex(){let e=0;for(const t of this.plates){if(t.getRemainingSpaces()>0)return e;e++}return-1}}let w4=(()=>{class r{constructor(t,n){u(this,"width",void 0),u(this,"pieces",void 0),this.width=t,this.pieces=n}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:ks.EMPTY}getRemainingSpaces(){return this.width-this.pieces.length}getPiecesCopy(){return Ct.copy(this.pieces)}}return u(r,"POSITIONS",["top","bottom","left","right"]),r})();var jC;!function(r){r.getInitialLodestonePressurePlates=function e(t){const n={};for(const i of w4.POSITIONS)n[i]=xs.of(t);return n}}(jC||(jC={}));class s1 extends k1{constructor(e,t,n,i){super(e,t),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=n,this.pressurePlates=i}withBoard(e){return new s1(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const t of w4.POSITIONS){const n=this.pressurePlates[t];e[t]=-1===n.getFillablePlateIndex()?0:n.getGroupRemainingSpaces()}return e}numberOfPieces(){const e=[0,0];for(let t=0;t<s1.SIZE;t++)for(let n=0;n<s1.SIZE;n++){const i=this.getPieceAtXY(n,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[s1.NUMBER_OF_PIECES-e[1],s1.NUMBER_OF_PIECES-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return g.empty();{const n=this.getPieceAt(t.get());switch(nn(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}u(s1,"SIZE",8),u(s1,"NUMBER_OF_PIECES",24),u(s1,"INITIAL_PRESSURE_PLATES",jC.getInitialLodestonePressurePlates([5,3]));let Hu=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class Ir extends Sr{static get(){return Ir.singleton.isAbsent()&&(Ir.singleton=g.of(new Ir)),Ir.singleton.get()}getInitialState(){const e=ks.EMPTY,t=rc.ZERO,n=rc.ONE,i=[[e,e,t,n,t,n,e,e],[e,t,n,t,n,t,n,e],[t,n,t,n,t,n,t,n],[n,t,n,e,e,t,n,t],[t,n,t,e,e,n,t,n],[n,t,n,t,n,t,n,t],[e,n,t,n,t,n,t,e],[e,e,n,t,n,t,e,e]],o=jC.getInitialLodestonePressurePlates([5,3]);return new s1(i,0,new Qt,o)}applyLegalMove(e,t,n,i){const o=t.getCurrentPlayer(),s=o.getOpponent(),a=wt.copy(i.board),c=t.lodestones.getCopy();c.put(o,e.coord);const l={...t.pressurePlates};return this.updatePressurePlates(a,l,c,s,e.captures),new s1(a,t.turn+1,c,l)}updatePressurePlates(e,t,n,i,o){for(const s of w4.POSITIONS)t[s]=this.updatePressurePlate(e,s,t[s],n,i,o[s])}updatePressurePlate(e,t,n,i,o,s){if(n.getCurrentPlate().isPresent()){const a=n.addCaptured(o,s),c=Ir.THREATENED_COORD_RANGE.get(t).get(),l=a.getCrumbledPlates().length;for(let f=0;f<l;f++)this.removePressurePlate(e,c.start(f,a.plates[f].width),c.direction,i);return a}return n}removePressurePlate(e,t,n,i){for(let o=t;o.isInRange(s1.SIZE,s1.SIZE);o=o.getNext(n)){for(const s of k.PLAYERS)i.get(s).equalsValue(o)&&i.delete(s);e[o.y][o.x]=ks.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return Q.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return Q.failure(Hu.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of w4.POSITIONS)if(t.pressurePlates[a].getGroupRemainingSpaces()<e.captures[a])return Q.failure(Hu.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE());return Q.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const o=wt.copy(e.board),s=e.lodestones.get(e.getCurrentPlayer());if(s.isPresent()){const a=s.get();o[a.y][a.x]=ks.EMPTY}return i="pull"===n.direction?this.applyPull(e,o,t,n.orientation):this.applyPush(e,o,t,n.orientation),i.board[t.y][t.x]=bo.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const o=e.getCurrentPlayer(),s=o.getOpponent(),a=[],c=[],l="diagonal"===i?ve.DIAGONALS:ve.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],E=d.getNext(f);if(e.isOnBoard(E)){const T=t[E.y][E.x];T.isPlayerPiece()&&T.owner===o&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=T,c.push(E),t[E.y][E.x]=ks.EMPTY):m.isPlayerPiece()&&m.owner===s&&(a.push(d),t[d.y][d.x]=T,c.push(E),t[E.y][E.x]=ks.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const s=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?ve.DIAGONALS:ve.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,s1.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const E=t[m.y][m.x];if(E.isPlayerPiece()&&E.owner===s){const T=m.getNext(f);if(e.isOnBoard(T)){const L=t[T.y][T.x];L.isUnreachable()?(a.push(m),t[m.y][m.x]=ks.EMPTY):L.isEmpty()&&(c.push(T),t[T.y][T.x]=E,c.push(m),t[m.y][m.x]=ks.EMPTY)}else a.push(m),t[m.y][m.x]=ks.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const o=e.nextLodestoneDirection();return!1===(o.isAbsent()||o.equalsValue(n))?w.failure(Hu.MUST_FLIP_LODESTONE()):w.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return w.failure(Hu.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?_e.DRAW:0===n[0]?_e.ONE_WON:0===n[1]?_e.ZERO_WON:_e.ONGOING}}u(Ir,"THREATENED_COORD_RANGE",Qt.from({top:{start:r=>new v(0,r),direction:ve.RIGHT},bottom:{start:r=>new v(0,s1.SIZE-(r+1)),direction:ve.RIGHT},left:{start:r=>new v(r,0),direction:ve.DOWN},right:{start:r=>new v(s1.SIZE-(r+1),0),direction:ve.DOWN}})),u(Ir,"singleton",g.empty());const Ie=ks.UNREACHABLE,ne=ks.EMPTY,kr=rc.ZERO,ns=rc.ONE,rh=bo.ONE_PUSH_ORTHOGONAL,AL=s1.INITIAL_PRESSURE_PLATES;class CGe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,Ir.get().getInitialState()),j.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,Ir.get().getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),j.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,Ir.get().getInitialState()),j.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,Ir.get().getInitialState()),j.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,Ir.get().getInitialState()),j.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,Ir.get().getInitialState(),new nc(new v(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?w.failure($localize`You have not captured any of the opponent's pieces, try again!`):w.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new s1([[ne,ne,ne,ne,ns,ne,ne,ne],[ne,ne,kr,ne,ne,ns,ne,ne],[ne,ne,rh,ne,ne,ne,ne,kr],[ne,ne,ne,ne,ns,ne,ne,kr],[ne,ne,ne,ne,ne,kr,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne]],0,new Qt([{key:k.ONE,value:new v(2,2)}]),{...AL,top:xs.of([5,3]).addCaptured(k.ONE,4)}),new nc(new v(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.getCurrentPlateWidth()?w.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):w.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new s1([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[ne,ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,kr],[ne,ne,ne,ne,ne,kr,ne,kr],[ne,rh,ne,ne,ns,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ns,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne]],0,new Qt([{key:k.ONE,value:new v(1,4)}]),{...AL,top:xs.of([5,3]).addCaptured(k.ONE,7)}),new nc(new v(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.getCurrentPlate().isPresent()?w.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):w.SUCCESS,$localize`Congratulations!`),j.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new s1([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,kr,ns,ne,ne,Ie,Ie],[Ie,Ie,rh,ns,ne,ne,Ie,Ie],[Ie,Ie,ne,kr,kr,ne,Ie,Ie],[Ie,Ie,kr,ne,ne,ne,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie]],0,new Qt([{key:k.ONE,value:new v(2,3)}]),{top:xs.of([5,3]).addCaptured(k.ZERO,8),bottom:xs.of([5,3]).addCaptured(k.ZERO,8),left:xs.of([5,3]).addCaptured(k.ZERO,8),right:xs.of([5,3]).addCaptured(k.ZERO,8)})),j.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new s1([[ne,ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ns,ne,ne],[ne,ne,ne,rh,ne,ne,kr,ne],[ne,ne,kr,kr,ns,ne,ne,kr],[ne,ne,ne,ne,ne,kr,ne,ne],[ne,ne,kr,ne,ne,ne,ne,ne],[ne,ne,ns,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne,ne]],0,new Qt([{key:k.ONE,value:new v(3,2)}]),{...AL,top:xs.of([5,3]).addCaptured(k.ZERO,4)}),[new nc(new v(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),j.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new s1([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,ns,kr,ns,ne,ne,Ie,Ie],[Ie,ns,rh,ne,ns,ne,Ie,Ie],[Ie,ne,ne,kr,kr,ne,Ie,Ie],[Ie,ns,kr,ne,ns,ne,Ie,Ie],[Ie,ne,ne,ne,kr,ne,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie]],0,new Qt([{key:k.ONE,value:new v(2,3)}]),{top:xs.of([5,3]).addCaptured(k.ZERO,8),bottom:xs.of([5,3]).addCaptured(k.ZERO,7),left:xs.of([5,3]).addCaptured(k.ZERO,5),right:xs.of([5,3]).addCaptured(k.ZERO,8)}),[new nc(new v(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}class g1e extends jn{getListMoves(e,t){const n=e.gameState;return this.flatMapEmptyCoords(n,i=>{const o=[];for(const s of this.nextDirection(n)){const a=["diagonal","orthogonal"];for(const c of a){const d=Ir.get().applyMoveWithoutPlacingCaptures(n,i,{direction:s,orientation:c}).captures.length;for(const m of this.captureCombinations(n,d))o.push(new nc(i,s,c,m))}}return o})}captureCombinations(e,t){if(0===t)return new it([{top:0,bottom:0,left:0,right:0}]);{const n=new it,i=e.remainingSpacesDetails(),o=this.captureCombinations(e,t-1);for(const s of o)s.top+1<=i.top&&n.add({...s,top:s.top+1}),s.bottom+1<=i.bottom&&n.add({...s,bottom:s.bottom+1}),s.left+1<=i.left&&n.add({...s,left:s.left+1}),s.right+1<=i.right&&n.add({...s,right:s.right+1});return 0===n.size()?o:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<s1.SIZE;i++)for(let o=0;o<s1.SIZE;o++){const s=new v(o,i),a=e.getPieceAt(s);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(s)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}}class yGe extends B1{getMetrics(e,t){const n=e.gameState.getScores();return g1.of([n[0]],[n[1]])}}var N4,ih,p1e;function MGe(r,e){if(1&r&&(I(),V(0,"rect",10)),2&r){const t=p().$implicit,n=p(2);y("ngClass",t.squareClasses),A("x",0)("y",0)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function EGe(r,e){if(1&r&&(I(),P(0,"g",11),V(1,"polygon",12)(2,"polygon",13),S()),2&r){const t=p().$implicit;_(1),y("ngClass",t.squareClasses),_(1),y("ngClass",t.squareClasses)}}function PGe(r,e){if(1&r&&(I(),V(0,"circle",14)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),y("ngClass",i.pieceClasses),A("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function SGe(r,e){if(1&r&&(I(),V(0,"g",15)),2&r){const t=p(),i=t.$implicit;Ce("id","lodestone_",t.index,"_",p().index,""),y("lodestoneInfo",i.lodestone),A("class",i.isCrumbled?"semi-transparent":"")}}function OGe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",5),q("click",function(){const o=ee(t).$implicit;return te(p(2).selectCoord(o.coord))}),O(2,MGe,1,5,"rect",6),O(3,EGe,3,2,"g",7),O(4,PGe,1,6,"circle",8),O(5,SGe,1,4,"g",9),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","square_",n,"_",i,""),A("transform",o.getSVGTranslate(o.SPACE_SIZE*n,o.SPACE_SIZE*i)),_(1),y("ngIf",!1===t.isCrumbled),_(1),y("ngIf",t.isCrumbled),_(1),y("ngIf",t.hasPieceToDraw&&void 0===t.lodestone),_(1),y("ngIf",t.lodestone)}}function TGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,OGe,6,7,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function bGe(r,e){if(1&r&&(I(),P(0,"g",16),V(1,"circle",17),S()),2&r){const t=e.$implicit,n=e.index,i=p();hn("id","capture_",n,""),A("transform",i.getCaptureTransform(n)),_(1),y("ngClass",t.pieceClasses),A("r",i.PIECE_RADIUS)}}function wGe(r,e){if(1&r){const t=ge();I(),P(0,"g",20),q("click",function(){const o=ee(t).$implicit;return te(p(2).selectLodestone(o))}),S()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);Hr("id","lodestone_",t.direction,"_",t.orientation,"_",t.owner.toString(),""),y("lodestoneInfo",t),A("transform",i.getAvailableLodestoneTransform(n))}}function NGe(r,e){if(1&r&&(I(),P(0,"g",18),O(1,wGe,1,5,"g",19),S()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.availableLodestones)}}function AGe(r,e){if(1&r&&(I(),V(0,"circle",14)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p().$implicit,a=p();Hr("id","platePiece_",s.groupPosition,"_",o.plateIndex,"_",n,""),y("ngClass",i.pieceClasses),A("r",a.PIECE_RADIUS)("cx",a.SPACE_SIZE*i.coord.x+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i.coord.y+a.SPACE_SIZE/2)}}function IGe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"g",5),q("click",function(){const i=ee(t),o=i.$implicit,s=i.index,a=p().$implicit,c=p().$implicit,l=p();return te(o.temporary?l.onTemporaryPressurePlateClick(c.groupPosition,a.plateIndex,s):l.onPressurePlateClick(c.groupPosition,a.plateIndex,s))}),V(2,"rect",14),O(3,AGe,1,7,"circle",8),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p().$implicit,s=p();_(1),Hr("id","plate_",o.groupPosition,"_",i.plateIndex,"_",n,""),_(1),Hr("id","plateSquare_",o.groupPosition,"_",i.plateIndex,"_",n,""),y("ngClass",t.squareClasses),A("x",s.SPACE_SIZE*t.coord.x)("y",s.SPACE_SIZE*t.coord.y)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("rx",.2*s.SPACE_SIZE)("ry",.2*s.SPACE_SIZE),_(1),y("ngIf",t.hasPiece)}}function kGe(r,e){if(1&r&&(I(),P(0,"g",16),O(1,IGe,4,14,"g",1),S()),2&r){const t=e.$implicit;Ce("id","pressurePlate_",p().$implicit.groupPosition,"_",t.plateIndex,""),_(1),y("ngForOf",t.coords)}}function xGe(r,e){if(1&r&&(I(),P(0,"g",16),O(1,kGe,2,3,"g",2),S()),2&r){const t=e.$implicit;hn("id","pressurePlateGroup_",t.groupPosition,""),_(1),y("ngForOf",t.plateInfos)}}function LGe(r,e){if(1&r&&(I(),V(0,"rect",21)),2&r){const t=p();Ce("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),A("x",t.SPACE_SIZE*t.viewInfo.selected.get().x)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class A4 extends n3{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlateGroupInfos:[],selected:g.empty()}),u(this,"viewBox",void 0),u(this,"platesGroupSize",void 0),u(this,"boardSize",void 0),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.setRulesAndNode("Lodestone"),this.availableAIs=[new cn($localize`Score`,this.rules,new yGe,new g1e),new bn($localize`MCTS`,new g1e,this.rules)],this.encoder=nc.encoder,this.scores=g.of([0,0]),this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH),this.displayedState=this.getState()}getViewBox(){const n=this.boardSize+2*this.platesGroupSize;return new sa(-this.platesGroupSize,-(this.platesGroupSize+this.SPACE_SIZE+this.STROKE_WIDTH),n,n+2*(this.SPACE_SIZE+this.STROKE_WIDTH))}selectCoord(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(Hu.MUST_PLACE_CAPTURES());const i=Ir.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.hideLastMove(),t.selectedCoord.equalsValue(e)?(yield t.cancelMove(),w.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),w.SUCCESS)))})()}selectLodestone(e){var t=this;return M(function*(){const n=t.getCurrentPlayer().toString(),i="#lodestone_"+e.direction+"_"+e.orientation+"_"+n,o=yield t.canUserPlay(i);if(o.isFailure())return t.cancelMove(o.getReason());t.hideLastMove(),H.assert(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=t.getCurrentPlayer(),a=bo.of(s,e);return t.selectedLodestone.equalsValue(a)?(yield t.cancelMove(),w.SUCCESS):(t.selectedLodestone=g.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),w.SUCCESS))})()}hideLastMove(){this.lastInfos=g.of({board:this.getState().getCopiedBoard(),captures:[],moved:[]}),this.updateViewInfo()}putLodestone(){var e=this;return M(function*(){H.assert(e.selectedCoord.isPresent(),"coord should have been selected"),H.assert(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState(),o=Ir.get().isLegalWithoutCaptures(i,t,n.direction);H.assert(o.isSuccess(),"Lodestone component should only allow creation of legal moves");const s=Ir.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(s),e.capturesToPlace=Math.min(s.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(s.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),w.SUCCESS)})()}applyMove(){var e=this;return M(function*(){H.assert(e.selectedCoord.isPresent(),"coord should have been selected"),H.assert(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new nc(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){var i=this;return M(function*(){const o="#plate_"+e+"_"+t+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.selectPressurePlate(e)})()}onTemporaryPressurePlateClick(e,t,n){var i=this;return M(function*(){const o="#plate_"+e+"_"+t+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.deselectPressurePlate(e)})()}selectPressurePlate(e){var t=this;return M(function*(){if(0===t.capturesToPlace)return t.cancelMove(Hu.NO_CAPTURES_TO_PLACE_YET());t.capturesToPlace--,t.captures[e]++;const n=t.stateAfterPlacingLodestone.get(),i=t.getCurrentOpponent(),o=wt.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return Ir.get().updatePressurePlates(o,s,a,i,t.captures),t.displayedState=new s1(o,n.turn,a,s),0===t.capturesToPlace?t.applyMove():(t.updateViewInfo(),t.showPressurePlateDifferences(t.getState(),t.displayedState,!0),w.SUCCESS)})()}deselectPressurePlate(e){var t=this;return M(function*(){t.capturesToPlace++,t.captures[e]--;const n=t.stateAfterPlacingLodestone.get(),i=t.getCurrentOpponent(),o=wt.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return Ir.get().updatePressurePlates(o,s,a,i,t.captures),t.displayedState=new s1(o,n.turn,a,s),t.updateViewInfo(),t.showPressurePlateDifferences(t.getState(),t.displayedState,!0),w.SUCCESS})()}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt(),t.scores=g.of(t.getState().getScores()),t.boardSize=t.getState().board.length*t.SPACE_SIZE;const n=t.getState().pressurePlates.top.plates.length;t.platesGroupSize=n*(1.2*t.SPACE_SIZE)})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=wt.copy(this.displayedState.board);t[e.get().y][e.get().x]=ks.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<s1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<s1.SIZE;t++){const n=new v(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.isCrumbled(this.selectedCoord.get())?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n=this.getLodestoneInfo(e),i={coord:e,squareClasses:[],isCrumbled:this.isCrumbled(e),hasPieceToDraw:void 0!==n,pieceClasses:[],lodestone:n};if(t.isPlayerPiece())i.hasPieceToDraw=!0,i.pieceClasses=[this.getPlayerClass(t.owner)];else if(i.isCrumbled)return this.getCrumbledSquareInfo(e,i);return i}getCrumbledSquareInfo(e,t){const n=this.getPreCaptureInfo();if(n.isAbsent())return t;const i=this.getPieceThatCrumbledLastEndOfTurn(e,n.get().preCaptureState,n.get().preCaptureMove);if(i.isPresent()){const o=i.get().owner;t.hasPieceToDraw=!0,t.pieceClasses=[this.getPlayerClass(o),"semi-transparent"]}return t}getPreCaptureInfo(){return this.selectedCoord.isPresent()&&this.selectedLodestone.isPresent()?g.of({preCaptureMove:new nc(this.selectedCoord.get(),this.selectedLodestone.get().direction,this.selectedLodestone.get().orientation),preCaptureState:this.getState()}):this.node.previousMove.isPresent()?g.of({preCaptureMove:this.node.previousMove.get(),preCaptureState:this.getPreviousState()}):g.empty()}getLodestoneInfo(e){if(this.displayedState.getPieceAt(e).isLodestone())return this.getLodestoneInfoAt(this.displayedState,e);if(this.isCrumbled(e)&&this.getPreCaptureInfo().isPresent()){if(this.selectedCoord.equalsValue(e)){const i=this.selectedLodestone.get();return this.getLodestoneInfoFromLodestone(i)}if(this.wasLastMoveLodestone(e))return this.getDroppedThenCrumbedLodestoneInfo(this.node.previousMove.get());if(this.isCrumbledLodestone(e))return this.getCrumbledLodestoneInfo(e)}}getDroppedThenCrumbedLodestoneInfo(e){const t={direction:e.direction,orientation:e.orientation},n=bo.of(this.getCurrentOpponent(),t);return this.getLodestoneInfoFromLodestone(n)}getCrumbledLodestoneInfo(e){const t=this.getPreviousState().getPieceAt(e);return H.assert(t.isLodestone(),"getCrumbledLodestoneInfo should only be called with coord that contain crumbled lodestone!"),this.getLodestoneInfoFromLodestone(t)}getLodestoneInfoFromLodestone(e){const t={direction:e.direction,movingClass:"",orientation:e.orientation,owner:e.owner,selectedClass:""};return t.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner),t}wasLastMoveLodestone(e){return!!this.node.parent.isPresent()&&this.node.previousMove.get().coord.equals(e)}isCrumbledLodestone(e){if(this.node.parent.isPresent()){if(this.selectedLodestone.isPresent())return!1;{const t=this.node.parent.get().gameState,n=t.getPieceAt(e);return n.isLodestone()&&n.owner===t.getCurrentOpponent()}}return!1}getLodestoneInfoAt(e,t){const n=e.getPieceAt(t);return H.assert(n.isLodestone(),"piece should be lodestone"),this.getLodestoneInfoFromLodestone(n)}getPieceThatCrumbledLastEndOfTurn(e,t,n){const s=this.rules.applyMoveWithoutPlacingCaptures(t,n.coord,{direction:n.direction,orientation:n.orientation}).board[e.y][e.x],a=!1===s.isEmpty(),c=!1===s.isUnreachable();return a&&c?g.of(s):g.empty()}isCrumbled(e){return this.displayedState.getPieceAt(e).isUnreachable()}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=bo.of(e,t),i=this.getLodestoneInfoFromLodestone(n);return this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlateGroupInfos=[];for(const e of w4.POSITIONS){const t=this.getPressurePlateGroupInfo(e);this.viewInfo.pressurePlateGroupInfos.push(t)}}getPressurePlateGroupInfo(e){const t={groupPosition:e,plateInfos:[]},n=this.displayedState.pressurePlates[e];let i=0;for(const o of n.plates){const s=this.getPressurePlateInfo(o,e,i);t.plateInfos.push(s),i++}return t}getPressurePlateInfo(e,t,n){const i={plateIndex:n,coords:[]},o=e.width;for(let s=0;s<o;s++){const a=this.getPressurePlateCoordInfo(e,t,n,s);i.coords.push(a)}return i}getPressurePlateCoordInfo(e,t,n,i){const o=e.getPieceAt(i);let s="";o.isPlayerPiece()&&(s=this.getPlayerClass(o.owner));const a=A4.PRESSURE_PLATES_POSITIONS.get(t).get();return{coord:a.start(n,e.width).getNext(a.direction,i),hasPiece:o.isPlayerPiece(),pieceClasses:[s],squareClasses:[],temporary:!1}}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState();t.lastInfos=g.of(Ir.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of w4.POSITIONS){const o=e.pressurePlates[i].plates.length;for(let s=0;s<o;s++)this.showPressurePlateDifference(e.pressurePlates[i].plates[s],t.pressurePlates[i].plates[s],i,s,n)}}showPressurePlateDifference(e,t,n,i,o){const c=this.viewInfo.pressurePlateGroupInfos.filter(l=>l.groupPosition===n)[0].plateInfos[i];for(let l=0;l<e.width;l++){const f=e.getPieceAt(l),d=t.getPieceAt(l);!1===f.equals(d)&&(c.coords[l].squareClasses.push("moved-fill"),c.coords[l].temporary=o,o&&c.coords[l].pieceClasses.push("semi-transparent"))}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}getCaptureTransform(e){return`translate(${(e+(s1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.SPACE_SIZE/2}, ${-(this.platesGroupSize+.5*this.SPACE_SIZE+this.STROKE_WIDTH)})`}getAvailableLodestoneTransform(e){return`translate(${(e+(s1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE}, ${this.boardSize+this.platesGroupSize+this.STROKE_WIDTH})`}}N4=A4,u(A4,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(A4,"PRESSURE_PLATES_POSITIONS",Qt.from({top:{start:(r,e)=>new v((8-e)/2,-(r+1)*(1+N4.PRESSURE_PLATE_EXTRA_SHIFT)),direction:ve.RIGHT},bottom:{start:(r,e)=>new v((8-e)/2,8+N4.PRESSURE_PLATE_EXTRA_SHIFT+r*(1+N4.PRESSURE_PLATE_EXTRA_SHIFT)),direction:ve.RIGHT},left:{start:(r,e)=>new v(-(1+N4.PRESSURE_PLATE_EXTRA_SHIFT)*(1+r),(8-e)/2),direction:ve.DOWN},right:{start:(r,e)=>new v(8+N4.PRESSURE_PLATE_EXTRA_SHIFT+r*(1+N4.PRESSURE_PLATE_EXTRA_SHIFT),(8-e)/2),direction:ve.DOWN}})),u(A4,"\u0275fac",function(e){return new(e||N4)(U(Ut))}),u(A4,"\u0275cmp",Fe({type:N4,selectors:[["app-lodestone"]],features:[Ge],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],["id","availableLodestones",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click"],["class","base lodestone_square",3,"ngClass",4,"ngIf"],["class","lodestone_crumbled_square",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo",4,"ngIf"],[1,"base","lodestone_square",3,"ngClass"],[1,"lodestone_crumbled_square"],["points","0,0     42,0    17,25    67,75    42,100   0,100   0,0",1,"base",3,"ngClass"],["points","100,0   58,0    35,25    85,75    58,100 100,100 100,0",1,"base",3,"ngClass"],[1,"base",3,"id","ngClass"],["app-lodestone-lodestone","",3,"id","lodestoneInfo"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["id","availableLodestones"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click",4,"ngFor","ngForOf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(I(),P(0,"svg",0),O(1,TGe,2,1,"g",1),O(2,bGe,2,4,"g",2),O(3,NGe,2,1,"g",3),O(4,xGe,2,2,"g",2),O(5,LGe,1,6,"rect",4),S()),2&e&&(A("viewBox",t.getViewBox().toSVGString()),_(1),y("ngForOf",t.viewInfo.boardInfo),_(1),y("ngForOf",t.viewInfo.capturesToPlace),_(1),y("ngIf",t.isInteractive),_(1),y("ngForOf",t.viewInfo.pressurePlateGroupInfos),_(1),y("ngIf",t.viewInfo.selected.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class bt{static tryMerge(e,t){nn(e!==bt.EMPTY&&t!==bt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(bt.of(i)):g.empty()}static of(e){return e===bt.DRONE.value?bt.DRONE:(H.expectToBe(e,bt.QUEEN.value),bt.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(bt,"EMPTY",new(ih=bt)(0)),u(bt,"PAWN",new ih(1)),u(bt,"DRONE",new ih(2)),u(bt,"QUEEN",new ih(3));class $0{static of(e){const t=new Qt;for(const n of e)$0.addToMap(t,n);return new $0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return $0.addToMap(t,e),new $0(t)}}class a1 extends k1{static isOnBoard(e){return e.isInRange(a1.WIDTH,a1.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),o){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==o&&(o=new Qt([{key:k.ZERO,value:$0.of([])},{key:k.ONE,value:$0.of([])}])),o.makeImmutable(),this.captured=o}getPlayerTerritory(e){return e===k.ZERO?a1.PLAYER_ZERO_TERRITORY:a1.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let o=0;o<a1.WIDTH;o++)if(this.getPieceAtXY(o,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(k.ZERO)?g.of(k.ZERO):this.isTerritoryEmpty(k.ONE)?g.of(k.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<a1.WIDTH;i++)if(this.getPieceAtXY(i,n)!==bt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(bt.PAWN).getOrElse(0),t.captures.get(bt.DRONE).getOrElse(0),t.captures.get(bt.QUEEN).getOrElse(0)]}}u(a1,"WIDTH",4),u(a1,"HEIGHT",8),u(a1,"PLAYER_ZERO_TERRITORY",new it([4,5,6,7])),u(a1,"PLAYER_ONE_TERRITORY",new it([0,1,2,3]));let ZC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class xr extends n2{static from(e,t,n=!1){if(!1===a1.isOnBoard(e))return Q.failure(ZC.START_COORD_OUT_OF_RANGE());if(!1===a1.isOnBoard(t))return Q.failure(ZC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return Q.failure(Ee.MOVE_CANNOT_BE_STATIC());const i=ve.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?Q.failure(i.getReason()):Q.success(new xr(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}p1e=xr,u(xr,"encoder",Ne.tuple([v.encoder,v.encoder,Ne.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>p1e.from(r[0],r[1],r[2]).get()));let m1e=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})(),YC=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class Ls extends Sr{static get(){return Ls.singleton.isAbsent()&&(Ls.singleton=g.of(new Ls)),Ls.singleton.get()}getInitialState(){const e=bt.EMPTY,t=bt.PAWN,n=bt.DRONE,i=bt.QUEEN;return new a1([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();o[e.getStart().y][e.getStart().x]=bt.EMPTY;const s=i.finalPiece;o[e.getEnd().y][e.getEnd().x]=s;const a=i.score;let c=t.countDown;if(c.isPresent())if(this.isCapture(e,t))c=Ls.STARTING_COUNT_DOWN;else{const f=t.countDown.get();c=g.of(f-1)}return e.calledTheClock&&(c=Ls.STARTING_COUNT_DOWN),new a1(o,t.turn+1,g.of(e),c,a)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return Q.failure(YC.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),o=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=o.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),o.replace(a,c),o.makeImmutable()}return Q.success({finalPiece:i,score:o})}assertNonDoubleClockCall(e,t){const n=t.countDown.isPresent();H.assert(!1===(n&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return Q.failure(YC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return Q.failure(YC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const o={finalPiece:i,score:t.captured.getCopy()};return Q.success(o)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return w.failure(YC.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===bt.EMPTY)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===bt.PAWN)return e.isValidForPawn()?w.SUCCESS:w.failure(ZC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===bt.DRONE&&!1===e.isValidForDrone())return w.failure(ZC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const o of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(o)!==bt.EMPTY)return w.failure(Ee.SOMETHING_IN_THE_WAY());return w.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return bt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,_e.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),o=_e.getVictory(i);return this.getGameStatusScoreVictoryOr(t,o)}return _e.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(k.ZERO),i=e.getScoreOf(k.ONE);return n>i?_e.ZERO_WON:i>n?_e.ONE_WON:t}}u(Ls,"STARTING_COUNT_DOWN",g.of(7)),u(Ls,"singleton",g.empty());const X=bt.EMPTY,wo=bt.PAWN,I4=bt.DRONE,Gl=bt.QUEEN;class RGe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ls.get().getInitialState()),j.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ls.get().getInitialState()),j.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ls.get().getInitialState(),xr.from(new v(2,5),new v(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.PAWN?w.SUCCESS:w.failure($localize`This is not a pawn!`),$localize`Congratulations!`),j.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ls.get().getInitialState(),xr.from(new v(1,7),new v(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.DRONE?w.SUCCESS:w.failure($localize`This is not a drone!`),$localize`Congratulations!`),j.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new a1([[I4,wo,X,X],[Gl,X,X,X],[X,X,X,X],[X,X,Gl,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[Gl,I4,wo,X]],1),xr.from(new v(2,3),new v(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?w.SUCCESS:w.failure($localize`This is not a queen!`),$localize`Congratulations!`),j.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new a1([[I4,wo,wo,X],[X,X,X,X],[Gl,X,X,X],[X,X,X,X],[X,X,wo,X],[X,X,X,X],[X,X,X,X],[X,I4,wo,X]],1),[xr.from(new v(0,2),new v(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,m1e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),j.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new a1([[X,X,X,Gl],[X,wo,X,X],[X,X,wo,X],[X,X,X,X],[X,X,X,X],[X,X,X,Gl],[X,X,I4,X],[X,wo,X,X]],1),[xr.from(new v(1,1),new v(2,2)).get(),xr.from(new v(2,2),new v(1,1)).get()],$localize`Congratulations!`,$localize`This is not a field promotion!`),j.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new a1([[wo,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,I4,X],[X,wo,X,X]],0),xr.from(new v(1,7),new v(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?w.SUCCESS:w.failure($localize`This is not a field promotion!`),$localize`Congratulations!`),j.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ls.get().getInitialState(),xr.from(new v(1,5),new v(0,4),!0).get(),(t,n,i)=>t.calledTheClock?w.SUCCESS:w.failure($localize`You did not call the clock!`),$localize`Congratulations!`),j.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new a1([[X,X,X,X],[X,wo,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,wo],[X,X,I4,X],[X,wo,X,X]],15,g.empty(),g.of(1)),[xr.from(new v(1,1),new v(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),j.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new a1([[X,X,X,Gl],[X,wo,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[I4,X,X,X],[X,X,X,X],[X,I4,X,X]],15,g.empty(),g.of(1)),xr.from(new v(1,1),new v(2,2)).get(),$localize`Congratulations!`),j.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new a1([[X,X,X,Gl],[X,wo,X,X],[X,X,X,X],[X,X,X,X],[X,X,wo,X],[X,X,X,X],[X,X,X,X],[X,X,X,X]],0),xr.from(new v(2,4),new v(1,3)).get(),(t,n,i)=>3===t.getEnd().y?w.SUCCESS:w.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}class _1e extends jn{getListMoves(e,t){const n=e.gameState,i=n.getCurrentPlayer(),o=n.getPlayerTerritory(i);let s=[];for(const a of o)for(let c=0;c<a1.WIDTH;c++)switch(n.getPieceAtXY(c,a)){case bt.PAWN:s=s.concat(this.getMovesForPawnAt(n,c,a));break;case bt.DRONE:s=s.concat(this.getMovesForDroneAt(n,c,a));break;case bt.QUEEN:s=s.concat(this.getMovesForQueenAt(n,c,a))}return s}getMovesForPawnAt(e,t,n){const i=new v(t,n),o=[];for(const s of ve.DIAGONALS){const a=i.getNext(s);a1.isOnBoard(a)&&o.push(a)}return this.addLegalMoves(e,i,o)}addLegalMoves(e,t,n){const i=[],o=e.getPieceAt(t),s=!1===e.isTherePieceOnPlayerSide(bt.DRONE),a=!1===e.isTherePieceOnPlayerSide(bt.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===bt.EMPTY)this.add(i,xr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=bt.tryMerge(f,o);if(d.isPresent()){const m=d.get(),E=xr.from(t,l).get();(m===bt.DRONE&&s||m===bt.QUEEN&&a)&&this.add(i,E,c)}}else this.add(i,xr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new v(t,n),o=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,o)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const o of ve.DIRECTIONS){let s=1,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY);for(;l;)i.push(a),s++,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY)&&s<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new v(t,n),o=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,o)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,a1.HEIGHT)}}class zGe extends B1{getMetrics(e,t){const n=e.gameState.getScoreOf(k.ZERO),i=e.gameState.getScoreOf(k.ONE);return g1.of([n],[i])}}function DGe(r,e){if(1&r&&(I(),V(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();uo(i.style),Ce("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function HGe(r,e){if(1&r&&(I(),V(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();uo(i.style),Ce("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function VGe(r,e){if(1&r&&(I(),V(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();uo(i.style),Ce("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function FGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,DGe,1,5,"g",16),O(2,HGe,1,5,"g",17),O(3,VGe,1,5,"g",18),S()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();A("transform",s.getPieceLocation(n,o)),_(1),y("ngIf",i===s.pieces.PAWN),_(1),y("ngIf",i===s.pieces.DRONE),_(1),y("ngIf",i===s.pieces.QUEEN)}}function $Ge(r,e){if(1&r){const t=ge();I(),P(0,"g",14),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",15),O(2,FGe,4,4,"g",13),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),A("transform",o.getPieceTranslation(i)),_(1),Ce("id","square_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.pieces.EMPTY)}}function GGe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",22),q("click",function(){const o=ee(t).$implicit;return te(p(3).onClick(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p(3);_(1),Ce("id","indicator_",t.x,"_",t.y,""),A("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function BGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,GGe,2,7,"g",1),S()),2&r){const t=p(2);_(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function UGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,$Ge,3,11,"g",12),O(2,BGe,2,1,"g",13),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",t),_(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function WGe(r,e){if(1&r&&(I(),P(0,"text",23),rt(1),S()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),A("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),_(1),gn(t.countDown.get())}}function qGe(r,e){if(1&r&&(I(),V(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),A("points",t.clockNeedlesPoints)}}const KC=function(r){return[r]};function jGe(r,e){if(1&r){const t=ge();I(),qt(0),P(1,"g",27),q("click",function(){const o=ee(t).index;return te(p(2).chooseStyle(o))}),S(),jt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),uo(t.style),y("id",t.name)("pieceClasses",Ra(5,KC,"player"+i.getCurrentPlayer().value+"-fill")),A("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function ZGe(r,e){if(1&r&&(I(),P(0,"g",25),V(1,"rect",26),O(2,jGe,2,7,"ng-container",1),S()),2&r){const t=p();_(1),A("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),_(1),y("ngForOf",t.listOfStyles)}}function YGe(r,e){if(1&r&&(I(),P(0,"text",33),rt(1),S()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),A("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),_(1),gn(t+" x ")}}function KGe(r,e){if(1&r&&(I(),V(0,"g",34)),2&r){const t=p(3).$implicit,n=p();uo(n.style),y("pieceClasses",Ra(3,KC,n.getPlayerClass(t)))}}function XGe(r,e){if(1&r&&(I(),V(0,"g",35)),2&r){const t=p(3).$implicit,n=p();uo(n.style),y("pieceClasses",Ra(3,KC,n.getPlayerClass(t)))}}function QGe(r,e){if(1&r&&(I(),V(0,"g",36)),2&r){const t=p(3).$implicit,n=p();uo(n.style),y("pieceClasses",Ra(3,KC,n.getPlayerClass(t)))}}function JGe(r,e){if(1&r&&(I(),P(0,"g"),O(1,YGe,2,4,"text",29),P(2,"g",28),O(3,KGe,1,5,"g",30),O(4,XGe,1,5,"g",31),O(5,QGe,1,5,"g",32),S()()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p();A("transform","translate(0, "+2*n*s.SPACE_SIZE+")"),_(1),y("ngIf",i>1),_(1),Ce("id","piece_",n,"_player_",o.value,""),A("transform","translate("+s.SPACE_SIZE+", 0)"),_(1),y("ngIf",0===n),_(1),y("ngIf",1===n),_(1),y("ngIf",2===n)}}function eBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,JGe,6,8,"g",13),S()),2&r){const t=e.$implicit;_(1),y("ngIf",t>0)}}function tBe(r,e){if(1&r&&(I(),P(0,"g")(1,"g",28),O(2,eBe,2,1,"g",1),S()()),2&r){const t=e.$implicit,n=p();_(1),hn("id","capture_of_player_",t.value,""),A("transform",n.getCapturesTransformation(t)),_(1),y("ngForOf",n.state.getCapturesOf(t))}}let Rs=(()=>{var r;class e extends Mo{static getRegularPolygon(n,i=0){const o=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(o)}static getNPointedStar(n,i){const o=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(o)}static getNPointedStarCoords(n,i){const o=[],s=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=s+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f);o.push(new v(m,E))}return o}static getRegularPolygonCoords(n,i=0){const o=[],s=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=s+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f)+i;o.push(new v(m,E))}return o}static mapCoordsToString(n){let i="";for(const o of n)i+=o.x+", "+o.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*a1.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",a1.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",a1.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",bt),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.setRulesAndNode("MartianChess"),this.availableAIs=[new cn($localize`Score`,this.rules,new zGe,new _1e),new bn($localize`MCTS`,new _1e,this.rules)],this.encoder=xr.encoder,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints()}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,o=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+o+" "+o+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board;const o=i.state.getScoreOf(k.ZERO),s=i.state.getScoreOf(k.ONE);i.countDown=i.state.countDown,i.scores=g.of([o,s])})()}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const o=new v(n,i),s=[];return s.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(o)&&s.push("selected-stroke"),this.node.previousMove.isPresent()&&this.node.previousMove.get().getEnd().equals(o)&&this.getPreviousState().getPieceAt(o)!==bt.EMPTY&&this.getState().isInOpponentTerritory(new v(0,i))&&s.push("last-move-stroke"),s}onClick(n,i){var o=this;return M(function*(){o.displayModePanel=!1;const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);return o.selectedPieceInfo.isPresent()?o.secondClick(a):o.firstClick(a)})()}firstClick(n){var i=this;return M(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),w.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return M(function*(){const o=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:o}),w.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let o;return o=i===bt.PAWN?ve.DIAGONALS.map(s=>n.getNext(s)):this.getValidLinearLandingSquareUntil(n,i===bt.DRONE?2:a1.HEIGHT),o.filter(s=>{const a=xr.from(n,s);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return ve.DIRECTIONS.flatMap(o=>{const s=[];let a=n.getNext(o),c=1;for(;a1.isOnBoard(a)&&c<=i&&(s.push(a),this.getState().getPieceAt(a)===bt.EMPTY);)a=a.getNext(o),c++;return s})}secondClick(n){var i=this;return M(function*(){const o=i.selectedPieceInfo.get();if(o.selectedPiece.equals(n))return i.cancelMoveAttempt(),w.SUCCESS;if(o.legalLandings.some(s=>s.equals(n))){const s=xr.from(o.selectedPiece,n,i.callTheClock);return H.assert(s.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(s.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const s=xr.from(o.selectedPiece,n,i.callTheClock);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==bt.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return M(function*(){const i=yield n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),w.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===k.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const o=new v(n,i),s=["base"];if(this.node.previousMove.isPresent()){const a=this.node,c=a.previousMove.get();c.getStart().equals(o)?s.push("moved-fill"):c.getEnd().equals(o)&&(a.parent.get().gameState.getPieceAt(o)===bt.EMPTY||a.gameState.isInOpponentTerritory(new v(0,i))?s.push("moved-fill"):s.push("captured-fill"))}return s}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.getPointOfView().value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){const o=-this.SPACE_SIZE/2;let s=this.SPACE_SIZE/2;return n===this.getPointOfView()&&(s+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+o+", "+s+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-martian-chess"]],features:[Ge],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"g"),O(2,UGe,3,2,"g",1),S(),P(3,"g",2),q("click",function(){return i.onClockClick()}),V(4,"rect",3)(5,"circle",4),O(6,WGe,2,5,"text",5),O(7,qGe,1,2,"polyline",6),S(),P(8,"g",7)(9,"g",8),q("click",function(){return i.onModeCogClick()}),V(10,"rect",3)(11,"path",9),S(),O(12,ZGe,3,5,"g",10),S(),P(13,"g",11),O(14,tBe,3,3,"g",1),S()()),2&n&&(A("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(1),A("transform",i.getBoardTransformation()),_(1),y("ngForOf",i.board),_(1),A("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),_(1),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getClockCircleClasses()),A("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),_(1),y("ngIf",i.countDown.isPresent()),_(1),y("ngIf",i.countDown.isAbsent()),_(1),A("transform",i.configViewTranslation),_(2),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),A("transform",i.configCogTransformation),_(1),y("ngIf",i.displayModePanel),_(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class XC extends k1{}let nBe=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var oh,Bl;let f3=(oh=class extends ja{static get(){return Bl.singleton.isAbsent()&&(Bl.singleton=g.of(new Bl)),Bl.singleton.get()}constructor(){super(),u(this,"P4_HELPER",void 0),this.P4_HELPER=new Su(H.identity,4)}getRulesConfigDescription(){return g.of(Bl.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=wt.create(e.get().width,e.get().height,W.NONE);return new XC(t,0)}applyLegalMove(e,t,n,i){const o=e.x,s=t.getCopiedBoard(),a=Bl.get().getLowestUnoccupiedSpace(s,o),c=t.turn;return s[a][o]=t.getCurrentPlayer(),new XC(s,c+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?w.failure(nBe.COLUMN_IS_FULL()):w.SUCCESS}getGameStatus(e){const t=e.gameState;if(this.P4_HELPER.getVictoriousCoord(t).length>0)return _e.getVictory(t.getCurrentOpponent());const i=t.getWidth(),o=t.getHeight();return t.turn===i*o?_e.DRAW:_e.ONGOING}getVictoriousCoords(e){return this.P4_HELPER.getVictoriousCoord(e)}getLowestUnoccupiedSpace(e,t){let n=0;const i=e.length;for(;n<i&&e[n][t]===W.NONE;)n++;return n-1}},Bl=oh,u(oh,"singleton",g.empty()),u(oh,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Four in a Row`,config:{width:new br(7,Ss.WIDTH,Tr.range(1,99)),height:new br(6,Ss.HEIGHT,Tr.range(1,99))}})),oh);var v1e;f3=Bl=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],f3);class ic extends yo{static of(e){return H.assert(0<=e,"P4Move should be a positive integer!"),new ic(e)}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}toString(){return"P4Move("+this.x+")"}}v1e=ic,u(ic,"encoder",Ne.tuple([Ne.identity()],r=>[r.x],r=>v1e.of(r[0])));let QC=class extends jn{getListMoves(e,t){const i=e.gameState.getWidth(),o=Math.floor((i-1)/2);return this.getUnorderedListMoves(e,t).sort((s,a)=>Math.abs(s.x-o)-Math.abs(a.x-o))}getUnorderedListMoves(e,t){const n=e.gameState,i=[];for(let o=0;o<n.getWidth();o++)if(n.getPieceAtXY(o,0)===W.NONE){const s=ic.of(o);i.push(s)}return i}};QC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],QC);class oBe extends Ya{getBoardValue(e,t){const n=e.gameState;let i=0;for(let o=0;o<n.getWidth();o++)for(let s=n.getHeight()-1;-1!==s&&n.board[s][o].isPlayer();s--)i+=f3.get().P4_HELPER.getSquareScore(n,new v(o,s));return un.of(i)}}class sBe extends QC{getListMoves(e,t){const n=(e.gameState.getWidth()-1)/2;return super.getListMoves(e,t).sort(function i(o,s){return Math.abs(o.x-n)-Math.abs(s.x-n)})}}class aBe extends cn{constructor(){super($localize`Minimax`,f3.get(),new oBe,new sBe)}}function cBe(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),A("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function lBe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index;return te(p(2).onClick(o))}),V(1,"rect",6),O(2,cBe,1,4,"circle",7),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();hn("id","click_",n,""),_(1),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function uBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,lBe,3,6,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function fBe(r,e){if(1&r&&(I(),V(0,"rect",9)),2&r){const t=p();A("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function dBe(r,e){if(1&r&&(I(),V(0,"rect",10)),2&r){const t=e.$implicit,n=p();Ce("id","victory_coord_",t.x,"_",t.y,""),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let hBe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"EMPTY",W.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.setRulesAndNode("P4"),this.availableAIs=[new aBe,new bn($localize`MCTS`,new QC,this.rules)],this.encoder=ic.encoder}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=ic.of(n);return yield i.chooseMove(s)})()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.victoryCoords=f3.get().getVictoriousCoords(o),i.board=o.board})()}showLastMove(n){var i=this;return M(function*(){const o=i.getState(),s=f3.get().getLowestUnoccupiedSpace(o.board,n.x)+1;i.last=g.of(new v(n.x,s))})()}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-p4"]],features:[Ge],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,uBe,2,1,"g",1),O(2,fBe,1,4,"rect",2),O(3,dBe,1,6,"rect",3),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.last.isPresent()),_(1),y("ngForOf",i.victoryCoords))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const st=W.NONE,k4=W.ZERO,Vu=W.ONE,C1e=f3.get().getDefaultRulesConfig();class gBe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,f3.get().getInitialState(C1e)),j.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,f3.get().getInitialState(C1e),ic.of(3),$localize`As you can see, the piece falls at the bottom of the column.`),j.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new XC([[st,st,st,st,st,st,st],[st,st,st,st,st,st,st],[st,st,st,st,st,st,st],[st,st,st,Vu,st,st,st],[st,st,st,Vu,st,st,st],[st,st,k4,k4,k4,Vu,st]],0),[ic.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),j.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new XC([[st,st,st,st,st,st,st],[st,st,st,st,st,st,st],[st,st,st,st,st,st,st],[st,st,st,k4,Vu,st,st],[st,st,k4,k4,Vu,st,st],[st,k4,Vu,k4,k4,st,st]],0),[ic.of(3),ic.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}class j1 extends k1{static isOnBoard(e){return e.isInRange(j1.SIZE,j1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=j1.getBlockCenter(e),n=this.getPieceAt(t.getNext(ve.UP,1)),i=this.getPieceAt(t.getNext(ve.UP_LEFT,1));return this.getPieceAt(t.getNext(ve.RIGHT,1))===n&&this.getPieceAt(t.getNext(ve.DOWN,1))===n&&this.getPieceAt(t.getNext(ve.LEFT,1))===n&&this.getPieceAt(t.getNext(ve.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(ve.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(ve.DOWN_LEFT,1))===i}static getBlockCenter(e){return new v(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new j1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const o=j1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const s of j1.ROTATION_MAP){const a=s[0].getNext(o),c=s[1].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const s of j1.ROTATION_MAP){const a=s[1].getNext(o),c=s[0].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new j1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var y1e;u(j1,"SIZE",6),u(j1,"ROTATION_MAP",[[new v(-1,-1),new v(1,-1)],[new v(0,-1),new v(1,0)],[new v(1,-1),new v(1,1)],[new v(1,0),new v(0,1)],[new v(1,1),new v(-1,1)],[new v(0,1),new v(-1,0)],[new v(-1,1),new v(-1,-1)],[new v(-1,0),new v(0,-1)]]);class Kr extends Or{static of(e,t,n){return new Kr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return H.assert(0<=n&&n<=3,"This block does not exist: "+n),new Kr(e,t,g.of(n),i)}static rotationless(e,t){return new Kr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,H.assert(j1.isOnBoard(this.coord),"The board is a "+j1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}y1e=Kr,u(Kr,"encoder",Ne.tuple([v.encoder,g.getEncoder(Ne.identity()),Ne.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>y1e.of(r[0],r[1],r[2])));class sh extends jn{getListMoves(e,t){const n=[],i=e.gameState.neutralBlocks;if(0===e.gameState.turn)return sh.FIRST_TURN_MOVES;const o=this.getLegalDrops(e.gameState);for(const s of o){const a=Kr.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(a),l=this.getLegalRotations(c,i);for(const d of l)n.push(Kr.withRotation(s.x,s.y,d[0],d[1]));0===c.neutralBlocks.length==0&&n.push(a)}return n}getLegalDrops(e){const t=[];for(let n=0;n<j1.SIZE;n++)for(let i=0;i<j1.SIZE;i++){const o=new v(i,n);e.getPieceAt(o)===W.NONE&&t.push(o)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let o=0;o<4;o++)!1===e.blockIsNeutral(o)&&(t.includes(o)?n&&i.push([o,!0]):i.push([o,!0],[o,!1]));return i}}function pBe(r,e){if(1&r){const t=ge();I(),P(0,"circle",12),q("click",function(){const o=ee(t).$implicit,s=p().$implicit,a=p().index,c=p().index;return te(p().onClick(3*a+o,3*c+s))}),S()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),o=i.index,s=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();Ce("id","click_",3*o+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*o+t,3*c+n)),A("cx",s+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}u(sh,"FIRST_TURN_MOVES",[Kr.rotationless(0,0),Kr.rotationless(1,0),Kr.rotationless(2,0),Kr.rotationless(0,1),Kr.rotationless(1,1),Kr.rotationless(0,2)]);const M1e=function(){return[0,1,2]};function mBe(r,e){1&r&&(I(),qt(0),O(1,pBe,1,6,"circle",11),jt()),2&r&&(_(1),y("ngForOf",Q1(1,M1e)))}function _Be(r,e){if(1&r&&(I(),qt(0),V(1,"rect",10),O(2,mBe,2,2,"ng-container",4),jt()),2&r){const t=e.$implicit,n=e.index,i=p(),o=i.index,s=i.$implicit,a=p();_(1),y("ngClass",a.getBlockClasses(n,o)),A("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+s)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),_(1),y("ngForOf",Q1(8,M1e))}}const E1e=function(r){return[0,r]};function vBe(r,e){if(1&r&&(I(),qt(0),O(1,_Be,3,9,"ng-container",4),jt()),2&r){const t=p();_(1),y("ngForOf",Ra(1,E1e,t.BLOCK_SEPARATION))}}function CBe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p();Ce("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),A("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function yBe(r,e){if(1&r){const t=ge();I(),P(0,"path",14),q("click",function(){const o=ee(t).$implicit;return te(p().rotate(o))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),A("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function MBe(r,e){if(1&r&&(I(),V(0,"path",15)),2&r){const t=p();Ce("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),A("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function EBe(r,e){if(1&r&&(I(),V(0,"circle",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),A("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function PBe(r,e){if(1&r){const t=ge();I(),P(0,"g",17),q("click",function(){return ee(t),te(p().skipRotation())}),V(1,"circle",18)(2,"line",19),S()}if(2&r){const t=p();_(1),A("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),_(1),A("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let SBe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.setRulesAndNode("Pentago"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new Jx,new sh),new bn($localize`MCTS`,new sh,this.rules)],this.encoder=Kr.encoder,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(n){var i=this;return M(function*(){i.board=i.getState().getCopiedBoard(),i.victoryCoords=i.rules.getVictoryCoords(i.getState()),i.lastDrop=g.empty(),i.lastRotation=g.empty()})()}showLastMove(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.movedBlock=n.blockTurned;const o=new v(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(i.showLastRotation(n),!1===o.equals(new v(0,0))&&i.coordBelongToBlock(n)))return i.showLastDrop(n,o);i.lastDrop=g.of(n.coord)})()}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),o=this.ARROWS.filter(s=>s.blockIndex===i&&s.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(o)}}showLastDrop(n,i){let o;o=n.turnedClockwise?H.getNonNullable(j1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:H.getNonNullable(j1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const s=n.blockTurned.get(),l=new v(s%2==0?1:4,s<2?1:4);o=o.getNext(l,1),this.lastDrop=g.of(o)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hideLastMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,o=this.SPACE_SIZE,s=n-o,a=2*o,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+o+" -"+o+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+o+"  "+o+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+o+"  "+o+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+s+" 0 q -"+o+" -"+o+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+s+" q -"+o+" -"+o+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+o+"  "+o+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+s+" "+n+" q -"+o+"  "+o+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+s+" q  "+o+" -"+o+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());if(o.hideLastMove(),o.board[i][n].isPlayer())return o.cancelMove(Ee.MUST_LAND_ON_EMPTY_SPACE());const a=Kr.rotationless(n,i),l=o.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return o.chooseMove(a);const f=o.rules.getGameStatus(o.node);return o.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,o.currentDrop=g.of(new v(n,i)),o.displayArrows(l.neutralBlocks),w.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const o=this.ARROWS.filter(s=>s.blockIndex===i);this.arrows=this.arrows.concat(o)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const o=[],s=this.getPlayerClass(this.board[i][n]);return o.push(s),this.lastDrop.equalsValue(new v(n,i))&&o.push("last-move-stroke"),o}rotate(n){var i=this;return M(function*(){const o=n.clockwise?"clockwise":"counterclockwise",s=yield i.canUserPlay("#rotate_"+n.blockIndex+"_"+o);if(s.isFailure())return i.cancelMove(s.getReason());const a=i.currentDrop.get(),c=Kr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return M(function*(){const i=yield n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const o=n.currentDrop.get(),s=Kr.rotationless(o.x,o.y);return n.chooseMove(s)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-pentago"]],features:[Ge],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),S()(),P(4,"defs")(5,"marker",3),V(6,"polygon",2),S()(),O(7,vBe,2,3,"ng-container",4),O(8,CBe,1,6,"circle",5),O(9,yBe,1,4,"path",6),O(10,MBe,1,4,"path",7),O(11,EBe,1,7,"circle",8),O(12,PBe,3,9,"g",9),S()),2&n&&(_(7),y("ngForOf",Ra(6,E1e,i.BLOCK_SEPARATION)),_(1),y("ngIf",i.currentDrop.isPresent()),_(1),y("ngForOf",i.arrows),_(1),y("ngIf",i.lastRotation.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngIf",i.canSkipRotation))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),P1e=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class d3 extends Sr{static get(){return d3.singleton.isAbsent()&&(d3.singleton=g.of(new d3)),d3.singleton.get()}getInitialState(){const e=wt.create(j1.SIZE,j1.SIZE,W.NONE);return new j1(e,0)}applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return w.failure(P1e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return w.failure(P1e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return w.SUCCESS}getVictoryCoords(e){let t=[];for(const n of d3.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),o=[n[0]];if(i.isPlayer()){let s=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(s)!==i?a=!1:(o.push(s),s=s.getNext(n[1]));if(a&&(e.getPieceAt(s)===i&&(o.push(s),t=t.concat(o)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(o.push(c),t=t.concat(o))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let o=0;o<n.length;o+=5)i[t.getPieceAt(n[o]).value]=!0;return!0===i[0]?!0===i[1]?_e.DRAW:_e.ZERO_WON:!0===i[1]?_e.ONE_WON:t.turn===j1.SIZE*j1.SIZE?_e.DRAW:_e.ONGOING}}u(d3,"singleton",g.empty()),u(d3,"VICTORY_SOURCE",[[new v(1,0),new Vt(1,1),!1],[new v(0,1),new Vt(1,1),!1],[new v(4,0),new Vt(-1,1),!1],[new v(5,1),new Vt(-1,1),!1],[new v(1,1),new Vt(1,1),!0],[new v(4,1),new Vt(-1,1),!0],[new v(0,1),new Vt(0,1),!0],[new v(1,1),new Vt(0,1),!0],[new v(2,1),new Vt(0,1),!0],[new v(3,1),new Vt(0,1),!0],[new v(4,1),new Vt(0,1),!0],[new v(5,1),new Vt(0,1),!0],[new v(1,0),new Vt(1,0),!0],[new v(1,1),new Vt(1,0),!0],[new v(1,2),new Vt(1,0),!0],[new v(1,3),new Vt(1,0),!0],[new v(1,4),new Vt(1,0),!0],[new v(1,5),new Vt(1,0),!0]]);const ze=W.NONE,h3=W.ZERO,x4=W.ONE;class OBe{constructor(){u(this,"tutorial",[j.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,d3.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new j1([[h3,ze,ze,h3,x4,ze],[h3,x4,ze,ze,ze,ze],[h3,ze,x4,ze,ze,ze],[h3,ze,ze,ze,ze,x4],[h3,ze,ze,ze,x4,ze],[ze,ze,ze,ze,ze,ze]],10)).withPreviousMove(Kr.withRotation(0,0,0,!1)),j.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant. As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant. To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>You're playing Dark, do a simple move.`,new j1([[ze,ze,ze,ze,ze,ze],[ze,h3,ze,ze,x4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,x4,ze,ze,h3,ze],[ze,ze,ze,ze,ze,ze]],10),Kr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?w.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):w.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new j1([[ze,ze,ze,ze,ze,ze],[ze,h3,ze,ze,x4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,x4,ze,ze,h3,ze],[ze,ze,ze,ze,ze,ze]],10),Kr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?w.SUCCESS:w.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}class ah extends k1{constructor(e,t,n){super(e,n),u(this,"captures",void 0),this.captures=t}}class No extends ja{static get(){return No.singleton.isAbsent()&&(No.singleton=g.of(new No)),No.singleton.get()}getInitialState(e){const t=e.get(),n=wt.create(t.width,t.height,W.NONE),i=Math.floor(t.width/2);return n[Math.floor(t.height/2)][i]=W.ONE,new ah(n,[0,0],0)}getRulesConfigDescription(){return g.of(No.RULES_CONFIG_DESCRIPTION)}isLegal(e,t){return!1===t.isOnBoard(e.coord)?w.failure(Ps.OUT_OF_RANGE(e.coord)):t.getPieceAt(e.coord).isPlayer()?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}applyLegalMove(e,t,n,i){const o=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=o;const a=this.getCaptures(e.coord,t,o);for(const l of a)s[l.y][l.x]=W.NONE;const c=[t.captures[0],t.captures[1]];return c[o.value]+=a.length,new ah(s,c,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),o=[];for(const s of ve.factory.all){const a=e.getNext(s,1),c=e.getNext(s,2),l=e.getNext(s,3);t.isOnBoard(a)&&t.getPieceAt(a)===i&&t.isOnBoard(c)&&t.getPieceAt(c)===i&&t.isOnBoard(l)&&t.getPieceAt(l)===n&&(o.push(a),o.push(c))}return o}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return 10<=t.captures[n.value]||No.PENTE_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(n):this.stillHaveEmptySquare(t)?_e.ONGOING:_e.DRAW}stillHaveEmptySquare(e){const t=e.getWidth(),n=e.getHeight();for(let i=0;i<n;i++)for(let o=0;o<t;o++)if(e.board[i][o]===W.NONE)return!0;return!1}}u(No,"PENTE_HELPER",new Su(H.identity,5)),u(No,"RULES_CONFIG_DESCRIPTION",tL.GOBAN),u(No,"singleton",g.empty());class F2 extends Or{static of(e){return new F2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(F2,"encoder",Or.getEncoder(F2.of));class O1e extends jn{getListMoves(e,t){const i=[];return e.gameState.forEachCoord((o,s)=>{!1===s.isPlayer()&&i.push(F2.of(o))}),i}}class TBe extends Ya{getBoardValue(e,t){return No.PENTE_HELPER.getBoardValue(e.gameState)}}function bBe(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE)}}function wBe(r,e){if(1&r&&(I(),V(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();Ce("id","hoshi_",t,"_",n,""),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.2*i.SPACE_SIZE)}}function NBe(r,e){if(1&r&&(I(),V(0,"rect",9)(1,"line",10)(2,"line",10),O(3,wBe,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n),_(1),A("x1",i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+i.SPACE_SIZE*n),_(1),A("x1",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y1",i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function ABe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),O(1,bBe,1,6,"circle",6),O(2,NBe,4,13,"ng-template",null,7,mn),S()}if(2&r){const t=e.$implicit,n=e.index,i=dn(3);Ce("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function IBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,ABe,4,4,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function kBe(r,e){if(1&r){const t=ge();I(),P(0,"circle",13),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","capture_",t.x,"_",t.y,""),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.14*n.SPACE_SIZE)}}let xBe=(()=>{var r;class e extends sL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.setRulesAndNode("Pente"),this.availableAIs=[new cn($localize`Alignment`,this.rules,new TBe,new O1e),new bn($localize`MCTS`,new O1e,this.rules)],this.encoder=F2.encoder,this.scores=g.of([0,0])}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.board,i.scores=g.of(i.getState().captures),i.victoryCoords=No.PENTE_HELPER.getVictoriousCoord(o),i.createHoshis(),i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=g.of(n.coord);const o=i.getCurrentOpponent();i.captured=No.get().getCaptures(n.coord,i.getPreviousState(),o)})()}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);return o.chooseMove(F2.of(a))})()}getSpaceClass(n,i){const o=new v(n,i),s=this.getState().getPieceAt(o),a=[];return a.push(this.getPlayerClass(s)),this.victoryCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),this.lastMoved.equalsValue(o)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-new-game"]],features:[Ge],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),V(1,"rect",1),O(2,IBe,2,1,"g",2),O(3,kBe,1,5,"circle",3),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),A("width",i.board.length*i.SPACE_SIZE)("height",i.board.length*i.SPACE_SIZE),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.captured))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const h=W.NONE,g3=W.ZERO,oc=W.ONE,T1e=No.get().getDefaultRulesConfig();class LBe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,No.get().getInitialState(T1e)),j.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,No.get().getInitialState(T1e),F2.of(new v(9,8)),$localize`Congratulations!`),j.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new ah([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,g3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,oc,g3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,oc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[F2.of(new v(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new ah([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,oc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,oc,g3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,oc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[F2.of(new v(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new ah([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,oc,h,h,g3,g3,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,g3,h,g3,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,oc,g3,g3,g3,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,oc,oc,oc,oc,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[F2.of(new v(9,6)),F2.of(new v(8,9)),F2.of(new v(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class ch extends v{static getCoord3DEncoder(e){return Ne.tuple([Ne.identity(),Ne.identity(),Ne.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new ch(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var IL;class pn extends ch{static of(e,t,n){return new pn(e,t,n)}constructor(e,t,n){super(e,t,n),H.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),H.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),H.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;H.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new pn(this.x,this.y,e),new pn(this.x+1,this.y,e),new pn(this.x,this.y+1,e),new pn(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new v(this.x-1,this.y-1),n=new v(this.x,this.y-1),i=new v(this.x-1,this.y),o=new v(this.x,this.y),s=4-e;return[t,n,i,o].filter(a=>a.isInRange(s,s)).map(a=>new pn(a.x,a.y,e))}getNextValid(e){const t=new v(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new pn(t.x,t.y,this.z))}}u(pn,"coordEncoder",ch.getCoord3DEncoder((IL=pn).of)),u(pn,"optionalEncoder",g.getEncoder(IL.coordEncoder));let Ul=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var b1e;let w1e=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class dr extends yo{static ofClimb(e,t,n){const i=g.of(e),o=dr.checkCaptures(n),s=new dr(i,t,o.firstCapture,o.secondCapture);return H.assert(t.isHigherThan(e),Ul.MUST_MOVE_UPWARD()),s}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(w1e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=dr.checkCaptures(t);return new dr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=dr.checkCaptures(t);return new dr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new dr(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}b1e=dr,u(dr,"encoder",Ne.tuple([pn.optionalEncoder,pn.coordEncoder,pn.optionalEncoder,pn.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>b1e.of(r[0],r[1],r[2],r[3])));class Wl extends sC{static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return H.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:W.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:W.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:W.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[wt.copy(this.boards[0]),wt.copy(this.boards[1]),wt.copy(this.boards[2]),wt.copy(this.boards[3])];for(const i of e){const o=i.coord;n[o.z][o.y][o.x]=i.value}return new Wl(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===W.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[W.NONE.value]=0,e[k.ZERO.value]=0,e[k.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const o=new pn(i,n,t),s=this.getPieceAt(o);e[s.value]=1+e[s.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:W.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Wl.getLevelRange(n);for(const o of i)for(const s of i){const a=new pn(s,o,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class wi extends Sr{static get(){return wi.singleton.isAbsent()&&(wi.singleton=g.of(new wi)),wi.singleton.get()}getInitialState(){const e=wt.create(4,4,W.NONE),t=wt.create(3,3,W.NONE),n=wt.create(2,2,W.NONE);return new Wl([e,t,n,[[W.NONE]]],0)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let o=0;o<4-i;o++)for(let s=0;s<4-i;s++){const a=new pn(s,o,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(o=>n.equals(o))){const o=dr.ofClimb(n,i,[]);t.push(o)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=dr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[Re.UP,Re.DOWN]){const o=t.getNextValid(i);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(const s of[Re.LEFT,Re.RIGHT]){const a=o.get().getNextValid(s);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new it,n=e.getFreeToMoves();for(const i of n){t.add(new it([i]));const s=e.removePieceAt(i).getFreeToMoves();for(const a of s){const c=new it([i,a]);t.add(c)}}return t}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(s=>e.getPieceAt(s).isPlayer()&&!1===s.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[k.ZERO.value]?_e.ONE_WON:15===n[k.ONE.value]?_e.ZERO_WON:_e.ONGOING}applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),o=this.isLegalLandingCoord(e,i);if(o.isFailure())return o.toOtherFallible();const s=o.get(),a=this.isLegalCaptures(e,s);return a.isFailure()?a:w.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),o=t.getPieceAt(i);if(o===n)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return Q.success(a)}return Q.failure(Ul.CANNOT_MOVE_SUPPORTING_PIECE())}return Q.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?Q.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?Q.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):Q.failure(Ul.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return w.SUCCESS;if(!1===wi.canCapture(t,e.landingCoord))return w.failure(Ul.CANNOT_CAPTURE());if(wi.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||wi.isValidCapture(n,e,e.secondCapture.get())?w.SUCCESS:w.failure(Ul.INVALID_SECOND_CAPTURE())}return w.failure(Ul.INVALID_FIRST_CAPTURE())}getGameStatus(e){return wi.getGameStatus(e)}}u(wi,"singleton",g.empty());class N1e extends jn{getListMoves(e,t){const n=e.gameState,i=[],o=wi.getStateInfo(n),s=wi.getClimbingMoves(o),a=wi.getDropMoves(o),c=s.concat(a);for(const l of c){const f=n.applyLegalMove(l,!1);let d=new it;wi.canCapture(f,l.landingCoord)?d=wi.getPossibleCaptures(f):i.push(l);for(const m of d){const E=dr.changeCapture(l,m.toList());i.push(E)}}return i}}class RBe extends N1e{getListMoves(e,t){const n=super.getListMoves(e,t);return this.orderMoves(n)}orderMoves(e){return e.sort((t,n)=>{const i=12*this.countStoneUsed(t),o=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(t)-(o+this.sumMoveEmplacementByValue(n))})}countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}class zBe extends B1{getMetrics(e,t){const n=e.gameState.getPiecesRepartition();return g1.of([n[k.ZERO.value]],[n[k.ONE.value]])}}function DBe(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),A("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function HBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,DBe,1,6,"circle",7),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function VBe(r,e){if(1&r){const t=ge();I(),P(0,"circle",12),q("click",function(){ee(t);const i=p(2).$implicit,o=p().$implicit,s=p().$implicit;return te(p().onPieceClick(i,o,s))}),S()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,o=p();Hr("id","piece_",t,"_",n,"_",i,""),y("ngClass",o.getPieceClasses(t,n,i)),A("r",o.getPieceRadius(i)-o.STROKE_WIDTH)("cx",o.getPieceCx(t,n,i))("cy",o.getPieceCy(t,n,i))}}function FBe(r,e){if(1&r){const t=ge();I(),P(0,"rect",12),q("click",function(){ee(t);const i=p(3).$implicit,o=p().$implicit,s=p().$implicit;return te(p().onDrop(i,o,s))}),S()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,o=p();Hr("id","drop_",t,"_",n,"_",i,""),y("ngClass",o.getSquareClasses(t,n,i)),A("width",2*o.getPieceRadius(i))("height",2*o.getPieceRadius(i))("x",o.getPieceCx(t,n,i)-o.getPieceRadius(i))("y",o.getPieceCy(t,n,i)-o.getPieceRadius(i))}}function $Be(r,e){if(1&r&&(I(),O(0,FBe,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function GBe(r,e){if(1&r&&(I(),qt(0),O(1,VBe,1,7,"circle",10),O(2,$Be,1,1,"ng-template",null,11,mn),jt()),2&r){const t=dn(3),n=p().$implicit,i=p().$implicit,o=p().$implicit,s=p();_(1),y("ngIf",s.isOccupied(n,i,o))("ngIfElse",t)}}function BBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,GBe,4,2,"ng-container",9),S()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,o=p();_(1),y("ngIf",o.mustDraw(t,n,i))}}function UBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,BBe,2,1,"g",1),S()),2&r){const t=p().$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function WBe(r,e){if(1&r&&(I(),P(0,"g"),O(1,UBe,2,1,"g",1),S()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function qBe(r,e){if(1&r&&(I(),V(0,"rect",14)),2&r){const t=p();Hr("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),A("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function jBe(r,e){if(1&r){const t=ge();I(),P(0,"g",15),q("click",function(){return ee(t),te(p().validateCapture())}),V(1,"circle",16)(2,"polygon",17),S()}if(2&r){const t=p();A("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),_(1),y("ngClass",t.getCaptureValidationButtonClasses()),A("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function ZBe(r,e){if(1&r){const t=ge();I(),P(0,"g",18),q("click",function(){const o=ee(t).$implicit;return te(p().onPieceClick(o.x,o.y,o.z))}),V(1,"line",19)(2,"line",19),S()}if(2&r){const t=e.$implicit,n=p();Hr("id","capturable_",t.x,"_",t.y,"_",t.z,""),A("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),_(1),A("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),_(1),A("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const YBe=function(){return[0,1,2]};let KBe=(()=>{var r;class e extends n3{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.setRulesAndNode("Pylos"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new zBe,new RBe),new bn($localize`MCTS`,new N1e,this.rules)],this.encoder=dr.encoder,this.hasAsymmetricBoard=!0}getPiecesCyForPlayer(n){return n===k.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Wl.getLevelRange(n)}mustDraw(n,i,o){const s=new pn(n,i,o);return!!(this.constructedState.getPieceAt(s).isPlayer()||this.justClimbed(s)||this.isCaptured(s))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(s)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,o){var s=this;return M(function*(){const a=yield s.canUserPlay("#piece_"+n+"_"+i+"_"+o);if(a.isFailure())return s.cancelMove(a.getReason());const c=new pn(n,i,o);return s.state.getPieceAt(c)===s.state.getCurrentOpponent()?s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):s.chosenStartingCoord.equalsValue(c)?(s.cancelMoveAttempt(),w.SUCCESS):s.chosenLandingCoord.isPresent()?s.isSupporting(c,s.constructedState)?s.cancelMove(Ul.CANNOT_MOVE_SUPPORTING_PIECE()):s.onCaptureClick(c):s.isSupporting(c,s.getState())?s.cancelMove(Ul.CANNOT_MOVE_SUPPORTING_PIECE()):s.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return M(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),w.SUCCESS})()}onCaptureClick(n){var i=this;return M(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),w.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),w.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),w.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),w.SUCCESS):i.cancelMove(w1e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return M(function*(){const i=yield n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?w.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return M(function*(){if(i.chosenStartingCoord.isAbsent()){const o=dr.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(o)}{const o=dr.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(o)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,o){var s=this;return M(function*(){const a=yield s.canUserPlay("#drop_"+n+"_"+i+"_"+o);if(a.isFailure())return s.cancelMove(a.getReason());const c=new pn(n,i,o);return wi.canCapture(s.constructedState,c)?(s.chosenLandingCoord=g.of(c),s.constructedState=s.constructedState.dropCurrentPlayersPieceAt(c),s.updateCapturableList(),w.SUCCESS):(s.chosenLandingCoord=g.of(c),s.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,o){const s=new pn(n,i,o);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(s)||a.secondCapture.equalsValue(s))return["captured-fill"];if(s.equals(a.landingCoord)||a.startingCoord.equalsValue(s))return["moved-fill"]}else if(this.justClimbed(s))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,o){return this.SPACE_SIZE/2+.5*o*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,o){return this.SPACE_SIZE/2+.5*o*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,o){const s=new pn(n,i,o);if(this.justClimbed(s))return!1;const a=this.getState().getPieceAt(s).isPlayer(),c=this.chosenLandingCoord.equalsValue(s);return a||c}getPieceClasses(n,i,o){const s=new pn(n,i,o),a=[this.getPieceFillClass(s)];return(this.lastLandingCoord.equalsValue(s)||this.lastStartingCoord.equalsValue(s))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(s)||this.chosenLandingCoord.equalsValue(s))&&a.push("selected-stroke"),this.isCaptured(s)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],o=[];for(let s=0;s<i;s++)o.push(s);return o}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.constructedState=i.state,i.lastMove=i.node.previousMove;const o=i.state.getPiecesRepartition();i.remainingPieces={0:15-o[0],1:15-o[1]},i.highCapture=g.empty(),i.cancelMoveAttempt(),i.hideLastMove()})()}showLastMove(n){var i=this;return M(function*(){i.lastLandingCoord=g.of(n.landingCoord),i.lastStartingCoord=n.startingCoord,i.lastFirstCapture=n.firstCapture,i.lastSecondCapture=n.secondCapture,i.lastFirstCapture.isPresent()&&!1===i.mustDrawCoord(i.lastFirstCapture.get())&&(i.highCapture=i.lastFirstCapture)})()}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,o){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new pn(n,i,o))||this.chosenStartingCoord.get().z<o}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-pylos"]],features:[Ge],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"g"),O(2,HBe,2,1,"g",1),S(),P(3,"g",null,2),V(5,"rect",3),O(6,WBe,2,1,"g",1),O(7,qBe,1,7,"rect",4),O(8,jBe,3,5,"g",5),O(9,ZBe,3,12,"g",6),S()()),2&n&&(A("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),_(1),A("transform","rotate("+180*i.getPointOfView().value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),_(1),y("ngForOf",i.Player.PLAYERS),_(1),A("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),_(2),A("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),_(1),y("ngForOf",Q1(10,YBe)),_(1),y("ngIf",i.highCapture.isPresent()),_(1),y("ngIf",i.chosenLandingCoord.isPresent()),_(1),y("ngForOf",i.capturables))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const Be=W.NONE,L4=W.ZERO,A1e=W.ONE;class XBe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,wi.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,wi.get().getInitialState(),dr.ofDrop(new pn(1,1,0),[]),$localize`There you go, as simple as that.`),j.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Wl([[[L4,A1e,Be,Be],[A1e,L4,Be,Be],[Be,Be,Be,Be],[Be,Be,Be,L4]],[[Be,Be,Be],[Be,Be,Be],[Be,Be,Be]],[[Be,Be],[Be,Be]],[[Be]]],0),[dr.ofClimb(new pn(3,3,0),new pn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),j.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Wl([[[L4,L4,Be,Be],[Be,L4,Be,Be],[Be,Be,Be,Be],[Be,Be,Be,Be]],[[Be,Be,Be],[Be,Be,Be],[Be,Be,Be]],[[Be,Be],[Be,Be]],[[Be]]],0),[dr.ofDrop(new pn(0,1,0),[new pn(0,0,0)]),dr.ofDrop(new pn(0,1,0),[new pn(0,1,0)]),dr.ofDrop(new pn(0,1,0),[new pn(1,0,0)]),dr.ofDrop(new pn(0,1,0),[new pn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),j.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Wl([[[L4,L4,Be,Be],[Be,L4,Be,Be],[Be,Be,Be,Be],[Be,Be,Be,Be]],[[Be,Be,Be],[Be,Be,Be],[Be,Be,Be]],[[Be,Be],[Be,Be]],[[Be]]],0),dr.ofDrop(new pn(0,1,0),[new pn(0,0,0),new pn(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?w.SUCCESS:t.firstCapture.isPresent()?w.failure($localize`Failed, you only captured one piece.`):w.failure(m1e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}var Ln,I1e;class yt{static ofInt(e){if(0<=e&&e<=15)return yt.pieces[e];if(16===e)return yt.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(yt,"AAAA",new(Ln=yt)(0)),u(yt,"AAAB",new Ln(1)),u(yt,"AABA",new Ln(2)),u(yt,"AABB",new Ln(3)),u(yt,"ABAA",new Ln(4)),u(yt,"ABAB",new Ln(5)),u(yt,"ABBA",new Ln(6)),u(yt,"ABBB",new Ln(7)),u(yt,"BAAA",new Ln(8)),u(yt,"BAAB",new Ln(9)),u(yt,"BABA",new Ln(10)),u(yt,"BABB",new Ln(11)),u(yt,"BBAA",new Ln(12)),u(yt,"BBAB",new Ln(13)),u(yt,"BBBA",new Ln(14)),u(yt,"BBBB",new Ln(15)),u(yt,"EMPTY",new Ln(16)),u(yt,"pieces",[Ln.AAAA,Ln.AAAB,Ln.AABA,Ln.AABB,Ln.ABAA,Ln.ABAB,Ln.ABBA,Ln.ABBB,Ln.BAAA,Ln.BAAB,Ln.BABA,Ln.BABB,Ln.BBAA,Ln.BBAB,Ln.BBBA,Ln.BBBB]),u(yt,"encoder",Ne.fromFunctions(r=>r.value,Ln.ofInt));class p3 extends Or{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}I1e=p3,u(p3,"encoder",Ne.tuple([v.encoder,yt.encoder],r=>[r.coord,r.piece],r=>new I1e(r[0].x,r[0].y,r[1])));class m3 extends k1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static isGivable(e,t,n){return e!==n&&!1===m3.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=yt.pieces,t=[];for(const n of e)m3.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}var c1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(c1||{});let kL=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class lh{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new lh(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new lh(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class _3{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class Xr extends Sr{static get(){return Xr.singleton.isAbsent()&&(Xr.singleton=g.of(new Xr)),Xr.singleton.get()}getInitialState(){const e=wt.create(4,4,yt.EMPTY);return new m3(e,0,yt.AAAA)}static isOccupied(e){return e!==yt.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,o=e.piece,s=t.getCopiedBoard(),a=t.pieceInHand;return Xr.isOccupied(s[i][n])?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):o===yt.EMPTY?15===t.turn?w.SUCCESS:w.failure(kL.MUST_GIVE_A_PIECE()):m3.isAlreadyOnBoard(o,s)?w.failure(kL.PIECE_ALREADY_ON_BOARD()):a===o?w.failure(kL.CANNOT_GIVE_PIECE_IN_HAND()):w.SUCCESS}isLegal(e,t){return Xr.isLegal(e,t)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.coord.y][e.coord.x]=t.pieceInHand,new m3(o,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===c1.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:c1.VICTORY,sensitiveSquares:new U1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const o=new lh(i);for(let s=0;s<3&&!1!==Xr.isOccupied(i)&&!o.areAllAbsent();s++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),o.mergeWithQuartoPiece(i);return!(!Xr.isOccupied(i)||!1!==o.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=Xr.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const o=i.commonCriterion,s=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(s.isAbsent())return{score:c1.VICTORY,sensitiveSquares:new U1};{o.get().matchPiece(t.pieceInHand)&&(n.score=c1.PRE_VICTORY);const a=s.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),o=g.empty(),s=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(s);if(c===yt.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(s),commonCriterion:o,boardStatus:g.of(n)};i=g.of(s)}else o.isAbsent()?(o=g.of(new lh(c)),we.display("QuartoRules","getLineInfos","set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(c),we.display("QuartoRules","getLineInfos","update commonCrit: "+o.toString()));s=s.getNext(e.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=k.of(t%2);return e===c1.VICTORY?_e.getDefeat(n):16===t?_e.DRAW:_e.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:c1.DEFAULT,sensitiveSquares:new U1};for(const i of Xr.lines)if(n=Xr.updateBoardStatus(i,t,n),n.score===c1.VICTORY)return Xr.scoreToGameStatus(n.score,t.turn);return Xr.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of Xr.lines)if(Xr.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(Xr,"singleton",g.empty()),u(Xr,"lines",[new _3(new v(0,0),ve.DOWN),new _3(new v(1,0),ve.DOWN),new _3(new v(2,0),ve.DOWN),new _3(new v(3,0),ve.DOWN),new _3(new v(0,0),ve.RIGHT),new _3(new v(0,1),ve.RIGHT),new _3(new v(0,2),ve.RIGHT),new _3(new v(0,3),ve.RIGHT),new _3(new v(0,0),ve.DOWN_RIGHT),new _3(new v(0,3),ve.UP_RIGHT)]);class QBe extends Ya{scoreToBoardValue(e,t){if(e===c1.DEFAULT)return un.of(0);{H.assert(e===c1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=k.of(t%2);return un.of(n.getPreVictory())}}getBoardValue(e,t){const n=e.gameState;let i={score:c1.DEFAULT,sensitiveSquares:new U1};for(const o of Xr.lines)i=Xr.updateBoardStatus(o,n,i);return this.scoreToBoardValue(i.score,n.turn)}}class k1e extends jn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCopiedBoard(),s=i.getRemainingPieces(),a=i.pieceInHand;let c;for(let l=0;l<4;l++)for(let f=0;f<4;f++)if(o[l][f]===yt.EMPTY){if(c=i.getCopiedBoard(),c[l][f]=a,15===i.turn){const d=new p3(f,l,yt.EMPTY);return n.push(d),n}for(const d of s){const m=new p3(f,l,d);n.push(m)}}return n}}function JBe(r,e){if(1&r&&(I(),V(0,"rect",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.getPieceClasses(n.value)),A("x",s.SPACE_SIZE*i+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("y",s.SPACE_SIZE*o+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("width",2*s.getPieceSize(n.value))("height",2*s.getPieceSize(n.value))}}function eUe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.getPieceClasses(n.value)),A("cx",s.SPACE_SIZE*i+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.SPACE_SIZE/2)("r",s.getPieceSize(n.value))}}function tUe(r,e){if(1&r&&(I(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();A("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function nUe(r,e){if(1&r&&(I(),P(0,"g"),O(1,JBe,1,5,"rect",11),O(2,eUe,1,4,"ng-template",null,12,mn),O(4,tUe,1,3,"circle",10),S()),2&r){const t=dn(3),n=p().$implicit,i=p(2);_(1),y("ngIf",n.isRectangle())("ngIfElse",t),_(3),y("ngIf",i.pieceHasDot(n.value))}}function rUe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",9),q("click",function(){const o=ee(t).index,s=p().index;return te(p().chooseCoord(o,s))}),S(),O(2,nUe,5,3,"g",10),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),Ce("id","chooseCoord_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function iUe(r,e){if(1&r&&(I(),P(0,"g",null,8),O(2,rUe,3,8,"g",2),S()),2&r){const t=e.$implicit;_(2),y("ngForOf",t)}}function oUe(r,e){if(1&r&&(I(),V(0,"rect",18)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),A("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function sUe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),A("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function aUe(r,e){if(1&r&&(I(),V(0,"circle")),2&r){const t=p(2);A("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function cUe(r,e){if(1&r){const t=ge();I(),P(0,"g",14,15),q("click",function(){return ee(t),te(p().deselectDroppedPiece())}),V(2,"rect",16),O(3,oUe,1,5,"rect",17),O(4,sUe,1,4,"ng-template",null,12,mn),O(6,aUe,1,3,"circle",10),S()}if(2&r){const t=dn(5),n=p();Ce("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),A("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),_(2),A("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function lUe(r,e){if(1&r&&(I(),P(0,"g",null,19),V(2,"rect",20),S()),2&r){const t=e.$implicit,n=p();_(2),A("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function uUe(r,e){if(1&r&&(I(),V(0,"rect",13)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),A("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function fUe(r,e){if(1&r&&(I(),V(0,"circle",23)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),A("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function dUe(r,e){1&r&&(I(),V(0,"circle",24)),2&r&&A("cy",.75*p(2).SPACE_SIZE)("r",10)}function hUe(r,e){if(1&r&&(I(),P(0,"g",21),O(1,uUe,1,6,"rect",11),O(2,fUe,1,3,"ng-template",null,12,mn),O(4,dUe,1,2,"circle",22),S()),2&r){const t=dn(3),n=p();_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function gUe(r,e){if(1&r&&(I(),V(0,"rect",29)),2&r){const t=p(2).index,n=p().index,i=p();hn("id","chosenPiece_",4*n+t,""),A("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function pUe(r,e){if(1&r&&(I(),V(0,"rect",13)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),A("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function mUe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),A("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function _Ue(r,e){if(1&r&&(I(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();A("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function vUe(r,e){if(1&r){const t=ge();I(),P(0,"g",14),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().choosePiece(4*o+i))}),O(1,gUe,1,5,"rect",28),O(2,pUe,1,5,"rect",11),O(3,mUe,1,4,"ng-template",null,12,mn),O(5,_Ue,1,3,"circle",10),S()}if(2&r){const t=dn(4),n=p().index,i=p().index,o=p();hn("id","choosePiece_",4*i+n,""),_(1),y("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.ofInt(4*i+n))),_(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),_(3),y("ngIf",o.pieceHasDot(4*i+n))}}function CUe(r,e){if(1&r&&(I(),P(0,"g"),O(1,vUe,6,5,"g",3),S()),2&r){const t=e.index,n=p().index,i=p();_(1),y("ngIf",i.isRemaining(4*n+t))}}function yUe(r,e){if(1&r&&(I(),P(0,"g",null,25),V(2,"rect",26,27),O(4,CUe,2,1,"g",2),S()),2&r){const t=e.$implicit,n=p();A("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),_(2),A("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),_(2),y("ngForOf",t)}}let MUe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"EMPTY",yt.EMPTY),u(this,"QuartoPiece",yt),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",yt.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.setRulesAndNode("Quarto"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new QBe,new k1e),new bn($localize`MCTS`,new k1e,this.rules)],this.encoder=p3.encoder,this.pieceInHand=this.getState().pieceInHand}updateBoard(n){var i=this;return M(function*(){const o=i.getState(),s=i.node.previousMove;i.board=o.getCopiedBoard(),i.chosen=g.empty(),i.pieceInHand=o.pieceInHand,i.victoriousCoords=i.rules.getVictoriousCoords(o),i.lastMove=s.map(a=>a.coord)})()}chooseCoord(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#chooseCoord_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());if(o.hideLastMove(),o.board[i][n]===yt.EMPTY){if(o.showPieceInHandOnBoard(n,i),15===o.getState().turn){const a=new p3(n,i,yt.EMPTY);return o.chooseMove(a)}if(o.pieceToGive.isAbsent())return w.SUCCESS;{const a=new p3(n,i,o.pieceToGive.get());return o.chooseMove(a)}}return o.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#choosePiece_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(yt.ofInt(n)))return i.cancelMoveAttempt(),w.SUCCESS;if(i.pieceToGive=g.of(yt.ofInt(n)),i.chosen.isAbsent())return w.SUCCESS;{const s=i.chosen.get(),a=new p3(s.x,s.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){var n=this;return M(function*(){const i=n.chosen.getOrElse(new v(404,404)),o="#droppedPiece_"+i.x+"_"+i.y,s=yield n.canUserPlay(o);return s.isFailure()?n.cancelMove(s.getReason()):(n.cancelMoveAttempt(),w.SUCCESS)})()}showPieceInHandOnBoard(n,i){this.chosen=g.of(new v(n,i))}isRemaining(n){return m3.isGivable(yt.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const o=new v(n,i);return this.lastMove.equalsValue(o)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==yt.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-quarto"]],features:[Ge],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["id","pieceInHand",4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["id","pieceInHand"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"g",1),O(2,iUe,3,1,"g",2),O(3,cUe,7,8,"g",3),O(4,lUe,3,3,"g",2),P(5,"g",null,4),V(7,"rect",5,6),O(9,hUe,5,3,"g",7),S(),O(10,yUe,5,6,"g",2),S()()),2&n&&(A("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),_(2),y("ngForOf",i.board),_(1),y("ngIf",i.chosen.isPresent()),_(1),y("ngForOf",i.victoriousCoords),_(1),A("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),_(2),A("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),_(2),y("ngIf",i.chosen.isAbsent()&&i.pieceInHand!==i.EMPTY),_(1),y("ngForOf",i.board))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const EUe=yt.AABA,PUe=yt.AABB,x1e=yt.ABAA,SUe=yt.ABAB,OUe=yt.ABBA,L1e=yt.BAAA,TUe=yt.BAAB,bUe=yt.BABB,R1e=yt.BBAA,wUe=yt.BBAB,xL=yt.BBBA,NUe=yt.BBBB,e1=yt.EMPTY;class AUe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new m3([[xL,R1e,x1e,EUe],[e1,e1,e1,e1],[e1,e1,e1,e1],[e1,e1,e1,e1]],7,yt.ABAB)),j.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new m3([[xL,PUe,OUe,e1],[e1,e1,e1,e1],[e1,L1e,e1,e1],[e1,e1,e1,e1]],7,yt.ABAA),new p3(2,2,yt.BAAB),$localize`Perfect!`),j.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new m3([[NUe,xL,wUe,e1],[x1e,bUe,R1e,e1],[SUe,L1e,TUe,e1],[e1,e1,e1,e1]],7,yt.AABA),[new p3(3,3,yt.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}var z1e;class G0 extends Or{constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}z1e=G0,u(G0,"encoder",Ne.tuple([v.encoder,Re.encoder],r=>[r.coord,r.direction],r=>new z1e(r[0].x,r[0].y,r[1])));class Fu extends k1{applyLegalMove(e){const t=this.getCopiedBoard(),n=this.turn+1;let i=e.coord,o=e.coord.getNext(e.direction);for(;this.isOnBoard(o);)t[i.y][i.x]=t[o.y][o.x],i=i.getNext(e.direction),o=o.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new Fu(t,n)}}let IUe=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})();class Qr extends ja{static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[],i=e.gameState;for(let o=0;o<i.getHeight();o++)i.getPieceAtXY(0,o)!==t&&n.push(new v(0,o)),i.getPieceAtXY(i.getWidth()-1,o)!==t&&n.push(new v(i.getWidth()-1,o));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[],i=e.gameState;for(let o=1;o<i.getWidth()-1;o++)i.getPieceAtXY(o,0)!==t&&n.push(new v(o,0)),i.getPieceAtXY(o,i.getHeight()-1)!==t&&n.push(new v(o,i.getHeight()-1));return n}static getLinesSums(e){const t={};t[k.ZERO.value]={columns:new Qt,rows:new Qt,ascendingDiagonal:new Qt,descendingDiagonal:new Qt},t[k.ONE.value]={columns:new Qt,rows:new Qt,ascendingDiagonal:new Qt,descendingDiagonal:new Qt};for(const n of e.getCoordsAndContents()){const i=n.content,o=n.coord.x,s=n.coord.y;if(i.isPlayer()){const a=i.value,c=t[a].columns.get(o).getOrElse(0);t[a].columns.put(o,c+1);const l=t[a].rows.get(s).getOrElse(0);t[a].rows.put(s,l+1);const f=t[a].ascendingDiagonal.get(o+s).getOrElse(0);t[a].ascendingDiagonal.put(o+s,f+1);const d=t[a].descendingDiagonal.get(o-s).getOrElse(0);t[a].descendingDiagonal.put(o-s,d+1)}}return t}static getVictoriousCoords(e){return Qr.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){let t=e.columns.listValues();return t=t.concat(e.rows.listValues()),t=t.concat(e.ascendingDiagonal.listValues()),t=t.concat(e.descendingDiagonal.listValues()),Math.max(...t)}static get(){return Qr.singleton.isAbsent()&&(Qr.singleton=g.of(new Qr)),Qr.singleton.get()}getRulesConfigDescription(){return g.of(Qr.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=wt.create(e.get().width,e.get().height,W.NONE);return new Fu(t,0)}getPossibleDirections(e,t){const n=[];return 0!==t.x&&n.push(Re.LEFT),0!==t.y&&n.push(Re.UP),t.x!==e.getWidth()-1&&n.push(Re.RIGHT),t.y!==e.getHeight()-1&&n.push(Re.DOWN),n}isValidCoord(e,t){return H.assert(e.isOnBoard(t),"Invalid coord for QuixoMove: "+t.toString()+" is outside the board."),0!==t.x&&t.x!==e.getWidth()-1&&0!==t.y&&t.y!==e.getHeight()-1?w.failure(IUe.NO_INSIDE_CLICK()):w.SUCCESS}assertDirectionValidity(e,t){const n=e.coord.x,i=e.coord.y,o=e.direction;H.assert(n!==t.getWidth()-1||o!==Re.RIGHT,"Invalid direction: pawn on the right side can't be moved to the right."),H.assert(i!==t.getHeight()-1||o!==Re.DOWN,"Invalid direction: pawn on the bottom side can't be moved down."),H.assert(0!==n||o!==Re.LEFT,"Invalid direction: pawn on the left side can't be moved to the left."),H.assert(0!==i||o!==Re.UP,"Invalid direction: pawn on the top side can't be moved up.")}applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){const n=this.isValidCoord(t,e.coord);return n.isFailure()?n:(this.assertDirectionValidity(e,t),t.getPieceAt(e.coord)===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):w.SUCCESS)}getGameStatus(e){const t=e.gameState,i=Qr.QUIXO_HELPER.getVictoriousCoord(t).map(s=>t.getPieceAt(s)),o=new it(i);return 0===o.size()?_e.ONGOING:1===o.size()?_e.getVictory(o.getAnyElement().get()):_e.getVictory(t.getCurrentPlayer())}}u(Qr,"singleton",g.empty()),u(Qr,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Quixo`,config:{width:new br(5,Ss.WIDTH,Tr.range(1,99)),height:new br(5,Ss.HEIGHT,Tr.range(1,99))}})),u(Qr,"QUIXO_HELPER",new Su(H.identity,5));class D1e extends jn{getListMoves(e,t){const n=e.gameState,i=[],o=Qr.getVerticalCoords(e),a=Qr.getHorizontalCenterCoords(e).concat(o);for(const c of a){const l=Qr.get().getPossibleDirections(n,c);for(const f of l){const d=new G0(c.x,c.y,f);i.push(d)}}return i}}class kUe extends B1{getMetrics(e,t){const i=Qr.getLinesSums(e.gameState),o=Qr.getFullestLine(i[k.ZERO.value]),s=Qr.getFullestLine(i[k.ONE.value]);return g1.of([o],[s])}}function xUe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"circle",4),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onBoardClick(o,s))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),A("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function LUe(r,e){if(1&r&&(I(),P(0,"g"),O(1,xUe,2,6,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function RUe(r,e){if(1&r){const t=ge();I(),P(0,"use",6),q("click",function(){const o=ee(t).$implicit;return te(p(2).chooseDirection(o))}),S()}if(2&r){const t=e.$implicit,n=p(2);hn("id","chooseDirection_",t,""),A("transform",n.getArrowTransform(t))}}function zUe(r,e){if(1&r&&(I(),P(0,"g"),O(1,RUe,1,2,"use",5),S()),2&r){const t=p();_(1),y("ngForOf",t.getPossiblesDirections())}}let DUe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"QuixoState",Fu),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.setRulesAndNode("Quixo"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new kUe,new D1e),new bn($localize`MCTS`,new D1e,this.rules)],this.encoder=G0.encoder}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board,i.lastMoveCoord=i.node.previousMove.map(o=>o.coord),i.victoriousCoords=Qr.getVictoriousCoords(i.state)})()}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const o=new v(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(o)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(o)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),a}onBoardClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i),c=o.getState(),l=o.rules.isValidCoord(c,a);return l.isFailure()?o.cancelMove(l.getReason()):o.board[i][n]===o.state.getCurrentOpponent()?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(o.chosenCoord.equalsValue(a)?o.cancelMoveAttempt():o.chosenCoord=g.of(a),w.SUCCESS)})()}getPossiblesDirections(){const n=[],i=this.chosenCoord.get(),o=this.getState();return i.x!==o.getWidth()-1&&n.push(Re.RIGHT),0!==i.x&&n.push(Re.LEFT),i.y!==o.getHeight()&&n.push(Re.DOWN),0!==i.y&&n.push(Re.UP),n}chooseDirection(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#chooseDirection_"+n.toString());return o.isFailure()?i.cancelMove(o.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return M(function*(){const i=n.chosenCoord.get(),o=new G0(i.x,i.y,n.chosenDirection);return n.chooseMove(o)})()}getArrowTransform(n){const i=this.getState(),o=i.getWidth()*this.SPACE_SIZE,s=i.getHeight()*this.SPACE_SIZE;return JDe.getArrowTransform(o,s,n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-quixo"]],features:[Ge],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0)(1,"defs"),V(2,"polygon",1),S(),O(3,LUe,2,1,"g",2),O(4,zUe,2,1,"g",3),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const S1=W.NONE,Ea=W.ZERO,sc=W.ONE,HUe=Qr.get().getDefaultRulesConfig();class VUe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,Qr.get().getInitialState(HUe)),j.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new Fu([[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[Ea,Ea,Ea,Ea,S1]],1),[new G0(4,4,Re.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new Fu([[S1,sc,S1,sc,sc],[S1,Ea,Ea,S1,Ea],[sc,sc,sc,Ea,sc],[Ea,S1,Ea,sc,sc],[sc,Ea,S1,sc,Ea]],31),[new G0(3,0,Re.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}var LL;class rs extends Or{static of(e){return new rs(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(rs,"encoder",Or.getEncoder((LL=rs).of)),u(rs,"PASS",new LL(-1,-1));class B0 extends k1{getNeighboringPawnLike(e,t){let n;const i=[];for(let o=-1;o<2;o++)for(let s=-1;s<2;s++)n=new v(t.x+s,t.y+o),this.isOnBoard(n)&&this.board[n.y][n.x]===e&&i.push(n);return i}countScore(){const e=[0,0];for(const t of this.getCoordsAndContents()){const n=t.content;n.isPlayer()&&(e[n.value]+=1)}return e}}let FUe=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var uh,U0;class H1e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let W0=(uh=class extends ja{static get(){return U0.singleton.isAbsent()&&(U0.singleton=g.of(new U0)),U0.singleton.get()}getRulesConfigDescription(){return g.of(U0.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=e.get(),n=wt.create(t.width,t.height,W.NONE),i=new v(Math.floor(t.width/2),Math.floor(t.height/2));return n[i.y-1][i.x-1]=k.ZERO,n[i.y][i.x]=k.ZERO,n[i.y-1][i.x]=k.ONE,n[i.y][i.x-1]=k.ONE,new B0(n,0)}applyLegalMove(e,t,n,i){const o=t.turn,s=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(rs.PASS))return new B0(a,o+1);for(const l of i)a[l.y][l.x]=s;return a[e.coord.y][e.coord.x]=s,new B0(a,o+1)}getAllSwitcheds(e,t,n){const i=[],o=t.getOpponent();for(const s of ve.DIRECTIONS){const a=e.coord.getNext(s);if(n.isOnBoard(a)&&n.getPieceAt(a)===o){const c=this.getSandwicheds(t,s,a,n);for(const l of c)i.push(l)}}return i}getSandwicheds(e,t,n,i){const o=[n];let s=n.getNext(t);for(;i.isOnBoard(s);){const a=i.getPieceAt(s);if(a===e)return o;if(a===W.NONE)return[];o.push(s),s=s.getNext(t)}return[]}isGameEnded(e,t){return this.playerCanOnlyPass(e,t)&&this.nextPlayerCantOnlyPass(e,t)}getGameStatus(e,t){const n=e.gameState;if(!1===this.isGameEnded(n,t))return _e.ONGOING;const o=n.countScore(),s=o[1]-o[0];return s<0?_e.ZERO_WON:s>0?_e.ONE_WON:_e.DRAW}playerCanOnlyPass(e,t){const n=this.getListMoves(e,t);return 1===n.length&&n[0].move.equals(rs.PASS)}nextPlayerCantOnlyPass(e,t){const n=e.getCopiedBoard(),o=new B0(n,e.turn+1);return this.playerCanOnlyPass(o,t)}getListMoves(e,t){const n=[];let i;const o=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(const a of e.getCoordsAndContents()){const c=a.coord;if(e.getPieceAt(c)===W.NONE&&(i=e.getCopiedBoard(),e.getNeighboringPawnLike(s,c).length>0)){const f=new rs(c.x,c.y),d=this.getAllSwitcheds(f,o,e);if(d.length>0){for(const m of d)H.assert(o!==e.getPieceAt(m),m+"was already switched!"),i[m.y][m.x]=o;i[c.y][c.x]=o,n.push(new H1e(f,d.length))}}}return 0===n.length&&n.push(new H1e(rs.PASS,0)),n}isLegal(e,t,n){if(e.equals(rs.PASS))return this.playerCanOnlyPass(t,n)?Q.success([]):Q.failure(Ee.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return Q.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const i=this.getAllSwitcheds(e,t.getCurrentPlayer(),t);return 0===i.length?Q.failure(FUe.NO_ELEMENT_SWITCHED()):Q.success(i)}},U0=uh,u(uh,"singleton",g.empty()),u(uh,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Reversi`,config:{width:new br(8,Ss.WIDTH,Tr.range(3,99)),height:new br(8,Ss.HEIGHT,Tr.range(3,99))}})),uh);W0=U0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],W0);class V1e extends jn{getListMoves(e,t){return W0.get().getListMoves(e.gameState,t).map(i=>i.move)}}class GUe extends B1{getMetrics(e,t){const n=e.gameState,i=g1.of([0],[0]);for(const o of n.getCoordsAndContents()){const s=o.coord,a=o.content,f=(n.isVerticalEdge(s)?4:1)*(n.isHorizontalEdge(s)?4:1);a.isPlayer()&&i.add(a,0,f)}return i}}class BUe extends cn{constructor(){super($localize`Minimax`,W0.get(),new GUe,new V1e)}}function UUe(r,e){if(1&r&&(I(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),A("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function WUe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",2),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S(),O(2,UUe,1,4,"circle",3),S()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),A("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function qUe(r,e){if(1&r&&(I(),P(0,"g"),O(1,WUe,3,8,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let jUe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"EMPTY",W.NONE),u(this,"lastMove",new v(-2,-2)),u(this,"capturedCoords",[]),this.setRulesAndNode("Reversi"),this.availableAIs=[new BUe,new bn($localize`MCTS`,new V1e,this.rules)],this.encoder=rs.encoder,this.scores=g.of([2,2])}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new rs(n,i);return yield o.chooseMove(a)})()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.capturedCoords=[],i.lastMove=new v(-2,-2),i.scores=g.of(o.countScore()),i.canPass=i.rules.playerCanOnlyPass(o,i.config)})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=n.coord;const o=i.getState().getCurrentPlayer(),s=i.getState().getCurrentOpponent();for(const a of ve.DIRECTIONS){let c=i.lastMove.getNext(a,1);for(;i.getState().isOnBoard(c)&&i.getState().getPieceAt(c)===s&&i.getPreviousState().getPieceAt(c)===o;)i.capturedCoords.push(c),c=c.getNext(a,1)}})()}getRectClasses(n,i){const o=new v(n,i);return this.capturedCoords.some(s=>s.equals(o))?["captured-fill"]:o.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return M(function*(){return H.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(rs.PASS.coord.x,rs.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-reversi"]],features:[Ge],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,qUe,2,1,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const Mt=W.NONE,Pt=W.ZERO,Ze=W.ONE,ZUe=W0.get().getDefaultRulesConfig();class YUe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new B0([[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt]],60)),j.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,W0.get().getInitialState(ZUe),new rs(2,4),$localize`Congratulations!`),j.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>You're playing Light here. Play on the bottom left to see a capture.`,new B0([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Ze,Mt,Mt,Mt],[Mt,Mt,Mt,Pt,Mt,Mt,Mt,Mt],[Mt,Mt,Pt,Mt,Mt,Mt,Mt,Mt],[Pt,Pt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Pt,Ze,Pt,Ze,Pt,Mt,Mt]],1),[new rs(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),j.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new B0([[Ze,Pt,Pt,Pt,Pt,Pt,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Ze,Ze,Ze,Ze,Ze,Ze,Mt,Mt],[Pt,Pt,Pt,Pt,Pt,Pt,Mt,Mt]],60))])}}let ql=(()=>{class r extends k0{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),$u=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class ac extends n2{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return w.failure(Ee.MOVE_CANNOT_BE_STATIC());if(1===n){const i=ua.getFakeNeighbors(e);if(t.equals(i))return w.failure($u.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return w.failure($localize`You can move one or two spaces, not ${n}.`);if(ua.isSpaceDark(e))return w.failure($u.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return w.failure($u.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return w.SUCCESS}static from(e,t){H.assert(ql.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),H.assert(ql.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=ac.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new ac(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var JC,v3;u(ac,"encoder",Ko.getFallibleEncoder(ac.from));let R4=(JC=class extends Sr{static get(){return v3.singleton.isAbsent()&&(v3.singleton=g.of(new v3)),v3.singleton.get()}getInitialState(){const e=Me.UNREACHABLE,t=Me.ZERO,n=Me.ONE,i=Me.EMPTY;return new ql([[e,e,t,n,i,i,i,t,n,e,e],[e,i,i,i,i,i,i,i,i,i,e],[n,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,n],[e,i,i,i,i,i,i,i,i,i,e],[e,e,n,t,i,i,i,n,t,e,e]],0)}static getStartingCoords(e,t){const n=[];for(let i=0;i<ql.HEIGHT;i++)for(let o=0;o<ql.WIDTH;o++)e[i][o].is(t)&&n.push(new v(o,i));return n}static getBoardValuesFor(e,t){const n=v3.getStartingCoords(e,t),i=[];for(const o of n){const s=k0.getEmptyNeighbors(e,o,Me.EMPTY).length;if(0===s)return[0,0,0,0,0,0];i.push(s)}return i.sort((o,s)=>o-s)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.getEnd().y][e.getEnd().x]=o[e.getStart().y][e.getStart().x],o[e.getStart().y][e.getStart().x]=Me.EMPTY,new ql(o,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.getPieceAt(e.getEnd())!==Me.EMPTY)return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const o=ua.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?t.getPieceAt(o.get())===Me.EMPTY?w.SUCCESS:w.failure($u.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):w.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=v3.getBoardValuesFor(t,k.ZERO),i=v3.getBoardValuesFor(t,k.ONE);return v3.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=o=>ql.isOnBoard(o)&&e[o.y][o.x]===Me.EMPTY,i=new it(ua.getNeighbors(t).filter(n));if(!0===ua.isSpaceDark(t))return i.toList();{const o=new it(i.toList());for(const s of i){const a=ua.getNeighbors(s).filter(n);for(const c of a)o.add(c)}return o.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?_e.ONE_WON:0===t[0]?_e.ZERO_WON:_e.ONGOING}},v3=JC,u(JC,"singleton",g.empty()),JC);R4=v3=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],R4);class XUe extends B1{getMetrics(e,t){const n=e.gameState.board,i=R4.getBoardValuesFor(n,k.ZERO),o=R4.getBoardValuesFor(n,k.ONE);return g1.of(i,o)}}class $1e extends jn{getListMoves(e,t){const n=[],i=e.gameState.getCopiedBoard(),o=e.gameState.getCurrentPlayer(),s=R4.getStartingCoords(i,o);for(const a of s){const c=k0.getEmptyNeighbors(i,a,Me.EMPTY);for(const l of c){const f=ac.from(a,l).get();if(i[l.y][l.x]=i[a.y][a.x],i[a.y][a.x]=Me.EMPTY,n.push(f),(l.y+l.x)%2==0){const m=k0.getEmptyNeighbors(i,l,Me.EMPTY);for(const E of m)if(!1===E.equals(a)){const T=ac.from(a,E).get();i[E.y][E.x]=i[l.y][l.x],i[l.y][l.x]=Me.EMPTY,n.push(T),i[l.y][l.x]=i[E.y][E.x],i[E.y][E.x]=Me.EMPTY}}i[a.y][a.x]=i[l.y][l.x],i[l.y][l.x]=Me.EMPTY}}return n}}function QUe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"polygon",7),S()),2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getPlayerClassFor(t,n)),A("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function JUe(r,e){if(1&r&&(I(),V(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();A("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function eWe(r,e){if(1&r&&(I(),V(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();A("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function tWe(r,e){if(1&r&&(I(),P(0,"g"),O(1,JUe,1,2,"polygon",8),O(2,eWe,1,2,"polygon",9),S()),2&r){const t=p().index,n=p().index;_(1),y("ngIf",(t+n)%2==1),_(1),y("ngIf",(t+n)%2==0)}}function nWe(r,e){if(1&r){const t=ge();I(),P(0,"g",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),O(1,QUe,2,3,"g",6),O(2,tWe,3,2,"g",6),S()}if(2&r){const t=e.$implicit;Ce("id","click_",e.index,"_",p().index,""),_(1),y("ngIf",t.isPlayer()),_(1),y("ngIf",2===t.value)}}function rWe(r,e){if(1&r&&(I(),P(0,"g"),O(1,nWe,3,4,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function iWe(r,e){if(1&r&&(I(),V(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);Ce("id","possible_landing_",t.x,"_",t.y,""),A("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function oWe(r,e){if(1&r&&(I(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),A("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function sWe(r,e){if(1&r&&(I(),qt(0),O(1,iWe,1,4,"polygon",12),O(2,oWe,1,4,"polygon",13),jt()),2&r){const t=p();_(1),y("ngForOf",t.possibleLandings),_(1),y("ngIf",t.chosenCoord.isPresent())}}function aWe(r,e){if(1&r&&(I(),qt(0),V(1,"polygon",15)(2,"polygon",15),jt()),2&r){const t=p(2);_(1),A("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),_(1),A("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function cWe(r,e){1&r&&(I(),O(0,aWe,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let lWe=(()=>{var r;class e extends pne{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.setRulesAndNode("Sahara"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new XUe,new $1e),new bn($localize`MCTS`,new $1e,this.rules)],this.encoder=ac.encoder}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState().getCurrentPlayer(),c=Me.ofPlayer(a);return o.chosenCoord.equalsValue(new v(n,i))?(o.cancelMoveAttempt(),w.SUCCESS):o.chosenCoord.isAbsent()||o.board[i][n]===c?o.choosePiece(n,i):o.chooseLandingCoord(n,i)})()}choosePiece(n,i){var o=this;return M(function*(){if(o.board[i][n]===Me.EMPTY)return o.cancelMove($u.MUST_CHOOSE_PYRAMID_FIRST());if(o.board[i][n].is(k.ofTurn(o.getTurn()))){const s=new v(n,i);return o.selectPiece(s),w.SUCCESS}return o.cancelMove($u.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var o=this;return M(function*(){const s=new v(n,i),a=ac.from(o.chosenCoord.get(),s);return a.isFailure()?o.cancelMove(a.getReason()):yield o.chooseMove(a.get())})()}updateBoard(n){var i=this;return M(function*(){const o=i.node.previousMove;i.lastCoord=o.map(s=>s.getStart()),i.lastMoved=o.map(s=>s.getEnd()),i.board=i.getState().board})()}getPlayerClassFor(n,i){return this.getPlayerClass(k.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-sahara"]],features:[Ge],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(I(),P(0,"svg",0),O(1,rWe,2,1,"g",1),O(2,sWe,3,2,"ng-container",2),O(3,cWe,1,1,"ng-template",null,3,mn),S()),2&n){const o=dn(4);_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",o)}},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const Pa=Me.UNREACHABLE,Gu=Me.ZERO,Bu=Me.ONE,ln=Me.EMPTY;class uWe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,R4.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new ql([[Pa,Pa,ln,ln,Bu,ln,ln,Gu,Bu,Pa,Pa],[Pa,ln,ln,ln,ln,ln,ln,ln,ln,ln,Pa],[Bu,Gu,ln,ln,ln,ln,ln,ln,ln,ln,Gu],[Gu,ln,ln,ln,ln,ln,ln,ln,ln,ln,Bu],[Pa,ln,ln,ln,ln,ln,ln,ln,ln,ln,Pa],[Pa,Pa,Bu,Gu,ln,ln,ln,Bu,Gu,Pa,Pa]],3)),j.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,R4.get().getInitialState(),ac.from(new v(2,0),new v(2,1)).get(),(t,n,i)=>t.isSimpleStep()?w.SUCCESS:w.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),j.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,R4.get().getInitialState(),ac.from(new v(7,0),new v(5,0)).get(),(t,n,i)=>t.isSimpleStep()?w.failure($localize`Failed! You have made a single step.`):w.SUCCESS,$localize`Congratulations!`)])}}var G1e,cc;class l2 extends Or{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static of(e,t,n,i){return new l2(e,t,n,i)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}}G1e=l2,u(l2,"encoder",Ne.tuple([Ne.identity(),Ne.identity(),g.getEncoder(Re.encoder),Re.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>G1e.of(r[0],r[1],r[2],r[3])));class Xe{static decode(e){switch(e){case 0:return Xe.EMPTY;case 1:return Xe.LIGHT_UP;case 2:return Xe.LIGHT_RIGHT;case 3:return Xe.LIGHT_DOWN;case 4:return Xe.LIGHT_LEFT;case 5:return Xe.DARK_UP;case 6:return Xe.DARK_RIGHT;case 7:return Xe.DARK_DOWN;case 8:return Xe.DARK_LEFT;case 9:return Xe.MOUNTAIN}}static of(e,t){return t===k.ZERO?e===Re.UP?Xe.DARK_UP:e===Re.RIGHT?Xe.DARK_RIGHT:e===Re.DOWN?Xe.DARK_DOWN:Xe.DARK_LEFT:e===Re.UP?Xe.LIGHT_UP:e===Re.RIGHT?Xe.LIGHT_RIGHT:e===Re.DOWN?Xe.LIGHT_DOWN:Xe.LIGHT_LEFT}constructor(e,t,n){u(this,"value",void 0),u(this,"owner",void 0),u(this,"direction",void 0),this.value=e,this.owner=t,this.direction=n}belongsTo(e){return this.owner.equals(e)}isEmptyOrMountain(){return this.owner===W.NONE}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return this.owner}getOptionalDirection(){return this.direction}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this){case Xe.EMPTY:return"EMPTY";case Xe.LIGHT_UP:return"LIGHT_UP";case Xe.LIGHT_RIGHT:return"LIGHT_RIGHT";case Xe.LIGHT_DOWN:return"LIGHT_DOWN";case Xe.LIGHT_LEFT:return"LIGHT_LEFT";case Xe.DARK_UP:return"DARK_UP";case Xe.DARK_RIGHT:return"DARK_RIGHT";case Xe.DARK_DOWN:return"DARK_DOWN";case Xe.DARK_LEFT:return"DARK_LEFT";default:return H.expectToBe(this,Xe.MOUNTAIN),"MOUNTAIN"}}}u(Xe,"EMPTY",new(cc=Xe)(0,W.NONE,g.empty())),u(Xe,"LIGHT_UP",new cc(1,W.ONE,g.of(Re.UP))),u(Xe,"LIGHT_RIGHT",new cc(2,W.ONE,g.of(Re.RIGHT))),u(Xe,"LIGHT_DOWN",new cc(3,W.ONE,g.of(Re.DOWN))),u(Xe,"LIGHT_LEFT",new cc(4,W.ONE,g.of(Re.LEFT))),u(Xe,"DARK_UP",new cc(5,W.ZERO,g.of(Re.UP))),u(Xe,"DARK_RIGHT",new cc(6,W.ZERO,g.of(Re.RIGHT))),u(Xe,"DARK_DOWN",new cc(7,W.ZERO,g.of(Re.DOWN))),u(Xe,"DARK_LEFT",new cc(8,W.ZERO,g.of(Re.LEFT))),u(Xe,"MOUNTAIN",new cc(9,W.NONE,g.empty()));class jl extends k1{countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const e=[0,0];for(const t of this.getCoordsAndContents())t.content!==Xe.EMPTY&&e[t.content.getOwner().value]++;return e}}let Uu=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var fh,q0;class B1e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let is=(fh=class extends ja{static get(){return q0.singleton.isAbsent()&&(q0.singleton=g.of(new q0)),q0.singleton.get()}getRulesConfigDescription(){return g.of(q0.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=e.get(),n=wt.create(t.width,t.height,Xe.EMPTY),i=Math.floor(t.height/2),o=Math.floor(t.width/2);n[i][o]=Xe.MOUNTAIN,t.numberOfBonusMountain=Math.min(t.numberOfBonusMountain,t.width-1);let s=0;for(;s<t.numberOfBonusMountain;){const a=Math.ceil((s+1)/2);n[i][o+a]=Xe.MOUNTAIN,s++,s<t.numberOfBonusMountain&&(n[i][o-a]=Xe.MOUNTAIN,s++)}return new jl(n,0)}getMoveValidity(e,t){const n=!1===t.isOnBoard(e.coord);if(e.isRotation()){if(n)return Q.failure($localize`Cannot rotate piece outside the board: ${e.toString()}`)}else if(!1===t.isOnBoard(e.coord.getNext(e.direction.get()))){if(n)return Q.failure($localize`SiamMove should end or start on the board: ${e.toString()}`);if(e.direction.get()!==e.landingOrientation)return Q.failure($localize`SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: ${e.toString()}`)}return w.SUCCESS}isInsertion(e,t){return-1===e.coord.x||e.coord.x===t.getWidth()||-1===e.coord.y||e.coord.y===t.getHeight()}isLegal(e,t,n){const i=this.getMoveValidity(e,t);if(i.isFailure())return i.toOtherFallible();if(!1===this.isInsertion(e,t)){const o=t.getPieceAt(e.coord);if(o===Xe.EMPTY)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o.belongsTo(t.getCurrentOpponent()))return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}if(e.isRotation())return this.isLegalRotation(e,t);{let o;if(this.isInsertion(e,t)){const s=this.isLegalInsertion(e.coord,t,n.get());if(s.legal.isFailure())return Q.failure(s.legal.getReason());o=s.insertedPiece}else o=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,o)}}isLegalInsertion(e,t,n){const i=t.countCurrentPlayerPawn(),o=t.getCurrentPlayer(),s=i<n.numberOfPiece?w.SUCCESS:w.failure(Uu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,o,t.getWidth()),legal:s}}getInsertedPiece(e,t,n){return Xe.of(-1===e.x?Re.RIGHT:-1===e.y?Re.DOWN:e.x===n?Re.LEFT:Re.UP,t)}isLegalForwarding(e,t,n){H.assert(n!==Xe.MOUNTAIN&&n!==Xe.EMPTY,"forwarding must be done with player piece");const i=[];let o=Xe.of(e.landingOrientation,t.getCurrentPlayer());const s=e.direction.get();let a=e.coord.getNext(s);if(t.isOnBoard(a)&&t.getPieceAt(a)!==Xe.EMPTY&&!1===this.isStraight(n,e))return Q.failure(Uu.ILLEGAL_PUSH());let c=g.of(s);const l=s.getOpposite();let f=0;const d=t.getCopiedBoard();t.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=Xe.EMPTY,i.push(e.coord));let m=t.isOnBoard(a)&&o!==Xe.EMPTY;for(;m;){c.equalsValue(s)?f++:c.equalsValue(l)&&f--;const E=d[a.y][a.x];E===Xe.MOUNTAIN&&(f-=.9),d[a.y][a.x]=o,i.push(a),o=E,a=a.getNext(s),c=o.getOptionalDirection(),m=t.isOnBoard(a)&&o!==Xe.EMPTY&&f>0}return!1===t.isOnBoard(a)&&(c.equalsValue(s)?f++:c.equalsValue(l)&&f--),f<=0?Q.failure(Uu.NOT_ENOUGH_FORCE_TO_PUSH()):Q.success(new B1e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),o=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return Q.failure(Uu.MUST_MOVE_OR_ROTATE());const s=t.getCopiedBoard();return s[n.y][n.x]=Xe.of(e.landingOrientation,o),Q.success(new B1e(s,[n]))}applyLegalMove(e,t,n,i){const o=wt.copy(i.resultingBoard);return new jl(o,t.turn+1)}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,o=6-t;return i===o?n.getScoreModifier():i>o?-10*(i+1)+(o+1):10*(o+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const o of e.getCoordsAndContents())o.content===Xe.MOUNTAIN&&(!1===t.includes(o.coord.y)&&t.push(o.coord.y),!1===n.includes(o.coord.x)&&n.push(o.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n,i){return n===i.numberOfBonusMountain?this.getPusher(e,t.get()):W.NONE}getPusher(e,t){const n=t.coord;let i;i=e.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent(),e.getWidth());const o=i.getDirection(),s=this.getPusherCoord(e,o,n),a=e.getPieceAt(s).getOwner();return we.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+s.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),o=n;for(;e.isOnBoard(i);){n=i,i=i.getNext(t);const s=e.getPieceAt(n);s!==Xe.MOUNTAIN&&s.getDirection()===t&&(o=n)}return o}getPushers(e,t,n,i){let o=[];const s=[];for(const a of t){let c=Re.DOWN,l=new v(a,i.height-1);s.push({direction:c,fallingCoord:l}),c=Re.UP,l=new v(a,0),s.push({direction:c,fallingCoord:l})}for(const a of n){let c=Re.LEFT,l=new v(0,a);s.push({direction:c,fallingCoord:l}),c=Re.RIGHT,l=new v(i.width-1,a),s.push({direction:c,fallingCoord:l})}for(const a of s)o=this.addPotentialDirectionPusher(e,a.fallingCoord,a.direction,o,i);return o}addPotentialDirectionPusher(e,t,n,i,o){const s=this.getLineClosestPusher(e,t,n,o);if(s.isAbsent())return i;const a=s.get();return i.push({coord:a.coord,distance:a.distance}),i}getInitialLineInfo(e,t,n){return{resistance:n.getOpposite(),previousPiece:e.getPieceAt(t),closestPusher:{coord:t,distance:1},almostPusher:g.empty(),pusherFound:!1,mountainEncountered:!1,missingForce:0}}getLineClosestPusher(e,t,n,i){let o=this.getInitialLineInfo(e,t,n);for(;e.isOnBoard(o.closestPusher.coord)&&!1===o.pusherFound;)o=this.updateLineInfo(e,o,n);if(!1===o.pusherFound&&o.almostPusher.isPresent())for(o.closestPusher.distance++,o.missingForce-=1;!1===o.closestPusher.coord.equals(o.almostPusher.get());)o.closestPusher.coord=o.closestPusher.coord.getNext(n),o.closestPusher.distance--;return!1===e.isOnBoard(o.closestPusher.coord)&&(o.missingForce-=1,e.countCurrentPlayerPawn()===i.numberOfPiece)||o.missingForce>0?g.empty():g.of(o.closestPusher)}updateLineInfo(e,t,n){const i=e.getPieceAt(t.closestPusher.coord);if(i.isEmptyOrMountain())i===Xe.MOUNTAIN?(t.missingForce+=.9,t.mountainEncountered=!0):t.closestPusher.distance++;else{const o=i.getDirection();o===n?t.mountainEncountered&&(t.missingForce-=1,t.missingForce<=0&&(t.pusherFound=!0,t.closestPusher.coord=t.closestPusher.coord.getNext(n))):o===t.resistance?(t.missingForce+=1,!1===t.mountainEncountered&&t.closestPusher.distance++):t.mountainEncountered?(t.almostPusher=g.of(t.closestPusher.coord),t.previousPiece!==Xe.EMPTY&&t.closestPusher.distance++):t.closestPusher.distance++}return t.previousPiece=i,t.closestPusher.coord=t.closestPusher.coord.getPrevious(n),t}getInsertions(e,t){let n=[];const i=t.width-1,o=t.height-1;for(let s=1;s<i;s++)n=n.concat(this.getInsertionsAt(e,s,0,t)),n=n.concat(this.getInsertionsAt(e,s,o,t));for(let s=1;s<o;s++)n=n.concat(this.getInsertionsAt(e,0,s,t)),n=n.concat(this.getInsertionsAt(e,i,s,t));return n=n.concat(this.getInsertionsAt(e,0,0,t)),n=n.concat(this.getInsertionsAt(e,0,o,t)),n=n.concat(this.getInsertionsAt(e,i,0,t)),n=n.concat(this.getInsertionsAt(e,i,o,t)),n}getInsertionsAt(e,t,n,i){const o=[];for(const s of Re.ORTHOGONALS){const a=new v(t,n).getPrevious(s);if(!1===e.isOnBoard(a))for(const c of Re.ORTHOGONALS){const l=l2.of(a.x,a.y,g.of(s),c);H.assert(this.getMoveValidity(l,e).isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(l,e,g.of(i)).isSuccess()&&o.push(l)}}return o}getMovesFrom(e,t,n,i){const o=new v(n,i);let s=this.getRotationMovesAt(o,t);for(const a of Re.ORTHOGONALS){const c=o.getNext(a);s=s.concat(this.getForwardMovesBetween(e,o,c))}return s}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):Re.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const o of Re.ORTHOGONALS)if(o!==i){const s=l2.of(e.x,e.y,g.empty(),o);n.push(s)}return n}getForwardMovesBetween(e,t,n){const i=[];let o;const s=Re.factory.fromMove(t,n).get(),a=e.getPieceAt(t);o=e.isOnBoard(n)?Re.ORTHOGONALS:[s];for(const c of o){const l=l2.of(t.x,t.y,g.of(s),c);this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e,t){const n=this.getMountainsRowsAndColumns(e.gameState),i=this.getWinner(e.gameState,e.previousMove,n.nbMountain,t.get());return i.isPlayer()?_e.getVictory(i):_e.ONGOING}},q0=fh,u(fh,"singleton",g.empty()),u(fh,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Siam`,config:{width:new br(5,Ss.WIDTH,Tr.range(3,99)),height:new br(5,Ss.HEIGHT,Tr.range(3,99)),numberOfPiece:new br(5,()=>$localize`Number of piece by player`,Tr.range(1,99)),numberOfBonusMountain:new br(2,()=>$localize`Number of bonus mountains`,Tr.range(0,98))}})),fh);is=q0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],is);class U1e extends jn{getListMoves(e,t){let n=[];const i=e.gameState.getCurrentPlayer();for(const o of e.gameState.getCoordsAndContents()){const s=o.content;s.belongsTo(i)&&(n=n.concat(is.get().getMovesFrom(e.gameState,s,o.coord.x,o.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<t.get().numberOfPiece)for(const o of is.get().getInsertions(e.gameState,t.get()))if(o.direction.get().getOpposite()!==o.landingOrientation){if(e.gameState.isEdge(o.coord)&&o.direction.get()!==o.landingOrientation)continue;n.push(o)}return n}}class dWe extends Ya{getBoardValue(e,t){const n=this.getBoardValueInfo(e.gameState,t.get());return un.of(n.boardValue)}getBoardValueInfo(e,t){const n=is.get().getMountainsRowsAndColumns(e),i=n.rows,o=n.columns,s=is.get().getPushers(e,o,i,t);let a=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER;const l=e.getCurrentPlayer();for(const d of s)e.isOnBoard(d.coord)?e.getPieceAt(d.coord).belongsTo(k.ZERO)?a=Math.min(a,d.distance):c=Math.min(c,d.distance):l===k.ZERO?a=Math.min(a,d.distance):c=Math.min(c,d.distance);return{shortestZero:a,shortestOne:c,boardValue:is.get().getScoreFromShortestDistances(a,c,l)}}}class hWe extends cn{constructor(){super($localize`Minimax`,is.get(),new dWe,new U1e)}}var Wu;function pWe(r,e){if(1&r){const t=ge();I(),P(0,"use",11),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().clickSquare(i,o))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),y("ngClass",s.getPieceClasses(n,o,i)),A("transform",s.getPiceRotation(n,o))}}function mWe(r,e){if(1&r){const t=ge();I(),P(0,"use",12),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p().clickSquare(i,o))}),S()}}function _We(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",8),q("click",function(){const o=ee(t).index,s=p().index;return te(p().clickSquare(o,s))}),S(),O(2,pWe,1,4,"use",9),O(3,mWe,1,0,"use",10),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();A("transform","translate("+n*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")"),_(1),Ce("id","square_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),A("x",o.SPACE_SIZE*n*0)("y",o.SPACE_SIZE*i*0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isPiece()),_(1),y("ngIf",o.isMountain(t))}}function vWe(r,e){if(1&r&&(I(),P(0,"g"),O(1,_We,4,10,"g",4),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function CWe(r,e){if(1&r){const t=ge();I(),P(0,"rect",15),q("click",function(){ee(t);const i=p().$implicit;return te(p().clickSquare(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();Ce("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function yWe(r,e){if(1&r){const t=ge();I(),P(0,"g"),O(1,CWe,1,7,"rect",13),P(2,"rect",14),q("click",function(){const o=ee(t).$implicit;return te(p().clickSquare(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngIf",!1===n.getState().isOnBoard(t)),_(1),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function MWe(r,e){if(1&r){const t=ge();I(),P(0,"rect",16),q("click",function(){ee(t);const i=p();return te(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),S()}if(2&r){const t=p();A("x",t.SPACE_SIZE*t.selectedLanding.get().x)("y",t.SPACE_SIZE*t.selectedLanding.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function EWe(r,e){if(1&r){const t=ge();I(),P(0,"rect",16),q("click",function(){ee(t);const i=p();return te(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),S()}if(2&r){const t=p();A("x",t.SPACE_SIZE*t.selectedPiece.get().x)("y",t.SPACE_SIZE*t.selectedPiece.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function PWe(r,e){if(1&r&&(I(),V(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),A("transform",i.getRemainingPieceTransform(t,n))}}function SWe(r,e){if(1&r){const t=ge();I(),P(0,"g",17),q("click",function(){const o=ee(t).$implicit;return te(p().selectPieceForInsertion(o))}),O(1,PWe,1,4,"use",18),S()}if(2&r){const t=e.$implicit,n=p();hn("id","remainingPieces_",t.value,""),_(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function OWe(r,e){if(1&r){const t=ge();I(),P(0,"use",22),q("click",function(){ee(t);const i=p().$implicit;return te(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),S()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),A("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function TWe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"use",20),q("click",function(){const o=ee(t).$implicit;return te(p().clickArrow(o))}),S(),O(2,OWe,1,2,"use",21),S()}if(2&r){const t=e.$implicit,n=p();_(1),Hr("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),A("transform",n.getIndicatorTransform(t)),_(1),y("ngIf",t.source.isPresent())}}let ey=(Wu=class extends Mo{constructor(e){super(e),u(this,"SiamState",jl),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new it),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.setRulesAndNode("Siam"),this.availableAIs=[new hWe,new bn($localize`MCTS`,new U1e,this.rules)],this.encoder=l2.encoder}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.board,t.movedPieces=[]})()}showLastMove(e){var t=this;return M(function*(){t.lastMove=g.of(e);const n=t.getPreviousState(),i=t.getConfig();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n,i).get().moved})()}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new it,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e===t.getCurrentOpponent())return t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.insertingPiece)return t.cancelMoveAttempt(),w.SUCCESS;t.cancelMoveAttempt();const i=t.getConfig().get();for(const o of is.get().getInsertions(t.getState(),i)){const s=o.coord.getNext(o.direction.get());if(t.board[s.y][s.x]!==Xe.EMPTY){const a={source:g.empty(),target:s,direction:o.direction.get(),move:o};t.indicatorArrows.push(a)}t.clickableCoords.add(s)}return t.insertingPiece=!0,w.SUCCESS})()}selectOrientation(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!0){var i=this;return M(function*(){if(n){const s=yield i.canUserPlay("#square_"+e+"_"+t);if(s.isFailure())return i.cancelMove(s.getReason())}const o=new v(e,t);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),w.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(o);const s=is.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===s.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(s)}{H.assert(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const s=i.board[t][e];return s.getOwner()===W.NONE?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.selectPiece(o,s)}})()}insertPiece(e){var t=this;return M(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(Uu.MUST_SELECT_ORIENTATION()),w.SUCCESS;t.selectedLanding=g.of(e);const n=t.getConfig().get(),i=is.get().getInsertionsAt(t.getState(),e.x,e.y,n);return 0===i.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(i)})()}changeMoveDestinationClick(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!1):t.cancelMove(Uu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return M(function*(){return H.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new it,t.indicatorArrows=[],t.orientations=e,w.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=is.get().getMovesFrom(n,t,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const s=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(s),n.isOnBoard(s)&&n.getPieceAt(s)!==Xe.EMPTY){const a={source:g.of({coord:e,piece:t}),target:s,direction:o.direction.get(),move:o};this.indicatorArrows.push(a)}}else this.clickableCoords.add(o.coord);return w.SUCCESS}clickArrow(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===Xe.MOUNTAIN}getArrowTransform(e,t,n){const i=n.toInt()-2,o=this.getRotation(i);return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",o].join(" ")}getRotation(e){return`rotate(${90*e} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`}getPiceRotation(e,t){const i=this.board[t][e].getDirection().toInt()-2;return this.getRotation(i)}getPieceTransform(e,t){return this.getArrowTransform(e,t,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x,t.y,e.direction)}getRemainingPieceTransform(e,t){const n=this.getConfig().get(),i=n.width/2,s=this.getState().countPlayersPawn()[t.value],c=1+.5*(n.numberOfPiece-s-1);let l,f,d;return t===this.getPointOfView()?(l=i-c/2+.5*e,f=n.height,d=Re.LEFT):(l=i+c/2-1-.5*e,f=-1,d=Re.RIGHT),this.getArrowTransform(l,f,d)}getPieceClasses(e,t,n){const i=new v(e,t),o=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,t){const n=new v(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}playerPieces(e){return this.getConfig().get().numberOfPiece-this.getState().countPlayersPawn()[e.value]}},u(Wu,"\u0275fac",function(e){return new(e||Wu)(U(Ut))}),u(Wu,"\u0275cmp",Fe({type:Wu,selectors:[["app-siam"]],features:[Ge],decls:12,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],["id","siamBoard"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["app-siam-orientation-arrow","",3,"orientations","currentPlayer","config","moveEmitter"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"]],template:function(e,t){1&e&&(I(),P(0,"svg",0)(1,"defs"),V(2,"polygon",1)(3,"polygon",2),S(),P(4,"g",3),O(5,vWe,2,1,"g",4),S(),O(6,yWe,3,5,"g",4),O(7,MWe,1,4,"rect",5),O(8,EWe,1,4,"rect",5),O(9,SWe,2,2,"g",6),O(10,TWe,3,5,"g",4),P(11,"g",7),q("moveEmitter",function(i){return t.selectOrientation(i)}),S()()),2&e&&(A("viewBox",t.getViewBox().toSVGString()),_(5),y("ngForOf",t.board),_(1),y("ngForOf",t.clickableCoords),_(1),y("ngIf",t.selectedLanding.isPresent()),_(1),y("ngIf",t.selectedPiece.isPresent()),_(1),y("ngForOf",t.Player.PLAYERS),_(1),y("ngForOf",t.indicatorArrows),_(1),y("orientations",t.orientations)("currentPlayer",t.getCurrentPlayer())("config",t.getConfig().get()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Wu);ey=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ey);const xe=Xe.EMPTY,$2=Xe.MOUNTAIN,bWe=Xe.LIGHT_UP,RL=Xe.LIGHT_LEFT,W1e=Xe.LIGHT_RIGHT,wWe=Xe.LIGHT_DOWN,zL=Xe.DARK_UP,q1e=Xe.DARK_LEFT,qu=Xe.DARK_RIGHT,NWe=Xe.DARK_DOWN,j1e=is.get().getDefaultRulesConfig();class AWe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board. The initial board contains three mountains, and no pieces are initially on the board. During its turn, a player can do one of the following actions: <ol><li>Put a new piece on the board.</li><li>Change the orientation of one of its piece</li><li>Move one of its piece and optionally reorient it.</li><li>Take one of its pieces out of the board.</li></ol>`,is.get().getInitialState(j1e)),j.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total. As long as you have remaining pieces next to the board, you can insert new pieces. To do so:<ol><li>Click on one of your pieces from your reserve, next to board.</li><li>Click on one of the highlighted squares to select a landing for your piece.</li><li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark, insert a piece on the board.`,is.get().getInitialState(j1e),l2.of(2,-1,g.of(Re.DOWN),Re.DOWN),$localize`Congratulations!`),j.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing". A move is made from a piece's square to an empty neighboring square, horizontally or vertically. You can also move a piece out of the board. To move a piece:<ol><li>Click on it.</li><li>Click on the square on which you want the piece to move. You can also click a second time on your piece to change its orientation without moving it.</li><li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new jl([[xe,xe,xe,xe,xe],[xe,xe,xe,xe,xe],[xe,$2,$2,$2,xe],[xe,xe,xe,xe,xe],[xe,xe,zL,xe,xe]],0),[l2.of(2,4,g.of(Re.UP),Re.LEFT)],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/> You're playing Dark, get that piece out of the board!`,new jl([[xe,xe,xe,xe,xe],[xe,xe,xe,xe,xe],[xe,$2,$2,$2,xe],[xe,xe,xe,xe,xe],[xe,xe,zL,xe,xe]],0),[l2.of(2,4,g.of(Re.DOWN),Re.DOWN)],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),j.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push". In order to push player pieces, the following conditions must hold:<ol><li>Your piece must already be oriented in the direction of the push.</li><li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li></ol>Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction. On the second row, you can push because there are two pieces against one.<br/><br/>You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new jl([[xe,qu,RL,xe,xe],[qu,W1e,RL,xe,xe],[xe,xe,zL,xe,xe],[xe,xe,xe,xe,xe],[xe,xe,xe,xe,xe]],0),[l2.of(2,2,g.of(Re.UP),Re.UP)],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher. In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains. On the following board, as Dark, you can push the mountain on the first row. On the second and third row, because of the resisting forces, you cannot push. On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>You're playing Dark, push on the fourth row it.`,new jl([[xe,xe,qu,$2,xe],[xe,xe,qu,$2,q1e],[xe,qu,$2,$2,xe],[xe,qu,W1e,RL,$2],[xe,xe,xe,xe,xe]],0),[l2.of(1,3,g.of(Re.RIGHT),Re.RIGHT)],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board. If you pushed it and nobody is in front of you, you're the winner. However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain. However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new jl([[xe,xe,xe,xe,xe],[xe,xe,xe,xe,xe],[$2,bWe,q1e,xe,NWe],[xe,xe,xe,xe,wWe],[xe,xe,xe,xe,$2]],0),[l2.of(2,2,g.of(Re.LEFT),Re.LEFT)],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}var Z1e;class hr extends yo{static of(e,t,n){return new hr(e,t,n)}static ofDrop(e){return new hr(g.empty(),e,g.empty())}static ofMovement(e,t){return new hr(g.of(e),t,g.empty())}static ofCut(e,t,n){return new hr(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,H.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),H.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}Z1e=hr,u(hr,"encoder",Ne.tuple([g.getEncoder(v.encoder),v.encoder,g.getEncoder(v.encoder)],r=>[r.start,r.landing,r.keep],r=>Z1e.of(r[0],r[1],r[2])));let lc=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class u2 extends Xne{static ofRepresentation(e,t,n=new Vt(0,0)){const i=new _u;for(let o=0;o<e.length;o++)for(let s=0;s<e[0].length;s++)if(e[o][s]!==W.NONE){const a=new v(s,o).getNext(n);i.set(a,e[o][s])}return new u2(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new u2(t,this.turn)}toRepresentation(){const e=wt.create(this.width,this.height,W.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?w.SUCCESS:w.failure(lc.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of Pi.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():W.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new u2(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new _u;for(const o of t)i.set(o,n.getPieceAt(o));return new u2(i,this.turn+1)}return new u2(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(k.ZERO).getOrElse(new U1),n=e.get(k.ONE).getOrElse(new U1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new u2(t,this.turn);vi.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var ty,Zl;let C3=(ty=class extends Sr{constructor(...e){super(...e),u(this,"currentVictorySource",void 0)}static get(){return Zl.singleton.isAbsent()&&(Zl.singleton=g.of(new Zl)),Zl.singleton.get()}getInitialState(){return u2.ofRepresentation([[k.ZERO],[k.ONE]],0)}applyLegalMove(e,t,n,i){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,i)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Zl.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new U1;for(const n of e.getPieceCoords())for(const i of Ae.factory.all){const o=n.getNext(i,1);e.getPieceAt(o)===W.NONE&&t.add(o)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?Q.failure(lc.NO_MOVEMENT_BEFORE_TURN_40()):Q.success(new it(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return Q.failure(lc.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===W.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const i=t.movePiece(e),o=i.getGroups();if(Zl.isSplit(o)){const s=this.getLargestGroups(o);return 1===s.size()?e.keep.isPresent()?Q.failure(lc.CANNOT_CHOOSE_TO_KEEP()):Q.success(s.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,s,i)}return Q.success(new U1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new it;for(const i of e){const o=i.size();o>t?(t=o,n=new it([i])):o===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return Q.failure(lc.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return Q.failure(lc.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const o of t)if(o.contains(i))return Q.success(o);return Q.failure(lc.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.previousMove.isPresent()&&(i=this.getShapeVictory(e.previousMove.get(),t)),6===i.length)return _e.getVictory(n);if(t.turn>39){const o=t.countPieces(),s=o[0],a=o[1];return s<6&&a<6?s<a?_e.ONE_WON:a<s?_e.ZERO_WON:_e.DRAW:s<6?_e.getDefeat(k.ZERO):a<6?_e.getDefeat(k.ONE):_e.ONGOING}return _e.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(Ae.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+s.length)%6;s.push(a),a=a.getNext(Ae.factory.all[l],1)}return s}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return[];c=!0,o=o.getOpposite(),s=s.getNext(o,a.length)}s=s.getNext(o,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.length%2==0&&(o=Ae.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return s}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.push(a),s.length%2==0&&(o=Ae.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return s}},Zl=ty,u(ty,"singleton",g.empty()),ty);C3=Zl=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],C3);class kWe extends Ya{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:c1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let o;if(o=n.status===c1.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),o.status===c1.VICTORY)return o;n.status=o.status,n.sum=n.sum+o.sum,n.preVictory.isAbsent()&&(n.preVictory=o.preVictory)}return n}}class Y1e extends kWe{constructor(...e){super(...e),u(this,"VERBOSE",!1),u(this,"currentVictorySource",void 0)}getBoardValue(e,t){const n=e.previousMove,i=e.gameState,o=i.getCurrentOpponent(),s=o.getVictoryValue();let a={status:c1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(n.isPresent()&&(a=this.calculateBoardValue(n.get(),i)),a.status===c1.VICTORY)return un.of(s);if(i.turn>39){const c=i.countPieces();return un.ofSingle(c[0],c[1])}return un.of(a.status===c1.PRE_VICTORY?o.getPreVictory():a.sum*o.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(Ae.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+s.length)%6;s.push(a),a=a.getNext(Ae.factory.all[l],1)}return{status:c1.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,o=o.getOpposite(),s=s.getNext(o,a.length-1)}s=s.getNext(o,1)}return{status:c1.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s.length%2==0&&(o=Ae.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return{status:c1.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=Ae.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s.push(a),s.length%2==0&&(o=Ae.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return{status:c1.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const o=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,o,n,i);case"LINE":return this.getBoardInfoForLine(e.index,o,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,o,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,o,n,i)}}getBoardInfoForCircle(e,t,n,i){const o=n.getCurrentPlayer(),a=[t];let c=t.getNext(Ae.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;const m=(e+a.length)%6;a.push(c);const E=Ae.factory.all[m];d===W.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(E,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let o=i.preVictory;if(4.16===e){if(o.isPresent()&&!1===o.equals(t))return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o=t}else if(5===e)return{status:c1.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:o,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const o=Ae.factory.all[e];let s=t.getPrevious(o,5),a=[],c=[],l=g.empty();for(let L=0;L<6;L++){const z=this.updateEncounterAndReturnLastEmpty(n,s,c);z.isPresent()&&(l=z),a.push(s),s=s.getNext(o,1)}let f=i.status,d=i.preVictory,m=0,E=0;for(;m<6;){const L=c.reduce((G,B)=>G+B);5.16===L&&f===c1.DEFAULT&&(d.isPresent()?(H.assert(!1===d.equals(l),"Impossible to have point aligned with different line to a same point"),f=c1.PRE_VICTORY):d=l),E=Math.max(E,L),a=a.slice(1,6),a.push(s),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,s,c);z.isPresent()&&(l=z),m++,s=s.getNext(o,1)}const T={status:f,victory:g.of(a),preVictory:d,sum:E};return this.getBoardInfoResult(E,l,a,T)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case W.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const o=n.getCurrentPlayer();let s=Ae.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;d===W.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(s=Ae.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(s,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const o=n.getCurrentPlayer();let s=Ae.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;d===W.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(s=Ae.factory.all[(e+a.length)%6]),c=c.getNext(s,1)}return this.getBoardInfoResult(l,f,a,i)}}let ny=class extends jn{getListMoves(e,t){const n=C3.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrops(n):this.getMovements(e.gameState,n)}getMovements(e,t){const n=e.getPieces().reverse(),i=e.getCurrentPlayer(),o=n.get(i).get();return this.getMovementsFrom(e,o,t)}getMovementsFrom(e,t,n){const i=[];for(const o of t)for(const s of n){const a=hr.ofMovement(o,s);if(e.isCoordConnected(s,g.of(o))){const l=e.movePiece(a).getGroups();if(C3.isSplit(l)){const f=C3.getLargestGroups(l);if(1===f.size())i.push(hr.ofMovement(o,s));else for(const d of f){const m=d.getAnyElement().get(),E=hr.ofCut(o,s,m);i.push(E)}}else i.push(a)}}return i}getListDrops(e){const t=[];for(const n of e){const i=hr.ofDrop(n);t.push(i)}return t}};ny=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ny);class LWe extends ny{constructor(...e){super(...e),u(this,"heuristic",new Y1e)}getMovements(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementsFrom(e,n,t)}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),o=i.getAnyElement().get(),s=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&s.push(a);return new U1(0===s.length?[o]:s)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=hr.ofDrop(t);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===c1.VICTORY)return!0;return!1}}function RWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",10),q("click",function(){const o=ee(t).$implicit;return te(p().onPieceClick(o))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),A("points",n.getHexaPointsAt(t))}}function zWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",11),q("click",function(){const o=ee(t).$implicit;return te(p().onNeighborClick(o))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","neighbor_",t.x,"_",t.y,""),A("points",n.getHexaPointsAt(t))}}function DWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",10),q("click",function(){ee(t);const i=p();return te(i.onPieceClick(i.chosenLanding.get()))}),S()}if(2&r){const t=p();Ce("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),A("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function HWe(r,e){if(1&r&&(I(),V(0,"polygon",12)),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.x,"_",t.y,""),A("points",n.getHexaPointsAt(t))}}function VWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",13),q("click",function(){ee(t);const i=p();return te(i.onNeighborClick(i.leftCoord.get()))}),S()}if(2&r){const t=p();Ce("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),A("points",t.getHexaPointsAt(t.leftCoord.get()))}}function FWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",14),q("click",function(){ee(t);const i=p();return te(i.onPieceClick(i.lastDrop.get()))}),S()}if(2&r){const t=p();Ce("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),A("points",t.getHexaPointsAt(t.lastDrop.get()))}}function $We(r,e){if(1&r){const t=ge();I(),P(0,"polygon",15),q("click",function(){ee(t);const i=p();return te(i.onPieceClick(i.selectedPiece.get()))}),S()}if(2&r){const t=p();Ce("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),A("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function GWe(r,e){if(1&r&&(I(),V(0,"polygon",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),A("points",n.getHexaPointsAt(t))}}function BWe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",19),q("click",function(){const o=ee(t).$implicit;return te(p(2).onPieceClick(o))}),S()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","cuttable_",t.x,"_",t.y,""),A("points",n.getHexaPointsAt(t))}}function UWe(r,e){if(1&r&&(I(),P(0,"g",17),O(1,BWe,1,3,"polygon",18),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let WWe=(()=>{var r;class e extends Cu{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"nextClickShouldSelectGroup",!1),this.setRulesAndNode("Six"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new Y1e,new LWe),new bn($localize`MCTS`,new ny,this.rules)],this.encoder=hr.encoder,this.SPACE_SIZE=30,this.hexaLayout=new yu(1.5*this.SPACE_SIZE,new v(2*this.SPACE_SIZE,0),Wr.INSTANCE)}cancelMoveAttempt(){var n=this;return M(function*(){n.selectedPiece=g.empty(),n.chosenLanding=g.empty(),n.cuttableGroups=[],n.nextClickShouldSelectGroup=!1,yield n.updateBoard(!1)})()}updateBoard(n){var i=this;return M(function*(){i.state=i.node.gameState,i.node.previousMove.isAbsent()&&i.hideLastMove(),i.pieces=i.state.getPieceCoords(),i.neighbors=i.getEmptyNeighbors()})()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return sa.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH)}showLastMove(n){var i=this;return M(function*(){i.lastDrop=g.of(n.landing),i.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const o=i.getState();i.rules.getGameStatus(i.node).isEndGame&&(i.victoryCoords=i.rules.getShapeVictory(n,o)),i.disconnecteds=i.getDisconnected()})()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),o=[];for(const a of n)!1===this.node.previousMove.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&o.push(a);const s=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(s))&&!1===i.some(a=>a.equals(s))&&o.push(s),o}getEmptyNeighbors(){let n=C3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(o=>!1===o.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#piece_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());if(i.state.turn<40)return i.cancelMove(lc.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),w.SUCCESS);{const s=hr.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(s)}})()}onNeighborClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(lc.MUST_CUT());if(i.state.turn<40)return i.chooseMove(hr.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(lc.CAN_NO_LONGER_DROP());{const s=hr.ofMovement(i.selectedPiece.get(),n),a=C3.isLegalPhaseTwoMove(s,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,w.SUCCESS):i.chooseMove(s)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===lc.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=hr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),o=this.state.movePiece(n).getGroups(),s=C3.getLargestGroups(o);this.cuttableGroups=[];for(const a of s)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-six"]],features:[Ge],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,RWe,1,4,"polygon",1),O(2,zWe,1,3,"polygon",2),O(3,DWe,1,4,"polygon",3),O(4,HWe,1,3,"polygon",4),O(5,VWe,1,3,"polygon",5),O(6,FWe,1,3,"polygon",6),O(7,$We,1,4,"polygon",7),O(8,GWe,1,3,"polygon",8),O(9,UWe,2,1,"g",9),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.pieces),_(1),y("ngForOf",i.neighbors),_(1),y("ngIf",i.chosenLanding.isPresent()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.leftCoord.isPresent()),_(1),y("ngIf",i.lastDrop.isPresent()),_(1),y("ngIf",i.selectedPiece.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngForOf",i.cuttableGroups))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const ue=W.NONE,St=k.ZERO,kt=k.ONE;let DL=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class qWe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,C3.get().getInitialState()),j.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,u2.ofRepresentation([[St,kt,kt,kt,kt,St],[ue,St,kt,ue,St,ue],[kt,kt,St,ue,ue,ue],[ue,ue,St,ue,ue,ue],[ue,St,ue,ue,ue,ue],[St,ue,ue,ue,ue,ue]],0),[hr.ofDrop(new v(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,u2.ofRepresentation([[ue,ue,ue,kt,ue,ue],[ue,ue,kt,kt,St,St],[ue,kt,ue,St,kt,ue],[kt,St,St,St,St,kt]],0),[hr.ofDrop(new v(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,u2.ofRepresentation([[ue,ue,ue,kt,ue,ue],[ue,St,kt,St,St,St],[ue,St,ue,St,St,ue],[kt,kt,kt,ue,kt,ue]],0),[hr.ofDrop(new v(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,u2.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,kt,ue],[ue,ue,ue,ue,ue,ue,St,ue,ue],[ue,ue,ue,ue,St,St,St,ue,ue],[ue,ue,ue,ue,kt,kt,ue,kt,St],[ue,St,kt,kt,St,St,kt,ue,ue],[St,St,St,St,kt,kt,kt,St,ue],[kt,kt,St,ue,kt,kt,St,ue,ue],[ue,St,ue,St,St,ue,ue,ue,ue],[kt,kt,kt,kt,ue,ue,ue,ue,ue],[ue,St,ue,kt,ue,ue,ue,ue,ue]],40),hr.ofMovement(new v(6,1),new v(5,1)),(t,n,i)=>{const o=i.countPieces();return 19===o[0]?18===o[1]?w.SUCCESS:w.failure(DL.MOVEMENT_NOT_DISCONNECTING()):w.failure(DL.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),j.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,u2.ofRepresentation([[ue,ue,ue,ue,ue,kt],[ue,ue,ue,ue,St,kt],[ue,ue,ue,kt,St,St],[ue,ue,St,ue,kt,St],[kt,kt,ue,ue,ue,St],[St,kt,ue,ue,ue,ue],[St,ue,ue,ue,ue,ue]],40),hr.ofMovement(new v(2,3),new v(3,3)),(t,n,i)=>t.start.equalsValue(new v(2,3))?w.SUCCESS:w.failure(DL.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),j.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,u2.ofRepresentation([[ue,ue,ue,ue,ue,kt],[ue,ue,ue,ue,St,kt],[ue,ue,ue,kt,St,St],[St,ue,St,ue,ue,kt],[kt,kt,ue,ue,ue,ue],[St,St,ue,ue,ue,ue],[St,ue,ue,ue,ue,ue]],40),hr.ofCut(new v(2,3),new v(2,5),new v(2,5)),(t,n,i)=>t.keep.isAbsent()?w.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===W.NONE?w.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):w.SUCCESS,$localize`Congratulations, you won!`)])}}class G2 extends Eu{static from(e,t){const n=Eu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new G2(e,t))}getMaximalDistance(){return 9}}function jWe(r,e){1&r&&(I(),V(0,"polygon",8))}function ZWe(r,e){1&r&&(I(),V(0,"rect",9))}function YWe(r,e){if(1&r&&(I(),P(0,"g"),O(1,jWe,1,0,"polygon",6),O(2,ZWe,1,0,"ng-template",null,7,mn),S()),2&r){const t=dn(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function KWe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function XWe(r,e){if(1&r&&(I(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function QWe(r,e){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function JWe(r,e){if(1&r&&(I(),O(0,XWe,1,1,"polyline",14),O(1,QWe,4,20,"ng-template",null,15,mn)),2&r){const t=dn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function eqe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",10),O(2,KWe,6,25,"g",11),O(3,JWe,3,2,"ng-template",null,12,mn),S()),2&r){const t=dn(4),n=p().index,i=p().index,o=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function tqe(r,e){if(1&r){const t=ge();I(),P(0,"g",3),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",4),O(2,YWe,4,2,"g",5),O(3,eqe,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),A("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function nqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,tqe,4,10,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function rqe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"rect",17),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o.x,o.y))}),S()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),A("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}u(G2,"encoder",Ko.getFallibleEncoder(G2.from));let iqe=(()=>{var r;class e extends iL{constructor(n){super(n,G2.from),this.setRulesAndNode("Tablut"),this.availableAIs=this.createAIs(),this.encoder=G2.encoder}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-tablut"]],features:[Ge],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,nqe,2,1,"g",1),O(2,rqe,2,6,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Sa extends Bi{static get(){return Sa.singleton.isAbsent()&&(Sa.singleton=g.of(new Sa)),Sa.singleton.get()}constructor(){super(G2.from)}getInitialState(e){const t=At.UNOCCUPIED;let n=At.PLAYER_ZERO_PAWN,i=At.PLAYER_ONE_PAWN,o=At.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=At.PLAYER_ONE_PAWN,i=At.PLAYER_ZERO_PAWN,o=At.PLAYER_ZERO_KING),new Eo([[t,t,t,n,n,n,t,t,t],[t,t,t,t,n,t,t,t,t],[t,t,t,t,i,t,t,t,t],[n,t,t,t,i,t,t,t,n],[n,n,i,i,o,i,i,n,n],[n,t,t,t,i,t,t,t,n],[t,t,t,t,i,t,t,t,t],[t,t,t,t,n,t,t,t,t],[t,t,t,n,n,n,t,t,t]],0)}getRulesConfigDescription(){return g.of(Sa.RULES_CONFIG_DESCRIPTION)}}u(Sa,"singleton",g.empty()),u(Sa,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Tablut`,config:{castleIsLeftForGood:new er(!1,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new er(!0,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new er(!1,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new er(!1,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new er(!0,Bi.INVADER_STARTS)}}));const F=At.UNOCCUPIED,An=At.PLAYER_ZERO_PAWN,os=At.PLAYER_ONE_PAWN,ry=At.PLAYER_ONE_KING,X1e=Sa.get().getDefaultRulesConfig();class oqe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Sa.get().getInitialState(X1e)),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Sa.get().getInitialState(X1e),G2.from(new v(4,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Eo([[F,F,F,An,An,An,F,F,F],[F,F,F,F,An,F,F,F,F],[F,F,F,F,os,F,F,F,F],[F,F,F,An,os,F,F,F,An],[An,An,os,os,ry,os,os,An,An],[F,F,F,F,os,F,F,F,An],[F,F,F,F,os,F,F,F,F],[F,F,F,F,An,F,F,F,F],[F,F,F,An,An,An,F,F,F]],1),[G2.from(new v(2,4),new v(2,3)).get(),G2.from(new v(4,2),new v(3,2)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Eo([[F,F,F,An,An,An,F,F,F],[F,F,F,F,An,F,F,F,F],[F,F,F,F,os,F,F,F,F],[F,F,os,F,ry,F,os,F,An],[An,An,F,os,F,os,os,An,An],[F,F,F,F,os,F,F,F,An],[F,F,F,F,os,F,F,F,F],[F,F,F,F,An,F,F,F,F],[F,F,F,An,An,An,F,F,F]],12),[G2.from(new v(1,4),new v(2,4)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Eo([[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,An,F,F,F,F,F,F,F],[An,ry,F,An,F,F,F,F,F],[F,An,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F]],72),[G2.from(new v(3,4),new v(2,4)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Eo([[F,F,An,ry,An,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,An,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F]],72),[G2.from(new v(3,3),new v(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}let B2=(()=>{class r extends k1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var HL;class U2 extends Or{static from(e){return B2.isOnBoard(e)?Q.success(new U2(e.x,e.y)):Q.failure(Ps.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof U2&&super.equals(e)}}u(U2,"encoder",Or.getFallibleEncoder(U2.from));class W2 extends n2{static from(e,t){return!1===B2.isOnBoard(e)?Q.failure(Ps.OUT_OF_RANGE(e)):!1===B2.isOnBoard(t)?Q.failure(Ps.OUT_OF_RANGE(t)):e.equals(t)?Q.failure(Ee.MOVE_CANNOT_BE_STATIC()):Q.success(new W2(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof W2&&super.equals(e)}}u(W2,"encoder",n2.getFallibleEncoder(W2.from)),function(r){r.encoder=Ne.disjunction([e=>e instanceof U2,e=>e instanceof W2],[U2.encoder,W2.encoder])}(HL||(HL={}));class zs extends ja{static get(){return zs.singleton.isAbsent()&&(zs.singleton=g.of(new zs)),zs.singleton.get()}getRulesConfigDescription(){return g.of(zs.RULES_CONFIG_DESCRIPTION)}getInitialState(){const e=wt.create(B2.WIDTH,B2.WIDTH,W.NONE);return new B2(e,0)}isLegal(e,t,n){return t.isInDropPhase()?(H.assert(e instanceof U2,"Cannot translate in dropping phase !"),this.isLegalDrop(e,t)):(H.assert(e instanceof W2,"Cannot drop in translation phase !"),this.isLegalTranslation(e,t,n.get()))}isLegalDrop(e,t){return t.getPieceAt(e.coord).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}isLegalTranslation(e,t,n){const i=t.getPieceAt(e.getStart());return i===t.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i===W.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(e.getEnd()).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===n.teleport&&!1===e.getStart().isNeighborWith(e.getEnd())?w.failure(Ee.MUST_MOVE_ON_NEIGHBOR()):w.SUCCESS}applyLegalMove(e,t,n,i){return e instanceof U2?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new B2(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=W.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new B2(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):_e.ONGOING}getLastCoord(e){return e instanceof U2?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<B2.WIDTH-1;i++)for(let o=0;o<B2.WIDTH-1;o++){const s=new v(i,o),a=new v(i+1,o),c=new v(i,o+1),l=new v(i+1,o+1),f=[e.getPieceAt(s),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=Ct.count(f,W.NONE),m=Ct.count(f,W.ZERO),E=Ct.count(f,W.ONE);d<4&&(4===m||4===E?t.push(s,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}getVictoryCoord(e){const t=zs.TEEKO_HELPER.getVictoriousCoord(e),n=this.getSquareInfo(e).victoriousCoords;return t.concat(n)}}u(zs,"singleton",g.empty()),u(zs,"RULES_CONFIG_DESCRIPTION",new z2({name:()=>$localize`Standard Teeko`,config:{teleport:new er(!1,()=>$localize`Piece can teleport`)}},[{name:()=>$localize`Teleport Teeko`,config:{teleport:!0}}])),u(zs,"TEEKO_HELPER",new Su(H.identity,4));class sqe extends Ya{getBoardValue(e,t){const n=zs.TEEKO_HELPER.getBoardValue(e.gameState).metrics[0],i=zs.get().getSquareInfo(e.gameState);return un.of(i.score+n)}}class ere extends jn{getListMoves(e,t){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState,t.get())}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===n.content.isPlayer()){const o=U2.from(i).get();t.push(o)}}return t}getListTranslations(e,t){const n=[],i=e.getCurrentPlayer(),o=this.getCoordsContaining(e,i);for(const s of o)for(const a of this.getPossibleTargets(e,s,t)){const c=W2.from(s,a).get();n.push(c)}return n}getPossibleTargets(e,t,n){if(n.teleport)return this.getCoordsContaining(e,W.NONE);{const i=[];for(const o of ve.factory.all){const s=t.getNext(o);B2.isOnBoard(s)&&e.getPieceAt(s)===W.NONE&&i.push(s)}return i}}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}}function aqe(r,e){if(1&r&&(I(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),A("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function cqe(r,e){if(1&r){const t=ge();I(),P(0,"g",3),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),V(1,"rect",4),O(2,aqe,1,6,"circle",5),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),_(1),Ce("id","space_",n,"_",i,""),y("ngClass",o.getSpaceClasses(n,i)),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isPlayer())}}function lqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,cqe,3,10,"g",2),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let uqe=(()=>{var r;class e extends Mo{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.setRulesAndNode("Teeko"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new sqe,new ere),new bn($localize`MCTS`,new ere,this.rules)],this.encoder=HL.encoder}updateBoard(n){var i=this;return M(function*(){i.board=i.node.gameState.board})()}showLastMove(n){var i=this;return M(function*(){i.last=g.of(i.rules.getLastCoord(n)),i.moved=n instanceof W2?[n.getStart(),n.getEnd()]:[],i.victory=i.rules.getVictoryCoord(i.getState())})()}hideLastMove(){var n=this;return M(function*(){n.last=g.empty(),n.moved=[],n.victory=[]})()}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new v(n,i);if(o.getState().isInDropPhase()){const c=U2.from(a).get();return o.chooseMove(c)}if(o.selected.isPresent()){if(o.selected.equalsValue(a))return o.selected=g.empty(),w.SUCCESS;{const c=W2.from(o.selected.get(),a).get();return o.chooseMove(c)}}{const c=o.getState().getCurrentPlayer(),l=o.getState().getPieceAt(a);return l===c?(o.selected=g.of(a),w.SUCCESS):o.cancelMove(l===W.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}})()}getPieceClasses(n,i){const o=new v(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(o))];return this.victory.some(c=>c.equals(o))?a.push("victory-stroke"):this.last.equalsValue(o)?a.push("last-move-stroke"):this.selected.equalsValue(o)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const o=new v(n,i);return this.moved.some(s=>s.equals(o))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-teeko"]],features:[Ge],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(I(),P(0,"svg",0),O(1,lqe,2,1,"g",1),S()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const $n=W.NONE,Yl=W.ZERO,Kl=W.ONE;class fqe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,zs.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,zs.get().getInitialState(),U2.from(new v(2,2)).get(),$localize`Congratulations!`),j.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to an empty neighboring space, orthogonally or diagonally. The goal remains to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new B2([[Yl,Kl,$n,$n,$n],[Yl,Yl,$n,$n,$n],[Kl,Kl,$n,$n,$n],[Kl,Yl,$n,$n,$n],[$n,$n,$n,$n,$n]],8),W2.from(new v(1,3),new v(2,2)).get(),$localize`Congratulations!`),j.fromMove($localize`Victory`,$localize`In this board, you can win by creating a square.<br/><br/>You are playing Dark, win.`,new B2([[Kl,$n,$n,$n,$n],[Kl,Yl,$n,Yl,$n],[$n,Yl,Yl,Kl,$n],[$n,Kl,$n,$n,$n],[$n,$n,$n,$n,$n]],8),[W2.from(new v(3,1),new v(2,1)).get()],$localize`Congratulations, you won! Remember that you can also win by creating a line.`,$localize`Failed. Try again.`)])}}class Ao{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Jr{static of(e){let t=-1;for(const n of e)H.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new Jr(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?W.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return Jr.of(this.pieces.concat(e))}getPieceAt(e){return H.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(Jr,"EMPTY",Jr.of([]));let Ji=(()=>{class r extends k1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){H.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)H.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),o=new Ao(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(o),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),iy=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var rre,VL;class f2 extends Ko{static from(e,t){return H.assert(Ji.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),H.assert(Ji.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?Q.success(new f2(e,t)):Q.failure(iy.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(f2,"encoder",Ko.getFallibleEncoder(f2.from));class eo extends Sr{static get(){return eo.instance.isAbsent()&&(eo.instance=g.of(new eo)),eo.instance.get()}static getOwner(e){return e.getOwner()}getInitialState(){const e=wt.create(Ji.SIZE,Ji.SIZE,Jr.EMPTY);return new Ji(e,0)}applyLegalMove(e,t,n,i){return t.drop(e.getZero(),k.ZERO).drop(e.getOne(),k.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?w.failure(iy.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?w.failure(iy.CANNOT_DROP_ON_ONLY_ONE_PIECE()):w.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return eo.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const o of e.toMap()){const s=o.key,a=e.getPieceAt(s).getOwner();if(a.isPlayer()){const c=eo.getSquareScore(e,s);un.isVictory(c)&&(a===i?t.push(s):n.push(s))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const o of t.toMap()){const s=o.key,a=t.getPieceAt(s).getOwner();if(a.isPlayer()){const c=eo.getSquareScore(t,s);if(un.isVictory(c)){if(a!==n)return _e.getDefeat(n);i=!0}}}return i?_e.getVictory(n):_e.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<Ji.SIZE){const o=new v(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,o))}if(i.y+1<Ji.SIZE){const o=new v(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,o))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),o=e.getPieceAt(n);let s;s=!i.isGround()&&i.getUpperTileId()===o.getUpperTileId();const a=i.getHeight()!==o.getHeight();return s||a?[]:[f2.from(t,n).get(),f2.from(n,t).get()]}}rre=eo,u(eo,"instance",g.empty()),u(eo,"TREXO_HELPER",new Su(rre.getOwner,5));class dqe extends Ya{getBoardValue(e,t){let n=0;const i=e.gameState;for(const o of i.toMap())i.getPieceAt(o.key).getOwner().isPlayer()&&(n+=eo.getSquareScore(i,o.key));return un.of(n)}}class ire extends jn{constructor(...e){super(...e),u(this,"rules",eo.get())}getListMoves(e,t){return this.rules.getLegalMoves(e.gameState)}}function hqe(r,e){if(1&r){const t=ge();I(),P(0,"g")(1,"polygon",5),q("click",function(){const o=ee(t).index,s=p().index;return te(p().onClick(o,s))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),A("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function gqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,hqe,2,5,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function pqe(r,e){if(1&r){const t=ge();I(),P(0,"g",8),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p(2).onClick(i,o))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p().index,a=p();Hr("id","half_tile_",n,"_",o,"_",s,""),y("mode",a.mode)("coord",a.Coord3D.of(n,o,s))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,o,s)),A("transform",a.getTranslate(n,o,s+1))}}const ore=function(r){return[r]};function mqe(r,e){if(1&r){const t=ge();I(),P(0,"g",9),q("click",function(){ee(t);const i=p().index,o=p().index;return te(p(2).onClick(i,o))}),S()}if(2&r){const t=p().index,n=p().index,i=p().index,o=p();Hr("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",o.mode)("coord",o.Coord3D.of(t,n,i))("pieceClasses",Ra(7,ore,o.currentOpponentClass)),A("transform",o.getTranslate(t,n,i+1))}}function _qe(r,e){if(1&r&&(I(),P(0,"g"),O(1,pqe,1,9,"g",6),O(2,mqe,1,9,"g",7),S()),2&r){const t=e.$implicit;_(1),y("ngIf",t.move.isPresent()),_(1),y("ngIf",t.isDroppedPiece)}}function vqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,_qe,3,2,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Cqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,vqe,2,1,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}const yqe=function(){return["player0-fill"]};function Mqe(r,e){if(1&r){const t=ge();I(),P(0,"g",10),q("click",function(){return ee(t),te(p().switchToMode("3D"))}),S()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",Q1(4,yqe)),A("transform",t.get3DSwitcherTransform())}}function Eqe(r,e){if(1&r){const t=ge();I(),P(0,"g",11),q("click",function(){return ee(t),te(p().switchToMode("2D"))}),S()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",Ra(4,ore,t.currentPlayerClass)),A("transform",t.getTranslate(12,9,0))}}class Gn extends s1e{constructor(e){super(e),u(this,"TrexoComponent",Gn),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",ch),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.setRulesAndNode("Trexo"),this.availableAIs=[new cn($localize`Alignment`,this.rules,new dqe,new ire),new bn($localize`MCTS`,new ire,this.rules)],this.encoder=f2.encoder,Gn.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=Gn.modeMap[e]}getViewBoxWidth(){const e=Gn.modeMap["3D"],t=Ji.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=Ji.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*Gn.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=eo.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}get3DBoard(){const e=PDe.create(1,Ji.SIZE,Ji.SIZE,Gn.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const o=i.key,s=i.value.getHeight();if(t=Math.max(t,s),n<s){const a=this.extractMoveFromState(o.x,o.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),o=new v(e,t);let s=new v(-2,-2);for(const a of ve.ORTHOGONALS){const c=o.getNext(a);if(Ji.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(s=c)}}return i.owner===k.ZERO?f2.from(o,s).get():f2.from(s,o).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(wt.create(Ji.SIZE,Ji.SIZE,Gn.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new v(e,t);if(n.droppedPiece.isPresent()){const s=n.droppedPiece.get();if(n.droppedPiece.equalsValue(o))return yield n.cancelMoveAttempt(),w.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(o))){const a=n.getState().getCurrentPlayer()===k.ZERO,f=f2.from(a?o:s,a?s:o).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(o)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=Gn.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return M(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return t.pieceOnBoard.length<=n&&t.pieceOnBoard.push(wt.create(Ji.SIZE,Ji.SIZE,Gn.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),w.SUCCESS}return t.cancelMove(iy.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return M(function*(){e.droppedPiece=g.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new v(e,t),o=this.getState().getPieceAtXYZ(e,t,n).owner;let s=[this.getPlayerClass(o)];s=s.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){s.push("victory-stroke");break}if(this.node.previousMove.isPresent()){const a=this.node.previousMove.get();(a.getZero().equals(i)||a.getOne().equals(i))&&s.push("last-move-stroke")}return s}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const o=this.getCoordTranslate(e,t,n,Gn.modeMap[this.chosenMode]);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(Gn.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=Gn.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}VL=Gn,u(Gn,"STROKE_WIDTH",void 0),u(Gn,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u(Gn,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u(Gn,"\u0275fac",function(e){return new(e||VL)(U(Ut))}),u(Gn,"\u0275cmp",Fe({type:VL,selectors:[["app-trexo"]],features:[Ge],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(I(),P(0,"svg",0),O(1,gqe,2,1,"g",1),O(2,Cqe,2,1,"g",1),P(3,"g",null,2),O(5,Mqe,1,5,"g",3),O(6,Eqe,1,6,"ng-template",null,4,mn),S()()),2&e){const n=dn(7);A("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),_(1),y("ngForOf",t.board),_(1),y("ngForOf",t.pieceOnBoard),_(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const J=Jr.EMPTY,sre=Jr.of([new Ao(k.ONE,0)]),Pqe=Jr.of([new Ao(k.ZERO,0)]),Sqe=Jr.of([new Ao(k.ONE,1)]),are=Jr.of([new Ao(k.ZERO,1)]),Oqe=Jr.of([new Ao(k.ZERO,2)]),Tqe=Jr.of([new Ao(k.ONE,2)]),bqe=Jr.of([new Ao(k.ZERO,0),new Ao(k.ZERO,3)]),wqe=Jr.of([new Ao(k.ONE,1),new Ao(k.ONE,3)]),Nqe=Jr.of([new Ao(k.ZERO,4)]),Aqe=Jr.of([new Ao(k.ONE,4)]),Iqe=Jr.of([new Ao(k.ZERO,5)]),kqe=Jr.of([new Ao(k.ONE,5)]),xqe=Jr.of([new Ao(k.ONE,6)]),Lqe=Jr.of([new Ao(k.ZERO,6)]);class Rqe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,eo.get().getInitialState()),j.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,eo.get().getInitialState(),f2.from(new v(4,4),new v(3,4)).get(),$localize`Congratulations!`),j.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new Ji([[J,J,J,sre,Pqe,are,Sqe,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J]],7),[f2.from(new v(4,0),new v(5,0)).get(),f2.from(new v(5,0),new v(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),j.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new Ji([[J,J,J,J,J,J,J,J,J,J],[J,J,J,Iqe,J,J,J,J,J,J],[J,J,J,kqe,J,J,J,J,J,J],[J,J,J,J,sre,J,J,Nqe,Aqe,J],[J,J,J,J,bqe,wqe,are,J,J,J],[J,J,J,J,J,Oqe,xqe,Lqe,J,J],[J,J,J,J,J,Tqe,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J]],7),f2.from(new v(2,0),new v(2,1)).get(),(t,n,i)=>eo.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?w.SUCCESS:w.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}class Z1{}var Oa;u(Z1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(Z1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(Z1,"MISSING_CAPTURES",_a.MISSING_CAPTURES),u(Z1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(Z1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(Z1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(Z1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(Z1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(Z1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(Z1,"AMBIGUOUS_CAPTURE_COORD",_a.AMBIGUOUS_CAPTURE_COORD),u(Z1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class Rt{static of(e,t){return e===W.NONE?Rt.EMPTY:t?Rt.RINGS[e.value]:Rt.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return nn(!1===this.isRing,"cannot flip a ring (it should never happen)"),nn(this.player.isPlayer(),"cannot flip a non-player piece"),Rt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case Rt.UNREACHABLE:return"NONE";case Rt.EMPTY:return"EMPTY";case Rt.MARKER_ZERO:return"MARKER_ZERO";case Rt.MARKER_ONE:return"MARKER_ONE";case Rt.RING_ZERO:return"RING_ZERO";default:return H.expectToBe(this,Rt.RING_ONE),"RING_ONE"}}}Oa=Rt,u(Rt,"encoder",Ne.tuple([W.encoder,Ne.identity()],r=>[r.player,r.isRing],r=>Oa.of(r[0],r[1]))),u(Rt,"UNREACHABLE",new Oa(W.NONE,!1)),u(Rt,"EMPTY",new Oa(W.NONE,!1)),u(Rt,"MARKER_ZERO",new Oa(k.ZERO,!1)),u(Rt,"MARKER_ONE",new Oa(k.ONE,!1)),u(Rt,"MARKERS",[Oa.MARKER_ZERO,Oa.MARKER_ONE]),u(Rt,"RING_ZERO",new Oa(k.ZERO,!0)),u(Rt,"RING_ONE",new Oa(k.ONE,!0)),u(Rt,"RINGS",[Oa.RING_ZERO,Oa.RING_ONE]);let uc=(()=>{class r extends hL{constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],Rt.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&wt.compare(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,o)=>{o.isRing&&o.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Rt.UNREACHABLE}setAtUnsafe(t,n){const i=wt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();var cre,lre,oy;class Ta extends Ki{static of(e,t,n){const i=[],o=Ae.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(o))i.push(s);return i.push(t),new Ta(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new Ta(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}cre=Ta,u(Ta,"encoder",Ne.tuple([Ne.list(v.encoder),g.getEncoder(v.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new cre(r[0],r[1])));class y3 extends yo{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===Ct.equals(this.initialCaptures,e.initialCaptures)||!1===Ct.equals(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}lre=y3,u(y3,"encoder",Ne.tuple([Ne.list(Ta.encoder),v.encoder,g.getEncoder(v.encoder),Ne.list(Ta.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new lre(r[0],r[1],r[2],r[3])));class zqe extends B1{getMetrics(e,t){return g1.of([e.gameState.sideRings[0]],[e.gameState.sideRings[1]])}}class Dqe{static getCombinations(e,t){return nn(t<=e.length,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let o=1;for(;o<t;)if(i[o]<o){const s=o%2&&i[o],a=e[o];e[o]=e[s],e[s]=a,++i[o],o=1,n.push(e.slice())}else i[o]=0,++o;return n}static getSubsetsOfSize(e,t){return function n(i,o){if(e.length<=o||i<1)return[[]];{const s=[];for(;o<=e.length-i;){const a=e[o];for(const c of n(i-1,o+1))c.push(a),s.push(c);++o}return s}}(t,0)}}class fc extends Sr{static get(){return fc.singleton.isAbsent()&&(fc.singleton=g.of(new fc)),fc.singleton.get()}getInitialState(){const e=Rt.EMPTY,t=Rt.UNREACHABLE;return new uc([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}applyLegalMove(e,t,n,i){return new uc(i.board,i.sideRings,i.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new uc(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,Rt.EMPTY).board,o=[e.sideRings[0],e.sideRings[1]];return o[n]+=1,new uc(i,o,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,Rt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===Rt.RINGS[n]?w.SUCCESS:w.failure(Z1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let o=n.setAt(e,Rt.MARKERS[i]);o=o.setAt(t,Rt.RINGS[i]);const s=Ae.factory.fromMove(e,t).get();for(let a=e.getNext(s);!1===a.equals(t);a=a.getNext(s)){const c=o.getPieceAt(a);c!==Rt.EMPTY&&(o=o.setAt(a,c.flip()))}return o}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return Q.failure(Z1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),o=this.moveValidity(i,e.start,e.end.get());if(o.isFailure())return o.toOtherFallible();const s=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(s,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():Q.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return Q.failure(Z1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==Rt.EMPTY)return Q.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const o=e.setAt(t,Rt.of(n,!0)).board,s=new uc(o,i,e.turn);return Q.success(s)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==Rt.RINGS[n]?w.failure(Z1.SHOULD_SELECT_PLAYER_RING()):w.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==Rt.EMPTY)return w.failure(Z1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const o=Ae.factory.fromMove(t,n);if(o.isFailure())return w.failure(Z1.MOVE_DIRECTION_INVALID());const s=o.get();let a=!1;for(let c=t.getNext(s);!1===c.equals(n);c=c.getNext(s)){const l=e.getPieceAt(c);if(l===Rt.EMPTY){if(a)return w.failure(Z1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return w.failure(Z1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return w.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=this.applyCapture(i,n)}return w.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==Rt.MARKERS[n])return w.failure(Z1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==Rt.RINGS[n]?w.failure(Z1.CAPTURE_SHOULD_TAKE_RING()):w.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?w.SUCCESS:w.failure(Z1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let c,a=o;for(c=o;e.isOnBoard(c);c=c.getNext(s)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(5<=i)break;i=0}}return 5<=i?g.of({start:a,end:c,dir:s}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let o=i.start;5<=o.getDistance(i.end);o=o.getNext(i.dir))n.push(Ta.of(o,o.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of Ae.factory.all){let o=!1;for(let s=t.getNext(i);e.isOnBoard(s);s=s.getNext(i)){const a=e.getPieceAt(s);if(a===Rt.EMPTY){if(n.push(s),o)break}else{if(a.isRing)break;o=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?_e.ONGOING:3<=e.gameState.sideRings[0]?_e.ZERO_WON:3<=e.gameState.sideRings[1]?_e.ONE_WON:_e.ONGOING}}u(fc,"singleton",g.empty());class ure extends jn{getListMoves(e,t){const n=[],i=e.gameState;if(i.isInitialPlacementPhase())for(const{coord:o,content:s}of i.getCoordsAndContents())s===Rt.EMPTY&&n.push(new y3([],o,g.empty(),[]));else{const o=fc.get();this.getPossibleCaptureCombinations(i).forEach(s=>{const a=o.applyCaptures(s,i);this.getRingMoves(a).forEach(c=>{const l=o.applyRingMoveAndFlip(c.start,c.end,a);this.getPossibleCaptureCombinations(l).forEach(f=>{const d=new y3(s,c.start,g.of(c.end),f);n.push(d)})})})}return n}getPossibleCaptureCombinations(e){const n=fc.get().getPossibleCaptures(e),i=this.getRingCoords(e);return MC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(o=>Dqe.getCombinations(i,o.length).map(s=>o.map((a,c)=>new Ta(a.capturedSpaces,g.of(s[c]))))).reduce((o,s)=>o.concat(s),[])}getRingMoves(e){const t=fc.get(),n=[];for(const i of this.getRingCoords(e))for(const o of t.getRingTargets(e,i))n.push({start:i,end:o});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,o)=>{o===Rt.RINGS[t]&&n.push(i)}),n}}function Hqe(r,e){if(1&r&&(I(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);A("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function Vqe(r,e){if(1&r&&(I(),V(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","ring_",n,"_",o,""),y("ngClass",i.ringClasses),A("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.ringMidSize)}}function Fqe(r,e){if(1&r&&(I(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);A("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function $qe(r,e){if(1&r&&(I(),V(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","marker_",n,"_",o,""),y("ngClass",i.markerClasses),A("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.markerSize)}}function Gqe(r,e){if(1&r){const t=ge();I(),P(0,"g",6),q("click",function(){ee(t);const i=p().$implicit;return te(p(2).onClick(i.coord))}),V(1,"polygon",7),P(2,"g",8),O(3,Hqe,1,3,"circle",9),O(4,Vqe,1,6,"circle",10),O(5,Fqe,1,3,"circle",9),O(6,$qe,1,6,"circle",11),S()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index;Ce("id","click_",n,"_",o,""),_(1),Ce("id","space_",n,"_",o,""),y("ngClass",i.spaceClasses),A("points",i.coordinates),_(1),Ce("id","pieceGroup_",n,"_",o,""),y("ngClass",i.removedClass),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isMarker)}}function Bqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,Gqe,7,13,"g",5),S()),2&r){const t=e.$implicit;_(1),y("ngIf",null!=t)}}function Uqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,Bqe,2,1,"g",1),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Wqe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",15),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","selected_",t.x,"_",t.y,""),A("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function qqe(r,e){if(1&r){const t=ge();I(),P(0,"polygon",17),q("click",function(){const o=ee(t).$implicit;return te(p(2).onClick(o))}),S()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","selectable_",t.x,"_",t.y,""),A("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function jqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,qqe,1,3,"polygon",16),S()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.selectableCoords)}}function Zqe(r,e){if(1&r){const t=ge();I(),P(0,"rect",18),q("click",function(){const o=ee(t).$implicit;return te(p().onClick(o))}),S()}if(2&r){const t=e.$implicit,n=p();Ce("id","indicator_",t.x,"_",t.y,""),A("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function Yqe(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",19)(2,"circle",12)(3,"circle",20),S()),2&r){const t=e.index,n=p().$implicit,i=p();_(1),Ce("id","player_",n.value,"_sideRing_",t+1,""),A("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),_(1),A("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),_(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),A("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const Kqe=function(){return[]};function Xqe(r,e){if(1&r&&(I(),P(0,"g"),O(1,Yqe,4,12,"g",1),S()),2&r){const t=e.$implicit,n=p();A("transform","rotate("+180*(n.getPointOfView().value+1)+" 532.5 780)"),_(1),y("ngForOf",Q1(2,Kqe).constructor(n.viewInfo.sideRings[t.value]))}}class Io extends Cu{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:Io.MARKER_SIZE,ringOuterSize:Io.RING_OUTER_SIZE,ringMidSize:Io.RING_MID_SIZE,ringInnerSize:Io.RING_INNER_SIZE,indicatorSize:Io.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.setRulesAndNode("Yinsh"),this.availableAIs=[new cn($localize`Score`,this.rules,new zqe,new ure),new bn($localize`MCTS`,new ure,this.rules)],this.encoder=y3.encoder,this.scores=g.of([0,0]),this.hexaLayout=new yu(1.5*Io.RING_OUTER_SIZE,new v(2*Io.RING_OUTER_SIZE,0),Wr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt();const n=t.getState();t.scores=g.of(n.countScores())})()}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of k.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==Rt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return M(function*(){if(e.isInitialPlacement())t.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const i of t.coordsBetween(e.start,e.end.get()))t.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["moved-fill"];const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}coordsBetween(e,t){return e.getAllCoordsToward(t)}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),w.SUCCESS}onClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return M(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(Z1.MISSING_CAPTURES());t.selectCapture(n[0])}return w.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(H.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return M(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(Z1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(Z1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new uc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(nn("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),w.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,Rt.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,Rt.RINGS[t.value])}selectRing(e){var t=this;return M(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),w.SUCCESS)):(H.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),w.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),w.SUCCESS}tryMove(){var e=this;return M(function*(){const t=new y3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return M(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return w.SUCCESS})()}selectMoveEnd(e){var t=this;return M(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),w.SUCCESS;const n=Rt.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),w.SUCCESS)})()}}oy=Io,u(Io,"RING_OUTER_SIZE",40),u(Io,"RING_MID_SIZE",34),u(Io,"RING_INNER_SIZE",28),u(Io,"MARKER_SIZE",oy.RING_INNER_SIZE),u(Io,"INDICATOR_SIZE",10),u(Io,"\u0275fac",function(e){return new(e||oy)(U(Ut))}),u(Io,"\u0275cmp",Fe({type:oy,selectors:[["app-yinsh"]],features:[Ge],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(I(),P(0,"svg",0),O(1,Uqe,2,1,"g",1),O(2,Wqe,1,3,"polygon",2),O(3,jqe,2,1,"g",3),O(4,Zqe,1,6,"rect",4),O(5,Xqe,2,3,"g",1),S()),2&e&&(_(1),y("ngForOf",t.viewInfo.spaceInfo),_(1),y("ngForOf",t.viewInfo.selectedCoords),_(1),y("ngIf",t.isPlayerTurn()),_(1),y("ngForOf",t.viewInfo.targets),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Lt,Dt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const D=Rt.EMPTY,he=Rt.UNREACHABLE,to=Rt.MARKER_ZERO,ss=Rt.RING_ZERO,M3=Rt.MARKER_ONE,Ni=Rt.RING_ONE;let fre=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class Qqe extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new uc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,to,Ni,D,D,D,D,D,D],[he,he,D,to,D,Ni,D,M3,D,D,D],[he,D,ss,M3,D,D,Ni,to,D,D,D],[he,D,D,to,M3,D,D,D,D,D,he],[D,D,D,to,D,D,D,Ni,D,D,he],[D,D,D,M3,to,ss,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),j.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new uc(fc.get().getInitialState().board,[5,5],0),new y3([],new v(5,5),g.empty(),[]),$localize`Congratulations!`),j.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new uc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,Ni,D,D,D,D,D,D,D],[he,he,Ni,D,D,Ni,D,D,D,D,D],[he,D,ss,M3,D,D,Ni,D,D,D,D],[he,D,D,M3,D,D,D,D,D,D,he],[D,D,D,D,ss,D,D,Ni,D,D,he],[D,D,D,D,D,ss,D,D,D,he,he],[D,D,D,ss,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new y3([],new v(2,4),g.of(new v(4,4)),[]),$localize`Congratulations!`),j.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new uc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,Ni,D,D,D,D,D,D,D],[he,he,Ni,D,D,Ni,D,D,D,D,D],[he,D,to,to,ss,M3,M3,D,D,D,D],[he,D,D,Ni,D,D,D,D,D,D,he],[D,D,D,D,ss,D,D,Ni,D,D,he],[D,D,D,D,D,ss,D,D,D,he,he],[D,D,D,ss,D,D,D,ss,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new y3([],new v(4,4),g.of(new v(7,4)),[Ta.of(new v(2,4),new v(6,4),g.of(new v(7,4)))]),(t,n,i)=>1===i.sideRings[k.ZERO.value]?w.SUCCESS:w.failure(fre.MUST_ALIGN_FIVE()),$localize`Congratulations!`),j.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new uc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,ss,D,D,Ni,Ni,ss,D],[he,he,he,ss,D,D,M3,Ni,D,ss,D],[he,he,D,ss,D,D,D,D,D,Ni,D],[he,D,D,D,D,to,D,D,Ni,D,D],[he,D,D,D,to,to,D,M3,D,D,he],[D,D,D,to,D,to,D,D,D,D,he],[D,D,to,D,D,to,D,D,D,he,he],[D,to,D,D,D,to,D,D,he,he,he],[D,D,D,D,D,to,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new y3([Ta.of(new v(5,4),new v(1,8),g.of(new v(3,2))),Ta.of(new v(5,9),new v(5,5),g.of(new v(3,3)))],new v(4,1),g.of(new v(4,2)),[]),(t,n,i)=>2===i.sideRings[k.ZERO.value]?w.SUCCESS:w.failure(fre.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}function Jqe(r,e){if(1&r&&(P(0,"option",5),rt(1),S()),2&r){const t=e.$implicit;y("value",t.urlName),_(1),gn(t.name)}}let In=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The most widespread of the Mancalas.`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIABALLIK",()=>$localize`Pass the ball up to the side of the opponent to win the game!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KALAH",()=>$localize`A modern version of the famous African strategy game!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})();class Ft{static ALL_GAMES(){return[new Ft($localize`Four in a Row`,"P4",hBe,new gBe,f3.get(),new Date("2018-08-28"),In.P4()),new Ft($localize`Awalé`,"Awale",sHe,new aHe,t2.get(),new Date("2018-11-29"),In.AWALE()),new Ft($localize`Quarto`,"Quarto",MUe,new AUe,Xr.get(),new Date("2018-12-09"),In.QUARTO()),new Ft($localize`Tablut`,"Tablut",iqe,new oqe,Sa.get(),new Date("2018-12-27"),In.TABLUT()),new Ft($localize`Reversi`,"Reversi",jUe,new YUe,W0.get(),new Date("2019-01-16"),In.REVERSI()),new Ft($localize`Go`,"Go",ML,new GFe,ec.get(),new Date("2019-12-21"),In.GO()),new Ft($localize`Encapsule`,"Encapsule",lFe,new gFe,ku.get(),new Date("2019-12-30"),In.ENCAPSULE()),new Ft($localize`Siam`,"Siam",ey,new AWe,is.get(),new Date("2020-01-11"),In.SIAM()),new Ft($localize`Sahara`,"Sahara",lWe,new uWe,R4.get(),new Date("2020-02-29"),In.SAHARA()),new Ft($localize`Pylos`,"Pylos",KBe,new XBe,wi.get(),new Date("2020-10-02"),In.PYLOS()),new Ft($localize`Kamisado`,"Kamisado",J$e,new eGe,Xi.get(),new Date("2020-10-03"),In.KAMISADO()),new Ft($localize`Quixo`,"Quixo",DUe,new VUe,Qr.get(),new Date("2020-10-15"),In.QUIXO()),new Ft($localize`Dvonn`,"Dvonn",tFe,new GVe,Nr.get(),new Date("2020-10-21"),In.DVONN()),new Ft($localize`Epaminondas`,"Epaminondas",OFe,new TFe,qr.get(),new Date("2021-01-16"),In.EPAMINONDAS()),new Ft($localize`Gipf`,"Gipf",zFe,new i$e,Jt.get(),new Date("2021-02-22"),In.GIPF()),new Ft($localize`Coerceo`,"Coerceo",sVe,new cVe,G9.get(),new Date("2021-03-21"),In.COERCEO()),new Ft($localize`Six`,"Six",WWe,new qWe,C3.get(),new Date("2021-04-08"),In.SIX()),new Ft($localize`Lines of Action`,"LinesOfAction",_Ge,new vGe,li.get(),new Date("2021-04-28"),In.LINES_OF_ACTION()),new Ft($localize`Pentago`,"Pentago",SBe,new OBe,d3.get(),new Date("2021-05-23"),In.PENTAGO()),new Ft($localize`Abalone`,"Abalone",GDe,new cHe,e2.get(),new Date("2021-07-13"),In.ABALONE()),new Ft($localize`Yinsh`,"Yinsh",Io,new Qqe,fc.get(),new Date("2021-07-31"),In.YINSH()),new Ft($localize`Apagos`,"Apagos",XDe,new ADe,R2.get(),new Date("2021-11-04"),In.APAGOS()),new Ft($localize`Diam`,"Diam",s3,new $He,i3.get(),new Date("2021-11-30"),In.DIAM()),new Ft($localize`Brandhub`,"Brandhub",bHe,new wHe,ca.get(),new Date("2021-12-07"),In.BRANDHUB()),new Ft($localize`Conspirateurs`,"Conspirateurs",yVe,new VHe,Os.get(),new Date("2021-12-30"),In.CONSPIRATEURS()),new Ft($localize`Lodestone`,"Lodestone",A4,new CGe,Ir.get(),new Date("2022-06-24"),In.LODESTONE()),new Ft($localize`Martian Chess`,"MartianChess",Rs,new RGe,Ls.get(),new Date("2022-07-01"),In.MARTIAN_CHESS()),new Ft($localize`Hnefatafl`,"Hnefatafl",V$e,new b$e,Ma.get(),new Date("2022-09-21"),In.HNEFATAFL()),new Ft($localize`Hive`,"Hive",e1e,new T$e,Ti.get(),new Date("2023-04-02"),In.HIVE()),new Ft($localize`Trexo`,"Trexo",Gn,new Rqe,eo.get(),new Date("2023-04-23"),In.TREXO()),new Ft($localize`Lasca`,"Lasca",cGe,new fGe,c2.get(),new Date("2023-05-11"),In.LASCA()),new Ft($localize`Connect Six`,"ConnectSix",DHe,new HHe,Ui.get(),new Date("2023-05-13"),In.CONNECT_SIX()),new Ft($localize`Pente`,"Pente",xBe,new LBe,No.get(),new Date("2023-05-20"),In.PENTE()),new Ft($localize`Teeko`,"Teeko",uqe,new fqe,zs.get(),new Date("2023-07-30"),In.TEEKO()),new Ft($localize`Kalah`,"Kalah",B$e,new U$e,Jo.get(),new Date("2023-09-07"),In.KALAH()),new Ft($localize`Diaballik`,"Diaballik",IVe,new kVe,s2.get(),new Date("2023-11-18"),In.DIABALLIK())].sort((e,t)=>e.name.localeCompare(t.name))}static getByUrlName(e){const t=Ft.ALL_GAMES().filter(n=>n.urlName===e);return H.assert(t.length<=1,"There should only be one game matching $urlName!"),0===t.length?g.empty():g.of(t[0])}constructor(e,t,n,i,o,s,a,c=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=e,this.urlName=t,this.component=n,this.tutorial=i,this.rules=o,this.creationDate=s,this.description=a,this.display=c}getRulesConfigDescription(){return this.rules.getRulesConfigDescription()}getRulesConfig(){const e=this.getRulesConfigDescription();return e.isPresent()?g.of(e.get().getDefaultConfig().config):g.empty()}}let FL=(()=>{var r;class e{constructor(){u(this,"games",Ft.ALL_GAMES()),u(this,"pickGame",new _1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"select",1),q("change",function(s){return i.onChange(s)}),P(2,"option",2),se(3,3),S(),O(4,Jqe,2,2,"option",4),S()()),2&n&&(_(4),y("ngForOf",i.games))},dependencies:[Dt,Q8,J8],encapsulation:2})),e})();class $L{static getGameDefaultConfig(e){const t=Ft.getByUrlName(e);return t.isPresent()?t.get().getRulesConfig():g.empty()}}var j0;let GL=(u(j0=class extends O0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||j0)(Oe(kl))}),u(j0,"\u0275prov",De({token:j0,factory:j0.\u0275fac,providedIn:"root"})),j0);var z4,BL;GL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],GL);let dh=(z4=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new oC(s=>{for(const a of s)n.push(a.data);t(n)},s=>{for(const a of s)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},s=>{for(const a of s)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e,t){var n=this;return M(function*(){const i=n.connectedUserService.user.get().toMinimalUser(),o={chosenOpponent:null,firstPlayer:$i.RANDOM.value,partType:cr.STANDARD.value,partStatus:Co.PART_CREATED.value,maximalMoveDuration:cr.NORMAL_MOVE_DURATION,totalPartDuration:cr.NORMAL_PART_DURATION,creator:i,rulesConfig:$L.getGameDefaultConfig(t).getOrElse({})};return n.configRoomDAO.set(e,o)})()}joinGame(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?w.failure(BL.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),w.SUCCESS)})()}cancelJoining(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),s=[t.removeCandidate(e,n)];o.chosenOpponent?.id===n.id&&s.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Co.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(e,t){var n=this;return M(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,o,s,a){var c=this;return M(function*(){return c.configRoomDAO.update(e,{partStatus:Co.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:s,firstPlayer:o.value,rulesConfig:a.getOrElse({})})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:Co.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:Co.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:Co.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return M(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return M(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},BL=z4,u(z4,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(z4,"\u0275fac",function(e){return new(e||z4)(Oe(GL),Oe(ar))}),u(z4,"\u0275prov",De({token:z4,factory:z4.\u0275fac,providedIn:"root"})),z4);var Z0;dh=BL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],dh);let ju=(Z0=class{constructor(e,t,n,i,o){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=o}update(e,t){var n=this;return M(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return M(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?w.failure("NONEXISTENT_PART"):i.get().typeGame===t?w.SUCCESS:w.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:I1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return M(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n,e),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=$i.of(e.firstPlayer);return t===$i.RANDOM&&(t=Math.random()<.5?$i.CREATOR:$i.CHOSEN_PLAYER),t===$i.CREATOR?(n=e.creator,i=H.getNonNullable(e.chosenOpponent)):(n=H.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:e3()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let o;o=i.playerZero===t.creator?k.ONE:k.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,o)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var o=this;return M(function*(){const s={winner:n,loser:i,result:I1.RESIGN.value};yield o.partDAO.update(e,s),yield o.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var o=this;return M(function*(){const s={winner:n,loser:i,result:I1.TIMEOUT.value};yield o.partDAO.update(e,s),yield o.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const o={result:(t===k.ZERO?I1.AGREED_DRAW_BY_ZERO:I1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,o),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return M(function*(){const i=H.getNonNullable(e.data),o=yield n.configRoomService.readConfigRoomById(e.id);let s;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=H.getNonNullable(i.playerOne),s=$i.CHOSEN_PLAYER):(c=i.playerZero,s=$i.CREATOR);const l={...o,firstPlayer:s.value,creator:a,chosenOpponent:c,partStatus:Co.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:I1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return M(function*(){let o=t-1;o%2===n.value&&o--;const s={turn:o};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,s)})()}refuseTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return M(function*(){let s={turn:(yield n.partDAO.read(e)).get().turn+1};return s=n.updateScore(s,t),s})()}updatePart(e,t){var n=this;return M(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return M(function*(){let o=yield i.preparePartUpdate(e,n);o={...o,result:I1.HARD_DRAW.value},yield i.update(e,o),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,o){var s=this;return M(function*(){let a=yield s.preparePartUpdate(e,o);a={...a,winner:n,loser:i,result:I1.VICTORY.value},yield s.update(e,a),yield s.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return M(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(Z0,"\u0275fac",function(e){return new(e||Z0)(Oe(x9),Oe(Zx),Oe(ar),Oe(dh),Oe(du))}),u(Z0,"\u0275prov",De({token:Z0,factory:Z0.\u0275fac,providedIn:"root"})),Z0);ju=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ju);class hh{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??hh.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let dre=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return hh.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),sy=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const o=this.getStoredTheme();o.isPresent()?this.loadTheme(o.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(o=>o===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],o=this.document.getElementById("theme");if(null!=o)o.href=n;else{const s=this.document.createElement("link");s.id="theme",s.rel="stylesheet",s.href=`${n}`,i.appendChild(s)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ki),Oe(dre))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var Py,zre={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Gre={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Bre={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},ZL={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Kie={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},Ioe={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},lR={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Dae={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},_R={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},jae={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},h3e={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},xR={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Y3e={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class Ds{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new On),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new Ste(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var o=M(function*(s){yield i.onUserUpdate(s)});return function(s){return o.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return M(function*(){if(e===N0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{nn(i.isPresent(),"Observing part service expected user to already have a document!");const o=i.get();t.onCurrentGameUpdate(o.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(nn(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)nn(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return nn(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return w.SUCCESS;{const e=Ds.roleToMessage.get(this.currentGame.get().role).get()();return w.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return w.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return w.SUCCESS;{const n=Ds.roleToMessage.get(this.currentGame.get().role).get()();return w.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new On;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function aCt(r,e){if(1&r&&(qt(0),se(1,31),jt()),2&r){const t=p(2);_(1),Hn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Bn(1)}}function cCt(r,e){if(1&r&&(qt(0),se(1,33),jt()),2&r){const t=p(3);_(1),Hn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Bn(1)}}function lCt(r,e){if(1&r&&(qt(0),se(1,34),jt()),2&r){const t=p(3);_(1),Hn(t.currentGame.get().typeGame),Bn(1)}}function uCt(r,e){if(1&r&&(O(0,cCt,2,2,"ng-container",27),O(1,lCt,2,1,"ng-template",null,32,mn)),2&r){const t=dn(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function fCt(r,e){if(1&r){const t=ge();P(0,"a",29),q("click",function(){return ee(t),te(p().navigateToPart())}),O(1,aCt,2,2,"ng-container",27),O(2,uCt,3,2,"ng-template",null,30,mn),S()}if(2&r){const t=dn(3),n=p();_(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function dCt(r,e){if(1&r&&(qt(0),V(1,"fa-icon",35),jt()),2&r){const t=p();_(1),y("icon",t.faSpinner)}}function hCt(r,e){if(1&r){const t=ge();qt(0),P(1,"div",10)(2,"a",37),rt(3),S(),P(4,"div",13)(5,"a",38),se(6,39),S(),P(7,"a",40),q("click",function(){return ee(t),te(p(2).logout())}),se(8,41),S()()(),jt()}if(2&r){const t=p(2);_(3),gn(t.username.get())}}Py=Ds,u(Ds,"roleToMessage",new Qt([{key:"Candidate",value:I9.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:I9.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:I9.YOU_ARE_ALREADY_CREATING},{key:"Player",value:I9.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:I9.YOU_ARE_ALREADY_OBSERVING}])),u(Ds,"\u0275fac",function(e){return new(e||Py)(Oe(A9),Oe(hu),Oe(ar))}),u(Ds,"\u0275prov",De({token:Py,factory:Py.\u0275fac,providedIn:"root"}));const gCt=function(){return["/register"]},pCt=function(){return["/login"]};function mCt(r,e){1&r&&(P(0,"div",42)(1,"a",43)(2,"strong"),se(3,44),S()(),P(4,"a",45),se(5,46),S()()),2&r&&(_(1),y("routerLink",Q1(2,gCt)),_(3),y("routerLink",Q1(3,pCt)))}function _Ct(r,e){if(1&r&&(O(0,hCt,9,1,"ng-container",27),O(1,mCt,6,4,"ng-template",null,36,mn)),2&r){const t=dn(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const P4e=function(){return["/"]},vCt=function(){return["/play"]},CCt=function(){return["/lobby"]},yCt=function(){return["/local"]},MCt=function(){return["/tutorial"]},ECt=function(){return["/settings"]};let PCt=(()=>{var r;class e{constructor(n,i,o,s){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",Dae),u(this,"faSpinner",h3e),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=o,this.userService=s}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return M(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return M(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(ar),U(Ds),U(hu))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,T,L,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,o=$localize`Join a game`,s=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,T=$localize`Log out`,L=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,o,["id","playOffline",1,"navbar-link"],s,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],T,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],L,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(P(0,"nav",0)(1,"div",1)(2,"a",2),V(3,"img",3),S(),P(4,"a",4),q("click",function(){return i.showMenu=!i.showMenu}),V(5,"span",5)(6,"span",5)(7,"span",5),S()(),P(8,"div",6),q("click",function(){return i.showMenu=!i.showMenu}),P(9,"div",7)(10,"a",8),se(11,9),S(),P(12,"div",10)(13,"a",11),se(14,12),S(),P(15,"div",13)(16,"a",2),se(17,14),S(),P(18,"a",2),se(19,15),S()()(),P(20,"div",10)(21,"a",16),se(22,17),S(),P(23,"div",13)(24,"a",18),se(25,19),S(),P(26,"a",20),se(27,21),S()()()(),P(28,"div",22),O(29,fCt,4,2,"a",23),P(30,"a",24),V(31,"fa-icon",25),S(),P(32,"div",26),O(33,dCt,2,1,"ng-container",27),O(34,_Ct,3,2,"ng-template",null,28,mn),S()()()()),2&n){const o=dn(35);_(2),y("routerLink",Q1(13,P4e)),_(2),y("ngClass",i.showMenu?"is-active":""),_(4),y("ngClass",i.showMenu?"is-active":""),_(2),y("routerLink",Q1(14,P4e)),_(6),y("routerLink",Q1(15,vCt)),_(2),y("routerLink",Q1(16,CCt)),_(6),y("routerLink",Q1(17,yCt)),_(2),y("routerLink",Q1(18,MCt)),_(3),y("ngIf",i.currentGame.isPresent()),_(1),y("routerLink",Q1(19,ECt)),_(1),y("icon",i.faCog),_(2),y("ngIf",i.loading)("ngIfElse",o)}},dependencies:[Lt,Tt,Fc,S0],encapsulation:2})),e})(),SCt=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",Bre),u(this,"faFacebook",zre),u(this,"faGithub",Gre),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(sy),U(vi))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(V(0,"app-header"),P(1,"main",0),V(2,"router-outlet"),S(),P(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),qs(7,3),V(8,"strong"),js(),S(),rt(9," \xa0 "),P(10,"a",4),V(11,"fa-icon",5),S(),rt(12,"\xa0 "),P(13,"a",6),V(14,"fa-icon",5),S(),rt(15,"\xa0 "),P(16,"a",7),V(17,"fa-icon",5),S()()()()),2&n&&(_(11),y("icon",i.faGithub),_(3),y("icon",i.faTwitter),_(3),y("icon",i.faFacebook))},dependencies:[VS,S0,PCt],encapsulation:2})),e})();function OCt(r,e){if(1&r){const t=ge();P(0,"div",26)(1,"div",27),q("click",function(){return ee(t),te(p().closeInfo())}),S(),P(2,"div",28)(3,"header",29)(4,"p",30),rt(5),S(),P(6,"button",31),q("click",function(){return ee(t),te(p().closeInfo())}),S()(),P(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),V(11,"img",35),S()(),P(12,"div",7)(13,"div",13),rt(14),S()()(),P(15,"div",6)(16,"div",33)(17,"a",36),q("click",function(){ee(t);const i=p();return te(i.createGame(i.gameInfoDetails.get().urlName))}),V(18,"fa-icon",37),rt(19,"\xa0"),P(20,"span"),se(21,38),S()()(),P(22,"div",33)(23,"a",36),q("click",function(){ee(t);const i=p();return te(i.createLocalGame(i.gameInfoDetails.get().urlName))}),V(24,"fa-icon",37),rt(25,"\xa0"),P(26,"span"),se(27,39),S()()(),P(28,"div",33)(29,"a",36),q("click",function(){ee(t);const i=p();return te(i.createTutorial(i.gameInfoDetails.get().urlName))}),V(30,"fa-icon",37),rt(31,"\xa0"),P(32,"span"),se(33,40),S()()()()()()()}if(2&r){const t=p();_(5),gn(t.gameInfoDetails.get().name),_(6),Ce("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",Tg),_(3),ni(" ",t.gameInfoDetails.get().description," "),_(4),y("icon",t.iconOnlineGame),_(6),y("icon",t.iconLocalGame),_(6),y("icon",t.iconTutorial)}}function TCt(r,e){if(1&r){const t=ge();P(0,"div",8)(1,"div",9)(2,"p",10),rt(3),S()(),P(4,"div",42)(5,"figure",34)(6,"img",43),q("click",function(){const o=ee(t).$implicit;return te(p(2).openInfo(o))}),S(),P(7,"figcaption",44),q("click",function(){const o=ee(t).$implicit;return te(p(2).openInfo(o))}),P(8,"div",45),rt(9,"?"),S()(),P(10,"figcaption",46)(11,"a",47),q("click",function(){const o=ee(t).$implicit;return te(p(2).createGame(o.urlName))}),V(12,"fa-icon",37),S(),P(13,"a",48),q("click",function(){const o=ee(t).$implicit;return te(p(2).createLocalGame(o.urlName))}),V(14,"fa-icon",37),S(),P(15,"a",49),q("click",function(){const o=ee(t).$implicit;return te(p(2).createTutorial(o.urlName))}),V(16,"fa-icon",37),S()()()(),P(17,"div",50),rt(18),S()()}if(2&r){const t=e.$implicit,n=p(2);_(3),gn(t.name),_(3),hn("id","image_",t.urlName,""),Ce("src","assets/images/",n.theme,"/",t.urlName,".png",Tg),_(5),hn("id","playOnline_",t.urlName,""),_(1),y("icon",n.iconOnlineGame),_(1),hn("id","playLocally_",t.urlName,""),_(1),y("icon",n.iconLocalGame),_(1),hn("id","startTutorial_",t.urlName,""),_(1),y("icon",n.iconTutorial),_(2),ni(" ",t.description," ")}}function bCt(r,e){if(1&r&&(P(0,"div",7),O(1,TCt,19,11,"div",41),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let wCt=(()=>{var r;class e{constructor(n,i,o,s){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",jae),u(this,"iconLocalGame",xR),u(this,"iconTutorial",Y3e),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=o,this.theme=s.getTheme();const a=Ft.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return M(function*(){const o=i.currentGameService.canUserCreate();return o.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(o.getReason()),!1)})()}createLocalGame(n){var i=this;return M(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(Ut),U(Ds),U(sy))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,T,L;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,o=$localize`Create an online game`,s=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,T=$localize`Play offline`,L=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],o,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],s,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",T,1,"button",3,"id","click"],["data-tooltip",L,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(P(0,"section",0)(1,"div",1)(2,"p",2),se(3,3),S(),P(4,"p",4),qs(5,5),V(6,"br"),js(),S()(),P(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),se(12,11),S()(),P(13,"div",12)(14,"div",13)(15,"button",14),q("click",function(){return i.createGame()}),se(16,15),S(),P(17,"button",16),se(18,17),S()()()()(),P(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),se(23,18),S()(),P(24,"div",12)(25,"div",19)(26,"button",20),se(27,21),S(),P(28,"button",22),se(29,23),S()()()()()(),O(30,OCt,34,7,"div",24),P(31,"div",6),O(32,bCt,2,1,"div",25),S()()),2&n&&(_(30),y("ngIf",i.gameInfoDetails.isPresent()),_(2),y("ngForOf",i.games))},dependencies:[Dt,Tt,Fc,S0],encapsulation:2})),e})();const NCt=["board"];let Y0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),Sy=(()=>{var r;class e extends Lte{constructor(n,i,o,s){super(n),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",W.NONE),u(this,"endGame",!1),u(this,"Player",k),this.connectedUserService=i,this.router=o,this.messageDisplayer=s}getMatchingComponent(n){return g.ofNullable(Ft.ALL_GAMES().find(o=>o.urlName===n)).map(o=>o.component)}createMatchingGameComponent(){var n=this;return M(function*(){const i=yield n.getMatchingComponentAndNavigateOutIfAbsent();if(i.isPresent()){const o=yield n.getConfig();return yield n.createGameComponent(i.get()),n.gameComponent.config=o,n.gameComponent.node=n.gameComponent.rules.getInitialNode(o),yield n.gameComponent.updateBoard(!1),!0}return!1})()}getMatchingComponentAndNavigateOutIfAbsent(){var n=this;return M(function*(){const i=n.getGameName(),o=n.getMatchingComponent(i);return o.isAbsent()?(yield n.router.navigate(["/notFound",Y0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),g.empty()):o})()}createGameComponent(n){var i=this;return M(function*(){H.assert(null!=i.boardRef,"Board element should be present");const o=H.getNonNullable(i.boardRef).createComponent(n);i.gameComponent=o.instance,i.gameComponent.chooseMove=s=>i.receiveValidMove(s),i.gameComponent.canUserPlay=s=>i.canUserPlay(s),i.gameComponent.isPlayerTurn=()=>i.isPlayerTurn(),i.gameComponent.cancelMoveOnWrapper=s=>i.onCancelMove(s),yield i.setRole(i.role)})()}setRole(n){var i=this;return M(function*(){i.role=n,i.gameComponent.setPointOfView(n===W.NONE?k.ZERO:n),yield i.updateBoardAndShowLastMove(!1)})()}receiveValidMove(n){var i=this;return M(function*(){const o=yield i.getConfig(),s=i.gameComponent.rules.isLegal(n,i.gameComponent.node.gameState,o);return s.isFailure()?(yield i.gameComponent.cancelMove(s.getReason()),w.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),w.SUCCESS)})()}getConfig(){var n=this;return M(function*(){const i=n.getGameName();return $L.getGameDefaultConfig(i)})()}canUserPlay(n){var i=this;return M(function*(){if(i.role===W.NONE){const o=Y0.CANNOT_PLAY_AS_OBSERVER();return w.failure(o)}return!1===i.isPlayerTurn()?w.failure(Y0.NOT_YOUR_TURN()):i.endGame?w.failure(Y0.GAME_HAS_ENDED()):w.SUCCESS})()}isPlayerTurn(){if(this.role===W.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,o=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(o)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(n){var i=this;return M(function*(){if(i.gameComponent.cancelMoveAttempt(),i.gameComponent.hideLastMove(),yield i.gameComponent.updateBoard(n),i.gameComponent.node.previousMove.isPresent()){const o=i.gameComponent.node.previousMove.get();yield i.gameComponent.showLastMove(o)}})()}getRulesConfigDescription(){const n=this.getGameName();return this.getRulesConfigDescriptionByName(n)}getRulesConfigDescriptionByName(n){const i=Ft.getByUrlName(n);return i.isAbsent()?g.empty():i.get().getRulesConfigDescription()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(_s),U(ar),U(Un),U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&F3(NCt,5,E2),2&n){let o;Ac(o=Ic())&&(i.boardRef=o.first)}},features:[Ge],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const ACt=["board"];let S4e=(()=>{var r;class e extends Sy{constructor(n,i,o,s,a){super(n,i,o,s),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}ngAfterViewInit(){var n=this;return M(function*(){window.setTimeout(M(function*(){yield n.createMatchingGameComponent(),n.gameComponent.node=n.demoNodeInfo.node,n.gameComponent.setInteractive(!0),yield n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(H.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges()),yield n.setRole(W.NONE)}),1)})()}ngOnChanges(n){var i=this;return M(function*(){null!=i.gameComponent&&(i.gameComponent.node=i.demoNodeInfo.node,yield i.gameComponent.updateBoard(!1),i.cdr.detectChanges())})()}getGameName(){return this.demoNodeInfo.name}onLegalUserMove(n,i){return M(function*(){H.assert(!1,"DemoCardWrapper should not call applyLegalMove, as it does no move")})()}getPlayer(){return"no-player"}onCancelMove(n){return M(function*(){})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(_s),U(ar),U(Un),U(Ut),U(xc))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&F3(ACt,5,E2),2&n){let o;Ac(o=Ic())&&(i.boardRef=o.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Ge,Do],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&V(0,"div",null,0)},encapsulation:2})),e})();function ICt(r,e){if(1&r&&(P(0,"div",17)(1,"figure",18),V(2,"app-demo-card",19),S()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function kCt(r,e){if(1&r&&(P(0,"div",20)(1,"figure",21),V(2,"app-demo-card",19),S()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function xCt(r,e){if(1&r&&(P(0,"div",12)(1,"div",13)(2,"p",14),rt(3),S()(),O(4,ICt,3,1,"div",15),O(5,kCt,3,1,"ng-template",null,16,mn),S()),2&r){const t=e.$implicit,n=dn(6),i=p(2);_(3),gn(t.name),_(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function LCt(r,e){if(1&r&&(P(0,"div",10),O(1,xCt,7,3,"div",11),S()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let RCt=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new Ys(5)),u(this,"squared",new Ys(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=Ft.ALL_GAMES();let o=0,s=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial,d=a.getRulesConfig();for(const m of f){const E=this.getNodeFromStep(m,l,d);c.push(E)}for(const m of c)s<n&&this.columns.push([]),this.columns[o].push({name:a.urlName,node:m.node,click:m.click}),s++,o=(o+1)%n}}getNodeFromStep(n,i,o){if(n.hasSolution()){const s=n.getSolution();if("string"==typeof s)return{node:new L2(n.state),click:g.of(s)};{const a=s,c=i.isLegal(a,n.state,o),l=i.applyLegalMove(a,n.state,o,c.get()),f=new L2(n.state);return{node:new L2(l,g.of(f),g.of(a)),click:g.empty()}}}return{node:new L2(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(P(0,"form")(1,"div",0)(2,"label",1),qt(3),se(4,2),jt(),P(5,"output"),rt(6),S()(),P(7,"div",3),V(8,"input",4),S()(),P(9,"div",0)(10,"label",5),V(11,"input",6),rt(12," \xa0"),qt(13),se(14,7),jt(),S()()(),P(15,"div",8),O(16,LCt,2,1,"div",9),S()),2&n&&(_(6),gn(i.numberOfColumns.value),_(2),y("formControl",i.numberOfColumns),_(3),y("formControl",i.squared),_(5),y("ngForOf",i.columns))},dependencies:[Dt,Tt,el,Va,Vp,wp,Rc,J4,hS,_f,S4e],encapsulation:2})),e})(),$R=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Vo))}),u(e,"\u0275dir",zt({type:r,selectors:[["","autofocus",""]]})),e})(),O4e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Vo))}),u(e,"\u0275dir",zt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function zCt(r,e){if(1&r&&(P(0,"div",29)(1,"div",30),se(2,31),S(),P(3,"div",32),rt(4),S()()),2&r){const t=p();_(4),gn(t.errorMessage)}}const DCt=function(){return["/register"]},HCt=function(){return["/reset-password"]};let VCt=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",lR),u(this,"errorMessage",void 0),u(this,"loginForm",new zc({email:new Ys,password:new Ys})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=M(function*(o){o!==N0.NOT_CONNECTED&&(yield n.redirect())});return function(o){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return M(function*(){const o=yield i.connectedUserService.doEmailLogin(n.email,n.password);o.isFailure()&&(i.errorMessage=o.getReason())})()}loginWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return M(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(ar))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,o=$localize`Password`,s=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",s,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"p",1),se(2,2),S(),P(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),S()(),P(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),S()()()(),P(12,"div",4)(13,"div",5)(14,"label",12),se(15,13),S()(),P(16,"div",8)(17,"div",9)(18,"div",14),V(19,"input",15),P(20,"span",16),V(21,"fa-icon",17),S()()()()(),P(22,"div",4),V(23,"div",5),P(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),q("click",function(){return i.loginWithEmail(i.loginForm.value)}),se(28,19),S()()()()(),P(29,"div",4),V(30,"div",5),P(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),q("click",function(){return i.loginWithGoogle()}),se(35,21),S()()()()(),O(36,zCt,5,1,"div",22),P(37,"p",23),qt(38),se(39,24),jt(),rt(40,"\xa0 "),P(41,"a",25),se(42,26),S()(),P(43,"p",23),qt(44),se(45,27),jt(),rt(46,"\xa0 "),P(47,"a",25),se(48,28),S()()()()),2&n&&(_(3),y("formGroup",i.loginForm),_(18),y("icon",i.faEye),_(6),y("disabled",!i.canLogin()),_(9),y("ngIf",i.errorMessage),_(5),y("routerLink",Q1(6,DCt)),_(6),y("routerLink",Q1(7,HCt)))},dependencies:[Tt,Fc,el,Va,Rc,J4,nl,tl,b6,S0,$R,O4e],encapsulation:2})),e})(),FCt=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new oC(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",I1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(x9))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),$Ct=(()=>{var r;class e{transform(n){return KG(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Ro({name:"firestoreTime",type:r,pure:!0})),e})();var Zu;const BCt=["chatDiv"];function UCt(r,e){1&r&&(qt(0),se(1,5),jt())}function WCt(r,e){1&r&&se(0,6),2&r&&(Hn(p().unreadMessagesText),Bn(0))}function qCt(r,e){if(1&r){const t=ge();P(0,"button",11),q("click",function(){return ee(t),te(p(2).scrollToBottom())}),rt(1),S()}if(2&r){const t=p(2);_(1),ni("",t.unreadMessagesText," \u2193")}}function jCt(r,e){if(1&r&&(P(0,"p"),rt(1),za(2,"firestoreTime"),P(3,"b",12),rt(4),S(),P(5,"span",13),rt(6),S()()),2&r){const t=e.$implicit;_(1),ni(" [",Nc(2,3,t.postedTime),"] "),_(3),ni("",t.sender.name," : "),_(2),gn(t.content)}}function ZCt(r,e){if(1&r){const t=ge();P(0,"div"),O(1,qCt,2,1,"button",7),P(2,"div",8,9),q("scroll",function(){return ee(t),te(p().updateCurrentScrollPosition())}),O(4,jCt,7,5,"p",10),S()()}if(2&r){const t=p();_(1),y("ngIf",t.showUnreadMessagesButton),_(3),y("ngForOf",t.chat)}}const YCt=function(){return{standalone:!0}};function KCt(r,e){if(1&r){const t=ge();P(0,"form",14),q("onSubmit",function(){return ee(t),te(p().sendMessage())}),P(1,"div",15)(2,"div",16)(3,"input",17,18),q("ngModelChange",function(i){return ee(t),te(p().userMessage=i)}),S(),P(5,"p",19),rt(6),S()(),P(7,"div",20)(8,"button",21),q("click",function(){return ee(t),te(p().sendMessage())}),V(9,"fa-icon",22),S()()(),P(10,"div",23)(11,"p")(12,"strong"),se(13,24),S()()()()}if(2&r){const t=dn(4),n=p();_(3),y("ngModel",n.userMessage)("ngModelOptions",Q1(4,YCt)),_(3),ni("",t.value.length,"/128"),_(3),y("icon",n.faReply)}}let Oy=(Zu=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",ZL),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){nn(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new oC(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return M(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(Zu,"\u0275fac",function(e){return new(e||Zu)(U(du),U(ar))}),u(Zu,"\u0275cmp",Fe({type:Zu,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&F3(BCt,5),2&e){let n;Ac(n=Ic())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(P(0,"div")(1,"button",0),q("click",function(){return t.switchChatVisibility()}),O(2,UCt,2,0,"ng-container",1),O(3,WCt,1,1,"ng-template",null,2,mn),S(),O(5,ZCt,5,2,"div",3),O(6,KCt,14,5,"form",4),S()),2&e){const n=dn(4);_(2),y("ngIf",t.visible)("ngIfElse",n),_(3),y("ngIf",t.visible),_(1),y("ngIf",t.visible)}},dependencies:[Dt,Tt,el,Va,Rc,J4,vS,vf,_f,S0,$Ct],encapsulation:2})),Zu);Oy=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],Oy);let T4e=(()=>{var r;class e{constructor(n,i,o){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=o}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(Ds),U(Ut))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(P(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),S(),P(1,"button",1),q("click",function(){return i.navigateToOnlineGameCreation()}),se(2,2),S()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[FL],encapsulation:2})),e})();var Yu;function QCt(r,e){if(1&r&&(qt(0),rt(1),jt()),2&r){const t=p().$implicit;_(1),gn(t.data.playerOne.name)}}function JCt(r,e){1&r&&(qt(0),se(1,27),jt())}function eyt(r,e){if(1&r){const t=ge();P(0,"tr",22),q("click",function(){const o=ee(t).$implicit;return te(p(2).joinGame(o))}),P(1,"td",23),rt(2),S(),P(3,"td",23),rt(4),S(),P(5,"td",23),O(6,QCt,2,1,"ng-container",24),O(7,JCt,2,0,"ng-template",null,25,mn),S(),P(9,"td",26),rt(10),S()()}if(2&r){const t=e.$implicit,n=e.index,i=dn(8);hn("id","part_",n,""),_(2),gn(t.data.typeGame),_(2),gn(t.data.playerZero.name),_(2),y("ngIf",t.data.playerOne)("ngIfElse",i),_(4),gn(t.data.turn+1)}}function tyt(r,e){if(1&r&&(P(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),se(6,17),S(),P(7,"th",16),se(8,18),S(),P(9,"th",16),se(10,19),S(),P(11,"th",16),se(12,20),S()()(),P(13,"tbody"),O(14,eyt,11,6,"tr",21),S()()()()),2&r){const t=p();_(14),y("ngForOf",t.activeParts)}}function nyt(r,e){1&r&&(P(0,"div",28),V(1,"app-online-game-selection",29),S())}function ryt(r,e){1&r&&(P(0,"div",30)(1,"div",31)(2,"div",32),V(3,"app-chat",33),S()()()),2&r&&(_(3),y("turn",-1))}let GR=(Yu=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return M(function*(){const n=e.id,i=e.data.typeGame,s=t.currentGameService.canUserJoin(n,null!=e.data.beginning);s.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(s.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(Yu,"\u0275fac",function(e){return new(e||Yu)(U(Un),U(Ut),U(FCt),U(Ds))}),u(Yu,"\u0275cmp",Fe({type:Yu,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,o,s,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,s=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,o,s,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(P(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),q("click",function(){return t.selectTab("games")}),se(4,3),S()(),P(5,"li",4)(6,"a",5),q("click",function(){return t.selectTab("create")}),se(7,6),S()(),P(8,"li",7)(9,"a",8),q("click",function(){return t.selectTab("chat")}),se(10,9),S()()()(),O(11,tyt,15,1,"div",10),O(12,nyt,2,0,"div",11),O(13,ryt,4,1,"div",12)),2&e&&(_(6),y("ngClass",t.createTabClasses),_(5),y("ngIf","games"===t.currentTab),_(1),y("ngIf","create"===t.currentTab),_(1),y("ngIf","chat"===t.currentTab))},dependencies:[Lt,Dt,Tt,Oy,T4e],encapsulation:2})),Yu);GR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],GR);let iyt=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(P(0,"div",0)(1,"p",1),se(2,2),S()(),P(3,"div",3)(4,"p",1),rt(5,"Resetting password"),S(),P(6,"div",4)(7,"p",5),se(8,6),S(),P(9,"button",7),se(10,8),S()()())},dependencies:[Fc],encapsulation:2})),e})(),b4e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(_s))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"div",1),se(2,2),S(),P(3,"div",3),rt(4),S()()),2&n&&(_(4),gn(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const ayt=new Error("request for lock canceled");class lyt{constructor(e,t=ayt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,o=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(o)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class fyt{constructor(e){this._semaphore=new lyt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let N4e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new it)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new it}onReceivedMove(){this.forbiddenRequests=new it,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){H.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var o=this;return M(function*(){switch(o.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(o.lastDeniedRequest=g.of(n.requestType),o.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:_R},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Kie},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:Ioe}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),hyt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of k.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(k.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(k.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=k.of(n.player),o=n.time,s=this.getMillisecondsElapsedSinceLastMoveStart(o);this.lastMoveStartTimestamp=g.of(o),this.takenGlobalTime[i.value]+=s,this.availableTurnTime[i.value]-=s;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return jte(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,o){if(this.updateClocks(),!1===n){const s=this.getMillisecondsElapsedSinceLastMoveStart(o);this.turnClocks[i.value].subtract(s),this.globalClocks[i.value].subtract(s),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of k.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Ch(r){return ei((e,t)=>{g2(r).subscribe(pr(t,()=>t.complete(),Hs)),!t.closed&&e.subscribe(t)})}function gyt(r,e){if(1&r&&(P(0,"option",12),rt(1),S()),2&r){const t=e.$implicit;y("value",t.name()),_(1),ni(" ",t.name()," ")}}function pyt(r,e){if(1&r&&(P(0,"div",24)(1,"div",25),rt(2),S()()),2&r){const t=p(2).$implicit,n=p(2);_(1),hn("id","",t,"_number_config_error"),_(1),gn(n.getErrorMessage(t))}}function myt(r,e){if(1&r&&(P(0,"div",17)(1,"div",18)(2,"div",19),V(3,"input",20),P(4,"span",21),V(5,"i",22),S()(),O(6,pyt,3,2,"div",23),S()()),2&r){const t=p().$implicit,n=p(2);_(3),hn("id","",t,"_number_config_input"),Kg("placeholder",n.rulesConfigDescription.getI18nName(t)),y("formControlName",t),_(3),y("ngIf",!1===n.isValid(t))}}function _yt(r,e){if(1&r&&(P(0,"div",17)(1,"div",18)(2,"div",26),V(3,"input",27),S()()()),2&r){const t=p().$implicit,n=p(2);_(3),hn("id","",t,"_boolean_config_input"),Kg("placeholder",n.rulesConfigDescription.getI18nName(t)),y("formControlName",t)}}function vyt(r,e){if(1&r&&(P(0,"div",13)(1,"div",14)(2,"label",15),rt(3),S()(),O(4,myt,7,4,"div",16),O(5,_yt,4,3,"div",16),S()),2&r){const t=e.$implicit,n=p(2);hn("id","",t,"_config"),_(3),gn(n.rulesConfigDescription.getI18nName(t)),_(1),y("ngIf",n.isNumber(t)),_(1),y("ngIf",n.isBoolean(t))}}function Cyt(r,e){1&r&&V(0,"app-demo-card",28),2&r&&y("demoNodeInfo",p(2).getConfigDemo())}function yyt(r,e){if(1&r){const t=ge();P(0,"div")(1,"p",1),se(2,2),S(),P(3,"div",3)(4,"select",4),q("change",function(i){return ee(t),te(p().onChange(i))}),P(5,"option",5),rt(6),S(),O(7,gyt,2,2,"option",6),P(8,"option",7),se(9,8),S()()(),P(10,"form",9)(11,"fieldset"),O(12,vyt,6,4,"div",10),S()(),O(13,Cyt,1,1,"app-demo-card",11),S()}if(2&r){const t=p();_(2),Hn(t.gameName),Bn(2),_(2),y("disabled",!1===t.userIsCreator),_(1),y("value",t.rulesConfigDescription.getDefaultConfig().name()),_(1),ni(" ",t.rulesConfigDescription.getDefaultConfig().name()," "),_(1),y("ngForOf",t.rulesConfigDescription.getNonDefaultStandardConfigs()),_(3),hn("id","",t.getChosenConfigName(),"_values"),y("formGroup",t.rulesConfigForm),_(2),y("ngForOf",t.getFields()),_(1),y("ngIf",void 0!==t.getConfigDemo())}}let A4e=(()=>{var r;class e extends Lte{constructor(n,i){super(n),u(this,"cdr",void 0),u(this,"stateProvider",void 0),u(this,"rulesConfigDescriptionOptional",void 0),u(this,"rulesConfigDescription",void 0),u(this,"rulesConfigToDisplay",void 0),u(this,"userIsCreator",void 0),u(this,"updateCallback",new _1),u(this,"configDemo",void 0),u(this,"rulesConfigForm",new zc({})),u(this,"gameName",void 0),u(this,"chosenConfigName",""),this.cdr=i}getChosenConfigName(){return this.chosenConfigName}ngOnInit(){if(this.assertParamsAreCoherent(),this.gameName=this.getGameName(),!this.isCustomisable())return this.updateCallback.emit(g.of({}));{const n=this.rulesConfigDescription.getDefaultConfig();if(this.setChosenConfig(n.name()),this.userIsCreator)this.setConfigDemo(n.config);else{const i=H.getNonNullable(this.rulesConfigToDisplay);this.setConfigDemo(i)}}}setConfigDemo(n){if(this.stateProvider.isPresent()){const i=this.stateProvider.get(),o=new L2(i(g.of(n)));this.configDemo={click:g.empty(),name:this.gameName,node:o},this.cdr.detectChanges()}}getConfigDemo(){return this.configDemo}generateForm(n,i){const o={};Object.keys(n).forEach(s=>{const a=this.getRulesConfigDescriptionValue(s,n[s]);o[s]=this.getFormControl(a,i)}),this.rulesConfigForm=new zc(o)}assertParamsAreCoherent(){!1===this.userIsCreator&&H.assert(null!=this.rulesConfigToDisplay,"Config should be provided to non-creator in RulesConfigurationComponent")}getRulesConfigDescriptionValue(n,i){return this.userIsCreator?i:H.getNonNullable(this.rulesConfigToDisplay)[n]}getFormControl(n,i){const o=new Ys(n);return!1===i&&o.disable(),o.valueChanges.subscribe(()=>{this.onUpdate()}),o}onUpdate(){H.assert(this.userIsCreator,"Only creator should be able to modify rules config"),H.assert("Custom"===this.chosenConfigName,"Only Customifiable config should be modified!");const n={},i=this.rulesConfigDescription.getFields();for(const o of i){if(!this.isValid(o))return void this.updateCallback.emit(g.empty());n[o]=this.rulesConfigForm.controls[o].value}this.setConfigDemo(n),this.updateCallback.emit(g.of(n))}isNumber(n){return"number"==typeof this.rulesConfigDescription.getDefaultConfig().config[n]}isBoolean(n){return"boolean"==typeof this.rulesConfigDescription.getDefaultConfig().config[n]}isValid(n){const o=this.rulesConfigDescription.getDefaultConfig().config[n];if("number"==typeof o){const s=this.rulesConfigForm.controls[n].value;return this.rulesConfigDescription.getValidator(n)(s).isSuccess()}return H.expectToBe(typeof o,"boolean"),!0}getErrorMessage(n){const i=this.rulesConfigForm.controls[n].value;return this.rulesConfigDescription.getValidator(n)(i).getReason()}getFields(){return this.rulesConfigDescription.getFields()}onChange(n){this.setChosenConfig(n.target.value)}setChosenConfig(n){let i;this.chosenConfigName=n,"Custom"===this.chosenConfigName?(i=this.rulesConfigDescription.getDefaultConfig().config,this.generateForm(i,this.userIsCreator)):(i=this.rulesConfigDescription.getConfig(this.chosenConfigName),this.generateForm(i,!1),this.updateCallback.emit(g.of(i))),this.setConfigDemo(i)}isCustomisable(){return!this.rulesConfigDescriptionOptional.isAbsent()&&(H.assert(this.rulesConfigDescriptionOptional.get().getFields().length>0,"If rulesConfigDescriptionOptional is present it should have fields !"),this.rulesConfigDescription=this.rulesConfigDescriptionOptional.get(),!0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(_s),U(xc))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-rules-configuration"]],inputs:{stateProvider:"stateProvider",rulesConfigDescriptionOptional:"rulesConfigDescriptionOptional",rulesConfigToDisplay:"rulesConfigToDisplay",userIsCreator:"userIsCreator"},outputs:{updateCallback:"updateCallback"},features:[Ge],decls:1,vars:1,consts:function(){let t,n;return t=$localize`Configuration of your ${"\ufffd0\ufffd"}:INTERPOLATION: game`,n=$localize`Custom`,[[4,"ngIf"],[1,"title"],t,[1,"select","is-primary","is-fullwidth"],["id","ruleSelect",3,"disabled","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["value","Custom"],n,[3,"formGroup","id"],["class","field is-horizontal",3,"id",4,"ngFor","ngForOf"],["id","demoCard",3,"demoNodeInfo",4,"ngIf"],[3,"value"],[1,"field","is-horizontal",3,"id"],[1,"field-label","is-normal"],[1,"label"],["class","field-body",4,"ngIf"],[1,"field-body"],[1,"field"],[1,"control","has-icons-right"],["type","number","required","",1,"input",3,"id","formControlName","placeholder"],[1,"icon","is-small","is-right"],[1,"fas","fa-exclamation-triangle"],["class","message is-danger","role","alert",4,"ngIf"],["role","alert",1,"message","is-danger"],[1,"message-header",3,"id"],[1,"control"],["type","checkbox","required","",1,"checkbox",3,"id","formControlName","placeholder"],["id","demoCard",3,"demoNodeInfo"]]},template:function(n,i){1&n&&O(0,yyt,14,9,"div",0),2&n&&y("ngIf",i.isCustomisable())},dependencies:[Dt,Tt,el,Q8,J8,Va,fS,wp,Rc,J4,nl,_S,tl,b6,S4e],encapsulation:2})),e})(),Myt=(()=>{var r;class e{transform(n){const i=n%60,o=(n-i)%3600/60,s=(n-60*o-i)/3600,a=[];if(s>1?a.push($localize`${s} hours`):1===s&&a.push($localize`1 hour`),o>1?a.push($localize`${o} minutes`):1===o&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Ro({name:"humanDuration",type:r,pure:!0})),e})();var D4,yh;const Pyt=["rulesConfigurationComponent"];function Syt(r,e){if(1&r&&(qt(0),rt(1),jt()),2&r){const t=p(3);_(1),gn(t.viewInfo.chosenOpponent)}}function Oyt(r,e){1&r&&se(0,45)}function Tyt(r,e){if(1&r&&(P(0,"div",46)(1,"div",8)(2,"label",47),qt(3),se(4,48),jt(),P(5,"output"),rt(6),za(7,"humanDuration"),S()(),P(8,"div",37),V(9,"input",49),S()(),P(10,"div",8)(11,"label",50),qs(12,51),V(13,"output"),za(14,"humanDuration"),js(),S(),P(15,"div",37),V(16,"input",52),S()()()),2&r){const t=p(3);_(6),gn(Nc(7,2,t.viewInfo.maximalMoveDuration||0)),_(8),Hn(Nc(14,4,t.viewInfo.totalPartDuration||0)),Bn(12)}}function byt(r,e){1&r&&(P(0,"div"),qs(1,53),V(2,"br"),js(),S())}function wyt(r,e){1&r&&(P(0,"button",65),se(1,66),S())}function Nyt(r,e){if(1&r){const t=ge();P(0,"tr",61),q("click",function(){const o=ee(t).$implicit;return te(p(4).selectOpponent(o))}),P(1,"td",62),rt(2),S(),P(3,"td",63),O(4,wyt,2,0,"button",64),S()()}if(2&r){const t=e.$implicit,n=p(4);hn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),_(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),_(1),gn(t),_(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function Ayt(r,e){if(1&r&&(qt(0),se(1,54),jt(),P(2,"div",55)(3,"table",56)(4,"thead")(5,"tr")(6,"th",57),se(7,58),S(),P(8,"th",57),se(9,59),S()()(),P(10,"tbody"),O(11,Nyt,5,5,"tr",60),S()()()),2&r){const t=p(3);_(11),y("ngForOf",t.viewInfo.candidates)}}function Iyt(r,e){if(1&r){const t=ge();P(0,"button",67),q("click",function(){return ee(t),te(p(3).changeConfig())}),se(1,68),S()}}function kyt(r,e){if(1&r){const t=ge();P(0,"div")(1,"h1",4),se(2,5),S(),P(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),se(7,10),S(),P(8,"div",11)(9,"button",12),q("click",function(){return ee(t),te(p(2).selectFirstPlayer("RANDOM"))}),se(10,13),S(),P(11,"button",14),q("click",function(){return ee(t),te(p(2).selectFirstPlayer("CREATOR"))}),se(12,15),S(),P(13,"button",16),q("click",function(){return ee(t),te(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),O(14,Syt,2,1,"ng-container",17),O(15,Oyt,1,0,"ng-template",null,18,mn),S()()(),P(17,"div",8)(18,"label",9),se(19,19),S(),P(20,"div",11)(21,"div",20),q("click",function(){return ee(t),te(p(2).selectPartType("STANDARD"))}),P(22,"div",21)(23,"span"),se(24,22),S()(),P(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),qt(29),se(30,26),jt(),P(31,"strong"),rt(32),za(33,"humanDuration"),S(),V(34,"br"),qt(35),qs(36,27),V(37,"strong"),za(38,"humanDuration"),js(),jt(),S()()()()(),P(39,"div",28),q("click",function(){return ee(t),te(p(2).selectPartType("BLITZ"))}),P(40,"div",21)(41,"span"),se(42,29),S()(),P(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),qt(47),se(48,30),jt(),P(49,"strong"),rt(50),za(51,"humanDuration"),S(),V(52,"br"),qt(53),qs(54,31),V(55,"strong"),za(56,"humanDuration"),js(),jt(),S()()()()(),P(57,"button",32),q("click",function(){return ee(t),te(p(2).selectPartType("CUSTOM"))}),se(58,33),S()()(),O(59,Tyt,17,6,"div",34),P(60,"div",8)(61,"label",35),se(62,36),S(),P(63,"div",37),O(64,byt,3,0,"div",17),O(65,Ayt,12,1,"ng-template",null,38,mn),S()(),P(67,"app-rules-configuration",39),q("updateCallback",function(i){return ee(t),te(p(2).saveRulesConfig(i))}),S()(),P(68,"div",8)(69,"div",11)(70,"button",40),q("click",function(){return ee(t),te(p(2).proposeConfig())}),se(71,41),S(),O(72,Iyt,2,0,"button",42),P(73,"button",43),q("click",function(){return ee(t),te(p(2).cancelGameCreation())}),se(74,44),S()()()()()}if(2&r){const t=dn(16),n=dn(66),i=p(2);_(3),y("formGroup",i.configFormGroup),_(1),y("disabled",!i.viewInfo.canEditConfig),_(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),_(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),_(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),_(11),gn(Nc(33,22,i.partType.NORMAL_MOVE_DURATION)),_(6),Hn(Nc(38,24,i.partType.NORMAL_PART_DURATION)),Bn(36),_(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),_(11),gn(Nc(51,26,i.partType.BLITZ_MOVE_DURATION)),_(6),Hn(Nc(56,28,i.partType.BLITZ_PART_DURATION)),Bn(54),_(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),_(2),y("ngIf",i.viewInfo.showCustomTime),_(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),_(3),y("stateProvider",i.getStateProvider())("rulesConfigDescriptionOptional",i.rulesConfigDescription)("userIsCreator",!0),_(3),y("disabled",!(i.viewInfo.canProposeConfig&&i.rulesConfig.isPresent())),_(2),y("ngIf",i.viewInfo.canReviewConfig)}}function xyt(r,e){if(1&r&&(P(0,"div",75)(1,"p"),qs(2,76),V(3,"br"),js(),S()()),2&r){const t=p(3);_(3),Hn(t.viewInfo.creator),Bn(2)}}function Lyt(r,e){if(1&r&&(P(0,"span"),se(1,83),S()),2&r){const t=p(4);_(1),Hn(t.viewInfo.creator),Bn(1)}}function Ryt(r,e){1&r&&(P(0,"span"),se(1,84),S())}function zyt(r,e){1&r&&(P(0,"span"),se(1,85),S())}function Dyt(r,e){if(1&r){const t=ge();P(0,"div",75)(1,"p"),se(2,77),S(),P(3,"ul")(4,"li"),O(5,Lyt,2,1,"span",2),O(6,Ryt,2,0,"span",2),O(7,zyt,2,0,"span",2),S(),P(8,"li"),qs(9,78),V(10,"strong"),za(11,"humanDuration"),js(),S(),P(12,"li"),qs(13,79),V(14,"strong"),za(15,"humanDuration"),js(),S()(),V(16,"app-rules-configuration",80),P(17,"button",81),q("click",function(){return ee(t),te(p(3).acceptConfig())}),se(18,82),S()()}if(2&r){const t=p(3);_(2),Hn(t.viewInfo.creator)(t.viewInfo.partTypeName),Bn(2),_(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),_(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),_(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),_(4),Hn(Nc(11,11,t.viewInfo.maximalMoveDuration||0)),Bn(9),_(4),Hn(Nc(15,13,t.viewInfo.totalPartDuration||0)),Bn(13),_(1),y("rulesConfigDescriptionOptional",t.rulesConfigDescription)("stateProvider",t.getStateProvider())("userIsCreator",!1)("rulesConfigToDisplay",null==t.currentConfigRoom?null:t.currentConfigRoom.rulesConfig)}}function Hyt(r,e){if(1&r&&(P(0,"div")(1,"div",69)(2,"div",70)(3,"p"),se(4,71),S()(),P(5,"div",72),O(6,xyt,4,1,"div",73),O(7,Dyt,19,15,"ng-template",null,74,mn),S()()()),2&r){const t=dn(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Vyt(r,e){if(1&r&&(qt(0),se(1,88),jt()),2&r){const t=p(3);_(1),Hn(t.viewInfo.creator),Bn(1)}}function Fyt(r,e){if(1&r&&se(0,89),2&r){const t=p(3);Hn(t.viewInfo.creator)(t.viewInfo.chosenOpponent),Bn(0)}}function $yt(r,e){if(1&r&&(P(0,"div",69)(1,"div",70)(2,"p"),se(3,86),S()(),P(4,"div",72)(5,"p"),O(6,Vyt,2,1,"ng-container",17),O(7,Fyt,1,2,"ng-template",null,87,mn),S()()()),2&r){const t=dn(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Gyt(r,e){if(1&r&&(P(0,"div",1),O(1,kyt,75,30,"div",2),O(2,Hyt,9,2,"div",2),O(3,$yt,9,2,"div",3),S()),2&r){const t=p();_(1),y("ngIf",t.viewInfo.userIsCreator),_(1),y("ngIf",t.viewInfo.userIsChosenOpponent),_(1),y("ngIf",t.viewInfo.userIsObserver)}}let BR=(yh=D4=class{constructor(e,t,n,i,o,s,a,c,l,f){u(this,"router",void 0),u(this,"activatedRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",cr),u(this,"partId",void 0),u(this,"rulesConfigDescription",void 0),u(this,"gameStartNotification",new _1),u(this,"rulesConfigurationComponent",void 0),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new Vs),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new On),u(this,"configRoomSubscription",new On),u(this,"candidatesSubscription",new On),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),u(this,"rulesConfig",g.empty()),this.router=e,this.activatedRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=o,this.configRoomService=s,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return M(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;H.assert(e.isPresent(),"PartCreationComponent should not be called without connected user"),H.assert(e.get()!==N0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),H.assert(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[$i.RANDOM.value,ff.required],maximalMoveDuration:[cr.NORMAL_MOVE_DURATION,ff.required],partType:["STANDARD",ff.required],totalPartDuration:[cr.NORMAL_PART_DURATION,ff.required],chosenOpponent:["",ff.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:this.getGameUrlName(),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:H.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=M(function*(o){yield e.onCurrentConfigRoomUpdate(o)});return function(s){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(o){yield e.onCandidatesUpdate(o)});return function(s){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return H.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Ch(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=H.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==Co.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Ch(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Ch(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Ch(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Ch(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=H.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===Co.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==Co.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==Co.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(cr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(cr.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(cr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(cr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return M(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return H.getNonNullable(t)}changeConfig(){var e=this;return M(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return M(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,o=e.getForm("firstPlayer").value,s=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,cr.of(n),i,$i.of(o),s,e.rulesConfig)})()}cancelGameCreation(){var e=this;return M(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),we.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),we.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),we.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),we.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return M(function*(){if(e.isAbsent())return we.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.rulesConfig.isAbsent()&&(t.rulesConfig=g.of(n.rulesConfig)),t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const o=H.getNonNullable(t.currentConfigRoom),s=H.getNonNullable(o.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${s} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(H.assert(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(we.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return M(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return M(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return H.assert(null!=e,"configRoom should not be null (isGameStarted)"),H.getNonNullable(e).partStatus===Co.PART_STARTED.value}onGameStarted(){const e=H.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return M(function*(){const t=H.getNonNullable(e.currentConfigRoom);H.assert(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),yh.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return M(function*(){const n=H.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return M(function*(){const t=e.isGameStarted(e.currentConfigRoom);H.assert(!1===t,"Should not try to cancelGameCreation when part started!"),H.assert(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return M(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(vi.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):jte(i.get(),t)>yh.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return M(function*(){const n=H.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return M(function*(){yield e.connectedUserService.sendPresenceToken(),H.assert(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},yh.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{H.assert(n.isPresent(),"connected user should exist"),e.lastToken=H.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,H.getNonNullable(this.currentConfigRoom))}saveRulesConfig(e){this.rulesConfig=e}getGameUrlName(){return H.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}getStateProvider(){const e=this.getGameUrlName(),t=Ft.getByUrlName(e).get().rules;return g.of(i=>t.getInitialState(i))}ngOnDestroy(){var e=this;return M(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?we.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?we.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(we.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(we.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(D4,"TOKEN_INTERVAL",5e3),u(D4,"TOKEN_TIMEOUT",1e4),u(D4,"\u0275fac",function(e){return new(e||D4)(U(Un),U(_s),U(ar),U(Ds),U(ju),U(dh),U(du),U(hu),U(hme),U(Ut))}),u(D4,"\u0275cmp",Fe({type:D4,selectors:[["app-part-creation"]],viewQuery:function(e,t){if(1&e&&F3(Pyt,5),2&e){let n;Ac(n=Ic())&&(t.rulesConfigurationComponent=n.first)}},inputs:{partId:"partId",rulesConfigDescription:"rulesConfigDescription"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m,E,T,L,z,G,B,de,ye,Le,tt,gt,Pn,Et,no,X0,e6,E3,Sh,Oh,ft,Ot,xt,kn;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,o=$localize`Standard`,s=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,E=$localize`Propose configuration`,T=$localize`Cancel game`,L=$localize`The opponent`,z=$localize`Maximal turn duration: `,G=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,B=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,ye=$localize`Name`,Le=$localize`Actions`,tt=$localize`Pick`,gt=$localize`Change configuration`,Pn=$localize`Configuration proposal`,Et=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,no=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,X0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,e6=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,E3=$localize`Accept and start`,Sh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,Oh=$localize`you play first`,ft=$localize`the first player is selected randomly`,Ot=$localize`One moment...`,xt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,kn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],o,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],s,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","rulesConfigurationComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],E,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],T,L,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],G,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],B,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ye,Le,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],tt,["id","reviewConfig",1,"button",3,"click"],gt,[1,"message","is-primary"],[1,"message-header"],Pn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Et,no,X0,e6,[3,"rulesConfigDescriptionOptional","stateProvider","userIsCreator","rulesConfigToDisplay"],["id","acceptConfig",1,"button","is-primary",3,"click"],E3,Sh,Oh,ft,Ot,["proposalSent",""],xt,kn]},template:function(e,t){1&e&&O(0,Gyt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Lt,Dt,Tt,el,Va,Vp,Rc,J4,tl,b6,A4e,Myt],encapsulation:2})),D4);var dc,K0;function Uyt(r,e){if(1&r){const t=ge();P(0,"button",3),q("click",function(){return ee(t),te(p().addTime())}),se(1,4),S()}if(2&r){const t=p();_(1),Hn(t.timeToAdd),Bn(1)}}BR=yh=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],BR);let UR=(K0=dc=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new _1),u(this,"addTimeToOpponent",new _1),u(this,"cssClasses",K0.SAFE_TIME)}setDuration(e){H.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){H.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){H.assert(this.isSet,"Should not start a chrono that has not been set!"),H.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){H.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){H.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),H.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){H.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?K0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?K0.DANGER_TIME_ODD:K0.DANGER_TIME_EVEN:K0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(dc,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(dc,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(dc,"PASSIVE_STYLE","has-text-passive is-italic"),u(dc,"SAFE_TIME",""),u(dc,"\u0275fac",function(e){return new(e||dc)}),u(dc,"\u0275cmp",Fe({type:dc,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(P(0,"div",0)(1,"p",1),rt(2),za(3,"number"),S(),O(4,Uyt,2,1,"button",2),S()),2&e&&(y("ngClass",t.getTimeClass()),_(2),zE("",t.displayedMinute,":",T$(3,4,t.displayedSec,"2.0-0"),""),_(2),y("ngIf",t.canAddTime))},dependencies:[Lt,Tt,uB],encapsulation:2})),dc);var Ku;UR=K0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],UR);const qyt=["chronoZeroGlobal"],jyt=["chronoOneGlobal"],Zyt=["chronoZeroTurn"],Yyt=["chronoOneTurn"];function Kyt(r,e){if(1&r){const t=ge();P(0,"app-part-creation",5,6),q("gameStartNotification",function(i){return ee(t),te(p().startGame(i))}),S()}if(2&r){const t=p();y("partId",t.currentPartId)("rulesConfigDescription",t.getRulesConfigDescription())}}function Xyt(r,e){1&r&&(qt(0),P(1,"span",39),se(2,40),S(),jt())}function Qyt(r,e){if(1&r&&(P(0,"span",41),se(1,42),S()),2&r){const t=p(4);_(1),Hn(null==t.currentPlayer?null:t.currentPlayer.name),Bn(1)}}function Jyt(r,e){if(1&r&&(P(0,"p",36),O(1,Xyt,3,0,"ng-container",37),O(2,Qyt,2,1,"ng-template",null,38,mn),S()),2&r){const t=dn(3),n=p(3);_(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function eMt(r,e){if(1&r&&(P(0,"div",32)(1,"p",33),se(2,34),S(),O(3,Jyt,4,2,"p",35),S()),2&r){const t=p(2);_(2),Hn(t.currentPart.getTurn()+1),Bn(2),_(1),y("ngIf",!1===t.endGame)}}function tMt(r,e){if(1&r&&(P(0,"p",43),rt(1),S()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),_(1),gn(t.players[0].get().name)}}function nMt(r,e){if(1&r&&(P(0,"p",44),se(1,45),S()),2&r){const t=p(2);_(1),Hn(t.gameComponent.scores.get()[0]),Bn(1)}}function rMt(r,e){if(1&r&&(P(0,"p",46),rt(1),S()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),_(1),gn(t.players[1].get().name)}}function iMt(r,e){if(1&r&&(P(0,"p",47),se(1,48),S()),2&r){const t=p(2);_(1),Hn(t.gameComponent.scores.get()[1]),Bn(1)}}function oMt(r,e){1&r&&(P(0,"div")(1,"p",50),se(2,51),S()())}function sMt(r,e){1&r&&(P(0,"p",55),se(1,56),S())}function aMt(r,e){1&r&&(P(0,"p",57),se(1,58),S())}function cMt(r,e){1&r&&(P(0,"p",59),se(1,60),S())}function lMt(r,e){if(1&r&&(P(0,"div"),O(1,sMt,2,0,"p",52),O(2,aMt,2,0,"p",53),O(3,cMt,2,0,"p",54),S()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function uMt(r,e){1&r&&(P(0,"p",64),se(1,65),S())}function fMt(r,e){1&r&&(P(0,"p",66),se(1,67),S())}function dMt(r,e){if(1&r&&(P(0,"p",68),se(1,69),S()),2&r){const t=p(4);_(1),Hn(t.currentPart.getWinner().get().name),Bn(1)}}function hMt(r,e){if(1&r&&(P(0,"div"),O(1,uMt,2,0,"p",61),O(2,fMt,2,0,"p",62),O(3,dMt,2,1,"p",63),S()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function gMt(r,e){if(1&r&&(P(0,"p",64),se(1,70),S()),2&r){const t=p(4);_(1),Hn(t.currentPart.getLoser().get().name),Bn(1)}}function pMt(r,e){1&r&&(P(0,"p",68),se(1,71),S())}function mMt(r,e){if(1&r&&(P(0,"p",68),se(1,72),S()),2&r){const t=p(4);_(1),Hn(t.currentPart.getLoser().get().name),Bn(1)}}function _Mt(r,e){if(1&r&&(P(0,"div"),O(1,gMt,2,1,"p",61),O(2,pMt,2,0,"p",63),O(3,mMt,2,1,"p",63),S()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function vMt(r,e){1&r&&(P(0,"p",74),se(1,75),S())}function CMt(r,e){if(1&r&&(P(0,"p",74),se(1,76),S()),2&r){const t=p(4);_(1),Hn(t.currentPart.getLoser().get().name),Bn(1)}}function yMt(r,e){if(1&r&&(P(0,"div"),O(1,vMt,2,0,"p",73),O(2,CMt,2,1,"p",73),S()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function MMt(r,e){if(1&r&&(P(0,"div",49),V(1,"hr"),O(2,oMt,3,0,"div",27),O(3,lMt,4,3,"div",27),O(4,hMt,4,3,"div",27),O(5,_Mt,4,3,"div",27),O(6,yMt,3,2,"div",27),S()),2&r){const t=p(2);_(2),y("ngIf",t.currentPart.isHardDraw()),_(1),y("ngIf",t.currentPart.isAgreedDraw()),_(1),y("ngIf",t.currentPart.isWin()),_(1),y("ngIf",t.currentPart.isTimeout()),_(1),y("ngIf",t.currentPart.isResign())}}function EMt(r,e){if(1&r){const t=ge();qt(0),P(1,"button",85),q("click",function(){const o=ee(t).$implicit;return te(p(4).propose(o))}),rt(2),V(3,"fa-icon",86),S(),jt()}if(2&r){const t=e.$implicit,n=p(4);_(1),hn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),_(1),ni("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),_(1),y("icon",n.requestInfos[t].icon)}}function PMt(r,e){if(1&r){const t=ge();qt(0),P(1,"button",80),q("click",function(){return ee(t),te(p(3).resign())}),se(2,81),S(),P(3,"button",82),q("click",function(){return ee(t),te(p(3).gameComponent.pass())}),se(4,83),S(),O(5,EMt,4,4,"ng-container",84),jt()}if(2&r){const t=p(3);_(1),y("disabled",!1===t.canResign()),_(2),y("disabled",!1===t.canPass()),_(2),y("ngForOf",t.allRequests)}}function SMt(r,e){if(1&r){const t=ge();P(0,"div",87)(1,"p"),rt(2),V(3,"fa-icon",86),S(),P(4,"button",88),q("click",function(){return ee(t),te(p(3).accept())}),se(5,89),S(),P(6,"button",90),q("click",function(){return ee(t),te(p(3).reject())}),se(7,91),S()()}if(2&r){const t=p(3);_(2),ni(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),_(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function OMt(r,e){if(1&r&&(P(0,"div",92)(1,"p")(2,"span"),qs(3,93),V(4,"fa-icon",86),js(),S()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),Hn(t.requestInfos[t.deniedRequest().get()].name()),Bn(3)}}function TMt(r,e){if(1&r&&(P(0,"div",94)(1,"p")(2,"span"),qs(3,95),V(4,"fa-icon",86),js(),S()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),Hn(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),Bn(3)}}function bMt(r,e){if(1&r&&(qt(0),O(1,PMt,6,3,"ng-container",37),O(2,SMt,8,2,"ng-template",null,77,mn),O(4,OMt,5,2,"div",78),O(5,TMt,5,2,"div",79),jt()),2&r){const t=dn(3),n=p(2);_(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),_(3),y("ngIf",n.deniedRequest().isPresent()),_(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function wMt(r,e){1&r&&(P(0,"button",96),se(1,97),S())}function NMt(r,e){if(1&r){const t=ge();P(0,"div",7)(1,"div",8)(2,"div",9),O(3,eMt,4,2,"div",10),P(4,"div",11),O(5,tMt,2,2,"p",12),O(6,nMt,2,1,"p",13),P(7,"app-count-down",14,15),q("outOfTimeAction",function(){ee(t);const i=p();return te(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return ee(t),te(p().addGlobalTime())}),S(),P(9,"app-count-down",16,17),q("outOfTimeAction",function(){ee(t);const i=p();return te(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return ee(t),te(p().addTurnTime())}),S()(),P(11,"p",18),se(12,19),S(),P(13,"div",11),O(14,rMt,2,2,"p",20),O(15,iMt,2,1,"p",21),P(16,"app-count-down",22,23),q("outOfTimeAction",function(){ee(t);const i=p();return te(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return ee(t),te(p().addGlobalTime())}),S(),P(18,"app-count-down",24,25),q("outOfTimeAction",function(){ee(t);const i=p();return te(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return ee(t),te(p().addTurnTime())}),S()(),V(20,"hr"),O(21,MMt,7,5,"div",26),O(22,bMt,6,4,"ng-container",27),O(23,wMt,2,0,"button",28),S()(),P(24,"div",29)(25,"div",30),V(26,"div",null,31),S()()()}if(2&r){const t=p();_(3),y("ngIf",null!==t.currentPart),_(2),y("ngIf",t.players[0].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(5),y("ngIf",t.players[1].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(3),y("ngIf",t.endGame&&null!==t.currentPart),_(1),y("ngIf",t.isPlaying()),_(1),y("ngIf",t.endGame),_(1),y("ngClass",t.getBoardHighlight())}}let AMt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),WR=(Ku=class extends Sy{constructor(e,t,n,i,o,s,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new On),u(this,"partSubscription",new On),u(this,"gameEventsSubscription",new On),u(this,"currentGameSubscription",new On),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",N4e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=o,this.userService=s,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return H.getNonNullable(this.activatedRoute.snapshot.paramMap.get("id"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return M(function*(){const t=e.getGameName();if(Ft.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=AMt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=Y0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return M(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=M(function*(n){n instanceof sl&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=M(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return M(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return M(function*(){H.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(M(function*(){const n=yield t.createMatchingGameComponent();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),H.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),H.assert(null!==t.gameComponent,"Game component should exist"),t.gameComponent.config=g.of(e.rulesConfig),yield t.startPart()}),2)})()}startPart(){var e=this;return M(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new nC(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=M(function*(i){H.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new nC(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return M(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();H.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new fyt,n=function(){var i=M(function*(o){yield t.runExclusive(M(function*(){const s=o.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const l=a+1===s;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c,e.role))&&(yield e.handleReply(c));break;default:H.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(s){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return M(function*(){switch(e.requestType){case"TakeBack":const n=k.of(e.player);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.getGameName();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return M(function*(){yield e.currentGameService.removeCurrentGame(),e.gameComponent.setInteractive(!1),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,o=n.gameComponent.getTurn(),s=n.gameComponent.encoder.decode(e.move),a=n.gameComponent.node.gameState,c=yield n.getConfig(),l=n.gameComponent.rules.isLegal(s,a,c),f="We received an incorrect db move: "+s.toString()+" at turn "+o+'because "'+l.getReasonOr("")+'"';H.assert(l.isSuccess(),f);const d=i.choose(n.gameComponent.node,s,c);if(H.assert(d.isSuccess(),"Chosen move should be legal after all checks, but it is not! Reason: "+d.getReasonOr("")),n.gameComponent.node=d.get(),n.role===W.NONE)yield n.updateBoardAndShowLastMove(t);else{const m=o%2!==n.role.value;yield n.updateBoardAndShowLastMove(m&&t)}n.setCurrentPlayerAccordingToCurrentTurn(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}setCurrentPlayerAccordingToCurrentTurn(){this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.setInteractive(this.currentPlayer.name===this.getPlayer().name)}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return M(function*(){const t=k.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.gameComponent.getCurrentPlayer()!==e&&(H.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.parent.get()),t.setCurrentPlayerAccordingToCurrentTurn();const n=0===t.gameComponent.getTurn();yield t.updateBoardAndShowLastMove(n)})()}canResign(){return H.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return H.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return H.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return H.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return H.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return H.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),H.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||H.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return H.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return M(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],H.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.setCurrentPlayerAccordingToCurrentTurn();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=o=>{H.assert(o.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return M(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(k.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(k.ONE),t=e.players[0]):yield e.setRole(W.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===W.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return M(function*(){if(!t.mustReply()){const n=t.gameComponent.node,i=t.gameComponent.rules,o=n.gameState,s=yield t.getConfig(),a=t.gameComponent.rules.isLegal(e,o,s);H.assert(a.isSuccess(),"onLegalUserMove called with an illegal move");const c=i.applyLegalMove(e,o,s,a.get()),l=new L2(c,g.of(n),g.of(e)),f=i.getGameStatus(l,s),d=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,d),t.updatePartWithStatusAndScores(f,t.gameComponent.scores)}t.gameComponent.message(Y0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return M(function*(){return e.isEndGame?e===_e.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(H.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return M(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return M(function*(){const i=H.getNonNullable(n.currentPart),o=n.players[0].get(),s=n.players[1].get();n.currentPart=e===k.ONE?i.setWinnerAndLoser(s,o):i.setWinnerAndLoser(o,s);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return M(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return M(function*(){if(!1===t.isPlaying())return;const n=H.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return M(function*(){H.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return H.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return M(function*(){H.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=H.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return H.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return M(function*(){H.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return H.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===k.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}ngOnDestroy(){var e=this;return M(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}getConfig(){var e=this;return M(function*(){return g.of(e.configRoom.rulesConfig)})()}},u(Ku,"\u0275fac",function(e){return new(e||Ku)(U(_s),U(ar),U(Un),U(Ut),U(Ds),U(hu),U(ju),U(Zx),U(hyt),U(N4e))}),u(Ku,"\u0275cmp",Fe({type:Ku,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(F3(qyt,5),F3(jyt,5),F3(Zyt,5),F3(Yyt,5)),2&e){let n;Ac(n=Ic())&&(t.chronoZeroGlobal=n.first),Ac(n=Ic())&&(t.chronoOneGlobal=n.first),Ac(n=Ic())&&(t.chronoZeroTurn=n.first),Ac(n=Ic())&&(t.chronoOneTurn=n.first)}},features:[Ge],decls:5,vars:4,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m,E,T,L,z,G,B,de,ye,Le,tt,gt,Pn;return r=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,T=$localize`You reached your time limit.`,L=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,G=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,B=$localize`Resign`,de=$localize`Pass a turn`,ye=$localize`Accept`,Le=$localize`Reject`,tt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,gt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,Pn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],s,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,E,T,L,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,G,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],B,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],ye,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Le,["id","requestRejected",1,"notification","is-danger"],tt,["id","requestAwaitingReply",1,"notification"],gt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Pn]},template:function(e,t){1&e&&(O(0,Kyt,2,2,"app-part-creation",0),O(1,NMt,28,25,"div",1),P(2,"div",2)(3,"div",3),V(4,"app-chat",4),S()()),2&e&&(y("ngIf",!1===t.gameStarted),_(1),y("ngIf",t.gameStarted),_(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Lt,Dt,Tt,Fc,S0,Oy,BR,UR],encapsulation:2})),Ku);var Xl,qR;function kMt(r,e){if(1&r&&(P(0,"option",28),rt(1),S()),2&r){const t=e.$implicit;y("value",t.name),_(1),gn(t.name)}}function xMt(r,e){if(1&r&&(P(0,"option",28),se(1,32),S()),2&r){const t=e.$implicit;y("value",t.name),_(1),Hn(t.name),Bn(1)}}function LMt(r,e){if(1&r){const t=ge();P(0,"select",29),q("ngModelChange",function(i){return ee(t),te(p(3).aiOptions[0]=i)})("change",function(){ee(t);const i=p(3);return te(i.updatePlayer(i.Player.ZERO))}),P(1,"option",30),se(2,31),S(),O(3,xMt,2,2,"option",19),S()}if(2&r){const t=p(3);y("ngModel",t.aiOptions[0]),_(3),y("ngForOf",t.availableAIOptions(0))}}function RMt(r,e){if(1&r&&(P(0,"p",33),se(1,34),S()),2&r){const t=p(3);_(1),Hn(t.gameComponent.scores.get()[0]),Bn(1)}}function zMt(r,e){if(1&r&&(P(0,"option",28),rt(1),S()),2&r){const t=e.$implicit;y("value",t.name),_(1),gn(t.name)}}function DMt(r,e){if(1&r&&(P(0,"option",28),se(1,37),S()),2&r){const t=e.$implicit;y("value",t.name),_(1),Hn(t.name),Bn(1)}}function HMt(r,e){if(1&r){const t=ge();P(0,"select",35),q("ngModelChange",function(i){return ee(t),te(p(3).aiOptions[1]=i)})("change",function(){ee(t);const i=p(3);return te(i.updatePlayer(i.Player.ONE))}),P(1,"option",30),se(2,36),S(),O(3,DMt,2,2,"option",19),S()}if(2&r){const t=p(3);y("ngModel",t.aiOptions[1]),_(3),y("ngForOf",t.availableAIOptions(1))}}function VMt(r,e){if(1&r&&(P(0,"p",38),se(1,39),S()),2&r){const t=p(3);_(1),Hn(t.gameComponent.scores.get()[1]),Bn(1)}}function FMt(r,e){if(1&r&&(P(0,"h4",43),rt(1),S()),2&r){const t=p(4);_(1),gn(t.winnerMessage.get())}}function $Mt(r,e){1&r&&(P(0,"h4",44),se(1,45),S())}function GMt(r,e){if(1&r&&(P(0,"div",40),O(1,FMt,2,1,"h4",41),O(2,$Mt,2,0,"h4",42),S()),2&r){const t=p(3);_(1),y("ngIf",t.winnerMessage.isPresent()),_(1),y("ngIf",t.winnerMessage.isAbsent())}}function BMt(r,e){if(1&r){const t=ge();P(0,"div",9)(1,"div",10)(2,"p",11),se(3,12),S()(),P(4,"div",13)(5,"div",14)(6,"div",15)(7,"select",16),q("change",function(){ee(t);const i=p(2);return te(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return ee(t),te(p(2).playerSelection[0]=i)}),P(8,"option",17),se(9,18),S(),O(10,kMt,2,2,"option",19),S()(),P(11,"div",15),O(12,LMt,4,2,"select",20),S(),O(13,RMt,2,1,"p",21),S(),P(14,"div",22)(15,"div",15)(16,"select",23),q("change",function(){ee(t);const i=p(2);return te(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return ee(t),te(p(2).playerSelection[1]=i)}),P(17,"option",17),se(18,24),S(),O(19,zMt,2,2,"option",19),S()(),P(20,"div",15),O(21,HMt,4,2,"select",25),S(),O(22,VMt,2,1,"p",26),S()(),O(23,GMt,3,2,"div",27),S()}if(2&r){const t=p(2);_(3),Hn(t.gameComponent.getTurn()+1),Bn(3),_(4),y("ngModel",t.playerSelection[0]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[0].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(3),y("ngModel",t.playerSelection[1]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[1].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(1),y("ngIf",t.endGame)}}function UMt(r,e){if(1&r){const t=ge();P(0,"button",52),q("click",function(){return ee(t),te(p(3).gameComponent.pass())}),se(1,53),S()}}function WMt(r,e){if(1&r){const t=ge();P(0,"button",54),q("click",function(){return ee(t),te(p(3).takeBack())}),se(1,55),S()}}function qMt(r,e){if(1&r&&(qt(0),rt(1),V(2,"br"),jt()),2&r){const t=e.$implicit,n=p(4);_(1),ni(" ",t.name+": "+t.getInfo(n.gameComponent.node,n.gameComponent.config)," ")}}function jMt(r,e){if(1&r&&(P(0,"div",56),O(1,qMt,3,1,"ng-container",57),rt(2),V(3,"br"),rt(4),V(5,"br"),S()),2&r){const t=p(3);_(1),y("ngForOf",t.gameComponent.availableAIs),_(1),ni(" Created ",t.getCreatedNodes()," nodes."),_(2),ni(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function ZMt(r,e){if(1&r){const t=ge();P(0,"div",46),O(1,UMt,2,0,"button",47),O(2,WMt,2,0,"button",48),P(3,"button",49),q("click",function(){return ee(t),te(p(2).restartGame())}),se(4,50),S(),O(5,jMt,6,3,"div",51),S()}if(2&r){const t=p(2);_(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),_(1),y("ngIf",t.canTakeBack()),_(3),y("ngIf",t.gameComponent.node.previousMove.isPresent()&&t.displayAIInfo())}}function YMt(r,e){if(1&r&&(P(0,"div")(1,"div",2)(2,"div",3),O(3,BMt,24,10,"div",4),O(4,ZMt,6,3,"div",5),S(),P(5,"div",6)(6,"div",7),V(7,"div",null,8),S()()()()),2&r){const t=p();_(3),y("ngIf",t.gameComponent),_(1),y("ngIf",t.gameComponent),_(1),y("ngClass",t.getBoardHighlight())}}function KMt(r,e){if(1&r){const t=ge();P(0,"div",58)(1,"app-rules-configuration",59),q("updateCallback",function(i){return ee(t),te(p().updateConfig(i))}),S(),P(2,"div",60)(3,"div",61)(4,"div",62)(5,"div",63)(6,"button",64),q("click",function(){return ee(t),te(p().markConfigAsFilled())}),se(7,65),S()()()()()()}if(2&r){const t=p();_(1),y("stateProvider",t.getStateProvider())("rulesConfigDescriptionOptional",t.getRulesConfigDescription())("userIsCreator",!0),_(5),y("disabled",t.rulesConfig.isAbsent())}}WR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],WR);let jR=(qR=Xl=class extends Sy{constructor(e,t,n,i,o){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiOptions",["none","none"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"displayAIMetrics",!1),u(this,"configIsSet",!1),u(this,"rulesConfig",g.empty()),u(this,"configBS",new xo(g.empty())),u(this,"configObs",this.configBS.asObservable()),this.cdr=o,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=k.ZERO,this.setDefaultRulesConfig()}setDefaultRulesConfig(){const e=this.getGameName();this.rulesConfig=$L.getGameDefaultConfig(e)}getCreatedNodes(){return Ite.createdNodes}getMinimaxTime(){return LDe.aiTime}ngAfterViewInit(){var e=this;window.setTimeout(M(function*(){(yield e.createMatchingGameComponent())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return M(function*(){t.players[e.value]=g.of(t.playerSelection[e.value]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?(t.gameComponent.setInteractive(!1),yield t.setRole(k.ONE)):(t.gameComponent.setInteractive(!0),yield t.setRole(k.ZERO)),yield t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=yield t.getConfig();t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e,n).get(),yield t.proposeAIToPlay()})()}updateBoard(e){var t=this;return M(function*(){yield t.updateBoardAndShowLastMove(e);const n=yield t.getConfig(),i=t.gameComponent.rules.getGameStatus(t.gameComponent.node,n);if(!0===i.isEndGame&&(t.endGame=!0,i.winner.isPlayer())){const o=$localize`Player ${i.winner.value+1}`,a=i.winner.getOpponent().value;t.winnerMessage=t.players[i.winner.value].equalsValue("human")?t.players[a].equalsValue("human")?g.of($localize`${o} won`):g.of($localize`You won`):t.players[a].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${t.players[i.winner.value].get()} (Player ${i.winner.value+1}) won`)}})()}proposeAIToPlay(){var e=this;return M(function*(){if(yield e.hasSelectedAI()){e.gameComponent.setInteractive(!1),yield e.updateBoard(!1);const t=e.getPlayingAI();t.isPresent()&&window.setTimeout(M(function*(){yield e.doAIMove(t.get().ai,t.get().options)}),qR.AI_TIMEOUT)}else e.gameComponent.setInteractive(!0),yield e.updateBoard(!1),e.cdr.detectChanges()})()}hasSelectedAI(){var e=this;return M(function*(){const t=yield e.getConfig();if(e.gameComponent.rules.getGameStatus(e.gameComponent.node,t).isEndGame)return!1;const n=e.gameComponent.getTurn()%2;return"human"!==e.playerSelection[n]})()}getPlayingAI(){const e=this.gameComponent.getTurn()%2,t=this.findAI(e);if(t.isPresent()){const n=t.get(),i=this.aiOptions[e];return g.ofNullable(n.availableOptions.find(s=>s.name===i)).map(s=>({ai:n,options:s}))}return g.empty()}findAI(e){return g.ofNullable(this.gameComponent.availableAIs.find(t=>this.players[e].equalsValue(t.name)))}getStateProvider(){const e=this.getGameName(),t=Ft.getByUrlName(e);return t.isPresent()?g.of(i=>t.get().rules.getInitialState(i)):g.empty()}doAIMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,o=yield n.getConfig(),s=i.getGameStatus(n.gameComponent.node,o);H.assert(s===_e.ONGOING,"AI should not try to play when game is over!");const a=e.chooseNextMove(n.gameComponent.node,t,o),c=i.choose(n.gameComponent.node,a,o);return c.isSuccess()?(n.gameComponent.node=c.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),yield n.proposeAIToPlay(),w.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),vi.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:e.name,move:a.toString(),reason:c.getReason()}))})()}availableAIOptions(e){return this.findAI(e).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.isAITurn()&&(H.assert(e.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.parent.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return M(function*(){const t=yield e.getConfig();e.gameComponent.node=e.gameComponent.rules.getInitialNode(t),e.gameComponent.hideLastMove(),yield e.gameComponent.updateBoard(!1),e.endGame=!1,e.winnerMessage=g.empty(),yield e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}getConfig(){var e=this;return M(function*(){let t=g.empty();const i=yield new Promise(o=>{t=g.of(e.configObs.subscribe(s=>{s.isPresent()&&o(s.get())}))});return t.get().unsubscribe(),g.of(i)})()}updateConfig(e){this.rulesConfig=e,e.isPresent()&&0===Object.keys(e.get()).length&&this.markConfigAsFilled()}isConfigSet(){return this.configIsSet}markConfigAsFilled(){this.configIsSet=!0,this.cdr.detectChanges(),this.configBS.next(this.rulesConfig)}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}},u(Xl,"AI_TIMEOUT",1),u(Xl,"\u0275fac",function(e){return new(e||Xl)(U(_s),U(ar),U(Un),U(Ut),U(xc))}),u(Xl,"\u0275cmp",Fe({type:Xl,selectors:[["app-local-game-wrapper"]],features:[Ge],decls:2,vars:2,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m,E;return r=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the options`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Pick the options`,a=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,E=$localize`Start with this config`,[[4,"ngIf"],["class","box",4,"ngIf"],[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["id","info","class","tile is-child box has-text-centered",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],n,i,["id","scoreZero",1,"block"],o,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],s,a,["id","scoreOne",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIInfo"],[4,"ngFor","ngForOf"],[1,"box"],["id","rulesConfigComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],[1,"field","is-horizontal"],[1,"field-body"],[1,"field"],[1,"control"],["id","startGameWithConfig",1,"button","is-primary","is-fullwidth",3,"disabled","click"],E]},template:function(e,t){1&e&&(O(0,YMt,9,3,"div",0),O(1,KMt,8,4,"div",1)),2&e&&(y("ngIf",t.isConfigSet()),_(1),y("ngIf",!1===t.isConfigSet()))},dependencies:[Lt,Dt,Tt,Q8,J8,Fp,Rc,vf,A4e],encapsulation:2,changeDetection:0})),Xl);jR=qR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],jR);let I4e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var Xu;function QMt(r,e){if(1&r&&(P(0,"div",21)(1,"div",22),se(2,23),S(),V(3,"div",24),S()),2&r){const t=p();_(3),y("innerHTML",t.currentReason.get(),A7)}}function JMt(r,e){if(1&r){const t=ge();P(0,"button",25),q("click",function(){return ee(t),te(p().retry())}),se(1,26),S()}}function eEt(r,e){1&r&&(qt(0),se(1,31),jt())}function tEt(r,e){1&r&&(qt(0),se(1,32),jt())}function nEt(r,e){if(1&r&&O(0,tEt,2,0,"ng-container",28),2&r){p();const t=dn(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function rEt(r,e){1&r&&(qt(0),se(1,33),jt())}function iEt(r,e){if(1&r){const t=ge();P(0,"button",27),q("click",function(){return ee(t),te(p().next())}),O(1,eEt,2,0,"ng-container",28),O(2,nEt,1,2,"ng-template",null,29,mn),O(4,rEt,2,0,"ng-template",null,30,mn),S()}if(2&r){const t=dn(3),n=p();_(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function oEt(r,e){if(1&r){const t=ge();P(0,"button",34),q("click",function(){return ee(t),te(p().start())}),se(1,35),S()}}function sEt(r,e){if(1&r){const t=ge();P(0,"button",36),q("click",function(){return ee(t),te(p().playLocally())}),se(1,37),S()}}function aEt(r,e){if(1&r){const t=ge();P(0,"button",38),q("click",function(){return ee(t),te(p().createGame())}),se(1,39),S()}}function cEt(r,e){if(1&r){const t=ge();P(0,"button",40),q("click",function(){return ee(t),te(p().showSolution())}),se(1,41),S()}}function lEt(r,e){if(1&r&&(qt(0),P(1,"option",43),rt(2),S(),jt()),2&r){const t=p(),n=t.index,i=t.$implicit;_(1),hn("id","step_",n,""),y("value",n),_(1),gn(i.title)}}function uEt(r,e){1&r&&(qt(0),rt(1,"v "),jt())}function fEt(r,e){1&r&&rt(0,"x ")}function dEt(r,e){if(1&r&&(P(0,"option",44),O(1,uEt,2,0,"ng-container",28),O(2,fEt,1,0,"ng-template",null,45,mn),P(4,"span",46),rt(5),S()()),2&r){const t=dn(3),n=p(),i=n.index,o=n.$implicit,s=p();y("value",i),_(1),y("ngIf",s.stepFinished[i])("ngIfElse",t),_(3),hn("id","step_",i,""),_(1),gn(o.title)}}function hEt(r,e){if(1&r&&(qt(0),O(1,lEt,3,3,"ng-container",28),O(2,dEt,6,5,"ng-template",null,42,mn),jt()),2&r){const t=e.index,n=dn(3),i=p();_(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let ZR=(Xu=class extends Sy{constructor(e,t,n,i,o){super(e,o,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return M(function*(){(yield e.createMatchingGameComponent())&&(yield e.start())})()}start(){var e=this;return M(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return M(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return M(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return M(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=g.empty(),t.gameComponent.node=new L2(n.state,void 0,n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.gameComponent.setInteractive(!1===n.isInformation()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=t.steps[t.stepIndex],i=yield t.getConfig(),o=t.gameComponent.rules.choose(t.gameComponent.node,e,i);if(H.assert(o.isSuccess(),"It should be impossible to call onLegalUserMove with an illegal move, but got "+o.getReasonOr("")),t.gameComponent.node=o.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),a=t.gameComponent.getState(),c=H.getNonNullable(n.predicate)(e,s,a);c.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(c.getReason())}else if(n.isAnyMove())we.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(a=>a.equals(e))?(we.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(we.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(s.getFailureMessage()))}else H.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return M(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return M(function*(){if(t.currentReason=g.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return w.failure(I4e.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,H.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),w.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?w.SUCCESS:w.failure(I4e.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return M(function*(){void 0!==e&&(t.currentReason=g.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return M(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=e.COMPLETED_TUTORIAL_MESSAGE,e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return M(function*(){const t=e.steps[e.stepIndex];H.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution(),o=yield e.getConfig();i instanceof yo?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i,o).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return M(function*(){const t=e.getGameName();yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return M(function*(){const t=e.getGameName();yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(Xu,"\u0275fac",function(e){return new(e||Xu)(U(_s),U(Un),U(Ut),U(xc),U(ar))}),u(Xu,"\u0275cmp",Fe({type:Xu,selectors:[["app-tutorial-game-wrapper"]],features:[Ge],decls:23,vars:15,consts:function(){let r,e,t,n,i,o,s,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,s=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],s,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(P(0,"div",0)(1,"div",1)(2,"div",2),V(3,"progress",3),P(4,"div",4)(5,"p",5),rt(6),S(),V(7,"p",6),S(),O(8,QMt,4,1,"div",7),P(9,"div",8),O(10,JMt,2,0,"button",9),O(11,iEt,6,2,"button",10),O(12,oEt,2,0,"button",11),O(13,sEt,2,0,"button",12),O(14,aEt,2,0,"button",13),O(15,cEt,2,0,"button",14),P(16,"div",15)(17,"select",16),q("change",function(i){return t.changeStep(i)}),O(18,hEt,4,2,"ng-container",17),S()()()()(),P(19,"div",18)(20,"div",19),V(21,"div",null,20),S()()()),2&e&&(_(3),A("value",t.successfulSteps)("max",t.getNumberOfSteps()),_(3),DE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),_(1),y("innerHTML",t.currentMessage,A7),_(1),y("ngIf",t.currentReason.isPresent()),_(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),_(1),y("ngIf",!1===t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),_(3),y("ngForOf",t.steps),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Lt,Dt,Tt,Q8,J8],encapsulation:2,changeDetection:0})),Xu);function gEt(r,e){if(1&r&&(P(0,"div",35)(1,"div",36),se(2,37),S(),P(3,"div",38),rt(4),S()()),2&r){const t=p();_(4),gn(t.errorMessage)}}ZR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([we.log],ZR);const pEt=function(){return["/login"]};let mEt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",lR),u(this,"errorMessage",void 0),u(this,"registrationForm",new zc({email:new Ys,username:new Ys,password:new Ys})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return M(function*(){const i=n.registrationForm.value.username,o=n.registrationForm.value.email,s=n.registrationForm.value.password;if(null==i||null==o||null==s)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,o,s);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ar),U(Un))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,T,L;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,o=$localize`A confirmation email will be sent to validate your account.`,s=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,T=$localize`Log in`,L=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],o,["for","username",1,"label"],s,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],T,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],L,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"p",1),se(2,2),S(),P(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),S()(),P(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),P(12,"p",12),se(13,13),S()()()()(),P(14,"div",4)(15,"div",5)(16,"label",14),se(17,15),S()(),P(18,"div",8)(19,"div",9)(20,"div",10),V(21,"input",16),S()()()(),P(22,"div",4)(23,"div",5)(24,"label",17),se(25,18),S()(),P(26,"div",8)(27,"div",9)(28,"div",19),V(29,"input",20),P(30,"span",21),V(31,"fa-icon",22),S(),P(32,"p",23),se(33,24),S()()()()(),P(34,"div",4),V(35,"div",5),P(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),q("click",function(){return i.registerWithEmail()}),se(40,26),S()()()()(),P(41,"div",4),V(42,"div",5),P(43,"div",27),O(44,gEt,5,1,"div",28),S()(),P(45,"div",4),V(46,"div",5),P(47,"div",8)(48,"button",29),q("click",function(){return i.registerWithGoogle()}),se(49,30),S()()(),P(50,"p",31),qt(51),se(52,32),jt(),rt(53,"\xa0 "),P(54,"a",33),se(55,34),S()()()()),2&n&&(_(3),y("formGroup",i.registrationForm),_(28),y("icon",i.faEye),_(1),y("ngClass",i.getPasswordHelpClass()),_(7),y("disabled",!i.canRegister()),_(5),y("ngIf",i.errorMessage),_(10),y("routerLink",Q1(6,pEt)))},dependencies:[Lt,Tt,Fc,el,Va,Rc,J4,nl,tl,b6,S0,$R,O4e],encapsulation:2})),e})(),_Et=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return M(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(P(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),S(),P(1,"button",1),q("click",function(){return i.playLocally()}),se(2,2),S()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[FL],encapsulation:2})),e})(),vEt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return M(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(P(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),S(),P(1,"button",1),q("click",function(){return i.launchTutorial()}),se(2,2),S()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[FL],encapsulation:2})),e})(),CEt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(P(0,"p"),se(1,0),S())},encapsulation:2})),e})();function yEt(r,e){1&r&&(P(0,"p",20),se(1,21),S())}function MEt(r,e){if(1&r){const t=ge();P(0,"div",7)(1,"p",8),se(2,9),S(),P(3,"div",10)(4,"p",11),se(5,12),S(),P(6,"button",13),q("click",function(){return ee(t),te(p().finalizeEmailVerification())}),se(7,14),S()(),P(8,"div",15)(9,"p",11),se(10,16),S(),P(11,"button",17),q("click",function(){return ee(t),te(p().sendEmailVerification())}),se(12,18),S()(),O(13,yEt,2,0,"p",19),S()}if(2&r){const t=p();_(2),Hn(t.emailAddress),Bn(2),_(11),y("ngIf",t.success)}}function EEt(r,e){if(1&r){const t=ge();P(0,"div",24)(1,"div",8),se(2,25),S(),P(3,"form",26)(4,"div",27)(5,"div",28),V(6,"input",29),S(),P(7,"div",28)(8,"button",30),q("click",function(){ee(t);const i=p(2);return te(i.pickUsername(i.usernameForm.value))}),se(9,31),S()()()()()}if(2&r){const t=p(2);_(3),y("formGroup",t.usernameForm)}}const PEt=function(){return["/lobby"]};function SEt(r,e){1&r&&(P(0,"div",32),qs(1,33),V(2,"a",34),js(),S()),2&r&&(_(2),y("routerLink",Q1(1,PEt)))}function OEt(r,e){if(1&r&&(qt(0),O(1,EEt,10,1,"div",22),O(2,SEt,3,2,"div",23),jt()),2&r){const t=p();_(1),y("ngIf",!t.success),_(1),y("ngIf",t.success)}}function TEt(r,e){if(1&r&&(P(0,"div",35)(1,"div",36),rt(2),S()()),2&r){const t=p();_(2),gn(t.errorMessage)}}let bEt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new zc({username:new Ys})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return M(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=M(function*(o){n.emailAddress=o.email.get(),o.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===o.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===o.verified&&(yield n.router.navigate(["/lobby"])))});return function(o){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return M(function*(){const o=yield i.connectedUserService.setUsername(n.username);o.isSuccess()?i.success=!0:i.errorMessage=o.getReason()})()}sendEmailVerification(){var n=this;return M(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return M(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ar),U(Un))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,o,s,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,o=$localize`Finalize email verification`,s=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],o,[1,"level-left"],s,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"div",1)(2,"div",2),se(3,3),S(),O(4,MEt,14,2,"div",4),O(5,OEt,3,2,"ng-container",5),S(),O(6,TEt,3,1,"div",6),S()),2&n&&(_(4),y("ngIf","send-email"===i.verificationType),_(1),y("ngIf","enter-username"===i.verificationType),_(1),y("ngIf",i.errorMessage))},dependencies:[Tt,Fc,el,Va,Rc,J4,nl,tl,b6],encapsulation:2})),e})();function wEt(r,e){1&r&&(P(0,"p",17),se(1,18),S())}function NEt(r,e){if(1&r&&(P(0,"div",19)(1,"div",20),se(2,21),S(),P(3,"div",22),rt(4),S()()),2&r){const t=p();_(4),gn(t.errorMessage.get())}}const AEt=function(){return{standalone:!0}};let IEt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return M(function*(){nn(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ar))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,o,s,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,o=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],o,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"p",1),se(2,2),S(),P(3,"div",3)(4,"div",4)(5,"label",5),se(6,6),S()(),P(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),q("ngModelChange",function(s){return i.email=s}),S(),P(11,"p",11),se(12,12),S(),O(13,wEt,2,0,"p",13),S()()()(),P(14,"button",14),q("click",function(){return i.resetPassword()}),se(15,15),S(),O(16,NEt,5,1,"div",16),S()),2&n&&(_(10),y("ngModel",i.email)("ngModelOptions",Q1(5,AEt)),_(3),y("ngIf",i.success),_(1),y("disabled",""===i.email),_(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[Tt,Va,Rc,nl,vf,$R],encapsulation:2})),e})();function kEt(r,e){if(1&r&&(P(0,"option",13),rt(1),S()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),_(1),ni(" ",t.name," ")}}function xEt(r,e){if(1&r&&(P(0,"option",13),rt(1),S()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),_(1),ni(" ",t.name," ")}}let LEt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(dre),U(sy))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(P(0,"div",0)(1,"p",1),se(2,2),S(),P(3,"div",3)(4,"label",4),se(5,5),S(),P(6,"div",6)(7,"div",7)(8,"select",8),q("change",function(s){return i.changeTheme(s)}),O(9,kEt,2,3,"option",9),S()()()(),P(10,"div",3)(11,"label",10),se(12,11),S(),P(13,"div",6)(14,"div",7)(15,"select",12),q("change",function(s){return i.changeLanguage(s)}),O(16,xEt,2,3,"option",9),S()()()()()),2&n&&(_(9),y("ngForOf",i.availableThemes),_(7),y("ngForOf",i.availableLanguages))},dependencies:[Dt,Q8,J8],encapsulation:2})),e})(),REt=(()=>{var r;class e{constructor(n,i,o,s,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=o,this.currentGameService=s,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return M(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return H.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return M(function*(){if(nn(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",Y0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const s=i.currentGameService.canUserCreate();if(s.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(s.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(Ft.ALL_GAMES().find(o=>o.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(_s),U(Un),U(ar),U(Ds),U(Ut),U(ju))}),u(e,"\u0275cmp",Fe({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(P(0,"p"),se(1,0),S())},encapsulation:2})),e})();const zEt=["app-hive-piece",""];function DEt(r,e){1&r&&(I(),V(0,"path",9))}function HEt(r,e){1&r&&(I(),V(0,"path",10))}function VEt(r,e){1&r&&(I(),V(0,"path",11))}function FEt(r,e){1&r&&(I(),V(0,"path",12))}function $Et(r,e){1&r&&(I(),V(0,"path",13))}let GEt=(()=>{var r;class e extends uC{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new v(0,0))}ngAfterContentChecked(){const n=new v(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const o=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(s=>s.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=o[0],this.isoPointsDark=o[1],this.isoPointsStroke=o[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Ge],attrs:zEt,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(I(),P(0,"g"),V(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(5,"g"),O(6,DEt,1,0,"path",4),O(7,HEt,1,0,"path",5),O(8,VEt,1,0,"path",6),O(9,FEt,1,0,"path",7),O(10,$Et,1,0,"path",8),S()()),2&n&&(A("transform",i.layerTransform),_(1),y("ngClass",i.pieceClass),A("points",i.isoPointsLight),_(1),y("ngClass",i.pieceClass),A("points",i.isoPointsDark),_(1),A("points",i.isoPointsStroke),_(1),y("ngClass",i.pieceClass),A("points",i.hexaPoints),_(1),A("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),_(1),y("ngIf","QueenBee"===i.piece.kind),_(1),y("ngIf","Beetle"===i.piece.kind),_(1),y("ngIf","Grasshopper"===i.piece.kind),_(1),y("ngIf","Spider"===i.piece.kind),_(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const BEt=["app-lodestone-lodestone",""];function UEt(r,e){if(1&r&&(I(),V(0,"polygon",4)),2&r){const t=e.$implicit,n=p();IE("id","lodestone_",n.lodestoneInfo.direction,"_",n.lodestoneInfo.orientation,"_",n.lodestoneInfo.owner.toString(),"_arrow_",t,""),y("ngClass",n.lodestoneInfo.movingClass),A("points","push"===n.lodestoneInfo.direction?n.TRIANGLE_OUT:n.TRIANGLE_IN)("transform",n.getArrowRotate(t))}}const WEt=function(){return[0,1,2,3]};let qEt=(()=>{var r;class e extends uC{constructor(){super(),u(this,"lodestoneInfo",void 0),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const n=.8*this.PIECE_RADIUS,i=.3*this.PIECE_RADIUS,o=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${n},0 ${i},${o} ${i},-${o}`,this.TRIANGLE_IN=`${i},0 ${n},${i} ${n},-${i}`}getArrowRotate(n){let i=90*n;return"diagonal"===this.lodestoneInfo.orientation&&(i+=45),"rotate("+i+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Fe({type:r,selectors:[["","app-lodestone-lodestone",""]],inputs:{lodestoneInfo:"lodestoneInfo"},features:[Ge],attrs:BEt,decls:4,vars:10,consts:[[1,"lodestone_wrapper"],["cx","0","cy","0",1,"lodestone_main_circle","base","black-fill",3,"id","ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","no-stroke",3,"id","ngClass"]],template:function(n,i){1&n&&(I(),P(0,"g",0),V(1,"circle",1)(2,"circle",2),O(3,UEt,1,7,"polygon",3),S()),2&n&&(A("transform",i.getSVGTranslate(i.SPACE_SIZE/2,i.SPACE_SIZE/2)),_(1),Hr("id","lodestone_",i.lodestoneInfo.direction,"_",i.lodestoneInfo.orientation,"_",i.lodestoneInfo.owner.toString(),""),y("ngClass",i.lodestoneInfo.selectedClass),A("r",i.PIECE_RADIUS),_(1),y("ngClass",i.getPlayerClass(i.lodestoneInfo.owner)),A("r",i.PIECE_RADIUS/4),_(1),y("ngForOf",Q1(9,WEt)))},dependencies:[Lt,Dt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var YR,KR,Mh;function ZEt(r,e){if(1&r&&(I(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessQueenComponent.HEPTAGON)}}function YEt(r,e){if(1&r&&(I(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function KEt(r,e){if(1&r&&(I(),V(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function XEt(r,e){if(1&r&&(qt(0),I(),V(1,"circle",6)(2,"circle",6)(3,"circle",6),jt()),2&r){const t=p();_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function QEt(r,e){if(1&r&&(I(),P(0,"g"),V(1,"circle",7)(2,"circle",7)(3,"circle",7),S()),2&r){const t=p();_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),A("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),A("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function JEt(r,e){if(1&r&&(I(),P(0,"g",8),V(1,"circle",9)(2,"circle",9)(3,"circle",9),S()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Ql{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",Ql),u(this,"MartianChessComponent",Rs),u(this,"horizontalDotsRadius",Rs.SPACE_SIZE/15)}}function tPt(r,e){if(1&r&&(I(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessDroneComponent.PENTAGON)}}function nPt(r,e){if(1&r&&(I(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function rPt(r,e){if(1&r&&(I(),V(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function iPt(r,e){if(1&r&&(qt(0),I(),V(1,"circle",6)(2,"circle",6),jt()),2&r){const t=p();_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function oPt(r,e){if(1&r&&(I(),P(0,"g",7),V(1,"circle",8)(2,"circle",8),S()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),A("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),A("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function sPt(r,e){if(1&r&&(I(),P(0,"g",7),V(1,"circle",9)(2,"circle",9),S()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}YR=Ql,u(Ql,"HEPTAGON",Rs.getRegularPolygon(7)),u(Ql,"EIGHT_POINTED_STAR",Rs.getNPointedStar(8,0)),u(Ql,"\u0275fac",function(e){return new(e||YR)}),u(Ql,"\u0275cmp",Fe({type:YR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,ZEt,1,3,"polygon",0),O(1,YEt,1,3,"polygon",0),O(2,KEt,1,5,"circle",1),O(3,XEt,4,9,"ng-container",2),O(4,QEt,4,9,"g",2),O(5,JEt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Jl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Rs),u(this,"MartianChessDroneComponent",Jl),u(this,"horizontalDotsRadius",Rs.SPACE_SIZE/15)}}function cPt(r,e){if(1&r&&(I(),V(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessPawnComponent.TRIANGLE)}}function lPt(r,e){if(1&r&&(I(),V(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function uPt(r,e){if(1&r&&(I(),V(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function fPt(r,e){if(1&r&&(I(),V(0,"circle",7)),2&r){const t=p();A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function dPt(r,e){if(1&r&&(I(),V(0,"circle",8)),2&r){const t=p();A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function hPt(r,e){if(1&r&&(I(),P(0,"g",9),V(1,"circle",10),S()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),A("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}KR=Jl,u(Jl,"FOUR_POINTED_STAR_VERTICAL",Rs.getNPointedStar(4,0)),u(Jl,"PENTAGON",Rs.getRegularPolygon(5)),u(Jl,"\u0275fac",function(e){return new(e||KR)}),u(Jl,"\u0275cmp",Fe({type:KR,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,tPt,1,3,"polygon",0),O(1,nPt,1,3,"polygon",0),O(2,rPt,1,5,"circle",1),O(3,iPt,3,6,"ng-container",2),O(4,oPt,3,7,"g",3),O(5,sPt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class hc{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Rs),u(this,"MartianChessPawnComponent",hc),u(this,"horizontalDotsRadius",Rs.SPACE_SIZE/15)}static getTriangle(){return Rs.getRegularPolygon(3,hc.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Rs.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?hc.TRIANGLE_Y_OFFSET:0}}Mh=hc,u(hc,"FOUR_POINTED_STAR_DIAGONAL",Rs.getNPointedStar(4,45)),u(hc,"TRIANGLE_Y_OFFSET",Mh.yOffsetForVerticalCentering()),u(hc,"TRIANGLE",Mh.getTriangle()),u(hc,"\u0275fac",function(e){return new(e||Mh)}),u(hc,"\u0275cmp",Fe({type:Mh,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,cPt,1,3,"polygon",0),O(1,lPt,1,3,"polygon",0),O(2,uPt,1,5,"circle",1),O(3,fPt,1,3,"circle",2),O(4,dPt,1,3,"circle",3),O(5,hPt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const gPt=["app-siam-orientation-arrow",""];function pPt(r,e){if(1&r){const t=ge();I(),P(0,"use",2),q("click",function(){const o=ee(t).$implicit;return te(p().selectMove(o))}),S()}if(2&r){const t=e.$implicit,n=p();hn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),A("transform",n.getOrientationTransform(t.landingOrientation))}}let mPt=(()=>{var r;class e extends uC{constructor(...n){super(...n),u(this,"orientations",void 0),u(this,"currentPlayer",void 0),u(this,"config",void 0),u(this,"moveEmitter",new _1)}getCurrentPlayerClass(){return this.getPlayerClass(this.currentPlayer)}getOrientationTransform(n){const i=this.config,o=Math.min(i.width,i.height)/5,a=this.SPACE_SIZE/40*o,c=.5*a;let l=new v(i.width/2,i.height/2);l=l.getNext(ve.LEFT,c),l=l.getNext(ve.UP,c),l=l.getNext(n,a-o),l=l.scale(this.SPACE_SIZE,this.SPACE_SIZE);const f=90*(n.toInt()-2);return[`translate(${l.x}, ${l.y})`,`scale(${a})`,`rotate(${f} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`].join(" ")}selectMove(n){this.moveEmitter.emit(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=K1(r)))(i||r)}}()),u(e,"\u0275cmp",Fe({type:r,selectors:[["","app-siam-orientation-arrow",""]],inputs:{orientations:"orientations",currentPlayer:"currentPlayer",config:"config"},outputs:{moveEmitter:"moveEmitter"},features:[Ge],attrs:gPt,decls:3,vars:1,consts:[["id","arrow","points","30 10, 30 50, 10 50, 50 90, 90 50, 70 50, 70 10"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(n,i){1&n&&(I(),P(0,"defs"),V(1,"polygon",0),S(),O(2,pPt,1,3,"use",1)),2&n&&(_(2),y("ngForOf",i.orientations))},dependencies:[Lt,Dt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var XR;function vPt(r,e){if(1&r&&(I(),V(0,"text",8)),2&r){const t=p();Hr("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,A7)}}function CPt(r,e){if(1&r&&(I(),V(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),A("points",t.getUpperHorizontalLine())}}function yPt(r,e){if(1&r&&(I(),P(0,"g"),V(1,"polyline",10)(2,"polyline",11),S()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),A("points",t.getMiddleHorizontalLine()),_(1),y("ngClass",t.pieceClasses),A("points",t.getLowerHorizontalLine())}}function MPt(r,e){if(1&r&&(I(),V(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),A("points",t.getLeftDiagonalLine())}}function EPt(r,e){if(1&r&&(I(),P(0,"g"),V(1,"polyline",13)(2,"polyline",14),S()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),A("points",t.getMiddleDiagonalLine()),_(1),y("ngClass",t.pieceClasses),A("points",t.getRighterDiagonalLine())}}function PPt(r,e){if(1&r&&(I(),V(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),A("points",t.getLeftVerticalLine())}}function SPt(r,e){if(1&r&&(I(),V(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),A("points",t.getMiddleVerticalLine())}}function OPt(r,e){if(1&r&&(I(),V(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),A("points",t.getRighterVerticalLine())}}class Eh{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,o=e,a=e-n,c=t,l=-n,f=t;return[new v(0,0),new v(o,0),new v(l,f),new v(a,c),new v(o,0+i),new v(l,f+i),new v(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],o=new Vt(-1*this.mode.offsetRatio*Gn.STROKE_WIDTH,Gn.STROKE_WIDTH),s=t.getNext(o),a=n.getNext(o);return[t,n,a,s]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],o=new Vt(-1*this.mode.offsetRatio*Gn.STROKE_WIDTH,Gn.STROKE_WIDTH);return[t.getNext(o,-1),n.getNext(o,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new Vt(0,Gn.STROKE_WIDTH),o=t.getNext(i,-1),s=n.getNext(i,-1);return this.mapCoordToPoints([o,s,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],o=new Vt(Gn.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],o=new Vt(Gn.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],o=new Vt(0,Gn.STROKE_WIDTH),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],o=new Vt(Gn.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],o=new Vt(Gn.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],s=new Vt(Gn.STROKE_WIDTH,-Gn.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(s,-1),c=n.getNext(s,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){nn(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}XR=Eh,u(Eh,"STROKE_OFFSET",Gn.STROKE_WIDTH/2),u(Eh,"\u0275fac",function(e){return new(e||XR)}),u(Eh,"\u0275cmp",Fe({type:XR,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(I(),V(0,"polyline",0),O(1,vPt,1,4,"text",1),O(2,CPt,1,2,"polyline",2),O(3,yPt,3,4,"g",3),O(4,MPt,1,2,"polyline",4),O(5,EPt,3,4,"g",3),O(6,PPt,1,2,"polyline",5),O(7,SPt,1,2,"polyline",6),O(8,OPt,1,2,"polyline",7)),2&e&&(Hr("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),A("points",t.get3DIsoSquarePoints()),_(1),y("ngIf",t.mustDisplayHeight),_(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Lt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const Ph_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let QR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return M(function*(){const i=yield new Promise(o=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var s=M(function*(a){return o(yield n.evaluateUserPermission(a))});return function(a){return s.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ar))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Qu=(()=>{var r;class e extends QR{static evaluateUserPermission(n,i){return M(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ar),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),JR=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return M(function*(){const o=yield i.currentGameService.getCurrentGame();if(o.isAbsent())return!0;const s=o.get();return n.params.id===s.id||i.router.parseUrl("/play/"+s.typeGame+"/"+s.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(Ds),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),TPt=(()=>{var r;class e extends QR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ar),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),bPt=(()=>{var r;class e extends QR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ar),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();!function Dhe(r,e,t){(function O7e(r,e,t){"string"!=typeof e&&(t=e,e=r[w1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),W8[e]=r,t&&(W8[e][w1.ExtraData]=t)})(r,e,t)}(vRe);const wPt=[{path:"login",component:VCt},{path:"lobby",component:GR,canActivate:[Qu]},{path:"account",component:iyt,canActivate:[Qu]},{path:"settings",component:LEt},{path:"register",component:mEt,canActivate:[bPt]},{path:"reset-password",component:IEt},{path:"notFound/:message",component:b4e},{path:"nextGameLoading",component:CEt,canActivate:[Qu]},{path:"verify-account",component:bEt,canActivate:[TPt]},{path:"play",component:T4e,canActivate:[Qu,JR]},{path:"play/:compo",component:REt,canActivate:[Qu,JR]},{path:"play/:compo/:id",component:WR,canActivate:[Qu,JR]},{path:"local",component:_Et},{path:"local/:compo",component:jR},{path:"tutorial",component:vEt},{path:"tutorial/:compo",component:ZR},{path:"",component:wCt},{path:"demo",component:RCt},{path:"**",component:b4e}];class ez{static app(){return function cTe(r,...e){return{ngModule:aTe,providers:[{provide:Vb,useFactory:sTe(r),multi:!0,deps:[u1,lo,Db,...e]}]}}(()=>lTe(Ph_firebaseConfig))}static firestore(){return function iRe(r,...e){return{ngModule:rRe,providers:[{provide:px,useFactory:eRe(r),multi:!0,deps:[u1,lo,Db,Hb,[new ds,UY],[new ds,sw],...e]}]}}(()=>{const e=fRe();e.toJSON();return e})}static auth(){return function ZNe(r,...e){return{ngModule:jNe,providers:[{provide:dA,useFactory:UNe(r),multi:!0,deps:[u1,lo,Db,Hb,[new ds,sw],...e]}]}}(()=>{const e=XNe();return e})}}let NPt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",Lo({type:r,bootstrap:[SCt]})),u(e,"\u0275inj",oo({providers:[ar,ju,Zx,dh,hu,du,sy,{provide:kc,useValue:hh.getLocale()}],imports:[ez.app(),ez.firestore(),ez.auth(),AB,Fme,lCe.forRoot(wPt,{useHash:!1}),pme,gme,fMe,uDe]})),e})();o8(e1e,function(){return[Lt,Dt,Tt,GEt]},[]),o8(A4,function(){return[Lt,Dt,Tt,qEt]},[]),o8(Rs,function(){return[Lt,Dt,Tt,Ql,Jl,hc]},[]),o8(ey,function(){return[Lt,Dt,Tt,mPt]},[]),o8(Gn,function(){return[Lt,Dt,Tt,Eh]},[]);var APt=j2(522);function k4e(){ope().bootstrapModule(NPt).catch(r=>console.error(r))}const x4e=hh.getLocale();"en"!==x4e?fetch("/assets/"+x4e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,APt.XJ)(r.translations),$localize.locale=r.locale,k4e()}).catch(function(r){console.log(r)}):k4e()},1:function(Ju,J0){!function(j2){"use strict";function Sn(dt,at){var Ht=Object.keys(dt);if(Object.getOwnPropertySymbols){var Rn=Object.getOwnPropertySymbols(dt);at&&(Rn=Rn.filter(function(Lr){return Object.getOwnPropertyDescriptor(dt,Lr).enumerable})),Ht.push.apply(Ht,Rn)}return Ht}function Z2(dt){for(var at,Ht=1;Ht<arguments.length;Ht++)at=null==arguments[Ht]?{}:arguments[Ht],Ht%2?Sn(Object(at),!0).forEach(function(Rn){n6(dt,Rn,at[Rn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(dt,Object.getOwnPropertyDescriptors(at)):Sn(Object(at)).forEach(function(Rn){Object.defineProperty(dt,Rn,Object.getOwnPropertyDescriptor(at,Rn))});return dt}function S3(dt,at){if(!(dt instanceof at))throw new TypeError("Cannot call a class as a function")}function O3(dt,at){for(var Ht,Rn=0;Rn<at.length;Rn++)(Ht=at[Rn]).enumerable=Ht.enumerable||!1,Ht.configurable=!0,"value"in Ht&&(Ht.writable=!0),Object.defineProperty(dt,Ht.key,Ht)}function On(dt,at,Ht){return at&&O3(dt.prototype,at),Ht&&O3(dt,Ht),dt}function n6(dt,at,Ht){return at in dt?Object.defineProperty(dt,at,{value:Ht,enumerable:!0,configurable:!0,writable:!0}):dt[at]=Ht,dt}function T3(){var dt;return null!==(dt=e8)&&void 0!==dt?dt:document}var r6={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Hs=Z2({},r6),Y2={},e8=null,e7=function(dt,at,Ht,Rn,Lr){return"top-left"===dt?"left:".concat(Rn,";top:").concat(at,";text-align:left;align-items:flex-start;"):"top-right"===dt?"right:".concat(Lr,";top:").concat(at,";text-align:right;align-items:flex-end;"):"top-center"===dt?"top:".concat(at,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===dt?"left:".concat(Rn,";bottom:").concat(Ht,";text-align:left;align-items:flex-start;"):"bottom-right"===dt?"right:".concat(Lr,";bottom:").concat(Ht,";text-align:right;align-items:flex-end;"):"bottom-center"===dt?"bottom:".concat(Ht,";left:0;right:0;text-align:center;align-items:center;"):"center"===dt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},i6=function(){function dt(at){var Ht=this;S3(this,dt),this.element=T3().createElement("div"),this.opacity=at.opacity,this.type=at.type,this.animate=at.animate,this.dismissible=at.dismissible,this.closeOnClick=at.closeOnClick,this.message=at.message,this.duration=at.duration,this.pauseOnHover=at.pauseOnHover,this.offsetTop=at.offsetTop,this.offsetBottom=at.offsetBottom,this.offsetLeft=at.offsetLeft,this.offsetRight=at.offsetRight,this.extraClasses=at.extraClasses;var Rn="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Lr=["notification",this.extraClasses];if(this.type&&Lr.push(this.type),this.animate&&this.animate.in){var w3="animate__".concat(this.animate.in),ko=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Lr.push("animate__animated ".concat(w3," ").concat(ko)),this.onAnimationEnd(function(){return Ht.element.classList.remove(w3)})}if(this.element.className=Lr.join(" "),this.dismissible){var ro=T3().createElement("button");ro.className="delete",ro.addEventListener("click",function(){Ht.destroy()}),this.element.insertAdjacentElement("afterbegin",ro)}else Rn+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Ht.destroy()}),this.element.setAttribute("style",Rn),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var o6=new wa(function(){Ht.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){o6.pause()}),this.element.addEventListener("mouseout",function(){o6.resume()}))}return On(dt,[{key:"destroy",value:function(){var at=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){at.removeParent(at.element.parentNode),at.element.remove(),delete Y2.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Y2.position)}},{key:"removeParent",value:function(at){at&&1>=at.children.length&&at.remove()}},{key:"onAnimationEnd",value:function(){var at=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Ht={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var Rn in Ht)if(void 0!==this.element.style[Rn]){this.element.addEventListener(Ht[Rn],function(){return at()});break}}}]),dt}(),wa=function(){function dt(at,Ht){S3(this,dt),this.remaining=Ht,this.callback=at,this.resume()}return On(dt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),dt}();j2.resetDefaults=function(){Hs=Z2({},r6)},j2.setDefaults=function(dt){Hs=Z2(Z2({},r6),dt)},j2.setDoc=function gc(dt){for(var at in Y2)Y2[at].remove();Y2={},e8=dt},j2.toast=function H4(dt){if(!dt.message)throw new Error("message is required");var at=Z2(Z2({},Hs),dt),Ht=new i6(at),Rn=function b3(dt,at,Ht,Rn,Lr,w3){if(Y2.position)return Y2.position;var ko=T3().createElement("div");return ko.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+e7(at,Ht,Rn,Lr,w3)),dt.appendChild(ko),Y2.position=ko,ko}(at.appendTo||T3().body,at.position||Hs.position,at.offsetTop||Hs.offsetTop,at.offsetBottom||Hs.offsetBottom,at.offsetLeft||Hs.offsetLeft,at.offsetRight||Hs.offsetRight);if(at.single)for(var Lr=Rn.lastElementChild;Lr;)Rn.removeChild(Lr),Lr=Rn.lastElementChild;Rn.appendChild(Ht.element)},Object.defineProperty(j2,"__esModule",{value:!0})}(J0)},522:(Ju,J0,j2)=>{"use strict";j2.d(J0,{XJ:()=>i7,pQ:()=>s7});const Sn=":",Z2="|",S3="@@",O3="\u241f";class On{static zero(){return new On([0])}static one(){return new On([1])}constructor(ie){this.digits=ie}clone(){return new On(this.digits.slice())}add(ie){const me=this.clone();return me.addToSelf(ie),me}addToSelf(ie){const me=Math.max(this.digits.length,ie.digits.length);let Se=0;for(let Ye=0;Ye<me;Ye++){let ct=Se;Ye<this.digits.length&&(ct+=this.digits[Ye]),Ye<ie.digits.length&&(ct+=ie.digits[Ye]),ct>=10?(this.digits[Ye]=ct-10,Se=1):(this.digits[Ye]=ct,Se=0)}Se>0&&(this.digits[me]=1)}toString(){let ie="";for(let me=this.digits.length-1;me>=0;me--)ie+=this.digits[me];return ie}}class n6{constructor(ie){this.powerOfTwos=[ie]}getValue(){return this.powerOfTwos[0]}multiplyBy(ie){const me=On.zero();return this.multiplyByAndAddTo(ie,me),me}multiplyByAndAddTo(ie,me){for(let Se=0;0!==ie;ie>>>=1,Se++)if(1&ie){const Ye=this.getMultipliedByPowerOfTwo(Se);me.addToSelf(Ye)}}getMultipliedByPowerOfTwo(ie){for(let me=this.powerOfTwos.length;me<=ie;me++){const Se=this.powerOfTwos[me-1];this.powerOfTwos[me]=Se.add(Se)}return this.powerOfTwos[ie]}}class T3{constructor(ie){this.base=ie,this.exponents=[new n6(On.one())]}toThePowerOf(ie){for(let me=this.exponents.length;me<=ie;me++){const Se=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new n6(Se)}return this.exponents[ie]}}let b3;function Ht(ae){b3??=new TextEncoder;const ie=b3.encode(ae),me=new DataView(ie.buffer,ie.byteOffset,ie.byteLength);let Se=Lr(me,ie.length,0),Ye=Lr(me,ie.length,102072);return 0==Se&&(0==Ye||1==Ye)&&(Se^=319790063,Ye^=-1801410264),[Se,Ye]}function Lr(ae,ie,me){let Se=2654435769,Ye=2654435769,ct=0;const ui=ie-12;for(;ct<=ui;ct+=12){Se+=ae.getUint32(ct,!0),Ye+=ae.getUint32(ct+4,!0);const n1=w3(Se,Ye,me+=ae.getUint32(ct+8,!0));Se=n1[0],Ye=n1[1],me=n1[2]}const t1=ie-ct;return me+=ie,t1>=4?(Se+=ae.getUint32(ct,!0),ct+=4,t1>=8?(Ye+=ae.getUint32(ct,!0),ct+=4,t1>=9&&(me+=ae.getUint8(ct++)<<8),t1>=10&&(me+=ae.getUint8(ct++)<<16),11===t1&&(me+=ae.getUint8(ct++)<<24)):(t1>=5&&(Ye+=ae.getUint8(ct++)),t1>=6&&(Ye+=ae.getUint8(ct++)<<8),7===t1&&(Ye+=ae.getUint8(ct++)<<16))):(t1>=1&&(Se+=ae.getUint8(ct++)),t1>=2&&(Se+=ae.getUint8(ct++)<<8),3===t1&&(Se+=ae.getUint8(ct++)<<16)),w3(Se,Ye,me)[2]}function w3(ae,ie,me){return ae-=ie,ae-=me,ie-=me,ie-=ae^=me>>>13,me-=ae,me-=ie^=ae<<8,ae-=ie,ae-=me^=ie>>>13,ie-=me,ie-=ae^=me>>>12,me-=ae,me-=ie^=ae<<16,ae-=ie,ae-=me^=ie>>>5,ie-=me,ie-=ae^=me>>>3,me-=ae,me-=ie^=ae<<10,[ae,ie,me^=ie>>>15]}function ro(ae,ie){return o6(ae,ie)[1]}function o6(ae,ie){const me=(65535&ae)+(65535&ie),Se=(ae>>>16)+(ie>>>16)+(me>>>16);return[Se>>>16,Se<<16|65535&me]}const O1=new T3(256);function by(ae,ie,me,Se,Ye=[]){const ct={},ui={},t1={},n1=function wy(ae,ie){const{text:me,block:Se}=Vs(ae,ie);if(void 0===Se)return{text:me};{const[Ye,...ct]=Se.split(O3),[ui,t1]=Ye.split(S3,2);let[n1,Ai]=ui.split(Z2,2);return void 0===Ai&&(Ai=n1,n1=void 0),""===Ai&&(Ai=void 0),{text:me,meaning:n1,description:Ai,customId:t1,legacyIds:ct}}}(ae[0],ae.raw[0]),Ai=[n1.text],V4=[];let s6=n1.text;for(let h2=1;h2<ae.length;h2++){const{messagePart:a6,placeholderName:ti=Nh(h2),associatedMessageId:c6}=Ny(ae[h2],ae.raw[h2]);s6+=`{$${ti}}${a6}`,void 0!==ie&&(ct[ti]=ie[h2-1],ui[ti]=Ye[h2-1]),V4.push(ti),void 0!==c6&&(t1[ti]=c6),Ai.push(a6)}const d2=n1.customId||function Rn(ae,ie=""){let me=Ht(ae);if(ie){const ct=Ht(ie);me=function t7(ae,ie){const me=ae[0],Ye=ie[0],ui=o6(ae[1],ie[1]),t1=ui[0],n1=ui[1];return[ro(ro(me,Ye),t1),n1]}(function r7(ae,ie){const me=ae[0],Se=ae[1];return[me<<ie|Se>>>32-ie,Se<<ie|me>>>32-ie]}(me,1),ct)}return function wh(ae,ie){const me=O1.toThePowerOf(0).multiplyBy(ie);return O1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}(s6,n1.meaning||""),n8=n1.legacyIds?n1.legacyIds.filter(h2=>h2!==d2):[];return{id:d2,legacyIds:n8,substitutions:ct,substitutionLocations:ui,text:s6,customId:n1.customId,meaning:n1.meaning||"",description:n1.description||"",messageParts:Ai,messagePartLocations:Se,placeholderNames:V4,associatedMessageIds:t1,location:me}}function Ny(ae,ie){const{text:me,block:Se}=Vs(ae,ie);if(void 0===Se)return{messagePart:me};{const[Ye,ct]=Se.split(S3);return{messagePart:me,placeholderName:Ye,associatedMessageId:ct}}}function Vs(ae,ie){if(ie.charAt(0)!==Sn)return{text:ae};{const me=xo(ae,ie);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function Nh(ae){return 1===ae?"PH":"PH_"+(ae-1)}function xo(ae,ie){for(let me=1,Se=1;me<ae.length;me++,Se++)if("\\"===ie[Se])Se++;else if(ae[me]===Sn)return me;throw new Error(`Unterminated $localize metadata block in "${ie}".`)}class Ah extends Error{constructor(ie){super(`No translation found for ${Ih(ie)}.`),this.parsedMessage=ie,this.type="MissingTranslationError"}}function t8(ae,ie){return Object.defineProperty(ae,"raw",{value:ie}),ae}function Ih(ae){const ie=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Se=>`"${Se}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${ie})`}function i7(ae){$localize.translate||($localize.translate=Iy),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(ie=>{$localize.TRANSLATIONS[ie]=function Ay(ae){const ie=ae.split(/{\$([^}]*)}/),me=[ie[0]],Se=[];for(let ct=1;ct<ie.length-1;ct+=2)Se.push(ie[ct]),me.push(`${ie[ct+1]}`);const Ye=me.map(ct=>ct.charAt(0)===Sn?"\\"+ct:ct);return{text:ae,messageParts:t8(me,Ye),placeholderNames:Se}}(ae[ie])})}function Iy(ae,ie){try{return function pr(ae,ie,me){const Se=by(ie,me);let Ye=ae[Se.id];if(void 0!==Se.legacyIds)for(let ct=0;ct<Se.legacyIds.length&&void 0===Ye;ct++)Ye=ae[Se.legacyIds[ct]];if(void 0===Ye)throw new Ah(Se);return[Ye.messageParts,Ye.placeholderNames.map(ct=>{if(Se.substitutions.hasOwnProperty(ct))return Se.substitutions[ct];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Ih(Se)}.\nThe translation contains a placeholder with name ${ct}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,ie)}catch(me){return console.warn(me.message),[ae,ie]}}const s7=function(ae,...ie){if(s7.translate){const Se=s7.translate(ae,ie);ae=Se[0],ie=Se[1]}let me=ky(ae[0],ae.raw[0]);for(let Se=1;Se<ae.length;Se++)me+=ie[Se-1]+ky(ae[Se],ae.raw[Se]);return me},nz=":";function ky(ae,ie){return ie.charAt(0)===nz?ae.substring(xo(ae,ie)+1):ae}}},Ju=>{Ju(Ju.s=8910)}]);