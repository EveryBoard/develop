!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,E,b,S,P,O,T,I,A,R,M,x,N,D,L,F,U,V,B,z,H,G,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,Ee,be,Se,Pe,Oe,Te,Ie,Ae,Re,Me,xe,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,Et,bt,St,Pt,Ot,Tt,It,At,Rt,Mt,xt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,En,bn,Sn,Pn,On,Tn,In,An,Rn,Mn,xn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,Er,br,Sr,Pr,Or,Tr,Ir,Ar,Rr,Mr,xr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,Ei,bi,Si,Pi,Oi,Ti,Ii,Ai,Ri,Mi,xi,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,Ea,ba,Sa,Pa,Oa,Ta,Ia,Aa,Ra,Ma,xa,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,Eo,bo,So,Po,Oo,To,Io,Ao,Ro,Mo,xo,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,Es,bs,Ss,Ps,Os,Ts,Is,As,Rs,Ms,xs,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,Eu,bu,Su,Pu,Ou,Tu,Iu,Au,Ru,Mu,xu,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,Ec,bc,Sc,Pc,Oc,Tc,Ic,Ac,Rc,Mc,xc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,El,bl,Sl,Pl,Ol,Tl,Il,Al,Rl,Ml,xl,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,Ef,bf,Sf,Pf,Of,Tf,If,Af,Rf,Mf,xf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,Eh,bh,Sh,Ph,Oh,Th,Ih,Ah,Rh,Mh,xh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,Ed,bd,Sd,Pd,Od,Td,Id,Ad,Rd,Md,xd,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,Ev,bv,Sv,Pv,Ov,Tv,Iv,Av,Rv,Mv,xv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,Ep,bp,Sp,Pp,Op,Tp,Ip,Ap,Rp,Mp,xp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg,wg,_g,Eg,bg,Sg,Pg,Og,Tg,Ig,Ag,Rg,Mg,xg,Ng,Dg,Lg,Fg,Ug,Vg,Bg,zg;function Hg(e){return Yg(e)||uy(e)||ly(e)||jg()}function Gg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$g(Object(n),!0).forEach(function(t){qg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function qg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wg(e,t){return Yg(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||ly(e,t)||jg()}function jg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yg(e){if(Array.isArray(e))return e}function Kg(e){var t="function"==typeof Map?new Map:void 0;return Kg=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Qg(e,arguments,oy(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ty(r,e)},Kg(e)}function Qg(e,t,n){return Qg=ay()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&ty(i,n.prototype),i},Qg.apply(null,arguments)}function Xg(){return Xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Jg(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Xg.apply(this,arguments)}function Jg(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oy(e)););return e}function ey(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ty(e,t)}function ty(e,t){return ty=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ty(e,t)}function ny(e){var t=ay();return function(){var n,r=oy(e);if(t){var i=oy(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ry(this,n)}}function ry(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return iy(e)}function iy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ay(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function oy(e){return oy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oy(e)}function sy(e){return function(e){if(Array.isArray(e))return fy(e)}(e)||uy(e)||ly(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uy(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function cy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ly(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ly(e,t){if(e){if("string"==typeof e)return fy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fy(e,t):void 0}}function fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vy(e,t,n){return t&&dy(e.prototype,t),n&&dy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},4975:function($g,jg,Yg){"use strict";var Jg,ty;function ay(e){return"function"==typeof e}function uy(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ly=uy(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function fy(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var dy=function(){function e(t){hy(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return vy(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=cy(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(ay(a))try{a()}catch(i){e=i instanceof ly?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=cy(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{yy(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof ly?e=[].concat(sy(e),sy(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new ly(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)yy(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&fy(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&fy(n,t),t instanceof e&&t._removeParent(this)}}]),e}();dy.EMPTY=function(){var e=new dy;return e.closed=!0,e}();var py=dy.EMPTY;function gy(e){return e instanceof dy||e&&"closed"in e&&ay(e.remove)&&ay(e.add)&&ay(e.unsubscribe)}function yy(e){ay(e)?e():e.unsubscribe()}var my=null,ky=null,Cy=void 0,wy=!1,_y=!1,Ey={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Ey.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=Ey.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function by(e){Ey.setTimeout(function(){if(!my)throw e;my(e)})}function Sy(){}var Py=Oy("C",void 0,void 0);function Oy(e,t,n){return{kind:e,value:t,error:n}}var Ty=null;function Iy(e){if(wy){var t=!Ty;if(t&&(Ty={errorThrown:!1,error:null}),e(),t){var n=Ty,r=n.errorThrown,i=n.error;if(Ty=null,r)throw i}}else e()}var Ay=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,gy(e)&&e.add(iy(r))):r.destination=Dy,r}return vy(n,[{key:"next",value:function(e){this.isStopped?Ny(Oy("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?Ny(Oy("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?Ny(Py,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,Xg(oy(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Ry(e,t,n)}}]),n}(dy),Ry=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a,o,s;if(hy(this,n),o=t.call(this),ay(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,iy(o)&&_y?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?My(s):Sy,error:My(null!==(a=r)&&void 0!==a?a:xy),complete:i?My(i):Sy},ry(o)}return vy(n)}(Ay);function My(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){wy?function(e){wy&&Ty&&(Ty.errorThrown=!0,Ty.error=e)}(t):by(t)}}}function xy(e){throw e}function Ny(e,t){var n=ky;n&&Ey.setTimeout(function(){return n(e,t)})}var Dy={closed:!0,next:Sy,error:xy,complete:Sy},Ly="function"==typeof Symbol&&Symbol.observable||"@@observable";function Fy(e){return e}var Uy=function(){var e=function(){function e(t){hy(this,e),t&&(this._subscribe=t)}return vy(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof Ay||function(e){return e&&ay(e.next)&&ay(e.error)&&ay(e.complete)}(e)&&gy(e)}(e)?e:new Ry(e,t,n);return Iy(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Vy(t))(function(t,r){var i=new Ry({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Ly,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?Fy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Vy(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Vy(e){var t;return null!==(t=null!=e?e:Cy)&&void 0!==t?t:Promise}var By=uy(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),zy=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return vy(n,[{key:"lift",value:function(e){var t=new Hy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new By}},{key:"next",value:function(e){var t=this;Iy(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=cy(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;Iy(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;Iy(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),Xg(oy(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?py:(r.push(e),new dy(function(){return fy(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Uy;return e.source=this,e}}]),n}(Uy);return e.create=function(e,t){return new Hy(e,t)},e}(),Hy=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).destination=e,i.source=r,i}return vy(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:py}}]),n}(zy);function Gy(e){return ay(null==e?void 0:e.lift)}function $y(e){return function(t){if(Gy(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Zy=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s,u,c,l;return hy(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:Xg((s=iy(l),oy(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:Xg((u=iy(l),oy(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:Xg((c=iy(l),oy(n.prototype)),"_complete",c),l}return vy(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;Xg(oy(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(Ay);function qy(e,t){return $y(function(n,r){var i=0;n.subscribe(new Zy(r,function(n){r.next(e.call(t,n,i++))}))})}function Wy(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function jy(e){return this instanceof jy?(this.v=e,this):new jy(e)}function Yy(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof jy?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Ky(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Qy=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Xy(e){return ay(null==e?void 0:e.then)}function Jy(e){return ay(e[Ly])}function em(e){return Symbol.asyncIterator&&ay(null==e?void 0:e[Symbol.asyncIterator])}function tm(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var nm="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function rm(e){return ay(null==e?void 0:e[nm])}function im(e){return Yy(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,jy(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,jy(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,jy(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function am(e){return ay(null==e?void 0:e.getReader)}function om(e){if(e instanceof Uy)return e;if(null!=e){if(Jy(e))return function(e){return new Uy(function(t){var n=e[Ly]();if(ay(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Qy(e))return function(e){return new Uy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Xy(e))return function(e){return new Uy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,by)})}(e);if(em(e))return sm(e);if(rm(e))return function(e){return new Uy(function(t){var n,r=cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(am(e))return function(e){return sm(im(e))}(e)}throw tm(e)}function sm(e){return new Uy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Ky(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function um(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function cm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return ay(t)?cm(function(n,r){return qy(function(e,i){return t(n,e,r,i)})(om(e(n,r)))},n):("number"==typeof t&&(n=t),$y(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;om(n(i,l++)).subscribe(new Zy(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new Zy(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function lm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return cm(Fy,e)}var fm=new Uy(function(e){return e.complete()});function hm(e){return e[e.length-1]}function dm(e){return ay(hm(e))?e.pop():void 0}function vm(e){return function(e){return e&&ay(e.schedule)}(hm(e))?e.pop():void 0}function pm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $y(function(n,r){n.subscribe(new Zy(r,function(n){return um(r,e,function(){return r.next(n)},t)},function(){return um(r,e,function(){return r.complete()},t)},function(n){return um(r,e,function(){return r.error(n)},t)}))})}function gm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $y(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function ym(e,t){if(!e)throw new Error("Iterable cannot be null");return new Uy(function(n){um(n,t,function(){var r=e[Symbol.asyncIterator]();um(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function mm(e,t){return t?function(e,t){if(null!=e){if(Jy(e))return function(e,t){return om(e).pipe(gm(t),pm(t))}(e,t);if(Qy(e))return function(e,t){return new Uy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Xy(e))return function(e,t){return om(e).pipe(gm(t),pm(t))}(e,t);if(em(e))return ym(e,t);if(rm(e))return function(e,t){return new Uy(function(n){var r;return um(n,t,function(){r=e[nm](),um(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return ay(null==r?void 0:r.return)&&r.return()}})}(e,t);if(am(e))return function(e,t){return ym(im(e),t)}(e,t)}throw tm(e)}(e,t):om(e)}function km(e){return e<=0?function(){return fm}:$y(function(t,n){var r=0;t.subscribe(new Zy(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function Cm(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(km(1)).subscribe(function(){return e()})}function wm(e){for(var t in e)if(e[t]===wm)return t;throw Error("Could not find renamed property on target object.")}function _m(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Em(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Em).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function bm(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Sm=wm({__forward_ref__:wm});function Pm(e){return e.__forward_ref__=Pm,e.toString=function(){return Em(this())},e}function Om(e){return Tm(e)?e():e}function Tm(e){return"function"==typeof e&&e.hasOwnProperty(Sm)&&e.__forward_ref__===Pm}var Im=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return vy(n)}(Kg(Error));function Am(e){return"string"==typeof e?e:null==e?"":String(e)}function Rm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Am(e)}function Mm(e,t){var n=t?" in ".concat(t):"";throw new Im("201","No provider for ".concat(Rm(e)," found").concat(n))}function xm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function Nm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Dm(e){return{providers:e.providers||[],imports:e.imports||[]}}function Lm(e){return Fm(e,Bm)||Fm(e,Hm)}function Fm(e,t){return e.hasOwnProperty(t)?e[t]:null}function Um(e){return e&&(e.hasOwnProperty(zm)||e.hasOwnProperty(Gm))?e[zm]:null}var Vm,Bm=wm({"\u0275prov":wm}),zm=wm({"\u0275inj":wm}),Hm=wm({ngInjectableDef:wm}),Gm=wm({ngInjectorDef:wm}),$m=(($m=$m||{})[$m.Default=0]="Default",$m[$m.Host=1]="Host",$m[$m.Self=2]="Self",$m[$m.SkipSelf=4]="SkipSelf",$m[$m.Optional=8]="Optional",$m);function Zm(e){var t=Vm;return Vm=e,t}function qm(e,t,n){var r=Lm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&$m.Optional?null:void 0!==t?t:void Mm(Em(e),"Injector")}function Wm(e){return{toString:e}.toString()}var jm=((jm=jm||{})[jm.OnPush=0]="OnPush",jm[jm.Default=1]="Default",jm),Ym=((Ym=Ym||{})[Ym.Emulated=0]="Emulated",Ym[Ym.None=2]="None",Ym[Ym.ShadowDom=3]="ShadowDom",Ym),Km="undefined"!=typeof globalThis&&globalThis,Qm="undefined"!=typeof window&&window,Xm="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Jm=Km||"undefined"!=typeof global&&global||Qm||Xm,ek={},tk=[],nk=wm({"\u0275cmp":wm}),rk=wm({"\u0275dir":wm}),ik=wm({"\u0275pipe":wm}),ak=wm({"\u0275mod":wm}),ok=wm({"\u0275loc":wm}),sk=wm({"\u0275fac":wm}),uk=wm({__NG_ELEMENT_ID__:wm}),ck=0;function lk(e){return Wm(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===jm.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||tk,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ym.Emulated,id:"c",styles:e.styles||tk,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=ck++,n.inputs=pk(e.inputs,t),n.outputs=pk(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(fk)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(hk)}:null,n})}function fk(e){return mk(e)||function(e){return e[rk]||null}(e)}function hk(e){return function(e){return e[ik]||null}(e)}var dk={};function vk(e){return Wm(function(){var t={type:e.type,bootstrap:e.bootstrap||tk,declarations:e.declarations||tk,imports:e.imports||tk,exports:e.exports||tk,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(dk[e.id]=e.type),t})}function pk(e,t){if(null==e)return ek;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var gk=lk;function yk(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function mk(e){return e[nk]||null}function kk(e,t){var n=e[ak]||null;if(!n&&!0===t)throw new Error("Type ".concat(Em(e)," does not have '\u0275mod' property."));return n}function Ck(e){return Array.isArray(e)&&"object"==typeof e[1]}function wk(e){return Array.isArray(e)&&!0===e[1]}function _k(e){return 0!=(8&e.flags)}function Ek(e){return 2==(2&e.flags)}function bk(e){return 1==(1&e.flags)}function Sk(e){return null!==e.template}function Pk(e){return 0!=(512&e[2])}function Ok(e,t){return e.hasOwnProperty(sk)?e[sk]:null}var Tk=function(){function e(t,n,r){hy(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return vy(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Ik(){return Ak}function Ak(e){return e.type.prototype.ngOnChanges&&(e.setInput=Mk),Rk}function Rk(){var e=Nk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===ek)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Mk(e,t,n,r){var i=Nk(e)||function(e,t){return e[xk]=t}(e,{previous:ek,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new Tk(u&&u.currentValue,t,o===ek),e[r]=t}Ik.ngInherit=!0;var xk="__ngSimpleChanges__";function Nk(e){return e[xk]||null}var Dk,Lk="http://www.w3.org/2000/svg";function Fk(){return void 0!==Dk?Dk:"undefined"!=typeof document?document:void 0}function Uk(e){return!!e.listen}var Vk={createRenderer:function(e,t){return Fk()}};function Bk(e){for(;Array.isArray(e);)e=e[0];return e}function zk(e,t){return Bk(t[e])}function Hk(e,t){return Bk(t[e.index])}function Gk(e,t){return e.data[t]}function $k(e,t){return e[t]}function Zk(e,t){var n=t[e];return Ck(n)?n:n[0]}function qk(e){return 4==(4&e[2])}function Wk(e){return 128==(128&e[2])}function jk(e,t){return null==t?null:e[t]}function Yk(e){e[18]=0}function Kk(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Qk={lFrame:EC(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Xk(){return Qk.bindingsEnabled}function Jk(){return Qk.lFrame.lView}function eC(){return Qk.lFrame.tView}function tC(e){return Qk.lFrame.contextLView=e,e[8]}function nC(){for(var e=rC();null!==e&&64===e.type;)e=e.parent;return e}function rC(){return Qk.lFrame.currentTNode}function iC(){var e=Qk.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function aC(e,t){var n=Qk.lFrame;n.currentTNode=e,n.isParent=t}function oC(){return Qk.lFrame.isParent}function sC(){Qk.lFrame.isParent=!1}function uC(){return Qk.isInCheckNoChangesMode}function cC(e){Qk.isInCheckNoChangesMode=e}function lC(){var e=Qk.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function fC(){return Qk.lFrame.bindingIndex}function hC(){return Qk.lFrame.bindingIndex++}function dC(e){var t=Qk.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function vC(e){Qk.lFrame.inI18n=e}function pC(e,t){var n=Qk.lFrame;n.bindingIndex=n.bindingRootIndex=e,gC(t)}function gC(e){Qk.lFrame.currentDirectiveIndex=e}function yC(){return Qk.lFrame.currentQueryIndex}function mC(e){Qk.lFrame.currentQueryIndex=e}function kC(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function CC(e,t,n){if(n&$m.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&$m.Host||(r=kC(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Qk.lFrame=_C();return a.currentTNode=t,a.lView=e,!0}function wC(e){var t=_C(),n=e[1];Qk.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function _C(){var e=Qk.lFrame,t=null===e?null:e.child;return null===t?EC(e):t}function EC(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function bC(){var e=Qk.lFrame;return Qk.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var SC=bC;function PC(){var e=bC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function OC(){return Qk.lFrame.selectedIndex}function TC(e){Qk.lFrame.selectedIndex=e}function IC(){var e=Qk.lFrame;return Gk(e.tView,e.selectedIndex)}function AC(){Qk.lFrame.currentNamespace=Lk}function RC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function MC(e,t,n){DC(e,t,3,n)}function xC(e,t,n,r){(3&e[2])===n&&DC(e,t,n,r)}function NC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function DC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(LC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function LC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var FC=vy(function e(t,n,r){hy(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function UC(e,t,n){for(var r=Uk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];BC(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function VC(e){return 3===e||4===e||6===e}function BC(e){return 64===e.charCodeAt(0)}function zC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||HC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function HC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function GC(e){return-1!==e}function $C(e){return 32767&e}function ZC(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var qC=!0;function WC(e){var t=qC;return qC=e,t}var jC=0;function YC(e,t){var n=QC(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,KC(r.data,e),KC(t,null),KC(r.blueprint,null));var i=XC(e,t),a=e.injectorIndex;if(GC(i))for(var o=$C(i),s=ZC(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function KC(e,t){e.push(0,0,0,0,0,0,0,0,t)}function QC(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function XC(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function JC(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(uk)&&(r=n[uk]),null==r&&(r=n[uk]=jC++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function ew(e,t,n){if(n&$m.Optional)return e;Mm(t,"NodeInjector")}function tw(e,t,n,r){if(n&$m.Optional&&void 0===r&&(r=null),0==(n&($m.Self|$m.Host))){var i=e[9],a=Zm(void 0);try{return i?i.get(t,r,n&$m.Optional):qm(t,r,n&$m.Optional)}finally{Zm(a)}}return ew(r,t,n)}function nw(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$m.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(uk)?e[uk]:void 0;return"number"==typeof t?t>=0?255&t:iw:t}(n);if("function"==typeof a){if(!CC(t,e,r))return r&$m.Host?ew(i,n,r):tw(t,n,r,i);try{var o=a(r);if(null!=o||r&$m.Optional)return o;Mm(n)}finally{SC()}}else if("number"==typeof a){var s=null,u=QC(e,t),c=-1,l=r&$m.Host?t[16][6]:null;for((-1===u||r&$m.SkipSelf)&&(-1!==(c=-1===u?XC(e,t):t[u+8])&&cw(r,!1)?(s=t[1],u=$C(c),t=ZC(c,t)):u=-1);-1!==u;){var f=t[1];if(uw(a,u,f.data)){var h=aw(u,t,n,s,r,l);if(h!==rw)return h}-1!==(c=t[u+8])&&cw(r,t[1].data[u+8]===l)&&uw(a,u,t)?(s=f,u=$C(c),t=ZC(c,t)):u=-1}}}return tw(t,n,r,i)}var rw={};function iw(){return new lw(nC(),Jk())}function aw(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=ow(s,o,n,null==r?Ek(s)&&qC:r!=o&&0!=(3&s.type),i&$m.Host&&a===s);return null!==u?sw(t,o,u,s):rw}function ow(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&Sk(d)&&d.type===n)return u}return null}function sw(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof FC}(i)){var o=i;o.resolving&&function(e,t){throw new Im("200","Circular dependency in DI detected for ".concat(e))}(Rm(a[n]));var s=WC(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Zm(o.injectImpl):null;CC(e,r,$m.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=Ak(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Zm(u),WC(s),o.resolving=!1,SC()}}return i}function uw(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function cw(e,t){return!(e&$m.Self||e&$m.Host&&t)}var lw=function(){function e(t,n){hy(this,e),this._tNode=t,this._lView=n}return vy(e,[{key:"get",value:function(e,t,n){return nw(this._tNode,this._lView,e,n,t)}}]),e}();function fw(e){return Wm(function(){for(var t=e.prototype.constructor,n=t[sk]||hw(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[sk]||hw(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function hw(e){return Tm(e)?function(){var t=hw(Om(e));return t&&t()}:Ok(e)}function dw(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(VC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(nC(),e)}var vw="__parameters__";function pw(e,t,n){return Wm(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Qg(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(vw)?e[vw]:Object.defineProperty(e,vw,{value:[]})[vw];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var gw=function(){function e(t,n){hy(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Nm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return vy(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),yw=new gw("AnalyzeForEntryComponents"),mw=Function;function kw(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),kw(r,t)):t!==e&&t.push(r)}return t}function Cw(e,t){e.forEach(function(e){return Array.isArray(e)?Cw(e,t):t(e)})}function ww(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function _w(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Ew(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function bw(e,t,n){var r=Pw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function Sw(e,t){var n=Pw(e,t);if(n>=0)return e[1|n]}function Pw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var Ow,Tw={},Iw="__NG_DI_FLAG__",Aw="ngTempTokenPath",Rw=/\n/gm,Mw="__source",xw=wm({provide:String,useValue:wm});function Nw(e){var t=Ow;return Ow=e,t}function Dw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$m.Default;if(void 0===Ow)throw new Error("inject() must be called from an injection context");return null===Ow?qm(e,void 0,t):Ow.get(e,t&$m.Optional?null:void 0,t)}function Lw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$m.Default;return(Vm||Dw)(Om(e),t)}function Fw(e){for(var t=[],n=0;n<e.length;n++){var r=Om(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=$m.Default,o=0;o<r.length;o++){var s=r[o],u=Vw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Lw(i,a))}else t.push(Lw(r))}return t}function Uw(e,t){return e[Iw]=t,e.prototype[Iw]=t,e}function Vw(e){return e[Iw]}function Bw(e,t,n,r){var i=e[Aw];throw t[Mw]&&i.unshift(t[Mw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=Em(t);if(Array.isArray(t))i=t.map(Em).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):Em(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Rw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Aw]=null,e}var zw,Hw,Gw=Uw(pw("Inject",function(e){return{token:e}}),-1),$w=Uw(pw("Optional"),8),Zw=Uw(pw("SkipSelf"),4);function qw(e){var t;return(null===(t=function(){if(void 0===zw&&(zw=null,Jm.trustedTypes))try{zw=Jm.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return zw}())||void 0===t?void 0:t.createHTML(e))||e}function Ww(e){var t;return(null===(t=function(){if(void 0===Hw&&(Hw=null,Jm.trustedTypes))try{Hw=Jm.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Hw}())||void 0===t?void 0:t.createHTML(e))||e}var jw=function(){function e(t){hy(this,e),this.changingThisBreaksApplicationSecurity=t}return vy(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Yw=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(jw),Kw=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(jw),Qw=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(jw),Xw=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(jw),Jw=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(jw);function e_(e){return e instanceof jw?e.changingThisBreaksApplicationSecurity:e}function t_(e,t){var n=n_(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function n_(e){return e instanceof jw&&e.getTypeName()||null}function r_(e){var t=new a_(e);return function(){try{return!!(new window.DOMParser).parseFromString(qw(""),"text/html")}catch(e){return!1}}()?new i_(t):t}var i_=function(){function e(t){hy(this,e),this.inertDocumentHelper=t}return vy(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(qw(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),a_=function(){function e(t){if(hy(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return vy(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=qw(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=qw(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),o_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,s_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function u_(e){return(e=String(e)).match(o_)||e.match(s_)?e:"unsafe:"+e}function c_(e){return(e=String(e)).split(",").map(function(e){return u_(e.trim())}).join(", ")}function l_(e){var t,n={},r=cy(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function f_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var h_,d_=l_("area,br,col,hr,img,wbr"),v_=l_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),p_=l_("rp,rt"),g_=f_(d_,f_(v_,l_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),f_(p_,l_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),f_(p_,v_)),y_=l_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),m_=l_("srcset"),k_=f_(y_,m_,l_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),l_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),C_=l_("script,style,template"),w_=function(){function e(){hy(this,e),this.sanitizedSomething=!1,this.buf=[]}return vy(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!g_.hasOwnProperty(t))return this.sanitizedSomething=!0,!C_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(k_.hasOwnProperty(o)){var s=i.value;y_[o]&&(s=u_(s)),m_[o]&&(s=c_(s)),this.buf.push(" ",a,'="',b_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();g_.hasOwnProperty(t)&&!d_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(b_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),__=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,E_=/([^\#-~ |!])/g;function b_(e){return e.replace(/&/g,"&amp;").replace(__,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(E_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function S_(e,t){var n=null;try{h_=h_||r_(e);var r=t?String(t):"";n=h_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=h_.getInertBodyElement(r)}while(r!==a);return qw((new w_).sanitizeChildren(P_(n)||n))}finally{if(n)for(var o=P_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function P_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var O_=((O_=O_||{})[O_.NONE=0]="NONE",O_[O_.HTML=1]="HTML",O_[O_.STYLE=2]="STYLE",O_[O_.SCRIPT=3]="SCRIPT",O_[O_.URL=4]="URL",O_[O_.RESOURCE_URL=5]="RESOURCE_URL",O_);function T_(e){var t=A_();return t?Ww(t.sanitize(O_.HTML,e)||""):t_(e,"HTML")?Ww(e_(e)):S_(Fk(),Am(e))}function I_(e){var t=A_();return t?t.sanitize(O_.URL,e)||"":t_(e,"URL")?e_(e):u_(Am(e))}function A_(){var e=Jk();return e&&e[12]}var R_="__ngContext__";function M_(e,t){e[R_]=t}function x_(e){var t=function(e){return e[R_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function N_(e){return e.ngOriginalError}function D_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var L_=function(){function e(){hy(this,e),this._console=console}return vy(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||D_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(N_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&N_(e);t&&N_(t);)t=N_(t);return t||null}}]),e}(),F_=/^>|^->|<!--|-->|--!>|<!-$/g,U_=/(<|>)/,V_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Jm);function B_(e){return e instanceof Function?e():e}var z_,H_=((H_=H_||{})[H_.Important=1]="Important",H_[H_.DashCase=2]="DashCase",H_);function G_(e,t){return z_(e,t)}function $_(e){var t=e[3];return wk(t)?t[3]:t}function Z_(e){return W_(e[13])}function q_(e){return W_(e[4])}function W_(e){for(;null!==e&&!wk(e);)e=e[4];return e}function j_(e,t,n,r,i){if(null!=r){var a,o=!1;wk(r)?a=r:Ck(r)&&(o=!0,r=r[0]);var s=Bk(r);0===e&&null!==n?null==i?oE(t,n,s):aE(t,n,s,i||null,!0):1===e&&null!==n?aE(t,n,s,i||null,!0):2===e?mE(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==Bk(n)&&j_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];CE(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function Y_(e,t){return Uk(e)?e.createText(t):e.createTextNode(t)}function K_(e,t,n){Uk(e)?e.setValue(t,n):t.textContent=n}function Q_(e,t){return e.createComment(function(e){return e.replace(F_,function(e){return e.replace(U_,"\u200b$1\u200b")})}(t))}function X_(e,t,n){return Uk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function J_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Kk(i,-1)),n.splice(r,1)}function eE(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&J_(i,r),t>0&&(e[n-1][4]=r[4]);var a=_w(e,10+t);!function(e,t){CE(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function tE(e,t){if(!(256&t[2])){var n=t[11];Uk(n)&&n.destroyNode&&CE(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return nE(e[1],e);for(;t;){var n=null;if(Ck(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)Ck(t)&&nE(t[1],t),t=t[3];null===t&&(t=e),Ck(t)&&nE(t[1],t),n=t&&t[4]}t=n}}(t)}}function nE(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof FC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):Bk(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&Uk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&wk(t[3])){n!==t[3]&&J_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function rE(e,t,n){return iE(e,t.parent,n)}function iE(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Ym.None||i===Ym.Emulated)return null}return Hk(r,n)}function aE(e,t,n,r,i){Uk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function oE(e,t,n){Uk(e)?e.appendChild(t,n):t.appendChild(n)}function sE(e,t,n,r,i){null!==r?aE(e,t,n,r,i):oE(e,t,n)}function uE(e,t){return Uk(e)?e.parentNode(t):t.parentNode}function cE(e,t,n){return hE(e,t,n)}function lE(e,t,n){return 40&e.type?Hk(e,n):null}var fE,hE=lE;function dE(e,t){hE=e,fE=t}function vE(e,t,n,r){var i=rE(e,r,t),a=t[11],o=cE(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)sE(a,i,n[s],o,!1);else sE(a,i,n,o,!1);void 0!==fE&&fE(a,r,t,n,i)}function pE(e,t){if(null!==t){var n=t.type;if(3&n)return Hk(t,e);if(4&n)return yE(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return pE(e,r);var i=e[t.index];return wk(i)?yE(-1,i):Bk(i)}if(32&n)return G_(t,e)()||Bk(e[t.index]);var a=gE(e,t);return null!==a?Array.isArray(a)?a[0]:pE($_(e[16]),a):pE(e,t.next)}return null}function gE(e,t){return null!==t?e[16][6].projection[t.projection]:null}function yE(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return pE(r,i)}return t[7]}function mE(e,t,n){var r=uE(e,t);r&&function(e,t,n,r){Uk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function kE(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&M_(Bk(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)kE(e,t,n.child,r,i,a,!1),j_(t,e,i,s,a);else if(32&u){for(var c=G_(n,r),l=void 0;l=c();)j_(t,e,i,l,a);j_(t,e,i,s,a)}else 16&u?wE(e,t,r,n,i,a):j_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function CE(e,t,n,r,i,a){kE(n,r,e.firstChild,t,i,a,!1)}function wE(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)j_(t,e,i,s[u],a);else kE(e,t,s,o[3],i,a,!0)}function _E(e,t,n){Uk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function EE(e,t,n){Uk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function bE(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var SE="ng-template";function PE(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==bE((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function OE(e){return 4===e.type&&e.value!==SE}function TE(e,t,n){return t===(4!==e.type||n?e.value:SE)}function IE(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(VC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!TE(e,u,n)||""===u&&1===t.length){if(AE(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!PE(e.attrs,c,n)){if(AE(r))return!1;o=!0}continue}var l=RE(8&r?"class":u,i,OE(e),n);if(-1===l){if(AE(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==bE(h,c,0)||2&r&&c!==f){if(AE(r))return!1;o=!0}}}}else{if(!o&&!AE(r)&&!AE(u))return!1;if(o&&AE(u))continue;o=!1,r=u|1&r}}return AE(r)||o}function AE(e){return 0==(1&e)}function RE(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function ME(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(IE(e,t[r],n))return!0;return!1}function xE(e,t){return e?":not("+t.trim()+")":t}function NE(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!AE(o)&&(t+=xE(a,i),i=""),r=o,a=a||!AE(r);n++}return""!==i&&(t+=xE(a,i)),t}var DE={};function LE(e){FE(eC(),Jk(),OC()+e,uC())}function FE(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&MC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&xC(t,a,0,n)}TC(n)}function UE(e,t){return e<<17|t<<2}function VE(e){return e>>17&32767}function BE(e){return 2|e}function zE(e){return(131068&e)>>2}function HE(e,t){return-131069&e|t<<2}function GE(e){return 1|e}function $E(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];mC(i),o.contentQueries(2,t[a],a)}}}function ZE(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Yk(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function qE(e,t,n,r,i){var a=e.data[t];if(null===a)a=WE(e,t,n,r,i),Qk.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=iC();a.injectorIndex=null===o?-1:o.injectorIndex}return aC(a,!0),a}function WE(e,t,n,r,i){var a=rC(),o=oC(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function jE(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function YE(e,t,n){wC(t);try{var r=e.viewQuery;null!==r&&Ob(1,r,n);var i=e.template;null!==i&&XE(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&$E(e,t),e.staticViewQueries&&Ob(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)_b(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,PC()}}function KE(e,t,n,r){var i=t[2];if(256!=(256&i)){wC(t);var a=uC();try{Yk(t),function(e){Qk.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&XE(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&MC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&xC(t,u,0,null),NC(t,0)}if(function(e){for(var t=Z_(e);null!==t;t=q_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Kk(a,1),i[2]|=1024}}(t),function(e){for(var t=Z_(e);null!==t;t=q_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Wk(r)&&KE(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&$E(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&MC(t,c)}else{var l=e.contentHooks;null!==l&&xC(t,l,1),NC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)TC(~i);else{var a=i,o=n[++r],s=n[++r];pC(o,a),s(2,t[a])}}}finally{TC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)Cb(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&Ob(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&MC(t,d)}else{var v=e.viewHooks;null!==v&&xC(t,v,2),NC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Kk(t[3],-1))}finally{PC()}}}function QE(e,t,n,r){var i=t[10],a=!uC(),o=qk(t);try{a&&!o&&i.begin&&i.begin(),o&&YE(e,t,r),KE(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function XE(e,t,n,r,i){var a=OC(),o=2&r;try{TC(-1),o&&t.length>20&&FE(e,t,20,uC()),n(r,i)}finally{TC(a)}}function JE(e,t,n){if(_k(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function eb(e,t,n){!Xk()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||YC(n,t),M_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=Sk(u);c&&vb(t,n,u);var l=sw(t,e,s,n);M_(l,t),null!==o&&yb(0,s-i,l,u,0,o),c&&(Zk(n.index,t)[8]=l)}}(e,t,n,Hk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Qk.lFrame.currentDirectiveIndex;try{TC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];gC(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&cb(u,c)}}finally{TC(-1),gC(o)}}(e,t,n))}function tb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function nb(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=rb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function rb(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:DE);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function ib(e,t,n,r){var i=Ib(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&Ab(e).push(r,i.length-1))}function ab(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function ob(e,t,n,r,i,a,o,s){var u,c=Hk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(Mb(e,n,u,r,i),Ek(t)&&function(e,t){var n=Zk(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Uk(a)?a.setProperty(c,r,i):BC(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function sb(e,t,n,r){var i=!1;if(Xk()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];ME(n,o.selectors,!1)&&(i||(i=[]),JC(YC(n,t),e,o.type),Sk(o)?(lb(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,hb(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=jE(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=zC(n.mergedAttrs,d.hostAttrs),db(e,n,t,f,d),fb(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||OE(t)?null:mb(l,i);a.push(f),o=ab(l,u,o),s=ab(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new Im("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=zC(n.mergedAttrs,n.attrs),i}function ub(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function cb(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function lb(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function fb(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Sk(t)&&(n[""]=e)}}function hb(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function db(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=Ok(i.type)),o=new FC(a,Sk(i),null);e.blueprint[r]=o,n[r]=o,ub(e,t,0,r,jE(e,n,i.hostVars,DE),i)}function vb(e,t,n){var r=Hk(t,e),i=nb(n),a=e[10],o=Eb(e,ZE(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function pb(e,t,n,r,i,a){var o=Hk(e,t);gb(t[11],o,a,e.value,n,r,i)}function gb(e,t,n,r,i,a,o){if(null==a)Uk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?Am(a):o(a,r||"",i);Uk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function yb(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function mb(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function kb(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function Cb(e,t){var n=Zk(t,e);if(Wk(n)){var r=n[1];80&n[2]?KE(r,n,r.template,n[8]):n[5]>0&&wb(n)}}function wb(e){for(var t=Z_(e);null!==t;t=q_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];KE(i,r,i.template,r[8])}else r[5]>0&&wb(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Zk(a[o],e);Wk(s)&&s[5]>0&&wb(s)}}function _b(e,t){var n=Zk(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),YE(r,n,n[8])}function Eb(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function bb(e){for(;e;){e[2]|=64;var t=$_(e);if(Pk(e)&&!t)return e;e=t}return null}function Sb(e,t,n){var r=t[10];r.begin&&r.begin();try{KE(e,t,e.template,n)}catch(i){throw Rb(t,i),i}finally{r.end&&r.end()}}function Pb(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=x_(n),i=r[1];QE(i,r,i.template,n)}}(e[8])}function Ob(e,t,n){mC(0),t(e,n)}var Tb=Promise.resolve(null);function Ib(e){return e[7]||(e[7]=[])}function Ab(e){return e.cleanup||(e.cleanup=[])}function Rb(e,t){var n=e[9],r=n?n.get(L_,null):null;r&&r.handleError(t)}function Mb(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function xb(e,t,n){var r=zk(t,e);K_(e[11],r,n)}function Nb(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=bm(i,s):2==a&&(r=bm(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var Db,Lb=new gw("INJECTOR",-1),Fb=function(){function e(){hy(this,e)}return vy(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tw;if(t===Tw){var n=new Error("NullInjectorError: No provider for ".concat(Em(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Ub=new gw("Set Injector scope."),Vb={},Bb={};function zb(){return void 0===Db&&(Db=new Fb),Db}function Hb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Gb(e,n,t||zb(),r)}var Gb=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;hy(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&Cw(n,function(e){return i.processProvider(e,t,n)}),Cw([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(Lb,qb(void 0,this));var s=this.records.get(Ub);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:Em(t))}return vy(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$m.Default;this.assertNotDestroyed();var r,i=Nw(this),a=Zm(void 0);try{if(!(n&$m.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof gw)&&Lm(e);o=s&&this.injectableDefInScope(s)?qb($b(e),Vb):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&$m.Self?zb():this.parent).get(e,t=n&$m.Optional&&t===Tw?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[Aw]=u[Aw]||[]).unshift(Em(e)),i)throw u;return Bw(u,e,"R3InjectorError",this.source)}throw u}finally{Zm(a),Nw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(Em(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=Om(e)))return!1;var i=Um(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Um(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{Cw(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;Cw(i,function(e){return r.processProvider(e,n,i||tk)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=Ok(o)||function(){return new o};this.records.set(o,qb(f,Vb));var h=i.providers;if(null!=h&&!s){var d=e;Cw(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=jb(e=Om(e))?e:Om(e&&e.provide),a=Wb(r=e)?qb(void 0,r.useValue):qb(Zb(r),Vb);if(jb(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=qb(void 0,Vb,!0)).factory=function(){return Fw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===Vb&&(t.value=Bb,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=Om(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function $b(e){var t=Lm(e),n=null!==t?t.factory:Ok(e);if(null!==n)return n;if(e instanceof gw)throw new Error("Token ".concat(Em(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=Ew(t,"?");throw new Error("Can't resolve all parameters for ".concat(Em(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[Bm]||e[Hm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Zb(e,t,n){var r;if(jb(e)){var i=Om(e);return Ok(i)||$b(i)}if(Wb(e))r=function(){return Om(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,sy(Fw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Lw(Om(e.useExisting))};else{var a=Om(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Ok(a)||$b(a);r=function(){return Qg(a,sy(Fw(e.deps)))}}return r}function qb(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Wb(e){return null!==e&&"object"==typeof e&&xw in e}function jb(e){return"function"==typeof e}var Yb=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=Hb(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},Kb=function(){var e=function(){function e(){hy(this,e)}return vy(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Yb(e,t,""):Yb(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Tw,e.NULL=new Fb,e.\u0275prov=Nm({token:e,providedIn:"any",factory:function(){return Lw(Lb)}}),e.__NG_ELEMENT_ID__=-1,e}();function Qb(e,t){RC(x_(e)[1],nC())}function Xb(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(Sk(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=Jb(e.inputs),a.declaredInputs=Jb(e.declaredInputs),a.outputs=Jb(e.outputs);var o=i.hostBindings;o&&nS(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&eS(e,s),u&&tS(e,u),_m(e.inputs,i.inputs),_m(e.declaredInputs,i.declaredInputs),_m(e.outputs,i.outputs),Sk(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===Xb&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=zC(i.hostAttrs,n=zC(n,i.hostAttrs))}}(r)}function Jb(e){return e===ek?{}:e===tk?[]:e}function eS(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function tS(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function nS(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var rS=null;function iS(){if(!rS){var e=Jm.Symbol;if(e&&e.iterator)rS=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(rS=r)}}return rS}var aS=function(){function e(t){hy(this,e),this.wrapped=t}return vy(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function oS(e){return!!sS(e)&&(Array.isArray(e)||!(e instanceof Map)&&iS()in e)}function sS(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function uS(e,t,n){return e[t]=n}function cS(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function lS(e,t,n,r){var i=cS(e,t,n);return cS(e,t+1,r)||i}function fS(e,t,n,r){var i=Jk();return cS(i,hC(),t)&&(eC(),pb(IC(),i,e,t,n,r)),fS}function hS(e,t,n,r){return cS(e,hC(),n)?t+Am(n)+r:DE}function dS(e,t,n,r,i,a){var o=lS(e,fC(),n,i);return dC(2),o?t+Am(n)+r+Am(i)+a:DE}function vS(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=lS(e,t,n,r);return cS(e,t+2,i)||a}(e,fC(),n,i,o);return dC(3),u?t+Am(n)+r+Am(i)+a+Am(o)+s:DE}function pS(e,t,n,r,i,a){var o=Jk(),s=hS(o,t,n,r);return s!==DE&&pb(IC(),o,e,s,i,a),pS}function gS(e,t,n,r,i,a,o,s){var u=Jk(),c=eC(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=qE(t,e,4,o||null,jk(c,s));sb(t,n,l,jk(c,u)),RC(t,l);var f=l.tViews=rb(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];aC(f,!1);var h=u[11].createComment("");vE(c,u,h,f),M_(h,u),Eb(u,u[l]=kb(h,u,h,f)),bk(f)&&eb(c,u,f),null!=o&&tb(u,f,s)}function yS(e){return $k(Qk.lFrame.contextLView,20+e)}function mS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$m.Default,n=Jk();return null===n?Lw(e,t):nw(nC(),n,Om(e),t)}function kS(e,t,n){var r=Jk();return cS(r,hC(),t)&&ob(eC(),IC(),r,e,t,r[11],n,!1),kS}function CS(e,t,n,r,i){var a=i?"class":"style";Mb(e,n,t.inputs[a],a,r)}function wS(e,t,n,r){var i=Jk(),a=eC(),o=20+e,s=i[11],u=i[o]=X_(s,t,Qk.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=qE(t,e,2,i,jk(s,a));return sb(t,n,u,jk(s,o)),null!==u.attrs&&Nb(u,u.attrs,!1),null!==u.mergedAttrs&&Nb(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];aC(c,!0);var l=c.mergedAttrs;null!==l&&UC(s,u,l);var f=c.classes;null!==f&&EE(s,u,f);var h=c.styles;null!==h&&_E(s,u,h),64!=(64&c.flags)&&vE(a,i,u,c),0===Qk.lFrame.elementDepthCount&&M_(u,i),Qk.lFrame.elementDepthCount++,bk(c)&&(eb(a,i,c),JE(a,c,i)),null!==r&&tb(i,c)}function _S(){var e=nC();oC()?sC():aC(e=e.parent,!1);var t=e;Qk.lFrame.elementDepthCount--;var n=eC();n.firstCreatePass&&(RC(n,e),_k(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&CS(n,t,Jk(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&CS(n,t,Jk(),t.stylesWithoutHost,!1)}function ES(e,t,n,r){wS(e,t,n,r),_S()}function bS(e,t,n){var r=Jk(),i=eC(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=jk(a,r),s=qE(t,e,8,"ng-container",o);return null!==o&&Nb(s,o,!0),sb(t,n,s,jk(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];aC(o,!0);var s=r[a]=r[11].createComment("");vE(i,r,s,o),M_(s,r),bk(o)&&(eb(i,r,o),JE(i,o,r)),null!=n&&tb(r,o)}function SS(){var e=nC(),t=eC();oC()?sC():aC(e=e.parent,!1),t.firstCreatePass&&(RC(t,e),_k(e)&&t.queries.elementEnd(e))}function PS(){return Jk()}function OS(e){return!!e&&"function"==typeof e.then}var TS=function(e){return!!e&&"function"==typeof e.subscribe};function IS(e,t,n,r){var i=Jk(),a=eC(),o=nC();return function(e,t,n,r,i,a,o,s){var u=bk(r),c=e.firstCreatePass&&Ab(e),l=t[8],f=Ib(t),h=!0;if(3&r.type||s){var d=Hk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s(Bk(e[r.index]))}:r.index;if(Uk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=RS(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=RS(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=RS(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var E=t[k[_]][k[_+1]].subscribe(a),b=f.length;f.push(a,E),c&&c.push(i,r.index,b,-(b+1))}}}(a,i,i[11],o,e,t,!!n,r),IS}function AS(e,t,n,r){try{return!1!==n(r)}catch(i){return Rb(e,i),!1}}function RS(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Zk(e.index,t):t;0==(32&t[2])&&bb(o);for(var s=AS(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=AS(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function MS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Qk.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Qk.lFrame.contextLView))[8]}(e)}function xS(e,t,n){return NS(e,"",t,"",n),xS}function NS(e,t,n,r,i){var a=Jk(),o=hS(a,t,n,r);return o!==DE&&ob(eC(),IC(),a,e,o,a[11],i,!1),NS}function DS(e,t,n,r,i,a,o){var s=Jk(),u=dS(s,t,n,r,i,a);return u!==DE&&ob(eC(),IC(),s,e,u,s[11],o,!1),DS}function LS(e,t,n,r,i,a,o,s,u){var c=Jk(),l=vS(c,t,n,r,i,a,o,s);return l!==DE&&ob(eC(),IC(),c,e,l,c[11],u,!1),LS}function FS(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?VE(a):zE(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];US(e[s],t)&&(u=!0,e[s+1]=r?GE(c):BE(c)),s=r?VE(c):zE(c)}u&&(e[n+1]=r?BE(a):GE(a))}function US(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Pw(e,t)>=0}var VS={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function BS(e){return e.substring(VS.key,VS.keyEnd)}function zS(e){return e.substring(VS.value,VS.valueEnd)}function HS(e,t){var n=VS.textEnd,r=VS.key=GS(e,t,n);return n===r?-1:(r=VS.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=$S(e,r,n),r=VS.value=GS(e,r,n),r=VS.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=ZS(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=ZS(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),$S(e,r,n))}function GS(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function $S(e,t,n,r){return(t=GS(e,t,n))<n&&t++,t}function ZS(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function qS(e,t){return function(e,t,n,r){var i=Jk(),a=eC(),o=dC(2);a.firstUpdatePass&&KS(a,e,o,true),t!==DE&&cS(i,o,t)&&eP(a,a.data[OC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=Em(e_(e))),e}(t),true,o)}(e,t),qS}function WS(e){!function(e,t,n,r){var i=eC(),a=dC(2);i.firstUpdatePass&&KS(i,null,a,r);var o=Jk();if(n!==DE&&cS(o,a,n)){var s=i.data[OC()];if(rP(s,r)&&!YS(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=bm(u,n||"")),CS(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===DE&&(i=tk);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&eP(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return tk;var r=[],i=e_(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(JS,jS,e,!1)}function jS(e,t){for(var n=function(e){return function(e){VS.key=0,VS.keyEnd=0,VS.value=0,VS.valueEnd=0,VS.textEnd=e.length}(e),HS(e,GS(e,0,VS.textEnd))}(t);n>=0;n=HS(t,n))JS(e,BS(t),zS(t))}function YS(e,t){return t>=e.expandoStartIndex}function KS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[OC()],o=YS(e,n);rP(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Qk.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=XS(n=QS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=QS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==zE(r))return e[VE(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[VE(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=XS(s=QS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=XS(r,e[a].hostAttrs,n);return XS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=VE(o),u=zE(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||Pw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=VE(e[s+1]);e[r+1]=UE(h,s),0!==h&&(e[h+1]=HE(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=UE(s,0),0!==s&&(e[s+1]=HE(e[s+1],r)),s=r;else e[r+1]=UE(u,0),0===s?s=r:e[u+1]=HE(e[u+1],r),u=r;l&&(e[r+1]=BE(e[r+1])),FS(e,c,r,!0),FS(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&Pw(a,t)>=0&&(n[r+1]=GE(n[r+1]))}(t,c,e,r,a),o=UE(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function QS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=XS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function XS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),bw(e,o,!!n||t[++a]))}return void 0===e?null:e}function JS(e,t,n){bw(e,t,e_(n))}function eP(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];nP(function(e){return 1==(1&e)}(c)?tP(u,t,n,i,zE(c),o):void 0)||(nP(a)||function(e){return 2==(2&e)}(c)&&(a=tP(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Uk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:H_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=H_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,zk(OC(),n),i,a))}}function tP(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===DE&&(h=f?tk:void 0);var d=f?Sw(h,r):l===r?h:void 0;if(c&&!nP(d)&&(d=Sw(u,r)),nP(d)&&(o=d,s))return o;var v=e[i+1];i=s?VE(v):zE(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=Sw(p,r))}return o}function nP(e){return void 0!==e}function rP(e,t){return 0!=(e.flags&(t?16:32))}function iP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Jk(),r=eC(),i=e+20,a=r.firstCreatePass?qE(r,i,1,t,null):r.data[i],o=n[i]=Y_(n[11],t);vE(r,n,o,a),aC(a,!1)}function aP(e){return oP("",e,""),aP}function oP(e,t,n){var r=Jk(),i=hS(r,e,t,n);return i!==DE&&xb(r,OC(),i),oP}function sP(e,t,n,r,i){var a=Jk(),o=dS(a,e,t,n,r,i);return o!==DE&&xb(a,OC(),o),sP}function uP(e,t,n,r,i,a,o){var s=Jk(),u=vS(s,e,t,n,r,i,a,o);return u!==DE&&xb(s,OC(),u),uP}function cP(e,t,n){var r=Jk();return cS(r,hC(),t)&&ob(eC(),IC(),r,e,t,r[11],n,!0),cP}var lP=void 0,fP=["en",[["a","p"],["AM","PM"],lP],[["AM","PM"],lP,lP],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],lP,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],lP,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",lP,"{1} 'at' {0}",lP],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],hP={};function dP(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=pP(t);if(n)return n;var r=t.split("-")[0];if(n=pP(r))return n;if("en"===r)return fP;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function vP(e){return dP(e)[gP.PluralCase]}function pP(e){return e in hP||(hP[e]=Jm.ng&&Jm.ng.common&&Jm.ng.common.locales&&Jm.ng.common.locales[e]),hP[e]}var gP=((gP=gP||{})[gP.LocaleId=0]="LocaleId",gP[gP.DayPeriodsFormat=1]="DayPeriodsFormat",gP[gP.DayPeriodsStandalone=2]="DayPeriodsStandalone",gP[gP.DaysFormat=3]="DaysFormat",gP[gP.DaysStandalone=4]="DaysStandalone",gP[gP.MonthsFormat=5]="MonthsFormat",gP[gP.MonthsStandalone=6]="MonthsStandalone",gP[gP.Eras=7]="Eras",gP[gP.FirstDayOfWeek=8]="FirstDayOfWeek",gP[gP.WeekendRange=9]="WeekendRange",gP[gP.DateFormat=10]="DateFormat",gP[gP.TimeFormat=11]="TimeFormat",gP[gP.DateTimeFormat=12]="DateTimeFormat",gP[gP.NumberSymbols=13]="NumberSymbols",gP[gP.NumberFormats=14]="NumberFormats",gP[gP.CurrencyCode=15]="CurrencyCode",gP[gP.CurrencySymbol=16]="CurrencySymbol",gP[gP.CurrencyName=17]="CurrencyName",gP[gP.Currencies=18]="Currencies",gP[gP.Directionality=19]="Directionality",gP[gP.PluralCase=20]="PluralCase",gP[gP.ExtraData=21]="ExtraData",gP),yP=["zero","one","two","few","many"],mP="en-US",kP={marker:"element"},CP={marker:"ICU"},wP=((wP=wP||{})[wP.SHIFT=2]="SHIFT",wP[wP.APPEND_EAGERLY=1]="APPEND_EAGERLY",wP[wP.COMMENT=2]="COMMENT",wP),_P=mP;function EP(e){(function(e,t){null==e&&xm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(_P=e.toLowerCase().replace(/_/g,"-"))}function bP(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?lE(e,0,n):Bk(n[i])}function SP(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)aE(e,o,n[a[u]],s,!1)}}function PP(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];OP(r)||TP(r,t)&&null===IP(r)&&AP(r,t.index)}}function OP(e){return!(64&e.type)}function TP(e,t){return OP(t)||e.index>t.index}function IP(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function AP(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(dE(bP,SP),e.insertBeforeIndex=t)}function RP(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function MP(e,t,n){var r=WE(e,n,64,null,null);return PP(t,r),r}function xP(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function NP(e){return e>>>17}function DP(e){return(131070&e)>>>1}var LP=0,FP=0;function UP(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=Y_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=NP(u),f=void 0,h=void 0;if(null===o&&(o=l,i=uE(a,r)),l===o?(f=r,h=i):(f=null,h=Bk(n[l])),null!==h){var d=DP(u);aE(a,h,n[d],f,!1);var v=RP(e,d);if(null!==v&&"object"==typeof v){var p=xP(v,n);null!==p&&UP(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];gb(a,zk(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case CP:var m=t[++s],k=t[++s];null===n[k]&&M_(n[k]=Q_(a,m),n);break;case kP:var C=t[++s],w=t[++s];null===n[w]&&M_(n[w]=X_(a,C,null),n)}}}function VP(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=Am(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?gb(t[11],t[f],null,v,h,u,d):ob(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&K_(t[11],p,u);break;case 2:zP(e,RP(e,f),t,u);break;case 3:BP(e,RP(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=RP(e,g>>>2);t[y.currentCaseLViewIndex]<0&&BP(e,y,r,t)}}a+=s}}function BP(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=LP;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),VP(e,r,t.update[i],n,a)}}function zP(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=vP(t)(parseInt(e,10)),r=yP[n];return void 0!==r?r:"other"}(t,_P);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(xP(t,n)!==i&&(HP(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&UP(e,t.create[i],n,a)}}function HP(e,t,n){var r=xP(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=zk(o,n);null!==s&&mE(n[11],s)}else HP(e,RP(e,~o),n)}}function GP(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=xP(e,n);t=null!==i?e.remove[i]:tk}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var $P=/\ufffd(\d+):?\d*\ufffd/gi,ZP=/\ufffd(\d+)\ufffd/,qP=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,WP=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,jP=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,YP=/\uE500/g;function KP(e,t,n,r,i,a,o){var s=jE(e,r,1,null),u=s<<wP.SHIFT,c=iC();t===c&&(c=null),null===c&&(u|=wP.APPEND_EAGERLY),o&&(u|=wP.COMMENT,function(e){void 0===z_&&(z_=e())}(GP)),i.push(u,null===a?"":a);var l=WE(e,s,o?32:1,null===a?"":a,null);PP(n,l);var f=l.index;return aC(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(dE(bP,SP),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&xm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function QP(e,t,n,r,i,a,o){var s=o.match($P),u=KP(e,t,n,a,r,s?null:o,!1);s&&XP(i,o,u.index,null,0,null)}function XP(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split($P),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=JP(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function JP(e){return 1<<Math.min(e,31)}function eO(e){for(var t,n,r="",i=0,a=!1;null!==(t=WP.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function tO(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:jE(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(JP(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=iO(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function nO(e){for(var t=[],n=[],r=1,i=0,a=rO(e=e.replace(qP,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=rO(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function rO(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);qP.test(s)?i.push(nO(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function iO(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=r_(Fk()).getInertBodyElement(o),h=P_(f)||f;return h?aO(e,t,n,r,u,c,l,h,i,s,0):0}function aO(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=jE(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(g_.hasOwnProperty(p)){uO(i,kP,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match($P)?k_.hasOwnProperty(k)&&XP(o,m.value,d,m.name,0,y_[k]?u_:m_[k]?c_:null):cO(i,d,m)}f=aO(e,t,n,r,i,a,o,h,d,c,l+1)|f,oO(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match($P);uO(i,null,w?"":C,u,d),oO(a,d,l),w&&(f=XP(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=ZP.exec(h.textContent||"");if(_){var E=c[parseInt(_[1],10)];uO(i,CP,"",u,d),tO(e,n,r,u,E,d),sO(a,d,l)}}h=h.nextSibling}return f}function oO(e,t,n){0===n&&e.push(t)}function sO(e,t,n){0===n&&(e.push(~t),e.push(t))}function uO(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function cO(e,t,n){e.push(t<<1|1,n.name,n.value)}function lO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=eC(),i=Jk(),a=20+e,o=jk(r.consts,t),s=iC();r.firstCreatePass&&function(e,t,n,r,i,a){var o=iC(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return eO(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return eO(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(YP," ")}(i).split(jP),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=rO(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&QP(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));tO(e,n,u,t,y,KP(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),aC(iC(),!1);else{var C=MP(e,c[0],k);c.unshift([]),aC(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=iE(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&wP.COMMENT)===wP.COMMENT,c=(o&wP.APPEND_EAGERLY)===wP.APPEND_EAGERLY,l=o>>>wP.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):Y_(i,s)),c&&null!==n&&aE(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),vC(!0)}function fO(){vC(!1)}function hO(e,t,n){lO(e,t,n),fO()}function dO(e){return function(e){e&&(LP|=1<<Math.min(FP,31)),FP++}(cS(Jk(),hC(),e)),dO}function vO(e){!function(e,t,n){if(FP>0){var r=e.data[n];VP(e,t,Array.isArray(r)?r:r.update,fC()-FP-1,LP)}LP=0,FP=0}(eC(),Jk(),e+20)}function pO(e,t,n,r,i){if(e=Om(e),Array.isArray(e))for(var a=0;a<e.length;a++)pO(e[a],t,n,r,i);else{var o=eC(),s=Jk(),u=jb(e)?e:Om(e.provide),c=Zb(e),l=nC(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(jb(e)||!e.multi){var v=new FC(c,i,mS),p=mO(u,t,i?f:f+d,h);-1===p?(JC(YC(l,s),o,u),gO(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=mO(u,t,f+d,h),y=mO(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){JC(YC(l,s),o,u);var C=function(e,t,n,r,i){var a=new FC(e,n,mS);return a.multi=[],a.index=t,a.componentProviders=0,yO(a,i,r&&!n),a}(i?CO:kO,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),gO(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else gO(o,e,g>-1?g:y,yO(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function gO(e,t,n,r){var i=jb(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function yO(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function mO(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function kO(e,t,n,r){return wO(this.multi,[])}function CO(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=sw(n,n[1],this.providerFactory.index,r);wO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else wO(a,i=[]);return i}function wO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function _O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=eC();if(r.firstCreatePass){var i=Sk(e);pO(n,r.data,r.blueprint,i,!0),pO(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var EO=vy(function e(){hy(this,e)}),bO=function(){function e(){hy(this,e)}return vy(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(Em(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),SO=function(){var e=vy(function e(){hy(this,e)});return e.NULL=new bO,e}();function PO(){}function OO(e,t){return new IO(Hk(e,t))}var TO=function(){return OO(nC(),Jk())},IO=function(){var e=vy(function e(t){hy(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=TO,e}();function AO(e){return e instanceof IO?e.nativeElement:e}var RO=vy(function e(){hy(this,e)}),MO=function(){var e=vy(function e(){hy(this,e)});return e.__NG_ELEMENT_ID__=function(){return xO()},e}(),xO=function(){var e=Jk(),t=Zk(nC().index,e);return function(e){return e[11]}(Ck(t)?t:e)},NO=function(){var e=vy(function e(){hy(this,e)});return e.\u0275prov=Nm({token:e,providedIn:"root",factory:function(){return null}}),e}(),DO=vy(function e(t){hy(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),LO=new DO("12.2.16"),FO=function(){function e(){hy(this,e)}return vy(e,[{key:"supports",value:function(e){return oS(e)}},{key:"create",value:function(e){return new VO(e)}}]),e}(),UO=function(e,t){return t},VO=function(){function e(t){hy(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||UO}return vy(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<GO(n,r,i)?t:n,o=GO(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!oS(e))throw new Error("Error trying to diff '".concat(Em(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[iS()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new BO(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new HO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new HO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),BO=vy(function e(t,n){hy(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),zO=function(){function e(){hy(this,e),this._head=null,this._tail=null}return vy(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),HO=function(){function e(){hy(this,e),this.map=new Map}return vy(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new zO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function GO(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var $O=function(){function e(){hy(this,e)}return vy(e,[{key:"supports",value:function(e){return e instanceof Map||sS(e)}},{key:"create",value:function(){return new ZO}}]),e}(),ZO=function(){function e(){hy(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return vy(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||sS(e)))throw new Error("Error trying to diff '".concat(Em(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new qO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),qO=vy(function e(t){hy(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function WO(){return new jO([new FO])}var jO=function(){var e=function(){function e(t){hy(this,e),this.factories=t}return vy(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||WO())},deps:[[e,new Zw,new $w]]}}}]),e}();return e.\u0275prov=Nm({token:e,providedIn:"root",factory:WO}),e}();function YO(){return new KO([new $O])}var KO=function(){var e=function(){function e(t){hy(this,e),this.factories=t}return vy(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||YO())},deps:[[e,new Zw,new $w]]}}}]),e}();return e.\u0275prov=Nm({token:e,providedIn:"root",factory:YO}),e}();function QO(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(Bk(a)),wk(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&QO(s[1],s,u,r)}var c=n.type;if(8&c)QO(e,t,n.child,r);else if(32&c)for(var l=G_(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=gE(t,n);if(Array.isArray(h))r.push.apply(r,sy(h));else{var d=$_(t[16]);QO(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var XO=function(){function e(t,n){hy(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return vy(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return QO(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(wk(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(eE(e,n),_w(t,n))}this._attachedToViewContainer=!1}tE(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){ib(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){bb(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){Sb(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){cC(!0);try{Sb(e,t,n)}finally{cC(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,CE(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),JO=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e))._view=e,r}return vy(n,[{key:"detectChanges",value:function(){Pb(this._view)}},{key:"checkNoChanges",value:function(){!function(e){cC(!0);try{Pb(e)}finally{cC(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(XO),eT=function(e){return function(e,t,n){if(Ek(e)&&!n){var r=Zk(e.index,t);return new XO(r,r)}return 47&e.type?new XO(t[16],t):null}(nC(),Jk(),16==(16&e))},tT=function(){var e=vy(function e(){hy(this,e)});return e.__NG_ELEMENT_ID__=eT,e}(),nT=[new $O],rT=new jO([new FO]),iT=new KO(nT),aT=function(){return uT(nC(),Jk())},oT=function(){var e=vy(function e(){hy(this,e)});return e.__NG_ELEMENT_ID__=aT,e}(),sT=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return vy(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=ZE(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),YE(t,n,e),new XO(n)}}]),n}(oT);function uT(e,t){return 4&e.type?new sT(t,e,OO(e,t)):null}var cT=vy(function e(){hy(this,e)}),lT=vy(function e(){hy(this,e)}),fT=function(){return gT(nC(),Jk())},hT=function(){var e=vy(function e(){hy(this,e)});return e.__NG_ELEMENT_ID__=fT,e}(),dT=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return vy(n,[{key:"element",get:function(){return OO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new lw(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=XC(this._hostTNode,this._hostLView);if(GC(e)){var t=ZC(e,this._hostLView),n=$C(e);return new lw(t[1].data[n+8],t)}return new lw(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=vT(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(cT,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(wk(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],ww(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=yE(u,c),f=r[11],h=uE(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,CE(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),ww(pT(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=vT(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=eE(this._lContainer,t);n&&(_w(pT(this._lContainer),t),tE(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=eE(this._lContainer,t);return n&&null!=_w(pT(this._lContainer),t)?new XO(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(hT);function vT(e){return e[8]}function pT(e){return e[8]||(e[8]=[])}function gT(e,t){var n,r=t[e.index];if(wk(r))n=r;else{var i;if(8&e.type)i=Bk(r);else{var a=t[11];i=a.createComment("");var o=Hk(e,t);aE(a,uE(a,o),i,function(e,t){return Uk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=kb(r,t,i,e),Eb(t,n)}return new dT(n,e,t)}var yT={},mT=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).ngModule=e,r}return vy(n,[{key:"resolveComponentFactory",value:function(e){var t=mk(e);return new wT(t,this.ngModule)}}]),n}(SO);function kT(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var CT=new gw("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return V_}}),wT=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(NE).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return vy(n,[{key:"inputs",get:function(){return kT(this.componentDef.inputs)}},{key:"outputs",get:function(){return kT(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,yT,i);return a!==yT||r===yT?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(RO,Vk),u=o.get(NO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(Uk(e))return e.selectRootElement(t,n===Ym.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):X_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Lk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:V_,clean:Tb,playerHandler:null,flags:0},v=rb(0,null,null,1,0,null,null,null,null,null),p=ZE(null,v,d,h,null,null,s,c,u,o);wC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=qE(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(Nb(s,u,!0),null!==e&&(UC(i,e,u),null!==s.classes&&EE(i,e,s.classes),null!==s.styles&&_E(i,e,s.styles)));var c=r.createRenderer(e,t),l=ZE(n,nb(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(JC(YC(s,n),o,t.type),lb(o,s),hb(s,n.length,1)),Eb(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)UC(c,f,["ng-version",LO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!AE(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&UC(c,f,m),k&&k.length>0&&EE(c,f,k.join(" "))}if(a=Gk(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=nC();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),db(e,r,t,jE(e,t,1,null),n));var i=sw(t,e,r.directiveStart,r);M_(i,t);var a=Hk(r,t);return a&&M_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=nC();t.contentQueries(1,o,s.directiveStart)}var u=nC();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(TC(u.index),ub(n[1],u,0,u.directiveStart,u.directiveEnd,t),cb(t,o)),o}(g,this.componentDef,p,d,[Qb]),YE(v,p,null)}finally{PC()}return new _T(this.componentType,i,OO(a,p),p,a)}}]),n}(EO),_T=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new JO(a),s.componentType=e,s}return vy(n,[{key:"injector",get:function(){return new lw(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return vy(function e(){hy(this,e)})}()),ET=new Map,bT=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;hy(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=iy(i),i.destroyCbs=[],i.componentFactoryResolver=new mT(iy(i));var a=kk(e),o=e[ok]||null;return o&&EP(o),i._bootstrapComponents=B_(a.bootstrap),i._r3Injector=Hb(e,r,[{provide:cT,useValue:iy(i)},{provide:SO,useValue:i.componentFactoryResolver}],Em(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return vy(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kb.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$m.Default;return e===Kb||e===cT||e===Lb?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(cT),ST=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).moduleType=e,null!==kk(e)&&function(e){var t=new Set;!function e(n){var r=kk(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(Em(t)," vs ").concat(Em(t.name)))}(i,ET.get(i),n),ET.set(i,n));var a,o=cy(B_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return vy(n,[{key:"create",value:function(e){return new bT(this.moduleType,e)}}]),n}(lT);function PT(e,t,n){var r=lC()+e,i=Jk();return i[r]===DE?uS(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function OT(e,t,n,r){return AT(Jk(),lC(),e,t,n,r)}function TT(e,t,n,r,i){return RT(Jk(),lC(),e,t,n,r,i)}function IT(e,t){var n=e[t];return n===DE?void 0:n}function AT(e,t,n,r,i,a){var o=t+n;return cS(e,o,i)?uS(e,o+1,a?r.call(a,i):r(i)):IT(e,o+1)}function RT(e,t,n,r,i,a,o){var s=t+n;return lS(e,s,i,a)?uS(e,s+2,o?r.call(o,i,a):r(i,a)):IT(e,s+2)}function MT(e,t){var n,r=eC(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Im("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=Ok(n.type)),o=Zm(mS);try{var s=WC(!1),u=a();return WC(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Jk(),i,u),u}finally{Zm(o)}}function xT(e,t,n){var r=e+20,i=Jk(),a=$k(i,r);return DT(i,NT(i,r)?AT(i,lC(),t,a.transform,n,a):a.transform(n))}function NT(e,t){return e[1].data[t].pure}function DT(e,t){return aS.isWrapped(t)&&(t=aS.unwrap(t),e[fC()]=DE),t}function LT(e){return function(t){setTimeout(e,void 0,t)}}var FT=function(e){ey(n,e);var t=ny(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hy(this,n),(e=t.call(this)).__isAsync=r,e}return vy(n,[{key:"emit",value:function(e){Xg(oy(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=LT(u),s&&(s=LT(s)),c&&(c=LT(c)));var f=Xg(oy(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof dy&&e.add(f),f}}]),n}(zy);function UT(){return this._results[iS()]()}var VT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];hy(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=iS(),r=e.prototype;r[n]||(r[n]=UT)}return vy(e,[{key:"changes",get:function(){return this._changes||(this._changes=new FT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=kw(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var BT=function(){function e(t){hy(this,e),this.queryList=t,this.matches=null}return vy(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),zT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];hy(this,e),this.queries=t}return vy(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==XT(e,t).matches&&this.queries[t].setDirty()}}]),e}(),HT=vy(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;hy(this,e),this.predicate=t,this.flags=n,this.read=r}),GT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];hy(this,e),this.queries=t}return vy(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),$T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;hy(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return vy(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,ZT(t,i)),this.matchTNodeWithReadOption(e,t,ow(t,e,i,!1,!1))}else n===oT?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ow(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===IO||r===hT||r===oT&&4&t.type)this.addMatch(t.index,-2);else{var i=ow(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function ZT(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function qT(e,t,n,r){return-1===n?function(e,t){return 11&e.type?OO(e,t):4&e.type?uT(e,t):null}(t,e):-2===n?function(e,t,n){return n===IO?OO(t,e):n===oT?uT(t,e):n===hT?gT(t,e):void 0}(e,t,r):sw(e,e[1],n,t)}function WT(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:qT(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function jT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=WT(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&jT(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];jT(p[1],p,c,r)}}}return r}function YT(e){var t=Jk(),n=eC(),r=yC();mC(r+1);var i=XT(n,r);if(e.dirty&&qk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?jT(n,t,r,[]):WT(n,t,i,r);e.reset(a,AO),e.notifyOnChanges()}return!0}return!1}function KT(e,t,n){var r=eC();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new GT),e.queries.track(new $T(t,-1))}(r,new HT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new VT(4==(4&n));ib(e,t,r,r.destroy),null===t[19]&&(t[19]=new zT),t[19].queries.push(new BT(r))}(r,Jk(),t)}function QT(){return e=Jk(),t=yC(),e[19].queries[t].queryList;var e,t}function XT(e,t){return e.queries.getByIndex(t)}function JT(e,t){return uT(e,t)}var eI=new gw("Application Initializer"),tI=function(){var e=function(){function e(t){var n=this;hy(this,e),this.appInits=t,this.resolve=PO,this.reject=PO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return vy(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(OS(r))t.push(r);else if(TS(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(eI,8))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),nI=new gw("AppId"),rI={provide:nI,useFactory:function(){return"".concat(iI()).concat(iI()).concat(iI())},deps:[]};function iI(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var aI=new gw("Platform Initializer"),oI=new gw("Platform ID"),sI=new gw("appBootstrapListener"),uI=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),cI=new gw("LocaleId"),lI=new gw("DefaultCurrencyCode"),fI=vy(function e(t,n){hy(this,e),this.ngModuleFactory=t,this.componentFactories=n}),hI=function(e){return new ST(e)},dI=hI,vI=function(e){return Promise.resolve(hI(e))},pI=function(e){var t=hI(e),n=B_(kk(e).declarations).reduce(function(e,t){var n=mk(t);return n&&e.push(new wT(n)),e},[]);return new fI(t,n)},gI=pI,yI=function(e){return Promise.resolve(pI(e))},mI=function(){var e=function(){function e(){hy(this,e),this.compileModuleSync=dI,this.compileModuleAsync=vI,this.compileModuleAndAllComponentsSync=gI,this.compileModuleAndAllComponentsAsync=yI}return vy(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),kI=Promise.resolve(0);function CI(e){"undefined"==typeof Zone?kI.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var wI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(hy(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new FT(!1),this.onMicrotaskEmpty=new FT(!1),this.onStable=new FT(!1),this.onError=new FT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Jm.requestAnimationFrame,t=Jm.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Jm,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,bI(e),e.isCheckStableRunning=!0,EI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),bI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return SI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),PI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return SI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),PI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,bI(e),EI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return vy(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,_I,PO,PO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),_I={};function EI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function bI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function SI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function PI(e){e._nesting--,EI(e)}var OI,TI=function(){function e(){hy(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new FT,this.onMicrotaskEmpty=new FT,this.onStable=new FT,this.onError=new FT}return vy(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),II=function(){var e=function(){function e(t){var n=this;hy(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return vy(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){wI.assertNotInAngularZone(),CI(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())CI(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(wI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),AI=function(){var e=function(){function e(){hy(this,e),this._applications=new Map,RI.addToWindow(this)}return vy(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return RI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),RI=new(function(){function e(){hy(this,e)}return vy(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),MI=!0,xI=!1,NI=new gw("AllowMultipleToken"),DI=vy(function e(t,n){hy(this,e),this.name=t,this.token=n});function LI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new gw(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=FI();if(!a||a.injector.get(NI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:Ub,useValue:"platform"});!function(e){if(OI&&!OI.destroyed&&!OI.injector.get(NI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");OI=e.get(UI);var t=e.get(aI,null);t&&t.forEach(function(e){return e()})}(Kb.create({providers:o,name:r}))}return function(e){var t=FI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function FI(){return OI&&!OI.destroyed?OI:null}var UI=function(){var e=function(){function e(t){hy(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return vy(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new TI:("zone.js"===e?void 0:e)||new wI({enableLongStackTrace:(xI=!0,MI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:wI,useValue:r}];return r.run(function(){var a=Kb.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(L_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){zI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(tI)).runInitializers(),s.donePromise.then(function(){return EP(o.injector.get(cI,mP)||mP),n._moduleDoBootstrap(o),o}));return OS(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=VI({},n);return function(e,t,n){var r=new ST(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(BI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(Em(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(Kb))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function VI(e,t){return Array.isArray(t)?t.reduce(VI,e):Object.assign(Object.assign({},e),t)}var BI=function(){var e=function(){function e(t,n,r,i,a){var o=this;hy(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Uy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Uy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){wI.assertNotInAngularZone(),CI(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){wI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=vm(t),i=function(e,t){return"number"==typeof hm(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?om(a[0]):lm(i)(mm(a,r)):fm}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new zy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return $y(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=Cm(d,u))}),g.subscribe(v),t||(t=new Ry({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=Cm(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=Cm(h,o),g.complete()}}),mm(e).subscribe(t))})(e)}}()))}return vy(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof EO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(cT),a=n.create(Kb.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(II,null),u=s&&a.injector.get(AI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),zI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=cy(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;zI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(sI,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(wI),Lw(Kb),Lw(L_),Lw(SO),Lw(tI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function zI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var HI=vy(function e(){hy(this,e)}),GI=vy(function e(){hy(this,e)}),$I={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},ZI=function(){var e=function(){function e(t,n){hy(this,e),this._compiler=t,this._config=n||$I}return vy(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Wg(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Yg(8255)(r).then(function(e){return e[i]}).then(function(e){return qI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Wg(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Yg(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return qI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(mI),Lw(GI,8))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function qI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var WI=LI(null,"core",[{provide:oI,useValue:"unknown"},{provide:UI,deps:[Kb]},{provide:AI,deps:[]},{provide:uI,deps:[]}]),jI=[{provide:BI,useClass:BI,deps:[wI,Kb,L_,SO,tI]},{provide:CT,deps:[wI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:tI,useClass:tI,deps:[[new $w,eI]]},{provide:mI,useClass:mI,deps:[]},rI,{provide:jO,useFactory:function(){return rT},deps:[]},{provide:KO,useFactory:function(){return iT},deps:[]},{provide:cI,useFactory:function(e){return EP(e=e||"undefined"!=typeof $localize&&$localize.locale||mP),e},deps:[[new Gw(cI),new $w,new Zw]]},{provide:lI,useValue:"USD"}],YI=function(){var e=vy(function e(t){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)(Lw(BI))},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:jI}),e}(),KI=null;function QI(){return KI}var XI=new gw("DocumentToken"),JI=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({factory:eA,token:e,providedIn:"platform"}),e}();function eA(){return Lw(nA)}var tA=new gw("Location Initialized"),nA=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this))._doc=e,r._init(),r}return vy(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return QI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=QI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=QI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){rA()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){rA()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(JI);return e.\u0275fac=function(t){return new(t||e)(Lw(XI))},e.\u0275prov=Nm({factory:iA,token:e,providedIn:"platform"}),e}();function rA(){return!!window.history.pushState}function iA(){return new nA(Lw(XI))}function aA(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function oA(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function sA(e){return e&&"?"!==e[0]?"?"+e:e}var uA=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({factory:cA,token:e,providedIn:"root"}),e}();function cA(e){var t=Lw(XI).location;return new fA(Lw(JI),t&&t.origin||"")}var lA=new gw("appBaseHref"),fA=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;if(hy(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,ry(i)}return vy(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return aA(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+sA(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+sA(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+sA(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(uA);return e.\u0275fac=function(t){return new(t||e)(Lw(JI),Lw(lA,8))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),hA=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return vy(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=aA(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+sA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+sA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(uA);return e.\u0275fac=function(t){return new(t||e)(Lw(JI),Lw(lA,8))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),dA=function(){var e=function(){function e(t,n){var r=this;hy(this,e),this._subject=new FT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=oA(pA(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return vy(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+sA(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,pA(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sA(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sA(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(uA),Lw(JI))},e.normalizeQueryParams=sA,e.joinWithSlash=aA,e.stripTrailingSlash=oA,e.\u0275prov=Nm({factory:vA,token:e,providedIn:"root"}),e}();function vA(){return new dA(Lw(uA),Lw(JI))}function pA(e){return e.replace(/\/index.html$/,"")}var gA=((gA=gA||{})[gA.Decimal=0]="Decimal",gA[gA.Percent=1]="Percent",gA[gA.Currency=2]="Currency",gA[gA.Scientific=3]="Scientific",gA),yA=((yA=yA||{})[yA.Zero=0]="Zero",yA[yA.One=1]="One",yA[yA.Two=2]="Two",yA[yA.Few=3]="Few",yA[yA.Many=4]="Many",yA[yA.Other=5]="Other",yA),mA=((mA=mA||{})[mA.Format=0]="Format",mA[mA.Standalone=1]="Standalone",mA),kA=((kA=kA||{})[kA.Narrow=0]="Narrow",kA[kA.Abbreviated=1]="Abbreviated",kA[kA.Wide=2]="Wide",kA[kA.Short=3]="Short",kA),CA=((CA=CA||{})[CA.Short=0]="Short",CA[CA.Medium=1]="Medium",CA[CA.Long=2]="Long",CA[CA.Full=3]="Full",CA),wA=((wA=wA||{})[wA.Decimal=0]="Decimal",wA[wA.Group=1]="Group",wA[wA.List=2]="List",wA[wA.PercentSign=3]="PercentSign",wA[wA.PlusSign=4]="PlusSign",wA[wA.MinusSign=5]="MinusSign",wA[wA.Exponential=6]="Exponential",wA[wA.SuperscriptingExponent=7]="SuperscriptingExponent",wA[wA.PerMille=8]="PerMille",wA[wA.Infinity=9]="Infinity",wA[wA.NaN=10]="NaN",wA[wA.TimeSeparator=11]="TimeSeparator",wA[wA.CurrencyDecimal=12]="CurrencyDecimal",wA[wA.CurrencyGroup=13]="CurrencyGroup",wA);function _A(e,t){return TA(dP(e)[gP.DateFormat],t)}function EA(e,t){return TA(dP(e)[gP.TimeFormat],t)}function bA(e,t){return TA(dP(e)[gP.DateTimeFormat],t)}function SA(e,t){var n=dP(e),r=n[gP.NumberSymbols][t];if(void 0===r){if(t===wA.CurrencyDecimal)return n[gP.NumberSymbols][wA.Decimal];if(t===wA.CurrencyGroup)return n[gP.NumberSymbols][wA.Group]}return r}var PA=vP;function OA(e){if(!e[gP.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[gP.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function TA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function IA(e){var t=Wg(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var AA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,RA={},MA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,xA=((xA=xA||{})[xA.Short=0]="Short",xA[xA.ShortGMT=1]="ShortGMT",xA[xA.Long=2]="Long",xA[xA.Extended=3]="Extended",xA),NA=((NA=NA||{})[NA.FullYear=0]="FullYear",NA[NA.Month=1]="Month",NA[NA.Date=2]="Date",NA[NA.Hours=3]="Hours",NA[NA.Minutes=4]="Minutes",NA[NA.Seconds=5]="Seconds",NA[NA.FractionalSeconds=6]="FractionalSeconds",NA[NA.Day=7]="Day",NA),DA=((DA=DA||{})[DA.DayPeriods=0]="DayPeriods",DA[DA.Days=1]="Days",DA[DA.Months=2]="Months",DA[DA.Eras=3]="Eras",DA);function LA(e,t,n,r){var i=function(e){if(YA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=Wg(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return FA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(AA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!YA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=UA(n,t)||t;for(var a,o=[];t;){if(!(a=MA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=jA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(jA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(WA[e])return WA[e];var t;switch(e){case"G":case"GG":case"GGG":t=HA(DA.Eras,kA.Abbreviated);break;case"GGGG":t=HA(DA.Eras,kA.Wide);break;case"GGGGG":t=HA(DA.Eras,kA.Narrow);break;case"y":t=zA(NA.FullYear,1,0,!1,!0);break;case"yy":t=zA(NA.FullYear,2,0,!0,!0);break;case"yyy":t=zA(NA.FullYear,3,0,!1,!0);break;case"yyyy":t=zA(NA.FullYear,4,0,!1,!0);break;case"Y":t=qA(1);break;case"YY":t=qA(2,!0);break;case"YYY":t=qA(3);break;case"YYYY":t=qA(4);break;case"M":case"L":t=zA(NA.Month,1,1);break;case"MM":case"LL":t=zA(NA.Month,2,1);break;case"MMM":t=HA(DA.Months,kA.Abbreviated);break;case"MMMM":t=HA(DA.Months,kA.Wide);break;case"MMMMM":t=HA(DA.Months,kA.Narrow);break;case"LLL":t=HA(DA.Months,kA.Abbreviated,mA.Standalone);break;case"LLLL":t=HA(DA.Months,kA.Wide,mA.Standalone);break;case"LLLLL":t=HA(DA.Months,kA.Narrow,mA.Standalone);break;case"w":t=ZA(1);break;case"ww":t=ZA(2);break;case"W":t=ZA(1,!0);break;case"d":t=zA(NA.Date,1);break;case"dd":t=zA(NA.Date,2);break;case"c":case"cc":t=zA(NA.Day,1);break;case"ccc":t=HA(DA.Days,kA.Abbreviated,mA.Standalone);break;case"cccc":t=HA(DA.Days,kA.Wide,mA.Standalone);break;case"ccccc":t=HA(DA.Days,kA.Narrow,mA.Standalone);break;case"cccccc":t=HA(DA.Days,kA.Short,mA.Standalone);break;case"E":case"EE":case"EEE":t=HA(DA.Days,kA.Abbreviated);break;case"EEEE":t=HA(DA.Days,kA.Wide);break;case"EEEEE":t=HA(DA.Days,kA.Narrow);break;case"EEEEEE":t=HA(DA.Days,kA.Short);break;case"a":case"aa":case"aaa":t=HA(DA.DayPeriods,kA.Abbreviated);break;case"aaaa":t=HA(DA.DayPeriods,kA.Wide);break;case"aaaaa":t=HA(DA.DayPeriods,kA.Narrow);break;case"b":case"bb":case"bbb":t=HA(DA.DayPeriods,kA.Abbreviated,mA.Standalone,!0);break;case"bbbb":t=HA(DA.DayPeriods,kA.Wide,mA.Standalone,!0);break;case"bbbbb":t=HA(DA.DayPeriods,kA.Narrow,mA.Standalone,!0);break;case"B":case"BB":case"BBB":t=HA(DA.DayPeriods,kA.Abbreviated,mA.Format,!0);break;case"BBBB":t=HA(DA.DayPeriods,kA.Wide,mA.Format,!0);break;case"BBBBB":t=HA(DA.DayPeriods,kA.Narrow,mA.Format,!0);break;case"h":t=zA(NA.Hours,1,-12);break;case"hh":t=zA(NA.Hours,2,-12);break;case"H":t=zA(NA.Hours,1);break;case"HH":t=zA(NA.Hours,2);break;case"m":t=zA(NA.Minutes,1);break;case"mm":t=zA(NA.Minutes,2);break;case"s":t=zA(NA.Seconds,1);break;case"ss":t=zA(NA.Seconds,2);break;case"S":t=zA(NA.FractionalSeconds,1);break;case"SS":t=zA(NA.FractionalSeconds,2);break;case"SSS":t=zA(NA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=GA(xA.Short);break;case"ZZZZZ":t=GA(xA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=GA(xA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=GA(xA.Long);break;default:return null}return WA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function FA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function UA(e,t){var n=function(e){return dP(e)[gP.LocaleId]}(e);if(RA[n]=RA[n]||{},RA[n][t])return RA[n][t];var r="";switch(t){case"shortDate":r=_A(e,CA.Short);break;case"mediumDate":r=_A(e,CA.Medium);break;case"longDate":r=_A(e,CA.Long);break;case"fullDate":r=_A(e,CA.Full);break;case"shortTime":r=EA(e,CA.Short);break;case"mediumTime":r=EA(e,CA.Medium);break;case"longTime":r=EA(e,CA.Long);break;case"fullTime":r=EA(e,CA.Full);break;case"short":var i=UA(e,"shortTime"),a=UA(e,"shortDate");r=VA(bA(e,CA.Short),[i,a]);break;case"medium":var o=UA(e,"mediumTime"),s=UA(e,"mediumDate");r=VA(bA(e,CA.Medium),[o,s]);break;case"long":var u=UA(e,"longTime"),c=UA(e,"longDate");r=VA(bA(e,CA.Long),[u,c]);break;case"full":var l=UA(e,"fullTime"),f=UA(e,"fullDate");r=VA(bA(e,CA.Full),[l,f])}return r&&(RA[n][t]=r),r}function VA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function BA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function zA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case NA.FullYear:return t.getFullYear();case NA.Month:return t.getMonth();case NA.Date:return t.getDate();case NA.Hours:return t.getHours();case NA.Minutes:return t.getMinutes();case NA.Seconds:return t.getSeconds();case NA.FractionalSeconds:return t.getMilliseconds();case NA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===NA.Hours)0===s&&-12===n&&(s=12);else if(e===NA.FractionalSeconds)return function(e,t){return BA(e,3).substr(0,t)}(s,t);var u=SA(o,wA.MinusSign);return BA(s,t,u,r,i)}}function HA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mA.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case DA.Months:return function(e,t,n){var r=dP(e),i=TA([r[gP.MonthsFormat],r[gP.MonthsStandalone]],t);return TA(i,n)}(t,i,r)[e.getMonth()];case DA.Days:return function(e,t,n){var r=dP(e),i=TA([r[gP.DaysFormat],r[gP.DaysStandalone]],t);return TA(i,n)}(t,i,r)[e.getDay()];case DA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=dP(e);return OA(t),(t[gP.ExtraData][2]||[]).map(function(e){return"string"==typeof e?IA(e):[IA(e[0]),IA(e[1])]})}(t),c=function(e,t,n){var r=dP(e);OA(r);var i=TA([r[gP.ExtraData][0],r[gP.ExtraData][1]],t)||[];return TA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Wg(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=dP(e),i=TA([r[gP.DayPeriodsFormat],r[gP.DayPeriodsStandalone]],t);return TA(i,n)}(t,i,r)[o<12?0:1];case DA.Eras:return function(e,t){return TA(dP(e)[gP.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function GA(e){return function(t,n,r){var i=-1*r,a=SA(n,wA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case xA.Short:return(i>=0?"+":"")+BA(o,2,a)+BA(Math.abs(i%60),2,a);case xA.ShortGMT:return"GMT"+(i>=0?"+":"")+BA(o,1,a);case xA.Long:return"GMT"+(i>=0?"+":"")+BA(o,2,a)+":"+BA(Math.abs(i%60),2,a);case xA.Extended:return 0===r?"Z":(i>=0?"+":"")+BA(o,2,a)+":"+BA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function $A(e){return FA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function ZA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=$A(n),u=function(e){var t=FA(e,0,1).getDay();return FA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return BA(i,e,SA(r,wA.MinusSign))}}function qA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return BA($A(n).getFullYear(),e,SA(r,wA.MinusSign),t)}}var WA={};function jA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function YA(e){return e instanceof Date&&!isNaN(e.valueOf())}var KA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function QA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var XA=vy(function e(){hy(this,e)}),JA=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).locale=e,r}return vy(n,[{key:"getPluralCategory",value:function(e,t){switch(PA(t||this.locale)(e)){case yA.Zero:return"zero";case yA.One:return"one";case yA.Two:return"two";case yA.Few:return"few";case yA.Many:return"many";default:return"other"}}}]),n}(XA);return e.\u0275fac=function(t){return new(t||e)(Lw(cI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function eR(e,t){t=encodeURIComponent(t);var n,r=cy(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Wg(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var tR=function(){var e=function(){function e(t,n,r,i){hy(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return vy(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(oS(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(Em(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(jO),mS(KO),mS(IO),mS(MO))},e.\u0275dir=gk({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),nR=function(){function e(t,n,r,i){hy(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return vy(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),rR=function(){var e=function(){function e(t,n,r){hy(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return vy(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new nR(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new iR(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new iR(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(hT),mS(oT),mS(jO))},e.\u0275dir=gk({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),iR=vy(function e(t,n){hy(this,e),this.record=t,this.view=n}),aR=function(){var e=function(){function e(t,n){hy(this,e),this._viewContainer=t,this._context=new oR,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return vy(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){sR("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){sR("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(hT),mS(oT))},e.\u0275dir=gk({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),oR=vy(function e(){hy(this,e),this.$implicit=null,this.ngIf=null});function sR(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(Em(t),"'."))}var uR=function(){var e=function(){function e(t){hy(this,e),this._locale=t}return vy(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(KA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=QA(v)),null!=p&&(f=QA(p)),null!=g?h=QA(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(SA(n,r)),C.length&&(s+=SA(n,i)+C.join("")),k&&(s+=SA(n,wA.Exponential)+"+"+k)}else s=SA(n,wA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return dP(e)[gP.NumberFormats][t]}(t,gA.Decimal),SA(t,wA.MinusSign)),t,wA.Group,wA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(Em(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(cI,16))},e.\u0275pipe=yk({name:"number",type:e,pure:!0}),e}(),cR=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[{provide:XA,useClass:JA}]}),e}(),lR=function(){var e=vy(function e(){hy(this,e)});return e.\u0275prov=Nm({token:e,providedIn:"root",factory:function(){return new fR(Lw(XI),window)}}),e}(),fR=function(){function e(t,n){hy(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return vy(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=hR(this.window.history)||hR(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function hR(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var dR,vR=vy(function e(){hy(this,e)}),pR=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(gR=gR||document.querySelector("base"))?gR.getAttribute("href"):null;return null==t?null:function(e){(dR=dR||document.createElement("a")).setAttribute("href",e);var t=dR.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){gR=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return eR(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,KI||(KI=e)}}]),n}(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return vy(n)}(function(){return vy(function e(){hy(this,e)})}())),gR=null,yR=new gw("TRANSITION_ID"),mR=[{provide:eI,useFactory:function(e,t,n){return function(){n.get(tI).donePromise.then(function(){for(var n=QI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[yR,XI,Kb],multi:!0}],kR=function(){function e(){hy(this,e)}return vy(e,[{key:"addToWindow",value:function(e){Jm.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Jm.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Jm.getAllAngularRootElements=function(){return e.getAllRootElements()},Jm.frameworkStabilizers||(Jm.frameworkStabilizers=[]),Jm.frameworkStabilizers.push(function(e){var t=Jm.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?QI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,RI=t}}]),e}(),CR=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),wR=new gw("EventManagerPlugins"),_R=function(){var e=function(){function e(t,n){var r=this;hy(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return vy(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(wR),Lw(wI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),ER=function(){function e(t){hy(this,e),this._doc=t}return vy(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=QI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),bR=function(){var e=function(){function e(){hy(this,e),this._stylesSet=new Set}return vy(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),SR=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return vy(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(PR),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(PR)})}}]),n}(bR);return e.\u0275fac=function(t){return new(t||e)(Lw(XI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function PR(e){QI().remove(e)}var OR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},TR=/%COMP%/g;function IR(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?IR(e,i,n):(i=i.replace(TR,e),n.push(i))}return n}function AR(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var RR=function(){var e=function(){function e(t,n,r){hy(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new MR(t)}return vy(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ym.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new xR(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Ym.ShadowDom:return new NR(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=IR(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(_R),Lw(SR),Lw(nI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),MR=function(){function e(t){hy(this,e),this.eventManager=t,this.data=Object.create(null)}return vy(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(OR[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=OR[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=OR[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(H_.DashCase|H_.Important)?e.style.setProperty(t,n,r&H_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&H_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,AR(n)):this.eventManager.addEventListener(e,t,AR(n))}}]),e}(),xR=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;hy(this,n),(o=t.call(this,e)).component=i;var s=IR(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(TR,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(TR,a+"-"+i.id),o}return vy(n,[{key:"applyToHost",value:function(e){Xg(oy(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=Xg(oy(n.prototype),"createElement",this).call(this,e,t);return Xg(oy(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(MR),NR=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;hy(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=IR(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return vy(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return Xg(oy(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return Xg(oy(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return Xg(oy(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(Xg(oy(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(MR),DR=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,e)}return vy(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(ER);return e.\u0275fac=function(t){return new(t||e)(Lw(XI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),LR=["alt","control","meta","shift"],FR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},UR={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},VR={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},BR=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,e)}return vy(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return QI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(LR.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&UR.hasOwnProperty(t)&&(t=UR[t]))}return FR[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),LR.forEach(function(r){r!=n&&VR[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(ER);return e.\u0275fac=function(t){return new(t||e)(Lw(XI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),zR=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({factory:function(){return Lw(HR)},token:e,providedIn:"root"}),e}(),HR=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this))._doc=e,r}return vy(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case O_.NONE:return t;case O_.HTML:return t_(t,"HTML")?e_(t):S_(this._doc,String(t)).toString();case O_.STYLE:return t_(t,"Style")?e_(t):t;case O_.SCRIPT:if(t_(t,"Script"))return e_(t);throw new Error("unsafe value used in a script context");case O_.URL:return n_(t),t_(t,"URL")?e_(t):u_(String(t));case O_.RESOURCE_URL:if(t_(t,"ResourceURL"))return e_(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Yw(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Kw(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new Qw(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Xw(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new Jw(e)}(e)}}]),n}(zR);return e.\u0275fac=function(t){return new(t||e)(Lw(XI))},e.\u0275prov=Nm({factory:function(){return function(e){return new HR(e.get(XI))}(Lw(Lb))},token:e,providedIn:"root"}),e}(),GR=[{provide:oI,useValue:"browser"},{provide:aI,useValue:function(){pR.makeCurrent(),kR.init()},multi:!0},{provide:XI,useFactory:function(){return e=document,Dk=e,document;var e},deps:[]}],$R=LI(WI,"browser",GR),ZR=[[],{provide:Ub,useValue:"root"},{provide:L_,useFactory:function(){return new L_},deps:[]},{provide:wR,useClass:DR,multi:!0,deps:[XI,wI,oI]},{provide:wR,useClass:BR,multi:!0,deps:[XI]},[],{provide:RR,useClass:RR,deps:[_R,SR,nI]},{provide:RO,useExisting:RR},{provide:bR,useExisting:SR},{provide:SR,useClass:SR,deps:[XI]},{provide:II,useClass:II,deps:[wI]},{provide:_R,useClass:_R,deps:[wR,wI]},{provide:vR,useClass:CR,deps:[]},[]],qR=function(){var e=function(){function e(t){if(hy(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return vy(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:nI,useValue:t.appId},{provide:yR,useExisting:nI},mR]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(e,12))},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:ZR,imports:[cR,YI]}),e}();"undefined"!=typeof window&&window;var WR=Array.isArray,jR=Object.getPrototypeOf,YR=Object.prototype,KR=Object.keys;function QR(e){if(1===e.length){var t=e[0];if(WR(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&jR(e)===YR}(t)){var n=KR(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var XR=Array.isArray;function JR(e){return qy(function(t){return function(e,t){return XR(t)?e.apply(void 0,sy(t)):e(t)}(e,t)})}function eM(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var tM=function(){var e=function(){function e(t,n){hy(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return vy(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(MO),mS(IO))},e.\u0275dir=gk({type:e}),e}(),nM=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n)}(tM);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275dir=gk({type:t,features:[Xb]}),t}(),rM=new gw("NgValueAccessor"),iM={provide:rM,useExisting:Pm(function(){return oM}),multi:!0},aM=new gw("CompositionEventMode"),oM=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=QI()?QI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return vy(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(tM);return e.\u0275fac=function(t){return new(t||e)(mS(MO),mS(IO),mS(aM,8))},e.\u0275dir=gk({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&IS("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[_O([iM]),Xb]}),e}();function sM(e){return null==e||0===e.length}function uM(e){return null!=e&&"number"==typeof e.length}var cM=new gw("NgValidators"),lM=new gw("NgAsyncValidators"),fM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hM=function(){function e(){hy(this,e)}return vy(e,null,[{key:"min",value:function(e){return t=e,function(e){if(sM(e.value)||sM(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(sM(e.value)||sM(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return dM(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return sM((t=e).value)||fM.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return sM(e.value)||!uM(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return vM(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(sM(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):pM;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return wM(e)}},{key:"composeAsync",value:function(e){return EM(e)}}]),e}();function dM(e){return sM(e.value)?{required:!0}:null}function vM(e){return function(t){return uM(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function pM(e){return null}function gM(e){return null!=e}function yM(e){var t=OS(e)?mm(e):e;return TS(t),t}function mM(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function kM(e,t){return t.map(function(t){return t(e)})}function CM(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function wM(e){if(!e)return null;var t=e.filter(gM);return 0==t.length?null:function(e){return mM(kM(e,t))}}function _M(e){return null!=e?wM(CM(e)):null}function EM(e){if(!e)return null;var t=e.filter(gM);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=dm(t),i=QR(t),a=i.args,o=i.keys,s=new Uy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;om(a[t]).subscribe(new Zy(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?eM(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(JR(r)):s}(kM(e,t).map(yM)).pipe(qy(mM))}}function bM(e){return null!=e?EM(CM(e)):null}function SM(e,t){return null===e?[t]:Array.isArray(e)?[].concat(sy(e),[t]):[e,t]}function PM(e){return e._rawValidators}function OM(e){return e._rawAsyncValidators}function TM(e){return e?Array.isArray(e)?e:[e]:[]}function IM(e,t){return Array.isArray(e)?e.includes(t):e===t}function AM(e,t){var n=TM(t);return TM(e).forEach(function(e){IM(n,e)||n.push(e)}),n}function RM(e,t){return TM(t).filter(function(t){return!IM(e,t)})}var MM=function(){var e=function(){function e(){hy(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return vy(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=_M(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=bM(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=gk({type:e}),e}(),xM=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(MM);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275dir=gk({type:t,features:[Xb]}),t}(),NM=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return vy(n)}(MM),DM=function(){function e(t){hy(this,e),this._cd=t}return vy(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),LM=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,e)}return vy(n)}(DM);return e.\u0275fac=function(t){return new(t||e)(mS(NM,2))},e.\u0275dir=gk({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&qS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Xb]}),e}(),FM=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,e)}return vy(n)}(DM);return e.\u0275fac=function(t){return new(t||e)(mS(xM,10))},e.\u0275dir=gk({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&qS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[Xb]}),e}();function UM(e,t){return[].concat(sy(t.path),[e])}function VM(e,t){HM(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&$M(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&$M(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function BM(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),GM(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function zM(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function HM(e,t){var n=PM(e);null!==t.validator?e.setValidators(SM(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=OM(e);null!==t.asyncValidator?e.setAsyncValidators(SM(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};zM(t._rawValidators,i),zM(t._rawAsyncValidators,i)}function GM(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=PM(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=OM(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return zM(t._rawValidators,s),zM(t._rawAsyncValidators,s),n}function $M(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function ZM(e,t){HM(e,t)}function qM(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function WM(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function jM(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===oM?n=e:function(e){return Object.getPrototypeOf(e.constructor)===nM}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function YM(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var KM="VALID",QM="INVALID",XM="PENDING",JM="DISABLED";function ex(e){return(ix(e)?e.validators:e)||null}function tx(e){return Array.isArray(e)?_M(e):e||null}function nx(e,t){return(ix(t)?t.asyncValidators:e)||null}function rx(e){return Array.isArray(e)?bM(e):e||null}function ix(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var ax=function(){function e(t,n){hy(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=tx(this._rawValidators),this._composedAsyncValidatorFn=rx(this._rawAsyncValidators)}return vy(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===KM}},{key:"invalid",get:function(){return this.status===QM}},{key:"pending",get:function(){return this.status==XM}},{key:"disabled",get:function(){return this.status===JM}},{key:"enabled",get:function(){return this.status!==JM}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=tx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=rx(e)}},{key:"addValidators",value:function(e){this.setValidators(AM(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(AM(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(RM(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(RM(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return IM(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return IM(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=XM,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=JM,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=KM,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===KM||this.status===XM)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?JM:KM}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=XM,this._hasOwnPendingAsyncValidator=!0;var n=yM(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof sx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof ux&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new FT,this.statusChanges=new FT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?JM:this.errors?QM:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(XM)?XM:this._anyControlsHaveStatus(QM)?QM:KM}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){ix(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),ox=function(e){ey(n,e);var t=ny(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return hy(this,n),(e=t.call(this,ex(i),nx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return vy(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){YM(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){YM(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(ax),sx=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,ex(r),nx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return vy(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof ox?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(ax),ux=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,ex(r),nx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return vy(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof ox?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=cy(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(ax),cx={provide:xM,useExisting:Pm(function(){return fx})},lx=Promise.resolve(null),fx=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new FT,i.form=new sx({},_M(e),bM(r)),i}return vy(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;lx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),VM(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;lx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),YM(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;lx.then(function(){var n=t._findContainer(e.path),r=new sx({});ZM(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;lx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;lx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,WM(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(mS(cM,10),mS(lM,10))},e.\u0275dir=gk({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&IS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_O([cx]),Xb]}),e}(),hx={provide:NM,useExisting:Pm(function(){return vx})},dx=Promise.resolve(null),vx=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this)).control=new ox,o._registered=!1,o.update=new FT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=jM(0,a),o}return vy(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),qM(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?UM(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){VM(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;dx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;dx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(NM);return e.\u0275fac=function(t){return new(t||e)(mS(xM,9),mS(cM,10),mS(lM,10),mS(rM,10))},e.\u0275dir=gk({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[_O([hx]),Xb,Ik]}),e}(),px=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=gk({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),gx=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({}),e}(),yx={provide:rM,useExisting:Pm(function(){return mx}),multi:!0},mx=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(nM);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275dir=gk({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&IS("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[_O([yx]),Xb]}),t}(),kx=new gw("NgModelWithFormControlWarning"),Cx={provide:xM,useExisting:Pm(function(){return wx})},wx=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new FT,i._setValidators(e),i._setAsyncValidators(r),i}return vy(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(GM(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return VM(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){BM(e.control||null,e,!1),YM(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,WM(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(BM(n||null,t),r instanceof ox&&(VM(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);ZM(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return GM(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){HM(this.form,this),this._oldForm&&GM(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(mS(cM,10),mS(lM,10))},e.\u0275dir=gk({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&IS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_O([Cx]),Xb,Ik]}),e}(),_x={provide:NM,useExisting:Pm(function(){return Ex})},Ex=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new FT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=jM(0,a),s}return vy(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),qM(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return UM(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(NM);return e.\u0275fac=function(t){return new(t||e)(mS(xM,13),mS(cM,10),mS(lM,10),mS(rM,10),mS(kx,8))},e.\u0275dir=gk({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[_O([_x]),Xb,Ik]}),e._ngModelWarningSentOnce=!1,e}(),bx={provide:rM,useExisting:Pm(function(){return Px}),multi:!0};function Sx(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Px=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return vy(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=Sx(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(nM);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275dir=gk({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&IS("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[_O([bx]),Xb]}),t}(),Ox=function(){var e=function(){function e(t,n,r){hy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return vy(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Sx(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(IO),mS(MO),mS(Px,9))},e.\u0275dir=gk({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),Tx={provide:rM,useExisting:Pm(function(){return Ax}),multi:!0};function Ix(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Ax=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return vy(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(nM);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275dir=gk({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&IS("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[_O([Tx]),Xb]}),t}(),Rx=function(){var e=function(){function e(t,n,r){hy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return vy(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(Ix(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(Ix(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(IO),mS(MO),mS(Ax,9))},e.\u0275dir=gk({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),Mx={provide:cM,useExisting:Pm(function(){return xx}),multi:!0},xx=function(){var e=function(){function e(){hy(this,e),this._required=!1}return vy(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?dM(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=gk({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&fS("required",t.required?"":null)},inputs:{required:"required"},features:[_O([Mx])]}),e}(),Nx={provide:cM,useExisting:Pm(function(){return Dx}),multi:!0},Dx=function(){var e=function(){function e(){hy(this,e),this._validator=pM}return vy(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?vM(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):pM}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=gk({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&fS("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[_O([Nx]),Ik]}),e}(),Lx=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({imports:[[gx]]}),e}(),Fx=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({imports:[Lx]}),e}(),Ux=function(){var e=function(){function e(){hy(this,e)}return vy(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:kx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({imports:[Lx]}),e}(),Vx=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new sx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new ox(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new ux(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof ox||e instanceof sx||e instanceof ux?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({factory:function(){return new e},token:e,providedIn:Ux}),e}();function Bx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return mm(t,vm(t))}function zx(e,t){return ay(t)?cm(e,t,1):cm(e,1)}function Hx(e,t){return $y(function(n,r){var i=0;n.subscribe(new Zy(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var Gx=vy(function e(){hy(this,e)}),$x=vy(function e(){hy(this,e)}),Zx=function(){function e(t){var n=this;hy(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return vy(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,sy(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),qx=function(){function e(){hy(this,e)}return vy(e,[{key:"encodeKey",value:function(e){return Yx(e)}},{key:"encodeValue",value:function(e){return Yx(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),Wx=/%(\d[a-f0-9])/gi,jx={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Yx(e){return encodeURIComponent(e).replace(Wx,function(e,t){var n;return null!==(n=jx[t])&&void 0!==n?n:e})}function Kx(e){return"".concat(e)}var Qx=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(hy(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new qx,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Wg(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return vy(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(Kx(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(Kx(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),Xx=function(){function e(){hy(this,e),this.map=new Map}return vy(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function Jx(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function eN(e){return"undefined"!=typeof Blob&&e instanceof Blob}function tN(e){return"undefined"!=typeof FormData&&e instanceof FormData}var nN=function(){function e(t,n,r,i){var a;if(hy(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new Zx),this.context||(this.context=new Xx),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new Qx,this.urlWithParams=n}return vy(e,[{key:"serializeBody",value:function(){return null===this.body?null:Jx(this.body)||eN(this.body)||tN(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Qx?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||tN(this.body)?null:eN(this.body)?this.body.type||null:Jx(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Qx?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),rN=((rN=rN||{})[rN.Sent=0]="Sent",rN[rN.UploadProgress=1]="UploadProgress",rN[rN.ResponseHeader=2]="ResponseHeader",rN[rN.DownloadProgress=3]="DownloadProgress",rN[rN.Response=4]="Response",rN[rN.User=5]="User",rN),iN=vy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";hy(this,e),this.headers=t.headers||new Zx,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),aN=function(e){ey(n,e);var t=ny(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hy(this,n),(e=t.call(this,r)).type=rN.ResponseHeader,e}return vy(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(iN),oN=function(e){ey(n,e);var t=ny(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hy(this,n),(e=t.call(this,r)).type=rN.Response,e.body=void 0!==r.body?r.body:null,e}return vy(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(iN),sN=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return vy(n)}(iN);function uN(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var cN=function(){var e=function(){function e(t){hy(this,e),this.handler=t}return vy(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof nN?n=e:(r=o.headers instanceof Zx?o.headers:new Zx(o.headers),o.params&&(i=o.params instanceof Qx?o.params:new Qx({fromObject:o.params})),n=new nN(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=Bx(n).pipe(zx(function(e){return a.handler.handle(e)}));if(e instanceof nN||"events"===o.observe)return s;var u=s.pipe(Hx(function(e){return e instanceof oN}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(qy(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(qy(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(qy(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(qy(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new Qx).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,uN(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,uN(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,uN(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(Gx))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),lN=function(){function e(t,n){hy(this,e),this.next=t,this.interceptor=n}return vy(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),fN=new gw("HTTP_INTERCEPTORS"),hN=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),dN=/^\)\]\}',?\n/,vN=function(){var e=function(){function e(t){hy(this,e),this.xhrFactory=t}return vy(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Uy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new Zx(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new aN({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(dN,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new oN({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new sN({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new sN({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:rN.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:rN.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:rN.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(vR))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),pN=new gw("XSRF_COOKIE_NAME"),gN=new gw("XSRF_HEADER_NAME"),yN=vy(function e(){hy(this,e)}),mN=function(){var e=function(){function e(t,n,r){hy(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return vy(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=eR(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(XI),Lw(oI),Lw(pN))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),kN=function(){var e=function(){function e(t,n){hy(this,e),this.tokenService=t,this.headerName=n}return vy(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(yN),Lw(gN))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),CN=function(){var e=function(){function e(t,n){hy(this,e),this.backend=t,this.injector=n,this.chain=null}return vy(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(fN,[]);this.chain=t.reduceRight(function(e,t){return new lN(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw($x),Lw(Kb))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),wN=function(){var e=function(){function e(){hy(this,e)}return vy(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:kN,useClass:hN}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:pN,useValue:t.cookieName}:[],t.headerName?{provide:gN,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[kN,{provide:fN,useExisting:kN,multi:!0},{provide:yN,useClass:mN},{provide:pN,useValue:"XSRF-TOKEN"},{provide:gN,useValue:"X-XSRF-TOKEN"}]}),e}(),_N=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[cN,{provide:Gx,useClass:CN},vN,{provide:$x,useExisting:vN}],imports:[[wN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),EN=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this))._value=e,r}return vy(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=Xg(oy(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){Xg(oy(n.prototype),"next",this).call(this,this._value=e)}}]),n}(zy);function bN(e,t,n){e?um(n,e,t):t()}var SN=uy(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function PN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lm(1)(mm(t,vm(t)))}function ON(e){return new Uy(function(t){om(e()).subscribe(t)})}function TN(){return $y(function(e,t){var n=null;e._refCount++;var r=new Zy(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var IN=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Gy(e)&&(i.lift=e.lift),i}return vy(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new dy;var n=this.getSubject();t.add(this.source.subscribe(new Zy(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=dy.EMPTY)}return t}},{key:"refCount",value:function(){return TN()(this)}}]),n}(Uy);function AN(e,t){return $y(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Zy(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;om(e(n,u)).subscribe(i=new Zy(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function RN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Zy(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function MN(e,t){return $y(RN(e,t,arguments.length>=2,!0))}function xN(e){return $y(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Zy(n,void 0,void 0,function(o){r=om(e(o,xN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function NN(e){return e<=0?function(){return fm}:$y(function(t,n){var r=[];t.subscribe(new Zy(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=cy(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function DN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LN;return $y(function(t,n){var r=!1;t.subscribe(new Zy(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function LN(){return new SN}function FN(e){return $y(function(t,n){var r=!1;t.subscribe(new Zy(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function UN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Hx(function(t,n){return e(t,n,r)}):Fy,km(1),n?FN(t):DN(function(){return new SN}))}}function VN(e,t,n){var r=ay(e)||t||n?{next:e,error:t,complete:n}:e;return r?$y(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Zy(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):Fy}var BN=vy(function e(t,n){hy(this,e),this.id=t,this.url=n}),zN=function(e){ey(n,e);var t=ny(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return hy(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return vy(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(BN),HN=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return vy(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(BN),GN=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).reason=i,a}return vy(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(BN),$N=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).error=i,a}return vy(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(BN),ZN=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return vy(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(BN),qN=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return vy(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(BN),WN=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return vy(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(BN),jN=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return vy(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(BN),YN=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return vy(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(BN),KN=function(){function e(t){hy(this,e),this.route=t}return vy(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),QN=function(){function e(t){hy(this,e),this.route=t}return vy(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),XN=function(){function e(t){hy(this,e),this.snapshot=t}return vy(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),JN=function(){function e(t){hy(this,e),this.snapshot=t}return vy(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),eD=function(){function e(t){hy(this,e),this.snapshot=t}return vy(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),tD=function(){function e(t){hy(this,e),this.snapshot=t}return vy(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),nD=function(){function e(t,n,r){hy(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return vy(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),rD="primary",iD=function(){function e(t){hy(this,e),this.params=t||{}}return vy(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function aD(e){return new iD(e)}var oD="ngNavigationCancelingError";function sD(e){var t=Error("NavigationCancelingError: "+e);return t[oD]=!0,t}function uD(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function cD(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!lD(e[n=r[a]],t[n]))return!1;return!0}function lD(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=sy(e).sort(),r=sy(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function fD(e){return Array.prototype.concat.apply([],e)}function hD(e){return e.length>0?e[e.length-1]:null}function dD(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function vD(e){return TS(e)?e:OS(e)?mm(Promise.resolve(e)):Bx(e)}var pD={exact:function e(t,n,r){if(!bD(t.segments,n.segments)||!CD(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:mD},gD={exact:function(e,t){return cD(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return lD(e[n],t[n])})},ignored:function(){return!0}};function yD(e,t,n){return pD[n.paths](e.root,t.root,n.matrixParams)&&gD[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function mD(e,t,n){return kD(e,t,t.segments,n)}function kD(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!bD(i,n)||t.hasChildren()||!CD(i,n,r))}if(e.segments.length===n.length){if(!bD(e.segments,n)||!CD(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!mD(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(bD(e.segments,o)&&CD(e.segments,o,r)&&e.children[rD])&&kD(e.children[rD],t,s,r)}function CD(e,t,n){return t.every(function(t,r){return gD[n](e[r].parameters,t.parameters)})}var wD=function(){function e(t,n,r){hy(this,e),this.root=t,this.queryParams=n,this.fragment=r}return vy(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=aD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return OD.serialize(this)}}]),e}(),_D=function(){function e(t,n){var r=this;hy(this,e),this.segments=t,this.children=n,this.parent=null,dD(n,function(e,t){return e.parent=r})}return vy(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return TD(this)}}]),e}(),ED=function(){function e(t,n){hy(this,e),this.path=t,this.parameters=n}return vy(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=aD(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return DD(this)}}]),e}();function bD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var SD=vy(function e(){hy(this,e)}),PD=function(){function e(){hy(this,e)}return vy(e,[{key:"parse",value:function(e){var t=new BD(e);return new wD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(ID(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(RD(t),"=").concat(RD(e))}).join("&"):"".concat(RD(t),"=").concat(RD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),OD=new PD;function TD(e){return e.segments.map(function(e){return DD(e)}).join("/")}function ID(e,t){if(!e.hasChildren())return TD(e);if(t){var n=e.children[rD]?ID(e.children[rD],!1):"",r=[];return dD(e.children,function(e,t){t!==rD&&r.push("".concat(t,":").concat(ID(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return dD(e.children,function(e,r){r===rD&&(n=n.concat(t(e,r)))}),dD(e.children,function(e,r){r!==rD&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===rD?[ID(e.children[rD],!1)]:["".concat(n,":").concat(ID(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[rD]?"".concat(TD(e),"/").concat(i[0]):"".concat(TD(e),"/(").concat(i.join("//"),")")}function AD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function RD(e){return AD(e).replace(/%3B/gi,";")}function MD(e){return AD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xD(e){return decodeURIComponent(e)}function ND(e){return xD(e.replace(/\+/g,"%20"))}function DD(e){return"".concat(MD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(MD(t),"=").concat(MD(e[t]))}).join("")}(e.parameters))}var LD=/^[^\/()?;=#]+/;function FD(e){var t=e.match(LD);return t?t[0]:""}var UD=/^[^=?&#]+/,VD=/^[^?&#]+/,BD=function(){function e(t){hy(this,e),this.url=t,this.remaining=t}return vy(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _D([],{}):new _D([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[rD]=new _D(e,t)),n}},{key:"parseSegment",value:function(){var e=FD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new ED(xD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=FD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=FD(this.remaining);r&&(n=r,this.capture(n))}e[xD(t)]=xD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(UD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(VD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=ND(t),a=ND(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=FD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=rD);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[rD]:new _D([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),zD=function(){function e(t){hy(this,e),this._root=t}return vy(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=HD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=HD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=GD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return GD(e,this._root).map(function(e){return e.value})}}]),e}();function HD(e,t){if(e===t.value)return t;var n,r=cy(t.children);try{for(r.s();!(n=r.n()).done;){var i=HD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function GD(e,t){if(e===t.value)return[t];var n,r=cy(t.children);try{for(r.s();!(n=r.n()).done;){var i=GD(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var $D=function(){function e(t,n){hy(this,e),this.value=t,this.children=n}return vy(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function ZD(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var qD=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e)).snapshot=r,XD(iy(i),e),i}return vy(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(zD);function WD(e,t){var n=function(e,t){var n=new KD([],{},{},"",{},rD,t,null,e.root,-1,{});return new QD("",new $D(n,[]))}(e,t),r=new EN([new ED("",{})]),i=new EN({}),a=new EN({}),o=new EN({}),s=new EN(""),u=new jD(r,i,o,s,a,rD,t,n.root);return u.snapshot=n.root,new qD(new $D(u,[]),n)}var jD=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return vy(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(qy(function(e){return aD(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(qy(function(e){return aD(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function YD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var KD=function(){function e(t,n,r,i,a,o,s,u,c,l,f){hy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return vy(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=aD(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=aD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),QD=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,r)).url=e,XD(iy(i),r),i}return vy(n,[{key:"toString",value:function(){return JD(this._root)}}]),n}(zD);function XD(e,t){t.value._routerState=e,t.children.forEach(function(t){return XD(e,t)})}function JD(e){var t=e.children.length>0?" { ".concat(e.children.map(JD).join(", ")," } "):"";return"".concat(e.value).concat(t)}function eL(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,cD(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),cD(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!cD(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),cD(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function tL(e,t){var n=cD(e.params,t.params)&&function(e,t){return bD(e,t)&&e.every(function(e,n){return cD(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||tL(e.parent,t.parent))}function nL(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=cy(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return nL(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return nL(e,t)})}(e,t,n);return new $D(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return rL(t,o),o}}var s=function(e){return new jD(new EN(e.url),new EN(e.params),new EN(e.queryParams),new EN(e.fragment),new EN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return nL(e,t)});return new $D(s,u)}function rL(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)rL(e.children[n],t.children[n])}function iL(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function aL(e){return"object"==typeof e&&null!=e&&e.outlets}function oL(e,t,n,r,i){var a={};return r&&dD(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new wD(n.root===e?t:sL(n.root,e,t),a,i)}function sL(e,t,n){var r={};return dD(e.children,function(e,i){r[i]=e===t?n:sL(e,t,n)}),new _D(e.segments,r)}var uL=function(){function e(t,n,r){if(hy(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&iL(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(aL);if(i&&i!==hD(r))throw new Error("{outlets:{}} has to be the last command")}return vy(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),cL=vy(function e(t,n,r){hy(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function lL(e,t,n){if(e||(e=new _D([],{})),0===e.segments.length&&e.hasChildren())return fL(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(aL(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!pL(u,c,o))return a;r+=2}else{if(!pL(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new _D(e.segments.slice(0,r.pathIndex),{});return a.children[rD]=new _D(e.segments.slice(r.pathIndex),e.children),fL(a,0,i)}return r.match&&0===i.length?new _D(e.segments,{}):r.match&&!e.hasChildren()?hL(e,t,n):r.match?fL(e,0,i):hL(e,t,n)}function fL(e,t,n){if(0===n.length)return new _D(e.segments,{});var r=function(e){return aL(e[0])?e[0].outlets:qg({},rD,e)}(n),i={};return dD(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=lL(e.children[r],t,n))}),dD(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new _D(e.segments,i)}function hL(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(aL(a)){var o=dL(a.outlets);return new _D(r,o)}if(0===i&&iL(n[0]))r.push(new ED(e.segments[t].path,vL(n[0]))),i++;else{var s=aL(a)?a.outlets[rD]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&iL(u)?(r.push(new ED(s,vL(u))),i+=2):(r.push(new ED(s,{})),i++)}}return new _D(r,{})}function dL(e){var t={};return dD(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=hL(new _D([],{}),0,e))}),t}function vL(e){var t={};return dD(e,function(e,n){return t[n]="".concat(e)}),t}function pL(e,t,n){return e==n.path&&cD(t,n.parameters)}var gL=function(){function e(t,n,r,i){hy(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return vy(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),eL(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=ZD(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),dD(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=ZD(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=ZD(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new tD(e.value.snapshot))}),e.children.length&&this.forwardEvent(new JN(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(eL(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),yL(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function yL(e){eL(e.value),e.children.forEach(yL)}var mL=vy(function e(t,n){hy(this,e),this.routes=t,this.module=n});function kL(e){return"function"==typeof e}function CL(e){return e instanceof wD}var wL=Symbol("INITIAL_VALUE");function _L(){return AN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=vm(t),i=dm(t),a=QR(t),o=a.args,s=a.keys;if(0===o.length)return mm([],r);var u=new Uy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fy;return function(r){bN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){bN(t,function(){var u=mm(e[i],t),c=!1;u.subscribe(new Zy(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return eM(s,e)}:Fy));return i?u.pipe(JR(i)):u}(e.map(function(e){return e.pipe(km(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=vm(t);return $y(function(e,n){(r?PN(t,e,r):PN(t,e)).subscribe(n)})}(wL))})).pipe(MN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==wL?e:(r===wL&&(n=!0),n||!1!==r&&i!==t.length-1&&!CL(r)?e:r)},e)},wL),Hx(function(e){return e!==wL}),qy(function(e){return CL(e)?e:!0===e}),km(1))})}var EL=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=lk({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&ES(0,"router-outlet")},directives:function(){return[CF]},encapsulation:2}),e}();function bL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];SL(r,PL(t,r))}}function SL(e,t){e.children&&bL(e.children,t)}function PL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function OL(e){var t=e.children&&e.children.map(OL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==rD&&(n.component=EL),n}function TL(e){return e.outlet||rD}function IL(e,t){var n=e.filter(function(e){return TL(e)===t});return n.push.apply(n,sy(e.filter(function(e){return TL(e)!==t}))),n}var AL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function RL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},AL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||uD)(n,e,t);if(!i)return Object.assign({},AL);var a={};dD(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function ML(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return xL(e,t,n)&&TL(n)!==rD})}(e,n,r)){var a=new _D(t,function(e,t,n,r){var i={};i[rD]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=cy(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&TL(s)!==rD){var u=new _D([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[TL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new _D(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return xL(e,t,n)})}(e,n,r)){var o=new _D(e.segments,function(e,t,n,r,i,a){var o,s={},u=cy(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(xL(e,n,c)&&!i[TL(c)]){var l=new _D([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[TL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new _D(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function xL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function NL(e,t,n,r){return!!(TL(e)===r||r!==rD&&xL(t,n,e))&&("**"===e.path||RL(t,e,n).matched)}function DL(e,t,n){return 0===t.length&&!e.children[n]}var LL=vy(function e(t){hy(this,e),this.segmentGroup=t||null}),FL=vy(function e(t){hy(this,e),this.urlTree=t});function UL(e){return new Uy(function(t){return t.error(new LL(e))})}function VL(e){return new Uy(function(t){return t.error(new FL(e))})}function BL(e){return new Uy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var zL=function(){function e(t,n,r,i,a){hy(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(cT)}return vy(e,[{key:"apply",value:function(){var e=this,t=ML(this.urlTree.root,[],[],this.config).segmentGroup,n=new _D(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,rD).pipe(qy(function(t){return e.createUrlTree(HL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(xN(function(t){if(t instanceof FL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof LL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,rD).pipe(qy(function(n){return t.createUrlTree(HL(n),e.queryParams,e.fragment)})).pipe(xN(function(e){throw e instanceof LL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new _D([],qg({},rD,e)):e;return new wD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(qy(function(e){return new _D([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return mm(i).pipe(zx(function(i){var a=n.children[i],o=IL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(qy(function(e){return{segment:e,outlet:i}}))}),MN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Hx(function(t,n){return e(t,n,r)}):Fy,NN(1),n?FN(t):DN(function(){return new SN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return mm(n).pipe(zx(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(xN(function(e){if(e instanceof LL)return Bx(null);throw e}))}),UN(function(e){return!!e}),xN(function(e,n){if(e instanceof SN||"EmptyError"===e.name){if(DL(t,r,i))return Bx(new _D([],{}));throw new LL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return NL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):UL(t):UL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?VL(a):this.lineralizeSegments(n,a).pipe(cm(function(n){var a=new _D(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=RL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return UL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?VL(h):this.lineralizeSegments(r,h).pipe(cm(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?Bx(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(qy(function(e){return n._loadedConfig=e,new _D(r,{})})):Bx(new _D(r,{}));var o=RL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return UL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(cm(function(e){var r=e.module,o=e.routes,s=ML(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new _D(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(qy(function(e){return new _D(u,e)}));if(0===o.length&&0===f.length)return Bx(new _D(u,{}));var d=TL(n)===i;return a.expandSegment(r,h,o,f,d?rD:i,!0).pipe(qy(function(e){return new _D(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?Bx(new mL(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Bx(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(cm(function(n){return n?r.configLoader.load(e.injector,t).pipe(qy(function(e){return t._loadedConfig=e,e})):(i=t,new Uy(function(e){return e.error(sD("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):Bx(new mL([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?Bx(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&kL(a.canLoad))i=o.canLoad(t,n);else{if(!kL(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return vD(i)})).pipe(_L(),VN(function(e){if(CL(e)){var t=sD('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),qy(function(e){return!0===e})):Bx(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Bx(n);if(r.numberOfChildren>1||!r.children[rD])return BL(e.redirectTo);r=r.children[rD]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new wD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return dD(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return dD(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new _D(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function HL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=HL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[rD]){var t=e.children[rD];return new _D(e.segments.concat(t.segments),t.children)}return e}(new _D(e.segments,t))}var GL=vy(function e(t){hy(this,e),this.path=t,this.route=this.path[this.path.length-1]}),$L=vy(function e(t,n){hy(this,e),this.component=t,this.route=n});function ZL(e,t,n){var r=e._root;return WL(r,t?t._root:null,n,[r.value])}function qL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function WL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=ZD(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!bD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!bD(e.url,t.url)||!cD(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tL(e,t)||!cD(e.queryParams,t.queryParams);default:return!tL(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new GL(r)):(a.data=o.data,a._resolvedData=o._resolvedData),WL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new $L(s.outlet.component,o))}else o&&jL(t,s,i),i.canActivateChecks.push(new GL(r)),WL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),dD(a,function(e,t){return jL(e,n.getContext(t),i)}),i}function jL(e,t,n){var r=ZD(e),i=e.value;dD(r,function(e,r){jL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new $L(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var YL=vy(function e(){hy(this,e)});function KL(e){return new Uy(function(t){return t.error(e)})}var QL=function(){function e(t,n,r,i,a,o){hy(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return vy(e,[{key:"recognize",value:function(){var e=ML(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,rD);if(null===t)return null;var n=new KD([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},rD,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new $D(n,t),i=new QD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=YD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=IL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,sy(u))}var c=XL(n);return c.sort(function(e,t){return e.value.outlet===rD?-1:t.value.outlet===rD?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return DL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!NL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?hD(n).parameters:{};i=new KD(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tF(e),TL(e),e.component,e,JL(t),eF(t)+n.length,nF(e))}else{var u=RL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new KD(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tF(e),TL(e),e.component,e,JL(t),eF(t)+a.length,nF(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=ML(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new $D(i,v)]}if(0===l.length&&0===d.length)return[new $D(i,[])];var p=TL(e)===r,g=this.processSegment(l,h,d,p?rD:r);return null===g?null:[new $D(i,g)]}}]),e}();function XL(e){var t,n=[],r=new Set,i=cy(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,sy(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=cy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=XL(u.children);n.push(new $D(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function JL(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function eF(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function tF(e){return e.data||{}}function nF(e){return e.resolve||{}}function rF(e){return AN(function(t){var n=e(t);return n?mm(n).pipe(qy(function(){return t})):Bx(t)})}var iF=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n)}(function(){function e(){hy(this,e)}return vy(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),aF=new gw("ROUTES"),oF=function(){function e(t,n,r,i){hy(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return vy(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(qy(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new mL(fD(i.injector.get(aF,void 0,$m.Self|$m.Optional)).map(OL),i)}),xN(function(e){throw t._loader$=void 0,e}));return t._loader$=new IN(r,function(){return new zy}).pipe(TN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?mm(this.loader.load(e)):vD(e()).pipe(cm(function(e){return e instanceof lT?Bx(e):mm(t.compiler.compileModuleAsync(e))}))}}]),e}(),sF=vy(function e(){hy(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new uF,this.attachRef=null}),uF=function(){function e(){hy(this,e),this.contexts=new Map}return vy(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new sF,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),cF=function(){function e(){hy(this,e)}return vy(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function lF(e){throw e}function fF(e,t,n){return t.parse("/")}function hF(e,t){return Bx(null)}var dF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},vF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},pF=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;hy(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new zy,this.errorHandler=lF,this.malformedUriErrorHandler=fF,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:hF,afterPreactivation:hF},this.urlHandlingStrategy=new cF,this.routeReuseStrategy=new iF,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(cT),this.console=a.get(uI);var l=a.get(wI);this.isNgZoneEnabled=l instanceof wI&&wI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new wD(new _D([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new oF(o,s,function(e){return c.triggerEvent(new KN(e))},function(e){return c.triggerEvent(new QN(e))}),this.routerState=WD(this.currentUrlTree,this.rootComponentType),this.transitions=new EN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return vy(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(Hx(function(e){return 0!==e.id}),qy(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),AN(function(e){var r=!1,i=!1;return Bx(e).pipe(VN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),AN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return gF(e.source)&&(t.browserUrlTree=e.extractedUrl),Bx(e).pipe(AN(function(e){var r=t.transitions.getValue();return n.next(new zN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?fm:Promise.resolve(e)}),function(e,t,n,r){return AN(function(i){return function(e,t,n,r,i){return new zL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(qy(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),VN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return cm(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new QL(e,t,n,r,a,o).recognize();return null===s?KL(new YL):Bx(s)}catch(i){return KL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(qy(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),VN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new ZN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new zN(o,t.serializeUrl(s),u,c);n.next(f);var h=WD(s,t.rootComponentType).snapshot;return Bx(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),fm}),rF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),VN(function(e){var n=new qN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),qy(function(e){return Object.assign(Object.assign({},e),{guards:ZL(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return cm(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?Bx(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return mm(e).pipe(cm(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?Bx(a.map(function(a){var o,s=qL(a,t,i);if(function(e){return e&&kL(e.canDeactivate)}(s))o=vD(s.canDeactivate(e,t,n,r));else{if(!kL(s))throw new Error("Invalid CanDeactivate guard");o=vD(s(e,t,n,r))}return o.pipe(UN())})).pipe(_L()):Bx(!0)}(e.component,e.route,n,t,r)}),UN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(cm(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return mm(t).pipe(zx(function(t){return PN(function(e,t){return null!==e&&t&&t(new XN(e)),Bx(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new eD(e)),Bx(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return ON(function(){return Bx(t.guards.map(function(i){var a,o=qL(i,t.node,n);if(function(e){return e&&kL(e.canActivateChild)}(o))a=vD(o.canActivateChild(r,e));else{if(!kL(o))throw new Error("Invalid CanActivateChild guard");a=vD(o(r,e))}return a.pipe(UN())})).pipe(_L())})});return Bx(i).pipe(_L())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Bx(!0);var i=r.map(function(r){return ON(function(){var i,a=qL(r,t,n);if(function(e){return e&&kL(e.canActivate)}(a))i=vD(a.canActivate(t,e));else{if(!kL(a))throw new Error("Invalid CanActivate guard");i=vD(a(t,e))}return i.pipe(UN())})});return Bx(i).pipe(_L())}(e,t.route,n))}),UN(function(e){return!0!==e},!0))}(r,o,e,t):Bx(n)}),qy(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),VN(function(e){if(CL(e.guardsResult)){var n=sD('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new WN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),Hx(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),rF(function(e){if(e.guards.canActivateChecks.length)return Bx(e).pipe(VN(function(e){var n=new jN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),AN(function(e){var n=!1;return Bx(e).pipe(function(e,t){return cm(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return Bx(n);var a=0;return mm(i).pipe(zx(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return Bx({});var a={};return mm(i).pipe(cm(function(i){return function(e,t,n,r){var i=qL(e,t,r);return vD(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(VN(function(e){a[i]=e}))}),NN(1),cm(function(){return Object.keys(a).length===i.length?Bx(a):fm}))}(e._resolve,e,t,r).pipe(qy(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),YD(e,n).resolve),null}))}(n.route,r,e,t)}),VN(function(){return a++}),NN(1),cm(function(e){return a===i.length?Bx(n):fm}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),VN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),VN(function(e){var n=new YN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),rF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),qy(function(e){var n=function(e,t,n){var r=nL(e,t._root,n?n._root:void 0);return new qD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),VN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return qy(function(r){return new gL(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),VN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return $y(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),xN(function(r){if(i=!0,function(e){return e&&e[oD]}(r)){var a=CL(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new GN(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||gF(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new $N(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return fm}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){bL(e),this.config=e.map(OL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return oL(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new uL(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return dD(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(sy(e),[{outlets:a}])}if(r.segmentPath)return[].concat(sy(e),[r.segmentPath])}return"string"!=typeof r?[].concat(sy(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(sy(e),[r])},[]);return new uL(n,t,r)}(n);if(a.toRoot())return oL(t.root,new _D([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new cL(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new cL(r,r===t.root,0)}var i=iL(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new cL(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?fL(o.segmentGroup,o.index,a.commands):lL(o.segmentGroup,o.index,a.commands);return oL(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=CL(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},dF):!1===t?Object.assign({},vF):t,CL(e))return yD(this.currentUrlTree,e,n);var r=this.parseUrl(e);return yD(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new HN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=gF(t)&&l&&!gF(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new GN(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(mw),Lw(SD),Lw(uF),Lw(dA),Lw(Kb),Lw(HI),Lw(mI),Lw(void 0))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function gF(e){return"imperative"!==e}var yF=function(){var e=function(){function e(t,n,r,i,a){hy(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new zy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return vy(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:kF(this.skipLocationChange),replaceUrl:kF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:kF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(jD),dw("tabindex"),mS(MO),mS(IO))},e.\u0275dir=gk({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&IS("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Ik]}),e}(),mF=function(){var e=function(){function e(t,n,r){var i=this;hy(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new zy,this.subscription=t.events.subscribe(function(e){e instanceof HN&&i.updateTargetUrlAndHref()})}return vy(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:kF(this.skipLocationChange),replaceUrl:kF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:kF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(jD),mS(uA))},e.\u0275dir=gk({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&IS("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(cP("href",t.href,I_),fS("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Ik]}),e}();function kF(e){return""===e||!!e}var CF=function(){var e=function(){function e(t,n,r,i,a){hy(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new FT,this.deactivateEvents=new FT,this.name=i||rD,t.onChildOutletCreated(this.name,this)}return vy(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new wF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(uF),mS(hT),mS(SO),dw("name"),mS(tT))},e.\u0275dir=gk({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),wF=function(){function e(t,n,r){hy(this,e),this.route=t,this.childContexts=n,this.parent=r}return vy(e,[{key:"get",value:function(e,t){return e===jD?this.route:e===uF?this.childContexts:this.parent.get(e,t)}}]),e}(),_F=vy(function e(){hy(this,e)}),EF=function(){function e(){hy(this,e)}return vy(e,[{key:"preload",value:function(e,t){return Bx(null)}}]),e}(),bF=function(){var e=function(){function e(t,n,r,i,a){hy(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new oF(n,r,function(e){return t.triggerEvent(new KN(e))},function(e){return t.triggerEvent(new QN(e))})}return vy(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Hx(function(e){return e instanceof HN}),zx(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(cT);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return mm(r).pipe(lm(),qy(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?Bx(t._loadedConfig):n.loader.load(e.injector,t)).pipe(cm(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(pF),Lw(HI),Lw(mI),Lw(Kb),Lw(_F))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),SF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};hy(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return vy(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof zN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof HN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof nD&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new nD(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(pF),Lw(lR),Lw(void 0))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),PF=new gw("ROUTER_CONFIGURATION"),OF=new gw("ROUTER_FORROOT_GUARD"),TF=[dA,{provide:SD,useClass:PD},{provide:pF,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new pF(null,e,t,n,r,i,a,fD(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[SD,uF,dA,Kb,HI,mI,aF,PF,[function(){return vy(function e(){hy(this,e)})}(),new $w],[function(){return vy(function e(){hy(this,e)})}(),new $w]]},uF,{provide:jD,useFactory:function(e){return e.routerState.root},deps:[pF]},{provide:HI,useClass:ZI},bF,EF,function(){function e(){hy(this,e)}return vy(e,[{key:"preload",value:function(e,t){return t().pipe(xN(function(){return Bx(null)}))}}]),e}(),{provide:PF,useValue:{enableTracing:!1}}];function IF(){return new DI("Router",pF)}var AF=function(){var e=function(){function e(t,n){hy(this,e)}return vy(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[TF,NF(t),{provide:OF,useFactory:xF,deps:[[pF,new $w,new Zw]]},{provide:PF,useValue:n||{}},{provide:uA,useFactory:MF,deps:[JI,[new Gw(lA),new $w],PF]},{provide:SF,useFactory:RF,deps:[pF,lR,PF]},{provide:_F,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:EF},{provide:DI,multi:!0,useFactory:IF},[DF,{provide:eI,multi:!0,useFactory:LF,deps:[DF]},{provide:UF,useFactory:FF,deps:[DF]},{provide:sI,multi:!0,useExisting:UF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[NF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(OF,8),Lw(pF,8))},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({}),e}();function RF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new SF(e,t,n)}function MF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new hA(e,t):new fA(e,t)}function xF(e){return"guarded"}function NF(e){return[{provide:yw,multi:!0,useValue:e},{provide:aF,multi:!0,useValue:e}]}var DF=function(){var e=function(){function e(t){hy(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new zy}return vy(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(tA,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(pF),i=e.injector.get(PF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?Bx(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(PF),n=this.injector.get(bF),r=this.injector.get(SF),i=this.injector.get(pF),a=this.injector.get(BI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(Kb))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}();function LF(e){return e.appInitializer.bind(e)}function FF(e){return e.bootstrapListener.bind(e)}var UF=new gw("Router Initializer"),VF=vy(function e(){hy(this,e)}),BF="*";function zF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function HF(e){return{type:6,styles:e,offset:null}}function GF(e){Promise.resolve(null).then(e)}var $F=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;hy(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return vy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;GF(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),ZF=function(){function e(t){var n=this;hy(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?GF(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return vy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function qF(){return"undefined"!=typeof window&&void 0!==window.document}function WF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function jF(e){switch(e.length){case 0:return new $F;case 1:return e[0];default:return new ZF(e)}}function YF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case BF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function KF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&QF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&QF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&QF(n,"destroy",e))})}}function QF(e,t,n){var r,i=XF(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function XF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function JF(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function eU(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var tU=function(e,t){return!1},nU=function(e,t){return!1},rU=function(e,t,n){return[]},iU=WF();(iU||"undefined"!=typeof Element)&&(tU=qF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},nU=function(){if(iU||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:nU}(),rU=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var aU=null,oU=!1;function sU(e){aU||(aU=("undefined"!=typeof document?document.body:null)||{},oU=!!aU.style&&"WebkitAppearance"in aU.style);var t=!0;return aU.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in aU.style)&&oU&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in aU.style)),t}var uU=nU,cU=tU,lU=rU;function fU(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var hU=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"validateStyleProperty",value:function(e){return sU(e)}},{key:"matchesElement",value:function(e,t){return uU(e,t)}},{key:"containsElement",value:function(e,t){return cU(e,t)}},{key:"query",value:function(e,t,n){return lU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new $F(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),dU=function(){var e=vy(function e(){hy(this,e)});return e.NOOP=new hU,e}(),vU="ng-enter",pU="ng-leave",gU="ng-trigger",yU=".ng-trigger",mU="ng-animating",kU=".ng-animating";function CU(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:wU(parseFloat(t[1]),t[2])}function wU(e,t){return"s"===t?1e3*e:e}function _U(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=wU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=wU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function EU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function bU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else EU(e,n);return n}function SU(e,t,n){return n?t+":"+n+";":""}function PU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=SU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=SU(0,LU(i),e.style[i]));e.setAttribute("style",t)}function OU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=DU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),WF()&&PU(e))}function TU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=DU(t);e.style[n]=""}),WF()&&PU(e))}function IU(e){return Array.isArray(e)?1==e.length?e[0]:zF(e):e}var AU=new RegExp("{{\\s*(.+?)\\s*}}","g");function RU(e){var t=[];if("string"==typeof e){for(var n;n=AU.exec(e);)t.push(n[1]);AU.lastIndex=0}return t}function MU(e,t,n){var r=e.toString(),i=r.replace(AU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function xU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var NU=/-+([a-z0-9])/g;function DU(e){return e.replace(NU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function LU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function FU(e,t){return 0===e||0===t}function UU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=BU(e,t)})},s=1;s<t.length;s++)o()}return t}function VU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function BU(e,t){return window.getComputedStyle(e)[t]}function zU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push($U(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push($U(s,a))}(e,n,t)}):n.push(e),n}var HU=new Set(["true","1"]),GU=new Set(["false","0"]);function $U(e,t){var n=HU.has(e)||GU.has(e),r=HU.has(t)||GU.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?HU.has(e):GU.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?HU.has(t):GU.has(t)),o&&s}}var ZU=new RegExp("s*:selfs*,?","g");function qU(e,t,n){return new WU(e).build(t,n)}var WU=function(){function e(t){hy(this,e),this._driver=t}return vy(e,[{key:"build",value:function(e,t){var n=new jU(t);return this._resetContextStyleTimingState(n),VU(this,IU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(YU(e)){var t=e;Object.keys(t).forEach(function(e){RU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=xU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=VU(this,IU(e.animation),t);return{type:1,matchers:zU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:KU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return VU(n,e,t)}),options:KU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=VU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:KU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return QU(_U(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=QU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return QU((n=n||_U(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:HF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=HF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==BF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(YU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=RU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(YU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(YU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:VU(this,IU(e.animation),t),options:KU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:KU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:KU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(ZU,"")),e=e.replace(/@\*/g,yU).replace(/@\w+/g,function(e){return yU+"-"+e.substr(1)}).replace(/:animating/g,kU),[e,t]}(e.selector),a=Wg(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,JF(t.collectedStyles,t.currentQuerySelector,{});var u=VU(this,IU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:KU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:_U(e.timings,t.errors,!0);return{type:12,animation:VU(this,IU(e.animation),t),timings:n,options:null}}}]),e}(),jU=vy(function e(t){hy(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function YU(e){return!Array.isArray(e)&&"object"==typeof e}function KU(e){return e?(e=EU(e)).params&&(e.params=function(e){return e?EU(e):null}(e.params)):e={},e}function QU(e,t,n){return{duration:e,delay:t,easing:n}}function XU(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var JU=function(){function e(){hy(this,e),this._map=new Map}return vy(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,sy(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),eV=new RegExp(":enter","g"),tV=new RegExp(":leave","g");function nV(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new rV).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var rV=function(){function e(){hy(this,e)}return vy(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new JU;var l=new aV(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),VU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[XU(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?CU(n.duration):null,a=null!=n.delay?CU(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),VU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=iV);var o=CU(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return VU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?CU(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),VU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return _U(t.params?MU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?CU(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=iV);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),VU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;VU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),iV={},aV=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=iV,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new oV(this._driver,n,0),s.push(this.currentTimeline)}return vy(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=CU(r.duration)),null!=r.delay&&(i.delay=CU(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=MU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=iV,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new sV(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(eV,"."+this._enterClassName)).replace(tV,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,sy(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),oV=function(){function e(t,n,r,i){hy(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return vy(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||BF,t._currentKeyframe[e]=BF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=BF}):bU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=MU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:BF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=bU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==BF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?xU(t.values()):[],o=n.size?xU(n.values()):[];if(r){var s=i[0],u=EU(s);s.offset=0,u.offset=1,i=[s,u]}return XU(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),sV=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return hy(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return vy(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=bU(e[0],!1);u.offset=0,a.push(u);var c=bU(e[0],!1);c.offset=uV(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=bU(e[f],!1);h.offset=uV((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return XU(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(oV);function uV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var cV=vy(function e(){hy(this,e)}),lV=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"normalizePropertyName",value:function(e,t){return DU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(fV[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(cV),fV=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function hV(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var dV={},vV=function(){function e(t,n,r){hy(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return vy(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||dV,h=this.buildStyles(n,o&&o.params||dV,l),d=s&&s.params||dV,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:nV(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return hV(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=JF(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=JF(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=xU(p.values());return hV(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),pV=function(){function e(t,n,r){hy(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return vy(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=EU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=MU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),gV=function(){function e(t,n,r){var i=this;hy(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new pV(e.style,e.options&&e.options.params||{},r)}),yV(this.states,"true","1"),yV(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new vV(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new vV(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return vy(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function yV(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var mV=new JU,kV=function(){function e(t,n,r){hy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return vy(e,[{key:"register",value:function(e,t){var n=[],r=qU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=YF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=nV(this._driver,t,o,vU,pU,{},{},i,mV,a)).forEach(function(e){var t=JF(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,BF)})});var u=jF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=XF(t,"","","");return KF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),CV="ng-animate-queued",wV="ng-animate-disabled",_V=".ng-animate-disabled",EV=[],bV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},SV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},PV="__ng_removed",OV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";hy(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=EU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return vy(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),TV="void",IV=new OV(TV),AV=function(){function e(t,n,r){hy(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,UV(n,this._hostClassName)}return vy(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=JF(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=JF(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(UV(e,gU),UV(e,gU+"-"+t),u[t]=IV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new MV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(UV(e,gU),UV(e,gU+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new OV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=IV),c.value===TV||u.value!==c.value){var l=JF(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(UV(e,CV),o.onStart(function(){VV(e,CV)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){TU(e,v),OU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,yU,!0);r.forEach(function(e){if(!e[PV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,TV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&jF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||IV,u=new OV(TV),c=new MV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[PV];(!s||s===bV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){UV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=XF(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,KF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),RV=function(){function e(t,n,r){hy(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return vy(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new AV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(xV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(xV(t)){var i=t[PV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),UV(e,wV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),VV(e,wV))}},{key:"removeNode",value:function(e,t,n,r){if(xV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[PV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return xV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,yU,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,kU,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return jF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[PV];if(n&&n.setForRemoval){if(e[PV]=bV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,_V)&&this.markElementAsDisabled(e,!1),this.driver.query(e,_V,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)UV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?jF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new JU,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=LV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=vU+p++;v.set(t,n),e.forEach(function(e){return UV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[PV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,E=LV(h,Array.from(y));E.forEach(function(e,t){var n=pU+p++;_.set(t,n),e.forEach(function(e){return UV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return VV(e,n)})}),E.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return VV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var b=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(b.push(t),n.collectedEnterElements.length){var l=a[PV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)S.push(g);else{if(h)return t.onStart(function(){return TU(a,g.fromStyles)}),t.onDestroy(function(){return OU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return TU(a,g.fromStyles)}),t.onDestroy(function(){return OU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return JF(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),b.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){JF(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return HV(e,u,c)}),R=new Map;DV(R,this.driver,m,c,BF).forEach(function(e){HV(e,u,c)&&A.push(e)});var M=new Map;d.forEach(function(e,t){DV(M,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=R.get(e),n=M.get(e);R.set(e,Object.assign(Object.assign({},t),n))});var x=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return OU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,M,R);if(o.setRealPlayer(d),u===D)x.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=jF(v)),i.push(o)}}else TU(t,s.fromStyles),o.onDestroy(function(){return OU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=jF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[PV];if(VV(F,pU),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,sy(B));for(var z=this.driver.query(F,kU,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,sy(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?BV(this,F,$):this.processLeaveNode(F)}}return g.length=0,x.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),x}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[PV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==TV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=cy(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=JF(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}TU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[PV];if(d&&d.removedBeforeQueried)return new $F(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return zV(e,t),t}((n.get(h)||EV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=YF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new MV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){JF(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return UV(e,mU)});var d=jF(h);return d.onDestroy(function(){l.forEach(function(e){return VV(e,mU)}),OU(u,t.toStyles)}),f.forEach(function(e){JF(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new $F(e.duration,e.delay)}}]),e}(),MV=function(){function e(t,n,r){hy(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new $F,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return vy(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return KF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){JF(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function xV(e){return e&&1===e.nodeType}function NV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function DV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(NV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[PV]=SV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return NV(e,a[s++])}),o}function LV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var FV="$$classes";function UV(e,t){if(e.classList)e.classList.add(t);else{var n=e[FV];n||(n=e[FV]={}),n[t]=!0}}function VV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[FV];n&&delete n[t]}}function BV(e,t,n){jF(n).onDone(function(){return e.processLeaveNode(t)})}function zV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof ZF?zV(r.players,t):t.push(r)}}function HV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var GV=function(){function e(t,n,r){var i=this;hy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new RV(t,n,r),this._timelineEngine=new kV(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return vy(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=qU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new gV(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Wg(eU(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Wg(eU(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function $V(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=qV(t[0]),t.length>1&&(r=qV(t[t.length-1]))):t&&(n=qV(t)),n||r?new ZV(e,n,r):null}var ZV=function(){var e=function(){function e(t,n,r){hy(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return vy(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&OU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(OU(this._element,this._initialStyles),this._endStyles&&(OU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(TU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(TU(this._element,this._endStyles),this._endStyles=null),OU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function qV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];WV(i)&&((t=t||{})[i]=e[i])}return t}function WV(e){return"display"===e||"position"===e}var jV="animation",YV="animationend",KV=function(){function e(t,n,r,i,a,o,s){var u=this;hy(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return vy(e,[{key:"apply",value:function(){(function(e,t){var n=nB(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),tB(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),eB(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){QV(this._element,this._name,"paused")}},{key:"resume",value:function(){QV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=XV(this._element,this._name);this._position=e*this._duration,tB(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),eB(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=nB(e,"").split(","),r=JV(n,t);r>=0&&(n.splice(r,1),tB(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function QV(e,t,n){tB(e,"PlayState",n,XV(e,t))}function XV(e,t){var n=nB(e,"");return n.indexOf(",")>0?JV(n.split(","),t):JV([n],t)}function JV(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function eB(e,t,n){n?e.removeEventListener(YV,t):e.addEventListener(YV,t)}function tB(e,t,n,r){var i=jV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function nB(e,t){return e.style[jV+t]||""}var rB=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return vy(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new KV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:BU(e.element,r))})}this.currentSnapshot=t}}]),e}(),iB=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=fU(r),i}return vy(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),Xg(oy(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),Xg(oy(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,Xg(oy(n.prototype),"destroy",this).call(this))}}]),n}($F),aB=function(){function e(){hy(this,e),this._count=0}return vy(e,[{key:"validateStyleProperty",value:function(e){return sU(e)}},{key:"matchesElement",value:function(e,t){return uU(e,t)}},{key:"containsElement",value:function(e,t){return cU(e,t)}},{key:"query",value:function(e,t,n){return lU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return fU(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof rB}),s={};FU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=UU(e,t,s));if(0==n)return new iB(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=$V(e,t),h=new rB(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),oB=function(){function e(t,n,r,i){hy(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return vy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:BU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),sB=function(){function e(){hy(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(uB().toString()),this._cssKeyframesDriver=new aB}return vy(e,[{key:"validateStyleProperty",value:function(e){return sU(e)}},{key:"matchesElement",value:function(e,t){return uU(e,t)}},{key:"containsElement",value:function(e,t){return cU(e,t)}},{key:"query",value:function(e,t,n){return lU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof oB});FU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=$V(e,t=UU(e,t=t.map(function(e){return bU(e,!1)}),u));return new oB(e,t,s,l)}}]),e}();function uB(){return qF()&&Element.prototype.animate||{}}var cB=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Ym.None,styles:[],data:{animation:[]}}),i}return vy(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?zF(e):e;return hB(this._renderer,null,t,"register",[n]),new lB(t,this._renderer)}}]),n}(VF);return e.\u0275fac=function(t){return new(t||e)(Lw(RO),Lw(XI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),lB=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return vy(n,[{key:"create",value:function(e,t){return new fB(this._id,e,t||{},this._renderer)}}]),n}(function(){return vy(function e(){hy(this,e)})}()),fB=function(){function e(t,n,r,i){hy(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return vy(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return hB(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function hB(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var dB="@.disabled",vB=function(){var e=function(){function e(t,n,r){hy(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return vy(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new pB("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new gB(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Wg(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(RO),Lw(GV),Lw(wI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),pB=function(){function e(t,n,r){hy(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return vy(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==dB?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),gB=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return vy(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==dB?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=Wg(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(pB),yB=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){return hy(this,n),t.call(this,e.body,r,i)}return vy(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(GV);return e.\u0275fac=function(t){return new(t||e)(Lw(XI),Lw(dU),Lw(cV))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac}),e}(),mB=new gw("AnimationModuleType"),kB=[{provide:VF,useClass:cB},{provide:cV,useFactory:function(){return new lV}},{provide:GV,useClass:yB},{provide:RO,useFactory:function(e,t,n){return new vB(e,t,n)},deps:[RR,GV,wI]}],CB=[{provide:dU,useFactory:function(){return"function"==typeof uB()?new sB:new aB}},{provide:mB,useValue:"BrowserAnimations"}].concat(kB),wB=[{provide:dU,useClass:hU},{provide:mB,useValue:"NoopAnimations"}].concat(kB),_B=function(){var e=function(){function e(){hy(this,e)}return vy(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?wB:CB}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:CB,imports:[qR]}),e}(),EB=Yg(9575),bB=Yg.n(EB);function SB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function PB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){SB(a,r,i,o,s,"next",e)}function s(e){SB(a,r,i,o,s,"throw",e)}o(void 0)})}}var OB=function(){function e(){hy(this,e)}return vy(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=cy(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function TB(e,t){e&&console.log(t)}function IB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===IB(n[o],r[o]))return!1}return!0}return e===t}function AB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===AB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function RB(e,t){if(AB(e)&&AB(t))return IB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var MB=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&RB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),xB=function(){function e(){hy(this,e)}return vy(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&RB(this.get(),e.get())}}],[{key:"success",value:function(e){return new NB(e)}},{key:"failure",value:function(e){return new DB(e)}}]),e}(),NB=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).value=e,r}return vy(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return MB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(xB),DB=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).reason=e,r}return vy(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return MB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(xB),LB=function(){function e(t){hy(this,e),this.reason=t}return vy(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?xB.success(e):xB.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return xB.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();LB.SUCCESS=new LB(null);var FB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},UB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(FB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},VB=function(e){return function(e){var t=FB(e);return UB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},BB=function(){function e(){var t=this;hy(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return vy(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function zB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function HB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zB())}function GB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function $B(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ZB(){var e=zB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function qB(){return"object"==typeof indexedDB}function WB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function jB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var YB=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(iy(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(iy(a),KB.prototype.create),a}return vy(n)}(Kg(Error)),KB=function(){function e(t,n,r){hy(this,e),this.service=t,this.serviceName=n,this.errors=r}return vy(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(QB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new YB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),QB=/\{\$([^}]+)}/g;function XB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(JB(s)&&JB(u)){if(!XB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function JB(e){return null!==e&&"object"==typeof e}function ez(e){for(var t=[],n=function(){var e=Wg(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function tz(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Wg(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function nz(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var rz=function(){function e(t,n){var r=this;hy(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return vy(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=iz),void 0===r.error&&(r.error=iz),void 0===r.complete&&(r.complete=iz);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function iz(){}function az(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function oz(e){return e&&e._delegate?e._delegate:e}var sz,uz,cz=function(){function e(t,n,r){hy(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return vy(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),lz="[DEFAULT]",fz=function(){function e(t,n){hy(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return vy(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new BB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:lz})}catch(u){}var t,n=cy(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Wg(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lz;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(sy(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),sy(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lz;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lz;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=cy(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Wg(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===lz?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lz;return this.component?this.component.multipleInstances?e:lz:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),hz=function(){function e(t){hy(this,e),this.name=t,this.providers=new Map}return vy(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new fz(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),dz=[],vz=function(){return(e=vz||(vz={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",vz;var e}(),pz={debug:vz.DEBUG,verbose:vz.VERBOSE,info:vz.INFO,warn:vz.WARN,error:vz.ERROR,silent:vz.SILENT},gz=vz.INFO,yz=(qg(Jg={},vz.DEBUG,"log"),qg(Jg,vz.VERBOSE,"log"),qg(Jg,vz.INFO,"info"),qg(Jg,vz.WARN,"warn"),qg(Jg,vz.ERROR,"error"),Jg),mz=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=yz[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},kz=function(){function e(t){hy(this,e),this.name=t,this._logLevel=gz,this._logHandler=mz,this._userLogHandler=null,dz.push(this)}return vy(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in vz))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?pz[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,vz.DEBUG].concat(t)),this._logHandler.apply(this,[this,vz.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,vz.VERBOSE].concat(t)),this._logHandler.apply(this,[this,vz.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,vz.INFO].concat(t)),this._logHandler.apply(this,[this,vz.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,vz.WARN].concat(t)),this._logHandler.apply(this,[this,vz.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,vz.ERROR].concat(t)),this._logHandler.apply(this,[this,vz.ERROR].concat(t))}}]),e}(),Cz=new WeakMap,wz=new WeakMap,_z=new WeakMap,Ez=new WeakMap,bz=new WeakMap,Sz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return wz.get(e);if("objectStoreNames"===t)return e.objectStoreNames||_z.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pz(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Pz(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Pz(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&Cz.set(t,e)}).catch(function(){}),bz.set(t,e),t}(e);if(Ez.has(e))return Ez.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(uz||(uz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Oz(this),n),Pz(Cz.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pz(e.apply(Oz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Oz(this),t].concat(r));return _z.set(a,t.sort?t.sort():[t]),Pz(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!wz.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});wz.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,sz||(sz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Sz):e)}(e);return t!==e&&(Ez.set(e,t),bz.set(t,e)),t}var Oz=function(e){return bz.get(e)};function Tz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Pz(s);return i&&s.addEventListener("upgradeneeded",function(e){i(Pz(s.result),e.oldVersion,e.newVersion,Pz(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function Iz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),Pz(r).then(function(){})}var Az,Rz=["get","getKey","getAll","getAllKeys","count"],Mz=["put","add","delete","clear"],xz=new Map;function Nz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(xz.get(t))return xz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Mz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Rz.includes(n))){var a,o=(a=PB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return xz.set(t,o),o}}}Sz=Zg(Zg({},Az=Sz),{},{get:function(e,t,n){return Nz(e,t)||Az.get(e,t,n)},has:function(e,t){return!!Nz(e,t)||Az.has(e,t)}});var Dz=function(){function e(t){hy(this,e),this.container=t}return vy(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),Lz="@firebase/app",Fz=new kz("@firebase/app"),Uz="[DEFAULT]",Vz=(qg(ty={},Lz,"fire-core"),qg(ty,"@firebase/app-compat","fire-core-compat"),qg(ty,"@firebase/analytics","fire-analytics"),qg(ty,"@firebase/analytics-compat","fire-analytics-compat"),qg(ty,"@firebase/app-check","fire-app-check"),qg(ty,"@firebase/app-check-compat","fire-app-check-compat"),qg(ty,"@firebase/auth","fire-auth"),qg(ty,"@firebase/auth-compat","fire-auth-compat"),qg(ty,"@firebase/database","fire-rtdb"),qg(ty,"@firebase/database-compat","fire-rtdb-compat"),qg(ty,"@firebase/functions","fire-fn"),qg(ty,"@firebase/functions-compat","fire-fn-compat"),qg(ty,"@firebase/installations","fire-iid"),qg(ty,"@firebase/installations-compat","fire-iid-compat"),qg(ty,"@firebase/messaging","fire-fcm"),qg(ty,"@firebase/messaging-compat","fire-fcm-compat"),qg(ty,"@firebase/performance","fire-perf"),qg(ty,"@firebase/performance-compat","fire-perf-compat"),qg(ty,"@firebase/remote-config","fire-rc"),qg(ty,"@firebase/remote-config-compat","fire-rc-compat"),qg(ty,"@firebase/storage","fire-gcs"),qg(ty,"@firebase/storage-compat","fire-gcs-compat"),qg(ty,"@firebase/firestore","fire-fst"),qg(ty,"@firebase/firestore-compat","fire-fst-compat"),qg(ty,"fire-js","fire-js"),qg(ty,"firebase","fire-js-all"),ty),Bz=new Map,zz=new Map;function Hz(e,t){try{e.container.addComponent(t)}catch(n){Fz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Gz(e){var t=e.name;if(zz.has(t))return Fz.debug("There were multiple attempts to register component ".concat(t,".")),!1;zz.set(t,e);var n,r=cy(Bz.values());try{for(r.s();!(n=r.n()).done;){Hz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function $z(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Zz=new KB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),qz=function(){function e(t,n,r){var i=this;hy(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cz("app",function(){return i},"PUBLIC"))}return vy(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Zz.create("app-deleted",{appName:this._name})}}]),e}(),Wz="9.9.0";function jz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uz,t=Bz.get(e);if(!t)throw Zz.create("no-app",{appName:e});return t}function Yz(){return Array.from(Bz.values())}function Kz(e,t,n){var r,i=null!==(r=Vz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Fz.warn(s.join(" "))}Gz(new cz("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var Qz="firebase-heartbeat-store",Xz=null;function Jz(){return Xz||(Xz=Tz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(Qz)}}).catch(function(e){throw Zz.create("storage-open",{originalErrorMessage:e.message})})),Xz}function eH(){return eH=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jz();case 3:return e.abrupt("return",e.sent.transaction(Qz).objectStore(Qz).get(rH(t)));case 6:throw e.prev=6,e.t0=e.catch(0),Zz.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),eH.apply(this,arguments)}function tH(e,t){return nH.apply(this,arguments)}function nH(){return nH=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jz();case 3:return i=e.sent.transaction(Qz,"readwrite"),e.next=6,i.objectStore(Qz).put(n,rH(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),Zz.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),nH.apply(this,arguments)}function rH(e){return"".concat(e.name,"!").concat(e.options.appId)}var iH=function(){function e(t){var n=this;hy(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new oH(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return vy(e,[{key:"triggerHeartbeat",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=aH(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=aH(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=cy(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),sH(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),sH(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=VB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function aH(){return(new Date).toISOString().substring(0,10)}var oH=function(){function e(t){hy(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return vy(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!qB()&&WB().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return eH.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",tH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",tH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(sy(i.heartbeats),sy(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function sH(e){return VB(JSON.stringify({version:2,heartbeats:e})).length}Gz(new cz("platform-logger",function(e){return new Dz(e)},"PRIVATE")),Gz(new cz("heartbeat",function(e){return new iH(e)},"PRIVATE")),Kz(Lz,"0.7.28",""),Kz(Lz,"0.7.28","esm2017"),Kz("fire-js","");var uH,cH="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},lH={},fH=fH||{},hH=cH||self;function dH(){}function vH(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function pH(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var gH="closure_uid_"+(1e9*Math.random()>>>0),yH=0;function mH(e,t,n){return e.call.apply(e.bind,arguments)}function kH(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function CH(e,t,n){return(CH=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mH:kH).apply(null,arguments)}function wH(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function _H(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function EH(){this.s=this.s,this.o=this.o}var bH={};EH.prototype.s=!1,EH.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,gH)&&e[gH]||(e[gH]=++yH)}(this);delete bH[e]}},EH.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var SH=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},PH=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function OH(e){return Array.prototype.concat.apply([],arguments)}function TH(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function IH(e){return/^[\s\xa0]*$/.test(e)}var AH,RH=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function MH(e,t){return-1!=e.indexOf(t)}function xH(e,t){return e<t?-1:e>t?1:0}e:{var NH=hH.navigator;if(NH){var DH=NH.userAgent;if(DH){AH=DH;break e}}AH=""}function LH(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function FH(e){var t={};for(var n in e)t[n]=e[n];return t}var UH="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function VH(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<UH.length;a++)n=UH[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function BH(e){return BH[" "](e),e}BH[" "]=dH;var zH,HH=MH(AH,"Opera"),GH=MH(AH,"Trident")||MH(AH,"MSIE"),$H=MH(AH,"Edge"),ZH=$H||GH,qH=MH(AH,"Gecko")&&!(MH(AH.toLowerCase(),"webkit")&&!MH(AH,"Edge"))&&!(MH(AH,"Trident")||MH(AH,"MSIE"))&&!MH(AH,"Edge"),WH=MH(AH.toLowerCase(),"webkit")&&!MH(AH,"Edge");function jH(){var e=hH.document;return e?e.documentMode:void 0}e:{var YH="",KH=function(){var e=AH;return qH?/rv:([^\);]+)(\)|;)/.exec(e):$H?/Edge\/([\d\.]+)/.exec(e):GH?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):WH?/WebKit\/(\S+)/.exec(e):HH?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(KH&&(YH=KH?KH[1]:""),GH){var QH=jH();if(null!=QH&&QH>parseFloat(YH)){zH=String(QH);break e}}zH=YH}var XH={};var JH=hH.document&&GH&&(jH()||parseInt(zH,10))||void 0,eG=function(){if(!hH.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{hH.addEventListener("test",dH,t),hH.removeEventListener("test",dH,t)}catch(n){}return e}();function tG(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function nG(e,t){if(tG.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(qH){e:{try{BH(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:rG[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&nG.Z.h.call(this)}}tG.prototype.h=function(){this.defaultPrevented=!0},_H(nG,tG);var rG={2:"touch",3:"pen",4:"mouse"};nG.prototype.h=function(){nG.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var iG="closure_listenable_"+(1e6*Math.random()|0),aG=0;function oG(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++aG,this.ca=this.fa=!1}function sG(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function uG(e){this.src=e,this.g={},this.h=0}function cG(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=SH(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(sG(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function lG(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}uG.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=lG(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new oG(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var fG="closure_lm_"+(1e6*Math.random()|0),hG={};function dG(e,t,n,r,i){if(r&&r.once)return pG(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)dG(e,t[a],n,r,i);return null}return n=_G(n),e&&e[iG]?e.N(t,n,pH(r)?!!r.capture:!!r,i):vG(e,t,n,!1,r,i)}function vG(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=pH(i)?!!i.capture:!!i,s=CG(e);if(s||(e[fG]=s=new uG(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=kG;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)eG||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(mG(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function pG(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)pG(e,t[a],n,r,i);return null}return n=_G(n),e&&e[iG]?e.O(t,n,pH(r)?!!r.capture:!!r,i):vG(e,t,n,!0,r,i)}function gG(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)gG(e,t[a],n,r,i);else r=pH(r)?!!r.capture:!!r,n=_G(n),e&&e[iG]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=lG(a=e.g[t],n,r,i))&&(sG(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=CG(e))&&(t=e.g[t.toString()],e=-1,t&&(e=lG(t,n,r,i)),(n=-1<e?t[e]:null)&&yG(n))}function yG(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[iG])cG(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(mG(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=CG(t))?(cG(n,e),0==n.h&&(n.src=null,t[fG]=null)):sG(e)}}}function mG(e){return e in hG?hG[e]:hG[e]="on"+e}function kG(e,t){if(e.ca)e=!0;else{t=new nG(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&yG(e),e=n.call(r,t)}return e}function CG(e){return(e=e[fG])instanceof uG?e:null}var wG="__closure_events_fn_"+(1e9*Math.random()>>>0);function _G(e){return"function"==typeof e?e:(e[wG]||(e[wG]=function(t){return e.handleEvent(t)}),e[wG])}function EG(){EH.call(this),this.i=new uG(this),this.P=this,this.I=null}function bG(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new tG(t,e);else if(t instanceof tG)t.target=t.target||e;else{var i=t;VH(t=new tG(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=SG(o,r,!0,t)&&i}if(i=SG(o=t.g=e,r,!0,t)&&i,i=SG(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=SG(o=t.g=n[a],r,!1,t)&&i}function SG(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&cG(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}_H(EG,EH),EG.prototype[iG]=!0,EG.prototype.removeEventListener=function(e,t,n,r){gG(this,e,t,n,r)},EG.prototype.M=function(){if(EG.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)sG(n[r]);delete t.g[e],t.h--}}this.I=null},EG.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},EG.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var PG=hH.JSON.stringify;function OG(){var e=NG,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var TG,IG=new(function(){function e(t,n){hy(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return vy(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new AG},function(e){return e.reset()}),AG=function(){function e(){hy(this,e),this.next=this.g=this.h=null}return vy(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function RG(e){hH.setTimeout(function(){throw e},0)}function MG(e,t){TG||function(){var e=hH.Promise.resolve(void 0);TG=function(){e.then(DG)}}(),xG||(TG(),xG=!0),NG.add(e,t)}var xG=!1,NG=new(function(){function e(){hy(this,e),this.h=this.g=null}return vy(e,[{key:"add",value:function(e,t){var n=IG.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function DG(){for(var e;e=OG();){try{e.h.call(e.g)}catch(n){RG(n)}var t=IG;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}xG=!1}function LG(e,t){EG.call(this),this.h=e||1,this.g=t||hH,this.j=CH(this.kb,this),this.l=Date.now()}function FG(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function UG(e,t,n){if("function"==typeof e)n&&(e=CH(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=CH(e.handleEvent,e)}return 2147483647<Number(t)?-1:hH.setTimeout(e,t||0)}function VG(e){e.g=UG(function(){e.g=null,e.i&&(e.i=!1,VG(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}_H(LG,EG),(uH=LG.prototype).da=!1,uH.S=null,uH.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),bG(this,"tick"),this.da&&(FG(this),this.start()))}},uH.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},uH.M=function(){LG.Z.M.call(this),FG(this),delete this.g};var BG=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return vy(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:VG(this)}},{key:"M",value:function(){Xg(oy(n.prototype),"M",this).call(this),this.g&&(hH.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(EH);function zG(e){EH.call(this),this.h=e,this.g={}}_H(zG,EH);var HG=[];function GG(e,t,n,r){Array.isArray(n)||(n&&(HG[0]=n.toString()),n=HG);for(var i=0;i<n.length;i++){var a=dG(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function $G(e){LH(e.g,function(e,t){this.g.hasOwnProperty(t)&&yG(e)},e),e.g={}}function ZG(){this.g=!0}function qG(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return PG(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}zG.prototype.M=function(){zG.Z.M.call(this),$G(this)},zG.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ZG.prototype.Aa=function(){this.g=!1},ZG.prototype.info=function(){};var WG={},jG=null;function YG(){return jG=jG||new EG}function KG(e){tG.call(this,WG.Ma,e)}function QG(e){var t=YG();bG(t,new KG(t,e))}function XG(e,t){tG.call(this,WG.STAT_EVENT,e),this.stat=t}function JG(e){var t=YG();bG(t,new XG(t,e))}function e$(e,t){tG.call(this,WG.Na,e),this.size=t}function t$(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return hH.setTimeout(function(){e()},t)}WG.Ma="serverreachability",_H(KG,tG),WG.STAT_EVENT="statevent",_H(XG,tG),WG.Na="timingevent",_H(e$,tG);var n$={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},r$={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function i$(){}function a$(){}i$.prototype.h=null;var o$,s$={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function u$(){tG.call(this,"d")}function c$(){tG.call(this,"c")}function l$(){}function f$(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new zG(this),this.P=d$,this.W=new LG(e=ZH?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new h$}function h$(){this.i=null,this.g="",this.h=!1}_H(u$,tG),_H(c$,tG),_H(l$,i$),l$.prototype.g=function(){return new XMLHttpRequest},l$.prototype.i=function(){return{}},o$=new l$;var d$=45e3,v$={},p$={};function g$(e,t,n){e.K=1,e.v=V$(x$(t)),e.s=n,e.U=!0,y$(e,null)}function y$(e,t){e.F=Date.now(),w$(e),e.A=x$(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),X$(n.h,"t",r),e.C=0,n=e.l.H,e.h=new h$,e.g=XZ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new BG(CH(e.Ia,e,e.g),e.O)),GG(e.V,e.g,"readystatechange",e.gb),t=e.H?FH(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),QG(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function m$(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function k$(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=C$(e,n))==p$){4==t&&(e.o=4,JG(14),i=!1),qG(e.j,e.m,null,"[Incomplete Response]");break}if(r==v$){e.o=4,JG(15),qG(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}qG(e.j,e.m,r,null),P$(e,r)}m$(e)&&r!=p$&&r!=v$&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,JG(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),$Z(t),t.L=!0,JG(11))):(qG(e.j,e.m,n,"[Invalid Chunked Response]"),S$(e),b$(e))}function C$(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?p$:(n=Number(t.substring(n,r)),isNaN(n)?v$:(r+=1)+n>t.length?p$:(t=t.substr(r,n),e.C=r+n,t))}function w$(e){e.Y=Date.now()+e.P,_$(e,e.P)}function _$(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=t$(CH(e.eb,e),t)}function E$(e){e.B&&(hH.clearTimeout(e.B),e.B=null)}function b$(e){0==e.l.G||e.I||WZ(e.l,e)}function S$(e){E$(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,FG(e.W),$G(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function P$(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||iZ(n.i,e)))if(n.I=e.N,!e.J&&iZ(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=t$(CH(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;qZ(n),DZ(n)}GZ(n),JG(18)}if(1>=rZ(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else YZ(n,11)}else if((e.J||n.g==e)&&qZ(n),!IH(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(MH(l,"spdy")||MH(l,"quic")||MH(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(aZ(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,U$(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=QZ(r,r.H?r.la:null,r.W),d.J){oZ(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(E$(v),w$(v)),r.g=d}else HZ(r);0<n.l.length&&UZ(n)}else"stop"!=a[0]&&"close"!=a[0]||YZ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?YZ(n,7):NZ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}QG(4)}catch(m){}}function O$(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(vH(e)||"string"==typeof e)PH(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(vH(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(vH(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function T$(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof T$)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function I$(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];A$(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)A$(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function A$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(uH=f$.prototype).setTimeout=function(e){this.P=e},uH.gb=function(e){e=e.target;var t=this.L;t&&3==IZ(e)?t.l():this.Ia(e)},uH.Ia=function(e){try{if(e==this.g)e:{var t=IZ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||ZH||this.g&&(this.h.h||this.g.ga()||AZ(this.g)))){this.I||4!=t||7==n||QG(8==n||0>=r?3:2),E$(this);var i=this.g.ba();this.N=i;t:if(m$(this)){var a=AZ(this.g);e="";var o=a.length,s=4==IZ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){S$(this),b$(this);var u="";break t}this.h.i=new hH.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!IH(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,JG(12),S$(this),b$(this);break e}qG(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,P$(this,i)}this.U?(k$(this,t,u),ZH&&this.i&&3==t&&(GG(this.V,this.W,"tick",this.fb),this.W.start())):(qG(this.j,this.m,u,null),P$(this,u)),4==t&&S$(this),this.i&&!this.I&&(4==t?WZ(this.l,this):(this.i=!1,w$(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,JG(12)):(this.o=0,JG(13)),S$(this),b$(this)}}}catch(h){}},uH.fb=function(){if(this.g){var e=IZ(this.g),t=this.g.ga();this.C<t.length&&(E$(this),k$(this,e,t),this.i&&4!=e&&w$(this))}},uH.cancel=function(){this.I=!0,S$(this)},uH.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(QG(3),JG(17)),S$(this),this.o=2,b$(this)):_$(this,this.Y-e)},(uH=T$.prototype).R=function(){I$(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},uH.T=function(){return I$(this),this.g.concat()},uH.get=function(e,t){return A$(this.h,e)?this.h[e]:t},uH.set=function(e,t){A$(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},uH.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var R$=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function M$(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof M$){this.g=void 0!==t?t:e.g,N$(this,e.j),this.s=e.s,D$(this,e.i),L$(this,e.m),this.l=e.l,t=e.h;var n=new j$;n.i=t.i,t.g&&(n.g=new T$(t.g),n.h=t.h),F$(this,n),this.o=e.o}else e&&(n=String(e).match(R$))?(this.g=!!t,N$(this,n[1]||"",!0),this.s=B$(n[2]||""),D$(this,n[3]||"",!0),L$(this,n[4]),this.l=B$(n[5]||"",!0),F$(this,n[6]||"",!0),this.o=B$(n[7]||"")):(this.g=!!t,this.h=new j$(null,this.g))}function x$(e){return new M$(e)}function N$(e,t,n){e.j=n?B$(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function D$(e,t,n){e.i=n?B$(t,!0):t}function L$(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function F$(e,t,n){t instanceof j$?(e.h=t,function(e,t){t&&!e.j&&(Y$(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(K$(this,t),X$(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=z$(t,q$)),e.h=new j$(t,e.g))}function U$(e,t,n){e.h.set(t,n)}function V$(e){return U$(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function B$(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function z$(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,H$),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function H$(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}M$.prototype.toString=function(){var e=[],t=this.j;t&&e.push(z$(t,G$,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(z$(t,G$,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(z$(n,"/"==n.charAt(0)?Z$:$$,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",z$(n,W$)),e.join("")};var G$=/[#\/\?@]/g,$$=/[#\?:]/g,Z$=/[#\?]/g,q$=/[#\?@]/g,W$=/#/g;function j$(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Y$(e){e.g||(e.g=new T$,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function K$(e,t){Y$(e),t=J$(e,t),A$(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,A$((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&I$(e)))}function Q$(e,t){return Y$(e),t=J$(e,t),A$(e.g.h,t)}function X$(e,t,n){K$(e,t),0<n.length&&(e.i=null,e.g.set(J$(e,t),TH(n)),e.h+=n.length)}function J$(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function eZ(e){this.l=e||tZ,e=hH.PerformanceNavigationTiming?0<(e=hH.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(hH.g&&hH.g.Ea&&hH.g.Ea()&&hH.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(uH=j$.prototype).add=function(e,t){Y$(this),this.i=null,e=J$(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},uH.forEach=function(e,t){Y$(this),this.g.forEach(function(n,r){PH(n,function(n){e.call(t,n,r,this)},this)},this)},uH.T=function(){Y$(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},uH.R=function(e){Y$(this);var t=[];if("string"==typeof e)Q$(this,e)&&(t=OH(t,this.g.get(J$(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=OH(t,e[n])}return t},uH.set=function(e,t){return Y$(this),this.i=null,Q$(this,e=J$(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},uH.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},uH.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var tZ=10;function nZ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function rZ(e){return e.h?1:e.g?e.g.size:0}function iZ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function aZ(e,t){e.g?e.g.add(t):e.h=t}function oZ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function sZ(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=cy(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return TH(e.i)}function uZ(){}function cZ(){this.g=new uZ}function lZ(e,t,n){var r=n||"";try{O$(e,function(e,n){var i=e;pH(e)&&(i=PG(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function fZ(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function hZ(e){this.l=e.$b||null,this.j=e.ib||!1}function dZ(e,t){EG.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=vZ,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}eZ.prototype.cancel=function(){if(this.i=sZ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=cy(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},uZ.prototype.stringify=function(e){return hH.JSON.stringify(e,void 0)},uZ.prototype.parse=function(e){return hH.JSON.parse(e,void 0)},_H(hZ,i$),hZ.prototype.g=function(){return new dZ(this.l,this.j)},hZ.prototype.i=function(e){return function(){return e}}({}),_H(dZ,EG);var vZ=0;function pZ(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function gZ(e){e.readyState=4,e.l=null,e.j=null,e.A=null,yZ(e)}function yZ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(uH=dZ.prototype).open=function(e,t){if(this.readyState!=vZ)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,yZ(this)},uH.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||hH).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},uH.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,gZ(this)),this.readyState=vZ},uH.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,yZ(this)),this.g&&(this.readyState=3,yZ(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==hH.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pZ(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},uH.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?gZ(this):yZ(this),3==this.readyState&&pZ(this)}},uH.Ua=function(e){this.g&&(this.response=this.responseText=e,gZ(this))},uH.Ta=function(e){this.g&&(this.response=e,gZ(this))},uH.ha=function(){this.g&&gZ(this)},uH.setRequestHeader=function(e,t){this.v.append(e,t)},uH.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},uH.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(dZ.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var mZ=hH.JSON.parse;function kZ(e){EG.call(this),this.headers=new T$,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=CZ,this.K=this.L=!1}_H(kZ,EG);var CZ="",wZ=/^https?$/i,_Z=["POST","PUT"];function EZ(e){return"content-type"==e.toLowerCase()}function bZ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,SZ(e),OZ(e)}function SZ(e){e.D||(e.D=!0,bG(e,"complete"),bG(e,"error"))}function PZ(e){if(e.h&&void 0!==fH&&(!e.C[1]||4!=IZ(e)||2!=e.ba()))if(e.v&&4==IZ(e))UG(e.Fa,0,e);else if(bG(e,"readystatechange"),4==IZ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(R$)[1]||null;if(!a&&hH.self&&hH.self.location){var o=hH.self.location.protocol;a=o.substr(0,o.length-1)}i=!wZ.test(a?a.toLowerCase():"")}t=i}if(t)bG(e,"complete"),bG(e,"success");else{e.m=6;try{var s=2<IZ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",SZ(e)}}finally{OZ(e)}}}function OZ(e,t){if(e.g){TZ(e);var n=e.g,r=e.C[0]?dH:null;e.g=null,e.C=null,t||bG(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function TZ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(hH.clearTimeout(e.A),e.A=null)}function IZ(e){return e.g?e.g.readyState:0}function AZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case CZ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function RZ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return LH(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):U$(e,t,n))}function MZ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function xZ(e){this.za=0,this.l=[],this.h=new ZG,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=MZ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=MZ("baseRetryDelayMs",5e3,e),this.$a=MZ("retryDelaySeedMs",1e4,e),this.Ya=MZ("forwardChannelMaxRetries",2,e),this.ra=MZ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new eZ(e&&e.concurrentRequestLimit),this.Ca=new cZ,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function NZ(e){if(LZ(e),3==e.G){var t=e.V++,n=x$(e.F);U$(n,"SID",e.J),U$(n,"RID",t),U$(n,"TYPE","terminate"),BZ(e,n),(t=new f$(e,e.h,t,void 0)).K=2,t.v=V$(x$(n)),n=!1,hH.navigator&&hH.navigator.sendBeacon&&(n=hH.navigator.sendBeacon(t.v.toString(),"")),!n&&hH.Image&&((new Image).src=t.v,n=!0),n||(t.g=XZ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),w$(t)}KZ(e)}function DZ(e){e.g&&($Z(e),e.g.cancel(),e.g=null)}function LZ(e){DZ(e),e.u&&(hH.clearTimeout(e.u),e.u=null),qZ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&hH.clearTimeout(e.m),e.m=null)}function FZ(e,t){e.l.push(new(function(){return vy(function e(t,n){hy(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&UZ(e)}function UZ(e){nZ(e.i)||e.m||(e.m=!0,MG(e.Ha,e),e.C=0)}function VZ(e,t){var n;n=t?t.m:e.V++;var r=x$(e.F);U$(r,"SID",e.J),U$(r,"RID",n),U$(r,"AID",e.U),BZ(e,r),e.o&&e.s&&RZ(r,e.o,e.s),n=new f$(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=zZ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),aZ(e.i,n),g$(n,r,t)}function BZ(e,t){e.j&&O$({},function(e,n){U$(t,n,e)})}function zZ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?CH(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{lZ(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function HZ(e){e.g||e.u||(e.Y=1,MG(e.Ga,e),e.A=0)}function GZ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=t$(CH(e.Ga,e),jZ(e,e.A)),e.A++,0))}function $Z(e){null!=e.B&&(hH.clearTimeout(e.B),e.B=null)}function ZZ(e){e.g=new f$(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=x$(e.oa);U$(t,"RID","rpc"),U$(t,"SID",e.J),U$(t,"CI",e.N?"0":"1"),U$(t,"AID",e.U),BZ(e,t),U$(t,"TYPE","xmlhttp"),e.o&&e.s&&RZ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=V$(x$(t)),n.s=null,n.U=!0,y$(n,e)}function qZ(e){null!=e.v&&(hH.clearTimeout(e.v),e.v=null)}function WZ(e,t){var n=null;if(e.g==t){qZ(e),$Z(e),e.g=null;var r=2}else{if(!iZ(e.i,t))return;n=t.D,oZ(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;bG(r=YG(),new e$(r,n,t,i)),UZ(e)}else HZ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(rZ(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=t$(CH(e.Ha,e,t),jZ(e,e.C)),e.C++,0)))}(e,t)||2==r&&GZ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:YZ(e,5);break;case 4:YZ(e,10);break;case 3:YZ(e,6);break;default:YZ(e,2)}}function jZ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function YZ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=CH(e.jb,e);n||(n=new M$("//www.google.com/images/cleardot.gif"),hH.location&&"http"==hH.location.protocol||N$(n,"https"),V$(n)),function(e,t){var n=new ZG;if(hH.Image){var r=new Image;r.onload=wH(fZ,n,r,"TestLoadImage: loaded",!0,t),r.onerror=wH(fZ,n,r,"TestLoadImage: error",!1,t),r.onabort=wH(fZ,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=wH(fZ,n,r,"TestLoadImage: timeout",!1,t),hH.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else JG(2);e.G=0,e.j&&e.j.va(t),KZ(e),LZ(e)}function KZ(e){e.G=0,e.I=-1,e.j&&((0!=sZ(e.i).length||0!=e.l.length)&&(e.i.i.length=0,TH(e.l),e.l.length=0),e.j.ua())}function QZ(e,t,n){var r=function(e){return e instanceof M$?x$(e):new M$(e,void 0)}(n);if(""!=r.i)t&&D$(r,t+"."+r.i),L$(r,r.m);else{var i=hH.location;r=function(e,t,n,r){var i=new M$(null,void 0);return e&&N$(i,e),t&&D$(i,t),n&&L$(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&LH(e.aa,function(e,t){U$(r,t,e)}),n=e.sa,(t=e.D)&&n&&U$(r,t,n),U$(r,"VER",e.ma),BZ(e,r),r}function XZ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new kZ(n&&e.Ba&&!e.qa?new hZ({ib:!0}):e.qa)).L=e.H,t}function JZ(){}function eq(){if(GH&&!(10<=Number(JH)))throw Error("Environmental error: no available transport.")}function tq(e,t){EG.call(this),this.g=new xZ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!IH(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!IH(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new iq(this)}function nq(e){u$.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function rq(){c$.call(this),this.status=1}function iq(e){this.g=e}(uH=kZ.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():o$.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:o$),this.g.onreadystatechange=CH(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void bZ(this,a)}e=n||"";var i=new T$(this.headers);r&&O$(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=EZ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=hH.FormData&&e instanceof hH.FormData,!(0<=SH(_Z,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{TZ(this),0<this.B&&((this.K=function(e){return GH&&function(){return e=XH,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=RH(String(zH)).split("."),n=RH("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=xH(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||xH(0==a[2].length,0==o[2].length)||xH(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=CH(this.pa,this)):this.A=UG(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){bZ(this,a)}},uH.pa=function(){void 0!==fH&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,bG(this,"timeout"),this.abort(8))},uH.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,bG(this,"complete"),bG(this,"abort"),OZ(this))},uH.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),OZ(this,!0)),kZ.Z.M.call(this)},uH.Fa=function(){this.s||(this.F||this.v||this.l?PZ(this):this.cb())},uH.cb=function(){PZ(this)},uH.ba=function(){try{return 2<IZ(this)?this.g.status:-1}catch(e){return-1}},uH.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},uH.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),mZ(t)}},uH.Da=function(){return this.m},uH.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(uH=xZ.prototype).ma=8,uH.G=1,uH.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},uH.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new f$(this,this.h,e,void 0),n=this.s;if(this.P&&(n?VH(n=FH(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=zZ(this,t,r),U$(i=x$(this.F),"RID",e),U$(i,"CVER",22),this.D&&U$(i,"X-HTTP-Session-Id",this.D),BZ(this,i),this.o&&n&&RZ(i,this.o,n),aZ(this.i,t),this.Ra&&U$(i,"TYPE","init"),this.ja?(U$(i,"$req",r),U$(i,"SID","null"),t.$=!0,g$(t,i,null)):g$(t,i,r),this.G=2}}else 3==this.G&&(e?VZ(this,e):0==this.l.length||nZ(this.i)||VZ(this))},uH.Ga=function(){if(this.u=null,ZZ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=t$(CH(this.bb,this),e)}},uH.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,JG(10),DZ(this),ZZ(this))},uH.ab=function(){null!=this.v&&(this.v=null,DZ(this),GZ(this),JG(19))},uH.jb=function(e){e?(this.h.info("Successfully pinged google.com"),JG(2)):(this.h.info("Failed to ping google.com"),JG(1))},(uH=JZ.prototype).xa=function(){},uH.wa=function(){},uH.va=function(){},uH.ua=function(){},uH.Oa=function(){},eq.prototype.g=function(e,t){return new tq(e,t)},_H(tq,EG),tq.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),MG(CH(e.hb,e,t))),JG(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=QZ(e,null,e.W),UZ(e)},tq.prototype.close=function(){NZ(this.g)},tq.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,FZ(this.g,t)}else this.v?((t={}).__data__=PG(e),FZ(this.g,t)):FZ(this.g,e)},tq.prototype.M=function(){this.g.j=null,delete this.j,NZ(this.g),delete this.g,tq.Z.M.call(this)},_H(nq,u$),_H(rq,c$),_H(iq,JZ),iq.prototype.xa=function(){bG(this.g,"a")},iq.prototype.wa=function(e){bG(this.g,new nq(e))},iq.prototype.va=function(e){bG(this.g,new rq(e))},iq.prototype.ua=function(){bG(this.g,"b")},eq.prototype.createWebChannel=eq.prototype.g,tq.prototype.send=tq.prototype.u,tq.prototype.open=tq.prototype.m,tq.prototype.close=tq.prototype.close,n$.NO_ERROR=0,n$.TIMEOUT=8,n$.HTTP_ERROR=6,r$.COMPLETE="complete",a$.EventType=s$,s$.OPEN="a",s$.CLOSE="b",s$.ERROR="c",s$.MESSAGE="d",EG.prototype.listen=EG.prototype.N,kZ.prototype.listenOnce=kZ.prototype.O,kZ.prototype.getLastError=kZ.prototype.La,kZ.prototype.getLastErrorCode=kZ.prototype.Da,kZ.prototype.getStatus=kZ.prototype.ba,kZ.prototype.getResponseJson=kZ.prototype.Qa,kZ.prototype.getResponseText=kZ.prototype.ga,kZ.prototype.send=kZ.prototype.ea;var aq=lH.createWebChannelTransport=function(){return new eq},oq=lH.getStatEventTarget=function(){return YG()},sq=lH.ErrorCode=n$,uq=lH.EventType=r$,cq=lH.Event=WG,lq=lH.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},fq=lH.FetchXmlHttpFactory=hZ,hq=lH.WebChannel=a$,dq=lH.XhrIo=kZ,vq="@firebase/firestore",pq=function(){function e(t){hy(this,e),this.uid=t}return vy(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();pq.UNAUTHENTICATED=new pq(null),pq.GOOGLE_CREDENTIALS=new pq("google-credentials-uid"),pq.FIRST_PARTY=new pq("first-party-uid"),pq.MOCK_USER=new pq("mock-user");var gq="9.9.0",yq=new kz("@firebase/firestore");function mq(){return yq.logLevel}function kq(e){if(yq.logLevel<=vz.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(_q);yq.debug.apply(yq,["Firestore (".concat(gq,"): ").concat(e)].concat(sy(i)))}}function Cq(e){if(yq.logLevel<=vz.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(_q);yq.error.apply(yq,["Firestore (".concat(gq,"): ").concat(e)].concat(sy(i)))}}function wq(e){if(yq.logLevel<=vz.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(_q);yq.warn.apply(yq,["Firestore (".concat(gq,"): ").concat(e)].concat(sy(i)))}}function _q(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Eq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(gq,") INTERNAL ASSERTION FAILED: ")+e;throw Cq(t),new Error(t)}function bq(e,t){e||Eq()}function Sq(e,t){return e}var Pq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Oq=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return vy(n)}(YB),Tq=vy(function e(){var t=this;hy(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),Iq=vy(function e(t,n){hy(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),Aq=function(){function e(){hy(this,e)}return vy(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(pq.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),Rq=function(){function e(t){hy(this,e),this.t=t,this.currentUser=pq.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return vy(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new Tq;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new Tq,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){kq("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(kq("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Tq)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(kq("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(bq("string"==typeof n.accessToken),new Iq(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return bq(null===e||"string"==typeof e),new pq(e)}}]),e}(),Mq=vy(function e(t,n,r){hy(this,e),this.type="FirstParty",this.user=pq.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),xq=function(){function e(t,n,r){hy(this,e),this.h=t,this.l=n,this.m=r}return vy(e,[{key:"getToken",value:function(){return Promise.resolve(new Mq(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(pq.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Nq=vy(function e(t){hy(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),Dq=function(){function e(t){hy(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return vy(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&kq("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,kq("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){kq("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):kq("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(bq("string"==typeof t.token),e.p=t.token,new Nq(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Lq(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Fq=function(){function e(){hy(this,e)}return vy(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Lq(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Uq(e,t){return e<t?-1:e>t?1:0}function Vq(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var Bq=function(){function e(t,n){if(hy(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Oq(Pq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Oq(Pq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Oq(Pq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Oq(Pq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return vy(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Uq(this.nanoseconds,e.nanoseconds):Uq(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),zq=function(){function e(t){hy(this,e),this.timestamp=t}return vy(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Bq(0,0))}},{key:"max",value:function(){return new e(new Bq(253402300799,999999999))}}]),e}(),Hq=function(){function e(t,n,r){hy(this,e),void 0===n?n=0:n>t.length&&Eq(),void 0===r?r=t.length-n:r>t.length-n&&Eq(),this.segments=t,this.offset=n,this.len=r}return vy(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Gq=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,sy(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Hq),$q=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Zq=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return $q.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Oq(Pq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Oq(Pq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new Oq(Pq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Hq),qq=function(){function e(t){hy(this,e),this.path=t}return vy(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Gq.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Gq.fromString(t))}},{key:"fromName",value:function(t){return new e(Gq.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Gq.emptyPath())}},{key:"comparator",value:function(e,t){return Gq.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Gq(t.slice()))}}]),e}();function Wq(e){return new jq(e.readTime,e.key,-1)}var jq=function(){function e(t,n,r){hy(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return vy(e,null,[{key:"min",value:function(){return new e(zq.min(),qq.empty(),-1)}},{key:"max",value:function(){return new e(zq.max(),qq.empty(),-1)}}]),e}();function Yq(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=qq.comparator(e.documentKey,t.documentKey))?n:Uq(e.largestBatchId,t.largestBatchId)}var Kq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Qq(e){return Xq.apply(this,arguments)}function Xq(){return Xq=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Pq.FAILED_PRECONDITION&&t.message===Kq){e.next=2;break}throw t;case 2:kq("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),Xq.apply(this,arguments)}var Jq=function(){function e(t){var n=this;hy(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return vy(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Eq(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=cy(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function eW(e){return"IndexedDbTransactionError"===e.name}var tW=function(){function e(t,n){var r=this;hy(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return vy(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function nW(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function rW(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function iW(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}tW.ot=-1;var aW=function(){function e(t,n){hy(this,e),this.comparator=t,this.root=n||sW.EMPTY}return vy(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,sW.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,sW.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new oW(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new oW(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new oW(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new oW(this.root,e,this.comparator,!0)}}]),e}(),oW=function(){function e(t,n,r,i){hy(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return vy(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),sW=function(){function e(t,n,r,i,a){hy(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return vy(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Eq();var e=this.left.check();if(e!==this.right.check())throw Eq();return e+(this.isRed()?0:1)}}]),e}();sW.EMPTY=null,sW.RED=!0,sW.BLACK=!1,sW.EMPTY=new(function(){function e(){hy(this,e),this.size=0}return vy(e,[{key:"key",get:function(){throw Eq()}},{key:"value",get:function(){throw Eq()}},{key:"color",get:function(){throw Eq()}},{key:"left",get:function(){throw Eq()}},{key:"right",get:function(){throw Eq()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new sW(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var uW=function(){function e(t){hy(this,e),this.comparator=t,this.data=new aW(this.comparator)}return vy(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new cW(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new cW(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),cW=function(){function e(t){hy(this,e),this.iter=t}return vy(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),lW=function(){function e(t){hy(this,e),this.fields=t,t.sort(Zq.comparator)}return vy(e,[{key:"unionWith",value:function(t){var n,r=new uW(Zq.comparator),i=cy(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=cy(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=cy(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Vq(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),fW=function(e){function t(e){hy(this,t),this.binaryString=e}return vy(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Uq(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();fW.EMPTY_BYTE_STRING=new fW("");var hW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dW(e){if(bq(!!e),"string"==typeof e){var t=0,n=hW.exec(e);if(bq(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:vW(e.seconds),nanos:vW(e.nanos)}}function vW(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function pW(e){return"string"==typeof e?fW.fromBase64String(e):fW.fromUint8Array(e)}function gW(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yW(e){var t=e.mapValue.fields.__previous_value__;return gW(t)?yW(t):t}function mW(e){var t=dW(e.mapValue.fields.__local_write_time__.timestampValue);return new Bq(t.seconds,t.nanos)}var kW=vy(function e(t,n,r,i,a,o,s,u){hy(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),CW=function(){function e(t,n){hy(this,e),this.projectId=t,this.database=n||"(default)"}return vy(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function wW(e){return null==e}function _W(e){return 0===e&&1/e==-1/0}var EW={fields:{__type__:{stringValue:"__max__"}}};function bW(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?gW(e)?4:UW(e)?9007199254740991:10:Eq()}function SW(e,t){if(e===t)return!0;var n,r=bW(e);if(r!==bW(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return mW(e).isEqual(mW(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=dW(e.timestampValue),r=dW(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,pW(e.bytesValue).isEqual(pW(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return vW(e.geoPointValue.latitude)===vW(t.geoPointValue.latitude)&&vW(e.geoPointValue.longitude)===vW(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return vW(e.integerValue)===vW(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=vW(e.doubleValue),r=vW(t.doubleValue);return n===r?_W(n)===_W(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Vq(e.arrayValue.values||[],t.arrayValue.values||[],SW);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(nW(n)!==nW(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!SW(n[i],r[i])))return!1;return!0}(e,t);default:return Eq()}}function PW(e,t){return void 0!==(e.values||[]).find(function(e){return SW(e,t)})}function OW(e,t){if(e===t)return 0;var n,r,i,a,o=bW(e),s=bW(t);if(o!==s)return Uq(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Uq(e.booleanValue,t.booleanValue);case 2:return r=t,i=vW((n=e).integerValue||n.doubleValue),a=vW(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return TW(e.timestampValue,t.timestampValue);case 4:return TW(mW(e),mW(t));case 5:return Uq(e.stringValue,t.stringValue);case 6:return function(e,t){var n=pW(e),r=pW(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Uq(n[i],r[i]);if(0!==a)return a}return Uq(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Uq(vW(e.latitude),vW(t.latitude));return 0!==n?n:Uq(vW(e.longitude),vW(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=OW(n[i],r[i]);if(a)return a}return Uq(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===EW&&t===EW)return 0;if(e===EW)return 1;if(t===EW)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Uq(r[o],a[o]);if(0!==s)return s;var u=OW(n[r[o]],i[a[o]]);if(0!==u)return u}return Uq(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Eq()}}function TW(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Uq(e,t);var n=dW(e),r=dW(t),i=Uq(n.seconds,r.seconds);return 0!==i?i:Uq(n.nanos,r.nanos)}function IW(e){return AW(e)}function AW(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=dW(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?pW(e.bytesValue).toBase64():"referenceValue"in e?qq.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=cy(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=AW(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=cy(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(AW(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):Eq();var t,n,r}function RW(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function MW(e){return!!e&&"integerValue"in e}function xW(e){return!!e&&"arrayValue"in e}function NW(e){return!!e&&"nullValue"in e}function DW(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function LW(e){return!!e&&"mapValue"in e}function FW(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return rW(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=FW(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=FW(e.arrayValue.values[r]);return n}return Object.assign({},e)}function UW(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var VW=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!LW(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=FW(t)}},{key:"setAll",value:function(e){var t=this,n=Zq.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=FW(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());LW(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return SW(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];LW(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){rW(t,function(t,n){return e[t]=n});var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(FW(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function BW(e){var t=[];return rW(e.fields,function(e,n){var r=new Zq([e]);if(LW(n)){var i=BW(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=cy(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new lW(t)}var zW=function(){function e(t,n,r,i,a,o){hy(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return vy(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=VW.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=VW.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=zq.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,zq.min(),zq.min(),VW.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,zq.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,zq.min(),VW.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,zq.min(),VW.empty(),2)}}]),e}(),HW=vy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;hy(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function GW(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new HW(e,t,n,r,i,a,o)}function $W(e){var t=Sq(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+IW(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),wW(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return IW(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return IW(e)}).join(",")),t.ut=n}return t.ut}function ZW(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!ij(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!SW(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!oj(e.startAt,t.startAt)&&oj(e.endAt,t.endAt)}function qW(e){return qq.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var WW=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return vy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(OW(t,this.value)):null!==t&&bW(this.value)===bW(t)&&this.at(OW(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Eq()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new jW(e,t,r):"array-contains"===t?new XW(e,r):"in"===t?new JW(e,r):"not-in"===t?new ej(e,r):"array-contains-any"===t?new tj(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new YW(e,n):new KW(e,n)}}]),n}(function(){return vy(function e(){hy(this,e)})}()),jW=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r,i)).key=qq.fromName(i.referenceValue),a}return vy(n,[{key:"matches",value:function(e){var t=qq.comparator(e.key,this.key);return this.at(t)}}]),n}(WW),YW=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,"in",r)).keys=QW(0,r),i}return vy(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(WW),KW=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,"not-in",r)).keys=QW(0,r),i}return vy(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(WW);function QW(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return qq.fromName(e.referenceValue)})}var XW=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,"array-contains",r)}return vy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return xW(t)&&PW(t.arrayValue,this.value)}}]),n}(WW),JW=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,"in",r)}return vy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&PW(this.value.arrayValue,t)}}]),n}(WW),ej=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,"not-in",r)}return vy(n,[{key:"matches",value:function(e){if(PW(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!PW(this.value.arrayValue,t)}}]),n}(WW),tj=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,"array-contains-any",r)}return vy(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!xW(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return PW(t.value.arrayValue,e)})}}]),n}(WW),nj=vy(function e(t,n){hy(this,e),this.position=t,this.inclusive=n}),rj=vy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";hy(this,e),this.field=t,this.dir=n});function ij(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function aj(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?qq.comparator(qq.fromName(o.referenceValue),n.key):OW(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function oj(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!SW(e.position[n],t.position[n]))return!1;return!0}var sj=vy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;hy(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function uj(e){return new sj(e)}function cj(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function lj(e){var t,n=cy(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function fj(e){return null!==e.collectionGroup}function hj(e){var t=Sq(e);if(null===t.lt){t.lt=[];var n=lj(t),r=cj(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new rj(n)),t.lt.push(new rj(Zq.keyField(),"asc"));else{var i,a=!1,o=cy(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new rj(Zq.keyField(),u))}}}return t.lt}function dj(e){var t=Sq(e);if(!t.ft)if("F"===t.limitType)t.ft=GW(t.path,t.collectionGroup,hj(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=cy(hj(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new rj(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new nj(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new nj(t.startAt.position,t.startAt.inclusive):null;t.ft=GW(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function vj(e,t,n){return new sj(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function pj(e,t){return ZW(dj(e),dj(t))&&e.limitType===t.limitType}function gj(e){return"".concat($W(dj(e)),"|lt:").concat(e.limitType)}function yj(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(IW(t.value));var t}).join(", "),"]")),wW(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return IW(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return IW(e)}).join(",")),"Target(".concat(t,")")}(dj(e)),"; limitType=").concat(e.limitType,")")}function mj(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):qq.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=cy(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=cy(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=hj(o),i=s,a=aj(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=aj(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,hj(o),s)));var n,r,i,a,o,s}function kj(e){return function(t,n){var r,i=!1,a=cy(hj(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=Cj(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function Cj(e,t,n){var r,i,a,o,s=e.field.isKeyField()?qq.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?OW(a,o):Eq());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return Eq()}}function wj(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_W(t)?"-0":t}}function _j(e){return{integerValue:""+e}}var Ej=vy(function e(){hy(this,e),this._=void 0});function bj(e,t,n){return e instanceof Oj?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof Tj?Ij(e,t):e instanceof Aj?Rj(e,t):function(e,t){var n=Pj(e,t),r=xj(n)+xj(e._t);return MW(n)&&MW(e._t)?_j(r):wj(e.wt,r)}(e,t);var r,i,a}function Sj(e,t,n){return e instanceof Tj?Ij(e,t):e instanceof Aj?Rj(e,t):n}function Pj(e,t){return e instanceof Mj?MW(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var Oj=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n)}(Ej),Tj=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).elements=e,r}return vy(n)}(Ej);function Ij(e,t){var n,r=Nj(t),i=cy(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return SW(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Aj=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).elements=e,r}return vy(n)}(Ej);function Rj(e,t){var n,r=Nj(t),i=cy(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!SW(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Mj=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).wt=e,i._t=r,i}return vy(n)}(Ej);function xj(e){return vW(e.integerValue||e.doubleValue)}function Nj(e){return xW(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Dj=vy(function e(t,n){hy(this,e),this.field=t,this.transform=n}),Lj=vy(function e(t,n){hy(this,e),this.version=t,this.transformResults=n}),Fj=function(){function e(t,n){hy(this,e),this.updateTime=t,this.exists=n}return vy(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Uj(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Vj=vy(function e(){hy(this,e)});function Bj(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Xj(e.key,Fj.none()):new Zj(e.key,e.data,Fj.none());var n,r=e.data,i=VW.empty(),a=new uW(Zq.comparator),o=cy(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new qj(e.key,i,new lW(a.toArray()),Fj.none())}function zj(e,t,n){var r,i,a,o,s;e instanceof Zj?(i=t,a=n,o=(r=e).value.clone(),s=jj(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof qj?function(e,t,n){if(Uj(e.precondition,t)){var r=jj(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Wj(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function Hj(e,t,n,r){return e instanceof Zj?function(e,t,n,r){if(!Uj(e.precondition,t))return n;var i=e.value.clone(),a=Yj(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof qj?function(e,t,n,r){if(!Uj(e.precondition,t))return n;var i=Yj(e.fieldTransforms,r,t),a=t.data;return a.setAll(Wj(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,Uj(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Gj(e,t){var n,r=null,i=cy(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=Pj(a.transform,o||null);null!=s&&(null===r&&(r=VW.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function $j(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&Vq(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof Tj&&r instanceof Tj||n instanceof Aj&&r instanceof Aj?Vq(n.elements,r.elements,SW):n instanceof Mj&&r instanceof Mj?SW(n._t,r._t):n instanceof Oj&&r instanceof Oj);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var Zj=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return hy(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return vy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Vj),qj=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return hy(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return vy(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Vj);function Wj(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function jj(e,t,n){var r=new Map;bq(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,Sj(o,s,n[i]))}return r}function Yj(e,t,n){var r,i=new Map,a=cy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,bj(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Kj,Qj,Xj=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return vy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Vj),Jj=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return vy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Vj),eY=vy(function e(t){hy(this,e),this.count=t});function tY(e){switch(e){default:return Eq();case Pq.CANCELLED:case Pq.UNKNOWN:case Pq.DEADLINE_EXCEEDED:case Pq.RESOURCE_EXHAUSTED:case Pq.INTERNAL:case Pq.UNAVAILABLE:case Pq.UNAUTHENTICATED:return!1;case Pq.INVALID_ARGUMENT:case Pq.NOT_FOUND:case Pq.ALREADY_EXISTS:case Pq.PERMISSION_DENIED:case Pq.FAILED_PRECONDITION:case Pq.ABORTED:case Pq.OUT_OF_RANGE:case Pq.UNIMPLEMENTED:case Pq.DATA_LOSS:return!0}}function nY(e){if(void 0===e)return Cq("GRPC error has no .code"),Pq.UNKNOWN;switch(e){case Kj.OK:return Pq.OK;case Kj.CANCELLED:return Pq.CANCELLED;case Kj.UNKNOWN:return Pq.UNKNOWN;case Kj.DEADLINE_EXCEEDED:return Pq.DEADLINE_EXCEEDED;case Kj.RESOURCE_EXHAUSTED:return Pq.RESOURCE_EXHAUSTED;case Kj.INTERNAL:return Pq.INTERNAL;case Kj.UNAVAILABLE:return Pq.UNAVAILABLE;case Kj.UNAUTHENTICATED:return Pq.UNAUTHENTICATED;case Kj.INVALID_ARGUMENT:return Pq.INVALID_ARGUMENT;case Kj.NOT_FOUND:return Pq.NOT_FOUND;case Kj.ALREADY_EXISTS:return Pq.ALREADY_EXISTS;case Kj.PERMISSION_DENIED:return Pq.PERMISSION_DENIED;case Kj.FAILED_PRECONDITION:return Pq.FAILED_PRECONDITION;case Kj.ABORTED:return Pq.ABORTED;case Kj.OUT_OF_RANGE:return Pq.OUT_OF_RANGE;case Kj.UNIMPLEMENTED:return Pq.UNIMPLEMENTED;case Kj.DATA_LOSS:return Pq.DATA_LOSS;default:return Eq()}}(Qj=Kj||(Kj={}))[Qj.OK=0]="OK",Qj[Qj.CANCELLED=1]="CANCELLED",Qj[Qj.UNKNOWN=2]="UNKNOWN",Qj[Qj.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qj[Qj.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qj[Qj.NOT_FOUND=5]="NOT_FOUND",Qj[Qj.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qj[Qj.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qj[Qj.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qj[Qj.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qj[Qj.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qj[Qj.ABORTED=10]="ABORTED",Qj[Qj.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qj[Qj.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qj[Qj.INTERNAL=13]="INTERNAL",Qj[Qj.UNAVAILABLE=14]="UNAVAILABLE",Qj[Qj.DATA_LOSS=15]="DATA_LOSS";var rY=function(){function e(t,n){hy(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return vy(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=Wg(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){rW(this.inner,function(t,n){var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=Wg(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return iW(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),iY=new aW(qq.comparator);function aY(){return iY}var oY=new aW(qq.comparator);function sY(){for(var e=oY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function uY(e){var t=oY;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function cY(){return fY()}function lY(){return fY()}function fY(){return new rY(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var hY=new aW(qq.comparator),dY=new uW(qq.comparator);function vY(){for(var e=dY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var pY=new uW(Uq);function gY(){return pY}var yY=function(){function e(t,n,r,i,a){hy(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return vy(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,mY.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(zq.min(),r,gY(),aY(),vY())}}]),e}(),mY=function(){function e(t,n,r,i,a){hy(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return vy(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(fW.EMPTY_BYTE_STRING,n,vY(),vY(),vY())}}]),e}(),kY=vy(function e(t,n,r,i){hy(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),CY=vy(function e(t,n){hy(this,e),this.targetId=t,this.It=n}),wY=vy(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fW.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;hy(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),_Y=function(){function e(){hy(this,e),this.Tt=0,this.Et=SY(),this.At=fW.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return vy(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=vY(),t=vY(),n=vY();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Eq()}}),new mY(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=SY()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),EY=function(){function e(t){hy(this,e),this.Mt=t,this.Ft=new Map,this.$t=aY(),this.Bt=bY(),this.Lt=new uW(Uq)}return vy(e,[{key:"Ut",value:function(e){var t,n=cy(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=cy(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:Eq()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(qW(i))if(0===n){var a=new qq(i.path);this.Kt(t,a,zW.newNoDocument(a,zq.min()))}else bq(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&qW(a.target)){var o=new qq(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,zW.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=vY();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new yY(e,n,this.Lt,this.$t,r);return this.$t=aY(),this.Bt=bY(),this.Lt=new uW(Uq),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new _Y,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new uW(Uq),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||kq("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new _Y),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function bY(){return new aW(qq.comparator)}function SY(){return new aW(qq.comparator)}var PY={asc:"ASCENDING",desc:"DESCENDING"},OY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TY=vy(function e(t,n){hy(this,e),this.databaseId=t,this.dt=n});function IY(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function AY(e,t){return e.dt?t.toBase64():t.toUint8Array()}function RY(e,t){return IY(e,t.toTimestamp())}function MY(e){return bq(!!e),zq.fromTimestamp((t=dW(e),new Bq(t.seconds,t.nanos)));var t}function xY(e,t){return(n=e,new Gq(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function NY(e){var t=Gq.fromString(e);return bq(XY(t)),t}function DY(e,t){return xY(e.databaseId,t.path)}function LY(e,t){var n=NY(t);if(n.get(1)!==e.databaseId.projectId)throw new Oq(Pq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Oq(Pq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new qq(VY(n))}function FY(e,t){return xY(e.databaseId,t)}function UY(e){return new Gq(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function VY(e){return bq(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function BY(e,t,n){return{name:DY(e,t),fields:n.value.mapValue.fields}}function zY(e,t){return{documents:[FY(e,t.path)]}}function HY(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=FY(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=FY(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(DW(e.value))return{unaryFilter:{field:WY(e.field),op:"IS_NAN"}};if(NW(e.value))return{unaryFilter:{field:WY(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(DW(e.value))return{unaryFilter:{field:WY(e.field),op:"IS_NOT_NAN"}};if(NW(e.value))return{unaryFilter:{field:WY(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:WY(e.field),op:qY(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:WY((t=e).field),direction:ZY(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||wW(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function GY(e){var t=function(e){var t=NY(e);return 4===t.length?Gq.emptyPath():VY(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){bq(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=$Y(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new rj(jY((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return wW(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new nj((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new nj(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new sj(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function $Y(e){return e?void 0!==e.unaryFilter?[KY(e)]:void 0!==e.fieldFilter?[YY(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return $Y(e)}).reduce(function(e,t){return e.concat(t)}):Eq():[]}function ZY(e){return PY[e]}function qY(e){return OY[e]}function WY(e){return{fieldPath:e.canonicalString()}}function jY(e){return Zq.fromServerFormat(e.fieldPath)}function YY(e){return WW.create(jY(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Eq()}}(e.fieldFilter.op),e.fieldFilter.value)}function KY(e){switch(e.unaryFilter.op){case"IS_NAN":var t=jY(e.unaryFilter.field);return WW.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=jY(e.unaryFilter.field);return WW.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=jY(e.unaryFilter.field);return WW.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=jY(e.unaryFilter.field);return WW.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Eq()}}function QY(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function XY(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var JY=function(){function e(t,n,r,i){hy(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return vy(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&zj(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=cy(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Hj(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=cy(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=Hj(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=lY();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=Bj(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(zq.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},vY())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Vq(this.mutations,e.mutations,function(e,t){return $j(e,t)})&&Vq(this.baseMutations,e.baseMutations,function(e,t){return $j(e,t)})}}]),e}(),eK=function(){function e(t,n,r,i){hy(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return vy(e,null,[{key:"from",value:function(t,n,r){bq(t.mutations.length===r.length);for(var i=hY,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),tK=function(){function e(t,n){hy(this,e),this.largestBatchId=t,this.mutation=n}return vy(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),nK=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:zq.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zq.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fW.EMPTY_BYTE_STRING;hy(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return vy(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),rK=vy(function e(t){hy(this,e),this.ne=t});function iK(e){var t=GY({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?vj(t,t.limit,"L"):t}var aK=function(){function e(){hy(this,e)}return vy(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(vW(e.integerValue));else if("doubleValue"in e){var n=vW(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),_W(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(pW(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?UW(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):Eq()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),qq.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();aK.ye=new aK;var oK=function(){function e(){hy(this,e),this.ze=new sK}return vy(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),Jq.resolve()}},{key:"getCollectionParents",value:function(e,t){return Jq.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Jq.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Jq.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Jq.resolve(null)}},{key:"getIndexType",value:function(e,t){return Jq.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Jq.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Jq.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Jq.resolve(jq.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Jq.resolve(jq.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Jq.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Jq.resolve()}}]),e}(),sK=function(){function e(){hy(this,e),this.index={}}return vy(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new uW(Gq.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new uW(Gq.comparator)).toArray()}}]),e}();new Uint8Array(0);var uK=function(){function e(t,n,r){hy(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return vy(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();uK.DEFAULT_COLLECTION_PERCENTILE=10,uK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uK.DEFAULT=new uK(41943040,uK.DEFAULT_COLLECTION_PERCENTILE,uK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uK.DISABLED=new uK(-1,0,0);var cK=function(){function e(t){hy(this,e),this.En=t}return vy(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),lK=vy(function e(t,n){hy(this,e),this.overlayedDocument=t,this.mutatedFields=n}),fK=function(){function e(t,n,r,i){hy(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return vy(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&Hj(r.mutation,e,lW.empty(),Bq.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,vY()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vY(),i=cY();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=sY();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=cY();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,vY())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=aY(),a=fY(),o=fY();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof qj)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),Hj(o.mutation,t,o.mutation.getFieldMask(),Bq.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new lK(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=fY(),i=new aW(function(e,t){return e-t}),a=vY();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=cy(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||lW.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||vY()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=lY();c.forEach(function(e){if(!a.has(e)){var n=Bj(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return Jq.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return qq.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):fj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Jq.resolve(cY()),s=-1,u=a;return o.next(function(t){return Jq.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Jq.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,vY())}).next(function(e){return{batchId:s,changes:uY(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new qq(t)).next(function(e){var t=sY();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=sY();return this.indexManager.getCollectionParents(e,i).next(function(o){return Jq.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new sj(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,zW.newInvalidDocument(n)))});var n=sY();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&Hj(a.mutation,i,lW.empty(),Bq.now()),mj(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Jq.resolve(zW.newInvalidDocument(t))}}]),e}(),hK=function(){function e(t){hy(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return vy(e,[{key:"getBundleMetadata",value:function(e,t){return Jq.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:MY(n.createTime)}),Jq.resolve()}},{key:"getNamedQuery",value:function(e,t){return Jq.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:iK(n.bundledQuery),readTime:MY(n.readTime)}),Jq.resolve();var n}}]),e}(),dK=function(){function e(){hy(this,e),this.overlays=new aW(qq.comparator),this.Xn=new Map}return vy(e,[{key:"getOverlay",value:function(e,t){return Jq.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=cY();return Jq.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),Jq.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),Jq.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=cY(),i=t.length+1,a=new qq(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Jq.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new aW(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=cY(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=cY(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return Jq.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new tK(t,n));var a=this.Xn.get(t);void 0===a&&(a=vY(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),vK=function(){function e(){hy(this,e),this.Zn=new uW(pK.ts),this.es=new uW(pK.ns)}return vy(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new pK(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new pK(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new qq(new Gq([])),r=new pK(n,e),i=new pK(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new qq(new Gq([])),n=new pK(t,e),r=new pK(t,e+1),i=vY();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new pK(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),pK=function(){function e(t,n){hy(this,e),this.key=t,this.ls=n}return vy(e,null,[{key:"ts",value:function(e,t){return qq.comparator(e.key,t.key)||Uq(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Uq(e.ls,t.ls)||qq.comparator(e.key,t.key)}}]),e}(),gK=function(){function e(t,n){hy(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new uW(pK.ts)}return vy(e,[{key:"checkEmpty",value:function(e){return Jq.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new JY(i,t,n,r);this.mutationQueue.push(a);var o,s=cy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new pK(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return Jq.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Jq.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return Jq.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Jq.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return Jq.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new pK(t,0),i=new pK(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),Jq.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new uW(Uq);return t.forEach(function(e){var t=new pK(e,0),i=new pK(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),Jq.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;qq.isDocumentKey(i)||(i=i.child(""));var a=new pK(new qq(i),0),o=new uW(Uq);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),Jq.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;bq(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return Jq.forEach(t.mutations,function(i){var a=new pK(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new pK(t,0),r=this.ds.firstAfterOrEqual(n);return Jq.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return Jq.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),yK=function(){function e(t){hy(this,e),this.ps=t,this.docs=new aW(qq.comparator),this.size=0}return vy(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Jq.resolve(n?n.document.mutableCopy():zW.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=aY();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():zW.newInvalidDocument(e))}),Jq.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=aY(),i=new qq(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||Yq(Wq(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return Jq.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Eq()}},{key:"Is",value:function(e,t){return Jq.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new mK(this)}},{key:"getSize",value:function(e){return Jq.resolve(this.size)}}]),e}(),mK=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).zn=e,r}return vy(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),Jq.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){hy(this,e),this.changes=new rY(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return vy(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,zW.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Jq.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),kK=function(){function e(t){hy(this,e),this.persistence=t,this.Ts=new rY(function(e){return $W(e)},ZW),this.lastRemoteSnapshotVersion=zq.min(),this.highestTargetId=0,this.Es=0,this.As=new vK,this.targetCount=0,this.Rs=cK.An()}return vy(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),Jq.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Jq.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Jq.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),Jq.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),Jq.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new cK(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,Jq.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),Jq.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,Jq.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),Jq.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return Jq.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return Jq.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),Jq.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Jq.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),Jq.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return Jq.resolve(n)}},{key:"containsKey",value:function(e,t){return Jq.resolve(this.As.containsKey(t))}}]),e}(),CK=function(){function e(t,n){var r=this;hy(this,e),this.bs={},this.overlays={},this.Ps=new tW(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new kK(this),this.indexManager=new oK,this.remoteDocumentCache=new yK(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new rK(n),this.Ds=new hK(this.wt)}return vy(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new dK,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new gK(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;kq("MemoryPersistence","Starting transaction:",e);var i=new wK(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return Jq.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),wK=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return vy(n)}(function(){function e(){hy(this,e),this.onCommittedListeners=[]}return vy(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),_K=function(){function e(t){hy(this,e),this.persistence=t,this.ks=new vK,this.Os=null}return vy(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw Eq()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),Jq.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),Jq.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),Jq.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Jq.forEach(this.Fs,function(r){var i=qq.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,zq.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return Jq.or([function(){return Jq.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),EK=function(){function e(t,n,r,i){hy(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return vy(e,null,[{key:"Vi",value:function(t,n){var r,i=vY(),a=vY(),o=cy(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),bK=function(){function e(){hy(this,e),this.Si=!1}return vy(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return Jq.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(zq.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(mq()<=vz.DEBUG&&kq("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),yj(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=zq.fromTimestamp(1e9===r?new Bq(n+1,0):new Bq(n,r));return new jq(i,qq.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new uW(kj(e));return t.forEach(function(t,r){mj(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return mq()<=vz.DEBUG&&kq("QueryEngine","Using full collection scan to execute query:",yj(t)),this.Di.getDocumentsMatchingQuery(e,t,jq.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),SK=function(){function e(t,n,r,i){hy(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new aW(Uq),this.Bi=new rY(function(e){return $W(e)},ZW),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return vy(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fK(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function PK(e,t){return OK.apply(this,arguments)}function OK(){return OK=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sq(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=vY(),u=cy(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=cy(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=cy(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=cy(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),OK.apply(this,arguments)}function TK(e,t){var n=Sq(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=Jq.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);bq(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=vY(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function IK(e){var t=Sq(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function AK(e,t){var n=Sq(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken(fW.EMPTY_BYTE_STRING,zq.min()).withLastLimboFreeSnapshotVersion(zq.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=aY(),u=vY();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=vY(),i=vY();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=aY();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(zq.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):kq("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(zq.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return Jq.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function RK(e,t){var n=Sq(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function MK(e,t){var n=Sq(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,Jq.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new nK(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function xK(e,t,n){return NK.apply(this,arguments)}function NK(){return NK=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Sq(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),eW(e.t1)){e.next=12;break}throw e.t1;case 12:kq("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),NK.apply(this,arguments)}function DK(e,t,n){var r=Sq(e),i=zq.min(),a=vY();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=dj(t),c=Sq(o),l=c.Bi.get(u),void 0!==l?Jq.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:zq.min(),n?a:vY())}).next(function(e){return function(e,t,n){var r=zq.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var LK=function(){function e(){hy(this,e),this.activeTargetIds=gY()}return vy(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),FK=function(){function e(){hy(this,e),this.Fr=new LK,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return vy(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new LK,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),UK=function(){function e(){hy(this,e)}return vy(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),VK=function(){function e(){var t=this;hy(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return vy(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){kq("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=cy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){kq("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=cy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),BK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zK=function(){function e(t){hy(this,e),this.jr=t.jr,this.Wr=t.Wr}return vy(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),HK=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return vy(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new dq;o.listenOnce(uq.COMPLETE,function(){try{switch(o.getLastErrorCode()){case sq.NO_ERROR:var t=o.getResponseJson();kq("Connection","XHR received:",JSON.stringify(t)),i(t);break;case sq.TIMEOUT:kq("Connection",'RPC "'+e+'" timed out'),a(new Oq(Pq.DEADLINE_EXCEEDED,"Request time out"));break;case sq.HTTP_ERROR:var n=o.getStatus();if(kq("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(Pq).indexOf(c)>=0?c:Pq.UNKNOWN);a(new Oq(s,r.message))}else a(new Oq(Pq.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Oq(Pq.UNAVAILABLE,"Connection failed."));break;default:Eq()}}finally{kq("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=aq(),a=oq(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new fq({})),this.uo(o.initMessageHeaders,t,n),HB()||$B()||zB().indexOf("Electron/")>=0||ZB()||zB().indexOf("MSAppHost/")>=0||GB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");kq("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new zK({jr:function(e){l?kq("Connection","Not sending because WebChannel is closed:",e):(c||(kq("Connection","Opening WebChannel transport."),u.open(),c=!0),kq("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,hq.EventType.OPEN,function(){l||kq("Connection","WebChannel transport opened.")}),h(u,hq.EventType.CLOSE,function(){l||(l=!0,kq("Connection","WebChannel transport closed"),f.eo())}),h(u,hq.EventType.ERROR,function(e){l||(l=!0,wq("Connection","WebChannel transport errored:",e),f.eo(new Oq(Pq.UNAVAILABLE,"The operation could not be completed")))}),h(u,hq.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];bq(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){kq("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Kj[e];if(void 0!==t)return nY(t)}(a),s=i.message;void 0===o&&(o=Pq.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new Oq(o,s)),u.close()}else kq("Connection","WebChannel received:",n),f.no(n)}}),h(a,cq.STAT_EVENT,function(e){e.stat===lq.PROXY?kq("Connection","Detected buffering proxy"):e.stat===lq.NOPROXY&&kq("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){hy(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return vy(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);kq("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return kq("RestConnection","Received: ",e),e},function(t){throw wq("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+gq,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(BK[e])}}]),e}());function GK(){return"undefined"!=typeof document?document:null}function $K(e){return new TY(e,!0)}var ZK=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;hy(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return vy(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&kq("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),qK=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new ZK(t,n)}return vy(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===Pq.RESOURCE_EXHAUSTED?(Cq(t.toString()),Cq("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===Pq.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Wg(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new Oq(Pq.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return kq("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(kq("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),WK=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return vy(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Eq(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(bq(void 0===t||"string"==typeof t),fW.fromBase64String(t||"")):(bq(void 0===t||t instanceof Uint8Array),fW.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?Pq.UNKNOWN:nY(e.code);return new Oq(t,e.message||"")}(s);n=new wY(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=LY(e,c.document.name),f=MY(c.document.updateTime),h=new VW({mapValue:{fields:c.document.fields}}),d=zW.newFoundDocument(l,f,h);n=new kY(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=LY(e,v.document),g=v.readTime?MY(v.readTime):zq.min(),y=zW.newNoDocument(p,g);n=new kY([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=LY(e,m.document);n=new kY([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return Eq();var C=t.filter,w=new eY(C.count||0);n=new CY(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return zq.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?zq.min():t.readTime?MY(t.readTime):zq.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=UY(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=qW(i)?{documents:zY(t,i)}:{query:HY(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=AY(t,n.resumeToken):n.snapshotVersion.compareTo(zq.min())>0&&(r.readTime=IY(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Eq()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=UY(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(qK),jK=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return vy(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Xg(oy(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(bq(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(bq(void 0!==t),e.map(function(e){return function(e,t){var n=MY(e.updateTime?e.updateTime:t);return n.isEqual(zq.min())&&(n=MY(t)),new Lj(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=MY(e.commitTime);return this.listener.Jo(n,t)}return bq(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=UY(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof Zj)n={update:BY(e,t.key,t.value)};else if(t instanceof Xj)n={delete:DY(e,t.key)};else if(t instanceof qj)n={update:BY(e,t.key,t.data),updateMask:QY(t.fieldMask)};else{if(!(t instanceof Jj))return Eq();n={verify:DY(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Oj)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Tj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Aj)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Mj)return{fieldPath:t.field.canonicalString(),increment:n._t};throw Eq()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:RY(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Eq()),n}(t.wt,e)})};this.Mo(n)}}]),n}(qK),YK=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return vy(n,[{key:"tu",value:function(){if(this.Zo)throw new Oq(Pq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Wg(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Pq.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Oq(Pq.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=Wg(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Pq.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Oq(Pq.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return vy(function e(){hy(this,e)})}()),KK=function(){function e(t,n){hy(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return vy(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(Cq(t),this.su=!1):kq("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),QK=vy(function e(t,n,r,i,a){hy(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(PB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=uQ(o),!e.t0){e.next=5;break}return kq("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Sq(t)).lu.add(4),e.next=4,eQ(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,XK(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new KK(r,i)});function XK(e){return JK.apply(this,arguments)}function JK(){return JK=PB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!uQ(t)){e.next=18;break}n=cy(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),JK.apply(this,arguments)}function eQ(e){return tQ.apply(this,arguments)}function tQ(){return tQ=PB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=cy(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),tQ.apply(this,arguments)}function nQ(e,t){var n=Sq(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),sQ(n)?oQ(n):LQ(n).Co()&&iQ(n,t))}function rQ(e,t){var n=Sq(e),r=LQ(n);n.hu.delete(t),r.Co()&&aQ(n,t),0===n.hu.size&&(r.Co()?r.ko():uQ(n)&&n._u.set("Unknown"))}function iQ(e,t){e.wu.Nt(t.targetId),LQ(e).Qo(t)}function aQ(e,t){e.wu.Nt(t),LQ(e).jo(t)}function oQ(e){e.wu=new EY({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),LQ(e).start(),e._u.iu()}function sQ(e){return uQ(e)&&!LQ(e).Do()&&e.hu.size>0}function uQ(e){return 0===Sq(e).lu.size}function cQ(e){e.wu=void 0}function lQ(e){return fQ.apply(this,arguments)}function fQ(){return fQ=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){iQ(t,e)});case 1:case"end":return e.stop()}},e)})),fQ.apply(this,arguments)}function hQ(e,t){return dQ.apply(this,arguments)}function dQ(){return dQ=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:cQ(t),sQ(t)?(t._u.uu(n),oQ(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),dQ.apply(this,arguments)}function vQ(e,t,n){return pQ.apply(this,arguments)}function pQ(){return pQ=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof wY&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=cy(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),kq("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,gQ(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof kY?t.wu.Ut(n):n instanceof CY?t.wu.zt(n):t.wu.Gt(n),r.isEqual(zq.min())){e.next=29;break}return e.prev=14,e.next=17,IK(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(fW.EMPTY_BYTE_STRING,n.snapshotVersion)),aQ(e,t);var r=new nK(n.target,t,1,n.sequenceNumber);iQ(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),kq("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,gQ(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),pQ.apply(this,arguments)}function gQ(e,t,n){return yQ.apply(this,arguments)}function yQ(){return yQ=PB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(eW(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,eQ(t);case 5:t._u.set("Offline"),r||(r=function(){return IK(t.localStore)}),t.asyncQueue.enqueueRetryable(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return kq("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,XK(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),yQ.apply(this,arguments)}function mQ(e,t){return t().catch(function(n){return gQ(e,n,t)})}function kQ(e){return CQ.apply(this,arguments)}function CQ(){return CQ=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Sq(t),r=FQ(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!wQ(n)){e.next=19;break}return e.prev=3,e.next=6,RK(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,_Q(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,gQ(n,e.t0);case 17:e.next=2;break;case 19:EQ(n)&&bQ(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),CQ.apply(this,arguments)}function wQ(e){return uQ(e)&&e.au.length<10}function _Q(e,t){e.au.push(t);var n=FQ(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function EQ(e){return uQ(e)&&!FQ(e).Do()&&e.au.length>0}function bQ(e){FQ(e).start()}function SQ(e){return PQ.apply(this,arguments)}function PQ(){return PQ=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:FQ(t).Xo();case 1:case"end":return e.stop()}},e)})),PQ.apply(this,arguments)}function OQ(e){return TQ.apply(this,arguments)}function TQ(){return TQ=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=FQ(t),r=cy(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),TQ.apply(this,arguments)}function IQ(e,t,n){return AQ.apply(this,arguments)}function AQ(){return AQ=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=eK.from(i,n,r),e.next=3,mQ(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,kQ(t);case 5:case"end":return e.stop()}},e)})),AQ.apply(this,arguments)}function RQ(e,t){return MQ.apply(this,arguments)}function MQ(){return MQ=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&FQ(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!tY(i=n.code)||i===Pq.ABORTED){e.next=7;break}return r=t.au.shift(),FQ(t).No(),e.next=5,mQ(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,kQ(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:EQ(t)&&bQ(t);case 5:case"end":return e.stop()}},e)})),MQ.apply(this,arguments)}function xQ(e,t){return NQ.apply(this,arguments)}function NQ(){return NQ=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Sq(t)).asyncQueue.verifyOperationInProgress(),kq("RemoteStore","RemoteStore received new credentials"),i=uQ(r),r.lu.add(3),e.next=6,eQ(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,XK(r);case 12:case"end":return e.stop()}},e)})),NQ.apply(this,arguments)}function DQ(){return DQ=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sq(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,XK(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,eQ(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),DQ.apply(this,arguments)}function LQ(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:lQ.bind(null,e),Jr:hQ.bind(null,e),Go:vQ.bind(null,e)},(i=Sq(t)).tu(),new WK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=PB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),sQ(e)?oQ(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:cQ(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function FQ(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:SQ.bind(null,e),Jr:RQ.bind(null,e),Yo:OQ.bind(null,e),Jo:IQ.bind(null,e)},(i=Sq(t)).tu(),new jK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=PB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,kQ(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(kq("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var UQ=function(){function e(t,n,r,i,a){hy(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Tq,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return vy(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Oq(Pq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function VQ(e,t){if(Cq("AsyncQueue","".concat(t,": ").concat(e)),eW(e))return new Oq(Pq.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var BQ=function(){function e(t){hy(this,e),this.comparator=t?function(e,n){return t(e,n)||qq.comparator(e.key,n.key)}:function(e,t){return qq.comparator(e.key,t.key)},this.keyedMap=sY(),this.sortedSet=new aW(this.comparator)}return vy(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),zQ=function(){function e(){hy(this,e),this.yu=new aW(qq.comparator)}return vy(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):Eq():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),HQ=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return vy(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,BQ.emptySet(n),a,r,i,!0,!1)}}]),e}(),GQ=vy(function e(){hy(this,e),this.Iu=void 0,this.listeners=[]}),$Q=vy(function e(){hy(this,e),this.queries=new rY(function(e){return gj(e)},pj),this.onlineState="Unknown",this.Tu=new Set});function ZQ(e,t){return qQ.apply(this,arguments)}function qQ(){return qQ=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sq(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new GQ),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=VQ(e.t0,"Initialization of query '".concat(yj(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&QQ(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),qQ.apply(this,arguments)}function WQ(e,t){return jQ.apply(this,arguments)}function jQ(){return jQ=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sq(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),jQ.apply(this,arguments)}function YQ(e,t){var n,r=Sq(e),i=!1,a=cy(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=cy(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&QQ(r)}function KQ(e,t,n){var r=Sq(e),i=r.queries.get(t);if(i){var a,o=cy(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function QQ(e){e.Tu.forEach(function(e){e.next()})}var XQ=function(){function e(t,n,r){hy(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return vy(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=cy(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new HQ(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=HQ.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),JQ=vy(function e(t){hy(this,e),this.key=t}),eX=vy(function e(t){hy(this,e),this.key=t}),tX=function(){function e(t,n){hy(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=vY(),this.mutatedKeys=vY(),this.Lu=kj(t),this.Uu=new BQ(this.Lu)}return vy(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new zQ,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=mj(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Eq()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new HQ(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new zQ,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=vY(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new eX(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new JQ(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=vY();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return HQ.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),nX=vy(function e(t,n,r){hy(this,e),this.query=t,this.targetId=n,this.view=r}),rX=vy(function e(t){hy(this,e),this.key=t,this.Xu=!1}),iX=function(){function e(t,n,r,i,a,o){hy(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new rY(function(e){return gj(e)},pj),this.ec=new Map,this.nc=new Set,this.sc=new aW(qq.comparator),this.ic=new Map,this.rc=new vK,this.oc={},this.uc=new Map,this.cc=cK.Rn(),this.onlineState="Unknown",this.ac=void 0}return vy(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function aX(e,t){return oX.apply(this,arguments)}function oX(){return oX=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=xX(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,MK(r.localStore,dj(n));case 8:return s=e.sent,r.isPrimaryClient&&nQ(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,sX(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),oX.apply(this,arguments)}function sX(e,t,n,r){return uX.apply(this,arguments)}function uX(){return uX=PB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=PB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,DK(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(SX(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,DK(t.localStore,n,!0);case 3:return a=e.sent,o=new tX(n,a.ji),s=o.Ku(a.documents),u=mY.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),SX(t,r,c.zu),l=new nX(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),uX.apply(this,arguments)}function cX(e,t){return lX.apply(this,arguments)}function lX(){return lX=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sq(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!pj(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,xK(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),rQ(r.remoteStore,i.targetId),EX(r,i.targetId)}).catch(Qq);case 9:e.next=14;break;case 11:return EX(r,i.targetId),e.next=14,xK(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),lX.apply(this,arguments)}function fX(){return fX=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=NX(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Sq(e),a=Bq.now(),o=t.reduce(function(e,t){return e.add(t.key)},vY());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=aY(),u=vY();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=cy(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Gj(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new qj(c.key,l,BW(l.value.mapValue),Fj.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:uY(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new aW(Uq)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,TX(i,a.changes);case 9:return e.next=11,kQ(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=VQ(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])})),fX.apply(this,arguments)}function hX(e,t){return dX.apply(this,arguments)}function dX(){return dX=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sq(t),e.prev=1,e.next=4,AK(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(bq(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?bq(n.Xu):e.removedDocuments.size>0&&(bq(n.Xu),n.Xu=!1))}),e.next=8,TX(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Qq(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),dX.apply(this,arguments)}function vX(e,t,n){var r=Sq(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=Sq(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=cy(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&QQ(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function pX(e,t,n){return gX.apply(this,arguments)}function gX(){return gX=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Sq(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new aW(qq.comparator)).insert(o,zW.newNoDocument(o,zq.min())),u=vY().add(o),c=new yY(zq.min(),new Map,new uW(Uq),s,u),e.next=9,hX(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),OX(i),e.next=16;break;case 14:return e.next=16,xK(i.localStore,n,!1).then(function(){return EX(i,n,r)}).catch(Qq);case 16:case"end":return e.stop()}},e)})),gX.apply(this,arguments)}function yX(e,t){return mX.apply(this,arguments)}function mX(){return mX=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sq(t),i=n.batch.batchId,e.prev=1,e.next=4,TK(r.localStore,n);case 4:return a=e.sent,_X(r,i,null),wX(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,TX(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Qq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),mX.apply(this,arguments)}function kX(e,t,n){return CX.apply(this,arguments)}function CX(){return CX=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Sq(t),e.prev=1,e.next=4,function(e,t){var n=Sq(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return bq(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,_X(i,n,r),wX(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,TX(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Qq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),CX.apply(this,arguments)}function wX(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function _X(e,t,n){var r=Sq(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function EX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=cy(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||bX(e,t)})}function bX(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(rQ(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),OX(e))}function SX(e,t,n){var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof JQ?(e.rc.addReference(a.key,t),PX(e,a)):a instanceof eX?(kq("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||bX(e,a.key)):Eq()}}catch(o){i.e(o)}finally{i.f()}}function PX(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(kq("SyncEngine","New document in limbo: "+n),e.nc.add(r),OX(e))}function OX(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new qq(Gq.fromString(t)),r=e.cc.next();e.ic.set(r,new rX(n)),e.sc=e.sc.insert(n,r),nQ(e.remoteStore,new nK(dj(uj(n.path)),r,2,tW.ot))}}function TX(e,t,n){return IX.apply(this,arguments)}function IX(){return IX=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Sq(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=EK.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sq(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Jq.forEach(n,function(t){return Jq.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return Jq.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),eW(e.t0)){e.next=10;break}throw e.t0;case 10:kq("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=cy(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),IX.apply(this,arguments)}function AX(e,t){return RX.apply(this,arguments)}function RX(){return RX=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Sq(t)).currentUser.isEqual(n)){e.next=12;break}return kq("SyncEngine","User change. New user:",n.toKey()),e.next=5,PK(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new Oq(Pq.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,TX(r,i.Ki);case 12:case"end":return e.stop()}},e)})),RX.apply(this,arguments)}function MX(e,t){var n=Sq(e),r=n.ic.get(t);if(r&&r.Xu)return vY().add(r.key);var i=vY(),a=n.ec.get(t);if(!a)return i;var o,s=cy(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function xX(e){var t=Sq(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=hX.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=MX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=pX.bind(null,t),t.Zu.Go=YQ.bind(null,t.eventManager),t.Zu.lc=KQ.bind(null,t.eventManager),t}function NX(e){var t=Sq(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=yX.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=kX.bind(null,t),t}var DX=function(){function e(){hy(this,e),this.synchronizeTabs=!1}return vy(e,[{key:"initialize",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=$K(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new SK(e,t,n,r)}(this.persistence,new bK,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new CK(_K.Ms,this.wt)}},{key:"dc",value:function(e){return new FK}},{key:"terminate",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),LX=function(){function e(){hy(this,e)}return vy(e,[{key:"initialize",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return vX(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=AX.bind(null,n.syncEngine),r.next=12,function(e,t){return DQ.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new $Q}},{key:"createDatastore",value:function(e){var t=$K(e.databaseInfo.databaseId),n=new HK(e.databaseInfo);return new YK(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return vX(o.syncEngine,e,0)},a=VK.V()?new VK:new UK,new QK(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new iX(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Sq(t),kq("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,eQ(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),FX=function(){function e(t){hy(this,e),this.observer=t,this.muted=!1}return vy(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),UX=function(){function e(t,n,r,i){var a=this;hy(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=pq.UNAUTHENTICATED,this.clientId=Fq.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return kq("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return kq("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return vy(e,[{key:"getConfiguration",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Oq(Pq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Tq;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=VQ(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function VX(e,t){return BX.apply(this,arguments)}function BX(){return BX=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),kq("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,PK(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),BX.apply(this,arguments)}function zX(e,t){return HX.apply(this,arguments)}function HX(){return HX=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,GX(t);case 3:return r=e.sent,kq("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return xQ(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return xQ(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),HX.apply(this,arguments)}function GX(e){return $X.apply(this,arguments)}function $X(){return $X=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return kq("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,VX(t,new DX);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),$X.apply(this,arguments)}function ZX(e){return qX.apply(this,arguments)}function qX(){return qX=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return kq("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,zX(t,new LX);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),qX.apply(this,arguments)}function WX(e){return jX.apply(this,arguments)}function jX(){return jX=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ZX(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=aX.bind(null,n.syncEngine),r.onUnlisten=cX.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),jX.apply(this,arguments)}var YX=new Map;function KX(e,t,n){if(!n)throw new Oq(Pq.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function QX(e){if(!qq.isDocumentKey(e))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function XX(e){if(qq.isDocumentKey(e))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function JX(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":Eq()}function eJ(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Oq(Pq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=JX(e);throw new Oq(Pq.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var tJ=function(){function e(t){var n;if(hy(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Oq(Pq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Oq(Pq.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Oq(Pq.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return vy(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),nJ=function(){function e(t,n,r){hy(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tJ({}),this._settingsFrozen=!1,t instanceof CW?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Oq(Pq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new CW(e.options.projectId)}(t))}return vy(e,[{key:"app",get:function(){if(!this._app)throw new Oq(Pq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Oq(Pq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tJ(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Aq;switch(e.type){case"gapi":var t=e.client;return bq(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new xq(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Oq(Pq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=YX.get(e))&&(kq("ComponentProvider","Removing Datastore"),YX.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),rJ=function(){function e(t,n,r){hy(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return vy(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new aJ(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),iJ=function(){function e(t,n,r){hy(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return vy(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),aJ=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r,uj(i)))._path=i,a.type="collection",a}return vy(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new rJ(this.firestore,null,new qq(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(iJ);function oJ(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=oz(e),1===arguments.length&&(t=Fq.I()),KX("doc","path",t),e instanceof nJ){var a=Gq.fromString.apply(Gq,[t].concat(r));return QX(a),new rJ(e,null,new qq(a))}if(!(e instanceof rJ||e instanceof aJ))throw new Oq(Pq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Gq.fromString.apply(Gq,[t].concat(r)));return QX(o),new rJ(e.firestore,e instanceof aJ?e.converter:null,new qq(o))}var sJ=function(){function e(){var t=this;hy(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new ZK(this,"async_queue_retry"),this.Kc=function(){var e=GK();e&&kq("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=GK();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return vy(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=GK();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new Tq;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),eW(t.t0)){t.next=12;break}throw t.t0;case 12:kq("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,Cq("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=UQ.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&Eq()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=cy(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=cy(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function uJ(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var cJ=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new sJ,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return vy(n,[{key:"_terminate",value:function(){return this._firestoreClient||fJ(this),this._firestoreClient.terminate()}}]),n}(nJ);function lJ(e){return e._firestoreClient||fJ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function fJ(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new kW(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new UX(e._authCredentials,e._appCheckCredentials,e._queue,a)}var hJ=function(){function e(){hy(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zq(n)}return vy(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),dJ=function(){function e(t){hy(this,e),this._byteString=t}return vy(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(fW.fromBase64String(t))}catch(n){throw new Oq(Pq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(fW.fromUint8Array(t))}}]),e}(),vJ=vy(function e(t){hy(this,e),this._methodName=t}),pJ=function(){function e(t,n){if(hy(this,e),!isFinite(t)||t<-90||t>90)throw new Oq(Pq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Oq(Pq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return vy(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Uq(this._lat,e._lat)||Uq(this._long,e._long)}}]),e}(),gJ=/^__.*__$/,yJ=function(){function e(t,n,r){hy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return vy(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new qj(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zj(e,this.data,t,this.fieldTransforms)}}]),e}(),mJ=function(){function e(t,n,r){hy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return vy(e,[{key:"toMutation",value:function(e,t){return new qj(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function kJ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Eq()}}var CJ=function(){function e(t,n,r,i,a,o){hy(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return vy(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return xJ(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(kJ(this.Zc)&&gJ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),wJ=function(){function e(t,n,r){hy(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||$K(t)}return vy(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new CJ({Zc:e,methodName:t,ca:n,path:Zq.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function _J(e){var t=e._freezeSettings(),n=$K(e._databaseId);return new wJ(e._databaseId,!!t.ignoreUndefinedProperties,n)}function EJ(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);IJ("Data must be an object, but it was:",o,r);var s,u,c=OJ(r,o);if(a.merge)s=new lW(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=cy(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=AJ(t,d,n);if(!o.contains(v))throw new Oq(Pq.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));NJ(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new lW(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new yJ(new VW(c),s,u)}var bJ=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(vJ),SJ=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"_toFieldTransform",value:function(e){return new Dj(e.path,new Oj)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(vJ);function PJ(e,t){if(TJ(e=oz(e)))return IJ("Unsupported field value:",t,e),OJ(e,t);if(e instanceof vJ)return function(e,t){if(!kJ(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=cy(e);try{for(a.s();!(n=a.n()).done;){var o=PJ(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=oz(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!_W(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?_j(t):wj(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Bq.fromDate(e);return{timestampValue:IY(t.wt,n)}}if(e instanceof Bq){var r=new Bq(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:IY(t.wt,r)}}if(e instanceof pJ)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof dJ)return{bytesValue:AY(t.wt,e._byteString)};if(e instanceof rJ){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:xY(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(JX(e)))}(e,t)}function OJ(e,t){var n={};return iW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):rW(e,function(e,r){var i=PJ(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function TJ(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Bq||e instanceof pJ||e instanceof dJ||e instanceof rJ||e instanceof vJ)}function IJ(e,t,n){if(!TJ(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=JX(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function AJ(e,t,n){if((t=oz(t))instanceof hJ)return t._internalPath;if("string"==typeof t)return MJ(e,t);throw xJ("Field path arguments must be of type string or ",e,!1,void 0,n)}var RJ=new RegExp("[~\\*/\\[\\]]");function MJ(e,t,n){if(t.search(RJ)>=0)throw xJ("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Qg(hJ,sy(t.split(".")))._internalPath}catch(r){throw xJ("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function xJ(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new Oq(Pq.INVALID_ARGUMENT,s+e+u)}function NJ(e,t){return e.some(function(e){return e.isEqual(t)})}var DJ=function(){function e(t,n,r,i,a){hy(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return vy(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new rJ(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new LJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(FJ("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),LJ=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"data",value:function(){return Xg(oy(n.prototype),"data",this).call(this)}}]),n}(DJ);function FJ(e,t){return"string"==typeof t?MJ(e,t):t instanceof hJ?t._internalPath:t._delegate._internalPath}var UJ=function(){function e(t,n){hy(this,e),this.hasPendingWrites=t,this.fromCache=n}return vy(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),VJ=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return vy(n,[{key:"exists",value:function(){return Xg(oy(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new BJ(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(FJ("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(DJ),BJ=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xg(oy(n.prototype),"data",this).call(this,e)}}]),n}(VJ),zJ=function(){function e(t,n,r,i){hy(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new UJ(i.hasPendingWrites,i.fromCache),this.query=r}return vy(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new BJ(n._firestore,n._userDataWriter,r.key,r,new UJ(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oq(Pq.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new BJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new UJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new BJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new UJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:HJ(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function HJ(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Eq()}}function GJ(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Oq(Pq.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var $J=vy(function e(){hy(this,e)});var ZJ=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return vy(n,[{key:"_apply",value:function(e){var t,n,r,i=_J(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){YJ(o,a);var u,c=[],l=cy(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(jJ(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=jJ(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||YJ(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return PJ(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=WW.create(i,a,s);return function(e,t){if(t.ht()){var n=lj(e);if(null!==n&&!n.isEqual(t.field))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=cj(e);null!==r&&KJ(0,t.field,r)}var i=function(e,t){var n,r=cy(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new Oq(Pq.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new iJ(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new sj(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}($J);var qJ=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return vy(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new rj(t,n);return function(e,t){if(null===cj(e)){var n=lj(e);null!==n&&KJ(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new iJ(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new sj(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}($J);var WJ=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return vy(n,[{key:"_apply",value:function(e){return new iJ(e.firestore,e.converter,vj(e._query,this.ma,this.ga))}}]),n}($J);function jJ(e,t,n){if("string"==typeof(n=oz(n))){if(""===n)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fj(t)&&-1!==n.indexOf("/"))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(Gq.fromString(n));if(!qq.isDocumentKey(r))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return RW(e,new qq(r))}if(n instanceof rJ)return RW(e,n._key);throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(JX(n),"."))}function YJ(e,t){if(!Array.isArray(e)||0===e.length)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Oq(Pq.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function KJ(e,t,n){if(!n.isEqual(t))throw new Oq(Pq.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function QJ(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var XJ=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).firestore=e,r}return vy(n,[{key:"convertBytes",value:function(e){return new dJ(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new rJ(this.firestore,null,t)}}]),n}(function(){function e(){hy(this,e)}return vy(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(bW(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vW(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pW(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Eq()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return rW(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new pJ(vW(e.latitude),vW(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=yW(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(mW(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=dW(e);return new Bq(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Gq.fromString(e);bq(XY(n));var r=new CW(n.get(1),n.get(3)),i=new qq(n.popFirst(5));return r.isEqual(t)||Cq("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function JJ(e,t){return n=lJ(e),r=t,i=new Tq,n.asyncQueue.enqueueAndForget(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return fX.apply(this,arguments)},e.next=3,function(e){return ZX(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function e1(e,t,n){var r=n.docs.get(t._key),i=new XJ(e);return new VJ(e,i,t._key,r,new UJ(n.hasPendingWrites,n.fromCache),t.converter)}function t1(){return new SJ("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];gq="9.9.0",Gz(new cz("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new cJ(i,new Rq(e.getProvider("auth-internal")),new Dq(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),Kz(vq,"3.4.12",e),Kz(vq,"3.4.12","esm2017")}(),Kz("firebase","9.9.0","app");var n1="@firebase/installations",r1="0.5.12",i1="w:".concat(r1),a1="FIS_v2",o1=new KB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function s1(e){return e instanceof YB&&e.code.includes("request-failed")}function u1(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function c1(e){return{token:e.token,requestStatus:2,expiresIn:g1(e.expiresIn),creationTime:Date.now()}}function l1(e,t){return f1.apply(this,arguments)}function f1(){return f1=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",o1.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),f1.apply(this,arguments)}function h1(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function d1(e,t){var n=t.refreshToken,r=h1(e);return r.append("Authorization",function(e){return"".concat(a1," ").concat(e)}(n)),r}function v1(e){return p1.apply(this,arguments)}function p1(){return p1=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),p1.apply(this,arguments)}function g1(e){return Number(e.replace("s","000"))}function y1(e,t){return m1.apply(this,arguments)}function m1(){return m1=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=u1(r),s=h1(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:a1,appId:r.appId,sdkVersion:i1})},e.next=11,v1(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:c1(h.authToken)});case 17:return e.next=19,l1("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),m1.apply(this,arguments)}function k1(e){return new Promise(function(t){setTimeout(t,e)})}var C1=/^[cdef][\w-]{21}$/;function w1(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,sy(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return C1.test(t)?t:""}catch(n){return""}}function _1(e){return"".concat(e.appName,"!").concat(e.appId)}var E1=new Map;function b1(e,t){var n=_1(e);S1(n,t),function(e,t){var n=(!P1&&"BroadcastChannel"in self&&((P1=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){S1(e.data.key,e.data.fid)}),P1);n&&n.postMessage({key:e,fid:t}),0===E1.size&&P1&&(P1.close(),P1=null)}(n,t)}function S1(e,t){var n=E1.get(e);if(n){var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var P1=null,O1="firebase-installations-store",T1=null;function I1(){return T1||(T1=Tz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(O1)}})),T1}function A1(e,t){return R1.apply(this,arguments)}function R1(){return R1=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_1(t),e.next=3,I1();case 3:return i=e.sent.transaction(O1,"readwrite"),a=i.objectStore(O1),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&b1(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),R1.apply(this,arguments)}function M1(e){return x1.apply(this,arguments)}function x1(){return x1=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=_1(t),e.next=3,I1();case 3:return r=e.sent.transaction(O1,"readwrite"),e.next=6,r.objectStore(O1).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),x1.apply(this,arguments)}function N1(e,t){return D1.apply(this,arguments)}function D1(){return D1=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_1(t),e.next=3,I1();case 3:return i=e.sent.transaction(O1,"readwrite"),a=i.objectStore(O1),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&b1(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),D1.apply(this,arguments)}function L1(e){return F1.apply(this,arguments)}function F1(){return F1=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N1(t.appConfig,function(e){var r=U1(e),i=V1(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),F1.apply(this,arguments)}function U1(e){return $1(e||{fid:w1(),registrationStatus:0})}function V1(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(o1.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return B1.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:z1(e)}:{installationEntry:t}}function B1(){return B1=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y1(t,n);case 3:return r=e.sent,e.abrupt("return",A1(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!s1(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,M1(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,A1(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),B1.apply(this,arguments)}function z1(e){return H1.apply(this,arguments)}function H1(){return H1=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G1(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,k1(100);case 6:return e.next=8,G1(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,L1(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),H1.apply(this,arguments)}function G1(e){return N1(e,function(e){if(!e)throw o1.create("installation-not-found");return $1(e)})}function $1(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function Z1(e,t){return q1.apply(this,arguments)}function q1(){return q1=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=W1(r,n),o=d1(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:i1,appId:r.appId}})},e.next=10,v1(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=c1,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,l1("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),q1.apply(this,arguments)}function W1(e,t){var n=t.fid;return"".concat(u1(e),"/").concat(n,"/authTokens:generate")}function j1(e){return Y1.apply(this,arguments)}function Y1(){return Y1=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,N1(t.appConfig,function(e){if(!t0(e))throw o1.create("not-registered");var i=e.authToken;if(!n&&n0(i))return e;if(1===i.requestStatus)return r=K1(t,n),e;if(!navigator.onLine)throw o1.create("app-offline");var a=r0(e);return r=J1(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),Y1.apply(this,arguments)}function K1(e,t){return Q1.apply(this,arguments)}function Q1(){return Q1=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X1(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,k1(100);case 6:return e.next=8,X1(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?j1(t,n):i);case 13:case"end":return e.stop()}},e)})),Q1.apply(this,arguments)}function X1(e){return N1(e,function(e){if(!t0(e))throw o1.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function J1(e,t){return e0.apply(this,arguments)}function e0(){return e0=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z1(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,A1(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),s1(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,A1(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,M1(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),e0.apply(this,arguments)}function t0(e){return void 0!==e&&2===e.registrationStatus}function n0(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function r0(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function i0(){return i0=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,L1(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):j1(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),i0.apply(this,arguments)}function a0(){return a0=PB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,o0(r);case 4:return e.next=6,j1(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),a0.apply(this,arguments)}function o0(e){return s0.apply(this,arguments)}function s0(){return s0=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L1(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),s0.apply(this,arguments)}function u0(e){return o1.create("missing-app-config-values",{valueName:e})}var c0="installations";Gz(new cz(c0,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw u0("App Configuration");if(!e.name)throw u0("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw u0(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:$z(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),Gz(new cz("installations-internal",function(e){var t=$z(e.getProvider("app").getImmediate(),c0).getImmediate();return{getId:function(){return function(e){return i0.apply(this,arguments)}(t)},getToken:function(e){return function(e){return a0.apply(this,arguments)}(t,e)}}},"PRIVATE")),Kz(n1,r1),Kz(n1,r1,"esm2017");var l0="@firebase/remote-config",f0=new KB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),h0=function(){function e(t,n,r,i){hy(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return vy(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Wg(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function d0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var v0=function(){function e(t,n,r,i,a,o){hy(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return vy(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=Wg(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:d0()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),f0.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),f0.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw f0.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),p0=function(){function e(t,n){hy(this,e),this.client=t,this.storage=n}return vy(e,[{key:"fetch",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return PB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(f0.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof YB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+az(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),g0=function(){function e(t,n,r,i,a){hy(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return vy(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function y0(e,t){var n,r=e.target.error||void 0;return f0.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var m0="app_namespace_store",k0=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(y0(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(m0,{keyPath:"compositeKey"})}}catch(r){t(f0.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});hy(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return vy(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([m0],"readonly").objectStore(m0),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(y0(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(f0.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([m0],"readwrite").objectStore(m0),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(y0(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(f0.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([m0],"readwrite").objectStore(m0),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(y0(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(f0.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),C0=function(){function e(t){hy(this,e),this.storage=t}return vy(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function w0(){return(w0=PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(qB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,WB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}Gz(new cz("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw f0.create("registration-window");if(!qB())throw f0.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw f0.create("registration-project-id");if(!s)throw f0.create("registration-api-key");if(!u)throw f0.create("registration-app-id");var c=new k0(u,r.name,n=n||"firebase"),l=new C0(c),f=new kz(l0);f.logLevel=vz.ERROR;var h=new v0(i,Wz,n,o,s,u),d=new p0(h,c),v=new h0(d,c,l,f),p=new g0(r,v,l,c,f);return function(e){var t=oz(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),Kz(l0,"0.3.11"),Kz(l0,"0.3.11","esm2017");var _0="/firebase-messaging-sw.js",E0="/firebase-cloud-messaging-push-scope",b0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",S0="google.c.a.c_id",P0="google.c.a.c_l",O0="google.c.a.ts",T0="google.c.a.e",I0=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(I0||(I0={})),I0);function A0(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,sy(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function R0(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var M0="fcm_token_details_db",x0="fcm_token_object_Store";function N0(e){return D0.apply(this,arguments)}function D0(){return D0=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(M0);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,Tz(M0,5,{upgrade:(r=PB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(x0)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(x0),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:A0(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:A0(f.auth),p256dh:A0(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:A0(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:A0(h.auth),p256dh:A0(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:A0(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,Iz(M0);case 13:return e.next=15,Iz("fcm_vapid_details_db");case 15:return e.next=17,Iz("undefined");case 17:return e.abrupt("return",L0(n)?n:null);case 18:case"end":return e.stop()}},e)})),D0.apply(this,arguments)}function L0(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var F0="firebase-messaging-store",U0=null;function V0(){return U0||(U0=Tz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(F0)}})),U0}function B0(e){return z0.apply(this,arguments)}function z0(){return z0=PB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=q0(t),e.next=3,V0();case 3:return e.next=5,e.sent.transaction(F0).objectStore(F0).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,N0(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,H0(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),z0.apply(this,arguments)}function H0(e,t){return G0.apply(this,arguments)}function G0(){return G0=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=q0(t),e.next=3,V0();case 3:return i=e.sent.transaction(F0,"readwrite"),e.next=6,i.objectStore(F0).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),G0.apply(this,arguments)}function $0(e){return Z0.apply(this,arguments)}function Z0(){return Z0=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=q0(t),e.next=3,V0();case 3:return r=e.sent.transaction(F0,"readwrite"),e.next=6,r.objectStore(F0).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),Z0.apply(this,arguments)}function q0(e){return e.appConfig.appId}var W0=new KB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function j0(e,t){return Y0.apply(this,arguments)}function Y0(){return Y0=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t2(t);case 2:return i=e.sent,a=r2(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(e2(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),W0.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw W0.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw W0.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),Y0.apply(this,arguments)}function K0(e,t){return Q0.apply(this,arguments)}function Q0(){return Q0=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t2(t);case 2:return i=e.sent,a=r2(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(e2(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),W0.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw W0.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw W0.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),Q0.apply(this,arguments)}function X0(e,t){return J0.apply(this,arguments)}function J0(){return J0=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t2(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(e2(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw W0.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),W0.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),J0.apply(this,arguments)}function e2(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function t2(e){return n2.apply(this,arguments)}function n2(){return n2=PB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),n2.apply(this,arguments)}function r2(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==b0&&(a.web.applicationPubKey=i),a}function i2(e){return a2.apply(this,arguments)}function a2(){return a2=PB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h2(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:A0(n.getKey("auth")),p256dh:A0(n.getKey("p256dh"))},e.next=6,B0(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!v2(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?u2(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,X0(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",l2(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),a2.apply(this,arguments)}function o2(e){return s2.apply(this,arguments)}function s2(){return s2=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B0(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,X0(t.firebaseDependencies,n.token);case 7:return e.next=9,$0(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),s2.apply(this,arguments)}function u2(e,t){return c2.apply(this,arguments)}function c2(){return c2=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K0(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,H0(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,o2(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),c2.apply(this,arguments)}function l2(e,t){return f2.apply(this,arguments)}function f2(){return f2=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j0(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,H0(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),f2.apply(this,arguments)}function h2(e,t){return d2.apply(this,arguments)}function d2(){return d2=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:R0(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),d2.apply(this,arguments)}function v2(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function p2(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function g2(e){return"object"==typeof e&&!!e&&S0 in e}function y2(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function m2(e){return W0.create("missing-app-config-values",{valueName:e})}y2("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),y2("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var k2=function(){function e(t,n,r){hy(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw m2("App Configuration Object");if(!e.name)throw m2("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw m2(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return vy(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function C2(e){return w2.apply(this,arguments)}function w2(){return w2=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(_0,{scope:E0});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),W0.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),w2.apply(this,arguments)}function _2(e,t){return E2.apply(this,arguments)}function E2(){return E2=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,C2(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw W0.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),E2.apply(this,arguments)}function b2(e,t){return S2.apply(this,arguments)}function S2(){return S2=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=b0);case 1:case"end":return e.stop()}},e)})),S2.apply(this,arguments)}function P2(){return P2=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw W0.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw W0.create("permission-blocked");case 8:return e.next=10,b2(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,_2(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",i2(t));case 13:case"end":return e.stop()}},e)})),P2.apply(this,arguments)}function O2(e,t,n){return T2.apply(this,arguments)}function T2(){return T2=PB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=I2(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[S0],message_name:r[P0],message_time:r[O0],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),T2.apply(this,arguments)}function I2(e){switch(e){case I0.NOTIFICATION_CLICKED:return"notification_open";case I0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function A2(){return A2=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===I0.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(p2(r)):t.onMessageHandler.next(p2(r))),i=r.data,e.t0=g2(i)&&"1"===i[T0],!e.t0){e.next=9;break}return e.next=9,O2(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),A2.apply(this,arguments)}var R2="@firebase/messaging";function M2(){return(M2=PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,WB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&qB()&&jB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}Gz(new cz("messaging",function(e){var t=new k2(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return A2.apply(this,arguments)}(t,e)}),t},"PUBLIC")),Gz(new cz("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return P2.apply(this,arguments)}(t,e)}}},"PRIVATE")),Kz(R2,"0.9.16"),Kz(R2,"0.9.16","esm2017");var x2="analytics",N2="firebase_id",D2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",L2="https://www.googletagmanager.com/gtag/js",F2=new kz("@firebase/analytics");function U2(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function V2(e,t){var n=document.createElement("script");n.src="".concat(L2,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function B2(e,t,n,r,i,a){return z2.apply(this,arguments)}function z2(){return z2=PB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,U2(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),F2.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),z2.apply(this,arguments)}function H2(e,t,n,r,i){return G2.apply(this,arguments)}function G2(){return G2=PB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,U2(r);case 7:u=e.sent,c=cy(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),F2.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),G2.apply(this,arguments)}function $2(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(L2))return r}return null}var Z2=new KB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),q2=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;hy(this,e),this.throttleMetadata=t,this.intervalMillis=n}return vy(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function W2(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function j2(e){return Y2.apply(this,arguments)}function Y2(){return Y2=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:W2(i)},o=D2.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw Z2.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),Y2.apply(this,arguments)}function K2(e){return Q2.apply(this,arguments)}function Q2(){return Q2=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:q2,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw Z2.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw Z2.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new i3,e.abrupt("return",(setTimeout(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),X2({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),Q2.apply(this,arguments)}function X2(e,t,n){return J2.apply(this,arguments)}function J2(){return J2=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:q2,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,e3(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(F2.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,j2(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),t3(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(F2.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?az(a,o.intervalMillis,30):az(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),F2.debug("Calling attemptFetch again in ".concat(d," millis")),X2(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),J2.apply(this,arguments)}function e3(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(Z2.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function t3(e){if(!(e instanceof YB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var n3,r3,i3=function(){function e(){hy(this,e),this.listeners=[]}return vy(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function a3(){return a3=PB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),a3.apply(this,arguments)}function o3(e){r3=e}function s3(e){n3=e}function u3(){return c3.apply(this,arguments)}function c3(){return c3=PB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(qB()){e.next=2;break}return e.abrupt("return",(F2.warn(Z2.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,WB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(F2.warn(Z2.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),c3.apply(this,arguments)}function l3(){return l3=PB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=K2(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&F2.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return F2.error(e)}),n.push(c),l=u3().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=Wg(f,2),d=h[0],v=h[1],$2()||V2(o,d.measurementId),r3&&(a("consent","default",r3),o3(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[N2]=v),a("config",d.measurementId,p),n3&&(a("set",n3),s3(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),l3.apply(this,arguments)}var f3,h3,d3=function(){function e(t){hy(this,e),this.app=t}return vy(e,[{key:"_delete",value:function(){return delete v3[this.app.options.appId],Promise.resolve()}}]),e}(),v3={},p3=[],g3={},y3="dataLayer",m3=!1;function k3(){return(k3=PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!GB()&&jB()&&qB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,WB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var C3="@firebase/analytics";Gz(new cz(x2,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(GB()&&e.push("This is a browser extension environment."),jB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=Z2.create("invalid-analytics-context",{errorInfo:t});F2.warn(n.message)}}();var r=e.options.appId;if(!r)throw Z2.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Z2.create("no-api-key");F2.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=v3[r])throw Z2.create("already-exists",{id:r});if(!m3){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(y3);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=PB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,H2(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,B2(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),F2.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(v3,p3,g3,y3,"gtag"),a=i.wrappedGtag,o=i.gtagCore;h3=a,f3=o,m3=!0}return v3[r]=function(e,t,n,r,i,a,o){return l3.apply(this,arguments)}(e,p3,g3,t,f3,y3,n),new d3(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Gz(new cz("analytics-internal",function(e){try{var t=e.getProvider(x2).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=oz(e),function(e,t,n,r,i){return a3.apply(this,arguments)}(h3,v3[e.app.options.appId],t,n,r).catch(function(e){return F2.error(e)})}(t,e,n,r)}}}catch(t){throw Z2.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Kz(C3,"0.8.0"),Kz(C3,"0.8.0","esm2017");var w3=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this)}return vy(n,[{key:"schedule",value:function(e){return this}}]),n}(dy),_3={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=_3.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=_3.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},E3=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return vy(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _3.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;_3.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,fy(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,Xg(oy(n.prototype),"unsubscribe",this).call(this)}}}]),n}(w3),b3={now:function(){return(b3.delegate||Date).now()},delegate:void 0},S3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;hy(this,e),this.schedulerActionCtor=t,this.now=n}return vy(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();S3.now=b3.now;var P3=function(e){ey(n,e);var t=ny(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S3.now;return hy(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return vy(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(S3),O3=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n)}(P3))(function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return vy(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?Xg(oy(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?Xg(oy(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?Xg(oy(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(E3)),T3=new P3(E3),I3=new DO("7.4.1"),A3="__angularfire_symbol__analyticsIsSupportedValue",R3="__angularfire_symbol__analyticsIsSupported",M3="__angularfire_symbol__remoteConfigIsSupportedValue",x3="__angularfire_symbol__remoteConfigIsSupported",N3="__angularfire_symbol__messagingIsSupportedValue",D3="__angularfire_symbol__messagingIsSupported";function L3(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[R3]||(globalThis[R3]=function(){return k3.apply(this,arguments)}().then(function(e){return globalThis[A3]=e}).catch(function(){return globalThis[A3]=!1})),globalThis[D3]||(globalThis[D3]=function(){return M2.apply(this,arguments)}().then(function(e){return globalThis[N3]=e}).catch(function(){return globalThis[N3]=!1})),globalThis[x3]||(globalThis[x3]=function(){return w0.apply(this,arguments)}().then(function(e){return globalThis[M3]=e}).catch(function(){return globalThis[M3]=!1}));var F3=function(e,t){var n=t?[t]:Yz(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function U3(){}var V3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O3;hy(this,e),this.zone=t,this.delegate=n}return vy(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),B3=function(){function e(t){hy(this,e),this.zone=t,this.task=null}return vy(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",U3,{},U3,U3)}),t.pipe(VN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),z3=function(){var e=vy(function e(t){hy(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new V3(Zone.current)}),this.insideAngular=t.run(function(){return new V3(Zone.current,T3)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Lw(wI))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function H3(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function G3(e){return H3().ngZone.runOutsideAngular(function(){return e()})}function $3(e){return H3().ngZone.run(function(){return e()})}function Z3(e){return H3(),function(e){return function(t){return(t=t.lift(new B3(e.ngZone))).pipe(gm(e.outsideAngular),pm(e.insideAngular))}}(H3())(e)}var q3=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),$3(function(){return e.apply(n,r)})}},W3=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=$3(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",U3,{},U3,U3)}))),i[a]=q3(i[a],n));var o=G3(function(){return e.apply(r,i)});if(!t){if(o instanceof Uy){var s=H3();return o.pipe(gm(s.outsideAngular),pm(s.insideAngular))}return $3(function(){return o})}return o instanceof Uy?o.pipe(Z3):o instanceof Promise?$3(function(){return new Promise(function(e,t){return o.then(function(t){return $3(function(){return e(t)})},function(e){return $3(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:$3(function(){return o})}},j3=vy(function e(t){return hy(this,e),t}),Y3=vy(function e(){return hy(this,e),Yz()}),K3=new gw("angularfire2._apps"),Q3={provide:j3,useFactory:function(e){return e&&1===e.length?e[0]:new j3(jz())},deps:[[new $w,K3]]},X3={provide:Y3,deps:[[new $w,K3]]};function J3(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new j3(r)}}var e4=function(){var e=vy(function e(t){hy(this,e),Kz("angularfire",I3.full,"core"),Kz("angularfire",I3.full,"app"),Kz("angular",LO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Lw(oI))},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[Q3,X3]}),e}(),t4=W3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:Uz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Zz.create("bad-app-name",{appName:String(r)});var i=Bz.get(r);if(i){if(XB(e,i.options)&&XB(n,i.config))return i;throw Zz.create("duplicate-app",{appName:r})}var a,o=new hz(r),s=cy(zz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new qz(e,n,o);return Bz.set(r,c),c},!0),n4=new Map,r4={activated:!1,tokenObservers:[]},i4={initialized:!1,enabled:!1};function a4(e){return n4.get(e)||r4}function o4(e,t){n4.set(e,t)}function s4(){return i4}var u4=function(){function e(t,n,r,i,a){if(hy(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return vy(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new BB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new BB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),c4=new KB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function l4(e){if(!a4(e).activated)throw c4.create("use-before-activation",{appName:e.name})}function f4(e,t){return h4.apply(this,arguments)}function h4(){return h4=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),c4.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw c4.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),c4.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw c4.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),h4.apply(this,arguments)}function d4(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var v4="firebase-app-check-store",p4=null;function g4(){return p4||(p4=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(c4.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(v4,{keyPath:"compositeKey"})}}catch(r){t(c4.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),p4)}function y4(){return y4=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g4();case 2:return r=e.sent.transaction(v4,"readwrite"),i=r.objectStore(v4).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(c4.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),y4.apply(this,arguments)}var m4=new kz("@firebase/app-check");function k4(e,t){return qB()?function(e,t){return function(e,t){return y4.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){m4.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function C4(){return s4().enabled}function w4(){return _4.apply(this,arguments)}function _4(){return _4=PB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=s4()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),_4.apply(this,arguments)}var E4={error:"UNKNOWN_ERROR"};function b4(e){return UB.encodeString(JSON.stringify(e),!1)}function S4(e){return P4.apply(this,arguments)}function P4(){return P4=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],l4(r=t.app),i=a4(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&A4(s)&&(o=s);case 10:if(n||!o||!A4(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!C4()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=f4,e.t2=d4,e.t3=r,e.next=21,w4();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,k4(r,l);case 31:return o4(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?m4.warn(e.t7.message):m4.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},o4(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,k4(r,o);case 48:e.next=51;break;case 50:u=R4(a);case 51:return c&&I4(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),P4.apply(this,arguments)}function O4(e,t){var n=a4(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),o4(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function T4(e){var t=e.app,n=a4(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new u4(PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!a4(t).token){n.next=6;break}return n.next=3,S4(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,S4(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=a4(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),o4(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function I4(e,t){var n,r=cy(a4(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function A4(e){return e.expireTimeMillis-Date.now()>0}function R4(e){return{token:b4(E4),error:e}}var M4=function(){function e(t,n){hy(this,e),this.app=t,this.heartbeatServiceProvider=n}return vy(e,[{key:"_delete",value:function(){var e,t=cy(a4(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;O4(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),x4="app-check-internal";Gz(new cz("app-check",function(e){return function(e,t){return new M4(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(x4).initialize()})),Gz(new cz(x4,function(e){return function(e){return{getToken:function(t){return S4(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=a4(i),o={next:n,error:void 0,type:"INTERNAL"};if(o4(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(sy(a.tokenObservers),[o])})),a.token&&A4(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),T4(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return T4(e)})}(e,0,t)},removeTokenListener:function(t){return O4(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),Kz("@firebase/app-check","0.5.11");var N4=vy(function e(){return hy(this,e),F3("app-check")});"undefined"!=typeof window&&window;var D4=new KB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),L4=new kz("@firebase/auth");function F4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];L4.logLevel<=vz.ERROR&&L4.error.apply(L4,["Auth (9.9.0): ".concat(e)].concat(n))}function U4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw H4.apply(void 0,[e].concat(n))}function V4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return H4.apply(void 0,[e].concat(n))}function B4(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),qg({},t,n));return new KB("auth","Firebase",r).create(t,{appName:e.name})}function z4(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&U4(e,"argument-error"),B4(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function H4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=sy(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(sy(o)))}return D4.create.apply(D4,[e].concat(n))}function G4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw H4.apply(void 0,[t].concat(r))}function $4(e){var t="INTERNAL ASSERTION FAILED: "+e;throw F4(t),new Error(t)}function Z4(e,t){e||$4(t)}var q4=new Map;function W4(e){Z4(e instanceof Function,"Expected a class definition");var t=q4.get(e);return t?(Z4(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,q4.set(e,t),t)}function j4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Y4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var K4=function(){function e(t,n){hy(this,e),this.shortDelay=t,this.longDelay=n,Z4(n>t,"Short delay should be less than long delay!"),this.isMobile=HB()||$B()}return vy(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Y4()||"https:"===Y4()||GB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function Q4(e,t){Z4(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var X4=function(){function e(){hy(this,e)}return vy(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void $4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void $4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void $4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),J4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},e5=new K4(3e4,6e4);function t5(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function n5(e,t,n,r){return r5.apply(this,arguments)}function r5(){return r5=PB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",i5(t,a,PB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=ez(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),X4.fetch()(u5(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),r5.apply(this,arguments)}function i5(e,t,n){return a5.apply(this,arguments)}function a5(){return a5=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},J4),n),e.prev=2,a=new c5(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw l5(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Wg(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw l5(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw l5(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw l5(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw B4(t,d,h);case 25:U4(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof YB)){e.next=32;break}throw e.t0;case 32:U4(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),a5.apply(this,arguments)}function o5(e,t,n,r){return s5.apply(this,arguments)}function s5(){return s5=PB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,n5(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&U4(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),s5.apply(this,arguments)}function u5(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Q4(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var c5=function(){function e(t){var n=this;hy(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(V4(n.auth,"network-request-failed"))},e5.get())})}return vy(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function l5(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=V4(e,t,r);return i.customData._tokenResponse=n,i}function f5(){return f5=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n5(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),f5.apply(this,arguments)}function h5(e,t){return d5.apply(this,arguments)}function d5(){return d5=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n5(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),d5.apply(this,arguments)}function v5(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function p5(){return p5=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=oz(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,G4((a=y5(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:v5(g5(a.auth_time)),issuedAtTime:v5(g5(a.iat)),expirationTime:v5(g5(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),p5.apply(this,arguments)}function g5(e){return 1e3*Number(e)}function y5(e){var t,n=Wg(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return F4("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return UB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(F4("Failed to decode base64 JWT payload"),null)}catch(s){return F4("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function m5(e,t){return k5.apply(this,arguments)}function k5(){return k5=PB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof YB&&C5(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),k5.apply(this,arguments)}function C5(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var w5=function(){function e(t){hy(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return vy(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),_5=function(){function e(t,n){hy(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return vy(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=v5(this.lastLoginAt),this.creationTime=v5(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function E5(e){return b5.apply(this,arguments)}function b5(){return b5=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,m5(t,h5(r,{idToken:i}));case 6:G4(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?O5(o.providerUserInfo):[],u=P5(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new _5(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),b5.apply(this,arguments)}function S5(){return S5=PB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=oz(t),e.next=3,E5(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),S5.apply(this,arguments)}function P5(e,t){return[].concat(sy(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),sy(t))}function O5(e){return e.map(function(e){var t=e.providerId,n=Wy(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function T5(){return T5=PB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i5(t,{},PB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ez({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=u5(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",X4.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),T5.apply(this,arguments)}var I5=function(){function e(){hy(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return vy(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){G4(e.idToken,"internal-error"),G4(void 0!==e.idToken,"internal-error"),G4(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=y5(e);return G4(t,"internal-error"),G4(void 0!==t.exp,"internal-error"),G4(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(G4(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return T5.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return $4("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(G4("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(G4("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(G4("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function A5(e,t){G4("string"==typeof e||void 0===e,"internal-error",{appName:t})}var R5=function(){function e(t){hy(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Wy(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new w5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?sy(a.providerData):[],this.metadata=new _5(a.createdAt||void 0,a.lastLoginAt||void 0)}return vy(e,[{key:"getIdToken",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m5(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(G4(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return p5.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return S5.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(G4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){G4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,E5(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,m5(e,function(e,t){return f5.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,E=n.stsTokenManager;G4(k&&E,t,"internal-error");var b=I5.fromJSON(this.name,E);G4("string"==typeof k,t,"internal-error"),A5(f,t.name),A5(h,t.name),G4("boolean"==typeof C,t,"internal-error"),G4("boolean"==typeof w,t,"internal-error"),A5(d,t.name),A5(v,t.name),A5(p,t.name),A5(g,t.name),A5(y,t.name),A5(m,t.name);var S=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:b,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(S.providerData=_.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return PB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new I5).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,E5(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),M5=function(){var e=function(){function e(){hy(this,e),this.type="NONE",this.storage={}}return vy(e,[{key:"_isAvailable",value:function(){return PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function x5(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var N5=function(){function e(t,n,r){hy(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=x5(this.userKey,a.apiKey,o),this.fullPersistenceKey=x5("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return vy(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?R5._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return PB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(W4(M5),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||W4(M5),s=x5(r,t.config.apiKey,t.name),u=null,c=cy(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=R5._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function D5(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(V5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(L5(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(z5(t))return"Blackberry";if(H5(t))return"Webos";if(F5(t))return"Safari";if((t.includes("chrome/")||U5(t))&&!t.includes("edge/"))return"Chrome";if(B5(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function L5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/firefox\//i.test(e)}function F5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function U5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/crios\//i.test(e)}function V5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/iemobile/i.test(e)}function B5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/android/i.test(e)}function z5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/blackberry/i.test(e)}function H5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/webos/i.test(e)}function G5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function $5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return G5(e)||B5(e)||H5(e)||z5(e)||/windows phone/i.test(e)||V5(e)}function Z5(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=D5(zB());break;case"Worker":t="".concat(D5(zB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var q5=function(){function e(t){hy(this,e),this.auth=t,this.queue=[]}return vy(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=cy(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=cy(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),W5=function(){function e(t,n,r){hy(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Y5(this),this.idTokenSubscription=new Y5(this),this.beforeStateQueue=new q5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=D4,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return vy(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=W4(t)),this._initializationPromise=this.queue(PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,N5.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return G4(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E5(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?oz(e):null,n.abrupt("return",(r&&G4(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&G4(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(W4(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new KB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return G4(r=e&&W4(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,N5.create(t,[W4(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return G4(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return G4(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Z5(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function j5(e){return oz(e)}var Y5=function(){function e(t){var n,r=this;hy(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new rz(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return vy(e,[{key:"next",get:function(){return G4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),K5=function(){function e(t,n){hy(this,e),this.providerId=t,this.signInMethod=n}return vy(e,[{key:"toJSON",value:function(){return $4("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return $4("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return $4("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return $4("not implemented")}}]),e}();function Q5(){return Q5=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),Q5.apply(this,arguments)}function X5(){return X5=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o5(t,"POST","/v1/accounts:signInWithPassword",t5(t,n)));case 1:case"end":return e.stop()}},e)})),X5.apply(this,arguments)}function J5(e,t){return e6.apply(this,arguments)}function e6(){return e6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n5(t,"POST","/v1/accounts:sendOobCode",t5(t,n)));case 1:case"end":return e.stop()}},e)})),e6.apply(this,arguments)}function t6(e,t){return n6.apply(this,arguments)}function n6(){return n6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J5(t,n));case 1:case"end":return e.stop()}},e)})),n6.apply(this,arguments)}function r6(e,t){return i6.apply(this,arguments)}function i6(){return i6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J5(t,n));case 1:case"end":return e.stop()}},e)})),i6.apply(this,arguments)}function a6(){return a6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o5(t,"POST","/v1/accounts:signInWithEmailLink",t5(t,n)));case 1:case"end":return e.stop()}},e)})),a6.apply(this,arguments)}function o6(){return o6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o5(t,"POST","/v1/accounts:signInWithEmailLink",t5(t,n)));case 1:case"end":return e.stop()}},e)})),o6.apply(this,arguments)}var s6=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return hy(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return vy(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return X5.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return a6.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:U4(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return Q5.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return o6.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:U4(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(K5);function u6(e,t){return c6.apply(this,arguments)}function c6(){return c6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o5(t,"POST","/v1/accounts:signInWithIdp",t5(t,n)));case 1:case"end":return e.stop()}},e)})),c6.apply(this,arguments)}var l6=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return vy(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return u6(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,u6(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,u6(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ez(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):U4("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Wy(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(K5),f6=function(){function e(t){var n,r,i,a,o,s;hy(this,e);var u=tz(nz(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);G4(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return vy(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=tz(nz(e)).link,n=t?tz(nz(t)).deep_link_id:null,r=tz(nz(e)).deep_link_id;return(r?tz(nz(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),h6=function(){var e=function(){function e(){hy(this,e),this.providerId=e.PROVIDER_ID}return vy(e,null,[{key:"credential",value:function(e,t){return s6._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=f6.parseLink(t);return G4(n,"argument-error"),s6._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),d6=function(){function e(t){hy(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return vy(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),v6=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).scopes=[],e}return vy(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return sy(this.scopes)}}]),n}(d6),p6=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return vy(n,null,[{key:"credential",value:function(e,t){return l6._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(v6);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function g6(e,t){return y6.apply(this,arguments)}function y6(){return y6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o5(t,"POST","/v1/accounts:signUp",t5(t,n)));case 1:case"end":return e.stop()}},e)})),y6.apply(this,arguments)}var m6=function(){function e(t){hy(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return vy(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return PB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,R5._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=k6(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=k6(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function k6(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var C6=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o,s;return hy(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(iy(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return vy(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(YB);function w6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?C6._fromErrorAndOperation(e,n,t,r):n})}function _6(e,t){return E6.apply(this,arguments)}function E6(){return E6=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=m5,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",m6._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),E6.apply(this,arguments)}function b6(){return b6=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,m5(t,w6(a,o,n,t),r);case 5:return G4((s=e.sent).idToken,a,"internal-error"),G4(u=y5(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(G4(t.uid===c,a,"user-mismatch"),m6._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&U4(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),b6.apply(this,arguments)}function S6(e,t){return P6.apply(this,arguments)}function P6(){return P6=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,w6(t,i,n);case 4:return a=e.sent,e.next=7,m6._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),P6.apply(this,arguments)}function O6(){return O6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S6(j5(t),n));case 1:case"end":return e.stop()}},e)})),O6.apply(this,arguments)}function T6(e,t,n){var r;G4((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),G4(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(G4(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(G4(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function I6(){return I6=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=oz(t),a={requestType:"PASSWORD_RESET",email:n},r&&T6(i,a,r),e.next=4,r6(i,a);case 4:case"end":return e.stop()}},e)})),I6.apply(this,arguments)}function A6(){return A6=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=j5(t),e.next=3,g6(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,m6._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),A6.apply(this,arguments)}function R6(){return R6=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=oz(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&T6(r.auth,i,n),e.next=8,t6(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),R6.apply(this,arguments)}function M6(e,t){return x6.apply(this,arguments)}function x6(){return x6=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),x6.apply(this,arguments)}function N6(){return N6=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=oz(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,m5(a,M6(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),N6.apply(this,arguments)}new WeakMap;var D6="__sak",L6=function(){function e(t,n){hy(this,e),this.storageRetriever=t,this.type=n}return vy(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(D6,"1"),this.storage.removeItem(D6),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),F6=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=zB();return F5(e)||G5(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=$5(),e._shouldAllowMigration=!0,e}return vy(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);ZB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return PB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Xg(oy(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Xg(oy(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Xg(oy(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(L6);return e.type="LOCAL",e}(),U6=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return vy(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(L6);return e.type="SESSION",e}(),V6=function(){var e=function(){function e(t){hy(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return vy(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=PB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function B6(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var z6=function(){function e(t){hy(this,e),this.target=t,this.handlers=new Set}return vy(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return PB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=B6("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function H6(){return window}function G6(){return void 0!==H6().WorkerGlobalScope&&"function"==typeof H6().importScripts}function $6(){return($6=PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var Z6="firebaseLocalStorageDb",q6="firebaseLocalStorage",W6="fbase_key",j6=function(){function e(t){hy(this,e),this.request=t}return vy(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function Y6(e,t){return e.transaction([q6],t?"readwrite":"readonly").objectStore(q6)}function K6(){var e=indexedDB.open(Z6,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(q6,{keyPath:W6})}catch(r){n(r)}}),e.addEventListener("success",PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(q6)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(Z6);return new j6(e).toPromise()}();case 8:return n.t0=t,n.next=11,K6();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function Q6(e,t,n){return X6.apply(this,arguments)}function X6(){return X6=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Y6(t,!0).put((qg(i={},W6,n),qg(i,"value",r),i)),e.abrupt("return",new j6(a).toPromise());case 2:case"end":return e.stop()}},e)})),X6.apply(this,arguments)}function J6(){return J6=PB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Y6(t,!1).get(n),e.next=3,new j6(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),J6.apply(this,arguments)}function e8(e,t){var n=Y6(e,!0).delete(t);return new j6(n).toPromise()}var t8=function(){var e=function(){function e(){hy(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return vy(e,[{key:"_openDb",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,K6();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",G6()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=V6._getInstance(G6()?self:null),e.receiver._subscribe("keyChanged",function(){var t=PB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=PB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return $6.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new z6(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return PB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,K6();case 5:return t=e.sent,e.next=8,Q6(t,D6,"1");case 8:return e.next=10,e8(t,D6);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return Q6(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return J6.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return e8(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=Y6(e,!1).getAll();return new j6(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=cy(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function n8(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function r8(e,t){return t?W4(t):(G4(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}n8("rcb"),new K4(3e4,6e4);var i8=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,"custom","custom")).params=e,r}return vy(n,[{key:"_getIdTokenResponse",value:function(e){return u6(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return u6(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return u6(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(K5);function a8(e){return S6(e.auth,new i8(e),e.bypassAuthState)}function o8(e){var t=e.auth,n=e.user;return G4(n,t,"internal-error"),function(e,t){return b6.apply(this,arguments)}(n,new i8(e),e.bypassAuthState)}function s8(e){return u8.apply(this,arguments)}function u8(){return u8=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(G4(r,n,"internal-error"),_6(r,new i8(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),u8.apply(this,arguments)}var c8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];hy(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return vy(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=PB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return a8;case"linkViaPopup":case"linkViaRedirect":return s8;case"reauthViaPopup":case"reauthViaRedirect":return o8;default:U4(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Z4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Z4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),l8=new K4(2e3,1e4);function f8(){return f8=PB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=j5(t),z4(t,n,d6),a=r8(i,r),e.abrupt("return",new h8(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),f8.apply(this,arguments)}var h8=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=iy(s),s}return vy(n,[{key:"executeNotNull",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(G4(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z4(1===e.filter.length,"Popup operations only handle one event"),n=B6(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(V4(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(V4(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(V4(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,l8.get())}()}}]),n}(c8);return e.currentPopupAction=null,e}(),d8=new Map,v8=function(e){ey(n,e);var t=ny(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return hy(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return vy(n,[{key:"execute",value:function(){var e=this,t=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=d8.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return p8.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,Xg(oy(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:d8.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||d8.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return Xg(oy(n.prototype),"onAuthEvent",t)},i=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(c8);function p8(){return p8=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=m8(n),i=y8(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),p8.apply(this,arguments)}function g8(e,t){d8.set(e._key(),t)}function y8(e){return W4(e._redirectPersistence)}function m8(e){return x5("pendingRedirect",e.config.apiKey,e.name)}function k8(e,t){return C8.apply(this,arguments)}function C8(){return C8=PB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=j5(t),a=r8(i,n),e.next=5,new v8(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),C8.apply(this,arguments)}var w8=function(){function e(t){hy(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return vy(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return E8(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!E8(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(V4(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_8(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(_8(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function _8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function E8(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function b8(e){return S8.apply(this,arguments)}function S8(){return S8=PB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",n5(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),S8.apply(this,arguments)}var P8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O8=/^https?/;function T8(){return T8=PB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,b8(t);case 4:n=e.sent,r=n.authorizedDomains,i=cy(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!I8(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:U4(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),T8.apply(this,arguments)}function I8(e){var t=j4(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!O8.test(r))return!1;if(P8.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var A8=new K4(3e4,6e4);function R8(){var e=H6().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=sy(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var M8=null;function x8(e){return M8=M8||function(e){return new Promise(function(t,n){var r,i,a;function o(){R8(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){R8(),n(V4(e,"network-request-failed"))},timeout:A8.get()})}if(null===(i=null===(r=H6().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=H6().gapi)||void 0===a?void 0:a.load)){var s=n8("iframefcb");return H6()[s]=function(){gapi.load?o():n(V4(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=V4("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw M8=null,e})}(e),M8}var N8=new K4(5e3,15e3),D8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F8(e){var t=e.config;G4(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Q4(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Wz},i=L8.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(ez(r).slice(1))}function U8(){return U8=PB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x8(t);case 2:return n=e.sent,r=H6().gapi,e.abrupt("return",(G4(r,t,"internal-error"),n.open({where:document.body,url:F8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D8,dontclear:!0},function(e){return new Promise((n=PB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){H6().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=V4(t,"network-request-failed"),o=H6().setTimeout(function(){i(a)},N8.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),U8.apply(this,arguments)}var V8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B8=function(){function e(t){hy(this,e),this.window=t,this.associatedEvent=null}return vy(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function z8(e,t,n,r,i,a){G4(e.config.authDomain,e,"auth-domain-config-required"),G4(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Wz,eventId:i};if(t instanceof d6){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Wg(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof v6){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?Q4(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(ez(d).slice(1))}var H8="webStorageSupport",G8=function(){function e(){hy(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=U6,this._completeRedirectFn=k8,this._overrideRedirectResult=g8}return vy(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return Z4(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=z8(e,t,n,j4(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},V8),{width:r.toString(),height:i.toString(),top:a,left:o}),c=zB().toLowerCase();n&&(s=U5(c)?"_blank":n),L5(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Wg(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zB();return G5(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new B8(null);var f=window.open(t||"",s,l);G4(f,e,"popup-blocked");try{f.focus()}catch(h){}return new B8(f)}(e,s,B6()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){H6().location.href=e}(z8(e,t,n,j4(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(Z4(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return U8.apply(this,arguments)}(e);case 2:return r=n.sent,i=new w8(e),n.abrupt("return",(r.register("authEvent",function(t){return G4(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(H8,{type:H8},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[H8];void 0!==i&&t(!!i),U4(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return T8.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return $5()||F5()||G5()}}]),e}(),$8="@firebase/auth",Z8=function(){function e(t){hy(this,e),this.auth=t,this.internalListeners=new Map}return vy(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){G4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){Gz(new cz("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){G4(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),G4(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Z5(e)},a=new W5(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(W4);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),Gz(new cz("auth-internal",function(e){var t=j5(e.getProvider("auth").getImmediate());return new Z8(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Kz($8,"0.20.5",void 0),Kz($8,"0.20.5","esm2017")}("Browser");var q8=vy(function e(t){return hy(this,e),t}),W8=vy(function e(){return hy(this,e),F3("auth")}),j8=new gw("angularfire2.auth-instances");function Y8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new q8(r)}}var K8={provide:W8,deps:[[new $w,j8]]},Q8={provide:q8,useFactory:function(e,t){var n=L3("auth",e,t);return n&&new q8(n)},deps:[[new $w,j8],j3]},X8=function(){var e=vy(function e(){hy(this,e),Kz("angularfire",I3.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[Q8,K8]}),e}(),J8=W3(function(e,t,n){return A6.apply(this,arguments)},!0),e7=W3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jz(),t=$z(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=$z(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(XB(n.getOptions(),null!=t?t:{}))return r;U4(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:G8,persistence:[t8,F6,U6]})},!0),t7=W3(function(e,t,n,r){return oz(e).onAuthStateChanged(t,n,r)},!0),n7=W3(function(e,t){return R6.apply(this,arguments)},!0),r7=W3(function(e,t,n){return I6.apply(this,arguments)},!0),i7=W3(function(e,t,n){return function(e,t){return O6.apply(this,arguments)}(oz(e),h6.credential(t,n))},!0),a7=W3(function(e,t,n){return f8.apply(this,arguments)},!0),o7=W3(function(e,t){return N6.apply(this,arguments)},!0),s7=vy(function e(t){return hy(this,e),t}),u7=new gw("angularfire2.firestore-instances");function c7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new s7(r)}}var l7={provide:vy(function e(){return hy(this,e),F3("firestore")}),deps:[[new $w,u7]]},f7={provide:s7,useFactory:function(e,t){var n=L3("firestore",e,t);return n&&new s7(n)},deps:[[new $w,u7],j3]},h7=function(){var e=vy(function e(){hy(this,e),Kz("angularfire",I3.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({providers:[f7,l7]}),e}(),d7=W3(function(e,t){var n=eJ(e.firestore,cJ),r=oJ(e),i=QJ(e.converter,t);return JJ(n,[EJ(_J(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Fj.exists(!1))]).then(function(){return r})},!0),v7=W3(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=oz(e),KX("collection","path",t),e instanceof nJ){var a=Gq.fromString.apply(Gq,[t].concat(r));return XX(a),new aJ(e,null,a)}if(!(e instanceof rJ||e instanceof aJ))throw new Oq(Pq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Gq.fromString.apply(Gq,[t].concat(r)));return XX(o),new aJ(e.firestore,null,o)},!0),p7=W3(function(e){return JJ(eJ(e.firestore,cJ),[new Xj(e._key,Fj.none())])},!0),g7=W3(oJ,!0),y7=W3(function(e){e=eJ(e,rJ);var t=eJ(e.firestore,cJ);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Tq;return e.asyncQueue.enqueueAndForget(PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new FX({next:function(a){t.enqueueAndForget(function(){return WQ(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new Oq(Pq.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new Oq(Pq.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new XQ(uj(n.path),a,{includeMetadataChanges:!0,Du:!0});return ZQ(e,o)},i.next=3,WX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(lJ(t),e._key).then(function(n){return e1(t,e,n)})},!0),m7=W3(function(e){e=eJ(e,iJ);var t=eJ(e.firestore,cJ),n=lJ(t),r=new XJ(t);return GJ(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Tq;return e.asyncQueue.enqueueAndForget(PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new FX({next:function(n){t.enqueueAndForget(function(){return WQ(e,o)}),n.fromCache&&"server"===r.source?i.reject(new Oq(Pq.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new XQ(n,a,{includeMetadataChanges:!0,Du:!0});return ZQ(e,o)},i.next=3,WX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new zJ(t,r,e,n)})},!0),k7=W3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jz();return $z(e,"firestore").getImmediate()},!0),C7=W3(function(e){return function(e,t){if(t<=0)throw new Oq(Pq.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new WJ("limit",e,"F")},!0),w7=W3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=oz(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||uJ(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(uJ(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof rJ)l=eJ(e.firestore,cJ),f=uj(e._key.path),c={next:function(t){n[u]&&n[u](e1(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=eJ(e,iJ);l=eJ(v.firestore,cJ),f=v._query;var p=new XJ(l);c={next:function(e){n[u]&&n[u](new zJ(l,p,v,e))},error:n[u+1],complete:n[u+2]},GJ(e._query)}return function(e,t,n,r){var i=new FX(r),a=new XQ(t,i,n);return e.asyncQueue.enqueueAndForget(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=ZQ,t.next=3,WX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=WQ,t.next=3,WX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(lJ(l),f,h,c)},!0),_7=W3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=FJ("orderBy",e);return new qJ(r,n)},!0),E7=W3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),b7=W3(function(e,t,n){e=eJ(e,rJ);var r=eJ(e.firestore,cJ),i=QJ(e.converter,t,n);return JJ(r,[EJ(_J(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Fj.none())])},!0),S7=W3(function(e,t,n){e=eJ(e,rJ);for(var r,i=eJ(e.firestore,cJ),a=_J(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=oz(t))||t instanceof hJ?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[AJ(t,r,n)],u=[i];if(a.length%2!=0)throw new Oq(Pq.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(AJ(t,a[c])),u.push(a[c+1]);for(var l=[],f=VW.empty(),h=s.length-1;h>=0;--h)if(!NJ(l,s[h])){var d=s[h],v=u[h];v=oz(v);var p=o.ia(d);if(v instanceof bJ)l.push(d);else{var g=PJ(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new lW(l);return new mJ(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);IJ("Data must be an object, but it was:",i,r);var a=[],o=VW.empty();rW(r,function(e,r){var s=MJ(t,e,n);r=oz(r);var u=i.ia(s);if(r instanceof bJ)a.push(s);else{var c=PJ(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new lW(a);return new mJ(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),JJ(i,[r.toMutation(e._key,Fj.exists(!0))])},!0),P7=W3(function(e,t,n){var r=t,i=FJ("where",e);return new ZJ(i,r,n)},!0),O7=function(){var e=function(){function e(t,n){hy(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=v7(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return vy(e,[{key:"create",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,d7(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,y7(g7(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?MB.of(OB.getNonNullable(i.data())):MB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(TB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),S7(g7(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return TB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),p7(g7(this.collection,t))}},{key:"set",value:function(t,n){return TB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),b7(g7(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return new dy(w7(g7(this.collection,e),function(e){t(MB.ofNullable(e.data()))}))}},{key:"findWhere",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,m7(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;TB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return new dy(w7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(TB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(TB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(TB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))}))}},{key:"constructQuery",value:function(e,t,n){var r=E7(this.collection);null!=t&&(r=E7(r,_7(t))),null!=n&&(r=E7(r,C7(n)));var i,a=cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=E7(r,P7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,r,e)}return vy(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),T7=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),r=t.call(this,"chats",e),TB(n.VERBOSE,"ChatDAO.constructor"),r}return vy(n)}(O7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(s7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),I7=function(){var n=vy(function e(){hy(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=Gg(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=Gg(["This message is forbidden."])))},n}(),A7=function(){var e=function(){function e(t){hy(this,e),this.chatDAO=t,TB(e.VERBOSE,"ChatService.constructor")}return vy(e,[{key:"addMessage",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}},{key:"deleteChat",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(TB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!1!==i.userCanSendMessage(t.name,e)){a.next=2;break}return a.abrupt("return",LB.failure(I7.CANNOT_SEND_MESSAGE()));case 2:if(!i.isForbiddenMessage(n)){a.next=4;break}return a.abrupt("return",LB.failure(I7.FORBIDDEN_MESSAGE()));case 4:return o={content:n,sender:t,postedTime:t1(),currentTurn:r},a.next=7,i.addMessage(e,o);case 7:return a.abrupt("return",LB.SUCCESS);case 8:case"end":return a.stop()}},a)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(T7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),R7=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,"errors",e)}return vy(n)}(O7);return e.\u0275fac=function(t){return new(t||e)(Lw(s7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),M7=Yg(5378),x7=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,M7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),N7=function(){function e(t,n,r){hy(this,e),this.errorDAO=t,this.router=n,this.messageDisplayer=r,e.setSingletonInstance(this)}return vy(e,[{key:"findErrors",value:function(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}},{key:"logError",value:function(e,t,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(n||(n=Gg(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.findErrors(e,o,t,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:e,route:o,message:t,firstEncounter:t1(),lastEncounter:t1(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:t1(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=MB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),LB.failure(e+": "+t)}}]),e}();function D7(e,t){if(!1===e)throw N7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}N7.singleton=MB.empty(),N7.\u0275fac=function(e){return new(e||N7)(Lw(R7),Lw(pF),Lw(x7))},N7.\u0275prov=Nm({token:N7,factory:N7.\u0275fac,providedIn:"root"});var L7=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),r=t.call(this,n.COLLECTION_NAME,e),TB(n.VERBOSE,"UserDAO.constructor"),r}return vy(n)}(O7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Lw(s7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),F7=function(){var e=function(){function e(t){hy(this,e),this.userDAO=t}return vy(e,[{key:"usernameIsAvailable",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.userDAO.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",MB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",(D7(null!=i,"should not receive a lastUpdateTime equal to null"),MB.of(i)));case 7:case"end":return n.stop()}},n)}))()}},{key:"updatePresenceToken",value:function(e){return this.userDAO.update(e,{lastUpdateTime:t1()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(L7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),U7=function(e){ey(n,e);var t=ny(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b3;return hy(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return vy(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),Xg(oy(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(zy),V7=function(){function e(){hy(this,e)}return vy(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return J8(e,t,n)}},{key:"sendEmailVerification",value:function(e){return n7(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return r7(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i7(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a7(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return o7(e,t)}}]),e}(),B7=function(){function e(t,n,r,i){hy(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return vy(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();B7.NOT_CONNECTED=new B7("",MB.empty(),MB.empty(),!1);var z7=function(){var e=function(){function e(t,n,r){hy(this,e);var i,a=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=MB.empty(),this.userSubscription=new dy,TB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new U7(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new dy(t7(this.auth,(i=PB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(TB(e.VERBOSE,"User is not connected"),a.userSubscription.unsubscribe(),a.userRS.next(B7.NOT_CONNECTED),a.user=MB.empty()):(D7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),a.userSubscription=a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;TB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userService.markAsVerified(n.uid);var o=new B7(n.uid,MB.ofNullable(n.email),MB.ofNullable(r),i);a.user=MB.of(o),a.userRS.next(o)}}));case 1:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)})))}return vy(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,V7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",LB.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",LB.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return PB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return TB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userService.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=xB.failure($localize(r||(r=Gg(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,V7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,V7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=OB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",xB.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",xB.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=Gg(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=Gg(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=Gg(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=Gg(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=Gg(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=Gg(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=Gg(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(f||(f=Gg(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return N7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(TB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=MB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",N7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",N7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,V7.sendEmailVerification(r.get());case 9:return n.abrupt("return",LB.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",LB.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return TB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,V7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",LB.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",LB.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=LB,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new p6).addScope("profile"),n.addScope("email"),t.next=5,V7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",xB.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",xB.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!MB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=LB.SUCCESS,t.next=7;break;case 6:t.t0=LB.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"subscribeToUser",value:function(e){return this.userObs.subscribe(e)}},{key:"setUsername",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",LB.failure($localize(h||(h=Gg(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userService.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",LB.failure($localize(d||(d=Gg(["This username is already in use, please select a different one."])))));case 9:return r=OB.getNonNullable(t.auth.currentUser),n.next=12,V7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userService.setUsername(r.uid,e);case 14:return n.next=16,t.userService.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",LB.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",LB.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=OB.getNonNullable(t.auth.currentUser),n.next=4,V7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",LB.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",LB.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=OB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return D7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return D7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return D7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(L7),Lw(F7),Lw(q8))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),H7=vy(function e(t){hy(this,e),this.value=t});H7.HARD_DRAW=new H7(0),H7.RESIGN=new H7(1),H7.ESCAPE=new H7(2),H7.VICTORY=new H7(3),H7.TIMEOUT=new H7(4),H7.UNACHIEVED=new H7(5),H7.AGREED_DRAW_BY_ZERO=new H7(6),H7.AGREED_DRAW_BY_ONE=new H7(7);var G7=function(){function e(t,n){hy(this,e),this.id=t,this.data=n}return vy(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===H7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===H7.AGREED_DRAW_BY_ZERO.value||this.data.result===H7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===H7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(D7(this.data.result===H7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),OB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===H7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===H7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===H7.RESIGN.value}},{key:"getWinner",value:function(){return MB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return MB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Zg(Zg({},this.data),{},{winner:t,loser:n}))}}]),e}(),$7=function(){function e(t){hy(this,e),this.value=t}return vy(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return D7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();$7.CREATOR=new $7("CREATOR"),$7.RANDOM=new $7("RANDOM"),$7.CHOSEN_PLAYER=new $7("CHOSEN_PLAYER");var Z7=function(){function e(t){hy(this,e),this.value=t}return vy(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();Z7.STANDARD=new Z7("STANDARD"),Z7.BLITZ=new Z7("BLITZ"),Z7.CUSTOM=new Z7("CUSTOM"),Z7.NORMAL_MOVE_DURATION=120,Z7.NORMAL_PART_DURATION=1800,Z7.BLITZ_MOVE_DURATION=30,Z7.BLITZ_PART_DURATION=900;var q7=vy(function e(t){hy(this,e),this.value=t});q7.PART_CREATED=new q7(0),q7.CONFIG_PROPOSED=new q7(2),q7.PART_STARTED=new q7(3),q7.PART_FINISHED=new q7(4);var W7=vy(function e(){hy(this,e)}),j7=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return D7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){ey(s,n);var o=ny(s);function s(){return hy(this,s),o.apply(this,arguments)}return vy(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=OB.getNonNullable(n).type,a=OB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(W7),Y7=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return D7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){ey(a,n);var i=ny(a);function a(){return hy(this,a),i.apply(this,arguments)}return vy(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){ey(a,n);var i=ny(a);function a(){return hy(this,a),i.apply(this,arguments)}return vy(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){ey(a,n);var i=ny(a);function a(){return hy(this,a),i.apply(this,arguments)}return vy(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){ey(r,t);var n=ny(r);function r(){return hy(this,r),n.apply(this,arguments)}return vy(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(j7);Y7.booleanEncoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(Y7));var K7=function(){function e(){hy(this,e),this.value=2}return vy(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PLAYER_NONE"}},{key:"equals",value:function(e){return this===e}}]),e}();K7.NONE=new K7;var Q7,X7=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return this===e.ZERO?"PLAYER_ZERO":(OB.expectToBe(this,e.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(OB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(OB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();X7.numberEncoder=Y7.ofN(2,function(e){return e.value},function(e){return 2===e?Q7.NONE:X7.of(e)}),X7.ZERO=new X7(0),X7.ONE=new X7(1),X7.PLAYERS=[X7.ZERO,X7.ONE],function(e){e.ZERO=X7.ZERO,e.ONE=X7.ONE,e.NONE=K7.NONE}(Q7||(Q7={}));var J7=function(){function e(){hy(this,e)}return vy(e,null,[{key:"rematchAccepted",value:function(e,t){return e9("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return X7.of(OB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return OB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return OB.getNonNullable(e.data).partId}}]),e}();function e9(e,t){return{code:e,data:t}}function t9(e){return function(t){return e9(e,{player:t.value})}}J7.drawProposed=t9("DrawProposed"),J7.drawAccepted=e9("DrawAccepted",{}),J7.drawRefused=t9("DrawRefused"),J7.takeBackAsked=t9("TakeBackAsked"),J7.takeBackRefused=t9("TakeBackRefused"),J7.takeBackAccepted=t9("TakeBackAccepted"),J7.rematchProposed=t9("RematchProposed"),J7.addTurnTime=t9("AddTurnTime"),J7.addGlobalTime=t9("AddGlobalTime");var n9=function(){function e(){hy(this,e)}return vy(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===RB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),r9=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),r=t.call(this,"parts",e),TB(n.VERBOSE,"PartDAO.constructor"),r}return vy(n)}(O7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(s7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),i9=vy(function e(t,n,r){hy(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),a9=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),r=t.call(this,"config-room",e),TB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return vy(n)}(O7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(s7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),o9=function(){var e=function(){function e(t,n){hy(this,e),this.configRoomDAO=t,this.connectedUserService=n,TB(e.VERBOSE,"ConfigRoomService.constructor")}return vy(e,[{key:"addCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}},{key:"subscribeToChanges",value:function(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new i9(function(e){var r,i=cy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=cy(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=cy(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}},{key:"createInitialConfigRoom",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:$7.RANDOM.value,partType:Z7.STANDARD.value,partStatus:q7.PART_CREATED.value,maximalMoveDuration:Z7.NORMAL_MOVE_DURATION,totalPartDuration:Z7.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=LB.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.addCandidate(t,i);case 13:r.t0=LB.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"cancelJoining",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"ConfigRoomService.cancelJoining(".concat(t,")")),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if((a=r.sent).isAbsent()){r.next=10;break}return s=a.get(),u=[n.removeCandidate(t,i)],(null===(o=s.chosenOpponent)||void 0===o?void 0:o.id)===i.id&&u.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:q7.PART_CREATED.value})),r.next=10,Promise.all(u);case 10:case"end":return r.stop()}},r)}))()}},{key:"deleteConfigRoom",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return TB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(".concat(t)),i.next=3,Promise.all(n.map(function(e){return r.removeCandidate(t,e)}));case 3:return i.next=5,r.configRoomDAO.delete(t);case 5:case"end":return i.stop()}},i)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a,o){var s=this;return PB(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(TB(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:a,totalPartDuration:o}}),s.configRoomDAO.update(t,{partStatus:q7.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:a.value})));case 1:case"end":return u.stop()}},u)}))()}},{key:"setChosenOpponent",value:function(t,n){return TB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t,", ").concat(n.name,")")),this.configRoomDAO.update(t,{chosenOpponent:n})}},{key:"reviewConfig",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(TB(e.VERBOSE,"ConfigRoomService.reviewConfig(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:q7.PART_CREATED.value})));case 1:case"end":return r.stop()}},r)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(TB(e.VERBOSE,"ConfigRoomService.reviewConfigAndRemoveChosenOpponent(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:q7.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t){return TB(e.VERBOSE,"ConfigRoomService.acceptConfig(".concat(t)),this.configRoomDAO.update(t,{partStatus:q7.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(TB(e.VERBOSE,"ConfigRoomService.create(".concat(t)+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"ConfigRoomService.readConfigRoomById(".concat(t,")")),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(v||(v=Gg(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(Lw(a9),Lw(z7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),s9=function(){var e=function(){function e(t,n,r,i){hy(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,TB(e.VERBOSE,"GameService.constructor")}return vy(e,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Zg(Zg({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.partDAO.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"getPartValidity",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?LB.failure("NONEXISTENT_PART"):i.get().typeGame===t?LB.SUCCESS:LB.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){TB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:H7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return TB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){TB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=$7.of(e.firstPlayer);return r===$7.RANDOM&&(r=Math.random()<.5?$7.CREATOR:$7.CHOSEN_PLAYER),r===$7.CREATOR?(t=e.creator,n=OB.getNonNullable(e.chosenOpponent)):(t=OB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:t1(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return TB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return TB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig(t);case 3:return i.abrupt("return",r.startGameWithConfig(t,X7.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"subscribeToChanges",value:function(e,t){return this.partDAO.subscribeToChanges(e,t)}},{key:"resign",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:H7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:H7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,J7.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===X7.ZERO?H7.AGREED_DRAW_BY_ZERO:H7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,J7.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,J7.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return TB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=OB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=OB.getNonNullable(o.playerOne),u=$7.CHOSEN_PLAYER):(l=o.playerZero,u=$7.CREATOR),f=Zg(Zg({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:q7.PART_STARTED.value}),h=i.getStartingConfig(f),d=Zg({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:H7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,J7.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,J7.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return D7(J7.getPlayer(OB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=J7.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:t1(),remainingMsForZero:OB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:OB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=J7.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:J7.addGlobalTime(r.getOpponent())},o=r===X7.ZERO?Zg(Zg({},o),{},{remainingMsForOne:OB.getNonNullable(n.remainingMsForOne)+3e5}):Zg(Zg({},o),{},{remainingMsForZero:OB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:J7.addTurnTime(e.getOpponent())},i.next=3,r.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return PB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return TB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=n9.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:t1()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=Zg(Zg({},p),{},{winner:s,loser:u,result:H7.VICTORY.value}):!0===o&&(p=Zg(Zg({},p),{},{result:H7.HARD_DRAW.value})),l.next=14,c.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Zg(Zg({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Zg(Zg({},e),{},{remainingMsForZero:OB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Zg(Zg({},e),{},{remainingMsForOne:OB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(r9),Lw(z7),Lw(o9),Lw(A7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),u9={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},c9={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},l9={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},f9=function(){function e(){hy(this,e)}return vy(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),h9=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return MB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return f9.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),d9=function(){var e=function(){function e(t,n){hy(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return vy(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return MB.of(t)}return MB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(XI),Lw(h9))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),v9={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},p9={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},g9={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},y9={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},m9={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},k9={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},C9={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function w9(e){return(w9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){_9(e,t,n[t])})}return e}function b9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var S9={},P9={};try{"undefined"!=typeof window&&(S9=window),"undefined"!=typeof document&&(P9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(zme){}var O9=(S9.navigator||{}).userAgent,T9=void 0===O9?"":O9,I9=S9,A9=P9,R9=!!A9.documentElement&&!!A9.head&&"function"==typeof A9.addEventListener&&"function"==typeof A9.createElement,M9=(~T9.indexOf("MSIE")||T9.indexOf("Trident/"),"___FONT_AWESOME___"),x9="svg-inline--fa",N9=[1,2,3,4,5,6,7,8,9,10],D9=N9.concat([11,12,13,14,15,16,17,18,19,20]),L9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},F9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",L9.GROUP,L9.SWAP_OPACITY,L9.PRIMARY,L9.SECONDARY].concat(N9.map(function(e){return"".concat(e,"x")})).concat(D9.map(function(e){return"w-".concat(e)})),I9.FontAwesomeConfig||{});A9&&"function"==typeof A9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=b9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=A9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(F9[n]=r)});var U9=E9({},{familyPrefix:"fa",replacementClass:x9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},F9);U9.autoReplaceSvg||(U9.observeMutations=!1);var V9=E9({},U9);I9.FontAwesomeConfig=V9;var B9=I9||{};B9[M9]||(B9[M9]={}),B9[M9].styles||(B9[M9].styles={}),B9[M9].hooks||(B9[M9].hooks={}),B9[M9].shims||(B9[M9].shims=[]);var z9=B9[M9],H9=[];R9&&((A9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(A9.readyState)||A9.addEventListener("DOMContentLoaded",function e(){A9.removeEventListener("DOMContentLoaded",e),H9.map(function(e){return e()})}));var G9,$9="pending",Z9="fulfilled",q9="rejected",W9=function(){},j9="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Y9="undefined"==typeof setImmediate?setTimeout:setImmediate,K9=[];function Q9(){for(var e=0;e<K9.length;e++)K9[e][0](K9[e][1]);K9=[],G9=!1}function X9(e,t){K9.push([e,t]),G9||(G9=!0,Y9(Q9,0))}function J9(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=Z9;try{r=i(r)}catch(o){ree(a,o)}}eee(a,r)||(n===Z9&&tee(a,r),n===q9&&ree(a,r))}function eee(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===w9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?nee(e,r):tee(e,r))},function(t){n||(n=!0,ree(e,t))}),!0}}catch(i){return n||ree(e,i),!0}return!1}function tee(e,t){(e===t||!eee(e,t))&&nee(e,t)}function nee(e,t){e._state===$9&&(e._state="settled",e._data=t,X9(aee,e))}function ree(e,t){e._state===$9&&(e._state="settled",e._data=t,X9(oee,e))}function iee(e){e._then=e._then.forEach(J9)}function aee(e){e._state=Z9,iee(e)}function oee(e){e._state=q9,iee(e),!e._handled&&j9&&global.process.emit("unhandledRejection",e._data,e)}function see(e){global.process.emit("rejectionHandled",e)}function uee(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof uee))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){ree(t,e)}try{e(function(e){tee(t,e)},n)}catch(r){n(r)}}(e,this)}uee.prototype={constructor:uee,_state:$9,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(W9),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===q9&&j9&&X9(see,this)),this._state===Z9||this._state===q9?X9(J9,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},uee.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new uee(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},uee.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new uee(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},uee.resolve=function(e){return e&&"object"===w9(e)&&e.constructor===uee?e:new uee(function(t){t(e)})},uee.reject=function(e){return new uee(function(t,n){n(e)})};var cee={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function lee(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function fee(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hee(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function dee(e){return e.size!==cee.size||e.x!==cee.x||e.y!==cee.y||e.rotate!==cee.rotate||e.flipX||e.flipY}function vee(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var pee={x:0,y:0,width:"100%",height:"100%"};function gee(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function yee(e){return"g"===e.tag?e.children:[e]}function mee(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[V9.replacementClass,a?"".concat(V9.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:E9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||lee())},children:[u]});var _=E9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:E9({},w,f.styles)}),E=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=vee({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:E9({},pee,{fill:"white"})},l=o.children?{children:o.children.map(gee)}:{},f={tag:"g",attributes:E9({},u.inner),children:[gee(E9({tag:o.tag,attributes:E9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:E9({},u.outer),children:[f]},d="mask-".concat(a||lee()),v="clip-".concat(a||lee()),p={tag:"mask",attributes:E9({},pee,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:yee(s)},p]};return t.push(g,{tag:"rect",attributes:E9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},pee)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=hee(e.styles);if(a.length>0&&(n.style=a),dee(i)){var o=vee({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:E9({},o.outer),children:[{tag:"g",attributes:E9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:E9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),b=E.attributes;return _.children=E.children,_.attributes=b,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:E9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(V9.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(dee(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=hee(E9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var kee=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function Cee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof z9.hooks.addPack||i?z9.styles[e]=E9({},z9.styles[e]||{},a):z9.hooks.addPack(e,a),"fas"===e&&Cee("fa",t)}var wee=z9.styles,_ee=z9.shims,Eee=function(){var e=function(e){return kee(wee,function(t,n,r){return t[r]=kee(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in wee;kee(_ee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function bee(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function See(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?fee(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(fee(e[n]),'" ')},"").trim()}(r),">").concat(a.map(See).join(""),"</").concat(t,">")}function Pee(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}Eee(),(Pee.prototype=Object.create(Error.prototype)).constructor=Pee;var Oee={fill:"currentColor"},Tee={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Iee=(E9({},Oee,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),E9({},Tee,{attributeName:"opacity"}));function Aee(e){var t=e[0],n=e[1],r=b9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(V9.familyPrefix,"-").concat(L9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(V9.familyPrefix,"-").concat(L9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(V9.familyPrefix,"-").concat(L9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}E9({},Oee,{cx:"256",cy:"364",r:"28"}),E9({},Tee,{attributeName:"r",values:"28;14;28;28;14;28;"}),E9({},Iee,{values:"1;0;1;1;0;1;"}),E9({},Oee,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),E9({},Iee,{values:"1;0;0;0;0;1;"}),E9({},Oee,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),E9({},Iee,{values:"0;0;1;1;0;0;"});var Ree=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=E9({},e.definitions[t]||{},i[t]),Cee(t,i[t]),Eee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function Mee(){V9.autoAddCss&&!Lee&&(function(e){if(e&&R9){var t=A9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=A9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}A9.head.insertBefore(t,r)}}(function(){var e="fa",t=x9,n=V9.familyPrefix,r=V9.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Lee=!0)}function xee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return See(e)})}}),Object.defineProperty(e,"node",{get:function(){if(R9){var t=A9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Nee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return bee(Dee.definitions,n,r)||bee(z9.styles,n,r)}var Dee=new Ree,Lee=!1,Fee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Nee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Nee(i||{})),e(r,E9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?cee:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return xee(E9({type:"icon"},e),function(){return Mee(),V9.autoA11y&&(f?y["aria-labelledby"]="".concat(V9.replacementClass,"-title-").concat(d||lee()):(y["aria-hidden"]="true",y.focusable="false")),mee({icons:{main:Aee(_),mask:s?Aee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:E9({},cee,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Uee=["*"],Vee=function(e){var t,n=(qg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),qg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),qg(t,"fa-pull-".concat(e.pull),null!==e.pull),qg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Bee=function(){var e=vy(function e(){hy(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),zee=function(){var e=function(){function e(){hy(this,e),this.definitions={}}return vy(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=cy(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,sy(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Hee=function(){var e=function(){function e(){hy(this,e),this.stackItemSize="1x"}return vy(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=gk({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Ik]}),e}(),Gee=function(){var e=function(){function e(t,n){hy(this,e),this.renderer=t,this.elementRef=n}return vy(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(MO),mS(IO))},e.\u0275cmp=lk({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Ik],ngContentSelectors:Uee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Jk()[16][6];if(!t.projection)for(var n=t.projection=Ew(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Jk(),i=eC(),a=qE(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),sC(),64!=(64&a.flags)&&function(e,t,n){wE(t[11],0,t,n,rE(e,n,t),cE(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),$ee=function(){var e=function(){function e(t,n,r,i,a){hy(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return vy(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(sy(Vee(e)),sy(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Fee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(zR),mS(Bee),mS(zee),mS(Hee,8),mS(Gee,8))},e.\u0275cmp=lk({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(cP("innerHTML",t.renderedIconHTML,T_),fS("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Ik],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Zee=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e}),e.\u0275inj=Dm({}),e}();function qee(e,t){if(1&e&&(bS(0),ES(1,"fa-icon",24),SS()),2&e){var n=MS();LE(1),kS("icon",n.faSpinner)}}function Wee(e,t){if(1&e){var n=PS();bS(0),wS(1,"div",9),wS(2,"a",10),iP(3),_S(),wS(4,"div",12),wS(5,"a",26),IS("click",function(){return tC(n),MS(2).logout()}),hO(6,27),_S(),_S(),_S(),SS()}if(2&e){var r=MS(2);LE(3),aP(r.username.get())}}var jee=function(){return["/register"]},Yee=function(){return["/login"]};function Kee(e,t){1&e&&(wS(0,"div",28),wS(1,"a",29),wS(2,"strong"),hO(3,30),_S(),_S(),wS(4,"a",31),hO(5,32),_S(),_S()),2&e&&(LE(1),kS("routerLink",PT(2,jee)),LE(3),kS("routerLink",PT(3,Yee)))}function Qee(e,t){if(1&e&&(gS(0,Wee,7,1,"ng-container",22),gS(1,Kee,6,4,"ng-template",null,25,JT)),2&e){var n=yS(2);kS("ngIf",MS().username.isPresent())("ngIfElse",n)}}var Xee=function(){return["/"]},Jee=function(){return["/play"]},ete=function(){return["/lobby"]},tte=function(){return["/local"]},nte=function(){return["/tutorial"]},rte=function(){return["/settings"]},ite=function(){var e=function(){function e(t,n,r){hy(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=MB.empty(),this.faCog=p9,this.faSpinner=C9,this.showMenu=!1}return vy(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.subscribeToUser(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(z7),mS(F7))},e.\u0275cmp=lk({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(p||(p=Gg(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(g||(g=Gg(["Play online"]))),[1,"navbar-dropdown"],$localize(y||(y=Gg(["Create a game"]))),$localize(m||(m=Gg(["Join a game"]))),$localize(k||(k=Gg(["Play offline"]))),$localize(C||(C=Gg(["Create a game"]))),$localize(w||(w=Gg(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(_||(_=Gg(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=Gg(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(b||(b=Gg(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(S||(S=Gg(["Log in"])))]},template:function(e,t){if(1&e&&(wS(0,"nav",0),wS(1,"div",1),wS(2,"a",2),ES(3,"img",3),_S(),wS(4,"a",4),IS("click",function(){return t.showMenu=!t.showMenu}),ES(5,"span",5),ES(6,"span",5),ES(7,"span",5),_S(),_S(),wS(8,"div",6),IS("click",function(){return t.showMenu=!t.showMenu}),wS(9,"div",7),wS(10,"a",2),hO(11,8),_S(),wS(12,"div",9),wS(13,"a",10),hO(14,11),_S(),wS(15,"div",12),wS(16,"a",2),hO(17,13),_S(),wS(18,"a",2),hO(19,14),_S(),_S(),_S(),wS(20,"div",9),wS(21,"a",10),hO(22,15),_S(),wS(23,"div",12),wS(24,"a",2),hO(25,16),_S(),wS(26,"a",2),hO(27,17),_S(),_S(),_S(),_S(),wS(28,"div",18),wS(29,"a",19),ES(30,"fa-icon",20),_S(),wS(31,"div",21),gS(32,qee,2,1,"ng-container",22),gS(33,Qee,3,2,"ng-template",null,23,JT),_S(),_S(),_S(),_S()),2&e){var n=yS(34);LE(2),kS("routerLink",PT(12,Xee)),LE(2),kS("ngClass",t.showMenu?"is-active":""),LE(4),kS("ngClass",t.showMenu?"is-active":""),LE(2),kS("routerLink",PT(13,Xee)),LE(6),kS("routerLink",PT(14,Jee)),LE(2),kS("routerLink",PT(15,ete)),LE(6),kS("routerLink",PT(16,tte)),LE(2),kS("routerLink",PT(17,nte)),LE(3),kS("routerLink",PT(18,rte)),LE(1),kS("icon",t.faCog),LE(2),kS("ngIf",t.loading)("ngIfElse",n)}},directives:[mF,tR,$ee,aR],encapsulation:2}),e}(),ate=function(){var e=vy(function e(t,n){hy(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=l9,this.faFacebook=u9,this.faGithub=c9});return e.\u0275fac=function(t){return new(t||e)(mS(d9),mS(N7))},e.\u0275cmp=lk({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(P||(P=Gg(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(ES(0,"app-header"),wS(1,"main",0),ES(2,"router-outlet"),_S(),wS(3,"footer",1),wS(4,"div",2),wS(5,"p"),wS(6,"span"),lO(7,3),ES(8,"strong"),fO(),_S(),iP(9," \xa0 "),wS(10,"a",4),ES(11,"fa-icon",5),_S(),iP(12,"\xa0 "),wS(13,"a",6),ES(14,"fa-icon",5),_S(),iP(15,"\xa0 "),wS(16,"a",7),ES(17,"fa-icon",5),_S(),_S(),_S(),_S()),2&e&&(LE(11),kS("icon",t.faGithub),LE(3),kS("icon",t.faTwitter),LE(3),kS("icon",t.faFacebook))},directives:[ite,CF,$ee],encapsulation:2}),e}(),ote=function(){function e(t,n){hy(this,e),this.x=t,this.y=n}return vy(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),ste=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(ote),ute=function(){function e(){hy(this,e)}return vy(e,[{key:"of",value:function(e,t){var n,r=cy(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return xB.success(i)}}catch(a){r.e(a)}finally{r.f()}return xB.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?xB.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):xB.failure(fte.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return xB.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return xB.failure("Invalid int direction: ".concat(e))}}}]),e}(),cte=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ste);cte.UP=new cte(0,-1),cte.UP_RIGHT=new cte(1,-1),cte.RIGHT=new cte(1,0),cte.DOWN_RIGHT=new cte(1,1),cte.DOWN=new cte(0,1),cte.DOWN_LEFT=new cte(-1,1),cte.LEFT=new cte(-1,0),cte.UP_LEFT=new cte(-1,-1),cte.factory=new(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).all=[cte.UP,cte.UP_RIGHT,cte.RIGHT,cte.DOWN_RIGHT,cte.DOWN,cte.DOWN_LEFT,cte.LEFT,cte.UP_LEFT],e}return vy(n)}(ute)),cte.DIRECTIONS=cte.factory.all,cte.DIAGONALS=[cte.UP_RIGHT,cte.DOWN_RIGHT,cte.DOWN_LEFT,cte.UP_LEFT],cte.ORTHOGONALS=[cte.UP,cte.RIGHT,cte.DOWN,cte.LEFT],cte.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return D7("string"==typeof e,"Invalid encoded direction"),cte.factory.fromString(e).get()}}]),n}(W7));var lte=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ste);lte.UP=new lte(0,-1),lte.RIGHT=new lte(1,0),lte.DOWN=new lte(0,1),lte.LEFT=new lte(-1,0),lte.factory=new(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).all=[lte.UP,lte.RIGHT,lte.DOWN,lte.LEFT],e}return vy(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?xB.success(lte.UP):1===e&&0===t?xB.success(lte.RIGHT):0===e&&1===t?xB.success(lte.DOWN):-1===e&&0===t?xB.success(lte.LEFT):xB.failure("Invalid orthogonal from x and y")}}]),n}(ute)),lte.ORTHOGONALS=lte.factory.all,lte.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return D7("string"==typeof e,"Invalid encoded orthogonal"),lte.factory.fromString(e).get()}}]),n}(W7));var fte=function(){var e=vy(function e(){hy(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(O||(O=Gg(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),hte=function(){function e(t,n){hy(this,e),this.x=t,this.y=n}return vy(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return cte.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return Y7.tuple([Y7.numberEncoder(t),Y7.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();hte.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new hte(t.x,t.y)}}]),n}(W7));var dte=function(){var e=function(){function e(t){hy(this,e),this.messageDisplayer=t,this.Player=X7,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=MB.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}return vy(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?LB.SUCCESS:(this.messageDisplayer.gameMessage(e),LB.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case X7.ZERO:return"player0";case X7.ONE:return"player1";default:return OB.expectToBe(e,Q7.NONE),""}}},{key:"pass",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",N7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),vte=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new hte(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=cy(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new hte(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(dte);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275cmp=lk({type:t,selectors:[["ng-component"]],features:[Xb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),pte=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===X7.ZERO?e.ZERO:(OB.expectToBe(t,X7.ONE),e.ONE)}}]),e}();pte.ZERO=new pte(X7.ZERO.value),pte.ONE=new pte(X7.ONE.value),pte.EMPTY=new pte(Q7.NONE.value),pte.UNREACHABLE=new pte(3);var gte=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return OB.expectToBe(e,n.LEFT),300}}}]),n}(ste);gte.UP=new gte(0,-1),gte.LEFT=new gte(-1,0),gte.UP_RIGHT=new gte(1,-1),gte.DOWN_LEFT=new gte(-1,1),gte.RIGHT=new gte(1,0),gte.DOWN=new gte(0,1),gte.factory=new(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).all=[gte.UP,gte.UP_RIGHT,gte.RIGHT,gte.DOWN,gte.DOWN_LEFT,gte.LEFT],e}return vy(n)}(ute)),gte.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case gte.UP:return 0;case gte.UP_RIGHT:return 1;case gte.RIGHT:return 2;case gte.DOWN:return 3;case gte.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return D7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),gte.factory.all[e]}}]),n}(Y7));var yte=function(){function e(t,n,r){hy(this,e),this.size=t,this.origin=n,this.orientation=r}return vy(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new hte(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new hte(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new hte(t.x+i.x,t.y+i.y))}return n}}]),e}(),mte=vy(function e(){hy(this,e)}),kte=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return vy(n)}(mte);kte.INSTANCE=new kte;var Cte=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return vy(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(mte);Cte.INSTANCE=new Cte;var wte=function(){var e=vy(function e(){hy(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(T||(T=Gg(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(I||(I=Gg(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(A||(A=Gg(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(R||(R=Gg(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(M||(M=Gg(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(x||(x=Gg(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(N||(N=Gg(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(D||(D=Gg(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(L||(L=Gg(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(F||(F=Gg(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(U||(U=Gg(["There is a piece between the piece you chose and its landing space."])))},e}(),_te=function(){function e(t,n){hy(this,e),this.ruler=t,this.name=n}return vy(e,[{key:"toString",value:function(){return this.name}}]),e}(),Ete=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),bte=function(){function e(){hy(this,e)}return vy(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return RB(t,e)})||t.push(e)}),t}}]),e}(),Ste=function(e){function t(e){hy(this,t),this.values=void 0===e?[]:bte.toComparableSet(e)}return vy(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=cy(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=cy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=cy(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=cy(this.values);try{for(n.s();!(t=n.n()).done;){if(RB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=cy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?MB.of(this.values[0]):MB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),Pte=function(){function e(t){hy(this,e),this.turn=t}return vy(e,[{key:"getCurrentPlayer",value:function(){return X7.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?X7.ZERO:X7.ONE}}]),e}(),Ote=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,r)).board=e,i}return vy(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?MB.of(this.board[e.y][e.x]):MB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new hte(e,t))}},{key:"forEachCoord",value:function(e){var t,n=cy(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Wg(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new hte(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return n9.copyBiArray(this.board)}}]),n}(Pte),Tte=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==pte.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===pte.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===pte.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=pte.EMPTY,t=pte.UNREACHABLE,r=pte.ZERO,i=pte.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(Ote),Ite=vy(function e(){hy(this,e)}),Ate=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).coord=new hte(e,r),i}return vy(n)}(Ite),Rte=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;if(hy(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return ry(a)}return vy(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return xB.success(new n(e,t,MB.empty()))}catch(r){return xB.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];n9.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=gte.factory.fromDelta(a.x,a.y);if(o.isFailure())return xB.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?xB.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):xB.success(new n(i[1],r,MB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Ate);Rte.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=gte.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new hte(i,r);if(0===e)return Rte.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new hte(s,o);return Rte.fromDoubleCoord(a,u,n).get()}}]),n}(Y7));var Mte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(Mte||(Mte={})),Mte),xte=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];hy(this,e),this.map=t,this.isImmutable=n}return vy(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=cy(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(RB(r.key,e))return MB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return MB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=cy(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=cy(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(RB(i.key,e)){var a=i.value;return i.value=t,MB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),MB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return RB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new Ste(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=cy(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(RB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=cy(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=cy(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(D7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===RB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),Nte=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"reverse",value:function(){var e,t=new n,r=cy(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new Ste;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(xte),Dte=function(){var e=vy(function e(){hy(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),Lte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MB.empty(),i=arguments.length>3?arguments[3]:void 0;if(hy(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=MB.empty(),this.hopedValue=new xte,this.ownValue=new xte,this.possibleMoves=new xte,this.ownValue=new xte,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Dte.createdNodes++,TB(e.VERBOSE||!1,"creating "+this.myToString())}return vy(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Dte.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return TB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return TB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);D7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=MB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new Ste(n)),new Ste(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===X7.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===X7.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=cy(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===X7.ZERO?n:r))break;c===X7.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();D7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=MB.of(new e(o,MB.of(this),MB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){D7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=cy(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return MB.of(r)}}catch(i){n.e(i)}finally{n.f()}return MB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=cy(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(TB(e.VERBOSE||n,"VICTORY"),Mte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(TB(e.VERBOSE||n,"PRE_VICTORY_MIN"),Mte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(TB(e.VERBOSE||n,"PRE_VICTORY_MAX"),Mte.PRE_VICTORY):(TB(e.VERBOSE||n,"DEFAULT"),Mte.DEFAULT)}}]),e}();Lte.VERBOSE=!1,Lte.minimaxes=new xte;var Fte=function(){function e(t,n){hy(this,e),this.isEndGame=t,this.winner=n}return vy(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===X7.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===X7.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Fte.ZERO_WON=new Fte(!0,X7.ZERO),Fte.ONE_WON=new Fte(!0,X7.ONE),Fte.DRAW=new Fte(!0,Q7.NONE),Fte.ONGOING=new Fte(!1,Q7.NONE);var Ute=function(){function e(t){hy(this,e),this.stateType=t,this.setInitialBoard()}return vy(e,[{key:"choose",value:function(e){var t=!1;TB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){TB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return D7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),TB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(TB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return TB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;TB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new Lte(i,MB.of(this.node),MB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();Lte.ruler=this,this.node=new Lte(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=cy(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);D7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Vte=function(){var e=vy(function e(){hy(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(V||(V=Gg(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(B||(B=Gg(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(z||(z=Gg(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(H||(H=Gg(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(G||(G=Gg(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize($||($=Gg(["This space is not aligned with the current line."])))},e}(),Bte=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return new Tte(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?LB.failure(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===pte.ofPlayer(t.getCurrentOpponent())?LB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):LB.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=pte.ofPlayer(t.getCurrentPlayer()),o=pte.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?xB.failure(Vte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?xB.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=pte.ofPlayer(n.getCurrentOpponent()),s=pte.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?xB.failure(Vte.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===pte.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?xB.failure(Vte.CANNOT_PUSH_YOUR_OWN_PIECES()):xB.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=pte.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return xB.failure(Vte.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=pte.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return xB.failure(Vte.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===pte.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return xB.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Fte.ZERO_WON:t[1]>5?Fte.ONE_WON:Fte.ONGOING}}]),n}(Ute),zte=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new hte(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=cy(gte.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Rte.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=cy(gte.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Rte.fromDoubleCoord(o,p,c).get();Bte.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new Ste(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Bte.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Tte(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Bte.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n=e.gameState.getScores();return new Ete(n[1]-n[0])}}]),n}(_te),Hte=function(){function e(t,n,r){hy(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=MB.empty(),this.previousState=MB.empty()}return vy(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=MB.of(e),this}},{key:"withPreviousState",value:function(e){return this.previousState=MB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new $te(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new qte(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Zte(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Wte(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new jte(e,t,n)}}]),e}(),Gte=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return vy(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Hte),$te=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,D7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return vy(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Gte),Zte=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return vy(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(Gte),qte=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return vy(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Gte),Wte=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return vy(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(Gte),jte=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isInformation",value:function(){return!0}}]),n}(Hte),Yte=pte.EMPTY,Kte=pte.UNREACHABLE,Qte=pte.ZERO,Xte=pte.ONE,Jte=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Z||(Z=Gg(["Initial board and goal of the game"]))),$localize(q||(q=Gg(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Tte.getInitialState()),Hte.anyMove($localize(W||(W=Gg(["Moving a piece"]))),$localize(j||(j=Gg(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Tte.getInitialState(),Rte.fromSingleCoord(new hte(2,6),gte.UP).get(),$localize(Y||(Y=Gg(["Congratulations!"])))),Hte.fromMove($localize(K||(K=Gg(["Pushing"]))),$localize(Q||(Q=Gg(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Tte([[Kte,Kte,Kte,Kte,Yte,Qte,Qte,Xte,Xte],[Kte,Kte,Kte,Yte,Yte,Yte,Yte,Yte,Yte],[Kte,Kte,Yte,Qte,Qte,Qte,Xte,Qte,Yte],[Kte,Yte,Yte,Yte,Yte,Yte,Yte,Yte,Yte],[Yte,Yte,Yte,Yte,Qte,Qte,Qte,Xte,Xte],[Yte,Yte,Yte,Yte,Yte,Yte,Yte,Yte,Kte],[Yte,Yte,Yte,Yte,Qte,Xte,Yte,Kte,Kte],[Yte,Yte,Yte,Qte,Yte,Yte,Kte,Kte,Kte],[Yte,Yte,Qte,Yte,Yte,Kte,Kte,Kte,Kte]],0),[Rte.fromSingleCoord(new hte(4,4),gte.RIGHT).get()],$localize(X||(X=Gg(["Congratulations! You know everything you need to start a game!"]))),$localize(J||(J=Gg(["Failed!"]))))]});function ene(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",6),IS("click",function(){tC(n);var e=MS(2).index,t=MS().index;return MS().onPieceClick(e,t)}),_S()}if(2&e){var r=MS(2).index,i=MS().index,a=MS();DS("id","piece_",r,"_",i,""),kS("ngClass",a.getPieceClasses(r,i)),fS("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function tne(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"polygon",4),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onSpaceClick(e,t)}),_S(),gS(2,ene,1,6,"circle",5),_S()}if(2&e){var r=MS(),i=r.index,a=r.$implicit,o=MS().index,s=MS();LE(1),DS("id","space_",i,"_",o,""),kS("ngClass",s.getSquareClasses(i,o)),fS("points",s.getHexaCoordsBy(i,o)),LE(1),kS("ngIf",s.isPiece(a))}}function nne(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,tne,3,5,"g",3),_S()),2&e){var n=t.$implicit,r=MS(2);LE(1),kS("ngIf",r.isBoard(n))}}function rne(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,nne,2,1,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function ine(e,t){1&e&&(AC(),wS(0,"marker",7),ES(1,"polygon",8),_S()),2&e&&NS("id","arrowhead_",t.$implicit.dir.toString(),"")}function ane(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),ES(1,"line",9),wS(2,"line",10),IS("click",function(){var e=tC(n).$implicit;return MS().chooseDirection(e.dir)}),_S(),wS(3,"polygon",11),IS("click",function(){var e=tC(n).$implicit;return MS().chooseDirection(e.dir)}),_S(),_S()}if(2&e){var r=t.$implicit;LE(1),NS("id","line_start_",r.dir.toString(),""),fS("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),LE(1),NS("id","line_end_",r.dir.toString(),""),fS("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),LE(1),NS("id","direction_",r.dir.toString(),""),fS("transform",r.transformation)}}var one=vy(function e(t,n,r,i,a,o){hy(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),sne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Bte(Tte),r.availableMinimaxes=[new zte(r.rules,"Dummy")],r.encoder=Rte.encoder,r.tutorial=(new Jte).tutorial,r.scores=MB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new yte(r.SPACE_SIZE,new hte(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),kte.INSTANCE),r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=MB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=LB.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new hte(e,t)],n.showPossibleDirections(),LB.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=pte.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=cy(gte.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Rte.fromSingleCoord(i,u).get():Rte.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=gte.getAngle(u)+150,p=new one(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new hte(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==pte.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==pte.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new hte(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),LB.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Vte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),LB.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new hte(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),LB.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=cte.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=cte.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),n9.sortByDescending(r.selecteds,Rte.sortCoord),r.showPossibleDirections(),LB.SUCCESS):r.cancelMove(Vte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Vte.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),LB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Rte.fromSingleCoord(a,e).get():Rte.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#space_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new hte(e,t),a=cy(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",LB.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new hte(e,t),r=X7.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(vte);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-abalone"]],features:[Xb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,rne,2,1,"g",1),wS(2,"defs"),gS(3,ine,2,1,"marker",2),_S(),gS(4,ane,4,12,"g",1),_S()),2&e&&(LE(1),kS("ngForOf",t.hexaBoard),LE(2),kS("ngForOf",t.directions),LE(1),kS("ngForOf",t.directions))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),une=function(){function e(t){hy(this,e),this.x=t}return vy(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return D7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();une.ZERO=new une(0),une.ONE=new une(1),une.TWO=new une(2),une.THREE=new une(3);var cne=function(){var e=vy(function e(){hy(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ee||(ee=Gg(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(te||(te=Gg(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(ne||(ne=Gg(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(re||(re=Gg(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ie||(ie=Gg(["There is no possible transfer from that square!"])))},e}(),lne=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return vy(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return OB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(MB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return xB.failure(cne.PIECE_SHOULD_MOVE_DOWNWARD());var r=OB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(MB.empty())&&n.starting.equals(MB.of(e))}));return xB.success(r)}}]),n}(Ite);lne.ALL_MOVES=[new lne(une.ZERO,MB.of(X7.ZERO),MB.empty()),new lne(une.ONE,MB.of(X7.ZERO),MB.empty()),new lne(une.TWO,MB.of(X7.ZERO),MB.empty()),new lne(une.THREE,MB.of(X7.ZERO),MB.empty()),new lne(une.ZERO,MB.of(X7.ONE),MB.empty()),new lne(une.ONE,MB.of(X7.ONE),MB.empty()),new lne(une.TWO,MB.of(X7.ONE),MB.empty()),new lne(une.THREE,MB.of(X7.ONE),MB.empty()),new lne(une.TWO,MB.empty(),MB.of(une.THREE)),new lne(une.ONE,MB.empty(),MB.of(une.THREE)),new lne(une.ZERO,MB.empty(),MB.of(une.THREE)),new lne(une.ONE,MB.empty(),MB.of(une.TWO)),new lne(une.ZERO,MB.empty(),MB.of(une.TWO)),new lne(une.ZERO,MB.empty(),MB.of(une.ONE))],lne.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return lne.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=lne.ALL_MOVES.findIndex(function(t){return t.equals(e)});return D7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return D7(e<lne.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),lne.ALL_MOVES[e]}}]),n}(Y7));var fne=function(){function e(t){hy(this,e),this.containing=t}return vy(e,[{key:"isFull",value:function(){return this.count(X7.ZERO)+this.count(X7.ONE)>=this.count(Q7.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(X7.ZERO),r=this.count(X7.ONE),i=this.count(Q7.NONE);return t===X7.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(X7.ZERO),r=this.count(X7.ONE),i=this.count(Q7.NONE);return t===X7.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(X7.ZERO),t=this.count(X7.ONE);return e>t?X7.ZERO:t>e?X7.ONE:Q7.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return xB.failure("invalid starting space");var i=new xte([{key:X7.ZERO,value:t},{key:X7.ONE,value:n},{key:Q7.NONE,value:r}]);i.makeImmutable();var a=new e(i);return xB.success(a)}}]),e}(),hne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return vy(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&n9.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=fne.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new xte;return u.set(X7.ZERO,r),u.set(X7.ONE,i),new n(e,a,u)}}]),n}(Pte);return e.PIECES_PER_PLAYER=10,e}(),dne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new hne(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===une.THREE)return i.updateAt(e.landing,o);var s=une.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new hne(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?xB.failure(cne.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?xB.failure(cne.NO_PIECE_REMAINING_TO_DROP()):xB.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?xB.failure(cne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(une.from(n)).isFull())return Fte.ONGOING;var r=t.getPieceAt(une.THREE).getDominatingPlayer();return D7(r.isPlayer(),"winner can only be a player if the game is finished"),Fte.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=MB.of(new n(hne))),this.singleton.get()}}]),n}(Ute);dne.singleton=MB.empty();var vne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return lne.ALL_MOVES.filter(function(e){return dne.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=dne.get().getGameStatus(e);if(t.isEndGame)return Ete.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new Ete(n.getScoreModifier()):new Ete(0)}}]),n}(_te),pne=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(ae||(ae=Gg(["Initial board and goal of the game"]))),$localize(oe||(oe=Gg(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),hne.getInitialState()),Hte.anyMove($localize(se||(se=Gg(["Drop"]))),$localize(ue||(ue=Gg(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),hne.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),lne.drop(une.ZERO,X7.ZERO),$localize(ce||(ce=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(le||(le=Gg(["Transfer"]))),$localize(fe||(fe=Gg(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),hne.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),lne.transfer(une.TWO,une.ZERO).get(),function(e,t,n){return e.isDrop()?LB.failure($localize(he||(he=Gg(["This move is a drop, please do a transfer!"])))):LB.SUCCESS},$localize(de||(de=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(ve||(ve=Gg(["Victory"]))),$localize(pe||(pe=Gg(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),hne.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),lne.drop(une.TWO,X7.ONE),function(e,t,n){return e.isDrop()?e.piece.equalsValue(X7.ONE)?LB.SUCCESS:LB.failure($localize(ge||(ge=Gg(["You actively made your opponent win!"])))):LB.failure($localize(ye||(ye=Gg(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(me||(me=Gg(["Congratulations!"]))))]});function gne(e,t){if(1&e&&(AC(),ES(0,"circle",5)),2&e){var n=t.$implicit,r=MS();fS("cx",r.getRemainingPieceCx(n))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function yne(e,t){if(1&e&&(AC(),ES(0,"circle",6)),2&e){var n=t.$implicit,r=MS();fS("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(n))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function mne(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",9),IS("click",function(){tC(n);var e=MS().index,t=MS();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),_S()}if(2&e){var r=MS().index,i=MS();NS("id","dropArrow_zero_",r,""),kS("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),fS("points",i.ARROW_COORD)("transform","translate("+i.SPACE_SIZE/2+" "+-i.SPACE_SIZE/2+")")}}function kne(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",9),IS("click",function(){tC(n);var e=MS().index,t=MS();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),_S()}if(2&e){var r=MS().index,i=MS();NS("id","dropArrow_one_",r,""),kS("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),fS("points",i.ARROW_COORD)("transform","translate(0 "+-i.SPACE_SIZE/2+")")}}function Cne(e,t){if(1&e){var n=PS();AC(),bS(0),wS(1,"circle",10),IS("click",function(){tC(n);var e=MS().index;return MS().onSquareClick(e)}),_S(),SS()}if(2&e){var r=t.$implicit,i=MS(),a=i.index,o=i.$implicit,s=MS();LE(1),LS("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),kS("ngClass",s.getPieceClasses(a,r,o)),fS("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function wne(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),gS(1,mne,1,4,"polygon",7),gS(2,kne,1,4,"polygon",7),wS(3,"rect",8),IS("click",function(){var e=tC(n).index;return MS().onSquareClick(e)}),_S(),gS(4,Cne,2,6,"ng-container",4),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS();fS("transform",a.getBlockTransform(i)),LE(1),kS("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),LE(1),kS("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),LE(1),NS("id","square_",i,""),kS("ngClass",a.getSquareClasses(i)),fS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}var _ne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).PlayerOrNone=Q7,r.BOARD_WIDTH=4*r.SPACE_SIZE,r.BOARD_HEIGHT=4.5*r.SPACE_SIZE,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=hne.PIECES_PER_PLAYER,r.selectedPiece=MB.empty(),r.leftPiece=MB.empty(),r.droppedPiece=MB.empty(),r.displayableArrow=[],r.rules=new dne(hne),r.hasAsymetricBoard=!0,r.availableMinimaxes=[new vne(r.rules,"ApagosDummyMinimax")],r.encoder=lne.encoder,r.tutorial=(new pne).tutorial,r.PIECE_RADIUS=2*r.SPACE_SIZE/(r.PIECES_PER_PLAYER+.5),r.updateBoard(),r}return vy(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=MB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(X7.ZERO).get(),this.remainingOne=e.remaining.get(X7.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=MB.empty(),this.leftPiece=MB.empty(),this.selectedPiece=MB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=MB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===X7.ZERO?n-1:e.count(Q7.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=MB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=MB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(X7.ZERO).get()>0&&this.displayableArrow.push({x:t,player:X7.ZERO}),e.remaining.get(X7.ONE).get()>0&&this.displayableArrow.push({x:t,player:X7.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=this.SPACE_SIZE/2,i=this.SPACE_SIZE/2;if(1===n.count(Q7.NONE))return new hte(r,i);var a=n.count(Q7.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new hte(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getBlockTransform",value:function(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===X7.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=une.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=lne.transfer(une.from(s),a).get()):o=lne.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(X7.ZERO),o=n.count(X7.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===X7.ZERO?a++:o++}var s=n.count(Q7.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),LB.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(cne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=MB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(cne.NO_POSSIBLE_TRANSFER_REMAINS()):LB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}},{key:"getRemainingPieceCx",value:function(e){return(e+.5)*this.PIECE_RADIUS*1.5}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(dte);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-apagos"]],features:[Xb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"g"),gS(2,gne,1,3,"circle",1),gS(3,yne,1,3,"circle",2),_S(),wS(4,"g",3),gS(5,wne,5,8,"g",4),_S(),_S()),2&e&&(fS("viewBox",-t.STROKE_WIDTH/2+" "+-t.STROKE_WIDTH/2+" "+(t.BOARD_WIDTH+t.STROKE_WIDTH)+" "+(t.BOARD_HEIGHT+t.STROKE_WIDTH)),LE(1),fS("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),LE(1),kS("ngForOf",t.range(t.remainingOne)),LE(1),kS("ngForOf",t.range(t.remainingZero)),LE(2),kS("ngForOf",t.board))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ene=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getViewBox",value:function(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}]),n}(dte);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275cmp=lk({type:t,selectors:[["ng-component"]],features:[Xb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),bne=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).captured=i,a}return vy(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(n9.createTable(6,2,4),0,[0,0])}}]),n}(Ote),Sne=function(){var e=vy(function e(){hy(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ke||(ke=Gg(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NON_EMPTY_HOUSE=function(){return $localize(Ce||(Ce=Gg(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=Gg(["You should distribute but you do not."])))},e}(),Pne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){TB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer(),o=t.getCurrentOpponent(),s=o.value,u=t.getCopiedBoard(),c=n.distribute(i,s,u);if(c.y===s)return new bne(u,t.turn+1,t.captured);var l=[0,0],f=n9.copyBiArray(u);return l[a.value]=n.capture(c.x,c.y,a,u),l[a.value]>0&&n.isStarving(o,u)&&(u=f,l=[0,0]),n.isStarving(a,u)&&!1===n.canDistribute(o,u)&&(l[o.value]+=n.mansoon(o,u)),l[0]+=t.captured[0],l[1]+=t.captured[1],new bne(u,t.turn+1,l)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0,i=e.getOpponent().value;do{n+=t[i][r],t[i][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentOpponent(),i=r.value,a=e.x;if(0===t.getPieceAtXY(a,i))return xB.failure(Sne.MUST_CHOOSE_NON_EMPTY_HOUSE());var o=n.isStarving(r,t.board),s=!1===n.doesDistribute(a,i,t.board);return o&&s?xB.failure(Sne.SHOULD_DISTRIBUTE()):xB.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e.getOpponent().value,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0,r=e.getOpponent().value;do{if(t[r][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new hte(e,t)}},{key:"capture",value:function(e,t,n,r){D7(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;n===X7.ONE&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Fte.ZERO_WON:t.captured[1]>24?Fte.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Fte.DRAW:Fte.ONGOING}}]),n}(Ute);return e.VERBOSE=!1,e}(),One=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).x=e,r}return vy(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return D7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(Ite);One.ZERO=new One(0),One.ONE=new One(1),One.TWO=new One(2),One.THREE=new One(3),One.FOUR=new One(4),One.FIVE=new One(5),One.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return One.from(e)}}]),n}(Y7));var Tne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=(r.turn+1)%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=One.from(a),Pne.isLegal(t,r).isSuccess()&&(t=One.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent().value,i=n.value;return n9.sortByDescending(t,function(t){var a,o=e.gameState.getCopiedBoard(),s=o[r][t.x],u=Pne.distribute(t.x,r,o),c=0;return u.y===r?(a=0,s<=6&&(c=10)):a=Pne.capture(u.x,i,n,o),100*a+c-s}),t}},{key:"getBoardValue",value:function(e){var t=Pne.getGameStatus(e);if(t.isEndGame)return Ete.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new Ete(n[1]-n[0])}}]),n}(_te),Ine=vy(function e(){hy(this,e),this.tutorial=[Hte.anyMove($localize(_e||(_e=Gg(["Sowing"]))),$localize(Ee||(Ee=Gg(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the bottom are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),bne.getInitialState(),One.ZERO,$localize(be||(be=Gg(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Hte.anyMove($localize(Se||(Se=Gg(["Big sowing"]))),$localize(Pe||(Pe=Gg(["You are still the first player.\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new bne([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),One.ONE,$localize(Oe||(Oe=Gg(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Hte.fromMove($localize(Te||(Te=Gg(["Simple capture"]))),$localize(Ie||(Ie=Gg(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the first player, try to capture some pieces!"]))),new bne([[1,0,0,0,1,0],[1,0,0,0,1,0]],0,[0,0]),[One.ZERO],$localize(Ae||(Ae=Gg(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Re||(Re=Gg(["Failed. Try again and sow from the leftmost house."])))),Hte.fromMove($localize(Me||(Me=Gg(["Multiple captures"]))),$localize(xe||(xe=Gg(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new bne([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[One.ZERO],$localize(Ne||(Ne=Gg(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(De||(De=Gg(["Failed. Try again."])))),Hte.fromMove($localize(Le||(Le=Gg(["Interrupted capture"]))),$localize(Fe||(Fe=Gg(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new bne([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[One.ZERO],$localize(Ue||(Ue=Gg(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Ve||(Ve=Gg(["Failed. Try again."])))),Hte.fromMove($localize(Be||(Be=Gg(["Capture on the other side only"]))),$localize(ze||(ze=Gg(["Try to capture the two leftmost houses of the opponent."]))),new bne([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[One.ONE],$localize(He||(He=Gg(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Ge||(Ge=Gg(["You have only captured one house, try again!"])))),Hte.fromMove($localize($e||($e=Gg(["Do not starve"]))),$localize(Ze||(Ze=Gg(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new bne([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[One.ZERO],$localize(qe||(qe=Gg(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(We||(We=Gg(["Failed. Try again."])))),Hte.anyMove($localize(je||(je=Gg(["Feeding is mandatory"]))),$localize(Ye||(Ye=Gg(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!"]))),new bne([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),One.THREE,$localize(Ke||(Ke=Gg(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Hte.anyMove($localize(Qe||(Qe=Gg(["End of the game"]))),$localize(Xe||(Xe=Gg(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new bne([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),One.FIVE,$localize(Je||(Je=Gg(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Ane(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",4),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),_S(),wS(2,"text",5),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),iP(3),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","click_",i,"_",a,""),kS("ngClass",o.getSquareClasses(i,a)),fS("cx",o.getPieceCx(i))("cy",o.getPieceCy(a)),LE(1),fS("x",50+100*i)("y",66+120*a)("transform",o.getPieceRotation(i,a)),LE(1),oP(" ",r," ")}}function Rne(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Ane,4,9,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var Mne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).last=MB.empty(),r.captured=[],r.moved=[],r.hasAsymetricBoard=!0,r.scores=MB.of([0,0]),r.rules=new Pne(bne),r.availableMinimaxes=[new Tne(r.rules,"AwaleMinimax")],r.encoder=One.encoder,r.tutorial=(new Ine).tutorial,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=MB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentPlayer().value;this.last=MB.of(new hte(t.get().x,n)),this.showPreviousMove()}else this.last=MB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new hte(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t!==n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(Sne.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=MB.empty(),a=One.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getPieceCx",value:function(e){return 50+100*e}},{key:"getPieceCy",value:function(e){return 50+120*e}},{key:"getPieceRotation",value:function(e,t){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(t)+")"}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-awale-component"]],features:[Xb],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),ES(1,"rect",1),gS(2,Rne,2,1,"g",2),ES(3,"line",3),_S()),2&e&&(fS("transform",t.rotation),LE(2),kS("ngForOf",t.board))},directives:[rR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),xne=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;if(hy(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(wte.MOVE_CANNOT_BE_STATIC());return i.end=r,ry(i)}return vy(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return cte.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){ey(a,r);var i=ny(a);function a(){var n;return hy(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return vy(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new hte((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new hte((r-=r%1)%e,o);return n(s,a)}}]),a}(Y7))}}]),n}(Ate),Nne=function(){var e=vy(function e(){hy(this,e)});return e.LANDING_ON_OCCUPIED_SQUARE=function(){return $localize(et||(et=Gg(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(tt||(tt=Gg(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(nt||(nt=Gg(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(rt||(rt=Gg(["Tafl moves must be orthogonal."])))},e}(),Dne=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;if(hy(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(Nne.MOVE_MUST_BE_ORTHOGONAL());return ry(i)}return vy(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(xne),Lne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return xB.success(r)}catch(r){return xB.failure(r.message)}}}]),n}(Dne);Lne.encoder=xne.getEncoder(7,7,Lne.of);var Fne={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:X7.ZERO},Une=function(){function e(t,n){hy(this,e),this.owner=t,this.king=n}return vy(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Une.UNOCCUPIED=new Une(Q7.NONE,!1),Une.PLAYER_ONE_KING=new Une(Q7.ONE,!0),Une.INVADERS=new Une(Q7.ZERO,!1),Une.DEFENDERS=new Une(Q7.ONE,!1);var Vne=vy(function e(t){hy(this,e),this.value=t});Vne.NONE=new Vne("NONE"),Vne.OPPONENT=new Vne("OPPONENT"),Vne.PLAYER=new Vne("PLAYER");var Bne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new hte(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===Q7.NONE?Vne.NONE:e===n?Vne.PLAYER:Vne.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(Ote),zne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Une.UNOCCUPIED,t=Une.INVADERS,r=Une.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Une.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Bne),Hne=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return vy(n,[{key:"isLegal",value:function(e,t){TB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?xB.failure(i.getReason()):xB.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Vne.NONE)return LB.failure(wte.MUST_CHOOSE_PLAYER_PIECE());if(r===Vne.OPPONENT)return LB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Vne.NONE)return LB.failure(Nne.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return LB.failure(Nne.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return LB.failure(Nne.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Une.UNOCCUPIED)return LB.failure(wte.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return LB.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Vne.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):MB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===Vne.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===Vne.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):MB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Vne.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Vne.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Vne.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Vne.PLAYER?1:0;return 2===(i+=t===Vne.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(TB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),MB.of(r)):MB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return MB.of(t)}else{var i=r===Vne.PLAYER,a=n===Vne.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return MB.of(t)}return MB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Vne.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Vne.NONE?!1===this.isThrone(i,s)?(TB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),MB.empty()):(TB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),MB.of(o)):u===Vne.PLAYER?(TB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),MB.of(o)):(TB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),MB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return MB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Vne.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Vne.PLAYER||l&&s)?(TB(n.VERBOSE||!1,"king captured by 4 invaders"),MB.of(t)):MB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){TB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Une.UNOCCUPIED;var u,c=cy(lte.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=Une.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Fte.getVictory(t.get()):Fte.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return TB(t,"The king is dead, victory to invader"),MB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(TB(t,"The king escape, victory to defender"),MB.of(this.getDefender())):this.isPlayerImmobilized(X7.ZERO,e)?(TB(t,"Zero has no move, victory to one"),MB.of(X7.ONE)):this.isPlayerImmobilized(X7.ONE,e)?(TB(t,"One has no move, victory to zero"),MB.of(X7.ZERO)):(TB(t,"no victory"),MB.empty())}},{key:"getKingCoord",value:function(e){TB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return MB.of(new hte(r,t));return MB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);TB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=cy(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=cy(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new hte(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=cy(lte.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===Q7.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Ute);return e.VERBOSE=!1,e}(),Gne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,zne,Fne,Lne.of)}return vy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Lte.ruler=this.singleton,n.singleton}}]),n}(Hne),$ne=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=Une.UNOCCUPIED,a.captureds=[],a.chosen=MB.empty(),a.lastMove=MB.empty(),a}return vy(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){TB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=cy(lte.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Vne.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Une.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===Q7.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new hte(e,t),r.abrupt("return",n.chosen.equalsValue(a)?(n.cancelMoveAttempt(),LB.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(a)?n.choosePiece(a):n.chooseDestination(e,t));case 6:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen.get(),a=new hte(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=8;break}return r.next=5,n.chooseMove(o.get(),n.rules.node.gameState);case 5:r.t0=r.sent,r.next=9;break;case 8:r.t0=n.cancelMove(o.getReason());case 9:return r.abrupt("return",r.t0);case 10:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){return TB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[e.y][e.x]===Une.UNOCCUPIED?this.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=MB.of(e),this.updateViewInfo(),TB(this.VERBOSE,"selected piece = ("+e.x+", "+e.y+")"),LB.SUCCESS):this.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e){var t=this.rules.node.gameState,n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===Vne.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=MB.empty(),this.updateViewInfo()}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new hte(e,t))}},{key:"isCentralThrone",value:function(e,t){return this.rules.node.gameState.isCentralThrone(new hte(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new hte(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equalsValue(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new hte(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new hte(n,t);this.isClickable(r)&&e.push(r)}return e}},{key:"isClickable",value:function(e){return this.pieceBelongToCurrentPlayer(e)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Une.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(Ene),Zne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){TB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?n9.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):n9.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new Ete(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(X7.ZERO,t).length,i=this.ruler.getPlayerListPawns(X7.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=X7.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=X7.ONE.getScoreModifier(),new Ete(r*a+i*o)}}]),n}(_te),qne=function(){function e(t,n){hy(this,e),this.directThreats=t,this.mover=n}return vy(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),Wne=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,new Ste([e]),r)).directThreat=e,i.mover=r,i}return vy(n)}(qne),jne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){ey(r,e);var n=ny(r);function r(e){var t;if(hy(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return ry(t)}return vy(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=cy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=cy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(Ste,Symbol.iterator)),Yne=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return vy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n,r=e.gameState,i=Une.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=cy(X7.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=cy(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=cy(lte.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new Ete(a)}},{key:"getPiecesMap",value:function(e){for(var t=Une.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new hte(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===X7.ZERO?n.push(o):r.push(o))}return new xte([{key:X7.ZERO,value:new jne(n)},{key:X7.ONE,value:new jne(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new xte,i=cy(X7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=cy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new Ste(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);D7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=cy(lte.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=cy(lte.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Une.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new Wne(u,new jne(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==X7.ONE&&t.getPieceAt(e)!==Une.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=cy(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new xte,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new jne(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=cy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=cy(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=cy(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new Wne(d.directThreat,new jne(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new Ste(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=cy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(Zne),Kne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=Une.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=cy(X7.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new jne,p=cy(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=cy(lte.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,_=cy(v);try{for(_.s();!(w=_.n()).done;){var E=w.value,b=this.getControlledPieceValue(E.x,E.y,a);s+=d.getScoreModifier()*b}}catch(S){_.e(S)}finally{_.f()}}}catch(S){f.e(S)}finally{f.f()}return new Ete(s)}},{key:"getControlledPieceValue",value:function(e,t,n){var r=1;return(0===e||e===n-1)&&(r*=n),(0===t||t===n-1)&&(r*=n),r}}]),n}(Yne);Kne.SCORE_BY_THREATENED_PIECE=530,Kne.SCORE_BY_SAFE_PIECE=16*Kne.SCORE_BY_THREATENED_PIECE+1;var Qne=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=Une.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=cy(X7.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new jne,g=cy(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=cy(lte.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,E=cy(p);try{for(E.s();!(_=E.n()).done;){var b=_.value,S=this.getControlledPieceValue(b.x,b.y,i);u+=v.getScoreModifier()*S}}catch(O){E.e(O)}finally{E.f()}}}catch(O){h.e(O)}finally{h.f()}var P=this.getStepForEscape(r);return new Ete(531*P*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?MB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?MB.of(t):(t++,r.push.apply(r,sy(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=cy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=cy(lte.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Une.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(Kne);Qne.SCORE_BY_THREATENED_PIECE=530,Qne.SCORE_BY_SAFE_PIECE=16*Kne.SCORE_BY_THREATENED_PIECE+1,Qne.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Xne=Une.UNOCCUPIED,Jne=Une.INVADERS,ere=Une.DEFENDERS,tre=Une.PLAYER_ONE_KING,nre=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(it||(it=Gg(["Goal of the game"]))),$localize(at||(at=Gg(["Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),zne.getInitialState()),Hte.anyMove($localize(ot||(ot=Gg(["Moving"]))),$localize(st||(st=Gg(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),zne.getInitialState(),Lne.of(new hte(3,1),new hte(1,1)),$localize(ut||(ut=Gg(["Congratulations!"])))),Hte.fromMove($localize(ct||(ct=Gg(["Capturing a soldier (1/2)"]))),$localize(lt||(lt=Gg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new zne([[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Jne,Xne,Xne,ere,Xne,Xne,Xne],[Xne,Xne,ere,tre,ere,Jne,Jne],[Xne,Xne,Jne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,ere,Xne,Jne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne]],1),[Lne.of(new hte(3,5),new hte(2,5))],$localize(ft||(ft=Gg(["Congratulations, that will teach him a lesson!"]))),$localize(ht||(ht=Gg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Hte.fromMove($localize(dt||(dt=Gg(["Capturing a soldier (2/2)"]))),$localize(vt||(vt=Gg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new zne([[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,Xne,Jne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,ere,Xne,Xne,Xne],[Jne,ere,Xne,Xne,ere,Jne,Jne],[Xne,ere,Xne,Xne,Xne,Xne,Xne],[Xne,Jne,Xne,tre,Xne,Jne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne]],12),[Lne.of(new hte(2,1),new hte(3,1)),Lne.of(new hte(3,0),new hte(3,1))],$localize(pt||(pt=Gg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(gt||(gt=Gg(["Failed, you did not do the expected move."])))),Hte.fromMove($localize(yt||(yt=Gg(["Capturing the king on his throne"]))),$localize(mt||(mt=Gg(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new zne([[Xne,Xne,Xne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,ere,Xne,Xne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,Jne,Xne,tre,Jne,Xne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,ere,Xne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,Xne,Xne,Xne,Xne]],72),[Lne.of(new hte(1,3),new hte(2,3))],$localize(kt||(kt=Gg(["Congratulations, you won!"]))),$localize(Ct||(Ct=Gg(["Failed, you let the king run away."])))),Hte.fromMove($localize(wt||(wt=Gg(["Capturing the king next to his throne"]))),$localize(_t||(_t=Gg(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new zne([[Xne,Xne,Jne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,Xne,Xne,tre,Jne,Xne,Xne],[Xne,Jne,ere,Xne,ere,Xne,Xne],[Xne,Xne,Xne,Jne,Xne,Xne,Xne],[Xne,Xne,Xne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,Xne,Xne,Xne,Xne]],72),[Lne.of(new hte(2,0),new hte(2,2))],$localize(Et||(Et=Gg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bt||(bt=Gg(["Failed!"])))),Hte.fromMove($localize(St||(St=Gg(["Capturing the king far from his throne"]))),$localize(Pt||(Pt=Gg(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new zne([[Xne,Xne,Xne,Xne,Xne,Xne,Xne],[Xne,Xne,Xne,Xne,Xne,Xne,Xne],[Xne,Jne,Xne,Jne,Xne,Xne,Xne],[Jne,Xne,Xne,Xne,ere,Xne,Xne],[Xne,Xne,Xne,ere,Xne,Xne,Xne],[Xne,Xne,Xne,Xne,Xne,Xne,Xne],[Xne,tre,Xne,Jne,Xne,Xne,Xne]],72),[Lne.of(new hte(3,6),new hte(2,6))],$localize(Ot||(Ot=Gg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Tt||(Tt=Gg(["Failed!"]))))]});function rre(e,t){1&e&&(AC(),ES(0,"polygon",8))}function ire(e,t){1&e&&(AC(),ES(0,"rect",9))}function are(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,rre,1,0,"polygon",6),gS(2,ire,1,0,"ng-template",null,7,JT),_S()),2&e){var n=yS(3),r=MS().index,i=MS().index,a=MS();LE(1),kS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function ore(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13),ES(4,"line",13),ES(5,"line",13),_S()),2&e){var n=MS(2).index,r=MS().index,i=MS();LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function sre(e,t){if(1&e&&(AC(),ES(0,"polyline",16)),2&e){var n=MS(3).index,r=MS().index;kS("ngClass",MS().viewInfo.pieceClasses[r][n])}}function ure(e,t){if(1&e&&(AC(),ES(0,"line",13),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13)),2&e){var n=MS(3).index,r=MS().index,i=MS();kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function cre(e,t){if(1&e&&(AC(),gS(0,sre,1,1,"polyline",14),gS(1,ure,4,20,"ng-template",null,15,JT)),2&e){var n=yS(2),r=MS(2).index,i=MS().index;kS("ngIf",MS().isKing(r,i))("ngIfElse",n)}}function lre(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",10),gS(2,ore,6,25,"g",11),gS(3,cre,3,2,"ng-template",null,12,JT),_S()),2&e){var n=yS(4),r=MS().index,i=MS().index,a=MS();LE(1),DS("id","piece_",r,"_",i,""),kS("ngClass",a.viewInfo.pieceClasses[i][r]),fS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),LE(1),kS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function fre(e,t){if(1&e){var n=PS();AC(),wS(0,"g",3),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(1,"rect",4),gS(2,are,4,2,"g",5),gS(3,lre,5,8,"g",5),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();DS("id","click_",r,"_",i,""),fS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),LE(1),kS("ngClass",a.getRectClasses(r,i)),fS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),LE(1),kS("ngIf",a.board[i][r]!==a.EMPTY)}}function hre(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,fre,4,8,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function dre(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",17),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),DS("id","click_",r.x,"_",r.y,""),fS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var vre=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e,!1,Lne.from)).rules=Gne.get(),r.availableMinimaxes=[new Zne(r.rules,"DummyBot"),new Yne(r.rules,"Piece > Influence"),new Kne(r.rules,"Piece > Control"),new Qne(r.rules,"Escape > Piece > Control")],r.encoder=Lne.encoder,r.tutorial=(new nre).tutorial,r}return vy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}($ne);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-brandhub"]],features:[Xb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,hre,2,1,"g",1),gS(2,dre,2,6,"g",1),_S()),2&e&&(fS("viewBox",t.getViewBox()),LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.getClickables()))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),pre=function(){var e,t=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return vy(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new hte(.5*this.SPACE_SIZE*e,i);return[o,new hte(n,a),new hte(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new hte(.5*this.SPACE_SIZE*e,a);return[o,new hte(n,i),new hte(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(dte);return t.\u0275fac=function(n){return(e||(e=fw(t)))(n||t)},t.\u0275cmp=lk({type:t,selectors:[["ng-component"]],features:[Xb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),gre=function(){var e=vy(function e(){hy(this,e)});return e.INVALID_DISTANCE=function(){return $localize(It||(It=Gg(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(At||(At=Gg(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Rt||(Rt=Gg(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Mt||(Mt=Gg(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(xt||(xt=Gg(["You cannot capture your own pieces."])))},e}(),yre=function(){function e(t,n){hy(this,e),this.direction=t,this.str=n}return vy(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(gre.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();yre.LEFT=new yre(new ote(-2,0),"LEFT"),yre.UP_LEFT=new yre(cte.UP_LEFT,"UP_LEFT"),yre.UP_RIGHT=new yre(cte.UP_RIGHT,"UP_RIGHT"),yre.RIGHT=new yre(new ote(2,0),"RIGHT"),yre.DOWN_LEFT=new yre(cte.DOWN_LEFT,"DOWN_LEFT"),yre.DOWN_RIGHT=new yre(cte.DOWN_RIGHT,"DOWN_RIGHT"),yre.STEPS=[yre.LEFT,yre.UP_LEFT,yre.UP_RIGHT,yre.RIGHT,yre.DOWN_LEFT,yre.DOWN_RIGHT];var mre=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return vy(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new hte(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(MB.of(e),MB.of(t),MB.of(r),MB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(MB.empty(),MB.empty(),MB.empty(),MB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=yre.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(Ite);mre.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?mre.fromTilesExchange(new hte(n,t)):mre.fromMovement(new hte(n,t),yre.STEPS[e-1])}}]),n}(Y7));var kre=function(){function e(){hy(this,e)}return vy(e,null,[{key:"getNeighbors",value:function(e){var t=new hte(e.x-1,e.y),n=new hte(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new hte(e.x,e.y-1)]:[t,n,new hte(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new hte(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return MB.of(o);s++}a++}return MB.empty()}},{key:"isSpaceDark",value:function(e){return(e.x+e.y)%2==0}}]),e}(),Cre=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=cy(kre.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(Ote),wre=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return vy(n,[{key:"applyLegalMovement",value:function(e){TB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=pte.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=pte.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){TB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=cy(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return kre.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,pte.EMPTY).length}},{key:"capture",value:function(e){TB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return TB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=pte.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){TB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=cy(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===pte.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){D7(this.getPieceAt(e)!==pte.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new ote(n,t),1);if(this.getPieceAt(r)!==pte.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=MB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==pte.UNREACHABLE&&(r.isAbsent()&&(r=MB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){TB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=pte.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=cy(yre.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===pte.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new hte(n,t),pte.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new hte(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new hte(e.x+1,e.y-1),new hte(e.x+3,e.y+0),new hte(e.x+3,e.y+1),new hte(e.x+1,e.y+2),new hte(e.x-1,e.y+1),new hte(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=pte.EMPTY,t=pte.UNREACHABLE,r=pte.ZERO,i=pte.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(Cre);wre.VERBOSE=!1,wre.NEIGHBORS_TILES_DIRECTIONS=[new ote(0,-2),new ote(3,-1),new ote(3,1),new ote(0,2),new ote(-3,1),new ote(-3,-1)],wre.isInRange=function(e){return e.isInRange(15,10)};var _re=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=pte.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new wre(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new wre(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return TB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new wre(a.board,t.turn+1,a.tiles,a.captures);return TB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return xB.failure(gre.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===pte.UNREACHABLE||n===pte.EMPTY?xB.failure(gre.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?xB.failure(gre.CANNOT_CAPTURE_OWN_PIECES()):xB.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===pte.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return xB.failure(n)}if(t.getPieceAt(e.landingCoord.get())===pte.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return xB.failure(r)}var i=t.getPieceAt(e.start.get());return i===pte.EMPTY?xB.failure(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?xB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Fte.ZERO_WON:t.captures[1]>=18?Fte.ONE_WON:Fte.ONGOING}}]),n}(Ute);return e.VERBOSE=!1,e}(),Ere=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=pte.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new hte(o,a);if(n.getPieceAt(s)===i){var u=mre.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new hte(a,i);if(n.getPieceAt(o).is(r)){var s,u=cy(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=mre.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=_re.getGameStatus(e);if(t.isEndGame)return Ete.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new Ete(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return n9.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(_te),bre=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=_re.getGameStatus(e);if(t.isEndGame)return Ete.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=cy(X7.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=cy(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new Ete(u)}},{key:"getPiecesMap",value:function(e){for(var t=new xte,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new hte(a,i),s=e.getPieceAt(o);s===pte.ZERO?n.push(o):s===pte.ONE&&r.push(o)}return t.set(X7.ZERO,new jne(n)),t.set(X7.ONE,new jne(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new xte,i=cy(X7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=cy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=X7.of(t.getPieceAt(e).value).getOpponent(),i=MB.empty(),a=MB.empty(),o=[],s=kre.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=cy(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=MB.of(c));else if(l===pte.EMPTY){if(i.isPresent())return MB.empty();i=MB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=cy(yre.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return MB.of(new qne(new jne(o),new jne(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new jne(o);return MB.of(new qne(p,new jne([a.get()])))}return MB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=MB.empty(),a=wre.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new ote(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=MB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=wre.getTilesUpperLeftCoord(e),i=cy(yre.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=wre.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===pte.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new xte,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new jne(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=cy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=MB.empty(),h=cy(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=cy(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=MB.of(new qne(l.directThreats,new jne(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=cy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(Ere);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),Sre=pte.EMPTY,Pre=pte.UNREACHABLE,Ore=pte.ZERO,Tre=pte.ONE,Ire=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Nt||(Nt=Gg(["Board and goal of the game"]))),$localize(Dt||(Dt=Gg(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),wre.getInitialState()),Hte.anyMove($localize(Lt||(Lt=Gg(["Move"]))),$localize(Ft||(Ft=Gg(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),wre.getInitialState(),mre.fromCoordToCoord(new hte(3,5),new hte(5,5)),$localize(Ut||(Ut=Gg(["Congratulations! Let's see captures now."])))),Hte.fromMove($localize(Vt||(Vt=Gg(["Capture"]))),$localize(Bt||(Bt=Gg(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new wre([[Pre,Pre,Pre,Pre,Pre,Pre,Ore,Sre,Ore,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Ore,Sre,Sre,Sre,Sre,Sre,Ore,Sre,Sre,Pre,Pre,Pre],[Sre,Tre,Sre,Tre,Ore,Tre,Sre,Sre,Ore,Sre,Sre,Tre,Sre,Tre,Sre],[Tre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Tre,Sre,Sre,Sre,Tre],[Sre,Tre,Sre,Tre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Tre,Sre,Tre,Sre],[Sre,Ore,Sre,Ore,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Ore,Sre,Ore,Sre],[Ore,Sre,Sre,Sre,Ore,Sre,Sre,Sre,Sre,Sre,Ore,Sre,Sre,Sre,Ore],[Sre,Ore,Sre,Ore,Sre,Sre,Tre,Sre,Tre,Sre,Sre,Ore,Sre,Ore,Sre],[Pre,Pre,Pre,Sre,Sre,Tre,Sre,Sre,Sre,Tre,Sre,Sre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Tre,Sre,Tre,Pre,Pre,Pre,Pre,Pre,Pre]],3,[0,0],[0,0]),[mre.fromCoordToCoord(new hte(5,2),new hte(4,1)),mre.fromCoordToCoord(new hte(3,4),new hte(4,3))],$localize(zt||(zt=Gg(["Congratulations!"]))),$localize(Ht||(Ht=Gg(["Failed, you have not captured any piece."])))),Hte.fromMove($localize(Gt||(Gt=Gg(["Gain a tile"]))),$localize($t||($t=Gg(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new wre([[Pre,Pre,Pre,Pre,Pre,Pre,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Tre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Sre,Sre,Sre,Pre,Pre,Pre,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Sre,Sre,Tre,Sre,Sre,Sre,Sre,Ore,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Sre,Sre,Sre,Tre,Sre,Sre,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Ore,Pre,Pre,Pre],[Sre,Sre,Ore,Sre,Sre,Tre,Sre,Sre,Sre,Sre,Ore,Sre,Sre,Sre,Ore],[Sre,Sre,Sre,Sre,Sre,Sre,Tre,Sre,Tre,Sre,Sre,Ore,Sre,Ore,Sre],[Pre,Pre,Pre,Sre,Sre,Tre,Sre,Sre,Sre,Tre,Sre,Sre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Tre,Sre,Tre,Pre,Pre,Pre,Pre,Pre,Pre]],2,[0,0],[0,0]),[mre.fromCoordToCoord(new hte(2,6),new hte(4,6)),mre.fromCoordToCoord(new hte(2,6),new hte(3,5)),mre.fromCoordToCoord(new hte(2,6),new hte(3,7))],$localize(Zt||(Zt=Gg(["Congratulations!"]))),$localize(qt||(qt=Gg(["Failed, you have not gained the two tiles that you could, try again!"])))),Hte.fromMove($localize(Wt||(Wt=Gg(["Exchanging a tile"]))),$localize(jt||(jt=Gg(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new wre([[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Ore,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Sre,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Sre,Tre,Sre,Tre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Tre,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Tre,Sre,Tre,Pre,Pre,Pre,Pre,Pre,Pre]],1,[0,2],[0,0]),[mre.fromTilesExchange(new hte(5,5))],$localize(Yt||(Yt=Gg(["Congratulations!"]))),$localize(Kt||(Kt=Gg(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Hte.fromMove($localize(Qt||(Qt=Gg(["Special capture"]))),$localize(Xt||(Xt=Gg(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new wre([[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Sre,Sre,Ore,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Ore,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Ore,Tre,Sre,Tre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Tre,Ore,Sre,Sre,Sre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Sre,Sre,Tre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre],[Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre,Pre]],1,[0,0],[0,0]),[mre.fromCoordToCoord(new hte(7,6),new hte(6,5)),mre.fromCoordToCoord(new hte(7,6),new hte(8,5))],$localize(Jt||(Jt=Gg(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(en||(en=Gg(["Failed!"]))))]});function Are(e,t){if(1&e&&(AC(),ES(0,"polygon",13)),2&e){var n=MS().index,r=MS().index,i=MS();kS("ngClass",i.getPyramidClass(n,r)),fS("points",i.getPyramidCoordinate(n,r))}}function Rre(e,t){if(1&e&&(AC(),ES(0,"polygon",15)),2&e){var n=MS(2).index,r=MS().index,i=MS();kS("ngClass",i.getEmptyClass(n,r)),fS("points",i.getTriangleCoordinate(n,r))}}function Mre(e,t){if(1&e&&(AC(),gS(0,Rre,1,2,"polygon",14)),2&e){var n=MS().index,r=MS().index;kS("ngIf",MS().isEmptyCase(n,r))}}function xre(e,t){if(1&e&&(AC(),ES(0,"polygon",16)),2&e){var n=MS().index,r=MS().index,i=MS();DS("id","dark_line_",n,"_",r,""),fS("points",i.getLineCoordinate(n,r))}}function Nre(e,t){if(1&e&&(AC(),ES(0,"polygon",17)),2&e){var n=MS().index,r=MS().index,i=MS();DS("id","dark_line_",n,"_",r,""),fS("points",i.getLineCoordinate(n,r))}}function Dre(e,t){if(1&e){var n=PS();AC(),wS(0,"g",8),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),gS(1,Are,1,2,"polygon",9),gS(2,Mre,1,1,"ng-template",null,10,JT),gS(4,xre,1,3,"polygon",11),gS(5,Nre,1,3,"polygon",12),_S()}if(2&e){var r=t.$implicit,i=t.index,a=yS(3),o=MS().index,s=MS();DS("id","click_",i,"_",o,""),LE(1),kS("ngIf",s.isPyramid(i,o))("ngIfElse",a),LE(3),kS("ngIf",r!==s.NONE),LE(1),kS("ngIf",r!==s.NONE)}}function Lre(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Dre,6,6,"g",7),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Fre(e,t){if(1&e&&(AC(),ES(0,"polygon",18)),2&e){var n=t.$implicit;fS("points",MS().getTriangleCoordinate(n.x,n.y))}}function Ure(e,t){if(1&e&&(AC(),ES(0,"polygon",19)),2&e){var n=MS();fS("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Vre(e,t){if(1&e&&(AC(),ES(0,"polygon",19)),2&e){var n=MS();fS("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Bre(e,t){if(1&e&&(AC(),ES(0,"polygon",20)),2&e){var n=MS();DS("id","selected_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),fS("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function zre(e,t){if(1&e&&(AC(),wS(0,"g",21),ES(1,"polygon",22),wS(2,"text",23),iP(3),_S(),_S()),2&e){var n=MS();LE(1),fS("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),LE(1),fS("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),LE(1),aP(n.tiles[0])}}function Hre(e,t){if(1&e&&(AC(),wS(0,"g",24),ES(1,"polygon",25),wS(2,"text",26),iP(3),_S(),_S()),2&e){var n=MS();LE(1),fS("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),LE(1),fS("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),LE(1),aP(n.tiles[1])}}var Gre=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=pte.UNREACHABLE,r.chosenCoord=MB.empty(),r.lastStart=MB.empty(),r.lastEnd=MB.empty(),r.possibleLandings=[],r.scores=MB.of([0,0]),r.rules=new _re(wre),r.availableMinimaxes=[new Ere(r.rules,"Normal"),new bre(r.rules,"Piece > Threat > Tiles")],r.encoder=mre.encoder,r.tutorial=(new Ire).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.chosenCoord=MB.empty(),this.state=this.rules.node.gameState,this.scores=MB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=MB.empty(),this.lastEnd=MB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=MB.empty(),this.possibleLandings=[]}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new hte(e,t),o=n.state.getCurrentPlayer(),r.abrupt("return",n.chosenCoord.equalsValue(a)?(n.cancelMoveAttempt(),LB.SUCCESS):n.chosenCoord.isAbsent()||n.state.getPieceAt(a).is(o)?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=mre.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=MB.of(e),t.showHighlight(),LB.SUCCESS):t.cancelMove(gre.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.possibleLandings.some(function(t){return t.equals(e)})){n.next=3;break}return r=mre.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 3:return n.abrupt("return",t.cancelMove(gre.INVALID_DISTANCE()));case 4:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===pte.ZERO?this.getPlayerClass(X7.ZERO):n===pte.ONE?this.getPlayerClass(X7.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===pte.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===pte.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===pte.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===pte.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(pre);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-coerceo"]],features:[Xb],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Lre,2,1,"g",1),gS(2,Fre,1,1,"polygon",2),gS(3,Ure,1,1,"polygon",3),gS(4,Vre,1,1,"polygon",3),gS(5,Bre,1,3,"polygon",4),gS(6,zre,4,6,"g",5),gS(7,Hre,4,6,"g",6),_S()),2&e&&(fS("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.possibleLandings),LE(1),kS("ngIf",t.lastStart.isPresent()),LE(1),kS("ngIf",t.lastEnd.isPresent()),LE(1),kS("ngIf",t.chosenCoord.isPresent()),LE(1),kS("ngIf",t.mustShowTilesOf(0)),LE(1),kS("ngIf",t.mustShowTilesOf(1)))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),$re=function(){var e=vy(function e(){hy(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(tn||(tn=Gg(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(nn||(nn=Gg(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(rn||(rn=Gg(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(an||(an=Gg(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(on||(on=Gg(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(sn||(sn=Gg(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(un||(un=Gg(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Zre=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(n9.createTable(n.WIDTH,n.HEIGHT,Q7.NONE),0)}}]),n}(Ote);Zre.WIDTH=17,Zre.HEIGHT=17,Zre.CENTRAL_ZONE_TOP_LEFT=new hte(4,6),Zre.CENTRAL_ZONE_BOTTOM_RIGHT=new hte(12,10),Zre.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Zre.ALL_SHELTERS=new Ste(Zre.SHELTERS_INDICES.flatMap(function(e){return[new hte(e,0),new hte(e,Zre.HEIGHT-1),new hte(0,e),new hte(Zre.WIDTH-1,e)]})).toList();var qre=function(e){ey(n,e);var t=ny(n);function n(e){return hy(this,n),t.call(this,e.x,e.y)}return vy(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Zre.WIDTH,Zre.HEIGHT)?xB.success(new n(e)):xB.failure("Move out of board")}}]),n}(Ate);qre.encoder=function(){function e(){hy(this,e)}return vy(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){ey(a,r);var i=ny(a);function a(){var e;return hy(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return vy(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new hte((r-=r%1)%e,i);return n(a)}}]),a}(Y7))}}]),e}().getEncoder(Zre.WIDTH,Zre.HEIGHT,function(e){return qre.of(e).get()});var Wre=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Zre.WIDTH,Zre.HEIGHT)&&t.isInRange(Zre.WIDTH,Zre.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?xB.success(new n(e,t)):xB.failure($re.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):xB.failure("Move out of board")}}]),n}(xne);Wre.encoder=xne.getEncoder(Zre.WIDTH,Zre.HEIGHT,function(e,t){return Wre.of(e,t).get()});var jre=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).coords=e,r}return vy(n,[{key:"addJump",value:function(e){var t=n9.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return xB.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=cy(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Zre.WIDTH,Zre.HEIGHT))return xB.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return xB.failure($re.INVALID_JUMP());return new jne(e).size()===e.length?xB.success(new n(e)):xB.failure($re.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(Ite);jre.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).coordEncoder=hte.numberEncoder(Zre.WIDTH,Zre.HEIGHT),e}return vy(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){D7(null!=OB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=OB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return jre.of(t).get()}}]),n}(j7));var Yre=j7.disjunction3(qre.encoder,Wre.encoder,jre.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Kre=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,Zre)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=Q7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=Q7.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Zre(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?xB.failure($re.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?xB.failure($re.MUST_DROP_IN_CENTRAL_ZONE()):xB.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?xB.failure($re.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):xB.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return xB.failure($re.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE());var n,r=cy(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===Q7.NONE)return xB.failure($re.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=cy(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return xB.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new hte(e.x+2,e.y),new hte(e.x-2,e.y),new hte(e.x,e.y+2),new hte(e.x,e.y-2),new hte(e.x+2,e.y+2),new hte(e.x+2,e.y-2),new hte(e.x-2,e.y+2),new hte(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];jre.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=cy(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=cy(Zre.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return Fte.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Fte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=MB.of(new n)),n.singleton.get()}}]),n}(Ute);Kre.singleton=MB.empty();var Qre=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}},{key:"sortByNumberOfJump",value:function(e){return e.sort(function(e,t){var n=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(t.isDrop()?1:t.isSimple()?2:t.coords.length)-n})}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Zre.CENTRAL_ZONE_TOP_LEFT,r=Zre.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===Q7.NONE&&t.push(qre.of(new hte(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Zre.HEIGHT;r++)for(var i=0;i<Zre.WIDTH;i++){var a=new hte(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new hte(t.x+1,t.y),new hte(t.x-1,t.y),new hte(t.x,t.y+1),new hte(t.x,t.y-1),new hte(t.x+1,t.y+1),new hte(t.x+1,t.y-1),new hte(t.x-1,t.y+1),new hte(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Wre.of(t,a);o.isSuccess()&&Kre.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new Ste,i=cy(Kre.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=jre.of([t,a]).get();Kre.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Kre.get().nextJumps(t,e),i=new Ste(r),a=cy(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new xte([{key:X7.ZERO,value:0},{key:X7.ONE,value:0}]),i=0;i<Zre.HEIGHT;i++)for(var a=0;a<Zre.WIDTH;a++){var o=new hte(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new Ete(s.getVictoryValue())}else{var u,c=100,l=cy(Zre.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===Q7.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new Ete(n)}}]),n}(_te),Xre=Q7.NONE,Jre=Q7.ZERO,eie=Q7.ONE,tie=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(cn||(cn=Gg(["Board and aim of the game"]))),$localize(ln||(ln=Gg(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Zre.getInitialState()),Hte.anyMove($localize(fn||(fn=Gg(["Initial phase"]))),$localize(hn||(hn=Gg(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Zre.getInitialState(),qre.of(new hte(7,7)).get(),$localize(dn||(dn=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(vn||(vn=Gg(["Simple move"]))),$localize(pn||(pn=Gg(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Zre([[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,Jre,eie,eie,Jre,Jre,eie,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,eie,Jre,eie,Jre,Jre,Jre,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,eie,Xre,Xre,Xre,Xre,Xre,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,Jre,eie,eie,eie,Jre,Jre,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,eie,eie,eie,eie,eie,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre]],40),Wre.of(new hte(4,6),new hte(3,5)).get(),function(e,t,n){return e.isSimple()?LB.SUCCESS:LB.failure($localize(gn||(gn=Gg(["You have made a jump, not a simple move. Try again!"]))))},$localize(yn||(yn=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(mn||(mn=Gg(["Jumps"]))),$localize(kn||(kn=Gg(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Zre([[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,Jre,eie,eie,Jre,Jre,eie,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,eie,Jre,eie,Jre,Jre,Jre,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,eie,Xre,Xre,Xre,Xre,Xre,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,Jre,eie,eie,eie,Jre,Jre,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,eie,eie,eie,eie,eie,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre]],40),jre.of([new hte(6,7),new hte(6,5)]).get(),function(e,t,n){return e.isJump()?LB.SUCCESS:LB.failure($localize(Cn||(Cn=Gg(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=Gg(["Congratulations!"])))),Hte.fromMove($localize(_n||(_n=Gg(["Chaining jumps in a single move"]))),$localize(En||(En=Gg(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Zre([[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,eie,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,eie,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,eie,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,Jre,Xre,eie,Jre,Jre,eie,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,Xre,Jre,eie,Jre,Jre,Jre,Jre,eie,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,eie,Xre,Xre,Xre,Xre,Xre,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,Jre,eie,eie,eie,Jre,Jre,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,eie,Jre,eie,eie,eie,eie,eie,eie,Jre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre]],40),[jre.of([new hte(8,6),new hte(6,4),new hte(6,2),new hte(6,0)]).get()],$localize(bn||(bn=Gg(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Sn||(Sn=Gg(["You have not performed a triple jump. Try again!"]))))]});function nie(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",9),IS("click",function(){tC(n);var e=MS().$implicit;return MS(2).onClick(e.coord)}),_S()}if(2&e){var r=MS().$implicit,i=MS(2);fS("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function rie(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",6),IS("click",function(){tC(n);var e=MS().$implicit;return MS(2).onClick(e.coord)}),_S()}if(2&e){var r=MS(),i=r.index,a=r.$implicit,o=MS().index,s=MS();DS("id","piece_",i,"_",o,""),kS("ngClass",a.pieceClasses),fS("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function iie(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",6),IS("click",function(){var e=tC(n).$implicit;return MS(2).onClick(e.coord)}),_S(),gS(2,nie,1,4,"rect",7),gS(3,rie,1,6,"circle",8),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","click_",i,"_",a,""),kS("ngClass",r.squareClasses),fS("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r.isShelter),LE(1),kS("ngIf",r.hasPiece)}}function aie(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,iie,4,9,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function oie(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",10),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),kS("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),fS("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function sie(e,t){if(1&e&&(AC(),ES(0,"circle",11)),2&e){var n=t.$implicit,r=MS();NS("id","sidePiece_0_",n,""),fS("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function uie(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=t.$implicit,r=MS();NS("id","sidePiece_1_",n,""),fS("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function cie(e,t){if(1&e&&(AC(),ES(0,"rect",13)),2&e){var n=MS();fS("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var lie=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).ALL_SHELTERS=Zre.ALL_SHELTERS,r.CENTRAL_ZONE_START=Zre.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new ote(Zre.CENTRAL_ZONE_BOTTOM_RIGHT.x-Zre.CENTRAL_ZONE_TOP_LEFT.x+1,Zre.CENTRAL_ZONE_BOTTOM_RIGHT.y-Zre.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=MB.empty(),r.jumpInConstruction=MB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=Kre.get(),r.availableMinimaxes=[new Qre(r.rules,"ConspirateursMinimax")],r.encoder=Yre,r.tutorial=(new tie).tutorial,r}return vy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Zre.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Zre.WIDTH;n++){var r=new hte(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=cy(Zre.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=cy(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Kre.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=cy(Zre.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=cy(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=MB.empty(),this.selected=MB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected.equalsValue(e)?t.cancelMoveAttempt():(t.selected=MB.of(e),t.jumpInConstruction=MB.empty()),t.updateViewInfo(),LB.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=qre.of(e),n.abrupt("return",(D7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=MB.of(e),t.updateViewInfo(),LB.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Wre.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=jre.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(dte);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-conspirateurs"]],features:[Xb],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,aie,2,1,"g",1),gS(2,oie,2,5,"g",1),gS(3,sie,1,4,"circle",2),gS(4,uie,1,4,"circle",3),gS(5,cie,1,4,"rect",4),ES(6,"polyline",5),_S()),2&e&&(LE(1),kS("ngForOf",t.viewInfo.boardInfo),LE(1),kS("ngForOf",t.ALL_SHELTERS),LE(1),kS("ngForOf",t.range(t.viewInfo.sidePieces[0])),LE(1),kS("ngForOf",t.range(t.viewInfo.sidePieces[1])),LE(1),kS("ngIf",t.viewInfo.dropPhase),LE(1),fS("points",t.viewInfo.lastMoveArrow))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fie=function(){function e(t,n){hy(this,e),this.owner=t,this.otherPieceType=n}return vy(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===X7.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===X7.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();fie.encoder=Y7.tuple([X7.numberEncoder,Y7.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return fie.of(e[0],e[1])}),fie.EMPTY=new fie(Q7.NONE,!1),fie.ZERO_FIRST=new fie(X7.ZERO,!1),fie.ZERO_SECOND=new fie(X7.ZERO,!0),fie.ONE_FIRST=new fie(X7.ONE,!1),fie.ONE_SECOND=new fie(X7.ONE,!0),fie.PLAYER_PIECES=[fie.ZERO_FIRST,fie.ZERO_SECOND,fie.ONE_FIRST,fie.ONE_SECOND];var hie=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;if(hy(this,n),(i=t.call(this)).target=e,i.piece=r,r===fie.EMPTY)throw new Error("Cannot drop an empty piece");return ry(i)}return vy(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(Ite);hie.encoder=Y7.tuple([Y7.numberEncoder(7),fie.encoder],function(e){return[e.target,e.piece]},function(e){return new hie(e[0],e[1])});var die=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return vy(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new hte(e.x,3-e.y),t)}}]),n}(Ite);die.encoder=Y7.tuple([hte.numberEncoder(8,4),Y7.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new die(e[0],e[1]?"clockwise":"counterclockwise")});var vie=Y7.disjunction(hie.encoder,die.encoder,function(e){return e.isDrop()}),pie=function(){var e=vy(function e(){hy(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Pn||(Pn=Gg(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(On||(On=Gg(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Tn||(Tn=Gg(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(In||(In=Gg(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(An||(An=Gg(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),gie=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return vy(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==fie.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=fie.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==fie.EMPTY&&i[n.pieceIndex(s)]--}return D7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case fie.ZERO_FIRST:return 0;case fie.ZERO_SECOND:return 1;case fie.ONE_FIRST:return 2;default:return OB.expectToBe(e,fie.ONE_SECOND),3}}}]),n}(Ote);return e.WIDTH=8,e.HEIGHT=4,e}(),yie=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,gie)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=n9.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=n9.copyImmutableArray(t.remainingPieces);return r[gie.pieceIndex(e.piece)]-=1,new gie(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=n9.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<gie.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==fie.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=fie.EMPTY,i++,a++;return new gie(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?xB.failure(pie.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===gie.HEIGHT?xB.failure(pie.SPACE_IS_FULL()):xB.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>gie.HEIGHT?xB.failure(pie.TARGET_STACK_TOO_HIGH()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return D7(n.owner.isPlayer(),"highest alignment is owned by a player"),Fte.getVictory(n.owner)}return Fte.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<gie.WIDTH/2;t++)for(var n=gie.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+gie.WIDTH/2,n);if(r!==fie.EMPTY&&r===i)return MB.of(new hte(t,n))}return MB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new die(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new die(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=MB.of(new n)),n.singleton.get()}}]),n}(Ute);yie.singleton=MB.empty();var mie=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=cy(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new die(i,"clockwise"),new die(i,"counterclockwise")];a<o.length;a++){var s=o[a];yie.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<gie.WIDTH;r++){var i,a=cy(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new hie(r,o);yie.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=cy(fie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<gie.HEIGHT;r++)for(var i=0;i<gie.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new hte(i,r));return t}},{key:"getBoardValue",value:function(e){var t=yie.get().getGameStatus(e);return new Ete(t.isEndGame?t.toBoardValue():0)}}]),n}(_te),kie=fie.EMPTY,Cie=fie.ZERO_FIRST,wie=fie.ZERO_SECOND,_ie=fie.ONE_FIRST,Eie=fie.ONE_SECOND,bie=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Rn||(Rn=Gg(["Initial board and player pieces"]))),$localize(Mn||(Mn=Gg(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),gie.getInitialState()),Hte.fromMove($localize(xn||(xn=Gg(["Goal of the game"]))),$localize(Nn||(Nn=Gg(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),gie.fromRepresentation([[kie,kie,kie,kie,kie,kie,kie,kie],[kie,kie,kie,kie,kie,kie,kie,kie],[kie,kie,kie,kie,_ie,kie,kie,kie],[Cie,kie,kie,kie,Cie,kie,kie,kie]],3),[new hie(0,fie.ONE_FIRST)],$localize(Dn||(Dn=Gg(["Congratulations, you won!"]))),$localize(Ln||(Ln=Gg(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Hte.fromMove($localize(Fn||(Fn=Gg(["Types of move"]))),$localize(Un||(Un=Gg(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),gie.fromRepresentation([[kie,kie,kie,kie,kie,kie,kie,kie],[kie,kie,kie,kie,Eie,kie,kie,kie],[kie,kie,kie,kie,Cie,kie,kie,kie],[_ie,kie,kie,kie,wie,kie,kie,kie]],4),[die.fromRepresentation(new hte(4,3),"counterclockwise"),die.fromRepresentation(new hte(4,3),"clockwise"),die.fromRepresentation(new hte(4,2),"counterclockwise"),die.fromRepresentation(new hte(4,2),"clockwise")],$localize(Vn||(Vn=Gg(["Congratulations!"]))),$localize(Bn||(Bn=Gg(["Failed, try to move one of your piece that is already on the board."])))),Hte.fromMove($localize(zn||(zn=Gg(["Special case"]))),$localize(Hn||(Hn=Gg(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),gie.fromRepresentation([[kie,kie,kie,kie,Cie,kie,kie,kie],[kie,kie,kie,kie,Eie,kie,kie,Cie],[kie,kie,kie,kie,Cie,kie,kie,Eie],[kie,_ie,kie,kie,wie,kie,kie,_ie]],8),[die.fromRepresentation(new hte(4,2),"counterclockwise")],$localize(Gn||(Gn=Gg(["Congratulations!"]))),$localize($n||($n=Gg(["Failed, try to shift a stack of pieces to the left."]))))]});function Sie(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"path",5),IS("click",function(){var e=tC(n).$implicit;return MS().onSpaceClick(e)}),_S(),wS(2,"path",6),IS("click",function(){var e=tC(n).$implicit;return MS().onSpaceClick(e)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),NS("id","click_",r,""),kS("ngClass",i.viewInfo.boardInfo[r].spaceClasses),fS("d",i.BOARD_PATHS[r]),LE(1),kS("ngClass",i.viewInfo.boardInfo[r].spaceClasses),fS("d",i.DECORATION_PATHS[r])}}function Pie(e,t){if(1&e){var n=PS();AC(),wS(0,"g",8),IS("click",function(){var e=tC(n).$implicit,t=MS().$implicit;return MS().onPieceInGameClick(t,e.y)}),ES(1,"use",9),ES(2,"use",10),_S()}if(2&e){var r=t.$implicit;DS("id","click_",MS().$implicit,"_",r.y,""),kS("ngClass",r.foregroundClasses),LE(1),kS("ngClass",r.backgroundClasses),fS("x",r.drawPosition.x)("y",r.drawPosition.y),LE(1),fS("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Oie(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Pie,3,8,"g",7),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function Tie(e,t){if(1&e){var n=PS();AC(),wS(0,"g",12),IS("click",function(){var e=tC(n),t=e.$implicit,r=e.index;return MS(2).onRemainingPieceClick(t.actualPiece,r)}),ES(1,"use",9),ES(2,"use",10),_S()}if(2&e){var r=t.$implicit,i=t.index;LS("id","piece_",r.actualPiece.owner.toString(),"_",r.actualPiece.otherPieceType?1:0,"_",i,""),kS("ngClass",r.foregroundClasses),LE(1),kS("ngClass",r.backgroundClasses),fS("x",r.drawPosition.x)("y",r.drawPosition.y),LE(1),fS("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Iie(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Tie,3,9,"g",11),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",r.viewInfo.remainingPieces.get(n).get())}}var Aie=function(){return[0,1,2,3,4,5,6,7]},Rie=function(){return[2,1,3,0,4,7,5,6]},Mie=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=MB.empty(),r.viewInfo={boardInfo:[],remainingPieces:new xte([{key:X7.ZERO,value:[]},{key:X7.ONE,value:[]}])},r.rules=yie.get(),r.availableMinimaxes=[new mie(r.rules,"DiamDummyMinimax")],r.encoder=vie,r.tutorial=(new bie).tutorial,r}return vy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new hie(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%gie.WIDTH!==e){n.next=10;break}i=new die(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(gie.WIDTH-1))%gie.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(pie.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new die(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(pie.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new hte(e,t),r.abrupt("return",n.getState().getPieceAt(a).owner===n.getCurrentPlayer()?(n.isSelected(null,a)?n.cancelMoveAttempt():n.selected=MB.of({type:"pieceFromBoard",position:a}),n.updateViewInfo(),LB.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()));case 5:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay(n.getPieceId(e,t)),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?MB.empty():MB.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),LB.SUCCESS):n.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceId",value:function(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}},{key:"isSelected",value:function(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new hte(r,i);return[{start:MB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<gie.HEIGHT&&t.getPieceAtXY(n,o)!==fie.EMPTY;o++,i++)a.push({start:MB.of(new hte(n,o)),end:new hte(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<gie.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;D7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<gie.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;D7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=cy(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new xte([{key:X7.ZERO,value:[]},{key:X7.ONE,value:[]}]);var t,n=this.isPlayerTurn(),r=cy(fie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover");var u=this.viewInfo.remainingPieces.get(i.owner).get();u.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i}),this.viewInfo.remainingPieces.put(i.owner,u)}}catch(c){r.e(c)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===X7.ZERO?-100:600,i=e.otherPieceType?100:450,new hte(r,i).getNext(new ote(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<gie.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new hte(e,i);if(a!==fie.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new ote(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=MB.empty(),this.updateBoard()}}]),n}(dte);Mie.CENTER=[new hte(40,160),new hte(100,50),new hte(255,2),new hte(400,50),new hte(460,160),new hte(400,270),new hte(255,320),new hte(100,270)],Mie.PIECE_HEIGHT=36,Mie.\u0275fac=function(e){return new(e||Mie)(mS(x7))},Mie.\u0275cmp=lk({type:Mie,selectors:[["app-diam"]],features:[Xb],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"defs"),wS(2,"g",1),ES(3,"path",2),ES(4,"ellipse",3),_S(),_S(),gS(5,Sie,3,5,"g",4),gS(6,Oie,2,1,"g",4),gS(7,Iie,2,1,"g",4),_S()),2&e&&(LE(5),kS("ngForOf",PT(3,Aie)),LE(1),kS("ngForOf",PT(4,Rie)),LE(1),kS("ngForOf",t.Player.PLAYERS))},directives:[rR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var xie=function(){function e(t,n){hy(this,e),this.offset=t,this.constant=n}return vy(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return gte.DOWN;case"r":return gte.RIGHT;case"s":return gte.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?MB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?MB.of(e.constantR(a)):r!==i&&a!==o&&s===u?MB.of(e.constantS(s)):MB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=cy(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),Nie=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,D7(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return vy(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=cy(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(xie.constantQ(t));for(var n=0;n<this.height;n++)e.push(xie.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(xie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new hte(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new hte(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new hte(e.offset,0):new hte(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=N7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new hte(e.x+t,e.y-t),new hte(e.x+t,e.y),new hte(e.x-t,e.y+t),new hte(e.x-t,e.y),new hte(e.x,e.y+t),new hte(e.x,e.y-t)]}}]),n}(Ote),Die=function(){function e(t,n,r){hy(this,e),this.owner=t,this.size=n,this.source=r}return vy(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Die.sizeEncoder=Y7.numberEncoder(49),Die.encoder=Y7.tuple([Y7.booleanEncoder,X7.numberEncoder,Die.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Die(e[1],e[2],e[0])}),Die.MAX_SIZE=49,Die.EMPTY=new Die(Q7.NONE,0,!1),Die.UNREACHABLE=new Die(Q7.NONE,-1,!1),Die.PLAYER_ZERO=new Die(X7.ZERO,1,!1),Die.PLAYER_ONE=new Die(X7.ONE,1,!1),Die.SOURCE=new Die(Q7.NONE,1,!0);var Lie=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Die.EMPTY)).alreadyPassed=i,a}return vy(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new hte(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return Nie.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=n9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Die.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=Die.UNREACHABLE,t=Die.PLAYER_ZERO,n=Die.PLAYER_ONE,r=Die.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Die.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(Nie);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e}(),Fie=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Lie.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Lie.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(xne);Fie.PASS=new Fie(new hte(-1,-1),new hte(-2,-2)),Fie.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Fie.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Fie(new hte((e=e/16|0)%16,r),new hte(n,t))}}]),n}(Y7));var Uie=function(){var e=vy(function e(){hy(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Zn||(Zn=Gg(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=Gg(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Wn||(Wn=Gg(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(jn||(jn=Gg(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Yn||(Yn=Gg(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Kn||(Kn=Gg(["The stack must land on an occupied space."])))},e}(),Vie=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isMovablePiece",value:function(e,t){D7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?LB.failure(Uie.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?LB.failure(Uie.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?LB.SUCCESS:LB.failure(Uie.CANT_REACH_TARGET()):LB.failure(Uie.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;Nie.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=n9.createTable(Lie.WIDTH,Lie.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Die.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===Fie.PASS)return new Lie(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Die.EMPTY).setAt(e.end,Die.append(r,i));return this.removeDisconnectedPieces(new Lie(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==Fie.PASS||t.alreadyPassed?xB.failure(wte.MUST_PASS()):xB.success(void 0);if(e===Fie.PASS)return xB.failure(wte.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?xB.failure(Uie.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?xB.failure(Uie.EMPTY_TARGET_STACK()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Fte.ZERO_WON:r[0]<r[1]?Fte.ONE_WON:Fte.DRAW:Fte.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==Nie.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return Nie.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(X7.ZERO)?t+=i.getSize():i.belongsTo(X7.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Ute),Bie=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Vie.getMovablePieces(n).forEach(function(e){return Vie.pieceTargets(n,e).forEach(function(t){var n=Fie.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(Fie.PASS)&&r.push(Fie.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Vie.getScores(t);return 0===Vie.getMovablePieces(t).length?new Ete(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new Ete(n[0]-n[1])}}]),n}(_te),zie=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=Xg(oy(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return n9.sortByDescending(r,function(e){D7(e!==Fie.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Vie.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n=e.gameState,r=Vie.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(X7.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(X7.ONE)}).length;return new Ete((s*r[1]-o*r[0])/a)}}]),n}(Bie),Hie=Die.EMPTY,Gie=Die.UNREACHABLE,$ie=Die.SOURCE,Zie=Die.PLAYER_ZERO,qie=Die.PLAYER_ONE,Wie=new Die(X7.ZERO,2,!1),jie=new Die(X7.ONE,2,!1),Yie=new Die(X7.ZERO,4,!1),Kie=new Die(X7.ONE,4,!1),Qie=vy(function e(){hy(this,e),this.tutorial=[Hte.anyMove($localize(Qn||(Qn=Gg(["Moving"]))),$localize(Xn||(Xn=Gg(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Lie.getInitialState(),Fie.of(new hte(2,0),new hte(3,0)),$localize(Jn||(Jn=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(er||(er=Gg(["Disconnection"]))),$localize(tr||(tr=Gg(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Lie([[Gie,Gie,qie,$ie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Gie,Hie,Zie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Hie,Hie,Kie,Hie,Hie,Hie,Hie,qie,$ie,Hie,Hie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie,Gie]],0,!1),Fie.of(new hte(2,1),new hte(2,0)),function(e,t,n){return e.end.equals(new hte(3,0))?LB.failure($localize(nr||(nr=Gg(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(D7(e.end.equals(new hte(2,0)),"player made an impossible move"),LB.SUCCESS)},$localize(rr||(rr=Gg(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Hte.fromPredicate($localize(ir||(ir=Gg(["Moving on a source"]))),$localize(ar||(ar=Gg(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Lie([[Gie,Gie,$ie,qie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Gie,Zie,Zie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Hie,qie,Zie,qie,Hie,Hie,Zie,jie,$ie,Hie,Hie],[Hie,Hie,qie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie,Gie]],0,!1),Fie.of(new hte(2,1),new hte(2,0)),function(e,t,n){return e.end.equals(new hte(2,0))?LB.SUCCESS:LB.failure($localize(or||(or=Gg(["You have not taken possession of a source, try again."]))))},$localize(sr||(sr=Gg(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Hte.informational($localize(ur||(ur=Gg(["Passing"]))),$localize(cr||(cr=Gg(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Lie([[Gie,Gie,$ie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Gie,Hie,Wie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Hie,Hie,jie,Hie,Hie,Hie,Hie,jie,$ie,Yie,Hie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie,Gie]],0,!1)),Hte.fromMove($localize(lr||(lr=Gg(["End of the game"]))),$localize(fr||(fr=Gg(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Lie([[Gie,Gie,$ie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Gie,Hie,Zie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,$ie,Yie,Hie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie],[Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Hie,Gie,Gie]],0,!1),[Fie.of(new hte(2,1),new hte(2,0))],$localize(hr||(hr=Gg(["Congratulations, you won 6 - 0!"]))),$localize(dr||(dr=Gg(["Bad idea, by moving on the source you would have won a point."]))))]});function Xie(e,t){if(1&e&&(AC(),ES(0,"circle",10)),2&e){var n=MS().$implicit,r=MS().$implicit,i=MS();kS("ngClass",i.getPieceClasses(n)),fS("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Jie(e,t){if(1&e&&(AC(),ES(0,"polygon",11)),2&e){var n=MS().$implicit,r=MS().$implicit,i=MS();fS("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function eae(e,t){if(1&e){var n=PS();AC(),wS(0,"text",12),IS("click",function(){tC(n);var e=MS(2).$implicit;return MS().onClick(e.x,e.y)}),iP(1),_S()}if(2&e){var r=MS().$implicit,i=MS().$implicit,a=MS();fS("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),LE(1),aP(r.getSize())}}function tae(e,t){if(1&e){var n=PS();AC(),wS(0,"g",5),IS("click",function(){tC(n);var e=MS().$implicit;return MS().onClick(e.x,e.y)}),ES(1,"polygon",6),gS(2,Xie,1,4,"circle",7),gS(3,Jie,1,1,"polygon",8),gS(4,eae,2,3,"text",9),_S()}if(2&e){var r=t.$implicit,i=MS().$implicit,a=MS();DS("id","click_",i.x,"_",i.y,""),LE(1),fS("points",a.getHexaCoordsAt(i)),LE(1),kS("ngIf",r.getSize()>0),LE(1),kS("ngIf",r.containsSource()),LE(1),kS("ngIf",r.getSize()>1)}}var nae=function(e){return[e]};function rae(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,tae,5,6,"g",4),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",OT(1,nae,r.state.getPieceAt(n)))}}function iae(e,t){if(1&e&&(AC(),wS(0,"text",16),iP(1),_S()),2&e){var n=MS().$implicit,r=MS();fS("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),LE(1),aP(n.caseContent.getSize())}}function aae(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"polygon",13),ES(2,"circle",14),gS(3,iae,2,3,"text",15),_S()),2&e){var n=t.$implicit,r=MS();LE(1),fS("points",r.getHexaCoordsAt(n.coord)),LE(1),DS("id","captured_",n.coord.x,"_",n.coord.y,""),kS("ngClass",r.getPieceClasses(n.caseContent)),fS("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),LE(1),kS("ngIf",n.caseContent.getSize()>1)}}function oae(e,t){if(1&e&&(AC(),bS(0),ES(1,"polygon",17),ES(2,"polygon",17),SS()),2&e){var n=MS();LE(1),fS("points",n.getHexaCoordsAt(n.lastMove.get().coord)),LE(1),fS("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function sae(e,t){if(1&e&&(AC(),ES(0,"polygon",18)),2&e){var n=MS();fS("points",n.getHexaCoordsAt(n.chosen.get()))}}var uae=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).lastMove=MB.empty(),r.chosen=MB.empty(),r.disconnecteds=[],r.rules=new Vie(Lie),r.availableMinimaxes=[new Bie(r.rules,"DvonnMinimax"),new zie(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=Fie.encoder,r.tutorial=(new Qie).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=MB.of(Vie.getScores(r.rules.node.gameState)),r.hexaLayout=new yte(1.5*r.SPACE_SIZE,new hte(-r.SPACE_SIZE,2*r.SPACE_SIZE),kte.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return vy(n,[{key:"hideLastMove",value:function(){this.lastMove=MB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=MB.of(Vie.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new hte(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new hte(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=MB.empty()}},{key:"pass",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(Fie.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new hte(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),LB.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new hte(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=MB.of(n),LB.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new hte(e,t),o=Fie.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(vte);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-dvonn"]],features:[Xb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,rae,2,3,"g",1),gS(2,aae,4,8,"g",1),gS(3,oae,3,2,"ng-container",2),gS(4,sae,1,1,"polygon",3),_S()),2&e&&(LE(1),kS("ngForOf",t.state.allCoords()),LE(1),kS("ngForOf",t.disconnecteds),LE(1),kS("ngIf",t.lastMove.isPresent()),LE(1),kS("ngIf",t.chosen.isPresent()))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),cae=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(cae||(cae={})),cae),lae=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return X7.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return X7.ONE;default:return Q7.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return cae.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return cae.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return cae.SMALL;default:return OB.expectToBe(this,e.NONE),cae.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return OB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===X7.ZERO&&t===cae.BIG?e.BIG_DARK:n===X7.ZERO&&t===cae.MEDIUM?e.MEDIUM_DARK:n===X7.ZERO&&t===cae.SMALL?e.SMALL_DARK:n===X7.ONE&&t===cae.BIG?e.BIG_LIGHT:n===X7.ONE&&t===cae.MEDIUM?e.MEDIUM_LIGHT:n===X7.ONE&&t===cae.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();lae.SMALL_DARK=new lae(0),lae.SMALL_LIGHT=new lae(1),lae.MEDIUM_DARK=new lae(2),lae.MEDIUM_LIGHT=new lae(3),lae.BIG_DARK=new lae(4),lae.BIG_LIGHT=new lae(5),lae.NONE=new lae(6);var fae=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return vy(n,[{key:"getRemainingPieces",value:function(){return n9.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new hae(Q7.NONE,Q7.NONE,Q7.NONE).encode(),t=n9.createTable(3,3,e);return new n(n9.mapBiArray(t,function(e){return hae.decode(e)}),0,[lae.BIG_DARK,lae.BIG_DARK,lae.BIG_LIGHT,lae.BIG_LIGHT,lae.MEDIUM_DARK,lae.MEDIUM_DARK,lae.MEDIUM_LIGHT,lae.MEDIUM_LIGHT,lae.SMALL_DARK,lae.SMALL_DARK,lae.SMALL_LIGHT,lae.SMALL_LIGHT])}}]),n}(Ote),hae=function(){function e(t,n,r){hy(this,e),this.small=t,this.medium=n,this.big=r}return vy(e,[{key:"isEmpty",value:function(){return this.small===Q7.NONE&&this.medium===Q7.NONE&&this.big===Q7.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(lae.ofSizeAndPlayer(cae.SMALL,this.small)),this.medium.isPlayer()&&e.push(lae.ofSizeAndPlayer(cae.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(lae.ofSizeAndPlayer(cae.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=lae.ofSizeAndPlayer(cae.SMALL,this.small),t=lae.ofSizeAndPlayer(cae.MEDIUM,this.medium),n=lae.ofSizeAndPlayer(cae.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===X7.ZERO?lae.BIG_DARK:this.big===X7.ONE?lae.BIG_LIGHT:this.medium===X7.ZERO?lae.MEDIUM_DARK:this.medium===X7.ONE?lae.MEDIUM_LIGHT:this.small===X7.ZERO?lae.SMALL_DARK:this.small===X7.ONE?lae.SMALL_LIGHT:lae.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===lae.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?MB.of(this.put(e)):MB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===lae.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case cae.BIG:t=new e(this.small,this.medium,Q7.NONE);break;case cae.MEDIUM:t=new e(this.small,Q7.NONE,Q7.NONE);break;default:OB.expectToBe(r,cae.SMALL),t=new e(Q7.NONE,Q7.NONE,Q7.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===lae.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case cae.BIG:return new e(this.small,this.medium,n);case cae.MEDIUM:return D7(this.big===Q7.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return OB.expectToBe(r,cae.SMALL),D7(this.big===Q7.NONE,"Cannot put a piece on top of a bigger one"),D7(this.medium===Q7.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){D7(t%1==0,"EncapsuleCase must be encoded as integer: "+t),D7(t>=0,"To small representation for EncapsuleCase: "+t),D7(t<=26,"To big representation for EncapsuleCase: "+t);var n=X7.numberEncoder.decodeNumber(t%3);t-=n.value;var r=X7.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,X7.numberEncoder.decodeNumber(t/=3))}}]),e}();hae.EMPTY=new hae(Q7.NONE,Q7.NONE,Q7.NONE);var dae=function(){var e=vy(function e(){hy(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(vr||(vr=Gg(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(pr||(pr=Gg(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(gr||(gr=Gg(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(yr||(yr=Gg(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.END_YOUR_MOVE=function(){return $localize(mr||(mr=Gg(["You are performing a move, you must select a landing square."])))},e}(),vae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=hae.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=hae.decode(c).removeBiggest();i[u.y][u.x]=hae.decode(l.removedCase.encode()),r=l.removedPiece}return new fae(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=cy(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return MB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===Q7.NONE?MB.empty():t[0]===t[1]&&t[1]===t[2]?MB.of(t[0]):MB.empty()}},{key:"isLegal",value:function(e,t){var n;if(TB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return xB.failure(dae.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?xB.success(i.get()):xB.failure(dae.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Fte.getVictory(t.get()):Fte.ONGOING}}]),n}(Ute);vae.LINES=[[new hte(0,0),new hte(0,1),new hte(0,2)],[new hte(1,0),new hte(1,1),new hte(1,2)],[new hte(2,0),new hte(2,1),new hte(2,2)],[new hte(0,0),new hte(1,0),new hte(2,0)],[new hte(0,1),new hte(1,1),new hte(2,1)],[new hte(0,2),new hte(1,2),new hte(2,2)],[new hte(0,0),new hte(1,1),new hte(2,2)],[new hte(0,2),new hte(1,1),new hte(2,0)]];var pae=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return vy(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(MB.of(e),t,MB.empty())}},{key:"fromDrop",value:function(e,t){return new n(MB.empty(),t,MB.of(e))}}]),n}(Ite);pae.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new hte(r,n);if(0===t){var a=lae.of(e);return pae.fromDrop(a,i)}var o=e%3;e-=o;var s=new hte((e/=3)%3,o);return pae.fromMove(s,i)}}]),n}(Y7));var gae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=vae.getGameStatus(e);return new Ete(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=bte.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new hte(s,o),l=cy(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=pae.fromDrop(f,c);vae.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new hte(v,d);if(!p.equals(c)){var g=pae.fromMove(c,p);vae.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(_te),yae=new hae(Q7.NONE,Q7.NONE,Q7.NONE),mae=new hae(X7.ZERO,Q7.NONE,Q7.NONE),kae=new hae(Q7.NONE,X7.ZERO,Q7.NONE),Cae=new hae(Q7.NONE,Q7.NONE,X7.ZERO),wae=new hae(X7.ONE,Q7.NONE,Q7.NONE),_ae=new hae(Q7.NONE,Q7.NONE,X7.ONE),Eae=new hae(X7.ONE,X7.ZERO,Q7.NONE),bae=new hae(X7.ZERO,X7.ZERO,Q7.NONE),Sae=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(kr||(kr=Gg(["Goal of the game"]))),$localize(Cr||(Cr=Gg(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new fae([[mae,wae,_ae],[yae,kae,yae],[yae,yae,Cae]],0,[lae.SMALL_DARK,lae.MEDIUM_DARK,lae.BIG_DARK,lae.SMALL_LIGHT,lae.MEDIUM_LIGHT,lae.MEDIUM_LIGHT,lae.BIG_LIGHT])),Hte.anyMove($localize(wr||(wr=Gg(["Putting a piece"]))),$localize(_r||(_r=Gg(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),fae.getInitialState(),pae.fromDrop(lae.SMALL_DARK,new hte(1,1)),$localize(Er||(Er=Gg(["Congratulations!"])))),Hte.fromMove($localize(br||(br=Gg(["Moving"]))),$localize(Sr||(Sr=Gg(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new fae([[mae,_ae,yae],[yae,yae,yae],[yae,yae,yae]],0,[]),[pae.fromMove(new hte(0,0),new hte(2,0)),pae.fromMove(new hte(0,0),new hte(0,1)),pae.fromMove(new hte(0,0),new hte(1,1)),pae.fromMove(new hte(0,0),new hte(2,1)),pae.fromMove(new hte(0,0),new hte(0,2)),pae.fromMove(new hte(0,0),new hte(1,2)),pae.fromMove(new hte(0,0),new hte(2,2))],$localize(Pr||(Pr=Gg(["Congratulations!"]))),$localize(Or||(Or=Gg(["Failed. Try again."])))),Hte.fromPredicate($localize(Tr||(Tr=Gg(["Particularity"]))),$localize(Ir||(Ir=Gg(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new fae([[Eae,yae,wae],[bae,_ae,_ae],[yae,yae,yae]],0,[lae.MEDIUM_DARK,lae.BIG_DARK,lae.MEDIUM_LIGHT,lae.MEDIUM_LIGHT]),pae.fromMove(new hte(0,1),new hte(0,2)),function(e,t,n){if(e.landingCoord.equals(new hte(0,2))){if(e.isDropping())return LB.failure($localize(Ar||(Ar=Gg(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new hte(0,1)))return LB.SUCCESS}return LB.failure($localize(Rr||(Rr=Gg(["Failed. Try again."]))))},$localize(Mr||(Mr=Gg(["Congratulations!"]))))]});function Pae(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",6),IS("click",function(){var e=tC(n),t=e.$implicit,r=e.index;return MS().onPieceClick(0,t,r)}),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS();LE(1),DS("id","piece_0_",r.toString(),"_",i,""),kS("ngClass",a.getSidePieceClasses(r,i)),fS("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function Oae(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",9),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onBoardClick(e,t)}),_S()}if(2&e){var r=t.$implicit,i=MS().index,a=MS().index,o=MS();kS("ngClass",o.getPieceClasses(r)),fS("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Tae(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",7),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onBoardClick(e,t)}),_S(),gS(2,Oae,1,4,"circle",8),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","click_",i,"_",a,""),kS("ngClass",o.getRectClasses(i,a)),fS("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngForOf",o.getListPieces(r))}}function Iae(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Tae,3,8,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Aae(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",10),IS("click",function(){tC(n);var e=MS();return e.onBoardClick(e.chosenCoord.get().x,e.chosenCoord.get().y)}),_S()}if(2&e){var r=MS();DS("id","chosenCoord_",r.chosenCoord.get().x,"_",r.chosenCoord.get().y,""),fS("x",r.SPACE_SIZE*r.chosenCoord.get().x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*r.chosenCoord.get().y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Rae(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",6),IS("click",function(){var e=tC(n),t=e.$implicit,r=e.index;return MS().onPieceClick(1,t,r)}),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS();LE(1),DS("id","piece_1_",r.toString(),"_",i,""),kS("ngClass",a.getSidePieceClasses(r,i)),fS("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Mae=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=MB.empty(),r.lastStartingCoord=MB.empty(),r.chosenCoord=MB.empty(),r.chosenPiece=MB.empty(),r.remainingPieceLeftX=[],r.rules=new vae(fae),r.availableMinimaxes=[new gae(r.rules,"EncapsuleMinimax")],r.encoder=pae.encoder,r.tutorial=(new Sae).tutorial,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=MB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=MB.empty(),this.lastStartingCoord=MB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(X7.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new hte(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=MB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=pae.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(dae.INVALID_PIECE_SELECTED()):LB.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",(n.cancelMoveAttempt(),LB.SUCCESS));case 11:return u=pae.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=MB.empty(),this.chosenPiece=MB.empty(),this.chosenPieceIndex=MB.empty()}},{key:"onPieceClick",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a="#piece_"+e+"_"+t.toString()+"_"+n,o=r.canUserPlay(a),i.abrupt("return",o.isFailure()?r.cancelMove(o.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(dae.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece.equalsValue(t)&&r.chosenPieceIndex.equalsValue(n)?(r.chosenPiece=MB.empty(),r.chosenPieceIndex=MB.empty()):(r.chosenPiece=MB.of(t),r.chosenPieceIndex=MB.of(n)),LB.SUCCESS):r.cancelMove(dae.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new hte(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return D7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case cae.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case cae.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return OB.expectToBe(e.getSize(),cae.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(t)&&n.push("selected"),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-encapsule"]],features:[Xb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"g",null,1),gS(3,Pae,2,6,"g",2),_S(),wS(4,"g",null,3),gS(6,Iae,2,1,"g",2),gS(7,Aae,1,6,"rect",4),_S(),wS(8,"g",null,5),gS(10,Rae,2,6,"g",2),_S(),_S()),2&e&&(LE(1),fS("transform","translate("+t.STROKE_WIDTH+", 0)"),LE(2),kS("ngForOf",t.getRemainingPieces(0)),LE(1),fS("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),LE(2),kS("ngForOf",t.board),LE(1),kS("ngIf",t.chosenCoord.isPresent()),LE(1),fS("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),LE(2),kS("ngForOf",t.getRemainingPieces(1)))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),xae=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;if(hy(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return ry(s)}return vy(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Ate);xae.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=cte.factory.fromInt(t);return new xae(a,i,r+1,n+1,o.get())}}]),n}(Y7));var Nae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=Q7.NONE,t=Q7.ZERO,r=Q7.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(Ote),Dae=function(){var e=vy(function e(){hy(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(xr||(xr=Gg(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Nr||(Nr=Gg(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Dr||(Dr=Gg(["Your phalanx must be bigger than the one you are capturing."])))},e.SQUARE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Lr||(Lr=Gg(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Fr||(Fr=Gg(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Ur||(Ur=Gg(["A single piece cannot make a capture."])))},e.SQUARE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Vr||(Vr=Gg(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Br||(Br=Gg(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=function(){return $localize(zr||(zr=Gg(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Hr||(Hr=Gg(["A phalanx cannot contain a piece of the opponent."])))},e}(),Lae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new Nae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(X7.ZERO,0),r=t.count(X7.ONE,11);if(t.turn%2==0){if(n>r)return Fte.ZERO_WON}else if(r>n)return Fte.ONE_WON;return!1===t.doesOwnPiece(X7.ZERO)?Fte.ONE_WON:!1===t.doesOwnPiece(X7.ONE)?Fte.ZERO_WON:Fte.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return xB.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=n9.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:xB.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return LB.failure(Dae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===Q7.NONE)return LB.failure(Dae.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(a===i)return LB.failure(Dae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return LB.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=Q7.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return xB.failure(Dae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return xB.failure(Dae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?xB.failure(Dae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?xB.failure(wte.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=Q7.NONE,n[a.y][a.x]=r,xB.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=Q7.NONE),++a>=n.movedPieces)return xB.failure(Dae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return xB.success(t)}}]),n}(Ute),Fae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return n9.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new Ete(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new hte(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[cte.UP_LEFT,cte.UP,cte.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=Q7.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new hte(u,s);if(o.getPieceAt(c)===n){var l,f=cy(cte.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new xae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new xae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Lae.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(_te),Uae=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=Fae.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return n9.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new Ete(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new hte(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===X7.ZERO?(o=12-n,s=[cte.UP_LEFT,cte.UP,cte.UP_RIGHT]):(o=n+1,s=[cte.DOWN_LEFT,cte.DOWN,cte.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=cy(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(_te),Vae=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return vy(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new hte(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new hte(n,11))===X7.ZERO&&(t+=X7.ZERO.getScoreModifier()),e.getPieceAt(new hte(n,0))===X7.ONE&&(t+=X7.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new hte(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new hte(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===Q7.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new hte(n,0))===X7.ZERO&&(t+=X7.ZERO.getScoreModifier()),e.getPieceAt(new hte(n,11))===X7.ONE&&(t+=X7.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new hte(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new hte(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=cy(cte.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===Q7.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===X7.ZERO?n=Math.max(n,d):s===X7.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*X7.ZERO.getScoreModifier()+r*X7.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new Ete(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new Ete(r+i+a+o+s+u)}}]),n}(Fae),Bae=Q7.NONE,zae=Q7.ZERO,Hae=Q7.ONE,Gae=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Gr||(Gr=Gg(["Initial board"]))),$localize($r||($r=Gg(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),Nae.getInitialState()),Hte.informational($localize(Zr||(Zr=Gg(["Goal of the game (1/2)"]))),$localize(qr||(qr=Gg(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new Nae([[Bae,Bae,Bae,Bae,Bae,zae,Bae,Bae,Hae,Hae,Hae,Hae,Hae,Hae],[Bae,Bae,Bae,Bae,Bae,zae,Bae,Bae,Bae,Bae,Bae,Bae,Hae,Hae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,zae,zae,zae,zae,Bae,Bae,Bae]],0)),Hte.informational($localize(Wr||(Wr=Gg(["Goal of the game (2/2)"]))),$localize(jr||(jr=Gg(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new Nae([[Bae,Bae,Bae,Bae,Bae,zae,Bae,Bae,Bae,Bae,Hae,Hae,Hae,Hae],[Bae,Bae,Bae,Bae,Bae,zae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Hae,Hae,Bae,Bae,Bae,zae,zae,Bae,zae,zae,zae,zae]],1)),Hte.fromPredicate($localize(Yr||(Yr=Gg(["Moving a piece"]))),$localize(Kr||(Kr=Gg(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),Nae.getInitialState(),new xae(0,10,1,1,cte.UP),function(e,t,n){return 1===e.movedPieces?LB.SUCCESS:LB.failure($localize(Qr||(Qr=Gg(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Xr||(Xr=Gg(["This is how you move a single piece."])))),Hte.fromPredicate($localize(Jr||(Jr=Gg(["Moving a phalanx"]))),$localize(ei||(ei=Gg(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),Nae.getInitialState(),new xae(0,11,2,1,cte.UP),function(e,t,n){return e.movedPieces>1?LB.SUCCESS:LB.failure($localize(ti||(ti=Gg(["Failed! You moved only one piece."]))))},$localize(ni||(ni=Gg(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Hte.fromMove($localize(ri||(ri=Gg(["Capture"]))),$localize(ii||(ii=Gg(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new Nae([[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Hae,Hae,Hae,Hae,Hae,Hae],[Bae,Bae,Bae,Bae,Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Hae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Hae,Hae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,zae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,zae,Bae,Bae,Bae,Bae,Hae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,zae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,zae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae,Bae],[Bae,Bae,Bae,Bae,Bae,Bae,Bae,zae,zae,zae,zae,zae,zae,zae]],0),[new xae(2,10,4,2,cte.UP)],$localize(ai||(ai=Gg(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(oi||(oi=Gg(["Failed, you have not captured the phalanx."]))))]});function $ae(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",4),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onClick(e,t)}),_S()}if(2&e){var r=MS().index,i=MS().index,a=MS();kS("ngClass",a.getPieceClasses(r,i)),fS("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function Zae(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",2),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),_S(),gS(2,$ae,1,4,"circle",3),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();LE(1),DS("id","click_",r,"_",i,""),kS("ngClass",a.getRectClasses(r,i)),fS("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngIf",a.board[i][r]!==a.NONE)}}function qae(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Zae,3,8,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Wae(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",5),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),fS("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var jae=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).NONE=Q7.NONE,r.firstPiece=MB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=MB.empty(),r.phalanxDirection=MB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.hasAsymetricBoard=!0,r.rules=new Lae(Nae),r.availableMinimaxes=[new Fae(r.rules,"Normal"),new Uae(r.rules,"Positional"),new Vae(r.rules,"Attack")],r.encoder=xae.encoder,r.tutorial=(new Gae).tutorial,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.firstPiece=MB.empty(),this.lastPiece=MB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=MB.of(new hte(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),LB.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(OB.expectToBe(n.board[t][e],Q7.NONE),n.cancelMove(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=cy(cte.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=cte.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=cte.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptyCases()}},{key:"getNeighboringEmptyCases",value:function(){var e,t=[],n=cy(cte.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===Q7.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=MB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=MB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new hte(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),LB.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Dae.SQUARE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===Q7.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new xae(a.x,a.y,1,1,c)):n.cancelMove(Dae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Dae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return OB.expectToBe(n.board[t][e],s),l=new xae(a.x,a.y,u,1,c),f=Lae.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.lastPiece=MB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=MB.of(c),LB.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new hte(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Dae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=cte.factory.fromMove(o,s).get(),c=cte.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=MB.of(s),n.lastPiece=MB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Dae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=14;break}return r.abrupt("return",n.thirdClickOnPlayerPiece(a,u,i));case 14:return l=n.firstPiece.get().getDistance(n.lastPiece.get())+1,f=n.lastPiece.get().getDistance(a),h=new xae(n.firstPiece.get().x,n.firstPiece.get().y,l,f,u),r.abrupt("return",n.tryMove(h));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClickOnPlayerPiece",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r.lastPiece=MB.of(e),a=r.firstPiece.get().getDistance(e)+1,o=new xae(r.firstPiece.get().x,r.firstPiece.get().y,a,1,t),s=Lae.getPhalanxValidity(r.rules.node.gameState,o),i.abrupt("return",s.isFailure()?r.cancelMove(s.getReason()):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getValidExtensions(n),r.phalanxValidLandings=r.getPhalanxValidLandings(),LB.SUCCESS));case 3:case"end":return i.stop()}},i)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=MB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",LB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=MB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),LB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=MB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=MB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),LB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new hte(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new hte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new hte(r,n));return e}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-epaminondas"]],features:[Xb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,qae,2,1,"g",1),gS(2,Wae,2,4,"g",1),_S()),2&e&&(fS("transform",t.rotation),LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.getHighlightedCoords()))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Yae(e){return new(function(t){ey(r,t);var n=ny(r);function r(){return hy(this,r),n.apply(this,arguments)}return vy(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?MB.empty():MB.of(e.decode(t))}}]),r}(W7))}var Kae=function(){function e(t){if(hy(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===xie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=n9.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=MB.empty(),i=cy(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=MB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return vy(e,[{key:"toString",value:function(){var e,t="",n=cy(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return xie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Kae.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return hte.encoder.encode(e)})}},{key:"decode",value:function(e){return new Kae(e.map(function(e){return hte.encoder.decode(e)}))}}]),n}(W7));var Qae=function(){function e(t,n){hy(this,e),this.coord=t,this.direction=n}return vy(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Qae.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Yae(gte.encoder),e}return vy(n,[{key:"encode",value:function(e){return{coord:hte.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.coord,"Invalid encoded GipfPlacement"),new Qae(hte.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(W7));var Xae=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return vy(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===n9.compareArray(this.initialCaptures,e.initialCaptures)||!1===n9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(Ite);Xae.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encodeMove",value:function(e){var t={placement:Qae.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Kae.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Kae.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.placement,"Invalid encoded GipfMove"),new Xae(Qae.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Kae.encoder.decode),this.decodeArray(t,"finalCapture",Kae.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(j7));var Jae=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,r,e,7,7,[3,2,1],pte.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return vy(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&n9.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=n9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==pte.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=pte.EMPTY,t=pte.UNREACHABLE,r=pte.ZERO,i=pte.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(Nie),eoe=function(){var e=vy(function e(){hy(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(si||(si=Gg(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ui||(ui=Gg(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ci||(ci=Gg(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(li||(li=Gg(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(fi||(fi=Gg(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(hi||(hi=Gg(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(di||(di=Gg(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(vi||(vi=Gg(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(pi||(pi=Gg(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),toe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return new Jae(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==pte.EMPTY;)o.push(s),s=s.getNext(a);return D7(i.isOnBoard(s)&&i.getPieceAt(s)===pte.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():xB.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=cy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return LB.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return LB.failure(eoe.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?LB.SUCCESS:LB.failure(eoe.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?LB.SUCCESS:LB.failure(eoe.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==pte.EMPTY){if(t.direction.isAbsent())return LB.failure(eoe.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return LB.failure(eoe.PLACEMENT_ON_COMPLETE_LINE());var i,a=cy(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return LB.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return LB.failure(eoe.INVALID_PLACEMENT_DIRECTION())}return LB.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return Cte.INSTANCE.isOnBorder(e,t)?LB.SUCCESS:LB.failure(eoe.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,X7.ZERO),i=n.getPlayerScore(t,X7.ONE);return r.isAbsent()?Fte.ONE_WON:i.isAbsent()?Fte.ZERO_WON:Fte.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,pte.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Jae(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return Cte.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===pte.EMPTY?t.push(new Qae(r,MB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Qae(r,MB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===pte.EMPTY)return MB.of(r);return MB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=pte.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==pte.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==pte.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new Jae(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(Cte.INSTANCE.isTopLeftCorner(e,t))return[gte.RIGHT,gte.DOWN,gte.UP_RIGHT];if(Cte.INSTANCE.isTopCorner(e,t))return[gte.DOWN,gte.DOWN_LEFT,gte.RIGHT];if(Cte.INSTANCE.isTopRightCorner(e,t))return[gte.DOWN_LEFT,gte.DOWN,gte.LEFT];if(Cte.INSTANCE.isBottomLeftCorner(e,t))return[gte.UP_RIGHT,gte.UP,gte.RIGHT];if(Cte.INSTANCE.isBottomCorner(e,t))return[gte.UP,gte.LEFT,gte.UP_RIGHT];if(Cte.INSTANCE.isBottomRightCorner(e,t))return[gte.LEFT,gte.UP,gte.DOWN_LEFT];if(Cte.INSTANCE.isOnTopLeftBorder(e,t))return[gte.RIGHT,gte.DOWN];if(Cte.INSTANCE.isOnLeftBorder(e,t))return[gte.UP_RIGHT,gte.RIGHT];if(Cte.INSTANCE.isOnBottomLeftBorder(e,t))return[gte.UP,gte.UP_RIGHT];if(Cte.INSTANCE.isOnBottomRightBorder(e,t))return[gte.LEFT,gte.UP];if(Cte.INSTANCE.isOnRightBorder(e,t))return[gte.LEFT,gte.DOWN_LEFT];if(Cte.INSTANCE.isOnTopRightBorder(e,t))return[gte.DOWN_LEFT,gte.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return MB.of({0:o,1:s,2:a});return MB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==pte.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==pte.EMPTY;c=c.getNext(a))n.push(c);return new Kae(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return MB.empty();var i=e.getNumberOfPiecesCaptured(t);return MB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,X7.ZERO),r=n.getPlayerScore(e,X7.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Ute),noe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=toe.getPlayerScore(t,X7.ZERO),r=toe.getPlayerScore(t,X7.ONE);return n.isAbsent()?new Ete(X7.ONE.getVictoryValue()):r.isAbsent()?new Ete(X7.ZERO.getVictoryValue()):new Ete(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return toe.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=toe.applyCaptures(r,e);toe.getPlacements(i).forEach(function(e){var a=toe.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Xae(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=toe.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=cy(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(n9.copyImmutableArray(u)):o?(a.push(n9.copyImmutableArray(u)),u.push(n),a.push(n9.copyImmutableArray(u))):(u.push(n),a.push(n9.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(_te),roe=vy(function e(t,n,r,i,a,o){hy(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),ioe=pte.UNREACHABLE,aoe=pte.EMPTY,ooe=pte.ZERO,soe=pte.ONE,uoe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(gi||(gi=Gg(["Goal of the game"]))),$localize(yi||(yi=Gg(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Jae.getInitialState()),Hte.anyMove($localize(mi||(mi=Gg(["Pushing"]))),$localize(ki||(ki=Gg(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Jae.getInitialState(),new Xae(new Qae(new hte(3,0),MB.of(gte.DOWN)),[],[]),$localize(Ci||(Ci=Gg(["Congratulations!"])))),Hte.fromMove($localize(wi||(wi=Gg(["Capture (1/3)"]))),$localize(_i||(_i=Gg(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Jae([[ioe,ioe,ioe,ooe,soe,aoe,aoe],[ioe,ioe,aoe,aoe,aoe,aoe,aoe],[ioe,aoe,aoe,aoe,aoe,aoe,aoe],[ooe,ooe,ooe,aoe,aoe,aoe,aoe],[soe,aoe,aoe,aoe,aoe,aoe,ioe],[aoe,aoe,aoe,soe,aoe,ioe,ioe],[aoe,aoe,aoe,soe,ioe,ioe,ioe]],42,[8,8],[0,0]),[new Xae(new Qae(new hte(0,3),MB.of(gte.RIGHT)),[],[new Kae([new hte(0,3),new hte(1,3),new hte(2,3),new hte(3,3)])])],$localize(Ei||(Ei=Gg(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(bi||(bi=Gg(["Failed!"])))),Hte.fromMove($localize(Si||(Si=Gg(["Capture (2/3)"]))),$localize(Pi||(Pi=Gg(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Jae([[ioe,ioe,ioe,aoe,aoe,aoe,aoe],[ioe,ioe,aoe,soe,aoe,aoe,aoe],[ioe,aoe,aoe,ooe,aoe,aoe,aoe],[ooe,ooe,ooe,soe,aoe,aoe,aoe],[aoe,aoe,aoe,ooe,aoe,aoe,ioe],[aoe,aoe,aoe,ooe,aoe,ioe,ioe],[aoe,aoe,aoe,soe,ioe,ioe,ioe]],42,[8,4],[2,3]),[new Xae(new Qae(new hte(0,3),MB.of(gte.RIGHT)),[],[new Kae([new hte(3,1),new hte(3,2),new hte(3,3),new hte(3,4),new hte(3,5),new hte(3,6)])])],$localize(Oi||(Oi=Gg(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ti||(Ti=Gg(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Hte.fromMove($localize(Ii||(Ii=Gg(["Capture (3/3)"]))),$localize(Ai||(Ai=Gg(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Jae([[ioe,ioe,ioe,ooe,aoe,aoe,ooe],[ioe,ioe,aoe,ooe,aoe,aoe,ooe],[ioe,ooe,ooe,aoe,ooe,soe,ooe],[aoe,aoe,aoe,ooe,aoe,aoe,ooe],[aoe,aoe,aoe,ooe,aoe,aoe,ioe],[ooe,ooe,ooe,soe,soe,ioe,ioe],[aoe,aoe,aoe,ooe,ioe,ioe,ioe]],42,[8,4],[2,3]),[new Xae(new Qae(new hte(3,6),MB.of(gte.UP)),[new Kae([new hte(6,0),new hte(6,1),new hte(6,2),new hte(6,3)])],[new Kae([new hte(0,5),new hte(1,5),new hte(2,5),new hte(3,5),new hte(4,5)]),new Kae([new hte(1,2),new hte(2,2),new hte(3,2),new hte(4,2),new hte(5,2)])]),new Xae(new Qae(new hte(4,6),MB.of(gte.UP)),[new Kae([new hte(6,0),new hte(6,1),new hte(6,2),new hte(6,3)])],[new Kae([new hte(0,5),new hte(1,5),new hte(2,5),new hte(3,5),new hte(4,5)]),new Kae([new hte(3,0),new hte(3,1),new hte(3,2),new hte(3,3),new hte(3,4)])]),new Xae(new Qae(new hte(3,6),MB.of(gte.UP)),[new Kae([new hte(6,0),new hte(6,1),new hte(6,2),new hte(6,3)])],[new Kae([new hte(1,2),new hte(2,2),new hte(3,2),new hte(4,2),new hte(5,2)]),new Kae([new hte(0,5),new hte(1,5),new hte(2,5),new hte(3,5),new hte(4,5)])])],$localize(Ri||(Ri=Gg(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Mi||(Mi=Gg(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function coe(e,t){if(1&e&&(AC(),ES(0,"circle",13)),2&e){var n=MS().$implicit,r=MS();kS("ngClass",r.getPieceClass(n)),fS("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function loe(e,t){if(1&e){var n=PS();AC(),wS(0,"g",10),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e)}),ES(1,"polygon",11),gS(2,coe,1,4,"circle",12),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","click_",r.x,"_",r.y,""),LE(1),DS("id","space_",r.x,"_",r.y,""),kS("ngClass",i.getSpaceClass(r)),fS("points",i.getHexaCoordsAt(r)),LE(1),kS("ngIf",i.isPiece(r))}}function foe(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",16),IS("click",function(){var e=tC(n).$implicit;return MS(2).onClick(e)}),_S()}if(2&e){var r=t.$implicit;fS("points",MS(2).getHexaCoordsAt(r))}}function hoe(e,t){if(1&e&&(AC(),wS(0,"g",14),gS(1,foe,1,1,"polygon",15),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n.capturedSpaces)}}function doe(e,t){if(1&e){var n=PS();AC(),wS(0,"line",17),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.destination)}),_S()}if(2&e){var r=t.$implicit;fS("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function voe(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",18),_S()),2&e){var n=t.$implicit,r=MS().$implicit,i=MS();LE(1),DS("id","piece_",r.value,"_",n,""),kS("ngClass",i.getPlayerClass(r)),fS("cx",i.getRemainingPieceCx(r,n))("cy",i.getRemainingPieceCy(r))("r",.5*i.SPACE_SIZE)}}function poe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,voe,2,6,"g",8),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",r.getPlayerSidePieces(n))}}function goe(e,t){if(1&e&&(AC(),ES(0,"line",19)),2&e){var n=MS();fS("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var yoe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).inserted=MB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.HEXAGON_WIDTH=r.SPACE_SIZE,r.SHARED_HEXAGON_X=Math.cos(30)*r.HEXAGON_WIDTH*.5,r.BOARD_WIDTH=r.HEXAGON_WIDTH+6*(r.HEXAGON_WIDTH-r.SHARED_HEXAGON_X)+3*r.STROKE_WIDTH/2,r.BOARD_HEIGHT=7*r.HEXAGON_WIDTH+4.5*r.STROKE_WIDTH,r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=MB.empty(),r.placementEntrance=MB.empty(),r.finalCaptures=[],r.hasAsymetricBoard=!0,r.scores=MB.of([0,0]),r.rules=new toe(Jae),r.availableMinimaxes=[new noe(r.rules,"GipfMinimax")],r.encoder=Xae.encoder,r.tutorial=(new uoe).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new yte(1.5*r.SPACE_SIZE,new hte(r.HEXAGON_WIDTH/2+3*r.STROKE_WIDTH/4,-r.HEXAGON_WIDTH),Cte.INSTANCE),r}return vy(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt()}},{key:"showLastMove",value:function(){this.inserted=MB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=MB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new roe(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(e),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==pte.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:return r.abrupt("return",(OB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),t.selectPlacementDirectionOrPlacementCoord(e)));case 9:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(eoe.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(eoe.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=toe.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=toe.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():LB.SUCCESS):(OB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):LB.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,LB.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=toe.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,LB.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=toe.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,LB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=cy(toe.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===toe.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new roe(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.placementEntrance.equalsValue(e)?(t.cancelMoveAttempt(),LB.SUCCESS):(t.placementEntrance=MB.of(e),t.constructedState.getPieceAt(e)===pte.EMPTY?t.selectPlacementDirection(MB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(eoe.NO_DIRECTIONS_AVAILABLE()),LB.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=MB.of(new Qae(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=toe.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"selectPlacementDirectionOrPlacementCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==(r=t.placementEntrance.get()).isAlignedWith(e)&&1===r.getDistance(e)){n.next=3;break}return n.abrupt("return",t.selectPlacementCoord(e));case 3:return i=gte.factory.fromMove(r,e),n.abrupt("return",t.selectPlacementDirection(i.toOptional()));case 5:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Xae(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=MB.empty(),this.placement=MB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(X7.of(t.value))}},{key:"getRemainingPieceCy",value:function(e){return e===X7.ONE?25:this.BOARD_HEIGHT-25}},{key:"getRemainingPieceCx",value:function(e,t){var n=20+t*this.SPACE_SIZE*.5;return e===X7.ONE?n:this.BOARD_WIDTH-(15+n)}}]),n}(vte);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-gipf"]],features:[Xb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"defs"),wS(2,"marker",1),ES(3,"polygon",2),_S(),wS(4,"marker",3),ES(5,"polygon",4),_S(),_S(),gS(6,loe,3,7,"g",5),gS(7,hoe,2,1,"g",6),gS(8,doe,1,4,"line",7),gS(9,poe,2,1,"g",8),gS(10,goe,1,4,"line",9),_S()),2&e&&(fS("viewBox",-t.STROKE_WIDTH+" 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),LE(6),kS("ngForOf",t.getAllCoords()),LE(1),kS("ngForOf",t.possibleCaptures),LE(1),kS("ngForOf",t.arrows),LE(1),kS("ngForOf",t.Player.PLAYERS),LE(1),kS("ngIf",t.inserted.isPresent()))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),moe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ate);moe.PASS=new moe(-1,0),moe.ACCEPT=new moe(-2,0),moe.PASS_NUMBER=-1,moe.ACCEPT_NUMBER=-2,moe.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===moe.PASS_NUMBER)return moe.PASS;var t=e%19;return new moe(t,(e-t)/19)}}]),n}(Y7));var koe=function(){function e(t,n){hy(this,e),this.player=t,this.type=n}return vy(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return D7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return D7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===X7.ZERO?e.DARK:e.LIGHT}}]),e}();koe.DARK=new koe(X7.ZERO,"alive"),koe.LIGHT=new koe(X7.ONE,"alive"),koe.EMPTY=new koe(Q7.NONE,"empty"),koe.DEAD_DARK=new koe(X7.ZERO,"dead"),koe.DEAD_LIGHT=new koe(X7.ONE,"dead"),koe.DARK_TERRITORY=new koe(Q7.NONE,"territory"),koe.LIGHT_TERRITORY=new koe(Q7.NONE,"territory");var Coe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(Coe||(Coe={})),Coe),woe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return vy(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,MB.empty(),Coe.PLAYING)}},{key:"getStartingBoard",value:function(){return n9.createTable(n.WIDTH,n.HEIGHT,koe.EMPTY)}}]),n}(Ote);return e.WIDTH=13,e.HEIGHT=13,e}(),_oe=function(){var e=function(){function e(t){hy(this,e),this.color=t}return vy(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),Eoe=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return vy(n,[{key:"getCoords",value:function(){return this.color===koe.DARK?this.darkCoords:this.color===koe.LIGHT?this.lightCoords:this.color===koe.DEAD_DARK?this.deadDarkCoords:this.color===koe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(D7(!1===this.contains(e),"This group already contains "+e.toString()),t){case koe.DARK:this.darkCoords=_oe.insertAsEntryPoint(this.darkCoords,e);break;case koe.LIGHT:this.lightCoords=_oe.insertAsEntryPoint(this.lightCoords,e);break;case koe.DEAD_DARK:this.deadDarkCoords=_oe.insertAsEntryPoint(this.deadDarkCoords,e);break;case koe.DEAD_LIGHT:this.deadLightCoords=_oe.insertAsEntryPoint(this.deadLightCoords,e);break;default:OB.expectToBeMultiple(t,[koe.EMPTY,koe.DARK_TERRITORY,koe.LIGHT_TERRITORY]),this.emptyCoords=_oe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new xte;e.set(koe.EMPTY,this.emptyCoords.length),e.set(koe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(koe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==koe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==koe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==koe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==koe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==koe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(_oe),boe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getNewInstance",value:function(e){return new Eoe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return lte.ORTHOGONALS}}]),n}(function(){function e(){hy(this,e)}return vy(e,[{key:"getGroupDatas",value:function(e,t){TB(_oe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){TB(_oe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=cy(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),Soe=function(){var e=vy(function e(){hy(this,e)});return e.ILLEGAL_KO=function(){return $localize(xi||(xi=Gg(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Ni||(Ni=Gg(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Di||(Di=Gg(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Li||(Li=Gg(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Fi||(Fi=Gg(["You cannot commit suicide."])))},e}(),Poe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return TB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(TB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(TB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(TB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(TB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(TB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===Coe.PLAYING,a=t.phase===Coe.PASSED;return TB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?xB.success([]):xB.failure(Soe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===Coe.ACCEPT;return t.phase===Coe.COUNTING||o?xB.success([]):xB.failure(Soe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(TB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?xB.success([]):xB.failure(Soe.OCCUPIED_INTERSECTION())):(TB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new boe).getGroupDatas(i,t),s=o.emptyCoords,u=koe.pieceBelongTo(a,X7.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return MB.of(r)}return MB.empty()}},{key:"markTerritoryAndCount",value:function(e){TB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=cy(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===koe.LIGHT){a[1]+=s.emptyCoords.length;var c,l=cy(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=koe.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{D7(u===koe.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=cy(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=koe.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new woe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===koe.DARK_TERRITORY?(n[i][a]=koe.EMPTY,r[0]=r[0]-1):t===koe.LIGHT_TERRITORY&&(n[i][a]=koe.EMPTY,r[1]=r[1]-1);return new woe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new boe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new hte(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===koe.DEAD_DARK?r++:t===koe.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();D7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new boe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case koe.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=cy(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=koe.DARK}}catch(y){o.e(y)}finally{o.f()}break;case koe.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=cy(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=koe.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case koe.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=cy(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=koe.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:OB.expectToBe(r.color,koe.DARK),i[1]+=2*r.darkCoords.length;var v,p=cy(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=koe.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new woe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===Coe.FINISHED?t.captured[0]>t.captured[1]?Fte.ZERO_WON:t.captured[1]>t.captured[0]?Fte.ONE_WON:Fte.DRAW:Fte.ONGOING}},{key:"isPass",value:function(e){return e.equals(moe.PASS)}},{key:"isAccept",value:function(e){return e.equals(moe.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===Coe.COUNTING||t.phase===Coe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return xB.failure(Soe.ILLEGAL_KO());[Coe.COUNTING,Coe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(Ooe.isCapturing(i))return xB.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?koe.DARK:koe.LIGHT;var a=0===(new boe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=koe.EMPTY,a?xB.failure(Soe.CANNOT_COMMIT_SUICIDE()):xB.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){TB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new Ooe,o=cy(lte.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?koe.LIGHT:koe.DARK)){TB(n.VERBOSE||!1,"a group could be captured");var o=(new boe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return TB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===Coe.PASSED?(t=Coe.COUNTING,r=new woe(i,a,o+1,MB.empty(),t),r=n.markTerritoryAndCount(r)):(D7(e.phase===Coe.PLAYING,"Cannot pass in counting phase!"),t=Coe.PASSED,r=new woe(i,a,o+1,MB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===Coe.COUNTING?Coe.ACCEPT:Coe.FINISHED,new woe(n,e.getCapturedCopy(),e.turn+1,MB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;TB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[Coe.COUNTING,Coe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=koe.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=cy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=koe.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new woe(s,p,l,v,Coe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new hte(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){TB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new woe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,MB.empty(),Coe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Ute);return e.VERBOSE=!1,e}(),Ooe=function(){function e(){hy(this,e),this.capturedCoords=[]}return vy(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),Toe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){TB(Poe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===Coe.PLAYING||t.phase===Coe.PASSED)return n.push(moe.PASS),n;TB(Poe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[moe.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new moe(i,r),e.getPieceAt(t.coord)===koe.EMPTY&&Poe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=cy(Poe.getGroupsDatasWhere(r,function(e){return e!==koe.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new moe(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===koe.DARK?koe.DEAD_DARK:e===koe.LIGHT?koe.DEAD_LIGHT:e.isTerritory()?koe.EMPTY:e}),n=new woe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=Poe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=cy(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=cy(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=Poe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Poe.getGameStatus(e);if(n.isEndGame)return new Ete(n.toBoardValue());TB(Poe.VERBOSE||!1,"GoRules.getBoardValue");var r=Poe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new Ete(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(_te),Ioe=koe.LIGHT,Aoe=koe.DARK,Roe=koe.DEAD_LIGHT,Moe=koe.LIGHT_TERRITORY,xoe=koe.DARK_TERRITORY,Noe=koe.EMPTY,Doe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Ui||(Ui=Gg(["Preliminary information"]))),$localize(Vi||(Vi=Gg(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),woe.getInitialState()),Hte.informational($localize(Bi||(Bi=Gg(["Goal of the game"]))),$localize(zi||(zi=Gg(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new woe([[Noe,Aoe,Noe,Noe,Ioe,Ioe],[Noe,Aoe,Noe,Noe,Ioe,Noe],[Noe,Aoe,Aoe,Ioe,Ioe,Noe],[Noe,Noe,Aoe,Ioe,Noe,Noe],[Noe,Noe,Aoe,Ioe,Noe,Noe],[Noe,Noe,Aoe,Ioe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING)),Hte.fromMove($localize(Hi||(Hi=Gg(["Simple capture"]))),$localize(Gi||(Gi=Gg(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new woe([[Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Aoe,Noe,Noe],[Noe,Aoe,Ioe,Noe,Noe],[Noe,Noe,Aoe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING),[new moe(3,2)],$localize($i||($i=Gg(["Congratulations, you have earned one point."]))),$localize(Zi||(Zi=Gg(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Hte.fromMove($localize(qi||(qi=Gg(["Capturing multiple stones"]))),$localize(Wi||(Wi=Gg(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new woe([[Noe,Aoe,Noe,Noe,Noe],[Aoe,Ioe,Noe,Noe,Noe],[Aoe,Ioe,Ioe,Aoe,Noe],[Noe,Aoe,Aoe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING),[new moe(2,1)],$localize(ji||(ji=Gg(["Congratulations, you have earned three points and formed a territory."]))),$localize(Yi||(Yi=Gg(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Hte.informational($localize(Ki||(Ki=Gg(["Suicide"]))),$localize(Qi||(Qi=Gg(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new woe([[Noe,Aoe,Noe,Noe,Noe],[Aoe,Noe,Noe,Noe,Noe],[Aoe,Noe,Noe,Noe,Ioe],[Ioe,Aoe,Noe,Ioe,Noe],[Noe,Ioe,Noe,Ioe,Aoe]],[0,0],0,MB.empty(),Coe.PLAYING)),Hte.informational($localize(Xi||(Xi=Gg(["Life and death (death)"]))),$localize(Ji||(Ji=Gg(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new woe([[Noe,Noe,Noe,Noe,Noe],[Aoe,Aoe,Aoe,Noe,Noe],[Ioe,Ioe,Aoe,Noe,Noe],[Noe,Ioe,Aoe,Noe,Noe],[Ioe,Ioe,Aoe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING)),Hte.informational($localize(ea||(ea=Gg(["Life and death (eyes)"]))),$localize(ta||(ta=Gg(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new woe([[Noe,Aoe,Ioe,Noe,Noe],[Ioe,Aoe,Ioe,Noe,Noe],[Aoe,Aoe,Ioe,Noe,Noe],[Ioe,Aoe,Ioe,Noe,Noe],[Noe,Aoe,Ioe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING)),Hte.informational($localize(na||(na=Gg(["Seki"]))),$localize(ra||(ra=Gg(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new woe([[Noe,Ioe,Aoe,Noe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Aoe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Aoe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Aoe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Ioe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Ioe,Ioe,Aoe,Noe],[Noe,Ioe,Aoe,Noe,Ioe,Aoe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING)),Hte.fromMove($localize(ia||(ia=Gg(["Ko"]))),$localize(aa||(aa=Gg(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new woe([[Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Aoe,Ioe,Noe,Noe],[Noe,Noe,Aoe,Ioe,Noe,Ioe,Noe],[Noe,Noe,Noe,Aoe,Ioe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe],[Noe,Noe,Noe,Noe,Noe,Noe,Noe]],[0,0],0,MB.empty(),Coe.PLAYING),[new moe(4,3)],$localize(oa||(oa=Gg(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(sa||(sa=Gg(["Failed!"])))),Hte.fromMove($localize(ua||(ua=Gg(["End of the game"]))),$localize(ca||(ca=Gg(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new woe([[Ioe,Aoe,Aoe,Aoe,Aoe,Aoe,xoe,xoe,xoe],[Ioe,Ioe,Ioe,Ioe,Aoe,Aoe,Aoe,xoe,xoe],[Ioe,Moe,Ioe,Ioe,Aoe,Roe,Roe,Aoe,xoe],[Aoe,Ioe,Ioe,Ioe,Ioe,Aoe,xoe,xoe,xoe],[Noe,Ioe,Moe,Ioe,Aoe,Aoe,Roe,Aoe,xoe],[Ioe,Moe,Ioe,Ioe,Aoe,Aoe,Aoe,Aoe,Aoe],[Ioe,Ioe,Aoe,Aoe,Aoe,Ioe,Ioe,Aoe,Ioe],[Aoe,Aoe,Aoe,Ioe,Ioe,Ioe,Moe,Ioe,Ioe],[xoe,xoe,Aoe,Aoe,Aoe,Ioe,Ioe,Moe,Moe]],[0,0],0,MB.empty(),Coe.COUNTING),[new moe(0,3)],$localize(la||(la=Gg(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(fa||(fa=Gg(["Failed, try again."]))))]});function Loe(e,t){if(1&e&&(AC(),ES(0,"circle",10)),2&e){var n=MS(2).index,r=MS().index;fS("cx",25+50*n)("cy",25+50*r)("r",22)}}function Foe(e,t){if(1&e){var n=PS();AC(),wS(0,"line",11),IS("click",function(){tC(n);var e=MS(2).index,t=MS().index;return MS().onClick(e,t)}),_S()}if(2&e){var r=MS(2).index,i=MS().index;fS("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Uoe(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",7),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onClick(e,t)}),_S(),gS(2,Loe,1,3,"circle",8),gS(3,Foe,1,4,"line",9),_S()}if(2&e){var r=MS().index,i=MS().index,a=MS();LE(1),kS("ngClass",a.getSpaceClass(r,i)),fS("cx",25+50*r)("cy",25+50*i)("r",22),LE(1),kS("ngIf",a.isLastCase(r,i)),LE(1),kS("ngIf",a.isDead(r,i))}}function Voe(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",15),IS("click",function(){tC(n);var e=MS(2).index,t=MS().index;return MS().onClick(e,t)}),_S()}if(2&e){var r=MS(2),i=r.index,a=r.$implicit,o=MS().index,s=MS();fS("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function Boe(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",12),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onClick(e,t)}),_S(),wS(1,"line",13),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onClick(e,t)}),_S(),wS(2,"line",13),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().onClick(e,t)}),_S(),gS(3,Voe,1,4,"circle",14)}if(2&e){var r=MS().index,i=MS().index,a=MS();DS("id","click_",r,"_",i,""),fS("x",50*r)("y",50*i),LE(1),fS("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),LE(1),fS("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),LE(1),kS("ngIf",a.isTerritory(r,i))}}function zoe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Uoe,4,6,"g",5),gS(2,Boe,4,13,"ng-template",null,6,JT),_S()),2&e){var n=t.index,r=yS(3),i=MS().index,a=MS();LE(1),kS("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function Hoe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,zoe,4,2,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Goe(e,t){if(1&e&&(AC(),ES(0,"rect",16)),2&e){var n=MS();fS("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function $oe(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",17),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S()}if(2&e){var r=t.$implicit;fS("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Zoe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).ko=MB.empty(),r.last=MB.empty(),r.captures=[],r.GoPiece=koe,r.scores=MB.of([0,0]),r.rules=new Poe(woe),r.availableMinimaxes=[new Toe(r.rules,"GoMinimax")],r.encoder=moe.encoder,r.tutorial=(new Doe).tutorial,r.canPass=!0,r.updateBoard(),r}return vy(n,[{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=MB.empty(),a=new moe(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){TB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=MB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==Coe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new hte(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===koe.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===Coe.PLAYING||n===Coe.PASSED?e.onClick(moe.PASS.coord.x,moe.PASS.coord.y):(D7(n===Coe.COUNTING||n===Coe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(moe.ACCEPT.coord.x,moe.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==koe.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new hte(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new hte(e,t))}}]),n}(Ene);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-go"]],features:[Xb],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),ES(1,"rect",1),gS(2,Hoe,2,1,"g",2),gS(3,Goe,1,2,"rect",3),gS(4,$oe,1,3,"circle",4),_S()),2&e&&(fS("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),LE(1),fS("width",50*t.board.length)("height",50*t.board.length),LE(1),kS("ngForOf",t.board),LE(1),kS("ngIf",t.ko.isPresent()),LE(1),kS("ngForOf",t.captures))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),qoe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getMaximalDistance",value:function(){return 11}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return xB.success(r)}catch(r){return xB.failure(r.message)}}}]),n}(Dne);qoe.encoder=xne.getEncoder(11,11,qoe.of);var Woe={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:X7.ZERO},joe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Une.UNOCCUPIED,t=Une.INVADERS,r=Une.DEFENDERS;return new n([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,r,e,e,e,e,t],[t,e,e,e,r,r,r,e,e,e,t],[t,t,e,r,r,Une.PLAYER_ONE_KING,r,r,e,t,t],[t,e,e,e,r,r,r,e,e,e,t],[t,e,e,e,e,r,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}}]),n}(Bne),Yoe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,joe,Woe,qoe.of)}return vy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Lte.ruler=this.singleton,n.singleton}}]),n}(Hne),Koe=Une.UNOCCUPIED,Qoe=Une.INVADERS,Xoe=Une.DEFENDERS,Joe=Une.PLAYER_ONE_KING,ese=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(ha||(ha=Gg(["Goal of the game"]))),$localize(da||(da=Gg(["Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),joe.getInitialState()),Hte.anyMove($localize(va||(va=Gg(["Moving"]))),$localize(pa||(pa=Gg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),joe.getInitialState(),qoe.of(new hte(5,1),new hte(1,1)),$localize(ga||(ga=Gg(["Congratulations!"])))),Hte.fromMove($localize(ya||(ya=Gg(["Capturing a soldier (1/2)"]))),$localize(ma||(ma=Gg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new joe([[Koe,Koe,Koe,Koe,Qoe,Qoe,Qoe,Qoe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Qoe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Qoe,Koe,Koe,Koe,Koe,Xoe,Koe,Koe,Koe,Koe,Qoe],[Qoe,Koe,Koe,Qoe,Xoe,Xoe,Xoe,Koe,Koe,Koe,Qoe],[Qoe,Qoe,Koe,Xoe,Xoe,Joe,Xoe,Xoe,Koe,Qoe,Qoe],[Qoe,Koe,Koe,Koe,Xoe,Xoe,Xoe,Koe,Koe,Koe,Qoe],[Qoe,Koe,Koe,Koe,Koe,Xoe,Koe,Koe,Koe,Koe,Qoe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Qoe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Qoe,Qoe,Qoe,Qoe,Qoe,Koe,Koe,Koe]],1),[qoe.of(new hte(5,3),new hte(3,3))],$localize(ka||(ka=Gg(["Congratulations, that will teach him a lesson!"]))),$localize(Ca||(Ca=Gg(["Failed, you missed an opportunity to capture a piece of the opponent."])))).withPreviousMove(qoe.of(new hte(3,0),new hte(3,4))).withPreviousState(joe.getInitialState()),Hte.fromMove($localize(wa||(wa=Gg(["Capturing a soldier (2/2)"]))),$localize(_a||(_a=Gg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new joe([[Koe,Koe,Koe,Qoe,Qoe,Qoe,Qoe,Qoe,Koe,Koe,Koe],[Koe,Xoe,Koe,Koe,Koe,Qoe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Xoe,Koe,Koe,Koe,Koe,Qoe],[Qoe,Koe,Koe,Koe,Koe,Xoe,Xoe,Koe,Koe,Koe,Qoe],[Qoe,Qoe,Joe,Koe,Xoe,Koe,Xoe,Xoe,Koe,Koe,Qoe],[Koe,Koe,Qoe,Koe,Koe,Xoe,Xoe,Koe,Koe,Koe,Qoe],[Qoe,Koe,Koe,Koe,Koe,Xoe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Qoe,Qoe,Qoe,Qoe,Koe,Qoe,Koe,Koe]],12),[qoe.of(new hte(3,0),new hte(3,5)),qoe.of(new hte(3,10),new hte(3,5))],$localize(Ea||(Ea=Gg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(ba||(ba=Gg(["Failed, you did not do the expected move."])))),Hte.fromMove($localize(Sa||(Sa=Gg(["Capturing the king (1/2)"]))),$localize(Pa||(Pa=Gg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new joe([[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Qoe,Joe,Koe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe]],72),[qoe.of(new hte(3,4),new hte(2,4))],$localize(Oa||(Oa=Gg(["Congratulations, you won!"]))),$localize(Ta||(Ta=Gg(["Failed, you let the king run away."])))),Hte.fromMove($localize(Ia||(Ia=Gg(["Capturing the king (2/2)"]))),$localize(Aa||(Aa=Gg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new joe([[Koe,Koe,Qoe,Joe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Xoe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Qoe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe],[Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe,Koe]],72),[qoe.of(new hte(3,3),new hte(3,1))],$localize(Ra||(Ra=Gg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ma||(Ma=Gg(["Failed!"]))))]});function tse(e,t){1&e&&(AC(),ES(0,"polygon",8))}function nse(e,t){1&e&&(AC(),ES(0,"rect",9))}function rse(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,tse,1,0,"polygon",6),gS(2,nse,1,0,"ng-template",null,7,JT),_S()),2&e){var n=yS(3),r=MS().index,i=MS().index,a=MS();LE(1),kS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function ise(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13),ES(4,"line",13),ES(5,"line",13),_S()),2&e){var n=MS(2).index,r=MS().index,i=MS();LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ase(e,t){if(1&e&&(AC(),ES(0,"polyline",16)),2&e){var n=MS(3).index,r=MS().index;kS("ngClass",MS().viewInfo.pieceClasses[r][n])}}function ose(e,t){if(1&e&&(AC(),ES(0,"line",13),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13)),2&e){var n=MS(3).index,r=MS().index,i=MS();kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function sse(e,t){if(1&e&&(AC(),gS(0,ase,1,1,"polyline",14),gS(1,ose,4,20,"ng-template",null,15,JT)),2&e){var n=yS(2),r=MS(2).index,i=MS().index;kS("ngIf",MS().isKing(r,i))("ngIfElse",n)}}function use(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",10),gS(2,ise,6,25,"g",11),gS(3,sse,3,2,"ng-template",null,12,JT),_S()),2&e){var n=yS(4),r=MS().index,i=MS().index,a=MS();LE(1),DS("id","piece_",r,"_",i,""),kS("ngClass",a.viewInfo.pieceClasses[i][r]),fS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),LE(1),kS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function cse(e,t){if(1&e){var n=PS();AC(),wS(0,"g",3),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(1,"rect",4),gS(2,rse,4,2,"g",5),gS(3,use,5,8,"g",5),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();DS("id","click_",r,"_",i,""),fS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),LE(1),kS("ngClass",a.getRectClasses(r,i)),fS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),LE(1),kS("ngIf",a.board[i][r]!==a.EMPTY)}}function lse(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,cse,4,8,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function fse(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",17),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),DS("id","click_",r.x,"_",r.y,""),fS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var hse=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e,!1,qoe.from)).rules=Yoe.get(),r.availableMinimaxes=[new Zne(r.rules,"DummyBot"),new Yne(r.rules,"Piece > Influence"),new Kne(r.rules,"Piece > Control"),new Qne(r.rules,"Escape > Piece > Control")],r.encoder=qoe.encoder,r.tutorial=(new ese).tutorial,r}return vy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}($ne);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-hnefatafl"]],features:[Xb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,lse,2,1,"g",1),gS(2,fse,2,6,"g",1),_S()),2&e&&(fS("viewBox",t.getViewBox()),LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.getClickables()))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dse=function(){function e(t,n,r){hy(this,e),this.value=t,this.name=n,this.rgb=r}return vy(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return OB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();dse.ANY=new dse(0,"any","#000"),dse.ORANGE=new dse(1,"orange","#d67421"),dse.BLUE=new dse(2,"blue","#006bac"),dse.PURPLE=new dse(3,"purple","#6f3787"),dse.PINK=new dse(4,"pink","#d2719e"),dse.YELLOW=new dse(5,"yellow","#e2c200"),dse.RED=new dse(6,"red","#d23339"),dse.GREEN=new dse(7,"green","#009157"),dse.BROWN=new dse(8,"brown","#562500");var vse=function(){function e(t,n){hy(this,e),this.player=t,this.color=n}return vy(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(Q7.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,dse.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,dse.ORANGE),BLUE:new e(t,dse.BLUE),PURPLE:new e(t,dse.PURPLE),PINK:new e(t,dse.PINK),YELLOW:new e(t,dse.YELLOW),RED:new e(t,dse.RED),GREEN:new e(t,dse.GREEN),BROWN:new e(t,dse.BROWN)}}}]),e}();vse.EMPTY=new vse(Q7.NONE,dse.ANY),vse.ZERO=vse.createPlayerColors(X7.ZERO),vse.ONE=vse.createPlayerColors(X7.ONE);var pse=function(){function e(){hy(this,e)}return vy(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=vse.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return vse.of(X7.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return vse.of(X7.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(vse.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new hte(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();pse.INITIAL=pse.getInitialBoard(),pse.SIZE=8,pse.COLORS=n9.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],dse.of);var gse=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this)}return vy(n,[{key:"isPieceMove",value:function(){return!1}},{key:"length",value:function(){return 0}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"KamisadoMove(PASS)"}}]),n}(Ite);gse.PASS=new gse;var yse,mse=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"isPieceMove",value:function(){return!0}},{key:"equals",value:function(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(pse.SIZE,pse.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(pse.SIZE,pse.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(xne);!function(e){e.PASS=gse.PASS,e.of=function(e,t){return mse.of(e,t)},e.encoder=new(function(t){ey(r,t);var n=ny(r);function r(){return hy(this,r),n.apply(this,arguments)}return vy(r,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}},{key:"decodeNumber",value:function(t){if(0===t)return e.PASS;var n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new hte((t=t/16|0)%16,i),new hte(r,n))}}]),r}(Y7))}(yse||(yse={}));var kse=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o){var s;return hy(this,n),(s=t.call(this,n9.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return vy(n,null,[{key:"getInitialState",value:function(){return new n(0,dse.ANY,MB.empty(),!1,pse.INITIAL)}}]),n}(Ote),Cse=function(){var e=vy(function e(){hy(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(xa||(xa=Gg(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(Na||(Na=Gg(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(Da||(Da=Gg(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(La||(La=Gg(["You must play with the selected piece."])))},e}(),wse=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"nextCoordToPlay",value:function(e,t){return MB.ofNullable(pse.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.getCopiedBoard();a[i.y][i.x]=a[r.y][r.x],a[r.y][r.x]=vse.EMPTY;var o=pse.getColorAt(i.x,i.y),s=this.nextCoordToPlay(t,o);return new kse(t.turn+1,o,s,!1,a)}var u=this.nextCoordToPlay(t,t.colorToPlay);return new kse(t.turn+1,t.colorToPlay,u,!0,t.board)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Fte.getDefeat(r);var i=Wg(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Fte.ONE_WON:0===a?Fte.ZERO_WON:Fte.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new hte(0,7),new hte(1,7),new hte(2,7),new hte(3,7),new hte(4,7),new hte(5,7),new hte(6,7),new hte(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=cy(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&pse.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===X7.ONE?[cte.DOWN,cte.DOWN_LEFT,cte.DOWN_RIGHT]:[cte.UP,cte.UP_LEFT,cte.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===X7.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(D7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[yse.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=cy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=cy(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<pse.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!pse.isEmptyAt(e.board,h))break;var d=yse.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return pse.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);D7(i!==vse.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===X7.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE());if(a!==dse.ANY&&o.color!==a)return xB.failure(Cse.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return xB.failure(wte.MUST_CLICK_ON_EMPTY_SPACE());var s=cte.factory.fromMove(r,i);if(s.isFailure())return xB.failure(Cse.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return xB.failure(Cse.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return xB.failure(Cse.MOVE_BLOCKED());return xB.success(void 0)}return this.isLegalPass(t)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?xB.success(void 0):xB.failure(wte.CANNOT_PASS())}}]),n}(Ute),_se=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=wse.getListMovesFromState(e.gameState);return n9.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(wse.mustPass(t)&&t.alreadyPassed)return new Ete(n.getDefeatValue());var r=Wg(wse.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new Ete(7===a?X7.ONE.getVictoryValue():0===i?X7.ZERO.getVictoryValue():a-(7-i))}}]),n}(_te),Ese=vse.EMPTY,bse=vse.ZERO.ORANGE,Sse=vse.ONE.ORANGE,Pse=vse.ZERO.BLUE,Ose=vse.ONE.BLUE,Tse=vse.ZERO.PURPLE,Ise=vse.ONE.PURPLE,Ase=vse.ZERO.PINK,Rse=vse.ONE.PINK,Mse=vse.ZERO.YELLOW,xse=vse.ONE.YELLOW,Nse=vse.ZERO.RED,Dse=vse.ONE.RED,Lse=vse.ZERO.GREEN,Fse=vse.ONE.GREEN,Use=vse.ZERO.BROWN,Vse=vse.ONE.BROWN,Bse=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Fa||(Fa=Gg(["Goal of the game"]))),$localize(Ua||(Ua=Gg(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new kse(5,dse.ORANGE,MB.empty(),!1,[[Use,Ose,Ise,Rse,xse,Dse,Fse,Vse],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Sse,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Lse,Nse,Mse,Ase,Tse,Pse,bse]])).withPreviousMove(yse.of(new hte(0,7),new hte(0,0))),Hte.anyMove($localize(Va||(Va=Gg(["Initial board and initial move"]))),$localize(Ba||(Ba=Gg(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),kse.getInitialState(),yse.of(new hte(7,7),new hte(3,3)),$localize(za||(za=Gg(["Perfect! Note that each of your piece has a different color."])))),Hte.fromMove($localize(Ha||(Ha=Gg(["Moving"]))),$localize(Ga||(Ga=Gg(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new kse(1,dse.PINK,MB.of(new hte(3,0)),!1,[[Sse,Ose,Ise,Rse,xse,Dse,Fse,Vse],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Pse,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Use,Lse,Nse,Mse,Ase,Tse,Ese,bse]]),[yse.of(new hte(3,0),new hte(3,6)),yse.of(new hte(3,0),new hte(4,1))],$localize($a||($a=Gg(["Congratulations!"]))),$localize(Za||(Za=Gg(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(yse.of(new hte(6,7),new hte(6,5))),Hte.informational($localize(qa||(qa=Gg(["Stuck situation"]))),$localize(Wa||(Wa=Gg(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new kse(1,dse.PINK,MB.of(new hte(3,6)),!1,[[Sse,Ose,Ise,Ese,xse,Dse,Fse,Vse],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Pse],[Ese,Ese,Ese,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Rse,Ese,Ese,Ese,Ese],[Use,Lse,Nse,Mse,Ase,Tse,Ese,bse]])).withPreviousMove(yse.of(new hte(6,5),new hte(7,4))),Hte.fromMove($localize(ja||(ja=Gg(["Victory by blocking"]))),$localize(Ya||(Ya=Gg(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new kse(2,dse.RED,MB.of(new hte(2,4)),!1,[[Ese,Ose,Ise,Ese,Ese,Dse,Ese,Ese],[Ese,Ese,Ese,xse,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Rse,Ese,Ise,Ese,Ese],[Ese,Ese,Ese,Mse,Ese,Ese,Ese,Ese],[Ese,Ese,Nse,Ese,Ese,Ese,Ese,Ese],[Ese,Ese,Ese,Ese,Ese,Ese,Fse,Ese],[Sse,Ese,Ese,Ese,Ese,Ase,Ese,Vse],[Use,Lse,Ese,Ese,Ese,Ese,Pse,bse]]),[yse.of(new hte(2,4),new hte(0,2))],$localize(Ka||(Ka=Gg(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Qa||(Qa=Gg(["Failed!"])))).withPreviousMove(yse.of(new hte(4,0),new hte(3,1)))]});function zse(e,t){if(1&e&&(AC(),ES(0,"circle",8)),2&e){var n=MS(),r=n.$implicit,i=n.index,a=MS().index,o=MS();kS("ngClass",o.piecePlayerClass(r)),fS("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Hse(e,t){if(1&e&&(AC(),ES(0,"rect",9)),2&e){var n=MS(),r=n.index,i=n.$implicit,a=MS().index,o=MS();fS("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Gse(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"g",4),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(2,"rect",5),gS(3,zse,1,4,"circle",6),gS(4,Hse,1,7,"rect",7),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","click_",i,"_",a,""),LE(1),fS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),LE(1),kS("ngIf",r!==o.UNOCCUPIED),LE(1),kS("ngIf",r!==o.UNOCCUPIED)}}function $se(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Gse,5,9,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Zse(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"rect",10),ES(2,"rect",10),_S()),2&e){var n=MS();LE(1),fS("x",n.lastPieceMove.get().coord.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),LE(1),fS("x",n.lastPieceMove.get().end.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function qse(e,t){if(1&e&&(AC(),ES(0,"circle",11)),2&e){var n=MS();fS("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}var Wse=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).UNOCCUPIED=vse.EMPTY,r.lastMove=MB.empty(),r.lastPieceMove=MB.empty(),r.chosen=MB.empty(),r.chosenAutomatically=!1,r.hasAsymetricBoard=!0,r.rules=new wse(kse),r.availableMinimaxes=[new _se(r.rules,"KamisadoMinimax")],r.encoder=yse.encoder,r.tutorial=(new Bse).tutorial,r.canPass=!1,r.updateBoard(),r}return vy(n,[{key:"backgroundColor",value:function(e,t){return pse.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===X7.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=MB.empty(),this.lastMove.isPresent()){var t=this.lastMove.get();t.isPieceMove()&&(this.lastPieceMove=MB.of(t))}this.canPass=wse.mustPass(e);var n=this.rules.getGameStatus(this.rules.node)!==Fte.ONGOING;this.canPass||e.coordToPlay.isAbsent()||n?(this.chosenAutomatically=!1,this.chosen=MB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(D7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(yse.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new hte(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(wte.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),LB.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Cse.PLAY_WITH_SELECTED_PIECE()):(n.chosen=MB.of(a),LB.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=MB.of(new hte(e,t)),LB.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new hte(e,t),o=yse.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=MB.empty())}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-kamisado"]],features:[Xb],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","highlighted"],["id","selectedPiece",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,$se,2,1,"g",1),gS(2,Zse,3,8,"g",2),gS(3,qse,1,3,"circle",3),_S()),2&e&&(fS("viewBox",t.getViewBox())("transform",t.rotation),LE(1),kS("ngForOf",t.board),LE(1),kS("ngIf",t.lastPieceMove.isPresent()),LE(1),kS("ngIf",t.chosen.isPresent()))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jse=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,null,[{key:"getInitialState",value:function(){var e=Q7.NONE,t=Q7.ZERO,r=Q7.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(Ote);return e.SIZE=8,e}(),Yse=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).direction=i,a.direction=cte.factory.fromMove(e,r).get(),a}return vy(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=cte.factory.fromMove(e,t);return r.isFailure()?xB.failure(r.getReason()):e.isNotInRange(jse.SIZE,jse.SIZE)?xB.failure("start coord is not in range"):t.isNotInRange(jse.SIZE,jse.SIZE)?xB.failure("end coord is not in range"):xB.success(new n(e,t,r.get()))}}]),n}(xne);Yse.encoder=xne.getEncoder(jse.SIZE,jse.SIZE,function(e,t){return Yse.of(e,t).get()});var Kse=function(){var e=vy(function e(){hy(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Xa||(Xa=Gg(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ja||(Ja=Gg(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(eo||(eo=Gg(["This piece has no possible move, select another one."])))},e}(),Qse=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=Q7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new jse(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Wg(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Fte.ZERO_WON:i>1&&1===a?Fte.ONE_WON:Fte.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<jse.SIZE;r++)for(var i=0;i<jse.SIZE;i++){var a=new hte(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=cy(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=Yse.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=n9.createTable(jse.SIZE,jse.SIZE,-1),r=[0,0],i=0,a=0;a<jse.SIZE;a++)for(var o=0;o<jse.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new hte(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new hte(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=OB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=cy(cte.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===Q7.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?xB.failure(Kse.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?xB.failure(Kse.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?xB.failure(wte.CANNOT_SELF_CAPTURE()):xB.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=cy(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];jse.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case cte.UP:case cte.DOWN:return[new hte(e.x,0),cte.DOWN];case cte.LEFT:case cte.RIGHT:return[new hte(0,e.y),cte.RIGHT];case cte.UP_RIGHT:case cte.DOWN_LEFT:return[new hte(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),cte.UP_RIGHT];default:return OB.expectToBeMultiple(t,[cte.UP_LEFT,cte.DOWN_RIGHT]),[new hte(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),cte.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Wg(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?MB.of(Q7.NONE):1===r?MB.of(X7.ZERO):1===i?MB.of(X7.ONE):MB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=cy(cte.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=Yse.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Ute),Xse=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){return Qse.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Wg(Qse.getNumberOfGroups(t),2),r=n[0],i=n[1];return new Ete(1===r&&i>1?X7.ZERO.getVictoryValue():r>1&&1===i?X7.ONE.getVictoryValue():100/r*X7.ZERO.getScoreModifier()+100/i*X7.ONE.getScoreModifier())}}]),n}(_te),Jse=Q7.NONE,eue=Q7.ZERO,tue=Q7.ONE,nue=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(to||(to=Gg(["Goal of the game"]))),$localize(no||(no=Gg(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new jse([[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[tue,Jse,Jse,Jse,eue,Jse,Jse,tue],[Jse,Jse,eue,eue,tue,Jse,Jse,Jse],[Jse,Jse,Jse,eue,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse]],0)),Hte.anyMove($localize(ro||(ro=Gg(["Initial board and initial move"]))),$localize(io||(io=Gg(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),jse.getInitialState(),Yse.of(new hte(1,7),new hte(1,5)).get(),$localize(ao||(ao=Gg(["Congratulations!"])))),Hte.fromMove($localize(oo||(oo=Gg(["Jumping"]))),$localize(so||(so=Gg(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new jse([[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,tue,eue,eue,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,eue]],0),[Yse.of(new hte(3,1),new hte(6,1)).get()],$localize(uo||(uo=Gg(["Congratulations!"]))),$localize(co||(co=Gg(["Failed. You did not jump over one of your pieces."])))),Hte.fromMove($localize(lo||(lo=Gg(["Moving"]))),$localize(fo||(fo=Gg(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new jse([[Jse,Jse,Jse,Jse,Jse,Jse,tue,Jse],[Jse,Jse,Jse,Jse,Jse,eue,Jse,Jse],[Jse,Jse,Jse,Jse,tue,Jse,Jse,Jse],[Jse,Jse,Jse,eue,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,tue,Jse,tue],[Jse,Jse,Jse,eue,Jse,Jse,tue,tue],[Jse,Jse,Jse,eue,Jse,Jse,Jse,Jse]],0),[Yse.of(new hte(3,3),new hte(3,0)).get(),Yse.of(new hte(3,3),new hte(0,0)).get(),Yse.of(new hte(3,3),new hte(2,3)).get(),Yse.of(new hte(3,3),new hte(4,3)).get()],$localize(ho||(ho=Gg(["Congratulations!"]))),$localize(vo||(vo=Gg(["Failed. This was not one of the expected moves."])))),Hte.fromPredicate($localize(po||(po=Gg(["Capturing"]))),$localize(go||(go=Gg(["If a move ends on an opponent's piece, it is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new jse([[Jse,eue,Jse,eue,eue,eue,eue,Jse],[tue,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,eue,Jse,tue,Jse,Jse,Jse],[tue,Jse,Jse,Jse,Jse,Jse,Jse,tue],[tue,Jse,Jse,Jse,Jse,Jse,Jse,tue],[tue,Jse,Jse,Jse,Jse,Jse,Jse,tue],[tue,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,eue,eue,eue,eue,eue,eue,Jse]],0),Yse.of(new hte(2,2),new hte(4,2)).get(),function(e,t,n){return t.getPieceAt(e.end)===Q7.ONE?LB.SUCCESS:LB.failure($localize(yo||(yo=Gg(["Failed!"]))))},$localize(mo||(mo=Gg(["Congratulations!"])))),Hte.fromMove($localize(ko||(ko=Gg(["Tie"]))),$localize(Co||(Co=Gg(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new jse([[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse],[eue,Jse,Jse,eue,tue,eue,Jse,Jse],[Jse,Jse,Jse,eue,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,tue],[Jse,Jse,Jse,Jse,Jse,Jse,Jse,Jse]],0),[Yse.of(new hte(0,2),new hte(4,2)).get()],$localize(wo||(wo=Gg(["Congratulations!"]))),$localize(_o||(_o=Gg(["Failed!"]))))]});function rue(e,t){if(1&e&&(AC(),ES(0,"circle",6)),2&e){var n=MS().index,r=MS().index,i=MS();DS("id","piece_",n,"_",r,""),kS("ngClass",i.getPieceClasses(n,r)),fS("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function iue(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"g",3),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(2,"rect",4),gS(3,rue,1,6,"circle",5),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","click_",i,"_",a,""),LE(1),kS("ngClass",o.getSquareClasses(i,a)),fS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r!==o.EMPTY)}}function aue(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,iue,4,8,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function oue(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",7),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S()}if(2&e){var r=t.$implicit,i=MS();fS("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var sue=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=Q7.NONE,r.targets=[],r.selected=MB.empty(),r.lastMove=MB.empty(),r.captured=MB.empty(),r.rules=new Qse(jse),r.availableMinimaxes=[new Xse(r.rules,"LinesOfActionMinimax")],r.encoder=Yse.encoder,r.tutorial=(new nue).tutorial,r.updateBoard(),r}return vy(n,[{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new hte(e,t),!n.selected.equalsValue(a)){r.next=6;break}return r.abrupt("return",(n.cancelMoveAttempt(),LB.SUCCESS));case 6:return o=n.getState().getCurrentPlayer(),r.abrupt("return",n.selected.isAbsent()||n.getState().getPieceAt(a)===o?n.select(a):n.concludeMove(a));case 8:case"end":return r.stop()}},r)}))()}},{key:"concludeMove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=Yse.of(t.selected.get(),e),n.abrupt("return",r.isSuccess()?t.chooseMove(r.get(),t.rules.node.gameState):t.cancelMove(r.getReason()));case 2:case"end":return n.stop()}},n)}))()}},{key:"select",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=MB.of(e),t.targets=Qse.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(Kse.PIECE_CANNOT_MOVE()):LB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?MB.of(e.end):MB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=MB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new hte(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-linesofaction"]],features:[Xb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,aue,2,1,"g",1),gS(2,oue,1,4,"rect",2),_S()),2&e&&(LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.targets))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),uue=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return hy(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return vy(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(Ate);uue.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encodeMove",value:function(e){return{coord:hte.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.coord,"Invalid encoded LodestoneMove"),D7(null!=t.direction,"Invalid encoded LodestoneMove"),D7(null!=t.orientation,"Invalid encoded LodestoneMove"),D7(null!=t.captures,"Invalid encoded LodestoneMove"),new uue(hte.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(j7));var cue=function(){var e=vy(function e(){hy(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(Eo||(Eo=Gg(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(bo||(bo=Gg(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(So||(So=Gg(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(Po||(Po=Gg(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(Oo||(Oo=Gg(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(To||(To=Gg(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),lue=function(){function e(t){hy(this,e),this.unreachable=t}return vy(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();lue.UNREACHABLE=new lue(!0),lue.EMPTY=new lue(!1);var fue=function(){function e(t){hy(this,e),this.owner=t}return vy(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===X7.ZERO?e.ZERO:e.ONE}}]),e}();fue.ZERO=new fue(X7.ZERO),fue.ONE=new fue(X7.ONE);var hue=function(){function e(t,n,r){hy(this,e),this.owner=t,this.direction=n,this.orientation=r}return vy(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();hue.LODESTONES={0:{push:{diagonal:new hue(X7.ZERO,"push","diagonal"),orthogonal:new hue(X7.ZERO,"push","orthogonal")},pull:{diagonal:new hue(X7.ZERO,"pull","diagonal"),orthogonal:new hue(X7.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new hue(X7.ONE,"push","diagonal"),orthogonal:new hue(X7.ONE,"push","orthogonal")},pull:{diagonal:new hue(X7.ONE,"pull","diagonal"),orthogonal:new hue(X7.ONE,"pull","orthogonal")}}};var due=function(){function e(t,n){hy(this,e),this.width=t,this.pieces=n}return vy(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(D7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),MB.empty());for(var r=n9.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(fue.of(t));return MB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:lue.EMPTY}}]),e}();due.POSITIONS=["top","bottom","left","right"],due.EMPTY_5=new due(5,[]),due.EMPTY_3=new due(3,[]);var vue=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return vy(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=cy(due.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return MB.empty();var n=this.getPieceAt(t.get());switch(D7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return MB.of("pull");case"pull":return MB.of("push")}}}],[{key:"getInitialState",value:function(){var e=lue.EMPTY,t=fue.ZERO,r=fue.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new xte,{top:MB.of(due.EMPTY_5),bottom:MB.of(due.EMPTY_5),left:MB.of(due.EMPTY_5),right:MB.of(due.EMPTY_5)})}}]),n}(Ote);return e.SIZE=8,e}(),pue=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,vue)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=n9.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=Zg({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new vue(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=cy(due.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(vue.SIZE,vue.SIZE);i=i.getNext(n)){var a,o=cy(X7.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=lue.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return xB.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return xB.failure(cue.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=cy(due.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return xB.failure(cue.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return xB.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=n9.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=lue.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=hue.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=cy("diagonal"===r?cte.DIAGONALS:cte.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=lue.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=lue.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=cy("diagonal"===r?cte.DIAGONALS:cte.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,vue.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=lue.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=lue.EMPTY)}else o.push(l),t[l.y][l.x]=lue.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?LB.failure(cue.MUST_FLIP_LODESTONE()):LB.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return LB.failure(cue.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return LB.failure(wte.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?LB.failure(wte.MUST_CLICK_ON_EMPTY_SQUARE()):LB.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?Fte.DRAW:0===t[0]?Fte.ONE_WON:0===t[1]?Fte.ZERO_WON:Fte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=MB.of(new n)),n.singleton.get()}}]),n}(Ute);pue.THREATENED_COORD_RANGE=xte.from({top:{startForBigPlate:new hte(0,0),startForSmallPlate:new hte(0,1),direction:cte.RIGHT},bottom:{startForBigPlate:new hte(0,vue.SIZE-1),startForSmallPlate:new hte(0,vue.SIZE-2),direction:cte.RIGHT},left:{startForBigPlate:new hte(0,0),startForSmallPlate:new hte(1,0),direction:cte.DOWN},right:{startForBigPlate:new hte(vue.SIZE-1,0),startForSmallPlate:new hte(vue.SIZE-2,0),direction:cte.DOWN}}),pue.singleton=MB.empty();var gue=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=cy(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=pue.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=cy(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new uue(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new Ste([{top:0,bottom:0,left:0,right:0}]);var n,r=new Ste,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=cy(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(Zg(Zg({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(Zg(Zg({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(Zg(Zg({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(Zg(Zg({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<vue.SIZE;r++)for(var i=0;i<vue.SIZE;i++){var a=new hte(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?X7.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?X7.ONE.getVictoryValue():n[0]*X7.ZERO.getScoreModifier()+n[1]*X7.ONE.getScoreModifier(),new Ete(t)}}]),n}(_te),yue=lue.UNREACHABLE,mue=lue.EMPTY,kue=fue.ZERO,Cue=fue.ONE,wue=hue.of(X7.ONE,{direction:"push",orientation:"orthogonal"}),_ue={top:MB.of(due.EMPTY_5),bottom:MB.of(due.EMPTY_5),left:MB.of(due.EMPTY_5),right:MB.of(due.EMPTY_5)},Eue=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Io||(Io=Gg(["Board and aim of the game"]))),$localize(Ao||(Ao=Gg(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),vue.getInitialState()),Hte.forClick($localize(Ro||(Ro=Gg(["Selecting a lodestone"]))),$localize(Mo||(Mo=Gg(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),vue.getInitialState(),["#lodestone_push_diagonal"],$localize(xo||(xo=Gg(["Congratulations!"]))),$localize(No||(No=Gg(["This is not the right lodestone, try again."])))),Hte.informational($localize(Do||(Do=Gg(["The repelling lodestone"]))),$localize(Lo||(Lo=Gg(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),vue.getInitialState()),Hte.informational($localize(Fo||(Fo=Gg(["The attracting lodestone"]))),$localize(Uo||(Uo=Gg(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),vue.getInitialState()),Hte.informational($localize(Vo||(Vo=Gg(["Flipping the lodestone"]))),$localize(Bo||(Bo=Gg(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),vue.getInitialState()),Hte.fromPredicate($localize(zo||(zo=Gg(["Capturing"]))),$localize(Ho||(Ho=Gg(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),vue.getInitialState(),new uue(new hte(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t,n){return 32===n.remainingSpaces()?LB.failure($localize(Go||(Go=Gg(["You have not captured any of the opponent's pieces, try again!"])))):LB.SUCCESS},"Congratulations!"),Hte.fromPredicate($localize($o||($o=Gg(["Crumbling a first pressure plate"]))),$localize(Zo||(Zo=Gg(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new vue([[mue,mue,mue,mue,Cue,mue,mue,mue],[mue,mue,kue,mue,mue,Cue,mue,mue],[mue,mue,wue,mue,mue,mue,mue,kue],[mue,mue,mue,mue,Cue,mue,mue,kue],[mue,mue,mue,mue,mue,kue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue]],0,new xte([{key:X7.ONE,value:new hte(2,2)}]),Zg(Zg({},_ue),{},{top:due.EMPTY_5.addCaptured(X7.ONE,4)})),new uue(new hte(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return 5===n.pressurePlates.top.get().width?LB.failure($localize(qo||(qo=Gg(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):LB.SUCCESS},"Congratulations!"),Hte.fromPredicate($localize(Wo||(Wo=Gg(["Crumbling a second pressure plate"]))),$localize(jo||(jo=Gg(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new vue([[yue,yue,yue,yue,yue,yue,yue,yue],[mue,mue,mue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,kue],[mue,mue,mue,mue,mue,kue,mue,kue],[mue,wue,mue,mue,Cue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,Cue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue]],0,new xte([{key:X7.ONE,value:new hte(1,4)}]),Zg(Zg({},_ue),{},{top:due.EMPTY_3.addCaptured(X7.ONE,2)})),new uue(new hte(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return n.pressurePlates.top.isPresent()?LB.failure($localize(Yo||(Yo=Gg(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):LB.SUCCESS},"Congratulations!"),Hte.informational($localize(Ko||(Ko=Gg(["Minimal board"]))),$localize(Qo||(Qo=Gg(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new vue([[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,kue,Cue,mue,mue,yue,yue],[yue,yue,wue,Cue,mue,mue,yue,yue],[yue,yue,mue,kue,kue,mue,yue,yue],[yue,yue,kue,mue,mue,mue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0,new xte([{key:X7.ONE,value:new hte(2,3)}]),{top:MB.empty(),bottom:MB.empty(),left:MB.empty(),right:MB.empty()})),Hte.fromMove($localize(Xo||(Xo=Gg(["Making the lodestone fall"]))),$localize(Jo||(Jo=Gg(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new vue([[mue,mue,mue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,mue,Cue,mue,mue],[mue,mue,mue,wue,mue,mue,kue,mue],[mue,mue,kue,kue,Cue,mue,mue,kue],[mue,mue,mue,mue,mue,kue,mue,mue],[mue,mue,kue,mue,mue,mue,mue,mue],[mue,mue,Cue,mue,mue,mue,mue,mue],[mue,mue,mue,mue,mue,mue,mue,mue]],0,new xte([{key:X7.ONE,value:new hte(3,2)}]),Zg(Zg({},_ue),{},{top:due.EMPTY_5.addCaptured(X7.ONE,4)})),[new uue(new hte(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(es||(es=Gg(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(ts||(ts=Gg(["Failed, try again."])))),Hte.fromMove($localize(ns||(ns=Gg(["End of the game"]))),$localize(rs||(rs=Gg(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new vue([[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,Cue,kue,Cue,mue,mue,yue,yue],[yue,Cue,wue,mue,Cue,mue,yue,yue],[yue,mue,mue,kue,kue,mue,yue,yue],[yue,Cue,kue,mue,Cue,mue,yue,yue],[yue,mue,mue,mue,kue,mue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0,new xte([{key:X7.ONE,value:new hte(2,3)}]),{top:MB.empty(),bottom:due.EMPTY_3.addCaptured(X7.ZERO,2),left:MB.of(due.EMPTY_3),right:MB.empty()}),[new uue(new hte(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(is||(is=Gg(["Congratulations, you won!"]))),$localize(as||(as=Gg(["This is not the winning move. Try again."]))))]});function bue(e,t){if(1&e&&(AC(),ES(0,"circle",10)),2&e){var n=MS(2),r=n.index,i=n.$implicit,a=MS().index,o=MS();DS("id","piece_",r,"_",a,""),kS("ngClass",i.pieceClasses),fS("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Sue(e,t){if(1&e&&(AC(),ES(0,"polygon",15)),2&e){var n=MS().$implicit,r=MS(3).$implicit,i=MS(2);pS("transform","rotate(",90*n,")"),kS("ngClass",r.lodestone.movingClass),fS("points",i.TRIANGLE_OUT)}}function Pue(e,t){if(1&e&&(AC(),ES(0,"polygon",15)),2&e){var n=MS().$implicit,r=MS(3).$implicit,i=MS(2);pS("transform","rotate(",90*n,")"),kS("ngClass",r.lodestone.movingClass),fS("points",i.TRIANGLE_IN)}}function Oue(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Sue,1,3,"polygon",14),gS(2,Pue,1,3,"polygon",14),_S()),2&e){var n=MS(3).$implicit;LE(1),kS("ngIf","push"===n.lodestone.direction),LE(1),kS("ngIf","pull"===n.lodestone.direction)}}var Tue=function(){return[0,1,2,3]};function Iue(e,t){if(1&e&&(AC(),wS(0,"g",11),ES(1,"circle",12),ES(2,"circle",13),wS(3,"g"),gS(4,Oue,3,2,"g",1),_S(),_S()),2&e){var n=MS(2),r=n.index,i=n.$implicit,a=MS().index,o=MS();fS("transform",o.getSquareTransform(r,a)),LE(1),kS("ngClass",i.lodestone.selectedClass),fS("r",o.PIECE_RADIUS),LE(1),kS("ngClass",i.lodestone.pieceClasses),fS("r",o.PIECE_RADIUS/4),LE(1),pS("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),LE(1),kS("ngForOf",PT(7,Tue))}}function Aue(e,t){if(1&e){var n=PS();AC(),wS(0,"g",6),IS("click",function(){tC(n);var e=MS().$implicit;return MS(2).selectCoord(e.coord)}),ES(1,"rect",7),gS(2,bue,1,6,"circle",8),gS(3,Iue,5,8,"g",9),_S()}if(2&e){var r=MS(),i=r.index,a=r.$implicit,o=MS().index,s=MS();DS("id","square_",i,"_",o,""),LE(1),kS("ngClass",a.squareClasses),fS("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),LE(1),kS("ngIf",a.hasPiece),LE(1),kS("ngIf",a.lodestone)}}function Rue(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Aue,4,9,"g",5),_S()),2&e){var n=t.$implicit;LE(1),kS("ngIf",!1===n.crumbled)}}function Mue(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Rue,2,1,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function xue(e,t){if(1&e&&(AC(),wS(0,"g",16),ES(1,"circle",17),_S()),2&e){var n=t.$implicit,r=t.index,i=MS();NS("id","capture_",r,""),fS("transform",i.getCaptureTransform(r)),LE(1),kS("ngClass",n.pieceClasses),fS("r",i.PIECE_RADIUS)}}function Nue(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"polygon",15),_S()),2&e){var n=t.$implicit,r=MS().$implicit,i=MS();LE(1),pS("transform","rotate(",90*n,")"),kS("ngClass",r.movingClass),fS("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Due(e,t){if(1&e){var n=PS();AC(),wS(0,"g",6),IS("click",function(){var e=tC(n).$implicit;return MS().selectLodestone(e)}),ES(1,"circle",12),ES(2,"circle",13),wS(3,"g"),gS(4,Nue,2,3,"g",1),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS();DS("id","lodestone_",r.direction,"_",r.orientation,""),fS("transform",a.getAvailableLodestoneTransform(i)),LE(1),kS("ngClass",r.selectedClass),fS("r",a.PIECE_RADIUS),LE(1),kS("ngClass",r.pieceClasses),fS("r",a.PIECE_RADIUS/4),LE(1),pS("transform","rotate(","diagonal"===r.orientation?45:0,")"),LE(1),kS("ngForOf",PT(9,Tue))}}function Lue(e,t){if(1&e&&(AC(),ES(0,"circle",10)),2&e){var n=MS(),r=n.index,i=n.$implicit,a=MS().$implicit,o=MS();DS("id","platePiece_",a.position,"_",r,""),kS("ngClass",i.pieceClasses),fS("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Fue(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"g",6),IS("click",function(){var e=tC(n),t=e.$implicit,r=e.index,i=MS().$implicit;return MS().onPressurePlateClick(t.temporary,i.position,r)}),ES(2,"rect",18),gS(3,Lue,1,6,"circle",8),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().$implicit,o=MS();fS("transform",o.getPressurePlateTransform(a.position)),LE(1),DS("id","plate_",a.position,"_",i,""),LE(1),DS("id","plateSquare_",a.position,"_",i,""),kS("ngClass",r.squareClasses),fS("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r.hasPiece)}}function Uue(e,t){if(1&e&&(AC(),wS(0,"g",16),gS(1,Fue,4,11,"g",1),_S()),2&e){var n=t.$implicit;NS("id","pressurePlate_",n.position,""),LE(1),kS("ngForOf",n.coords)}}function Vue(e,t){if(1&e&&(AC(),ES(0,"rect",19)),2&e){var n=MS();DS("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),fS("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var Bue=function(e){ey(n,e);var t=ny(n);function n(e){var r;hy(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:MB.empty(),pressurePlateShift:{top:new ote(0,0),left:new ote(0,0),right:new ote(0,0),bottom:new ote(0,0)}},r.stateAfterPlacingLodestone=MB.empty(),r.lastInfos=MB.empty(),r.capturesToPlace=0,r.selectedCoord=MB.empty(),r.selectedLodestone=MB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=pue.get(),r.tutorial=(new Eue).tutorial,r.availableMinimaxes=[new gue(r.rules,"LodestoneDummyMinimax")],r.encoder=uue.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.rules.node.gameState,r.scores=MB.of([0,0]),r}return vy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(cue.MUST_PLACE_CAPTURES()));case 5:return i=pue.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),LB.SUCCESS):(t.selectedCoord=MB.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),LB.SUCCESS)));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return D7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),a=hue.of(i,e),n.abrupt("return",t.selectedLodestone.equalsValue(a)?(t.cancelMoveAttempt(),LB.SUCCESS):(t.selectedLodestone=MB.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),LB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.selectedCoord.isPresent(),"coord should have been selected"),D7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),D7(pue.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=pue.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=MB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=MB.of(e.displayedState),e.updateViewInfo(),LB.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.selectedCoord.isPresent(),"coord should have been selected"),D7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new uue(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(cue.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=n9.copyBiArray(a.board),u=Zg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(pue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new vue(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),LB.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=n9.copyBiArray(a.board),u=Zg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(pue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new vue(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),LB.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=MB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=MB.empty(),this.lastInfos=MB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=n9.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=lue.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=MB.empty(),this.selectedLodestone=MB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<vue.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<vue.SIZE;t++){var n=new hte(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:MB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=hue.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=cy(due.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=MB.of(pue.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=cy(due.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=OB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=cy(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=cy(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}}catch(s){n.e(s)}finally{n.f()}var i,a=cy(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new hte(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new hte(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new hte(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new hte(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(vue.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(vue.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(dte);Bue.PRESSURE_PLATE_EXTRA_SHIFT=.2,Bue.PRESSURE_PLATES_POSITIONS=xte.from({top:{startForBigPlate:new hte(.5,-1-Bue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new hte(1.5,0-Bue.PRESSURE_PLATE_EXTRA_SHIFT),direction:cte.RIGHT},bottom:{startForBigPlate:new hte(.5,8+Bue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new hte(1.5,7+Bue.PRESSURE_PLATE_EXTRA_SHIFT),direction:cte.RIGHT},left:{startForBigPlate:new hte(-1-Bue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new hte(0-Bue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:cte.DOWN},right:{startForBigPlate:new hte(8+Bue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new hte(7+Bue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:cte.DOWN}}),Bue.\u0275fac=function(e){return new(e||Bue)(mS(x7))},Bue.\u0275cmp=lk({type:Bue,selectors:[["app-lodestone"]],features:[Xb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Mue,2,1,"g",1),gS(2,xue,2,4,"g",2),gS(3,Due,5,10,"g",3),gS(4,Uue,2,2,"g",2),gS(5,Vue,1,6,"rect",4),_S()),2&e&&(LE(1),kS("ngForOf",t.viewInfo.boardInfo),LE(1),kS("ngForOf",t.viewInfo.capturesToPlace),LE(1),kS("ngForOf",t.viewInfo.availableLodestones),LE(1),kS("ngForOf",t.viewInfo.pressurePlates),LE(1),kS("ngIf",t.viewInfo.selected.isPresent()))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var zue=function(){var e=vy(function e(){hy(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(os||(os=Gg(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(ss||(ss=Gg(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize(us||(us=Gg(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(cs||(cs=Gg(["Drones must move one or two steps in any direction."])))},e}(),Hue=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return vy(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return xB.failure(zue.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return xB.failure(zue.END_COORD_OUT_OF_RANGE());if(t.equals(e))return xB.failure(wte.MOVE_CANNOT_BE_STATIC());var i=cte.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?xB.failure(i.getReason()):xB.success(new n(e,t,r))}}]),n}(xne);Hue.encoder=Y7.tuple([hte.numberEncoder(4,8),hte.numberEncoder(4,8),Y7.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return Hue.from(e[0],e[1],e[2]).get()});var Gue=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){D7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?MB.of(e.from(r)):MB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(OB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();Gue.EMPTY=new Gue(0),Gue.PAWN=new Gue(1),Gue.DRONE=new Gue(2),Gue.QUEEN=new Gue(3);var $ue=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).ruler=e,i}return vy(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=cy(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case Gue.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case Gue.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case Gue.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new hte(t,n),a=[],o=cy(cte.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(Gue.DRONE),s=!1===e.isTherePieceOnPlayerSide(Gue.QUEEN),u=e.lastMove,c=cy(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===Gue.EMPTY)this.add(i,Hue.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=Gue.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=Hue.from(t,l).get();(d===Gue.DRONE&&o||d===Gue.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,Hue.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new hte(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=cy(cte.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(Gue.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(Gue.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new hte(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(X7.ZERO);t=e.gameState.getScoreOf(X7.ONE)-r}return new Ete(t)}}]),n}(_te),Zue=function(){function e(t){hy(this,e),this.captures=t,t.makeImmutable()}return vy(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new xte,i=cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),que=function(e){ey(n,e);var t=ny(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:MB.empty(),s=arguments.length>4?arguments[4]:void 0;return hy(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new xte([{key:X7.ZERO,value:Zue.from([])},{key:X7.ONE,value:Zue.from([])}])),s.makeImmutable(),i.captured=s,i}return vy(n,[{key:"getPlayerTerritory",value:function(e){return e===X7.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=cy(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(X7.ZERO)?MB.of(X7.ZERO):this.isTerritoryEmpty(X7.ONE)?MB.of(X7.ONE):MB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=cy(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==Gue.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(e).get();return[t.captures.get(Gue.PAWN).getOrElse(0),t.captures.get(Gue.DRONE).getOrElse(0),t.captures.get(Gue.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=Gue.EMPTY,t=Gue.PAWN,r=Gue.DRONE,i=Gue.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,MB.empty())}}]),n}(Ote);que.PLAYER_ZERO_TERRITORY=new Ste([4,5,6,7]),que.PLAYER_ONE_TERRITORY=new Ste([0,1,2,3]);var Wue=function(){var e=vy(function e(){hy(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(ls||(ls=Gg(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(fs||(fs=Gg(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(hs||(hs=Gg(["You cannot perform a move that is the reverse of the previous one."])))},e}(),jue=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=Gue.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=MB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new que(i,t.turn+1,MB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return xB.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return xB.failure(Wue.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return xB.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){D7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==Gue.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==Gue.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return xB.failure(Wue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return xB.failure(Wue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return xB.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return xB.failure(Wue.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===Gue.EMPTY)return xB.failure(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===Gue.PAWN)return e.isValidForPawn()?xB.success(void 0):xB.failure(zue.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===Gue.DRONE&&!1===e.isValidForDrone())return xB.failure(zue.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=cy(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==Gue.EMPTY)return xB.failure(wte.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return xB.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return Gue.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,Fte.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=Fte.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return Fte.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(X7.ZERO),r=e.getScoreOf(X7.ONE);return n>r?Fte.ZERO_WON:r>n?Fte.ONE_WON:t}}]),n}(Ute);jue.STARTING_COUNT_DOWN=MB.of(7);var Yue=function(){var e=vy(function e(){hy(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(ds||(ds=Gg(["Failed, you did not capture any piece."])))},e}(),Kue=Gue.EMPTY,Que=Gue.PAWN,Xue=Gue.DRONE,Jue=Gue.QUEEN,ece=function(){return $localize(vs||(vs=Gg(["This is not a field promotion!"])))},tce=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(ps||(ps=Gg(["Goal of the game"]))),$localize(gs||(gs=Gg(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),que.getInitialState()),Hte.informational($localize(ys||(ys=Gg(["The pieces"]))),$localize(ms||(ms=Gg(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),que.getInitialState()),Hte.fromPredicate($localize(ks||(ks=Gg(["Moving pawns"]))),$localize(Cs||(Cs=Gg(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),que.getInitialState(),Hue.from(new hte(2,5),new hte(1,4)).get(),function(e,t,n){return n.getPieceAt(e.end)===Gue.PAWN?LB.SUCCESS:LB.failure($localize(ws||(ws=Gg(["This is not a pawn!"]))))},$localize(_s||(_s=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Es||(Es=Gg(["Moving drones"]))),$localize(bs||(bs=Gg(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),que.getInitialState(),Hue.from(new hte(1,7),new hte(0,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Gue.DRONE?LB.SUCCESS:LB.failure($localize(Ss||(Ss=Gg(["This is not a drone!"]))))},$localize(Ps||(Ps=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Os||(Os=Gg(["Moving queens"]))),$localize(Ts||(Ts=Gg(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new que([[Xue,Que,Kue,Kue],[Jue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Jue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Jue,Xue,Que,Kue]],1),Hue.from(new hte(2,3),new hte(2,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Gue.QUEEN?LB.SUCCESS:LB.failure($localize(Is||(Is=Gg(["This is not a queen!"]))))},$localize(As||(As=Gg(["Congratulations!"])))),Hte.fromMove($localize(Rs||(Rs=Gg(["Capture"]))),$localize(Ms||(Ms=Gg(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new que([[Xue,Que,Que,Kue],[Kue,Kue,Kue,Kue],[Jue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Que,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Xue,Que,Kue]],1),[Hue.from(new hte(0,2),new hte(2,4)).get()],$localize(xs||(xs=Gg(["Congratulations! By capturing that pawn, you won one point."]))),Yue.YOU_DID_NOT_CAPTURE_ANY_PIECE()),Hte.fromMove($localize(Ns||(Ns=Gg(["Field Promotion (1/2)"]))),$localize(Ds||(Ds=Gg(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new que([[Kue,Kue,Kue,Jue],[Kue,Que,Kue,Kue],[Kue,Kue,Que,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Jue],[Kue,Kue,Xue,Kue],[Kue,Que,Kue,Kue]],1),[Hue.from(new hte(1,1),new hte(2,2)).get(),Hue.from(new hte(2,2),new hte(1,1)).get()],$localize(Ls||(Ls=Gg(["Congratulations!"]))),ece()),Hte.fromPredicate($localize(Fs||(Fs=Gg(["Field Promotion (2/2)"]))),$localize(Us||(Us=Gg(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new que([[Que,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Xue,Kue],[Kue,Que,Kue,Kue]],0),Hue.from(new hte(1,7),new hte(2,6)).get(),function(e,t,n){return n.getPieceAt(e.end)===Gue.QUEEN?LB.SUCCESS:LB.failure(ece())},$localize(Vs||(Vs=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Bs||(Bs=Gg(["Call the clock"]))),$localize(zs||(zs=Gg(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),que.getInitialState(),Hue.from(new hte(1,5),new hte(0,4),!0).get(),function(e,t,n){return e.calledTheClock?LB.SUCCESS:LB.failure($localize(Hs||(Hs=Gg(["You did not call the clock!"]))))},$localize(Gs||(Gs=Gg(["Congratulations!"])))),Hte.fromMove($localize($s||($s=Gg(["Restarting the clock"]))),$localize(Zs||(Zs=Gg(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new que([[Kue,Kue,Kue,Kue],[Kue,Que,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Que],[Kue,Kue,Xue,Kue],[Kue,Que,Kue,Kue]],15,MB.empty(),MB.of(1)),[Hue.from(new hte(1,1),new hte(2,2)).get()],$localize(qs||(qs=Gg(["Congratulations!"]))),$localize(Ws||(Ws=Gg(["This is not a capture, the game is now over, please retry!"])))),Hte.anyMove($localize(js||(js=Gg(["End game (by clock)"]))),$localize(Ys||(Ys=Gg(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new que([[Kue,Kue,Kue,Jue],[Kue,Que,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Xue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Xue,Kue,Kue]],15,MB.empty(),MB.of(1)),Hue.from(new hte(1,1),new hte(2,2)).get(),$localize(Ks||(Ks=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Qs||(Qs=Gg(["End by emptyness"]))),$localize(Xs||(Xs=Gg(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new que([[Kue,Kue,Kue,Jue],[Kue,Que,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Que,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue],[Kue,Kue,Kue,Kue]],0),Hue.from(new hte(2,4),new hte(1,3)).get(),function(e,t,n){return 3===e.end.y?LB.SUCCESS:LB.failure($localize(Js||(Js=Gg(["Your piece is still in you territory!"]))))},$localize(eu||(eu=Gg(["Congratulations!"]))))]});function nce(e,t){if(1&e&&(AC(),ES(0,"g",20)),2&e){var n=MS(2).index,r=MS().index,i=MS();WS(i.style),DS("mainShapeId","pawn_",n,"_",r,""),kS("pieceClasses",i.getPieceClasses(n,r))}}function rce(e,t){if(1&e&&(AC(),ES(0,"g",21)),2&e){var n=MS(2).index,r=MS().index,i=MS();WS(i.style),DS("mainShapeId","drone_",n,"_",r,""),kS("pieceClasses",i.getPieceClasses(n,r))}}function ice(e,t){if(1&e&&(AC(),ES(0,"g",22)),2&e){var n=MS(2).index,r=MS().index,i=MS();WS(i.style),DS("mainShapeId","queen_",n,"_",r,""),kS("pieceClasses",i.getPieceClasses(n,r))}}function ace(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,nce,1,5,"g",17),gS(2,rce,1,5,"g",18),gS(3,ice,1,5,"g",19),_S()),2&e){var n=MS(),r=n.index,i=n.$implicit,a=MS().index,o=MS();fS("transform",o.getPieceLocation(r,a)),LE(1),kS("ngIf",i===o.pieces.PAWN),LE(1),kS("ngIf",i===o.pieces.DRONE),LE(1),kS("ngIf",i===o.pieces.QUEEN)}}function oce(e,t){if(1&e){var n=PS();AC(),wS(0,"g",15),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(1,"rect",16),gS(2,ace,4,4,"g",14),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();DS("id","click_",i,"_",a,""),fS("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),LE(1),DS("id","square_",i,"_",a,""),kS("ngClass",o.getSquareClasses(i,a)),fS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r!==o.pieces.EMPTY)}}function sce(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",23),IS("click",function(){var e=tC(n).$implicit;return MS(3).onClick(e.x,e.y)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS(3);LE(1),DS("id","indicator_",r.x,"_",r.y,""),fS("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function uce(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,sce,2,7,"g",1),_S()),2&e){var n=MS(2);LE(1),kS("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function cce(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,oce,3,11,"g",13),gS(2,uce,2,1,"g",14),_S()),2&e){var n=t.$implicit,r=MS();fS("transform","translate("+r.SPACE_SIZE+", 0)"),LE(1),kS("ngForOf",n),LE(1),kS("ngIf",r.selectedPieceInfo.isPresent())}}function lce(e,t){if(1&e&&(AC(),wS(0,"text",24),iP(1),_S()),2&e){var n=MS();kS("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),fS("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),LE(1),aP(n.countDown.get())}}function fce(e,t){if(1&e&&(AC(),ES(0,"polyline",25)),2&e){var n=MS();kS("ngClass",n.getClockCircleClasses()),fS("points",n.clockNeedlesPoints)}}var hce=function(e){return[e]};function dce(e,t){if(1&e){var n=PS();AC(),bS(0),wS(1,"g",28),IS("click",function(){var e=tC(n).index;return MS(2).chooseStyle(e)}),_S(),SS()}if(2&e){var r=t.$implicit,i=t.index,a=MS(2);LE(1),WS(r.style),kS("id",r.name)("pieceClasses",OT(5,hce,"player"+a.getCurrentPlayer().value)),fS("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function vce(e,t){if(1&e&&(AC(),wS(0,"g",26),ES(1,"rect",27),gS(2,dce,2,7,"ng-container",1),_S()),2&e){var n=MS();LE(1),fS("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),LE(1),kS("ngForOf",n.listOfStyles)}}function pce(e,t){if(1&e&&(AC(),wS(0,"text",34),iP(1),_S()),2&e){var n=MS(2).$implicit,r=MS().$implicit,i=MS();kS("ngClass","player"+(0===r.value?1:0)),fS("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),LE(1),aP(n+" x ")}}function gce(e,t){if(1&e&&(AC(),ES(0,"g",35)),2&e){var n=MS(3).$implicit;WS(MS().style),kS("pieceClasses",OT(3,hce,"player"+(0===n.value?1:0)))}}function yce(e,t){if(1&e&&(AC(),ES(0,"g",36)),2&e){var n=MS(3).$implicit;WS(MS().style),kS("pieceClasses",OT(3,hce,"player"+(0===n.value?1:0)))}}function mce(e,t){if(1&e&&(AC(),ES(0,"g",37)),2&e){var n=MS(3).$implicit;WS(MS().style),kS("pieceClasses",OT(3,hce,"player"+(0===n.value?1:0)))}}function kce(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,pce,2,4,"text",30),wS(2,"g",29),gS(3,gce,1,5,"g",31),gS(4,yce,1,5,"g",32),gS(5,mce,1,5,"g",33),_S(),_S()),2&e){var n=MS(),r=n.index,i=n.$implicit,a=MS().$implicit,o=MS();fS("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),LE(1),kS("ngIf",i>1),LE(1),DS("id","piece_",r,"_player_",a.value,""),fS("transform","translate("+o.SPACE_SIZE+", 0)"),LE(1),kS("ngIf",0===r),LE(1),kS("ngIf",1===r),LE(1),kS("ngIf",2===r)}}function Cce(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,kce,6,8,"g",14),_S()),2&e){var n=t.$implicit;LE(1),kS("ngIf",n>0)}}function wce(e,t){if(1&e&&(AC(),wS(0,"g"),wS(1,"g",29),gS(2,Cce,2,1,"g",1),_S(),_S()),2&e){var n=t.$implicit,r=MS();LE(1),NS("id","capture_of_player_",n.value,""),fS("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n.value*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),LE(1),kS("ngForOf",r.state.getCapturesOf(n))}}var _ce=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=Gue,r.selectedPieceInfo=MB.empty(),r.countDown=MB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.hasAsymetricBoard=!0,r.rules=new jue(que),r.availableMinimaxes=[new $ue(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=Hue.encoder,r.tutorial=(new tce).tutorial,r.scores=MB.of([0,0]),r.updateBoard(),r}return vy(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board;var e=this.state.getScoreOf(X7.ZERO),t=this.state.getScoreOf(X7.ONE);this.countDown=this.state.countDown,this.scores=MB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new hte(e,t),r=[];return r.push(t>3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==Gue.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new hte(0,t))&&r.push("highlighted"),r}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new hte(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),LB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=MB.of({selectedPiece:e,legalLandings:r}),LB.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===Gue.PAWN?cte.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===Gue.DRONE?2:8)).filter(function(n){var r=Hue.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return cte.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===Gue.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),LB.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return D7((i=Hue.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.rules.node.gameState,n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=Hue.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==Gue.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=MB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),LB.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===X7.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===Gue.EMPTY||i.gameState.isInOpponentTerritory(new hte(0,t))?r.push("moved"):r.push("captured"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new hte(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new hte(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(Ene);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-martian-chess"]],features:[Xb],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,cce,3,3,"g",1),wS(2,"g",2),IS("click",function(){return t.onClockClick()}),ES(3,"rect",3),ES(4,"circle",4),gS(5,lce,2,5,"text",5),gS(6,fce,1,2,"polyline",6),_S(),ES(7,"line",7),wS(8,"g",8),wS(9,"g",9),IS("click",function(){return t.onModeCogClick()}),ES(10,"rect",3),ES(11,"path",10),_S(),gS(12,vce,3,5,"g",11),_S(),wS(13,"g",12),gS(14,wce,3,3,"g",1),_S(),_S()),2&e&&(fS("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT)("transform",t.rotation),LE(1),kS("ngForOf",t.board),LE(1),fS("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),LE(1),fS("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),LE(1),kS("ngClass",t.getClockCircleClasses()),fS("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),LE(1),kS("ngIf",t.countDown.isPresent()),LE(1),kS("ngIf",t.countDown.isAbsent()),LE(1),kS("ngClass","player"+t.getCurrentPlayer().value),fS("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),LE(1),fS("transform",t.configViewTranslation),LE(2),fS("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),LE(1),kS("ngClass","player"+t.getCurrentPlayer().value),fS("transform",t.configCogTransformation),LE(1),kS("ngIf",t.displayModePanel),LE(2),kS("ngForOf",t.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ece=Number.MAX_SAFE_INTEGER,bce=Number.MIN_SAFE_INTEGER,Sce=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,n9.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return vy(n,null,[{key:"getInitialState",value:function(){return new n(0,new hte(0,0))}}]),n}(Ote);Sce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Sce.BOARD_1=[[0,+Ece,-1,-1],[1,2,+Ece,-1],[+bce,3,4,-1],[-1,+bce,+bce,-1]],Sce.BOARD_2=[[0,+Ece,-1,-1],[+Ece,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Sce.BOARD_3=[[0,1,+bce,-1],[1,+bce,-1,-1],[+bce,-1,-1,-1],[-1,-1,-1,-1]],Sce.BOARD_4=[[0,1,+bce,-1],[1,+bce,-1,-1],[+bce,-1,-1,-1],[-1,-1,-1,1]],Sce.initialBoard=Sce.BOARD_0;var Pce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new hte(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Sce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?xB.failure("incorrect move"):xB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===X7.ZERO.getVictoryValue()?Fte.ZERO_WON:n===X7.ONE.getVictoryValue()?Fte.ONE_WON:t.location.equals(new hte(3,3))?0===n?Fte.DRAW:n>0?Fte.ONE_WON:Fte.ZERO_WON:Fte.ONGOING}}]),n}(Ute),Oce=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).right=e,r}return vy(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(Ite);Oce.RIGHT=new Oce(!0),Oce.DOWN=new Oce(!1),Oce.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Oce.RIGHT:Oce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(Y7));var Tce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=Pce.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n=e.gameState;return new Ete(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Oce.RIGHT),n.location.y<3&&t.push(Oce.DOWN),t}}]),n}(_te);function Ice(e,t){1&e&&(bS(0),iP(1,"("),SS())}function Ace(e,t){1&e&&(bS(0),iP(1,")"),SS())}function Rce(e,t){if(1&e&&(wS(0,"td"),gS(1,Ice,2,0,"ng-container",3),iP(2),gS(3,Ace,2,0,"ng-container",3),_S()),2&e){var n=t.$implicit,r=t.index,i=MS().index,a=MS();LE(1),kS("ngIf",a.coord.x===r&&a.coord.y===i),LE(1),oP(" ",n," "),LE(1),kS("ngIf",a.coord.x===r&&a.coord.y===i)}}function Mce(e,t){if(1&e&&(wS(0,"tr"),gS(1,Rce,4,3,"td",0),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var xce=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).coord=new hte(-1,-1),r.rules=new Pce(Sce),r.availableMinimaxes=[new Tce(r.rules,"MinimaxTestingMinimax")],r.encoder=Oce.encoder,r}return vy(n,[{key:"chooseRight",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Oce.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Oce.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-minimax-testing"]],features:[Xb],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(wS(0,"table"),gS(1,Mce,2,1,"tr",0),wS(2,"div",1),IS("click",function(){return t.chooseRight()}),iP(3," goRight "),_S(),wS(4,"div",2),IS("click",function(){return t.chooseDown()}),iP(5," goDown "),_S(),wS(6,"div"),iP(7),_S(),_S()),2&e&&(LE(1),kS("ngForOf",t.board),LE(6),oP(" ",t.coord," "))},directives:[rR,aR],encapsulation:2}),e}(),Nce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,null,[{key:"getInitialState",value:function(){return new n(n9.createTable(7,6,Q7.NONE),0)}}]),n}(Ote),Dce=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this)).x=e,r}return vy(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(Ite);Dce.ZERO=new Dce(0),Dce.ONE=new Dce(1),Dce.TWO=new Dce(2),Dce.THREE=new Dce(3),Dce.FOUR=new Dce(4),Dce.FIVE=new Dce(5),Dce.SIX=new Dce(6),Dce.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Dce.of(e)}}]),n}(Y7));var Lce=function(){var e=vy(function e(){hy(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(tu||(tu=Gg(["Please put your piece in an incomplete column."])))},e}(),Fce=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Nce(a,s+1)}},{key:"isLegal",value:function(e,t){return TB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?xB.failure(Lce.COLUMN_IS_FULL()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new hte(r,i));if(Lte.getScoreStatus(a)===Mte.VICTORY)return Fte.getVictory(t.getCurrentOpponent())}return 42===t.turn?Fte.DRAW:Fte.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new hte(r,i));(a===X7.ZERO.getVictoryValue()||a===X7.ONE.getVictoryValue())&&t.push(new hte(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){TB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new hte(r,i));if(Lte.getScoreStatus(a)!==Mte.DEFAULT)return TB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new Ete(a);t+=a}return new Ete(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===Q7.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new hte(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return D7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===X7.ONE?X7.ZERO:X7.ONE}},{key:"getSquareScore",value:function(e,t){TB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),TB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new xte,u=new xte,c=cy(cte.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[cte.UP,cte.UP_RIGHT,cte.RIGHT,cte.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return TB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){TB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===Q7.NONE){var a=Dce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return TB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Ute);return e.VERBOSE=!1,e}(),Uce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){return Fce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return TB(Fce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Fce.getBoardValue(t)}}]),n}(_te),Vce=Q7.NONE,Bce=Q7.ZERO,zce=Q7.ONE,Hce=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(nu||(nu=Gg(["Goal of the game"]))),$localize(ru||(ru=Gg(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Nce.getInitialState()),Hte.anyMove($localize(iu||(iu=Gg(["Dropping a piece"]))),$localize(au||(au=Gg(["Click on any space in any column."]))),Nce.getInitialState(),Dce.THREE,$localize(ou||(ou=Gg(["As you can see, the piece falls at the bottom of the column."])))),Hte.fromMove($localize(su||(su=Gg(["Victory"]))),$localize(uu||(uu=Gg(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Nce([[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,zce,Vce,Vce,Vce],[Vce,Vce,Vce,zce,Vce,Vce,Vce],[Vce,Vce,Bce,Bce,Bce,zce,Vce]],0),[Dce.of(1)],$localize(cu||(cu=Gg(["You won!"]))),$localize(lu||(lu=Gg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Hte.fromMove($localize(fu||(fu=Gg(["Other victory"]))),$localize(hu||(hu=Gg(["You can also align 4 pieces diagonally or vertically."]))),new Nce([[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,Vce,Vce,Vce,Vce],[Vce,Vce,Vce,Bce,zce,Vce,Vce],[Vce,Vce,Bce,Bce,zce,Vce,Vce],[Vce,Bce,zce,Bce,Bce,Vce,Vce]],0),[Dce.of(3),Dce.of(4)],$localize(du||(du=Gg(["You won!"]))),$localize(vu||(vu=Gg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function Gce(e,t){if(1&e&&(AC(),ES(0,"circle",8)),2&e){var n=MS().index,r=MS().index,i=MS();kS("ngClass",i.getSquareFillClass(n,r)),fS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function $ce(e,t){if(1&e){var n=PS();AC(),wS(0,"g",5),IS("click",function(){var e=tC(n).index;return MS(2).onClick(e)}),ES(1,"rect",6),gS(2,Gce,1,4,"circle",7),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();NS("id","click_",i,""),LE(1),fS("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r!==o.EMPTY)}}function Zce(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,$ce,3,6,"g",4),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function qce(e,t){if(1&e&&(AC(),ES(0,"rect",9)),2&e){var n=MS();fS("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Wce(e,t){if(1&e&&(AC(),ES(0,"rect",10)),2&e){var n=t.$implicit,r=MS();DS("id","victory_coord_",n.x,"_",n.y,""),fS("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var jce=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).EMPTY=Q7.NONE,r.victoryCoords=[],r.rules=new Fce(Nce),r.availableMinimaxes=[new Uce(r.rules,"P4Minimax")],r.encoder=Dce.encoder,r.tutorial=(new Hce).tutorial,r.updateBoard(),r}return vy(n,[{key:"onClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Dce.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Fce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Fce.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=MB.of(new hte(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=MB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(Ene);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-p4"]],features:[Xb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Zce,2,1,"g",1),gS(2,qce,1,4,"rect",2),gS(3,Wce,1,6,"rect",3),_S()),2&e&&(LE(1),kS("ngForOf",t.board),LE(1),kS("ngIf",t.last.isPresent()),LE(1),kS("ngForOf",t.victoryCoords))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yce=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(hy(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return ry(a)}return vy(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,MB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,MB.empty())}}]),n}(Ate);Yce.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encodeMove",value:function(e){var t={coord:hte.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=hte.encoder.decode(t.coord),r=MB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return Yce.withRotation(n.x,n.y,r.get(),i)}return Yce.rotationless(n.x,n.y)}}]),n}(j7));var Kce=function(){var e=vy(function e(){hy(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(pu||(pu=Gg(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(gu||(gu=Gg(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),Qce=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return vy(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(cte.UP,1)),i=this.getPieceAt(t.getNext(cte.UP_LEFT,1));return this.getPieceAt(t.getNext(cte.RIGHT,1))===r&&this.getPieceAt(t.getNext(cte.DOWN,1))===r&&this.getPieceAt(t.getNext(cte.LEFT,1))===r&&this.getPieceAt(t.getNext(cte.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(cte.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(cte.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=cy(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=cy(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(n9.createTable(6,6,Q7.NONE),0)}},{key:"getBlockCenter",value:function(e){return new hte(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(Ote);Qce.ROTATION_MAP=[[new hte(-1,-1),new hte(1,-1)],[new hte(0,-1),new hte(1,0)],[new hte(1,-1),new hte(1,1)],[new hte(1,0),new hte(0,1)],[new hte(1,1),new hte(-1,1)],[new hte(0,1),new hte(-1,0)],[new hte(-1,1),new hte(-1,-1)],[new hte(-1,0),new hte(0,-1)]];var Xce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return xB.failure(Kce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return xB.failure(Kce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return xB.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=cy(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Fte.DRAW:Fte.ZERO_WON:!0===r[1]?Fte.ONE_WON:36===t.turn?Fte.DRAW:Fte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=MB.of(new n(Qce))),n.singleton.get()}}]),n}(Ute);Xce.singleton=MB.empty(),Xce.VICTORY_SOURCE=[[new hte(1,0),new ote(1,1),!1],[new hte(0,1),new ote(1,1),!1],[new hte(4,0),new ote(-1,1),!1],[new hte(5,1),new ote(-1,1),!1],[new hte(1,1),new ote(1,1),!0],[new hte(4,1),new ote(-1,1),!0],[new hte(0,1),new ote(0,1),!0],[new hte(1,1),new ote(0,1),!0],[new hte(2,1),new ote(0,1),!0],[new hte(3,1),new ote(0,1),!0],[new hte(4,1),new ote(0,1),!0],[new hte(5,1),new ote(0,1),!0],[new hte(1,0),new ote(1,0),!0],[new hte(1,1),new ote(1,0),!0],[new hte(1,2),new ote(1,0),!0],[new hte(1,3),new ote(1,0),!0],[new hte(1,4),new ote(1,0),!0],[new hte(1,5),new ote(1,0),!0]];var Jce=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=cy(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=Yce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=cy(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(Yce.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new hte(r,n);e.getPieceAt(i)===Q7.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new Ete(Xce.get().getGameStatus(e).toBoardValue())}}]),n}(_te);Jce.FIRST_TURN_MOVES=[Yce.rotationless(0,0),Yce.rotationless(1,0),Yce.rotationless(2,0),Yce.rotationless(0,1),Yce.rotationless(1,1),Yce.rotationless(0,2)];var ele=Q7.NONE,tle=Q7.ZERO,nle=Q7.ONE,rle=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(yu||(yu=Gg(["Initial board"]))),$localize(mu||(mu=Gg(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),Qce.getInitialState()),Hte.informational($localize(ku||(ku=Gg(["Goal of the game"]))),$localize(Cu||(Cu=Gg(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new Qce([[tle,ele,ele,tle,nle,ele],[tle,nle,ele,ele,ele,ele],[tle,ele,nle,ele,ele,ele],[tle,ele,ele,ele,ele,nle],[tle,ele,ele,ele,nle,ele],[ele,ele,ele,ele,ele,ele]],10)).withPreviousMove(Yce.withRotation(0,0,0,!1)),Hte.fromPredicate($localize(wu||(wu=Gg(["Simple move"]))),$localize(_u||(_u=Gg(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new Qce([[ele,ele,ele,ele,ele,ele],[ele,tle,ele,ele,nle,ele],[ele,ele,ele,ele,ele,ele],[ele,ele,ele,ele,ele,ele],[ele,nle,ele,ele,tle,ele],[ele,ele,ele,ele,ele,ele]],10),Yce.rotationless(2,2),function(e,t,n){return e.blockTurned.isPresent()?LB.failure($localize(Eu||(Eu=Gg(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):LB.SUCCESS},$localize(bu||(bu=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Su||(Su=Gg(["Move with rotation"]))),$localize(Pu||(Pu=Gg(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new Qce([[ele,ele,ele,ele,ele,ele],[ele,tle,ele,ele,nle,ele],[ele,ele,ele,ele,ele,ele],[ele,ele,ele,ele,ele,ele],[ele,nle,ele,ele,tle,ele],[ele,ele,ele,ele,ele,ele]],10),Yce.withRotation(0,0,0,!0),function(e,t,n){return e.blockTurned.isPresent()?LB.SUCCESS:LB.failure($localize(Ou||(Ou=Gg(["You made a move without rotation, try again!"]))))},$localize(Tu||(Tu=Gg(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function ile(e,t){if(1&e){var n=PS();AC(),bS(0),wS(1,"circle",9),IS("click",function(){var e=tC(n).$implicit,t=MS().$implicit,r=MS().index,i=MS().index;return MS().onClick(3*r+e,3*i+t)}),_S(),SS()}if(2&e){var r=t.$implicit,i=MS().$implicit,a=MS(),o=a.index,s=a.$implicit,u=MS(),c=u.index,l=u.$implicit,f=MS();LE(1),DS("id","click_",3*o+r,"_",3*c+i,""),kS("ngClass",f.getSquareClasses(3*o+r,3*c+i)),fS("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var ale=function(){return[0,1,2]};function ole(e,t){1&e&&(AC(),bS(0),gS(1,ile,2,6,"ng-container",3),SS()),2&e&&(LE(1),kS("ngForOf",PT(1,ale)))}function sle(e,t){if(1&e&&(AC(),bS(0),ES(1,"rect",8),gS(2,ole,2,2,"ng-container",3),SS()),2&e){var n=t.$implicit,r=t.index,i=MS(),a=i.index,o=i.$implicit,s=MS();LE(1),kS("ngClass",s.getBlockClasses(r,a)),fS("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),LE(1),kS("ngForOf",PT(8,ale))}}var ule=function(e){return[0,e]};function cle(e,t){if(1&e&&(AC(),bS(0),gS(1,sle,3,9,"ng-container",3),SS()),2&e){var n=MS();LE(1),kS("ngForOf",OT(1,ule,n.BLOCK_SEPARATION))}}function lle(e,t){if(1&e&&(AC(),ES(0,"circle",10)),2&e){var n=MS();DS("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),kS("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),fS("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function fle(e,t){if(1&e){var n=PS();AC(),wS(0,"path",11),IS("click",function(){var e=tC(n).$implicit;return MS().rotate(e)}),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),fS("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function hle(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=t.$implicit,r=MS();DS("id","victoryCoord_",n.x,"_",n.y,""),kS("ngClass",r.getSquareClasses(n.x,n.y)),fS("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function dle(e,t){if(1&e){var n=PS();AC(),wS(0,"g",13),IS("click",function(){return tC(n),MS().skipRotation()}),ES(1,"circle",14),ES(2,"line",15),_S()}if(2&e){var r=MS();LE(1),fS("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),LE(1),fS("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var vle=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new Xce(Qce),r.availableMinimaxes=[new Jce(r.rules,"PentagoMinimax")],r.encoder=Yce.encoder,r.tutorial=(new rle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new hte(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new hte(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?OB.getNonNullable(Qce.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:OB.getNonNullable(Qce.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new ote(i%2==0?1:4,i<2?1:4),1),this.lastDrop=MB.of(r)}else this.lastDrop=MB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=MB.empty(),this.movedBlock=MB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=MB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(wte.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=Yce.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=MB.of(new hte(e,t)),n.displayArrows(s.neutralBlocks),LB.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new hte(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=Yce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=Yce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-pentago"]],features:[Xb],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"defs"),wS(2,"marker",1),ES(3,"polygon",2),_S(),_S(),gS(4,cle,2,3,"ng-container",3),gS(5,lle,1,6,"circle",4),gS(6,fle,1,4,"path",5),gS(7,hle,1,7,"circle",6),gS(8,dle,3,9,"g",7),_S()),2&e&&(LE(4),kS("ngForOf",OT(5,ule,t.BLOCK_SEPARATION)),LE(1),kS("ngIf",t.currentDrop.isPresent()),LE(1),kS("ngForOf",t.arrows),LE(1),kS("ngForOf",t.victoryCoords),LE(1),kS("ngIf",t.canSkipRotation))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ple=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;if(hy(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return ry(a)}return vy(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new hte(this.x-1,this.y-1),r=new hte(this.x,this.y-1),i=new hte(this.x-1,this.y),a=new hte(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new hte(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?MB.empty():MB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?MB.empty():MB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(hte),gle=function(){var e=vy(function e(){hy(this,e)});return e.MUST_CAPTURE_MAXIMUM_TWO_PIECES=function(){return $localize(Iu||(Iu=Gg(["You must capture one or two pieces, not more."])))},e}(),yle=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return vy(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=MB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=MB.empty(),n=MB.empty();if(e.length>0&&(t=MB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=MB.of(e[1]),e[1].isUpperThan(e[0])&&(t=MB.of(e[1]),n=MB.of(e[0])),e.length>2)throw new Error(gle.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=MB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(Ite);yle.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=ple.encode(e.landingCoord),n=ple.encodeOptional(e.startingCoord),r=ple.encodeOptional(e.firstCapture);return 270400*ple.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=ple.decode(e%64);e-=e%64;var n=ple.decodeToOptional((e/=64)%65);e-=e%65;var r=ple.decodeToOptional((e/=65)%65);e-=e%65;var i=ple.decodeToOptional(e/=65);return new yle(n,t,r,i)}}]),n}(Y7));var mle=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,r)).boards=e,i}return vy(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:Q7.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:Q7.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:Q7.NONE}),t=n?this.turn+1:this.turn,this.setBoardAtCoords(r,t)}},{key:"setBoardAtCoords",value:function(e,t){var r,i=[n9.copyBiArray(this.boards[0]),n9.copyBiArray(this.boards[1]),n9.copyBiArray(this.boards[2]),n9.copyBiArray(this.boards[3])],a=cy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=cy(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===Q7.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=cy(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[Q7.NONE.value]=0,e[X7.ZERO.value]=0,e[X7.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new ple(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removePieceAt",value:function(e){return this.setBoardAtCoords([{coord:e,value:Q7.NONE}],this.turn)}},{key:"dropCurrentPlayersPieceAt",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=cy(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=cy(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new ple(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([n9.createTable(4,4,Q7.NONE),n9.createTable(3,3,Q7.NONE),n9.createTable(2,2,Q7.NONE),[[Q7.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return OB.expectToBe(e,2),[0,1]}}}]),n}(Pte),kle=function(){var e=vy(function e(){hy(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Au||(Au=Gg(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Ru||(Ru=Gg(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(Mu||(Mu=Gg(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(xu||(xu=Gg(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Nu||(Nu=Gg(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Du||(Du=Gg(["Your second capture is invalid."])))},e}(),Cle=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return xB.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return xB.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:xB.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return xB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===Q7.NONE)return xB.failure(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removePieceAt(e.startingCoord.get());return xB.success(a)}return xB.failure(kle.CANNOT_MOVE_SUPPORTING_PIECE())}return xB.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?xB.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):xB.failure(kle.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return xB.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return xB.failure(kle.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?xB.success(void 0):xB.failure(kle.INVALID_SECOND_CAPTURE())}return xB.failure(kle.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new ple(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=cy(e.freeToMove);try{var i=function(){var r,i=t.value,a=cy(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=yle.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=cy(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=yle.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[lte.UP,lte.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[lte.LEFT,lte.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new Ste,r=cy(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new Ste([i]));var a,o=cy(e.removePieceAt(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new Ste([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[X7.ZERO.value]?Fte.ONE_WON:15===t[X7.ONE.value]?Fte.ZERO_WON:Fte.ONGOING}}]),n}(Ute),wle=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Cle.getGameStatus(e);if(t.isEndGame)return new Ete(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new Ete(n[X7.ZERO.value]-n[X7.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Cle.getStateInfo(n),a=Cle.getClimbingMoves(i),o=Cle.getDropMoves(i),s=cy(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new Ste;Cle.canCapture(c,u.landingCoord)?l=Cle.getPossibleCaptures(c):r.push(u);var f,h=cy(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=yle.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(_te),_le=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t=wle.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(wle),Ele=Q7.NONE,ble=Q7.ZERO,Sle=Q7.ONE,Ple=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Lu||(Lu=Gg(["Goal of the game"]))),$localize(Fu||(Fu=Gg(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),mle.getInitialState()),Hte.anyMove($localize(Uu||(Uu=Gg(["Dropping a piece"]))),$localize(Vu||(Vu=Gg(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),mle.getInitialState(),yle.fromDrop(new ple(1,1,0),[]),$localize(Bu||(Bu=Gg(["There you go, as simple as that."])))),Hte.fromMove($localize(zu||(zu=Gg(["Climbing"]))),$localize(Hu||(Hu=Gg(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new mle([[[ble,Sle,Ele,Ele],[Sle,ble,Ele,Ele],[Ele,Ele,Ele,Ele],[Ele,Ele,Ele,ble]],[[Ele,Ele,Ele],[Ele,Ele,Ele],[Ele,Ele,Ele]],[[Ele,Ele],[Ele,Ele]],[[Ele]]],0),[yle.fromClimb(new ple(3,3,0),new ple(0,0,1),[])],$localize(Gu||(Gu=Gg(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize($u||($u=Gg(["Failed!"])))),Hte.fromMove($localize(Zu||(Zu=Gg(["Square (1/2)"]))),$localize(qu||(qu=Gg(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move."]))),new mle([[[ble,ble,Ele,Ele],[Ele,ble,Ele,Ele],[Ele,Ele,Ele,Ele],[Ele,Ele,Ele,Ele]],[[Ele,Ele,Ele],[Ele,Ele,Ele],[Ele,Ele,Ele]],[[Ele,Ele],[Ele,Ele]],[[Ele]]],0),[yle.fromDrop(new ple(0,1,0),[new ple(0,0,0)]),yle.fromDrop(new ple(0,1,0),[new ple(0,1,0)]),yle.fromDrop(new ple(0,1,0),[new ple(1,0,0)]),yle.fromDrop(new ple(0,1,0),[new ple(1,1,0)])],$localize(Wu||(Wu=Gg(["Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece."]))),$localize(ju||(ju=Gg(["Failed!"])))),Hte.fromPredicate($localize(Yu||(Yu=Gg(["Square (2/2)"]))),$localize(Ku||(Ku=Gg(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces before validating."]))),new mle([[[ble,ble,Ele,Ele],[Ele,ble,Ele,Ele],[Ele,Ele,Ele,Ele],[Ele,Ele,Ele,Ele]],[[Ele,Ele,Ele],[Ele,Ele,Ele],[Ele,Ele,Ele]],[[Ele,Ele],[Ele,Ele]],[[Ele]]],0),yle.fromDrop(new ple(0,1,0),[new ple(0,0,0),new ple(1,0,0)]),function(e,t,n){return e.secondCapture.isPresent()?LB.SUCCESS:e.firstCapture.isPresent()?LB.failure($localize(Qu||(Qu=Gg(["Failed, you only captured one piece."])))):LB.failure(Yue.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(Xu||(Xu=Gg(["Congratulations, you have saved up two pieces."]))))]});function Ole(e,t){if(1&e&&(AC(),ES(0,"circle",8)),2&e){var n=t.$implicit,r=MS().$implicit,i=MS();DS("id","piece_",r.value,"_",n,""),kS("ngClass",i.getPlayerClass(r)),fS("cx",i.SPACE_SIZE/4+n/15*(i.BOARD_WIDTH-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(r))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function Tle(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Ole,1,6,"circle",7),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",r.getPlayerSidePieces(n))}}function Ile(e,t){if(1&e){var n=PS();AC(),wS(0,"circle",12),IS("click",function(){tC(n);var e=MS(2).$implicit,t=MS().$implicit,r=MS().$implicit;return MS().onPieceClick(e,t,r)}),_S()}if(2&e){var r=MS(2).$implicit,i=MS().$implicit,a=MS().$implicit,o=MS();LS("id","piece_",r,"_",i,"_",a,""),kS("ngClass",o.getPieceClasses(r,i,a)),fS("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Ale(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",12),IS("click",function(){tC(n);var e=MS(2).$implicit,t=MS().$implicit,r=MS().$implicit;return MS().onDrop(e,t,r)}),_S()}if(2&e){var r=MS(2).$implicit,i=MS().$implicit,a=MS().$implicit,o=MS();LS("id","drop_",r,"_",i,"_",a,""),kS("ngClass",o.getSquareClasses(r,i,a)),fS("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Rle(e,t){if(1&e&&(AC(),bS(0),gS(1,Ile,1,7,"circle",10),gS(2,Ale,1,8,"ng-template",null,11,JT),SS()),2&e){var n=yS(3),r=MS().$implicit,i=MS().$implicit,a=MS().$implicit,o=MS();LE(1),kS("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Mle(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Rle,4,2,"ng-container",9),_S()),2&e){var n=t.$implicit,r=MS().$implicit,i=MS().$implicit,a=MS();LE(1),kS("ngIf",a.mustDraw(n,r,i))}}function xle(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Mle,2,1,"g",1),_S()),2&e){var n=MS().$implicit,r=MS();LE(1),kS("ngForOf",r.getLevelRange(n))}}function Nle(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,xle,2,1,"g",1),_S()),2&e){var n=t.$implicit,r=MS();LE(1),kS("ngForOf",r.getLevelRange(n))}}function Dle(e,t){if(1&e&&(AC(),ES(0,"rect",13)),2&e){var n=MS();LS("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),fS("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCxByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCyByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))}}function Lle(e,t){if(1&e){var n=PS();AC(),wS(0,"g",14),IS("click",function(){return tC(n),MS().validateCapture()}),ES(1,"circle",15),ES(2,"polygon",16),_S()}if(2&e){var r=MS();fS("transform","translate("+4*r.SPACE_SIZE+" "+4*r.SPACE_SIZE+")"),LE(1),kS("ngClass",r.getCaptureValidationButtonClasses()),fS("cx",r.STROKE_WIDTH/2)("cy",r.STROKE_WIDTH/2)("r",r.SPACE_SIZE/2)}}function Fle(e,t){if(1&e&&(AC(),wS(0,"g",17),ES(1,"line",18),ES(2,"line",18),_S()),2&e){var n=t.$implicit,r=MS();LS("id","capturable_",n.x,"_",n.y,"_",n.z,""),fS("transform","translate("+r.getPieceCxByCoord(n)+" "+r.getPieceCyByCoord(n)+")"),LE(1),fS("x1",-.25*r.getPieceRadius(n.z))("y1",-.25*r.getPieceRadius(n.z))("x2",.25*r.getPieceRadius(n.z))("y2",.25*r.getPieceRadius(n.z)),LE(1),fS("x1",.25*r.getPieceRadius(n.z))("y1",-.25*r.getPieceRadius(n.z))("x2",-.25*r.getPieceRadius(n.z))("y2",.25*r.getPieceRadius(n.z))}}var Ule=function(){return[0,1,2]},Vle=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).BOARD_WIDTH=4*r.SPACE_SIZE+r.STROKE_WIDTH,r.PIECE_ROW_HEIGHT=r.SPACE_SIZE/2,r.BOARD_HEIGHT=r.BOARD_WIDTH+2*r.PIECE_ROW_HEIGHT,r.lastLandingCoord=MB.empty(),r.lastStartingCoord=MB.empty(),r.lastFirstCapture=MB.empty(),r.lastSecondCapture=MB.empty(),r.highCapture=MB.empty(),r.capturables=[],r.chosenStartingCoord=MB.empty(),r.chosenLandingCoord=MB.empty(),r.chosenFirstCapture=MB.empty(),r.chosenSecondCapture=MB.empty(),r.lastMove=MB.empty(),r.remainingPieces={0:15,1:15},r.hasAsymetricBoard=!0,r.rules=new Cle(mle),r.availableMinimaxes=[new wle(r.rules,"PylosMinimax"),new _le(r.rules,"PylosOrderedMinimax")],r.encoder=yle.encoder,r.tutorial=(new Ple).tutorial,r.updateBoard(),r}return vy(n,[{key:"getPiecesCyForPlayer",value:function(e){return e===X7.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}},{key:"getLevelRange",value:function(e){return mle.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new ple(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new ple(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(kle.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenStartingCoord.equalsValue(o)?(r.cancelMoveAttempt(),LB.SUCCESS):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=MB.of(e),t.constructedState=t.constructedState.removePieceAt(e),LB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.equalsValue(e)?(t.chosenFirstCapture=MB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),LB.SUCCESS):t.chosenSecondCapture.equalsValue(e)?(t.chosenSecondCapture=MB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),LB.SUCCESS):t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=MB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),LB.SUCCESS):t.chosenSecondCapture.isAbsent()?(t.chosenSecondCapture=MB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),LB.SUCCESS):t.cancelMove(gle.MUST_CAPTURE_MAXIMUM_TWO_PIECES()));case 1:case"end":return n.stop()}},n)}))()}},{key:"updateCapturableList",value:function(){this.capturables=this.constructedState.getFreeToMoves()}},{key:"getCaptureValidationButtonClasses",value:function(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}},{key:"validateCapture",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#capture_validation"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?LB.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()]));case 2:case"end":return t.stop()}},t)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?yle.fromDrop(t.chosenLandingCoord.get(),e):yle.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=MB.empty(),this.chosenLandingCoord=MB.empty(),this.chosenFirstCapture=MB.empty(),this.chosenSecondCapture=MB.empty(),this.capturables=[]}},{key:"onDrop",value:function(e,t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new ple(e,t,n),i.abrupt("return",Cle.canCapture(r.constructedState,o)?(r.chosenLandingCoord=MB.of(o),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(o),r.updateCapturableList(),LB.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=MB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(kle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new ple(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return this.SPACE_SIZE*(.45+.025*e)}},{key:"getPieceCx",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+e*this.SPACE_SIZE}},{key:"getPieceCy",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+t*this.SPACE_SIZE}},{key:"getPieceCxByCoord",value:function(e){return this.getPieceCx(e.x,e.y,e.z)}},{key:"getPieceCyByCoord",value:function(e){return this.getPieceCy(e.x,e.y,e.z)}},{key:"isOccupied",value:function(e,t,n){var r=new ple(e,t,n);if(this.justClimbed(r))return!1;var i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new ple(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.isCaptured(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e.value],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=MB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=MB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=MB.empty(),this.lastLandingCoord=MB.empty(),this.lastFirstCapture=MB.empty(),this.lastSecondCapture=MB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(dte);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-pylos"]],features:[Xb],decls:9,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],[1,"base","captured","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id"],["stroke-width","8","stroke","red"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Tle,2,1,"g",1),wS(2,"g",null,2),ES(4,"rect",3),gS(5,Nle,2,1,"g",1),gS(6,Dle,1,7,"rect",4),gS(7,Lle,3,5,"g",5),gS(8,Fle,3,12,"g",6),_S(),_S()),2&e&&(fS("viewBox","0 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),LE(1),kS("ngForOf",t.Player.PLAYERS),LE(1),fS("transform","translate("+t.STROKE_WIDTH/2+" "+(t.STROKE_WIDTH/2+t.PIECE_ROW_HEIGHT)+")"),LE(2),fS("width",4*t.SPACE_SIZE)("height",4*t.SPACE_SIZE),LE(1),kS("ngForOf",PT(10,Ule)),LE(1),kS("ngIf",t.highCapture.isPresent()),LE(1),kS("ngIf",t.chosenLandingCoord.isPresent()),LE(1),kS("ngForOf",t.capturables))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ble=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();Ble.AAAA=new Ble(0),Ble.AAAB=new Ble(1),Ble.AABA=new Ble(2),Ble.AABB=new Ble(3),Ble.ABAA=new Ble(4),Ble.ABAB=new Ble(5),Ble.ABBA=new Ble(6),Ble.ABBB=new Ble(7),Ble.BAAA=new Ble(8),Ble.BAAB=new Ble(9),Ble.BABA=new Ble(10),Ble.BABB=new Ble(11),Ble.BBAA=new Ble(12),Ble.BBAB=new Ble(13),Ble.BBBA=new Ble(14),Ble.BBBB=new Ble(15),Ble.EMPTY=new Ble(16),Ble.pieces=[Ble.AAAA,Ble.AAAB,Ble.AABA,Ble.AABB,Ble.ABAA,Ble.ABAB,Ble.ABBA,Ble.ABBB,Ble.BAAA,Ble.BAAB,Ble.BABA,Ble.BABB,Ble.BBAA,Ble.BBAB,Ble.BBBA,Ble.BBBB];var zle=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).piece=i,a}return vy(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Ate);zle.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new zle(e/=4,n,Ble.fromInt(t))}}]),n}(Y7));var Hle=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return vy(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=cy(Ble.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(n9.createTable(4,4,Ble.EMPTY),0,Ble.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(Ote),Gle=function(){var e=vy(function e(){hy(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Ju||(Ju=Gg(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(ec||(ec=Gg(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(tc||(tc=Gg(["You cannot give the piece that was in your hands."])))},e}(),$le=function(){function e(t){hy(this,e),this.subCriterion=[MB.empty(),MB.empty(),MB.empty(),MB.empty()],this.subCriterion[0]=MB.of(8==(8&t.value)),this.subCriterion[1]=MB.of(4==(4&t.value)),this.subCriterion[2]=MB.of(2==(2&t.value)),this.subCriterion[3]=MB.of(1==(1&t.value))}return vy(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=MB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),Zle=function(){function e(t,n){hy(this,e),this.initialCoord=t,this.direction=n}return vy(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),qle=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Hle(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:Mte.DEFAULT,sensitiveSquares:new jne},a=cy(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===Mte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=cy(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Ble.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?LB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):a===Ble.EMPTY?15===t.turn?LB.SUCCESS:LB.failure(Gle.MUST_GIVE_A_PIECE()):Hle.isAlreadyOnBoard(a,o)?LB.failure(Gle.PIECE_ALREADY_ON_BOARD()):s===a?LB.failure(Gle.CANNOT_GIVE_PIECE_IN_HAND()):LB.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===Mte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Mte.VICTORY,sensitiveSquares:new jne}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new $le(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:Mte.VICTORY,sensitiveSquares:new jne};a.get().matchPiece(t.pieceInHand)&&(r.score=Mte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=MB.empty(),a=MB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Ble.EMPTY){if(!i.isAbsent())return{sensitiveCoord:MB.of(o),commonCriterion:a,boardStatus:MB.of(r)};i=MB.of(o)}else a.isAbsent()?(a=MB.of(new $le(u)),TB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),TB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:MB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=X7.of(t%2);return e===Mte.VICTORY?Fte.getDefeat(n):16===t?Fte.DRAW:Fte.ONGOING}}]),n}(Ute);qle.VERBOSE=!1,qle.lines=[new Zle(new hte(0,0),cte.DOWN),new Zle(new hte(1,0),cte.DOWN),new Zle(new hte(2,0),cte.DOWN),new Zle(new hte(3,0),cte.DOWN),new Zle(new hte(0,0),cte.RIGHT),new Zle(new hte(0,1),cte.RIGHT),new Zle(new hte(0,2),cte.RIGHT),new Zle(new hte(0,3),cte.RIGHT),new Zle(new hte(0,0),cte.DOWN_RIGHT),new Zle(new hte(0,3),cte.UP_RIGHT)];var Wle=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Ble.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new zle(s,o,Ble.EMPTY);return t.push(u),t}var c,l=cy(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new zle(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:Mte.DEFAULT,sensitiveSquares:new jne},a=cy(qle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=qle.updateBoardStatus(o,r,i)).score===Mte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===Mte.DEFAULT)return new Ete(0);var n=X7.of(t%2);return new Ete(e===Mte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(_te),jle=Ble.AABA,Yle=Ble.AABB,Kle=Ble.ABAA,Qle=Ble.ABAB,Xle=Ble.ABBA,Jle=Ble.BAAA,efe=Ble.BAAB,tfe=Ble.BABB,nfe=Ble.BBAA,rfe=Ble.BBAB,ife=Ble.BBBA,afe=Ble.BBBB,ofe=Ble.EMPTY,sfe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(nc||(nc=Gg(["Goal of the game"]))),$localize(rc||(rc=Gg(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Hle([[ife,nfe,Kle,jle],[ofe,ofe,ofe,ofe],[ofe,ofe,ofe,ofe],[ofe,ofe,ofe,ofe]],7,Ble.ABAB)),Hte.anyMove($localize(ic||(ic=Gg(["Placement"]))),$localize(ac||(ac=Gg(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Hle([[ife,Yle,Xle,ofe],[ofe,ofe,ofe,ofe],[ofe,Jle,ofe,ofe],[ofe,ofe,ofe,ofe]],7,Ble.ABAA),new zle(2,2,Ble.BAAB),$localize(oc||(oc=Gg(["Perfect!"])))),Hte.fromMove($localize(sc||(sc=Gg(["Situation"]))),$localize(uc||(uc=Gg(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Hle([[afe,ife,rfe,ofe],[Kle,tfe,nfe,ofe],[Qle,Jle,efe,ofe],[ofe,ofe,ofe,ofe]],7,Ble.AABA),[new zle(3,3,Ble.AABB)],$localize(cc||(cc=Gg(["Well done!"]))),$localize(lc||(lc=Gg(["Failed!"]))))]});function ufe(e,t){if(1&e&&(AC(),ES(0,"rect",12)),2&e){var n=MS(2),r=n.$implicit,i=n.index,a=MS().index,o=MS();kS("ngClass",o.getPieceClasses(r.value)),fS("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function cfe(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=MS(2),r=n.$implicit,i=n.index,a=MS().index,o=MS();kS("ngClass",o.getPieceClasses(r.value)),fS("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function lfe(e,t){if(1&e&&(AC(),ES(0,"circle")),2&e){var n=MS(2).index,r=MS().index,i=MS();fS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function ffe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,ufe,1,5,"rect",10),gS(2,cfe,1,4,"ng-template",null,11,JT),gS(4,lfe,1,3,"circle",7),_S()),2&e){var n=yS(3),r=MS().$implicit,i=MS(2);LE(1),kS("ngIf",r.isRectangle())("ngIfElse",n),LE(3),kS("ngIf",i.pieceHasDot(r.value))}}function hfe(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",9),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().chooseCoord(e,t)}),_S(),gS(2,ffe,5,3,"g",7),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","chooseCoord_",i,"_",a,""),kS("ngClass",o.getSquareClasses(i,a)),fS("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r!==o.EMPTY)}}function dfe(e,t){if(1&e&&(AC(),wS(0,"g",null,8),gS(2,hfe,3,8,"g",2),_S()),2&e){var n=t.$implicit;LE(2),kS("ngForOf",n)}}function vfe(e,t){if(1&e&&(AC(),ES(0,"rect",17)),2&e){var n=MS(2);kS("ngClass",n.getPieceClasses(n.pieceInHand.value)),fS("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function pfe(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=MS(2);kS("ngClass",n.getPieceClasses(n.pieceInHand.value)),fS("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function gfe(e,t){if(1&e&&(AC(),ES(0,"circle")),2&e){var n=MS(2);fS("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function yfe(e,t){if(1&e){var n=PS();AC(),wS(0,"g",13,14),IS("click",function(){return tC(n),MS().deselectDroppedPiece()}),ES(2,"rect",15),gS(3,vfe,1,5,"rect",16),gS(4,pfe,1,4,"ng-template",null,11,JT),gS(6,gfe,1,3,"circle",7),_S()}if(2&e){var r=yS(5),i=MS();DS("id","droppedPiece_",i.chosen.get().x,"_",i.chosen.get().y,""),fS("transform","translate("+i.chosen.get().x*i.SPACE_SIZE+" "+i.chosen.get().y*i.SPACE_SIZE+")"),LE(2),fS("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),LE(1),kS("ngIf",i.pieceInHand.isRectangle())("ngIfElse",r),LE(3),kS("ngIf",i.pieceHasDot(i.pieceInHand.value))}}function mfe(e,t){if(1&e&&(AC(),wS(0,"g",null,18),ES(2,"rect",19),_S()),2&e){var n=t.$implicit,r=MS();LE(2),fS("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function kfe(e,t){if(1&e&&(AC(),ES(0,"rect",12)),2&e){var n=MS(2);kS("ngClass",n.getPieceClasses(n.pieceInHand.value)),fS("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Cfe(e,t){if(1&e&&(AC(),ES(0,"circle",21)),2&e){var n=MS(2);kS("ngClass",n.getPieceClasses(n.pieceInHand.value)),fS("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function wfe(e,t){1&e&&(AC(),ES(0,"circle",22)),2&e&&fS("cy",.75*MS(2).SPACE_SIZE)("r",10)}function _fe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,kfe,1,6,"rect",10),gS(2,Cfe,1,3,"ng-template",null,11,JT),gS(4,wfe,1,2,"circle",20),_S()),2&e){var n=yS(3),r=MS();LE(1),kS("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),LE(3),kS("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Efe(e,t){if(1&e&&(AC(),ES(0,"rect",27)),2&e){var n=MS(2).index,r=MS().index,i=MS();NS("id","chosenPiece_",4*r+n,""),fS("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function bfe(e,t){if(1&e&&(AC(),ES(0,"rect",12)),2&e){var n=MS(2).index,r=MS().index,i=MS();kS("ngClass",i.getPieceClasses(4*r+n)),fS("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Sfe(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=MS(2).index,r=MS().index,i=MS();kS("ngClass",i.getPieceClasses(4*r+n)),fS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Pfe(e,t){if(1&e&&(AC(),ES(0,"circle")),2&e){var n=MS(2).index,r=MS().index,i=MS();fS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Ofe(e,t){if(1&e){var n=PS();AC(),wS(0,"g",13),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().choosePiece(4*t+e)}),gS(1,Efe,1,5,"rect",26),gS(2,bfe,1,5,"rect",10),gS(3,Sfe,1,4,"ng-template",null,11,JT),gS(5,Pfe,1,3,"circle",7),_S()}if(2&e){var r=yS(4),i=MS().index,a=MS().index,o=MS();NS("id","choosePiece_",4*a+i,""),LE(1),kS("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.fromInt(4*a+i))),LE(1),kS("ngIf",(4*a+i)%4<2)("ngIfElse",r),LE(3),kS("ngIf",o.pieceHasDot(4*a+i))}}function Tfe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Ofe,6,5,"g",3),_S()),2&e){var n=t.index,r=MS().index,i=MS();LE(1),kS("ngIf",i.isRemaining(4*r+n))}}function Ife(e,t){if(1&e&&(AC(),wS(0,"g",null,23),ES(2,"rect",24,25),gS(4,Tfe,2,1,"g",2),_S()),2&e){var n=t.$implicit,r=MS();fS("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),LE(2),fS("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),LE(2),kS("ngForOf",n)}}var Afe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).EMPTY=Ble.EMPTY,r.QuartoPiece=Ble,r.chosen=MB.empty(),r.lastMove=MB.empty(),r.pieceInHand=Ble.EMPTY,r.pieceToGive=MB.empty(),r.victoriousCoords=[],r.rules=new qle(Hle),r.availableMinimaxes=[new Wle(r.rules,"QuartoMinimax")],r.encoder=zle.encoder,r.tutorial=(new sfe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=MB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Ble.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new zle(e,t,Ble.EMPTY),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(!n.pieceToGive.isAbsent()){r.next=9;break}return r.abrupt("return",LB.SUCCESS);case 9:return o=new zle(e,t,n.pieceToGive.get()),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(wte.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),!t.pieceToGive.equalsValue(Ble.fromInt(e))){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),LB.SUCCESS));case 5:if(t.pieceToGive=MB.of(Ble.fromInt(e)),!t.chosen.isAbsent()){n.next=7;break}return n.abrupt("return",LB.SUCCESS);case 7:return i=t.chosen.get(),a=new zle(i.x,i.y,t.pieceToGive.get()),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 9:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=MB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=MB.empty(),this.chosen=MB.empty()}},{key:"deselectDroppedPiece",value:function(){var e=this.chosen.getOrElse(new hte(404,404)),t=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return t.isFailure()?this.cancelMove(t.getReason()):(this.cancelMoveAttempt(),LB.SUCCESS)}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=MB.of(new hte(e,t))}},{key:"isRemaining",value:function(e){return Hle.isGivable(Ble.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Ble.EMPTY.value&&e%8<4}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-quarto"]],features:[Xb],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected",3,"id",4,"ngIf"],[1,"base","selected",3,"id"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"g",1),gS(2,dfe,3,1,"g",2),gS(3,yfe,7,8,"g",3),gS(4,mfe,3,3,"g",2),wS(5,"g",null,4),ES(7,"rect",5,6),gS(9,_fe,5,3,"g",7),_S(),gS(10,Ife,5,6,"g",2),_S(),_S()),2&e&&(fS("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),LE(2),kS("ngForOf",t.board),LE(1),kS("ngIf",t.chosen.isPresent()),LE(1),kS("ngForOf",t.victoriousCoords),LE(1),fS("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),LE(2),fS("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),LE(2),kS("ngIf",t.chosen.isAbsent()),LE(1),kS("ngForOf",t.board))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Rfe=function(){var e=vy(function e(){hy(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(fc||(fc=Gg(["You must pick a space from the edge of the board."])))},e}(),Mfe=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;hy(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===lte.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===lte.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===lte.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===lte.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return vy(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?LB.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?LB.failure(Rfe.NO_INSIDE_CLICK()):LB.SUCCESS}}]),n}(Ate);Mfe.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=lte.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Mfe(e/=5,n,t)}}]),n}(Y7));var xfe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(n9.createTable(5,5,Q7.NONE),0)}}]),n}(Ote),Nfe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?xB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[X7.ZERO.value]),a=n.getFullestLine(r[X7.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===X7.ZERO||a<5)?Fte.ZERO_WON:5===a?Fte.ONE_WON:Fte.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new hte(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new hte(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new hte(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new hte(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(lte.LEFT),0!==e.y&&t.push(lte.UP),4!==e.x&&t.push(lte.RIGHT),4!==e.y&&t.push(lte.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[X7.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[X7.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new hte(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new hte(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new hte(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new hte(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,sy(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Ute),Dfe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Nfe.getVerticalCoords(e),i=cy(Nfe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=cy(Nfe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Mfe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Nfe.getLinesSums(t),r=Nfe.getFullestLine(n[X7.ZERO.value]),i=Nfe.getFullestLine(n[X7.ONE.value]),a=t.getCurrentPlayer();return new Ete(5===r&&(a===X7.ZERO||i<5)?X7.ZERO.getVictoryValue():5===i?X7.ONE.getVictoryValue():i-r)}}]),n}(_te),Lfe=function(){function e(){hy(this,e)}return vy(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case lte.UP:r=1,i=0,a=-90;break;case lte.DOWN:r=1,i=2,a=90;break;case lte.LEFT:r=0,i=1,a=180;break;default:OB.expectToBe(n,lte.RIGHT),r=2,i=1,a=0}return["scale("+e/300+")","translate(".concat(100*r," ").concat(100*i,")"),"rotate("+a+" 50 50)"].join(" ")}}]),e}(),Ffe=Q7.NONE,Ufe=Q7.ZERO,Vfe=Q7.ONE,Bfe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(hc||(hc=Gg(["Goal of the game."]))),$localize(dc||(dc=Gg(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),xfe.getInitialState()),Hte.fromMove($localize(vc||(vc=Gg(["What a move looks like (without animation)"]))),$localize(pc||(pc=Gg(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new xfe([[Ffe,Ffe,Ffe,Ffe,Ffe],[Ffe,Ffe,Ffe,Ffe,Ffe],[Ffe,Ffe,Ffe,Ffe,Ffe],[Ffe,Ffe,Ffe,Ffe,Ffe],[Ufe,Ufe,Ufe,Ufe,Ffe]],1),[new Mfe(4,4,lte.LEFT)],$localize(gc||(gc=Gg(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(yc||(yc=Gg(["Failed!"])))),Hte.fromMove($localize(mc||(mc=Gg(["Victory"]))),$localize(kc||(kc=Gg(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new xfe([[Ffe,Vfe,Ffe,Vfe,Vfe],[Ffe,Ufe,Ufe,Ffe,Ufe],[Vfe,Vfe,Vfe,Ufe,Vfe],[Ufe,Ffe,Ufe,Vfe,Vfe],[Vfe,Ufe,Ffe,Vfe,Ufe]],31),[new Mfe(3,0,lte.DOWN)],$localize(Cc||(Cc=Gg(["Congratulations, you won!"]))),$localize(wc||(wc=Gg(["Failed!"]))))]});function zfe(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",4),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onBoardClick(e,t)}),_S(),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();LE(1),DS("id","click_",r,"_",i,""),kS("ngClass",a.getPieceClasses(r,i)),fS("r",.45*a.SPACE_SIZE)("cx",(r+.5)*a.SPACE_SIZE)("cy",(i+.5)*a.SPACE_SIZE)}}function Hfe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,zfe,2,6,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Gfe(e,t){if(1&e){var n=PS();AC(),wS(0,"use",6),IS("click",function(){var e=tC(n).$implicit;return MS(2).chooseDirection(e)}),_S()}if(2&e){var r=t.$implicit,i=MS(2);NS("id","chooseDirection_",r,""),fS("transform",i.getArrowTransform(r))}}function $fe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Gfe,1,2,"use",5),_S()),2&e){var n=MS();LE(1),kS("ngForOf",n.getPossiblesDirections())}}var Zfe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).lastMoveCoord=MB.empty(),r.chosenCoord=MB.empty(),r.victoriousCoords=[],r.rules=new Nfe(xfe),r.availableMinimaxes=[new Dfe(r.rules,"QuixoMinimax")],r.encoder=Mfe.encoder,r.tutorial=(new Bfe).tutorial,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Nfe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=MB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new hte(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new hte(e,t),i=Mfe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(r)?this.cancelMoveAttempt():this.chosenCoord=MB.of(r),LB.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push(lte.RIGHT),0!==t.x&&e.push(lte.LEFT),4!==t.y&&e.push(lte.DOWN),0!==t.y&&e.push(lte.UP),e}},{key:"chooseDirection",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e.toString())).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=e,n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Mfe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e){return Lfe.getArrowTransform(5*this.SPACE_SIZE,new hte(0,0),e)}}]),n}(Ene);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-quixo"]],features:[Xb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"defs"),ES(2,"polygon",1),_S(),gS(3,Hfe,2,1,"g",2),gS(4,$fe,2,1,"g",3),_S()),2&e&&(fS("viewBox","0 0 "+5*t.SPACE_SIZE+" "+5*t.SPACE_SIZE),LE(3),kS("ngForOf",t.board),LE(1),kS("ngIf",t.chosenCoord.isPresent()))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),qfe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=n9.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,Q7.NONE);return e[3][3]=X7.ZERO,e[4][4]=X7.ZERO,e[3][4]=X7.ONE,e[4][3]=X7.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new hte(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(Ote);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),Wfe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ate);Wfe.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return(qfe.BOARD_HEIGHT-1)*qfe.BOARD_WIDTH+(qfe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*qfe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%qfe.BOARD_WIDTH;return new Wfe(t,(e-t)/qfe.BOARD_WIDTH)}}]),n}(Y7)),Wfe.PASS=new Wfe(-1,-1),Wfe.PASS_NUMBER=Wfe.encoder.encodeNumber(Wfe.PASS);var jfe=function(){var e=vy(function e(){hy(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(_c||(_c=Gg(["Your move should switch at least one piece."])))},e}(),Yfe=vy(function e(t,n){hy(this,e),this.move=t,this.switched=n}),Kfe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(Wfe.PASS))return new qfe(a,r+1);var o,s=cy(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new qfe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(Wfe.PASS))return n.playerCanOnlyPass(t)?xB.success([]):xB.failure(wte.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return TB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),xB.failure(wte.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return TB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?xB.failure(jfe.NO_ELEMENT_SWITCHED()):xB.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Fte.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Fte.ZERO_WON:i>0?Fte.ONE_WON:Fte.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=cy(cte.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(qfe.BOARD_WIDTH,qfe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=cy(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(qfe.BOARD_WIDTH,qfe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===Q7.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Wfe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new qfe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===Q7.NONE&&(t=e.getCopiedBoard(),qfe.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new Wfe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=cy(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;D7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new Yfe(u,c.length))}}return 0===r.length&&r.push(new Yfe(Wfe.PASS,0)),r}}]),n}(Ute);return e.VERBOSE=!1,e}(),Qfe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=Kfe.getGameStatus(e);if(t.isEndGame)return Ete.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<qfe.BOARD_HEIGHT;a++)for(var o=0;o<qfe.BOARD_WIDTH;o++){var s=(0===o||o===qfe.BOARD_WIDTH-1?4:1)*(0===a||a===qfe.BOARD_HEIGHT-1?4:1);n[a][o]===X7.ZERO&&(r+=s),n[a][o]===X7.ONE&&(i+=s)}return r*=X7.ZERO.getScoreModifier(),i*=X7.ONE.getScoreModifier(),new Ete(i+r)}},{key:"getListMoves",value:function(e){var t=Kfe.getListMoves(e.gameState);return n9.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(_te);Qfe.bestCoords=[new hte(0,0),new hte(0,qfe.BOARD_HEIGHT-1),new hte(qfe.BOARD_WIDTH-1,0),new hte(qfe.BOARD_WIDTH-1,qfe.BOARD_HEIGHT-1)];var Xfe=Q7.NONE,Jfe=Q7.ZERO,ehe=Q7.ONE,the=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Ec||(Ec=Gg(["Goal of the game"]))),$localize(bc||(bc=Gg(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new qfe([[Jfe,Jfe,Jfe,Jfe,Jfe,Jfe,Jfe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,Jfe,Jfe,Jfe,Jfe,Jfe,Jfe,Jfe]],60)),Hte.anyMove($localize(Sc||(Sc=Gg(["Capture (1/2)"]))),$localize(Pc||(Pc=Gg(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),qfe.getInitialState(),new Wfe(2,4),$localize(Oc||(Oc=Gg(["Congratulations!"])))),Hte.fromMove($localize(Tc||(Tc=Gg(["Capture (2/2)"]))),$localize(Ic||(Ic=Gg(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new qfe([[Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe],[Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe],[Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe],[Xfe,Xfe,Xfe,Xfe,ehe,Xfe,Xfe,Xfe],[Xfe,Xfe,Xfe,Jfe,Xfe,Xfe,Xfe,Xfe],[Xfe,Xfe,Jfe,Xfe,Xfe,Xfe,Xfe,Xfe],[Jfe,Jfe,Xfe,Xfe,Xfe,Xfe,Xfe,Xfe],[Xfe,Jfe,ehe,Jfe,ehe,Jfe,Xfe,Xfe]],1),[new Wfe(0,7)],$localize(Ac||(Ac=Gg(["Congratulations!"]))),$localize(Rc||(Rc=Gg(["Lower and more to the left, please."])))),Hte.informational($localize(Mc||(Mc=Gg(["Passing a turn"]))),$localize(xc||(xc=Gg(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new qfe([[ehe,Jfe,Jfe,Jfe,Jfe,Jfe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[Jfe,ehe,ehe,ehe,ehe,ehe,ehe,Jfe],[ehe,ehe,ehe,ehe,ehe,ehe,Xfe,Xfe],[Jfe,Jfe,Jfe,Jfe,Jfe,Jfe,Xfe,Xfe]],60))]});function nhe(e,t){if(1&e&&(AC(),ES(0,"circle",4)),2&e){var n=MS().index,r=MS().index,i=MS();kS("ngClass",i.getPieceClass(n,r)),fS("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function rhe(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",2),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),_S(),gS(2,nhe,1,4,"circle",3),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();LE(1),DS("id","click_",r,"_",i,""),kS("ngClass",a.getRectClasses(r,i)),fS("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngIf",a.board[i][r]!==a.EMPTY)}}function ihe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,rhe,3,8,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var ahe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).EMPTY=Q7.NONE,r.lastMove=new hte(-2,-2),r.captureds=[],r.scores=MB.of([2,2]),r.rules=new Kfe(qfe),r.availableMinimaxes=[new Qfe(r.rules,"ReversiMinimax")],r.encoder=Wfe.encoder,r.tutorial=(new the).tutorial,r.canPass=!1,r.updateBoard(),r}return vy(n,[{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Wfe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new hte(-2,-2),this.scores=MB.of(e.countScore()),this.canPass=Kfe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=cy(cte.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(qfe.BOARD_WIDTH,qfe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new hte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(D7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Wfe.PASS.coord.x,Wfe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-reversi"]],features:[Xb],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,ihe,2,1,"g",1),_S()),2&e&&(fS("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),LE(1),kS("ngForOf",t.board))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ohe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,null,[{key:"getInitialState",value:function(){var e=pte.UNREACHABLE,t=pte.ZERO,r=pte.ONE,i=pte.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(Cre);return e.HEIGHT=6,e.WIDTH=11,e}(),she=function(){var e=vy(function e(){hy(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Nc||(Nc=Gg(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Dc||(Dc=Gg(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Lc||(Lc=Gg(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Fc||(Fc=Gg(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Uc||(Uc=Gg(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Vc||(Vc=Gg(["Those two spaces have no intermediary neighbor."])))},e}(),uhe=function(e){ey(n,e);var t=ny(n);function n(e,r){return hy(this,n),t.call(this,e,r)}return vy(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return LB.failure(wte.MOVE_CANNOT_BE_STATIC());if(1===n){var r=kre.getFakeNeighbors(e);if(t.equals(r))return LB.failure(she.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return LB.failure($localize(Bc||(Bc=Gg(["You can move one or two spaces, not ","."])),n));if(kre.isSpaceDark(e))return LB.failure(she.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return LB.failure(she.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return LB.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(ohe.WIDTH,ohe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(ohe.WIDTH,ohe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():xB.success(new n(e,t))}}]),n}(xne);uhe.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 396*ohe.WIDTH+66*ohe.HEIGHT+6*ohe.WIDTH+ohe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,uhe.from(new hte(e/=6,r),new hte(n,t)).get()}}]),n}(Y7));var che=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,r){TB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=pte.EMPTY,new ohe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return xB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==pte.EMPTY)return xB.failure(wte.MUST_LAND_ON_EMPTY_SPACE());var n=kre.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===pte.EMPTY?xB.success(void 0):xB.failure(she.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):xB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,X7.ZERO),i=n.getBoardValuesFor(t,X7.ONE);return n.getGameStatusFromFreedoms(r,i)}},{key:"getLandingCoords",value:function(e,t){var n=function(t){return t.isInRange(ohe.WIDTH,ohe.HEIGHT)&&e[t.y][t.x]===pte.EMPTY},r=new Ste(kre.getNeighbors(t).filter(n));if(!0===kre.isSpaceDark(t))return r.toList();var i,a=new Ste(r.toList()),o=cy(r);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=cy(kre.getNeighbors(u).filter(n));try{for(c.s();!(s=c.n()).done;){var l=s.value;a.add(l)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a.toList()}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<ohe.HEIGHT;r++)for(var i=0;i<ohe.WIDTH;i++)e[r][i].is(t)&&n.push(new hte(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=cy(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=Cre.getEmptyNeighbors(e,o,pte.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Fte.ONE_WON:0===t[0]?Fte.ZERO_WON:Fte.ONGOING}}]),n}(Ute);return e.VERBOSE=!1,e}(),lhe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=cy(che.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=cy(Cre.getEmptyNeighbors(r,s,pte.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=uhe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=pte.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=cy(Cre.getEmptyNeighbors(r,c,pte.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=uhe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=pte.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=pte.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=pte.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=che.getBoardValuesFor(t,X7.ZERO),r=che.getBoardValuesFor(t,X7.ONE),i=che.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return Ete.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new Ete(r[a%6]-n[a%6])}}]),n}(_te),fhe=pte.UNREACHABLE,hhe=pte.ZERO,dhe=pte.ONE,vhe=pte.EMPTY,phe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(zc||(zc=Gg(["Initial board"]))),$localize(Hc||(Hc=Gg(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),ohe.getInitialState()),Hte.informational($localize(Gc||(Gc=Gg(["Goal of the game"]))),$localize($c||($c=Gg(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new ohe([[fhe,fhe,vhe,vhe,dhe,vhe,vhe,hhe,dhe,fhe,fhe],[fhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,fhe],[dhe,hhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,hhe],[hhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,dhe],[fhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,vhe,fhe],[fhe,fhe,dhe,hhe,vhe,vhe,vhe,dhe,hhe,fhe,fhe]],3)),Hte.fromPredicate($localize(Zc||(Zc=Gg(["Simple step"]))),$localize(qc||(qc=Gg(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),ohe.getInitialState(),uhe.from(new hte(2,0),new hte(2,1)).get(),function(e,t,n){return e.isSimpleStep()?LB.SUCCESS:LB.failure($localize(Wc||(Wc=Gg(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(jc||(jc=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Yc||(Yc=Gg(["Double step"]))),$localize(Kc||(Kc=Gg(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),ohe.getInitialState(),uhe.from(new hte(7,0),new hte(5,0)).get(),function(e,t,n){return e.isSimpleStep()?LB.failure($localize(Qc||(Qc=Gg(["Failed! You have made a single step."])))):LB.SUCCESS},$localize(Xc||(Xc=Gg(["Congratulations!"]))))]});function ghe(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"polygon",7),_S()),2&e){var n=MS().index,r=MS().index,i=MS();LE(1),kS("ngClass",i.getPlayerClassFor(n,r)),fS("points",i.getPyramidCoordinate(n,r))}}function yhe(e,t){if(1&e&&(AC(),ES(0,"polygon",10)),2&e){var n=MS(2).index,r=MS().index;fS("points",MS().getTriangleCoordinate(n,r))}}function mhe(e,t){if(1&e&&(AC(),ES(0,"polygon",11)),2&e){var n=MS(2).index,r=MS().index;fS("points",MS().getTriangleCoordinate(n,r))}}function khe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,yhe,1,1,"polygon",8),gS(2,mhe,1,1,"polygon",9),_S()),2&e){var n=MS().index,r=MS().index;LE(1),kS("ngIf",(n+r)%2==1),LE(1),kS("ngIf",(n+r)%2==0)}}function Che(e,t){if(1&e){var n=PS();AC(),wS(0,"g",5),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),gS(1,ghe,2,2,"g",6),gS(2,khe,3,2,"g",6),_S()}if(2&e){var r=t.$implicit;DS("id","click_",t.index,"_",MS().index,""),LE(1),kS("ngIf",r.isPlayer()),LE(1),kS("ngIf",2===r.value)}}function whe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Che,3,4,"g",4),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function _he(e,t){if(1&e&&(AC(),ES(0,"polygon",14)),2&e){var n=t.$implicit,r=MS(2);DS("id","possible_landing_",n.x,"_",n.y,""),fS("points",r.getTriangleCoordinate(n.x,n.y))}}function Ehe(e,t){if(1&e&&(AC(),ES(0,"polygon",15)),2&e){var n=MS(2);DS("id","chosen_coord_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),fS("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function bhe(e,t){if(1&e&&(AC(),bS(0),gS(1,_he,1,3,"polygon",12),gS(2,Ehe,1,3,"polygon",13),SS()),2&e){var n=MS();LE(1),kS("ngForOf",n.possibleLandings),LE(1),kS("ngIf",n.chosenCoord.isPresent())}}function She(e,t){if(1&e&&(AC(),bS(0),ES(1,"polygon",16),ES(2,"polygon",16),SS()),2&e){var n=MS(2);LE(1),fS("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),LE(1),fS("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Phe(e,t){1&e&&(AC(),gS(0,She,3,2,"ng-container",6)),2&e&&kS("ngIf",MS().lastMoved.isPresent())}var Ohe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).lastCoord=MB.empty(),r.lastMoved=MB.empty(),r.chosenCoord=MB.empty(),r.possibleLandings=[],r.rules=new che(ohe),r.availableMinimaxes=[new lhe(r.rules,"SaharaMinimax")],r.encoder=uhe.encoder,r.tutorial=(new phe).tutorial,r.updateBoard(),r}return vy(n,[{key:"cancelMoveAttempt",value:function(){this.possibleLandings=[],this.chosenCoord=MB.empty()}},{key:"onClick",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentPlayer(),o=pte.ofPlayer(a),r.abrupt("return",n.chosenCoord.equalsValue(new hte(e,t))?(n.cancelMoveAttempt(),LB.SUCCESS):n.chosenCoord.isAbsent()||n.board[t][e]===o?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){if(this.board[t][e]===pte.EMPTY)return this.cancelMove(she.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(X7.fromTurn(this.getTurn()))){var n=new hte(e,t);return this.selectPiece(n),LB.SUCCESS}return this.cancelMove(she.MUST_CHOOSE_OWN_PYRAMID())}},{key:"selectPiece",value:function(e){this.chosenCoord=MB.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new hte(e,t),!(a=uhe.from(n.chosenCoord.get(),i)).isFailure()){r.next=5;break}r.t0=n.cancelMove(a.getReason()),r.next=8;break;case 5:return r.next=7,n.chooseMove(a.get(),n.rules.node.gameState);case 7:r.t0=r.sent;case 8:return r.abrupt("return",r.t0);case 9:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(X7.of(this.board[t][e].value))}}]),n}(pre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-sahara"]],features:[Xb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke highlighted",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","highlighted",3,"id"],[1,"base","no-fill","small-stroke","selected",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(AC(),wS(0,"svg",0),gS(1,whe,2,1,"g",1),gS(2,bhe,3,2,"ng-container",2),gS(3,Phe,1,1,"ng-template",null,3,JT),_S()),2&e){var n=yS(4);LE(1),kS("ngForOf",t.board),LE(1),kS("ngIf",t.chosenCoord.isPresent())("ngIfElse",n)}},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),The=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return vy(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(Ate);The.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?MB.empty():lte.factory.fromInt(r).toOptional();e-=r;var a=lte.factory.fromInt(e/=5).get();return new The(n-1,t-1,i,a)}}]),n}(Y7));var Ihe=function(){function e(t){hy(this,e),this.value=t}return vy(e,[{key:"belongTo",value:function(e){return e===X7.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?X7.ZERO:5<=this.value&&this.value<=8?X7.ONE:Q7.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return MB.empty();case 1:case 5:return MB.of(lte.UP);case 2:case 6:return MB.of(lte.RIGHT);case 3:case 7:return MB.of(lte.DOWN);case 4:case 8:return MB.of(lte.LEFT);default:return OB.expectToBe(this.value,9),MB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return OB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===X7.ZERO?t===lte.UP?e.LIGHT_UP:t===lte.RIGHT?e.LIGHT_RIGHT:t===lte.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===lte.UP?e.DARK_UP:t===lte.RIGHT?e.DARK_RIGHT:t===lte.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();Ihe.EMPTY=new Ihe(0),Ihe.LIGHT_UP=new Ihe(1),Ihe.LIGHT_RIGHT=new Ihe(2),Ihe.LIGHT_DOWN=new Ihe(3),Ihe.LIGHT_LEFT=new Ihe(4),Ihe.DARK_UP=new Ihe(5),Ihe.DARK_RIGHT=new Ihe(6),Ihe.DARK_DOWN=new Ihe(7),Ihe.DARK_LEFT=new Ihe(8),Ihe.MOUNTAIN=new Ihe(9);var Ahe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=n9.createTable(5,5,Ihe.EMPTY);return e[2][1]=Ihe.MOUNTAIN,e[2][2]=Ihe.MOUNTAIN,e[2][3]=Ihe.MOUNTAIN,new n(e,0)}}]),n}(Ote),Rhe=function(){var e=vy(function e(){hy(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Jc||(Jc=Gg(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(el||(el=Gg(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(tl||(tl=Gg(["You do not have enough strength to push."])))},e.MUST_MOVE_OR_ROTATE=function(){return $localize(nl||(nl=Gg(["You must move or rotate your piece."])))},e.ILLEGAL_PUSH=function(){return $localize(rl||(rl=Gg(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=function(){return $localize(il||(il=Gg(["You should insert or choose one of your pieces!"])))},e}(),Mhe=vy(function e(t,n){hy(this,e),this.resultingBoard=t,this.moved=n}),xhe=function(){var e=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"isLegal",value:function(e,t){if(TB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return xB.failure(wte.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return TB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){TB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return xB.failure(i.legal.getReason());r=i.insertedPiece}else TB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?LB.SUCCESS:LB.failure(Rhe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){TB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return xB.failure(Rhe.MUST_MOVE_OR_ROTATE());var o=t.getCopiedBoard();return o[r.y][r.x]=Ihe.of(e.landingOrientation,a),xB.success(new Mhe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=n9.copyBiArray(n.resultingBoard);return new Ahe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?Fte.getVictory(r):Fte.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Ihe.of(-1===e.x?lte.RIGHT:-1===e.y?lte.DOWN:5===e.x?lte.LEFT:lte.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){TB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Ihe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Ihe.EMPTY&&!1===n.isStraight(r,e))return TB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),xB.failure(Rhe.ILLEGAL_PUSH());var u=MB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=Ihe.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==Ihe.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,TB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===Ihe.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==Ihe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(TB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(TB(n.VERBOSE,"This move is an illegal push: "+f),xB.failure(Rhe.NOT_ENOUGH_FORCE_TO_PUSH())):(TB(n.VERBOSE,"This move is a legal push: "+f),xB.success(new Mhe(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===X7.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,f=t.getCurrentPlayer(),h=cy(u);try{for(h.s();!(s=h.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(X7.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):f===X7.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){h.e(v)}finally{h.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,f)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Ihe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):Q7.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return TB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Ihe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){TB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=cy(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=lte.DOWN,l=new hte(u,4);o.push({direction:c,fallingCoord:l}),c=lte.UP,l=new hte(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=cy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=lte.LEFT,p=new hte(0,d);o.push({direction:v,fallingCoord:p}),v=lte.RIGHT,p=new hte(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return TB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){TB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=MB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===Ihe.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=MB.of(s),o!==Ihe.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countPlayerPawn())||f>0?MB.empty():MB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new The(-1,a,MB.of(lte.RIGHT),lte.RIGHT)),i.push(Ihe.of(lte.RIGHT,n)),r.push(new The(5,a,MB.of(lte.LEFT),lte.LEFT)),i.push(Ihe.of(lte.LEFT,n)),r.push(new The(a,-1,MB.of(lte.DOWN),lte.DOWN)),i.push(Ihe.of(lte.DOWN,n)),r.push(new The(a,5,MB.of(lte.UP),lte.UP)),i.push(Ihe.of(lte.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.getCurrentPlayer(),a=1;a<=3;a++)t=new The(-1,a,MB.of(lte.RIGHT),lte.UP),n=Ihe.of(lte.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new The(-1,a,MB.of(lte.RIGHT),lte.DOWN),n=Ihe.of(lte.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new The(5,a,MB.of(lte.LEFT),lte.UP),n=Ihe.of(lte.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new The(5,a,MB.of(lte.LEFT),lte.DOWN),n=Ihe.of(lte.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t));for(var o=1;o<=3;o++)t=new The(o,-1,MB.of(lte.DOWN),lte.LEFT),n=Ihe.of(lte.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new The(o,-1,MB.of(lte.DOWN),lte.RIGHT),n=Ihe.of(lte.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new The(o,5,MB.of(lte.UP),lte.LEFT),n=Ihe.of(lte.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new The(o,5,MB.of(lte.UP),lte.RIGHT),n=Ihe.of(lte.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new hte(t,n);return this.getInsertedPiece(r,e.getCurrentPlayer()).getDirection()}},{key:"getMovesFrom",value:function(e,t,r,i){var a,o=[],s=t.getDirection(),u=cy(lte.ORTHOGONALS);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(c!==s){var l=new The(r,i,MB.empty(),c);o.push(l)}var f,h=cy(new hte(r+c.x,i+c.y).isInRange(5,5)?lte.ORTHOGONALS:[c]);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=new The(r,i,MB.of(c),d);n.isLegalForwarding(v,e,t).isSuccess()&&o.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){u.e(p)}finally{u.f()}return o}}]),n}(Ute);return e.VERBOSE=!1,e}(),Nhe=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){return new Ete(xhe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=0;r<5;r++)for(var i=0;i<5;i++){var a=e.gameState.getPieceAtXY(i,r);a.belongTo(n)&&(t=t.concat(xhe.getMovesFrom(e.gameState,a,i,r)))}return e.gameState.countPlayerPawn()<5&&(t=(t=t.concat(xhe.getPushingInsertions(e.gameState))).concat(xhe.getDerapingInsertions(e.gameState))),TB(xhe.VERBOSE,{getListMovesResult:t}),t}}]),n}(_te),Dhe=Ihe.EMPTY,Lhe=Ihe.MOUNTAIN,Fhe=Ihe.LIGHT_UP,Uhe=Ihe.LIGHT_LEFT,Vhe=Ihe.LIGHT_RIGHT,Bhe=Ihe.LIGHT_DOWN,zhe=Ihe.DARK_UP,Hhe=Ihe.DARK_LEFT,Ghe=Ihe.DARK_RIGHT,$he=Ihe.DARK_DOWN,Zhe=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(al||(al=Gg(["Goal of the game"]))),$localize(ol||(ol=Gg(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Ahe.getInitialState()),Hte.anyMove($localize(sl||(sl=Gg(["Inserting a piece"]))),$localize(ul||(ul=Gg(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Ahe.getInitialState(),new The(2,-1,MB.of(lte.DOWN),lte.DOWN),$localize(cl||(cl=Gg(["Congratulations!"])))),Hte.fromMove($localize(ll||(ll=Gg(["Moving a piece"]))),$localize(fl||(fl=Gg(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Ahe([[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Lhe,Lhe,Lhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Fhe,Dhe,Dhe]],0),[new The(2,4,MB.of(lte.UP),lte.DOWN)],$localize(hl||(hl=Gg(["Congratulations, you made a side-slip!"]))),$localize(dl||(dl=Gg(["Failed!"])))),Hte.fromMove($localize(vl||(vl=Gg(["Moving a piece out of the board"]))),$localize(pl||(pl=Gg(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Ahe([[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Lhe,Lhe,Lhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Fhe,Dhe,Dhe]],0),[new The(2,4,MB.of(lte.DOWN),lte.DOWN)],$localize(gl||(gl=Gg(["Congratulations, even if in this context it was not a useful move."]))),$localize(yl||(yl=Gg(["Failed, the piece is still on the board."])))),Hte.fromMove($localize(ml||(ml=Gg(["Pushing"]))),$localize(kl||(kl=Gg(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Ahe([[Vhe,Lhe,Lhe,Hhe,Uhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Dhe,Lhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Ghe,Hhe,Uhe]],0),[new The(4,4,MB.of(lte.LEFT),lte.LEFT)],$localize(Cl||(Cl=Gg(["Congratulations!"]))),$localize(wl||(wl=Gg(["Failed!"])))),Hte.fromMove($localize(_l||(_l=Gg(["Victory"]))),$localize(El||(El=Gg(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Ahe([[Dhe,Dhe,Dhe,Dhe,Dhe],[Dhe,Dhe,Dhe,Dhe,Dhe],[Lhe,zhe,Uhe,Dhe,Bhe],[Dhe,Dhe,Dhe,Dhe,$he],[Dhe,Dhe,Dhe,Dhe,Lhe]],0),[new The(2,2,MB.of(lte.LEFT),lte.LEFT)],$localize(bl||(bl=Gg(["Congratulations, you won!"]))),$localize(Sl||(Sl=Gg(["Failed, you lost."]))))]});function qhe(e,t){if(1&e){var n=PS();AC(),wS(0,"use",7),IS("click",function(){var e=tC(n).$implicit;return MS(3).insertAt(e.x,e.y)}),_S()}if(2&e){var r=t.$implicit,i=MS(3);DS("id","insertAt_",r.x,"_",r.y,""),fS("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var Whe=function(e,t){return{dir:"DOWN",x:e,y:t}},jhe=function(e){return{dir:"UP",x:e,y:5}},Yhe=function(e,t){return{dir:"RIGHT",x:e,y:t}},Khe=function(e){return{dir:"LEFT",x:5,y:e}},Qhe=function(e,t,n,r){return[e,t,n,r]};function Xhe(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,qhe,1,3,"use",6),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=lS(e,t,n,r);return lS(e,t+2,i,a)||o}(e,c,i,a,o,s)?uS(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):IT(e,c+4)}(Jk(),lC(),e,t,n,r,i,a,o)}(11,Qhe,TT(1,Whe,n,-1),OT(4,jhe,n),TT(6,Yhe,-1,n),OT(9,Khe,n)))}}var Jhe=function(){return[0,1,2,3,4]};function ede(e,t){1&e&&(AC(),bS(0),gS(1,Xhe,2,16,"g",5),SS()),2&e&&(LE(1),kS("ngForOf",PT(1,Jhe)))}function tde(e,t){if(1&e){var n=PS();AC(),wS(0,"use",13),IS("click",function(){var e=tC(n).$implicit;return MS(5).chooseDirection(e)}),_S()}if(2&e){var r=t.$implicit,i=MS(3).index,a=MS().index,o=MS();NS("id","chooseDirection_",r,""),fS("transform",o.getArrowTransform(i+1,a+1,r))}}var nde=function(){return["RIGHT","DOWN","LEFT","UP"]};function rde(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"circle",11),IS("click",function(){return tC(n),MS(4).chooseDirection("")}),_S(),gS(2,tde,1,2,"use",12),_S()}if(2&e){var r=MS(2).index,i=MS().index,a=MS();LE(1),fS("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),LE(1),kS("ngForOf",PT(3,nde))}}function ide(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"use",10),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().clickPiece(e,t)}),_S(),gS(2,rde,3,4,"g",4),_S()}if(2&e){var r=MS(),i=r.index,a=r.$implicit,o=MS().index,s=MS();LE(1),DS("id","clickPiece_",i,"_",o,""),kS("ngClass",s.getPieceClasses(a)),fS("transform",s.getPieceTransform(i,o)),LE(1),kS("ngIf",s.choosingDirection(i,o))}}function ade(e,t){if(1&e){var n=PS();AC(),wS(0,"use",14),IS("click",function(){tC(n);var e=MS().index,t=MS().index;return MS().clickPiece(e,t)}),_S()}if(2&e){var r=MS().index,i=MS().index,a=MS();fS("transform","translate("+(r+1)*a.SPACE_SIZE+" "+(i+1)*a.SPACE_SIZE+")")}}function ode(e,t){if(1&e){var n=PS();AC(),wS(0,"use",13),IS("click",function(){var e=tC(n).$implicit;return MS(4).chooseOrientation(e)}),_S()}if(2&e){var r=t.$implicit,i=MS(2).index,a=MS().index,o=MS();NS("id","chooseOrientation_",r,""),fS("transform",o.getArrowTransform(i+1,a+1,r))}}function sde(e,t){1&e&&(AC(),wS(0,"g"),gS(1,ode,1,2,"use",12),_S()),2&e&&(LE(1),kS("ngForOf",PT(1,nde)))}function ude(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",8),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().insertAt(e,t)}),_S(),gS(2,ide,3,5,"g",4),gS(3,ade,1,1,"use",9),gS(4,sde,2,2,"g",4),_S()}if(2&e){var r=t.$implicit,i=t.index,a=MS().index,o=MS();LE(1),DS("id","insertAt_",i,"_",a,""),kS("ngClass",o.getSquareClasses(i,a)),fS("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),LE(1),kS("ngIf",r.isPiece()),LE(1),kS("ngIf",o.isMountain(r)),LE(1),kS("ngIf",o.choosingOrientation(i,a))}}function cde(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,ude,5,10,"g",5),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var lde=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).lastMove=MB.empty(),r.chosenCoord=MB.empty(),r.landingCoord=MB.empty(),r.chosenDirection=MB.empty(),r.chosenOrientation=MB.empty(),r.movedPieces=[],r.rules=new xhe(Ahe),r.availableMinimaxes=[new Nhe(r.rules,"SiamMinimax")],r.encoder=The.encoder,r.tutorial=(new Zhe).tutorial,r.updateBoard(),r}return vy(n,[{key:"updateBoard",value:function(){if(TB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=MB.empty(),this.chosenDirection=MB.empty(),this.landingCoord=MB.empty(),this.chosenOrientation=MB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);return n.isFailure()?this.cancelMove(n.getReason()):this.board[t][e].getOwner()!==this.getCurrentPlayer()?this.cancelMove(wte.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=MB.of(new hte(e,t)),LB.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=MB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=lte.factory.fromString(e).get(),t.chosenDirection=MB.of(a),t.landingCoord=MB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return TB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=MB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",LB.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=MB.of(lte.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(TB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Rhe.CANNOT_INSERT_WHEN_SELECTED()));case 6:if(o=new hte(e,t),!r.getState().isOnBoard(o)||!r.getState().getPieceAtXY(e,t).isEmptyOrMountain()){i.next=9;break}return i.abrupt("return",r.cancelMove(Rhe.MUST_INSERT_OR_CHOOSE_YOUR_PIECE()));case 9:return r.chosenCoord=MB.of(o),s=xhe.getCoordDirection(r.getState(),e,t),i.abrupt("return",(r.chosenDirection=MB.of(s),r.landingCoord=MB.of(r.chosenCoord.get().getNext(s)),LB.SUCCESS));case 12:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new The(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Ihe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new hte(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(TB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new hte(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(TB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(lte.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Lfe.getArrowTransform(this.SPACE_SIZE,new hte(e,t),lte.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new hte(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(Ene);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-siam"]],features:[Xb],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown",3,"click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),wS(1,"defs"),ES(2,"polygon",1),ES(3,"polygon",2),ES(4,"polygon",3),_S(),gS(5,ede,2,2,"ng-container",4),gS(6,cde,2,1,"g",5),_S()),2&e&&(LE(5),kS("ngIf",t.isPlayerTurn()),LE(1),kS("ngForOf",t.board))},directives:[aR,rR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fde=function(){var e=vy(function e(){hy(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(Pl||(Pl=Gg(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Ol||(Ol=Gg(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Tl||(Tl=Gg(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Il||(Il=Gg(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Al||(Al=Gg(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Rl||(Rl=Gg(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Ml||(Ml=Gg(["You must put this piece next to another piece."])))},e}(),hde=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;hy(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return vy(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=cy(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new Nte,u=new ote(-t,-r);if(0!==t||0!==r){var c,l=cy(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=n9.createTable(this.width,this.height,Q7.NONE.value),n=cy(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?LB.failure(wte.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?LB.SUCCESS:LB.failure(fde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=cy(gte.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():Q7.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new Nte;if(t.size()>0){i=new Nte;var a,o=cy(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(X7.ZERO).getOrElse(new jne),n=e.get(X7.ONE).getOrElse(new jne);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);N7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[X7.ZERO.value],[X7.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new Nte,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==Q7.NONE.value&&i.set(new hte(o,a),X7.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new Nte,a=0,o=cy(gte.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new Ste,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=cy(gte.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(Pte),dde=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;if(hy(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return ry(a)}return vy(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(MB.empty(),e,MB.empty())}},{key:"fromMovement",value:function(e,t){return new n(MB.of(e),t,MB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(MB.of(e),t,MB.of(r))}}]),n}(Ite);dde.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?hte.encoder.encode(e.start.get()):null,landing:hte.encoder.encode(e.landing),keep:e.keep.isPresent()?hte.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=hte.encoder.decode(t.landing);if(null==t.start)return dde.fromDrop(n);var r=hte.encoder.decode(t.start);if(null==t.keep)return dde.fromMovement(r,n);var i=hte.encoder.decode(t.keep);return dde.fromCut(r,n,i)}}]),n}(j7));var vde=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){TB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?xB.failure(fde.NO_MOVEMENT_BEFORE_TURN_40()):xB.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Fte.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Fte.ONE_WON:o<a?Fte.ZERO_WON:Fte.DRAW:a<6?Fte.getDefeat(X7.ZERO):o<6?Fte.getDefeat(X7.ONE):Fte.ONGOING}return Fte.ONGOING}},{key:"startSearchingVictorySources",value:function(){TB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(TB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(gte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(gte.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=gte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=gte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new jne,r=cy(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=cy(gte.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===Q7.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return xB.failure(fde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case Q7.NONE:return xB.failure(wte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return xB.failure(wte.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=hde.deplacePiece(t,e),i=hde.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?xB.failure(fde.CANNOT_CHOOSE_TO_KEEP()):xB.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return xB.success(new jne)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new Ste,i=cy(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new Ste([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return xB.failure(fde.MUST_CUT());if(n.get(e.get()).isAbsent())return xB.failure(fde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=cy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return xB.success(o)}}catch(s){a.e(s)}finally{a.f()}return xB.failure(fde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Ute),pde=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:Mte.DEFAULT,victory:MB.empty(),preVictory:MB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===Mte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===Mte.VICTORY)return r;n={status:r.status,victory:MB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(_te),gde=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return vy(n)}(Ete),yde=function(e){ey(n,e);var t=ny(n);function n(){var e;return hy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return vy(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=vde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){TB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=dde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){TB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=cy(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=cy(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=dde.fromMovement(s,c);if(e.isCoordConnected(c,MB.of(s))){var f=hde.deplacePiece(e,l),h=hde.getGroups(f,l.start.get());if(vde.isSplit(h)){var d,v=cy(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=dde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=cy(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new jne(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=dde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===Mte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=dde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:Mte.DEFAULT,victory:MB.empty(),preVictory:MB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=MB.empty();if(a.status===Mte.DEFAULT&&a.preVictory.isPresent()&&(o=MB.of(a.preVictory.get())),a.status===Mte.VICTORY)return new gde(i,MB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new gde(u<c?X7.ONE.getVictoryValue():c<u?X7.ZERO.getVictoryValue():0,MB.empty()):u<6?new gde(X7.ZERO.getDefeatValue(),MB.empty()):c<6?new gde(X7.ONE.getDefeatValue(),MB.empty()):new gde(u-c,o)}return new gde(a.status===Mte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){TB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(TB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(gte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:Mte.PRE_VICTORY,victory:MB.empty(),preVictory:MB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(gte.factory.all[o],1)}return{status:Mte.VICTORY,victory:MB.of(i),preVictory:MB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:Mte.PRE_VICTORY,victory:MB.empty(),preVictory:MB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:Mte.VICTORY,victory:MB.of(o),preVictory:MB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Mte.PRE_VICTORY,victory:MB.empty(),preVictory:MB.empty(),sum:0};a.length%2==0&&(i=gte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:Mte.VICTORY,victory:MB.of(a),preVictory:MB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){TB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=gte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Mte.PRE_VICTORY,victory:MB.empty(),preVictory:MB.empty(),sum:0};a.push(o),a.length%2==0&&(i=gte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:Mte.VICTORY,victory:MB.of(a),preVictory:MB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){TB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){TB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(gte.factory.all[e],1),s=0,u=MB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=gte.factory.all[l];c===Q7.NONE?(s+=.16,u=MB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(TB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:Mte.PRE_VICTORY,victory:MB.empty(),preVictory:MB.empty(),sum:0};i=t}else if(5===e)return{status:Mte.VICTORY,victory:MB.of(n),preVictory:MB.empty(),sum:0};return{status:r.status,victory:MB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){TB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=gte.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=MB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:Mte.VICTORY,victory:MB.of(o),preVictory:MB.empty(),sum:0};5.16===p&&f===Mte.DEFAULT&&(h.isPresent()?(D7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=Mte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:MB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),MB.empty();case Q7.NONE:return n.push(.16),MB.of(t);default:return n.push(1),MB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){TB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=gte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=MB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Q7.NONE?(u+=.16,c=MB.of(s)):u++,o.length%2==0&&(a=gte.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){TB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=gte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=MB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Q7.NONE?(u+=.16,c=MB.of(s)):u++,o.push(s),o.length%2==0&&(a=gte.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new vde(hde);n.singleton=MB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(pde);yde.singleton=MB.empty();var mde=Q7.NONE.value,kde=X7.ZERO.value,Cde=X7.ONE.value,wde=function(){var e=vy(function e(){hy(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(xl||(xl=Gg(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Nl||(Nl=Gg(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),_de=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Dl||(Dl=Gg(["Six"]))),$localize(Ll||(Ll=Gg(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),hde.getInitialState()),Hte.fromMove($localize(Fl||(Fl=Gg(["Victory (line)"]))),$localize(Ul||(Ul=Gg(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),hde.fromRepresentation([[kde,Cde,Cde,Cde,Cde,kde],[mde,kde,Cde,mde,kde,mde],[Cde,Cde,kde,mde,mde,mde],[mde,mde,kde,mde,mde,mde],[mde,kde,mde,mde,mde,mde],[kde,mde,mde,mde,mde,mde]],0),[dde.fromDrop(new hte(3,2))],$localize(Vl||(Vl=Gg(["Congratulations!"]))),$localize(Bl||(Bl=Gg(["Failed!"])))),Hte.fromMove($localize(zl||(zl=Gg(["Victory (circle)"]))),$localize(Hl||(Hl=Gg(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),hde.fromRepresentation([[mde,mde,mde,Cde,mde,mde],[mde,mde,Cde,Cde,kde,kde],[mde,Cde,mde,kde,Cde,mde],[Cde,kde,kde,kde,kde,Cde]],0),[dde.fromDrop(new hte(5,2))],$localize(Gl||(Gl=Gg(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize($l||($l=Gg(["Failed!"])))),Hte.fromMove($localize(Zl||(Zl=Gg(["Victory (triangle)"]))),$localize(ql||(ql=Gg(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),hde.fromRepresentation([[mde,mde,mde,Cde,mde,mde],[mde,kde,Cde,kde,kde,kde],[mde,kde,mde,kde,kde,mde],[Cde,Cde,Cde,mde,Cde,mde]],0),[dde.fromDrop(new hte(3,3))],$localize(Wl||(Wl=Gg(["Congratulations!"]))),$localize(jl||(jl=Gg(["Failed!"])))),Hte.fromPredicate($localize(Yl||(Yl=Gg(["Second phase"]))),$localize(Kl||(Kl=Gg(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),hde.fromRepresentation([[mde,mde,mde,mde,mde,mde,mde,Cde,mde],[mde,mde,mde,mde,mde,mde,kde,mde,mde],[mde,mde,mde,mde,kde,kde,kde,mde,mde],[mde,mde,mde,mde,Cde,Cde,mde,Cde,kde],[mde,kde,Cde,Cde,kde,kde,Cde,mde,mde],[kde,kde,kde,kde,Cde,Cde,Cde,kde,mde],[Cde,Cde,kde,mde,Cde,Cde,kde,mde,mde],[mde,kde,mde,kde,kde,mde,mde,mde,mde],[Cde,Cde,Cde,Cde,mde,mde,mde,mde,mde],[mde,kde,mde,Cde,mde,mde,mde,mde,mde]],40),dde.fromMovement(new hte(6,1),new hte(5,1)),function(e,t,n){var r=n.countPieces();return 19===r[0]?18===r[1]?LB.SUCCESS:LB.failure(wde.MOVEMENT_NOT_DISCONNECTING()):LB.failure(wde.MOVEMENT_SELF_DISCONNECTING())},$localize(Ql||(Ql=Gg(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Hte.fromPredicate($localize(Xl||(Xl=Gg(["Victory by disconnection"]))),$localize(Jl||(Jl=Gg(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),hde.fromRepresentation([[mde,mde,mde,mde,mde,Cde],[mde,mde,mde,mde,kde,Cde],[mde,mde,mde,Cde,kde,kde],[mde,mde,kde,mde,Cde,kde],[Cde,Cde,mde,mde,mde,kde],[kde,Cde,mde,mde,mde,mde],[kde,mde,mde,mde,mde,mde]],40),dde.fromMovement(new hte(2,3),new hte(3,3)),function(e,t,n){return e.start.equalsValue(new hte(2,3))?LB.SUCCESS:LB.failure(wde.MOVEMENT_NOT_DISCONNECTING())},$localize(ef||(ef=Gg(["Congratulations, you won!"])))),Hte.fromPredicate($localize(tf||(tf=Gg(["Special disconnection"]))),$localize(nf||(nf=Gg(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),hde.fromRepresentation([[mde,mde,mde,mde,mde,Cde],[mde,mde,mde,mde,kde,Cde],[mde,mde,mde,Cde,kde,kde],[kde,mde,kde,mde,mde,Cde],[Cde,Cde,mde,mde,mde,mde],[kde,kde,mde,mde,mde,mde],[kde,mde,mde,mde,mde,mde]],40),dde.fromCut(new hte(2,3),new hte(2,5),new hte(2,5)),function(e,t,n){return e.keep.isAbsent()?LB.failure($localize(rf||(rf=Gg(["This move has not cut the board in two equal halves."])))):n.getPieceAt(e.landing.getNext(n.offset))===Q7.NONE?LB.failure($localize(af||(af=Gg(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):LB.SUCCESS},$localize(of||(of=Gg(["Congratulations, you won!"]))))]});function Ede(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",10),IS("click",function(){var e=tC(n).$implicit;return MS().onPieceClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","piece_",r.x,"_",r.y,""),kS("ngClass",i.getPieceClass(r)),fS("points",i.getHexaCoordsAt(r))}}function bde(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",11),IS("click",function(){var e=tC(n).$implicit;return MS().onNeighborClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","neighbor_",r.x,"_",r.y,""),fS("points",i.getHexaCoordsAt(r))}}function Sde(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",10),IS("click",function(){tC(n);var e=MS();return e.onPieceClick(e.chosenLanding.get())}),_S()}if(2&e){var r=MS();DS("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),kS("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),fS("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Pde(e,t){if(1&e&&(AC(),ES(0,"polygon",12)),2&e){var n=t.$implicit,r=MS();DS("id","disconnected_",n.x,"_",n.y,""),fS("points",r.getHexaCoordsAt(n))}}function Ode(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",13),IS("click",function(){tC(n);var e=MS();return e.onNeighborClick(e.leftCoord.get())}),_S()}if(2&e){var r=MS();DS("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),fS("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Tde(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",14),IS("click",function(){tC(n);var e=MS();return e.onPieceClick(e.lastDrop.get())}),_S()}if(2&e){var r=MS();DS("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),fS("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Ide(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",15),IS("click",function(){tC(n);var e=MS();return e.onPieceClick(e.selectedPiece.get())}),_S()}if(2&e){var r=MS();DS("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),kS("ngClass",r.getSelectedPieceClass()),fS("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Ade(e,t){if(1&e&&(AC(),ES(0,"polygon",16)),2&e){var n=t.$implicit,r=MS();DS("id","victoryCoord_",n.x,"_",n.y,""),fS("points",r.getHexaCoordsAt(n))}}function Rde(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",19),IS("click",function(){var e=tC(n).$implicit;return MS(2).onPieceClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS(2);DS("id","cuttable_",r.x,"_",r.y,""),fS("points",i.getHexaCoordsAt(r))}}function Mde(e,t){if(1&e&&(AC(),wS(0,"g",17),gS(1,Rde,1,3,"polygon",18),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var xde=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=MB.empty(),r.lastDrop=MB.empty(),r.selectedPiece=MB.empty(),r.chosenLanding=MB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new vde(hde),r.availableMinimaxes=[new yde(r.rules,"SixMinimax")],r.encoder=dde.encoder,r.tutorial=(new _de).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new yte(1.5*r.SPACE_SIZE,new hte(2*r.SPACE_SIZE,0),Cte.INSTANCE),r.updateBoard(),r}return vy(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=MB.empty(),this.chosenLanding=MB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=MB.empty(),this.lastDrop=MB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=cy(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=cy(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=MB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?MB.of(e.start.get().getNext(this.state.offset,1)):MB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=cy(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=vde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(fde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(wte.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=t.selectedPiece.equalsValue(e)?MB.empty():MB.of(e),LB.SUCCESS));case 7:return i=dde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(fde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(dde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(fde.CAN_NO_LONGER_DROP()));case 9:return i=dde.fromMovement(t.selectedPiece.get(),e),a=vde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=MB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,LB.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===fde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=dde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=hde.deplacePiece(this.state,e),n=hde.getGroups(t,e.start.get()),r=vde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=cy(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(vte);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-six"]],features:[Xb],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Ede,1,4,"polygon",1),gS(2,bde,1,3,"polygon",2),gS(3,Sde,1,4,"polygon",3),gS(4,Pde,1,3,"polygon",4),gS(5,Ode,1,3,"polygon",5),gS(6,Tde,1,3,"polygon",6),gS(7,Ide,1,4,"polygon",7),gS(8,Ade,1,3,"polygon",8),gS(9,Mde,2,1,"g",9),_S()),2&e&&(fS("viewBox",t.viewBox),LE(1),kS("ngForOf",t.pieces),LE(1),kS("ngForOf",t.neighbors),LE(1),kS("ngIf",t.chosenLanding.isPresent()),LE(1),kS("ngForOf",t.disconnecteds),LE(1),kS("ngIf",t.leftCoord.isPresent()),LE(1),kS("ngIf",t.lastDrop.isPresent()),LE(1),kS("ngIf",t.selectedPiece.isPresent()),LE(1),kS("ngForOf",t.victoryCoords),LE(1),kS("ngForOf",t.cuttableGroups))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Nde=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return xB.success(r)}catch(r){return xB.failure(r.message)}}}]),n}(Dne);Nde.encoder=xne.getEncoder(9,9,Nde.of);var Dde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:X7.ZERO},Lde=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Une.UNOCCUPIED,t=Une.INVADERS,r=Une.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Une.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Bne),Fde=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.call(this,Lde,Dde,Nde.of)}return vy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Lte.ruler=this.singleton,n.singleton}}]),n}(Hne),Ude=Une.UNOCCUPIED,Vde=Une.INVADERS,Bde=Une.DEFENDERS,zde=Une.PLAYER_ONE_KING,Hde=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(sf||(sf=Gg(["Goal of the game"]))),$localize(uf||(uf=Gg(["Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Lde.getInitialState()),Hte.anyMove($localize(cf||(cf=Gg(["Moving"]))),$localize(lf||(lf=Gg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Lde.getInitialState(),Nde.of(new hte(4,1),new hte(1,1)),$localize(ff||(ff=Gg(["Congratulations!"])))),Hte.fromMove($localize(hf||(hf=Gg(["Capturing a soldier (1/2)"]))),$localize(df||(df=Gg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Lde([[Ude,Ude,Ude,Vde,Vde,Vde,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Vde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Vde,Bde,Ude,Ude,Ude,Vde],[Vde,Vde,Bde,Bde,zde,Bde,Bde,Vde,Vde],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Vde],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Vde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Vde,Vde,Vde,Ude,Ude,Ude]],1),[Nde.of(new hte(2,4),new hte(2,3)),Nde.of(new hte(4,2),new hte(3,2))],$localize(vf||(vf=Gg(["Congratulations, that will teach him a lesson!"]))),$localize(pf||(pf=Gg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Hte.fromMove($localize(gf||(gf=Gg(["Capturing a soldier (2/2)"]))),$localize(yf||(yf=Gg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Lde([[Ude,Ude,Ude,Vde,Vde,Vde,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Vde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Ude],[Ude,Ude,Bde,Ude,zde,Ude,Bde,Ude,Vde],[Vde,Vde,Ude,Bde,Ude,Bde,Bde,Vde,Vde],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Vde],[Ude,Ude,Ude,Ude,Bde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Vde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Vde,Vde,Vde,Ude,Ude,Ude]],12),[Nde.of(new hte(1,4),new hte(2,4))],$localize(mf||(mf=Gg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(kf||(kf=Gg(["Failed, you did not do the expected move."])))),Hte.fromMove($localize(Cf||(Cf=Gg(["Capturing the king (1/2)"]))),$localize(wf||(wf=Gg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new Lde([[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Vde,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Vde,zde,Ude,Vde,Ude,Ude,Ude,Ude,Ude],[Ude,Vde,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude]],72),[Nde.of(new hte(3,4),new hte(2,4))],$localize(_f||(_f=Gg(["Congratulations, you won!"]))),$localize(Ef||(Ef=Gg(["Failed, you let the king run away."])))),Hte.fromMove($localize(bf||(bf=Gg(["Capturing the king (2/2)"]))),$localize(Sf||(Sf=Gg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new Lde([[Ude,Ude,Vde,zde,Vde,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Vde,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude],[Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude,Ude]],72),[Nde.of(new hte(3,3),new hte(3,1))],$localize(Pf||(Pf=Gg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Of||(Of=Gg(["Failed!"]))))]});function Gde(e,t){1&e&&(AC(),ES(0,"polygon",8))}function $de(e,t){1&e&&(AC(),ES(0,"rect",9))}function Zde(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Gde,1,0,"polygon",6),gS(2,$de,1,0,"ng-template",null,7,JT),_S()),2&e){var n=yS(3),r=MS().index,i=MS().index,a=MS();LE(1),kS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function qde(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13),ES(4,"line",13),ES(5,"line",13),_S()),2&e){var n=MS(2).index,r=MS().index,i=MS();LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Wde(e,t){if(1&e&&(AC(),ES(0,"polyline",16)),2&e){var n=MS(3).index,r=MS().index;kS("ngClass",MS().viewInfo.pieceClasses[r][n])}}function jde(e,t){if(1&e&&(AC(),ES(0,"line",13),ES(1,"line",13),ES(2,"line",13),ES(3,"line",13)),2&e){var n=MS(3).index,r=MS().index,i=MS();kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),LE(1),kS("ngClass",i.viewInfo.pieceClasses[r][n]),fS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Yde(e,t){if(1&e&&(AC(),gS(0,Wde,1,1,"polyline",14),gS(1,jde,4,20,"ng-template",null,15,JT)),2&e){var n=yS(2),r=MS(2).index,i=MS().index;kS("ngIf",MS().isKing(r,i))("ngIfElse",n)}}function Kde(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",10),gS(2,qde,6,25,"g",11),gS(3,Yde,3,2,"ng-template",null,12,JT),_S()),2&e){var n=yS(4),r=MS().index,i=MS().index,a=MS();LE(1),DS("id","piece_",r,"_",i,""),kS("ngClass",a.viewInfo.pieceClasses[i][r]),fS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),LE(1),kS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Qde(e,t){if(1&e){var n=PS();AC(),wS(0,"g",3),IS("click",function(){var e=tC(n).index,t=MS().index;return MS().onClick(e,t)}),ES(1,"rect",4),gS(2,Zde,4,2,"g",5),gS(3,Kde,5,8,"g",5),_S()}if(2&e){var r=t.index,i=MS().index,a=MS();DS("id","click_",r,"_",i,""),fS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),LE(1),kS("ngClass",a.getRectClasses(r,i)),fS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),LE(1),kS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),LE(1),kS("ngIf",a.board[i][r]!==a.EMPTY)}}function Xde(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Qde,4,8,"g",2),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Jde(e,t){if(1&e){var n=PS();AC(),wS(0,"g"),wS(1,"rect",17),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e.x,e.y)}),_S(),_S()}if(2&e){var r=t.$implicit,i=MS();LE(1),DS("id","click_",r.x,"_",r.y,""),fS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var eve=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e,!1,Nde.from)).rules=Fde.get(),r.availableMinimaxes=[new Zne(r.rules,"DummyBot"),new Yne(r.rules,"Piece > Influence"),new Kne(r.rules,"Piece > Control"),new Qne(r.rules,"Escape > Piece > Control")],r.encoder=Nde.encoder,r.tutorial=(new Hde).tutorial,r.updateBoard(),r}return vy(n)}($ne);return e.\u0275fac=function(t){return new(t||e)(mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["app-tablut"]],features:[Xb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,Xde,2,1,"g",1),gS(2,Jde,2,6,"g",1),_S()),2&e&&(fS("viewBox",t.getViewBox()),LE(1),kS("ngForOf",t.board),LE(1),kS("ngForOf",t.getClickables()))},directives:[rR,tR,aR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),tve=vy(function e(){hy(this,e)});tve.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Tf||(Tf=Gg(["You cannot put a new ring after the tenth turn."])))},tve.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(If||(If=Gg(["You cannot put a marker in a ring before placing all of your rings."])))},tve.MISSING_CAPTURES=eoe.MISSING_CAPTURES,tve.MOVE_DIRECTION_INVALID=function(){return $localize(Af||(Af=Gg(["The direction of your move is invalid: a move is made along a straight line."])))},tve.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Rf||(Rf=Gg(["You can only capture your own markers."])))},tve.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Mf||(Mf=Gg(["You must pick one of your own rings to move."])))},tve.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(xf||(xf=Gg(["Your ring must land on an empty space."])))},tve.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(Nf||(Nf=Gg(["A ring can only jump over markers or empty spaces, not over another ring."])))},tve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Df||(Df=Gg(["Your ring must land on the first empty space after a group of markers."])))},tve.AMBIGUOUS_CAPTURE_COORD=eoe.AMBIGUOUS_CAPTURE_COORD,tve.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Lf||(Lf=Gg(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var nve=function(){function e(t,n){hy(this,e),this.player=t,this.isRing=n}return vy(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return D7(!1===this.isRing,"cannot flip a ring (it should never happen)"),D7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return OB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===Q7.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();nve.encoder=Y7.tuple([X7.numberEncoder,Y7.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return nve.of(e[0],e[1])}),nve.UNREACHABLE=new nve(Q7.NONE,!1),nve.EMPTY=new nve(Q7.NONE,!1),nve.MARKER_ZERO=new nve(X7.ZERO,!1),nve.MARKER_ONE=new nve(X7.ONE,!1),nve.MARKERS=[nve.MARKER_ZERO,nve.MARKER_ONE],nve.RING_ZERO=new nve(X7.ZERO,!0),nve.RING_ONE=new nve(X7.ONE,!0),nve.RINGS=[nve.RING_ZERO,nve.RING_ONE];var rve=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i){var a;return hy(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],nve.EMPTY)).sideRings=r,a}return vy(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&n9.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==nve.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=n9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=nve.EMPTY,t=nve.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(Nie);return e.SIZE=11,e}(),ive=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;if(hy(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=MB.ofNullable(r),ry(i)}return vy(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===Xg(oy(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=gte.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Kae);ive.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return hte.encoder.encode(e)}),ringTaken:hte.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new ive(t.captured.map(function(e){return hte.encoder.decode(e)}),hte.encoder.decode(t.ringTaken))}}]),n}(W7));var ave=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a){var o;return hy(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return vy(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===n9.compareArray(this.initialCaptures,e.initialCaptures)||!1===n9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(Ite);ave.coordOptionalEncoder=Yae(hte.encoder),ave.encoder=new(function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"encodeMove",value:function(e){var t={moveStart:hte.encoder.encode(e.start),moveEnd:ave.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=ive.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=ive.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.moveStart,"Invalid encoded YinshMove"),new ave(this.decodeArray(t,"initialCapture",ive.encoder.decode),hte.encoder.decode(t.moveStart),ave.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",ive.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(j7));var ove=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?Ete.fromWinner(t.winner):new Ete(e.gameState.sideRings[0]*X7.ZERO.getScoreModifier()+e.gameState.sideRings[1]*X7.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=cy(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Wg(i.value,2),s=o[0];o[1]===nve.EMPTY&&n.push(new ave([],s,MB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new ave(e,r.start,MB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return noe.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){hy(this,e)}return vy(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return D7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=cy(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new ive(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=cy(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=cy(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===nve.RINGS[t]&&n.push(e)}),n}}]),n}(_te),sve=function(e){ey(n,e);var t=ny(n);function n(){return hy(this,n),t.apply(this,arguments)}return vy(n,[{key:"applyLegalMove",value:function(e,t,n){return new rve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new rve(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,nve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new rve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,nve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===nve.RINGS[n]?LB.SUCCESS:LB.failure(tve.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,nve.MARKERS[r]);i=i.setAt(t,nve.RINGS[r]);for(var a=gte.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==nve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return xB.failure(tve.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():xB.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return xB.failure(tve.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==nve.EMPTY)return xB.failure(wte.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,nve.of(n,!0)).board,a=new rve(i,r,e.turn);return xB.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==nve.RINGS[n]?LB.failure(tve.SHOULD_SELECT_PLAYER_RING()):LB.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==nve.EMPTY)return LB.failure(tve.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=gte.factory.fromMove(t,n);if(i.isFailure())return LB.failure(tve.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===nve.EMPTY){if(o)return LB.failure(tve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return LB.failure(tve.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return LB.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return LB.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=cy(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==nve.MARKERS[r])return LB.failure(tve.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==nve.RINGS[r]?LB.failure(tve.CAPTURE_SHOULD_TAKE_RING()):LB.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?LB.SUCCESS:LB.failure(tve.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?MB.of({start:s,end:r,dir:o}):MB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(ive.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=cy(gte.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===nve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Fte.ONGOING:e.gameState.sideRings[0]>=3?Fte.ZERO_WON:e.gameState.sideRings[1]>=3?Fte.ONE_WON:Fte.ONGOING}}]),n}(Ute),uve=nve.EMPTY,cve=nve.UNREACHABLE,lve=nve.MARKER_ZERO,fve=nve.RING_ZERO,hve=nve.MARKER_ONE,dve=nve.RING_ONE,vve=function(){var e=vy(function e(){hy(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Ff||(Ff=Gg(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Uf||(Uf=Gg(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),pve=vy(function e(){hy(this,e),this.tutorial=[Hte.informational($localize(Vf||(Vf=Gg(["Goal of the game"]))),$localize(Bf||(Bf=Gg(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new rve([[cve,cve,cve,cve,cve,cve,uve,uve,uve,uve,cve],[cve,cve,cve,cve,uve,uve,uve,uve,uve,uve,uve],[cve,cve,cve,lve,dve,uve,uve,uve,uve,uve,uve],[cve,cve,uve,lve,uve,dve,uve,hve,uve,uve,uve],[cve,uve,fve,hve,uve,uve,dve,lve,uve,uve,uve],[cve,uve,uve,lve,hve,uve,uve,uve,uve,uve,cve],[uve,uve,uve,lve,uve,uve,uve,dve,uve,uve,cve],[uve,uve,uve,hve,lve,fve,uve,uve,uve,cve,cve],[uve,uve,uve,uve,uve,uve,uve,uve,cve,cve,cve],[uve,uve,uve,uve,uve,uve,uve,cve,cve,cve,cve],[cve,uve,uve,uve,uve,cve,cve,cve,cve,cve,cve]],[3,1],20)),Hte.anyMove($localize(zf||(zf=Gg(["Initial board and placement phase"]))),$localize(Hf||(Hf=Gg(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new rve(rve.getInitialState().board,[5,5],0),new ave([],new hte(5,5),MB.empty(),[]),$localize(Gf||(Gf=Gg(["Congratulations!"])))),Hte.anyMove($localize($f||($f=Gg(["Putting a marker"]))),$localize(Zf||(Zf=Gg(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new rve([[cve,cve,cve,cve,cve,cve,uve,uve,uve,uve,cve],[cve,cve,cve,cve,uve,uve,uve,uve,uve,uve,uve],[cve,cve,cve,dve,uve,uve,uve,uve,uve,uve,uve],[cve,cve,dve,uve,uve,dve,uve,uve,uve,uve,uve],[cve,uve,fve,hve,uve,uve,dve,uve,uve,uve,uve],[cve,uve,uve,hve,uve,uve,uve,uve,uve,uve,cve],[uve,uve,uve,uve,fve,uve,uve,dve,uve,uve,cve],[uve,uve,uve,uve,uve,fve,uve,uve,uve,cve,cve],[uve,uve,uve,fve,uve,uve,uve,cve,cve,cve,cve],[uve,uve,uve,uve,uve,uve,uve,cve,cve,cve,cve],[cve,uve,uve,uve,uve,cve,cve,cve,cve,cve,cve]],[0,0],20),new ave([],new hte(2,4),MB.of(new hte(4,4)),[]),$localize(qf||(qf=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Wf||(Wf=Gg(["Getting a ring by aligning 5 markers"]))),$localize(jf||(jf=Gg(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new rve([[cve,cve,cve,cve,cve,cve,uve,uve,uve,uve,cve],[cve,cve,cve,cve,uve,uve,uve,uve,uve,uve,uve],[cve,cve,cve,dve,uve,uve,uve,uve,uve,uve,uve],[cve,cve,dve,uve,uve,dve,uve,uve,uve,uve,uve],[cve,uve,lve,lve,fve,hve,hve,uve,uve,uve,uve],[cve,uve,uve,dve,uve,uve,uve,uve,uve,uve,cve],[uve,uve,uve,uve,fve,uve,uve,dve,uve,uve,cve],[uve,uve,uve,uve,uve,fve,uve,uve,uve,cve,cve],[uve,uve,uve,fve,uve,uve,uve,fve,cve,cve,cve],[uve,uve,uve,uve,uve,uve,uve,cve,cve,cve,cve],[cve,uve,uve,uve,uve,cve,cve,cve,cve,cve,cve]],[0,0],20),new ave([],new hte(4,4),MB.of(new hte(7,4)),[ive.of(new hte(2,4),new hte(6,4),new hte(7,4))]),function(e,t,n){return 1===n.sideRings[X7.ZERO.value]?LB.SUCCESS:LB.failure(vve.MUST_ALIGN_FIVE())},$localize(Yf||(Yf=Gg(["Congratulations!"])))),Hte.fromPredicate($localize(Kf||(Kf=Gg(["Compound captures"]))),$localize(Qf||(Qf=Gg(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new rve([[cve,cve,cve,cve,cve,cve,uve,uve,uve,uve,cve],[cve,cve,cve,cve,fve,uve,uve,dve,dve,fve,uve],[cve,cve,cve,fve,uve,uve,hve,dve,uve,fve,uve],[cve,cve,uve,fve,uve,uve,uve,uve,uve,dve,uve],[cve,uve,uve,uve,uve,lve,uve,uve,dve,uve,uve],[cve,uve,uve,uve,lve,lve,uve,hve,uve,uve,cve],[uve,uve,uve,lve,uve,lve,uve,uve,uve,uve,cve],[uve,uve,lve,uve,uve,lve,uve,uve,uve,cve,cve],[uve,lve,uve,uve,uve,lve,uve,uve,cve,cve,cve],[uve,uve,uve,uve,uve,lve,uve,cve,cve,cve,cve],[cve,uve,uve,uve,uve,cve,cve,cve,cve,cve,cve]],[0,0],10),new ave([ive.of(new hte(5,4),new hte(1,8),new hte(3,2)),ive.of(new hte(5,9),new hte(5,5),new hte(3,3))],new hte(4,1),MB.of(new hte(4,2)),[]),function(e,t,n){return 2===n.sideRings[X7.ZERO.value]?LB.SUCCESS:LB.failure(vve.MUST_CAPTURE_TWO())},$localize(Xf||(Xf=Gg(["Congratulations!"]))))]});function gve(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=MS(2).$implicit,r=MS(2);fS("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function yve(e,t){if(1&e&&(AC(),ES(0,"circle",13)),2&e){var n=MS(2),r=n.index,i=n.$implicit,a=MS().index,o=MS();DS("id","ring_",r,"_",a,""),kS("ngClass",i.ringClasses),fS("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function mve(e,t){if(1&e&&(AC(),ES(0,"circle",12)),2&e){var n=MS(2).$implicit,r=MS(2);fS("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function kve(e,t){if(1&e&&(AC(),ES(0,"circle",14)),2&e){var n=MS(2),r=n.index,i=n.$implicit,a=MS().index,o=MS();DS("id","marker_",r,"_",a,""),kS("ngClass",i.markerClasses),fS("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Cve(e,t){if(1&e){var n=PS();AC(),wS(0,"g",6),IS("click",function(){tC(n);var e=MS().$implicit;return MS(2).onClick(e.coord)}),ES(1,"polygon",7),wS(2,"g",8),gS(3,gve,1,3,"circle",9),gS(4,yve,1,6,"circle",10),gS(5,mve,1,3,"circle",9),gS(6,kve,1,6,"circle",11),_S(),_S()}if(2&e){var r=MS(),i=r.index,a=r.$implicit,o=MS().index;DS("id","click_",i,"_",o,""),LE(1),DS("id","space_",i,"_",o,""),kS("ngClass",a.spaceClasses),fS("points",a.coordinates),LE(1),DS("id","pieceGroup_",i,"_",o,""),kS("ngClass",a.removedClass),LE(1),kS("ngIf",a.isRing),LE(1),kS("ngIf",a.isRing),LE(1),kS("ngIf",a.isRing),LE(1),kS("ngIf",a.isMarker)}}function wve(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Cve,7,13,"g",5),_S()),2&e){var n=t.$implicit;LE(1),kS("ngIf",null!=n)}}function _ve(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,wve,2,1,"g",1),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}function Eve(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",15),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","selected_",r.x,"_",r.y,""),fS("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function bve(e,t){if(1&e){var n=PS();AC(),wS(0,"polygon",17),IS("click",function(){var e=tC(n).$implicit;return MS(2).onClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS(2);DS("id","selectable_",r.x,"_",r.y,""),fS("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Sve(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,bve,1,3,"polygon",16),_S()),2&e){var n=MS();LE(1),kS("ngForOf",n.viewInfo.selectableCoords)}}function Pve(e,t){if(1&e){var n=PS();AC(),wS(0,"rect",18),IS("click",function(){var e=tC(n).$implicit;return MS().onClick(e)}),_S()}if(2&e){var r=t.$implicit,i=MS();DS("id","indicator_",r.x,"_",r.y,""),fS("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Ove(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",19),ES(2,"circle",12),ES(3,"circle",20),_S()),2&e){var n=t.index,r=MS().$implicit,i=MS();LE(1),DS("id","player_",r.value,"_sideRing_",n+1,""),fS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringOuterSize),LE(1),fS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringInnerSize),LE(1),kS("ngClass",i.viewInfo.sideRingClass[r.value]),fS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringMidSize)}}var Tve=function(){return[]};function Ive(e,t){if(1&e&&(AC(),wS(0,"g"),gS(1,Ove,4,12,"g",1),_S()),2&e){var n=t.$implicit,r=MS();fS("transform","rotate("+180*r.role.value+" 532.5 780)"),LE(1),kS("ngForOf",PT(2,Tve).constructor(r.viewInfo.sideRings[n.value]))}}var Ave=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=MB.empty(),r.moveEnd=MB.empty(),r.currentlyMoved=[],r.currentCapture=MB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=MB.of([0,0]),r.rules=new sve(rve),r.availableMinimaxes=[new ove(r.rules,"YinshMinimax")],r.encoder=ave.encoder,r.tutorial=(new pve).tutorial,r.hexaLayout=new yte(1.5*n.RING_OUTER_SIZE,new hte(2*n.RING_OUTER_SIZE,0),Cte.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return vy(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=MB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=cy(X7.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=cy(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=cy(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=cy(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=cy(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==nve.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=MB.empty(),this.moveStart=MB.empty(),this.moveEnd=MB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=cy(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=gte.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==nve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=cy(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),LB.SUCCESS}},{key:"onClick",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(tve.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",LB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=cy(e);try{for(n.s();!(t=n.n()).done;){var r,i=cy(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(OB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(tve.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(tve.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=MB.of(e),this.constructedState=new rve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(D7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),LB.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=cy(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,nve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,nve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=MB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),LB.SUCCESS)):(OB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),LB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),LB.SUCCESS}},{key:"tryMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new ave(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=MB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=MB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",LB.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.moveStart.equalsValue(e)){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),LB.SUCCESS));case 2:if(r=nve.RINGS[t.getState().getCurrentPlayer().value],t.constructedState.getPieceAt(e)!==r){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),t.selectMoveStart(e)));case 5:return i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=MB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 7:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),LB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(vte);function Rve(e,t){if(1&e&&(wS(0,"option",5),iP(1),_S()),2&e){var n=t.$implicit;kS("value",n.urlName),LE(1),aP(n.name)}}Ave.RING_OUTER_SIZE=40,Ave.RING_MID_SIZE=34,Ave.RING_INNER_SIZE=28,Ave.MARKER_SIZE=Ave.RING_INNER_SIZE,Ave.INDICATOR_SIZE=10,Ave.\u0275fac=function(e){return new(e||Ave)(mS(x7))},Ave.\u0275cmp=lk({type:Ave,selectors:[["app-yinsh"]],features:[Xb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["class","base no-fill capturable","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(AC(),wS(0,"svg",0),gS(1,_ve,2,1,"g",1),gS(2,Eve,1,3,"polygon",2),gS(3,Sve,2,1,"g",3),gS(4,Pve,1,6,"rect",4),gS(5,Ive,2,3,"g",1),_S()),2&e&&(LE(1),kS("ngForOf",t.viewInfo.spaceInfo),LE(1),kS("ngForOf",t.viewInfo.selectedCoords),LE(1),kS("ngIf",t.isPlayerTurn()),LE(1),kS("ngForOf",t.viewInfo.targets),LE(1),kS("ngForOf",t.Player.PLAYERS))},directives:[rR,aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Mve=function(){var e=vy(function e(){hy(this,e)});return e.ABALONE=function(){return $localize(Jf||(Jf=Gg(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(eh||(eh=Gg(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(th||(th=Gg(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(nh||(nh=Gg(["The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.COERCEO=function(){return $localize(rh||(rh=Gg(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(ih||(ih=Gg(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(ah||(ah=Gg(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(oh||(oh=Gg(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(sh||(sh=Gg(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(uh||(uh=Gg(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(ch||(ch=Gg(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(lh||(lh=Gg(["The oldest strategy game still practiced widely. A territory control game."])))},e.HNEFATAFL=function(){return $localize(fh||(fh=Gg(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.KAMISADO=function(){return $localize(hh||(hh=Gg(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(dh||(dh=Gg(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(vh||(vh=Gg(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(ph||(ph=Gg(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(gh||(gh=Gg(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(yh||(yh=Gg(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(mh||(mh=Gg(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(kh||(kh=Gg(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(Ch||(Ch=Gg(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(wh||(wh=Gg(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(_h||(_h=Gg(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(Eh||(Eh=Gg(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(bh||(bh=Gg(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(Sh||(Sh=Gg(["Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(Ph||(Ph=Gg(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),xve=function(){var e=vy(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];hy(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",xce,new Date("1970-01-01"),"",!1),new e($localize(Oh||(Oh=Gg(["Four in a Row"]))),"P4",jce,new Date("2018-08-28"),Mve.P4()),new e($localize(Th||(Th=Gg(["Awal\xe9"]))),"Awale",Mne,new Date("2018-11-29"),Mve.AWALE()),new e($localize(Ih||(Ih=Gg(["Quarto"]))),"Quarto",Afe,new Date("2018-12-09"),Mve.QUARTO()),new e($localize(Ah||(Ah=Gg(["Tablut"]))),"Tablut",eve,new Date("2018-12-27"),Mve.TABLUT()),new e($localize(Rh||(Rh=Gg(["Reversi"]))),"Reversi",ahe,new Date("2019-01-16"),Mve.REVERSI()),new e($localize(Mh||(Mh=Gg(["Go"]))),"Go",Zoe,new Date("2019-12-21"),Mve.GO()),new e($localize(xh||(xh=Gg(["Encapsule"]))),"Encapsule",Mae,new Date("2019-12-30"),Mve.ENCAPSULE()),new e($localize(Nh||(Nh=Gg(["Siam"]))),"Siam",lde,new Date("2020-01-11"),Mve.SIAM()),new e($localize(Dh||(Dh=Gg(["Sahara"]))),"Sahara",Ohe,new Date("2020-02-29"),Mve.SAHARA()),new e($localize(Lh||(Lh=Gg(["Pylos"]))),"Pylos",Vle,new Date("2020-10-02"),Mve.PYLOS()),new e($localize(Fh||(Fh=Gg(["Kamisado"]))),"Kamisado",Wse,new Date("2020-10-03"),Mve.KAMISADO()),new e($localize(Uh||(Uh=Gg(["Quixo"]))),"Quixo",Zfe,new Date("2020-10-15"),Mve.QUIXO()),new e($localize(Vh||(Vh=Gg(["Dvonn"]))),"Dvonn",uae,new Date("2020-10-21"),Mve.DVONN()),new e($localize(Bh||(Bh=Gg(["Epaminondas"]))),"Epaminondas",jae,new Date("2021-01-16"),Mve.EPAMINONDAS()),new e($localize(zh||(zh=Gg(["Gipf"]))),"Gipf",yoe,new Date("2021-02-22"),Mve.GIPF()),new e($localize(Hh||(Hh=Gg(["Coerceo"]))),"Coerceo",Gre,new Date("2021-03-21"),Mve.COERCEO()),new e($localize(Gh||(Gh=Gg(["Six"]))),"Six",xde,new Date("2021-04-08"),Mve.SIX()),new e($localize($h||($h=Gg(["Lines of Action"]))),"LinesOfAction",sue,new Date("2021-04-28"),Mve.LINES_OF_ACTION()),new e($localize(Zh||(Zh=Gg(["Pentago"]))),"Pentago",vle,new Date("2021-05-23"),Mve.PENTAGO()),new e($localize(qh||(qh=Gg(["Abalone"]))),"Abalone",sne,new Date("2021-07-13"),Mve.ABALONE()),new e($localize(Wh||(Wh=Gg(["Yinsh"]))),"Yinsh",Ave,new Date("2021-07-31"),Mve.YINSH()),new e($localize(jh||(jh=Gg(["Apagos"]))),"Apagos",_ne,new Date("2021-11-04"),Mve.APAGOS()),new e($localize(Yh||(Yh=Gg(["Diam"]))),"Diam",Mie,new Date("2021-11-30"),Mve.DIAM()),new e($localize(Kh||(Kh=Gg(["Brandhub"]))),"Brandhub",vre,new Date("2021-12-07"),Mve.BRANDHUB()),new e($localize(Qh||(Qh=Gg(["Conspirateurs"]))),"Conspirateurs",lie,new Date("2021-12-30"),Mve.CONSPIRATEURS()),new e($localize(Xh||(Xh=Gg(["Lodestone"]))),"Lodestone",Bue,new Date("2022-06-24"),Mve.LODESTONE()),new e($localize(Jh||(Jh=Gg(["Martian Chess"]))),"MartianChess",_ce,new Date("2022-07-01"),Mve.MARTIAN_CHESS()),new e($localize(ed||(ed=Gg(["Hnefatafl"]))),"Hnefatafl",hse,new Date("2022-09-21"),Mve.HNEFATAFL())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),Nve=function(){var e=function(){function e(){hy(this,e),this.games=xve.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new FT}return vy(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=lk({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(td||(td=Gg(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"select",1),IS("change",function(e){return t.onChange(e)}),wS(2,"option",2),hO(3,3),_S(),gS(4,Rve,2,2,"option",4),_S(),_S()),2&e&&(LE(4),kS("ngForOf",t.games))},directives:[Ox,Rx,rR],encapsulation:2}),e}();function Dve(e,t){if(1&e){var n=PS();wS(0,"div",26),wS(1,"div",27),IS("click",function(){return tC(n),MS().closeInfo()}),_S(),wS(2,"div",28),wS(3,"header",29),wS(4,"p",30),iP(5),_S(),wS(6,"button",31),IS("click",function(){return tC(n),MS().closeInfo()}),_S(),_S(),wS(7,"section",32),wS(8,"div",6),wS(9,"div",33),wS(10,"p",34),ES(11,"img",35),_S(),_S(),wS(12,"div",7),wS(13,"div",13),iP(14),_S(),_S(),_S(),wS(15,"div",6),wS(16,"div",33),wS(17,"a",36),IS("click",function(){tC(n);var e=MS();return e.createGame(e.gameInfoDetails.get().urlName)}),ES(18,"fa-icon",37),iP(19,"\xa0"),wS(20,"span"),hO(21,38),_S(),_S(),_S(),wS(22,"div",33),wS(23,"a",36),IS("click",function(){tC(n);var e=MS();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),ES(24,"fa-icon",37),iP(25,"\xa0"),wS(26,"span"),hO(27,39),_S(),_S(),_S(),wS(28,"div",33),wS(29,"a",36),IS("click",function(){tC(n);var e=MS();return e.createTutorial(e.gameInfoDetails.get().urlName)}),ES(30,"fa-icon",37),iP(31,"\xa0"),wS(32,"span"),hO(33,40),_S(),_S(),_S(),_S(),_S(),_S(),_S()}if(2&e){var r=MS();LE(5),aP(r.gameInfoDetails.get().name),LE(6),DS("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",I_),LE(3),oP(" ",r.gameInfoDetails.get().description," "),LE(4),kS("icon",r.iconOnlineGame),LE(6),kS("icon",r.iconLocalGame),LE(6),kS("icon",r.iconTutorial)}}function Lve(e,t){if(1&e){var n=PS();wS(0,"div",8),wS(1,"div",9),wS(2,"p",10),iP(3),_S(),_S(),wS(4,"div",42),wS(5,"figure",34),wS(6,"img",43),IS("click",function(){var e=tC(n).$implicit;return MS(2).openInfo(e)}),_S(),wS(7,"figcaption",44),IS("click",function(){var e=tC(n).$implicit;return MS(2).openInfo(e)}),wS(8,"div",45),iP(9,"?"),_S(),_S(),wS(10,"figcaption",46),wS(11,"a",47),IS("click",function(){var e=tC(n).$implicit;return MS(2).createGame(e.urlName)}),ES(12,"fa-icon",37),_S(),wS(13,"a",48),IS("click",function(){var e=tC(n).$implicit;return MS(2).createLocalGame(e.urlName)}),ES(14,"fa-icon",37),_S(),wS(15,"a",49),IS("click",function(){var e=tC(n).$implicit;return MS(2).createTutorial(e.urlName)}),ES(16,"fa-icon",37),_S(),_S(),_S(),_S(),wS(17,"div",50),iP(18),_S(),_S()}if(2&e){var r=t.$implicit,i=MS(2);LE(3),aP(r.name),LE(3),NS("id","image_",r.urlName,""),DS("src","assets/images/",i.theme,"/",r.urlName,".png",I_),LE(5),NS("id","playOnline_",r.urlName,""),LE(1),kS("icon",i.iconOnlineGame),LE(1),NS("id","playLocally_",r.urlName,""),LE(1),kS("icon",i.iconLocalGame),LE(1),NS("id","startTutorial_",r.urlName,""),LE(1),kS("icon",i.iconTutorial),LE(2),oP(" ",r.description," ")}}function Fve(e,t){if(1&e&&(wS(0,"div",7),gS(1,Lve,19,11,"div",41),_S()),2&e){var n=t.$implicit;LE(1),kS("ngForOf",n)}}var Uve=function(){var e=function(){function e(t,n){hy(this,e),this.router=t,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=m9,this.iconLocalGame=g9,this.iconTutorial=v9,this.gameInfoDetails=MB.empty(),this.theme=n.getTheme();for(var r=xve.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return vy(e,[{key:"createGame",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=MB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=MB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(d9))},e.\u0275cmp=lk({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(nd||(nd=Gg(["EveryBoard"]))),[1,"subtitle"],$localize(rd||(rd=Gg(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(id||(id=Gg(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(ad||(ad=Gg(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(od||(od=Gg(["See the game list"]))),$localize(sd||(sd=Gg(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(ud||(ud=Gg(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(cd||(cd=Gg(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(ld||(ld=Gg(["Play online"]))),$localize(fd||(fd=Gg(["Play offline"]))),$localize(hd||(hd=Gg(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(dd||(dd=Gg(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(vd||(vd=Gg(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(pd||(pd=Gg(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(wS(0,"section",0),wS(1,"div",1),wS(2,"p",2),hO(3,3),_S(),wS(4,"p",4),lO(5,5),ES(6,"br"),fO(),_S(),_S(),wS(7,"div",6),wS(8,"div",7),wS(9,"div",8),wS(10,"header",9),wS(11,"p",10),hO(12,11),_S(),_S(),wS(13,"div",12),wS(14,"div",13),wS(15,"button",14),hO(16,15),_S(),wS(17,"button",16),hO(18,17),_S(),_S(),_S(),_S(),_S(),wS(19,"div",7),wS(20,"div",8),wS(21,"header",9),wS(22,"p",10),hO(23,18),_S(),_S(),wS(24,"div",12),wS(25,"div",19),wS(26,"button",20),hO(27,21),_S(),wS(28,"button",22),hO(29,23),_S(),_S(),_S(),_S(),_S(),_S(),gS(30,Dve,34,7,"div",24),wS(31,"div",6),gS(32,Fve,2,1,"div",25),_S(),_S()),2&e&&(LE(30),kS("ngIf",t.gameInfoDetails.isPresent()),LE(2),kS("ngForOf",t.games))},directives:[yF,aR,rR,$ee],encapsulation:2}),e}(),Vve=function(){var e=function(){function e(t){hy(this,e),this.element=t}return vy(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(IO))},e.\u0275dir=gk({type:e,selectors:[["","autofocus",""]]}),e}(),Bve=function(){var e=function(){function e(t){var n=this;hy(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return vy(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(IO))},e.\u0275dir=gk({type:e,selectors:[["","toggleVisibility",""]]}),e}();function zve(e,t){if(1&e&&(wS(0,"div",29),wS(1,"div",30),hO(2,31),_S(),wS(3,"div",32),iP(4),_S(),_S()),2&e){var n=MS();LE(4),aP(n.errorMessage)}}var Hve=function(){return["/register"]},Gve=function(){return["/reset-password"]},$ve=function(){var e=function(){function e(t,n){hy(this,e),this.router=t,this.connectedUserService=n,this.faEye=y9,this.loginForm=new sx({email:new ox,password:new ox})}return vy(e,[{key:"ngOnInit",value:function(){var e,t=this;this.userSubscription=this.connectedUserService.subscribeToUser((e=PB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==B7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(z7))},e.\u0275cmp=lk({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(gd||(gd=Gg(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(yd||(yd=Gg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(md||(md=Gg(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(kd||(kd=Gg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(Cd||(Cd=Gg(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(wd||(wd=Gg(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(_d||(_d=Gg(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(Ed||(Ed=Gg(["No account?"]))),[3,"routerLink"],$localize(bd||(bd=Gg(["Register"]))),$localize(Sd||(Sd=Gg(["Forgot your password?"]))),$localize(Pd||(Pd=Gg(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Od||(Od=Gg(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"p",1),hO(2,2),_S(),wS(3,"form",3),wS(4,"div",4),wS(5,"div",5),wS(6,"label",6),hO(7,7),_S(),_S(),wS(8,"div",8),wS(9,"div",9),wS(10,"div",10),ES(11,"input",11),_S(),_S(),_S(),_S(),wS(12,"div",4),wS(13,"div",5),wS(14,"label",12),hO(15,13),_S(),_S(),wS(16,"div",8),wS(17,"div",9),wS(18,"div",14),ES(19,"input",15),wS(20,"span",16),ES(21,"fa-icon",17),_S(),_S(),_S(),_S(),_S(),wS(22,"div",4),ES(23,"div",5),wS(24,"div",8),wS(25,"div",9),wS(26,"div",10),wS(27,"button",18),IS("click",function(){return t.loginWithEmail(t.loginForm.value)}),hO(28,19),_S(),_S(),_S(),_S(),_S(),wS(29,"div",4),ES(30,"div",5),wS(31,"div",8),wS(32,"div",9),wS(33,"div",10),wS(34,"button",20),IS("click",function(){return t.loginWithGoogle()}),hO(35,21),_S(),_S(),_S(),_S(),_S(),gS(36,zve,5,1,"div",22),wS(37,"p",23),bS(38),hO(39,24),SS(),iP(40,"\xa0 "),wS(41,"a",25),hO(42,26),_S(),_S(),wS(43,"p",23),bS(44),hO(45,27),SS(),iP(46,"\xa0 "),wS(47,"a",25),hO(48,28),_S(),_S(),_S(),_S()),2&e&&(LE(3),kS("formGroup",t.loginForm),LE(18),kS("icon",t.faEye),LE(6),kS("disabled",!t.canLogin()),LE(9),kS("ngIf",t.errorMessage),LE(5),kS("routerLink",PT(6,Hve)),LE(6),kS("routerLink",PT(7,Gve)))},directives:[px,FM,wx,oM,LM,Ex,Vve,xx,$ee,Bve,aR,mF],encapsulation:2}),e}(),Zve=function(){var e=function(){function e(t){hy(this,e),this.userDAO=t}return vy(e,[{key:"subscribeToActiveUsers",value:function(t){var n=this;TB(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");var r=[],i=new i9(function(i){var a;TB(e.VERBOSE,"our DAO gave us "+i.length+" new user(s)"),r=n.sort((a=r).concat.apply(a,sy(i))),t(r)},function(i){var a=r;TB(e.VERBOSE,"our DAO updated "+i.length+" user(s)");var o,s=cy(i);try{var u=function(){var e=o.value;a.forEach(function(t){t.id===e.id&&(t.data=e.data)}),a=n.sort(a)};for(s.s();!(o=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}t(r=a)},function(e){r=r.filter(function(t){return!e.some(function(e){return e.id===t.id})}),t(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],i)}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=OB.getNonNullable(e.data).lastUpdateTime,r=OB.getNonNullable(n).seconds,i=OB.getNonNullable(t.data).lastUpdateTime;return r-OB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Lw(L7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),qve=function(){var e=function(){function e(t){hy(this,e),this.partDAO=t}return vy(e,[{key:"subscribeToActiveParts",value:function(e){var t=[],n=new i9(function(n){var r;t=(r=t).concat.apply(r,sy(n)),e(t)},function(n){var r,i=t,a=cy(n);try{var o=function(){var e=r.value;i.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)},function(n){var r,i=[],a=cy(t);try{var o=function(){var e=r.value;n.some(function(t){return t.id===e.id})||i.push(e)};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)});return this.partDAO.observingWhere([["result","==",H7.UNACHIEVED.value]],n)}},{key:"userHasActivePart",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.partDAO.findWhere([["playerZero","==",e],["result","==",H7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.partDAO.findWhere([["playerOne","==",e],["result","==",H7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(r9))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),Wve=function(){var e=function(){function e(t){hy(this,e),this.router=t}return vy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF))},e.\u0275cmp=lk({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Td||(Td=Gg(["Create an online game"])))]},template:function(e,t){1&e&&(wS(0,"app-pick-game",0),IS("pickGame",function(e){return t.pickGame(e)}),_S(),wS(1,"button",1),IS("click",function(){return t.navigateToOnlineGameCreation()}),hO(2,2),_S()),2&e&&(LE(1),kS("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),jve=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"transform",value:function(e){return LA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=yk({name:"firebaseDate",type:e,pure:!0}),e}(),Yve=["chatDiv"];function Kve(e,t){1&e&&(bS(0),hO(1,5),SS())}function Qve(e,t){1&e&&hO(0,6),2&e&&(dO(MS().unreadMessagesText),vO(0))}function Xve(e,t){if(1&e){var n=PS();wS(0,"button",11),IS("click",function(){return tC(n),MS(2).scrollToBottom()}),iP(1),_S()}if(2&e){var r=MS(2);LE(1),oP("",r.unreadMessagesText," \u2193")}}function Jve(e,t){if(1&e&&(wS(0,"p"),iP(1),MT(2,"firebaseDate"),wS(3,"b",12),iP(4),_S(),wS(5,"span",13),iP(6),_S(),_S()),2&e){var n=t.$implicit;LE(1),oP(" [",xT(2,3,n.postedTime),"] "),LE(3),oP("",n.sender.name," : "),LE(2),aP(n.content)}}function epe(e,t){if(1&e){var n=PS();wS(0,"div"),gS(1,Xve,2,1,"button",7),wS(2,"div",8,9),IS("scroll",function(){return tC(n),MS().updateCurrentScrollPosition()}),gS(4,Jve,7,5,"p",10),_S(),_S()}if(2&e){var r=MS();LE(1),kS("ngIf",r.showUnreadMessagesButton),LE(3),kS("ngForOf",r.chat)}}var tpe=function(){return{standalone:!0}};function npe(e,t){if(1&e){var n=PS();wS(0,"form",14),IS("onSubmit",function(){return tC(n),MS().sendMessage()}),wS(1,"div",15),wS(2,"div",16),wS(3,"input",17,18),IS("ngModelChange",function(e){return tC(n),MS().userMessage=e}),_S(),wS(5,"p",19),iP(6),_S(),_S(),wS(7,"div",20),wS(8,"button",21),IS("click",function(){return tC(n),MS().sendMessage()}),ES(9,"fa-icon",22),_S(),_S(),_S(),wS(10,"div",23),wS(11,"p"),wS(12,"strong"),hO(13,24),_S(),_S(),_S(),_S()}if(2&e){var r=yS(4),i=MS();LE(3),kS("ngModel",i.userMessage)("ngModelOptions",PT(4,tpe)),LE(3),oP("",r.value.length,"/128"),LE(3),kS("icon",i.faReply)}}var rpe=function(){var e=function(){function e(t,n){hy(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=k9,this.isNearBottom=!0,this.notYetScrolled=!0,TB(e.VERBOSE,"ChatComponent constructor")}return vy(e,[{key:"ngOnInit",value:function(){TB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),D7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new i9(t,t,function(){});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(Id||(Id=Gg(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(Ad||(Ad=Gg(["1 new message"]))):$localize(Rd||(Rd=Gg([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(e.chatId,r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatSubscription.unsubscribe()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(A7),mS(z7))},e.\u0275cmp=lk({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&KT(Yve,5),2&e)&&(YT(n=QT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Md||(Md=Gg(["Hide chat"]))),$localize(xd||(xd=Gg(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Nd||(Nd=Gg(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Dd||(Dd=Gg(["Be polite"])))]},template:function(e,t){if(1&e&&(wS(0,"div"),wS(1,"button",0),IS("click",function(){return t.switchChatVisibility()}),gS(2,Kve,2,0,"ng-container",1),gS(3,Qve,1,1,"ng-template",null,2,JT),_S(),gS(5,epe,5,2,"div",3),gS(6,npe,14,5,"form",4),_S()),2&e){var n=yS(4);LE(2),kS("ngIf",t.visible)("ngIfElse",n),LE(3),kS("ngIf",t.visible),LE(1),kS("ngIf",t.visible)}},directives:[aR,rR,px,FM,fx,oM,Dx,LM,vx,$ee],pipes:[jve],encapsulation:2}),e}();function ipe(e,t){if(1&e&&(bS(0),iP(1),SS()),2&e){var n=MS().$implicit;LE(1),aP(n.data.playerOne.name)}}function ape(e,t){1&e&&(bS(0),hO(1,26),SS())}function ope(e,t){if(1&e){var n=PS();wS(0,"tr",22),IS("click",function(){var e=tC(n).$implicit;return MS(2).joinGame(e.id,e.data.typeGame)}),wS(1,"td",23),iP(2),_S(),wS(3,"td",23),iP(4),_S(),wS(5,"td",23),gS(6,ipe,2,1,"ng-container",24),gS(7,ape,2,0,"ng-template",null,25,JT),_S(),wS(9,"td",23),iP(10),_S(),_S()}if(2&e){var r=t.$implicit,i=t.index,a=yS(8);NS("id","part_",i,""),LE(2),aP(r.data.typeGame),LE(2),aP(r.data.playerZero.name),LE(2),kS("ngIf",r.data.playerOne)("ngIfElse",a),LE(4),aP(r.data.turn)}}function spe(e,t){if(1&e&&(wS(0,"div",13),wS(1,"div",14),wS(2,"table",15),wS(3,"thead"),wS(4,"tr"),wS(5,"th",16),hO(6,17),_S(),wS(7,"th",16),hO(8,18),_S(),wS(9,"th",16),hO(10,19),_S(),wS(11,"th",16),hO(12,20),_S(),_S(),_S(),wS(13,"tbody"),gS(14,ope,11,6,"tr",21),_S(),_S(),_S(),_S()),2&e){var n=MS();LE(14),kS("ngForOf",n.activeParts)}}function upe(e,t){1&e&&(wS(0,"div",27),ES(1,"app-online-game-selection",28),_S())}function cpe(e,t){if(1&e&&(wS(0,"li",39),iP(1),MT(2,"firebaseDate"),_S()),2&e){var n=MS().$implicit;xS("id",n.data.username),LE(1),sP("",n.data.username,": ",xT(2,3,n.data.lastUpdateTime),"")}}function lpe(e,t){if(1&e&&(bS(0),gS(1,cpe,3,5,"li",38),SS()),2&e){var n=t.$implicit;LE(1),kS("ngIf",n.data.lastUpdateTime)}}function fpe(e,t){if(1&e&&(wS(0,"div",29),wS(1,"div",30),wS(2,"div",31),ES(3,"app-chat",32),_S(),_S(),wS(4,"div",33),wS(5,"div",34),wS(6,"p"),hO(7,35),_S(),wS(8,"ul",36),gS(9,lpe,2,1,"ng-container",37),_S(),_S(),_S(),_S()),2&e){var n=MS();LE(3),kS("turn",-1),LE(6),kS("ngForOf",n.activeUsers)}}var hpe=function(){var e=function(){function e(t,n,r){hy(this,e),this.router=t,this.activeUsersService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return vy(e,[{key:"ngOnInit",value:function(){var t=this;TB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(function(e){t.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){TB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}},{key:"joinGame",value:function(e,t){var n=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(pF),mS(Zve),mS(qve))},e.\u0275cmp=lk({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Ld||(Ld=Gg(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Fd||(Fd=Gg(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Ud||(Ud=Gg(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Vd||(Vd=Gg(["Game"]))),$localize(Bd||(Bd=Gg(["First player"]))),$localize(zd||(zd=Gg(["Second player"]))),$localize(Hd||(Hd=Gg(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Gd||(Gd=Gg(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize($d||($d=Gg(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"ul"),wS(2,"li",1),wS(3,"a",2),IS("click",function(){return t.selectTab("games")}),hO(4,3),_S(),_S(),wS(5,"li",4),wS(6,"a",5),IS("click",function(){return t.selectTab("create")}),hO(7,6),_S(),_S(),wS(8,"li",7),wS(9,"a",8),IS("click",function(){return t.selectTab("chat")}),hO(10,9),_S(),_S(),_S(),_S(),gS(11,spe,15,1,"div",10),gS(12,upe,2,0,"div",11),gS(13,fpe,10,2,"div",12)),2&e&&(LE(11),kS("ngIf","games"===t.currentTab),LE(1),kS("ngIf","create"===t.currentTab),LE(1),kS("ngIf","chat"===t.currentTab))},directives:[tR,aR,rR,Wve,rpe],pipes:[jve],encapsulation:2}),e}(),dpe=function(){var e=vy(function e(t){var n;hy(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(Zd||(Zd=Gg(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(mS(jD))},e.\u0275cmp=lk({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(qd||(qd=Gg(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"div",1),hO(2,2),_S(),wS(3,"div",3),iP(4),_S(),_S()),2&e&&(LE(4),aP(t.message))},encapsulation:2}),e}();function vpe(e,t){}var ppe=function(){var e=vy(function e(t){hy(this,e),this.viewContainerRef=t,TB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(hT))},e.\u0275cmp=lk({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&gS(0,vpe,0,0,"ng-template")},encapsulation:2}),e}(),gpe=function(){var e=function(){function e(){hy(this,e)}return vy(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(Wd||(Wd=Gg(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(jd||(jd=Gg(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Yd||(Yd=Gg(["You cannot clone a game. This feature might be implemented later."])))},e}(),ype=function(){var e=function(){function e(t,n,r,i,a){hy(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[MB.empty(),MB.empty()],this.role=Q7.NONE,this.endGame=!1,this.Player=X7,TB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return vy(e,[{key:"getMatchingComponent",value:function(t){return TB(e.VERBOSE,"GameWrapper.getMatchingComponent"),MB.ofNullable(xve.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return TB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(TB(e.VERBOSE,"GameWrapper.createGameComponent"),r=OB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",gpe.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return D7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.setRole(t.role),t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"setRole",value:function(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(TB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",LB.failure(gpe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",LB.failure($localize(Kd||(Kd=Gg(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),LB.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:TB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=LB.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.role===Q7.NONE){var t=gpe.NO_CLONING_FEATURE();return LB.failure(t)}return this.isPlayerTurn()?LB.SUCCESS:LB.failure(gpe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.role===Q7.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayer();return TB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.role,areYouPlayer:this.players[n].isPresent()&&RB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(SO),mS(jD),mS(z7),mS(pF),mS(x7))},e.\u0275cmp=lk({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&KT(ppe,5),2&e)&&(YT(n=QT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),mpe=function(){function e(t,n,r){hy(this,e),this.added=t,this.modified=n,this.removed=r}return vy(e,[{key:"addNewKeys",value:function(e,t){var n,r=cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=cy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{D7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),D7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Zg({},n),r;if(null==n)return r.removed=Zg({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function kpe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Cpe(e,t){return kpe(t)-kpe(e)}function wpe(e){return $y(function(t,n){om(e).subscribe(new Zy(n,function(){return n.complete()},Sy)),!n.closed&&t.subscribe(n)})}var _pe=function(){var e=function(){function e(){hy(this,e)}return vy(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Qd||(Qd=Gg([""," hours"])),r)):1===r&&i.push($localize(Xd||(Xd=Gg(["1 hour"])))),n>1?i.push($localize(Jd||(Jd=Gg([""," minutes"])),n)):1===n&&i.push($localize(ev||(ev=Gg(["1 minute"])))),t>1?i.push($localize(tv||(tv=Gg([""," seconds"])),t)):1===t&&i.push($localize(nv||(nv=Gg(["1 second"])))),0===i.length)return $localize(rv||(rv=Gg(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(iv||(iv=Gg([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=yk({name:"humanDuration",type:e,pure:!0}),e}();function Epe(e,t){if(1&e&&(bS(0),iP(1),SS()),2&e){var n=MS(3);LE(1),aP(n.viewInfo.chosenOpponent)}}function bpe(e,t){1&e&&hO(0,44)}function Spe(e,t){if(1&e&&(wS(0,"div",45),wS(1,"div",8),wS(2,"label",46),bS(3),hO(4,47),SS(),wS(5,"output"),iP(6),MT(7,"humanDuration"),_S(),_S(),wS(8,"div",37),ES(9,"input",48),_S(),_S(),wS(10,"div",8),wS(11,"label",49),lO(12,50),ES(13,"output"),MT(14,"humanDuration"),fO(),_S(),wS(15,"div",37),ES(16,"input",51),_S(),_S(),_S()),2&e){var n=MS(3);LE(6),aP(xT(7,2,n.viewInfo.maximalMoveDuration||0)),LE(8),dO(xT(14,4,n.viewInfo.totalPartDuration||0)),vO(12)}}function Ppe(e,t){1&e&&(wS(0,"div"),lO(1,52),ES(2,"br"),fO(),_S())}function Ope(e,t){1&e&&(wS(0,"button",64),hO(1,65),_S())}function Tpe(e,t){if(1&e){var n=PS();wS(0,"tr",60),IS("click",function(){var e=tC(n).$implicit;return MS(4).selectOpponent(e)}),wS(1,"td",61),iP(2),_S(),wS(3,"td",62),gS(4,Ope,2,0,"button",63),_S(),_S()}if(2&e){var r=t.$implicit,i=MS(4);NS("id","presenceOf_",r,""),kS("ngClass",i.viewInfo.candidateClasses[r]),LE(1),kS("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),LE(1),aP(r),LE(2),kS("ngIf",i.viewInfo.chosenOpponent!==r)}}function Ipe(e,t){if(1&e&&(bS(0),hO(1,53),SS(),wS(2,"div",54),wS(3,"table",55),wS(4,"thead"),wS(5,"tr"),wS(6,"th",56),hO(7,57),_S(),wS(8,"th",56),hO(9,58),_S(),_S(),_S(),wS(10,"tbody"),gS(11,Tpe,5,5,"tr",59),_S(),_S(),_S()),2&e){var n=MS(3);LE(11),kS("ngForOf",n.viewInfo.candidates)}}function Ape(e,t){if(1&e){var n=PS();wS(0,"button",66),IS("click",function(){return tC(n),MS(3).changeConfig()}),hO(1,67),_S()}}function Rpe(e,t){if(1&e){var n=PS();wS(0,"div"),wS(1,"h1",4),hO(2,5),_S(),wS(3,"form",6),wS(4,"fieldset",7),wS(5,"div",8),wS(6,"label",9),hO(7,10),_S(),wS(8,"div",11),wS(9,"button",12),IS("click",function(){return tC(n),MS(2).selectFirstPlayer("RANDOM")}),hO(10,13),_S(),wS(11,"button",14),IS("click",function(){return tC(n),MS(2).selectFirstPlayer("CREATOR")}),hO(12,15),_S(),wS(13,"button",16),IS("click",function(){return tC(n),MS(2).selectFirstPlayer("CHOSEN_PLAYER")}),gS(14,Epe,2,1,"ng-container",17),gS(15,bpe,1,0,"ng-template",null,18,JT),_S(),_S(),_S(),wS(17,"div",8),wS(18,"label",9),hO(19,19),_S(),wS(20,"div",11),wS(21,"div",20),IS("click",function(){return tC(n),MS(2).selectPartType("STANDARD")}),wS(22,"div",21),wS(23,"span"),hO(24,22),_S(),_S(),wS(25,"div",23),wS(26,"div",24),wS(27,"div",25),wS(28,"p"),bS(29),hO(30,26),SS(),wS(31,"strong"),iP(32),MT(33,"humanDuration"),_S(),ES(34,"br"),bS(35),lO(36,27),ES(37,"strong"),MT(38,"humanDuration"),fO(),SS(),_S(),_S(),_S(),_S(),_S(),wS(39,"div",28),IS("click",function(){return tC(n),MS(2).selectPartType("BLITZ")}),wS(40,"div",21),wS(41,"span"),hO(42,29),_S(),_S(),wS(43,"div",23),wS(44,"div",24),wS(45,"div",25),wS(46,"p"),bS(47),hO(48,30),SS(),wS(49,"strong"),iP(50),MT(51,"humanDuration"),_S(),ES(52,"br"),bS(53),lO(54,31),ES(55,"strong"),MT(56,"humanDuration"),fO(),SS(),_S(),_S(),_S(),_S(),_S(),wS(57,"button",32),IS("click",function(){return tC(n),MS(2).selectPartType("CUSTOM")}),hO(58,33),_S(),_S(),_S(),gS(59,Spe,17,6,"div",34),wS(60,"div",8),wS(61,"label",35),hO(62,36),_S(),wS(63,"div",37),gS(64,Ppe,3,0,"div",17),gS(65,Ipe,12,1,"ng-template",null,38,JT),_S(),_S(),_S(),wS(67,"div",8),wS(68,"div",11),wS(69,"button",39),IS("click",function(){return tC(n),MS(2).proposeConfig()}),hO(70,40),_S(),gS(71,Ape,2,0,"button",41),wS(72,"button",42),IS("click",function(){return tC(n),MS(2).cancelGameCreation()}),hO(73,43),_S(),_S(),_S(),_S(),_S()}if(2&e){var r=yS(16),i=yS(66),a=MS(2);LE(3),kS("formGroup",a.configFormGroup),LE(1),kS("disabled",!a.viewInfo.canEditConfig),LE(5),kS("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),LE(2),kS("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),LE(2),kS("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),LE(1),kS("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),LE(7),kS("ngClass",a.viewInfo.partTypeClasses.STANDARD),LE(11),aP(xT(33,19,a.partType.NORMAL_MOVE_DURATION)),LE(6),dO(xT(38,21,a.partType.NORMAL_PART_DURATION)),vO(36),LE(1),kS("ngClass",a.viewInfo.partTypeClasses.BLITZ),LE(11),aP(xT(51,23,a.partType.BLITZ_MOVE_DURATION)),LE(6),dO(xT(56,25,a.partType.BLITZ_PART_DURATION)),vO(54),LE(1),kS("ngClass",a.viewInfo.partTypeClasses.CUSTOM),LE(2),kS("ngIf",a.viewInfo.showCustomTime),LE(5),kS("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),LE(5),kS("disabled",!a.viewInfo.canProposeConfig),LE(2),kS("ngIf",a.viewInfo.canReviewConfig)}}function Mpe(e,t){if(1&e&&(wS(0,"div",74),wS(1,"p"),lO(2,75),ES(3,"br"),fO(),_S(),_S()),2&e){var n=MS(3);LE(3),dO(n.viewInfo.creator),vO(2)}}function xpe(e,t){if(1&e&&(wS(0,"span"),hO(1,81),_S()),2&e){var n=MS(4);LE(1),dO(n.viewInfo.creator),vO(1)}}function Npe(e,t){1&e&&(wS(0,"span"),hO(1,82),_S())}function Dpe(e,t){1&e&&(wS(0,"span"),hO(1,83),_S())}function Lpe(e,t){if(1&e){var n=PS();wS(0,"div",74),wS(1,"p"),hO(2,76),_S(),wS(3,"ul"),wS(4,"li"),gS(5,xpe,2,1,"span",2),gS(6,Npe,2,0,"span",2),gS(7,Dpe,2,0,"span",2),_S(),wS(8,"li"),lO(9,77),ES(10,"strong"),MT(11,"humanDuration"),fO(),_S(),wS(12,"li"),lO(13,78),ES(14,"strong"),MT(15,"humanDuration"),fO(),_S(),_S(),wS(16,"button",79),IS("click",function(){return tC(n),MS(3).acceptConfig()}),hO(17,80),_S(),_S()}if(2&e){var r=MS(3);LE(2),dO(r.viewInfo.creator)(r.viewInfo.partTypeName),vO(2),LE(3),kS("ngIf","CREATOR"===r.viewInfo.firstPlayer),LE(1),kS("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),LE(1),kS("ngIf","RANDOM"===r.viewInfo.firstPlayer),LE(4),dO(xT(11,7,r.viewInfo.maximalMoveDuration||0)),vO(9),LE(4),dO(xT(15,9,r.viewInfo.totalPartDuration||0)),vO(13)}}function Fpe(e,t){if(1&e&&(wS(0,"div"),wS(1,"div",68),wS(2,"div",69),wS(3,"p"),hO(4,70),_S(),_S(),wS(5,"div",71),gS(6,Mpe,4,1,"div",72),gS(7,Lpe,18,11,"ng-template",null,73,JT),_S(),_S(),_S()),2&e){var n=yS(8),r=MS(2);LE(6),kS("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Upe(e,t){if(1&e&&(bS(0),hO(1,86),SS()),2&e){var n=MS(3);LE(1),dO(n.viewInfo.creator),vO(1)}}function Vpe(e,t){if(1&e&&hO(0,87),2&e){var n=MS(3);dO(n.viewInfo.creator)(n.viewInfo.chosenOpponent),vO(0)}}function Bpe(e,t){if(1&e&&(wS(0,"div",68),wS(1,"div",69),wS(2,"p"),hO(3,84),_S(),_S(),wS(4,"div",71),wS(5,"p"),gS(6,Upe,2,1,"ng-container",17),gS(7,Vpe,1,2,"ng-template",null,85,JT),_S(),_S(),_S()),2&e){var n=yS(8),r=MS(2);LE(6),kS("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function zpe(e,t){if(1&e&&(wS(0,"div",1),gS(1,Rpe,74,27,"div",2),gS(2,Fpe,9,2,"div",2),gS(3,Bpe,9,2,"div",3),_S()),2&e){var n=MS();LE(1),kS("ngIf",n.viewInfo.userIsCreator),LE(1),kS("ngIf",n.viewInfo.userIsChosenOpponent),LE(1),kS("ngIf",n.viewInfo.userIsObserver)}}var Hpe=function(){function e(t,n,r,i,a,o,s,u){hy(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.configRoomService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=Z7,this.gameStartNotification=new FT,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new zy,this.allUserInterval=MB.empty(),this.ownTokenInterval=MB.empty(),this.selfSubscription=new dy,this.configRoomSubscription=new dy,this.candidatesSubscription=new dy,this.allDocDeleted=!1,TB(e.VERBOSE,"PartCreationComponent constructed")}return vy(e,[{key:"ngOnInit",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return TB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=16;break;case 9:return n.next=11,t.updateUserDocWithObservedPart();case 11:return n.next=13,t.startSendingPresenceTokens();case 13:t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),TB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 16:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;D7(e.isPresent()&&e.get()!==B7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),D7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[$7.RANDOM.value,hM.required],maximalMoveDuration:[Z7.NORMAL_MOVE_DURATION,hM.required],partType:["STANDARD",hM.required],totalPartDuration:[Z7.NORMAL_PART_DURATION,hM.required],chosenOpponent:["",hM.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return TB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=PB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=PB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return OB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(wpe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=OB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==q7.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(wpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(wpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(wpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(wpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=OB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===q7.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==q7.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==q7.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(av||(av=Gg(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(ov||(ov=Gg(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(sv||(sv=Gg(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Z7.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Z7.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Z7.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Z7.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return TB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.configRoomService.setChosenOpponent(n.partId,i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return OB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig(e.partId));case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(e.partId,s,Z7.of(r),i,$7.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return TB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return TB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return TB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.partId,t.candidates);case 12:TB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return PB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(TB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=OB.getNonNullable(n.currentConfigRoom),a=OB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(uv||(uv=Gg([""," left the game, please pick another opponent."])),a))),n.currentConfigRoom=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observePlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(TB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return TB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(cv||(cv=Gg(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return OB.getNonNullable(this.currentConfigRoom).partStatus===q7.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=OB.getNonNullable(this.currentConfigRoom);TB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,TB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observePlayers",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:D7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),r=t.connectedUserService.user.get().id,t.allUserInterval=MB.of(window.setInterval(PB(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=OB.getNonNullable(t.currentConfigRoom),i=t.lastToken,r!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(i);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(i);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 3:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=OB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(0==(OB.getNonNullable(e.currentConfigRoom).partStatus===q7.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),D7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=cy(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return PB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(N7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Cpe(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=OB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId);case 5:return n.abrupt("return",t.configRoomService.removeCandidate(t.partId,e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:D7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=MB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){D7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=MB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}},{key:"acceptConfig",value:function(){return TB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,OB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(TB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),r=t.connectedUserService.user.get(),n.t0=!0!==t.gameStarted,!n.t0){n.next=23;break}if(null!==t.currentConfigRoom){n.next=8;break}TB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"),n.next=23;break;case 8:if(!0!==t.allDocDeleted){n.next=12;break}TB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"),n.next=23;break;case 12:if(r.id!==t.currentConfigRoom.creator.id){n.next=18;break}return TB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=16,t.cancelGameCreation();case 16:n.next=23;break;case 18:return TB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=21,t.connectedUserService.removeObservedPart();case 21:return n.next=23,t.configRoomService.cancelJoining(t.partId);case 23:case"end":return n.stop()}},n)}))()}}]),e}();function Gpe(e,t){if(1&e){var n=PS();wS(0,"button",3),IS("click",function(){return tC(n),MS().addTime()}),hO(1,4),_S()}if(2&e){var r=MS();LE(1),dO(r.timeToAdd),vO(1)}}Hpe.VERBOSE=!1,Hpe.TOKEN_INTERVAL=5e3,Hpe.TOKEN_TIMEOUT=2*Hpe.TOKEN_INTERVAL,Hpe.\u0275fac=function(e){return new(e||Hpe)(mS(pF),mS(z7),mS(s9),mS(o9),mS(A7),mS(F7),mS(Vx),mS(x7))},Hpe.\u0275cmp=lk({type:Hpe,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(lv||(lv=Gg(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(fv||(fv=Gg(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(hv||(hv=Gg(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(dv||(dv=Gg(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(vv||(vv=Gg(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(pv||(pv=Gg(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(gv||(gv=Gg(["Maximal turn duration: "]))),$localize(yv||(yv=Gg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(mv||(mv=Gg(["Blitz"]))),$localize(kv||(kv=Gg(["Maximal turn duration: "]))),$localize(Cv||(Cv=Gg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(wv||(wv=Gg(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(_v||(_v=Gg(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(Ev||(Ev=Gg(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(bv||(bv=Gg(["Cancel game"]))),$localize(Sv||(Sv=Gg(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(Pv||(Pv=Gg(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(Ov||(Ov=Gg(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(Tv||(Tv=Gg(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(Iv||(Iv=Gg(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Av||(Av=Gg(["Name"]))),$localize(Rv||(Rv=Gg(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Mv||(Mv=Gg(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(xv||(xv=Gg(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(Nv||(Nv=Gg(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Dv||(Dv=Gg(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Lv||(Lv=Gg(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Fv||(Fv=Gg(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Uv||(Uv=Gg(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Vv||(Vv=Gg(["Accept and start"]))),$localize(Bv||(Bv=Gg(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(zv||(zv=Gg(["you play first"]))),$localize(Hv||(Hv=Gg(["the first player is selected randomly"]))),$localize(Gv||(Gv=Gg(["One moment..."]))),["proposalSent",""],$localize($v||($v=Gg(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Zv||(Zv=Gg(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&gS(0,zpe,4,3,"div",0),2&e&&kS("ngIf",t.viewInfo)},directives:[aR,px,FM,wx,tR,oM,mx,LM,Ex,rR],pipes:[_pe],encapsulation:2});var $pe=function(){var e=function(){function e(){hy(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new FT,this.addTimeToOpponent=new FT,this.cssClasses=e.SAFE_TIME}return vy(e,[{key:"ngOnInit",value:function(){TB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(TB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(TB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(TB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){TB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(TB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(TB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){TB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=lk({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(qv||(qv=Gg(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"p",1),iP(2),MT(3,"number"),_S(),gS(4,Gpe,2,1,"button",2),_S()),2&e&&(kS("ngClass",t.getTimeClass()),LE(2),sP("",t.displayedMinute,":",function(e,t,n,r){var i=Jk(),a=$k(i,23);return DT(i,NT(i,23)?RT(i,lC(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),LE(2),kS("ngIf",t.canAddTime))},directives:[tR,aR],pipes:[uR],encapsulation:2}),e}(),Zpe=["partCreation"],qpe=["chatComponent"],Wpe=["chronoZeroGlobal"],jpe=["chronoOneGlobal"],Ype=["chronoZeroTurn"],Kpe=["chronoOneTurn"];function Qpe(e,t){if(1&e){var n=PS();wS(0,"app-part-creation",5,6),IS("gameStartNotification",function(e){return tC(n),MS().startGame(e)}),_S()}2&e&&kS("partId",MS().currentPartId)}function Xpe(e,t){1&e&&(bS(0),hO(1,40),SS())}function Jpe(e,t){if(1&e&&(bS(0),hO(1,41),SS()),2&e){var n=MS(4);LE(1),dO(null==n.currentPlayer?null:n.currentPlayer.name),vO(1)}}function ege(e,t){if(1&e&&(wS(0,"p",37),gS(1,Xpe,2,0,"ng-container",38),gS(2,Jpe,2,1,"ng-template",null,39,JT),_S()),2&e){var n=yS(3),r=MS(3);LE(1),kS("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function tge(e,t){if(1&e&&(wS(0,"div",33),wS(1,"p",34),hO(2,35),_S(),gS(3,ege,4,2,"p",36),_S()),2&e){var n=MS(2);LE(2),dO(n.currentPart.getTurn()+1),vO(2),LE(1),kS("ngIf",!1===n.endGame)}}function nge(e,t){if(1&e&&(wS(0,"p",42),iP(1),_S()),2&e){var n=MS(2);kS("ngClass",n.getPlayerNameClass(n.Player.ZERO)),LE(1),aP(n.players[0].get().name)}}function rge(e,t){if(1&e&&(wS(0,"p",43),hO(1,44),_S()),2&e){var n=MS(2);LE(1),dO(n.gameComponent.scores.get()[0]),vO(1)}}function ige(e,t){if(1&e&&(wS(0,"p",45),iP(1),_S()),2&e){var n=MS(2);kS("ngClass",n.getPlayerNameClass(n.Player.ONE)),LE(1),aP(n.players[1].get().name)}}function age(e,t){if(1&e&&(wS(0,"p",46),hO(1,47),_S()),2&e){var n=MS(2);LE(1),dO(n.gameComponent.scores.get()[1]),vO(1)}}function oge(e,t){if(1&e){var n=PS();wS(0,"button",56),IS("click",function(){return tC(n),MS(3).resign()}),hO(1,57),_S()}}function sge(e,t){if(1&e){var n=PS();wS(0,"button",58),IS("click",function(){return tC(n),MS(3).proposeDraw()}),hO(1,59),_S()}}function uge(e,t){if(1&e){var n=PS();wS(0,"button",60),IS("click",function(){return tC(n),MS(3).acceptDraw()}),hO(1,61),_S()}}function cge(e,t){if(1&e){var n=PS();wS(0,"button",62),IS("click",function(){return tC(n),MS(3).refuseDraw()}),hO(1,63),_S()}}function lge(e,t){if(1&e){var n=PS();wS(0,"button",64),IS("click",function(){return tC(n),MS(3).gameComponent.pass()}),hO(1,65),_S()}}function fge(e,t){if(1&e){var n=PS();wS(0,"button",66),IS("click",function(){return tC(n),MS(3).acceptTakeBack()}),hO(1,67),_S()}}function hge(e,t){if(1&e){var n=PS();wS(0,"button",68),IS("click",function(){return tC(n),MS(3).refuseTakeBack()}),hO(1,69),_S()}}function dge(e,t){if(1&e){var n=PS();wS(0,"button",70),IS("click",function(){return tC(n),MS(3).askTakeBack()}),hO(1,71),_S()}}function vge(e,t){if(1&e&&(bS(0),gS(1,oge,2,0,"button",48),gS(2,sge,2,0,"button",49),gS(3,uge,2,0,"button",50),gS(4,cge,2,0,"button",51),gS(5,lge,2,0,"button",52),gS(6,fge,2,0,"button",53),gS(7,hge,2,0,"button",54),gS(8,dge,2,0,"button",55),SS()),2&e){var n=MS(2);LE(1),kS("ngIf",n.canResign()),LE(1),kS("ngIf",n.canProposeDraw()),LE(1),kS("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),LE(1),kS("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),LE(1),kS("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),LE(1),kS("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),LE(1),kS("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),LE(1),kS("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function pge(e,t){1&e&&(wS(0,"div"),wS(1,"p",73),hO(2,74),_S(),_S())}function gge(e,t){1&e&&(wS(0,"p",78),hO(1,79),_S())}function yge(e,t){1&e&&(wS(0,"p",80),hO(1,81),_S())}function mge(e,t){1&e&&(wS(0,"p",82),hO(1,83),_S())}function kge(e,t){if(1&e&&(wS(0,"div"),gS(1,gge,2,0,"p",75),gS(2,yge,2,0,"p",76),gS(3,mge,2,0,"p",77),_S()),2&e){var n=MS(3);LE(1),kS("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),LE(1),kS("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),LE(1),kS("ngIf",!1===n.isPlaying())}}function Cge(e,t){1&e&&(wS(0,"p",86),hO(1,87),_S())}function wge(e,t){1&e&&(wS(0,"p",88),hO(1,89),_S())}function _ge(e,t){if(1&e&&(wS(0,"p",88),hO(1,90),_S()),2&e){var n=MS(4);LE(1),dO(n.currentPart.getWinner().get().name),vO(1)}}function Ege(e,t){if(1&e&&(wS(0,"div"),gS(1,Cge,2,0,"p",84),gS(2,wge,2,0,"p",85),gS(3,_ge,2,1,"p",85),_S()),2&e){var n=MS(3);LE(1),kS("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),LE(1),kS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),LE(1),kS("ngIf",!1===n.isPlaying())}}function bge(e,t){if(1&e&&(wS(0,"p",86),hO(1,91),_S()),2&e){var n=MS(4);LE(1),dO(n.currentPart.getLoser().get().name),vO(1)}}function Sge(e,t){1&e&&(wS(0,"p",88),hO(1,92),_S())}function Pge(e,t){if(1&e&&(wS(0,"p",88),hO(1,93),_S()),2&e){var n=MS(4);LE(1),dO(n.currentPart.getLoser().get().name),vO(1)}}function Oge(e,t){if(1&e&&(wS(0,"div"),gS(1,bge,2,1,"p",84),gS(2,Sge,2,0,"p",85),gS(3,Pge,2,1,"p",85),_S()),2&e){var n=MS(3);LE(1),kS("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),LE(1),kS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),LE(1),kS("ngIf",!1===n.isPlaying())}}function Tge(e,t){1&e&&(wS(0,"p",95),hO(1,96),_S())}function Ige(e,t){if(1&e&&(wS(0,"p",95),hO(1,97),_S()),2&e){var n=MS(4);LE(1),dO(n.currentPart.getLoser().get().name),vO(1)}}function Age(e,t){if(1&e&&(wS(0,"div"),gS(1,Tge,2,0,"p",94),gS(2,Ige,2,1,"p",94),_S()),2&e){var n=MS(3);LE(1),kS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),LE(1),kS("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Rge(e,t){if(1&e&&(wS(0,"div",72),ES(1,"hr"),gS(2,pge,3,0,"div",26),gS(3,kge,4,3,"div",26),gS(4,Ege,4,3,"div",26),gS(5,Oge,4,3,"div",26),gS(6,Age,3,2,"div",26),_S()),2&e){var n=MS(2);LE(2),kS("ngIf",n.currentPart.isHardDraw()),LE(1),kS("ngIf",n.currentPart.isAgreedDraw()),LE(1),kS("ngIf",n.currentPart.isWin()),LE(1),kS("ngIf",n.currentPart.isTimeout()),LE(1),kS("ngIf",n.currentPart.isResign())}}function Mge(e,t){1&e&&(wS(0,"button",98),hO(1,99),_S())}function xge(e,t){if(1&e){var n=PS();wS(0,"button",100),IS("click",function(){return tC(n),MS(2).proposeRematch()}),hO(1,101),_S()}}function Nge(e,t){if(1&e){var n=PS();wS(0,"button",102),IS("click",function(){return tC(n),MS(2).acceptRematch()}),hO(1,103),_S()}}function Dge(e,t){if(1&e){var n=PS();wS(0,"div",7),wS(1,"div",8),wS(2,"div",9),gS(3,tge,4,2,"div",10),wS(4,"div",11),gS(5,nge,2,2,"p",12),gS(6,rge,2,1,"p",13),wS(7,"app-count-down",14,15),IS("outOfTimeAction",function(){tC(n);var e=MS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return tC(n),MS().addGlobalTime()}),_S(),wS(9,"app-count-down",16,17),IS("outOfTimeAction",function(){tC(n);var e=MS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return tC(n),MS().addTurnTime()}),_S(),_S(),wS(11,"p",18),hO(12,19),_S(),wS(13,"div",11),gS(14,ige,2,2,"p",20),gS(15,age,2,1,"p",21),wS(16,"app-count-down",22,23),IS("outOfTimeAction",function(){tC(n);var e=MS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return tC(n),MS().addGlobalTime()}),_S(),wS(18,"app-count-down",24,25),IS("outOfTimeAction",function(){tC(n);var e=MS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return tC(n),MS().addTurnTime()}),_S(),_S(),ES(20,"hr"),gS(21,vge,9,8,"ng-container",26),gS(22,Rge,7,5,"div",27),gS(23,Mge,2,0,"button",28),gS(24,xge,2,0,"button",29),gS(25,Nge,2,0,"button",30),_S(),_S(),wS(26,"div",31),wS(27,"div",32),ES(28,"app-game-includer"),_S(),_S(),_S()}if(2&e){var r=MS();LE(3),kS("ngIf",r.currentPart),LE(2),kS("ngIf",r.players[0].isPresent()),LE(1),kS("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),LE(1),kS("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),LE(2),kS("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),LE(5),kS("ngIf",r.players[1].isPresent()),LE(1),kS("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),LE(1),kS("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),LE(2),kS("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),LE(3),kS("ngIf",r.isPlaying()),LE(1),kS("ngIf",r.endGame),LE(1),kS("ngIf",r.endGame),LE(1),kS("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),LE(1),kS("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),LE(1),kS("ngClass",r.getBoardHighlight())}}var Lge=function(){var e=vy(function e(){hy(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Wv||(Wv=Gg(["The game you tried to join does not exist."])))},e}(),Fge=vy(function e(t){hy(this,e),this.value=t});Fge.PRE_START_DOC=new Fge("PRE_START_DOC"),Fge.STARTING_DOC=new Fge("STARTING_DOC"),Fge.DUPLICATE=new Fge("DUPLICATE"),Fge.MOVE_WITHOUT_TIME=new Fge("MOVE_WITHOUT_TIME"),Fge.MOVE=new Fge("MOVE"),Fge.REQUEST=new Fge("REQUEST"),Fge.END_GAME=new Fge("END_GAME"),Fge.END_GAME_WITHOUT_TIME=new Fge("END_GAME_WITHOUT_TIME"),Fge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Fge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Uge=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s,u){var c;return hy(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=new dy,c.partSubscription=new dy,c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(jv||(jv=Gg(["5 minutes"]))),c.turnTimeMessage=$localize(Yv||(Yv=Gg(["30 seconds"]))),TB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return vy(n,[{key:"extractPartIdFromURL",value:function(){return OB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return OB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.role.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.role===e}},{key:"isOpponent",value:function(e){return this.role!==e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!xve.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=Lge.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=gpe.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return TB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=PB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof HN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.subscribeToUser(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:TB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 6:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:TB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),D7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(PB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=D7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;TB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,(e=PB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return D7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new G7(t.currentPartId,e),TB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,TB(n.VERBOSE,a===Fge.REQUEST?"UpdateType: Request("+OB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Fge.REQUEST?8:r.t0===Fge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Fge.DUPLICATE?12:r.t0===Fge.END_GAME_WITHOUT_TIME?13:r.t0===Fge.END_GAME?14:r.t0===Fge.MOVE_WITHOUT_TIME?15:r.t0===Fge.MOVE?16:r.t0===Fge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(OB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void D7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(D7(a===Fge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(X7.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=mpe.from(null!=this.currentPart?this.currentPart.data:null,e.data);TB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Fge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Fge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Fge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Fge.MOVE_WITHOUT_TIME:Fge.MOVE:null==t.modified.lastUpdateTime?Fge.MOVE_WITHOUT_TIME:Fge.MOVE;if(null==e.data.beginning)return Fge.PRE_START_DOC;if(e.data.result!==H7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Fge.END_GAME_WITHOUT_TIME:Fge.END_GAME}return D7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Fge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);D7(null!=r,"oldTime should not be null"),D7(null!=i,"updateTime should not be null");var a=X7.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(OB.getNonNullable(r),OB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=Cpe(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){TB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){TB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();for(var t=n9.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;r.node.gameState.turn<t.length;){var i=r.node.gameState.turn,a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,r.node.gameState),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';D7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){TB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=X7.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(TB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=X7.fromTurn(e.data.turn);this.endGame=!0,[H7.VICTORY,H7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(D7(!0===[H7.RESIGN,H7.TIMEOUT,H7.HARD_DRAW,H7.AGREED_DRAW_BY_ZERO,H7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),TB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){TB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===Fte.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(D7(r===Fte.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return D7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.role.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&this.currentPart.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===Q7.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return Q7.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?J7.getPlayer(e):Q7.NONE}},{key:"canProposeDraw",value:function(){return D7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&J7.getPlayer(this.currentPart.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===Q7.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==Q7.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return Q7.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?J7.getPlayer(e):Q7.NONE}},{key:"onRequest",value:function(e,t){var r=this;return PB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(TB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=J7.getPlayer(e).getOpponent(),r.isPlayer(a)&&(TB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",J7.getTypeGame(e),J7.getPartId(e)]);case 15:return 3e4,o=X7.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=X7.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return OB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(TB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=X7.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;TB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[MB.of(e.data.playerZero),MB.ofNullable(e.data.playerOne)],D7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=MB.empty();if(this.players[0].get().id===this.authUser.id?(this.setRole(X7.ZERO),r=this.players[1]):this.players[1].get().id===this.authUser.id?(this.setRole(X7.ONE),r=this.players[0]):this.setRole(Q7.NONE),r.isPresent()){this.opponentSubscription=this.userService.observeUser(r.get().id,function(e){D7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent={id:r.get().id,name:OB.getNonNullable(e.get().username)}})}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return PB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(TB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return PB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),TB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===Fte.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.role,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return TB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.role,a=e.getPlayer(),o=e.players[(e.role.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(TB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.role,t.stopCountdownsFor(e),e!==t.role){r.next=8;break}return o=OB.getNonNullable(t.opponent),r.next=6,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 6:r.next=13;break;case 8:if(D7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=13;break}return s=OB.getNonNullable(t.opponent),r.next=12,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,s);case 12:t.endGame=!0;case 13:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new G7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.role);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return D7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptDraw",value:function(){return D7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"refuseDraw",value:function(){return D7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"askTakeBack",value:function(){return D7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptTakeBack",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.role,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return D7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"startCountDownFor",value:function(e){TB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===X7.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];TB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===X7.ZERO?(this.chronoZeroGlobal.changeDuration(OB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(OB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];TB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===X7.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){TB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===X7.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===X7.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return D7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.role,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=X7.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===X7.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===X7.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){TB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),TB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}]),n}(ype);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(SO),mS(jD),mS(pF),mS(x7),mS(z7),mS(F7),mS(s9))},e.\u0275cmp=lk({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(KT(Zpe,5),KT(qpe,5),KT(Wpe,5),KT(jpe,5),KT(Ype,5),KT(Kpe,5)),2&e)&&(YT(n=QT())&&(t.partCreation=n.first),YT(n=QT())&&(t.chatComponent=n.first),YT(n=QT())&&(t.chronoZeroGlobal=n.first),YT(n=QT())&&(t.chronoOneGlobal=n.first),YT(n=QT())&&(t.chronoZeroTurn=n.first),YT(n=QT())&&(t.chronoOneTurn=n.first))},features:[Xb],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Kv||(Kv=Gg(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Qv||(Qv=Gg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(Xv||(Xv=Gg(["It is your turn."]))),$localize(Jv||(Jv=Gg(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(ep||(ep=Gg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(tp||(tp=Gg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(np||(np=Gg(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(rp||(rp=Gg(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(ip||(ip=Gg(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(ap||(ap=Gg(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(op||(op=Gg(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(sp||(sp=Gg(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(up||(up=Gg(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(cp||(cp=Gg(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(lp||(lp=Gg(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(fp||(fp=Gg(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(hp||(hp=Gg(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(dp||(dp=Gg(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(vp||(vp=Gg(["You won."]))),[1,"title"],$localize(pp||(pp=Gg(["You lost."]))),$localize(gp||(gp=Gg(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(yp||(yp=Gg(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(mp||(mp=Gg(["You reached your time limit."]))),$localize(kp||(kp=Gg(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(Cp||(Cp=Gg(["You resigned."]))),$localize(wp||(wp=Gg(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(_p||(_p=Gg(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Ep||(Ep=Gg(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(bp||(bp=Gg(["Accept to play again"])))]},template:function(e,t){1&e&&(gS(0,Qpe,2,1,"app-part-creation",0),gS(1,Dge,29,27,"div",1),wS(2,"div",2),wS(3,"div",3),ES(4,"app-chat",4),_S(),_S()),2&e&&(kS("ngIf",!1===t.gameStarted),LE(1),kS("ngIf",t.gameStarted),LE(3),kS("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[aR,rpe,Hpe,$pe,tR,ppe,yF],encapsulation:2}),e}();function Vge(e,t){if(1&e&&(wS(0,"option",25),iP(1),_S()),2&e){var n=t.$implicit;kS("value",n.name),LE(1),aP(n.name)}}function Bge(e,t){if(1&e&&(wS(0,"option",25),hO(1,29),_S()),2&e){var n=t.$implicit;kS("value",n),LE(1),dO(n),vO(1)}}var zge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Hge(e,t){if(1&e){var n=PS();wS(0,"select",26),IS("ngModelChange",function(e){return tC(n),MS(2).aiDepths[0]=e})("change",function(){tC(n);var e=MS(2);return e.updatePlayer(e.Player.ZERO)}),wS(1,"option",27),hO(2,28),_S(),gS(3,Bge,2,2,"option",16),_S()}2&e&&(kS("ngModel",MS(2).aiDepths[0]),LE(3),kS("ngForOf",PT(2,zge)))}function Gge(e,t){if(1&e&&(wS(0,"p",30),hO(1,31),_S()),2&e){var n=MS(2);LE(1),dO(n.gameComponent.scores.get()[0]),vO(1)}}function $ge(e,t){if(1&e&&(wS(0,"option",25),iP(1),_S()),2&e){var n=t.$implicit;kS("value",n.name),LE(1),aP(n.name)}}function Zge(e,t){if(1&e&&(wS(0,"option",25),hO(1,34),_S()),2&e){var n=t.$implicit;kS("value",n),LE(1),dO(n),vO(1)}}function qge(e,t){if(1&e){var n=PS();wS(0,"select",32),IS("ngModelChange",function(e){return tC(n),MS(2).aiDepths[1]=e})("change",function(){tC(n);var e=MS(2);return e.updatePlayer(e.Player.ONE)}),wS(1,"option",27),hO(2,33),_S(),gS(3,Zge,2,2,"option",16),_S()}2&e&&(kS("ngModel",MS(2).aiDepths[1]),LE(3),kS("ngForOf",PT(2,zge)))}function Wge(e,t){if(1&e&&(wS(0,"p",35),hO(1,36),_S()),2&e){var n=MS(2);LE(1),dO(n.gameComponent.scores.get()[1]),vO(1)}}function jge(e,t){if(1&e&&(wS(0,"h4"),hO(1,40),_S()),2&e){var n=MS(3);LE(1),dO(n.winner.get()),vO(1)}}function Yge(e,t){1&e&&(wS(0,"h4",41),hO(1,42),_S())}function Kge(e,t){if(1&e&&(wS(0,"div",37),gS(1,jge,2,1,"h4",38),gS(2,Yge,2,0,"h4",39),_S()),2&e){var n=MS(2);LE(1),kS("ngIf",n.winner.isPresent()),LE(1),kS("ngIf",n.winner.isAbsent())}}function Qge(e,t){if(1&e){var n=PS();wS(0,"div",6),wS(1,"div",7),wS(2,"p",8),hO(3,9),_S(),_S(),wS(4,"div",10),wS(5,"div",11),wS(6,"div",12),wS(7,"select",13),IS("change",function(){tC(n);var e=MS();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return tC(n),MS().playerSelection[0]=e}),wS(8,"option",14),hO(9,15),_S(),gS(10,Vge,2,2,"option",16),_S(),_S(),wS(11,"div",12),gS(12,Hge,4,3,"select",17),_S(),gS(13,Gge,2,1,"p",18),_S(),wS(14,"div",19),wS(15,"div",12),wS(16,"select",20),IS("change",function(){tC(n);var e=MS();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return tC(n),MS().playerSelection[1]=e}),wS(17,"option",14),hO(18,21),_S(),gS(19,$ge,2,2,"option",16),_S(),_S(),wS(20,"div",12),gS(21,qge,4,3,"select",22),_S(),gS(22,Wge,2,1,"p",23),_S(),_S(),gS(23,Kge,3,2,"div",24),_S()}if(2&e){var r=MS();LE(3),dO(r.gameComponent.rules.node.gameState.turn+1),vO(3),LE(4),kS("ngModel",r.playerSelection[0]),LE(3),kS("ngForOf",r.gameComponent.availableMinimaxes),LE(2),kS("ngIf",!1===r.players[0].equalsValue("human")),LE(1),kS("ngIf",r.gameComponent.scores.isPresent()),LE(3),kS("ngModel",r.playerSelection[1]),LE(3),kS("ngForOf",r.gameComponent.availableMinimaxes),LE(2),kS("ngIf",!1===r.players[1].equalsValue("human")),LE(1),kS("ngIf",r.gameComponent.scores.isPresent()),LE(1),kS("ngIf",r.endGame)}}function Xge(e,t){if(1&e&&(bS(0),iP(1),ES(2,"br"),SS()),2&e){var n=t.$implicit,r=MS(3);LE(1),oP(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function Jge(e,t){if(1&e&&(bS(0),gS(1,Xge,3,1,"ng-container",48),iP(2),ES(3,"br"),iP(4),ES(5,"br"),SS()),2&e){var n=MS(2);LE(1),kS("ngForOf",n.gameComponent.availableMinimaxes),LE(1),oP(" Created ",n.getCreatedNodes()," nodes."),LE(2),oP(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function eye(e,t){if(1&e){var n=PS();wS(0,"button",49),IS("click",function(){return tC(n),MS(2).gameComponent.pass()}),hO(1,50),_S()}}function tye(e,t){if(1&e){var n=PS();wS(0,"button",51),IS("click",function(){return tC(n),MS(2).takeBack()}),hO(1,52),_S()}}function nye(e,t){if(1&e){var n=PS();wS(0,"div",43),gS(1,Jge,6,3,"ng-container",38),gS(2,eye,2,0,"button",44),gS(3,tye,2,0,"button",45),wS(4,"button",46),IS("click",function(){return tC(n),MS().restartGame()}),hO(5,47),_S(),_S()}if(2&e){var r=MS();LE(1),kS("ngIf",r.gameComponent.rules.node.move),LE(1),kS("ngIf",!1===r.endGame&&r.gameComponent.canPass),LE(1),kS("ngIf",r.canTakeBack())}}var rye=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=MB.empty(),u.botTimeOut=1e3,u.players=[MB.of(u.playerSelection[0]),MB.of(u.playerSelection[1])],u.role=X7.ZERO,TB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return vy(n,[{key:"getCreatedNodes",value:function(){return Dte.createdNodes}},{key:"getMinimaxTime",value:function(){return Dte.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=MB.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?X7.ONE:X7.ZERO),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:TB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=MB.of($localize(Sp||(Sp=Gg(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return MB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?MB.empty():MB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return D7((r=t.gameComponent.rules).getGameStatus(r.node)===Fte.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),LB.SUCCESS):(t.messageDisplayer.criticalMessage($localize(Pp||(Pp=Gg(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),N7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new Lte(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=MB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(ype);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(SO),mS(jD),mS(z7),mS(pF),mS(x7),mS(tT))},e.\u0275cmp=lk({type:e,selectors:[["app-local-game-wrapper"]],features:[Xb],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Op||(Op=Gg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(Tp||(Tp=Gg(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(Ip||(Ip=Gg(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(Ap||(Ap=Gg(["Pick the level"]))),$localize(Rp||(Rp=Gg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(Mp||(Mp=Gg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(xp||(xp=Gg(["Pick the level"]))),$localize(Np||(Np=Gg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Dp||(Dp=Gg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Lp||(Lp=Gg(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Fp||(Fp=Gg(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Up||(Up=Gg(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Vp||(Vp=Gg(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Bp||(Bp=Gg(["Take back move"])))]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"div",1),gS(2,Qge,24,10,"div",2),gS(3,nye,6,3,"div",3),_S(),wS(4,"div",4),wS(5,"div",5),ES(6,"app-game-includer"),_S(),_S(),_S()),2&e&&(LE(2),kS("ngIf",t.gameComponent),LE(1),kS("ngIf",t.gameComponent),LE(1),kS("ngClass",t.getBoardHighlight()))},directives:[aR,tR,ppe,Px,LM,vx,Ox,Rx,rR],encapsulation:2,changeDetection:0}),e}(),iye=function(){var e=vy(function e(){hy(this,e)});return e.STEP_FINISHED=function(){return $localize(zp||(zp=Gg(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(Hp||(Hp=Gg(["This step is not expecting any move from your part."])))},e}();function aye(e,t){if(1&e&&(wS(0,"div",20),wS(1,"div",21),hO(2,22),_S(),wS(3,"div",23),iP(4),_S(),_S()),2&e){var n=MS();LE(4),aP(n.currentReason.get())}}function oye(e,t){if(1&e){var n=PS();wS(0,"button",24),IS("click",function(){return tC(n),MS().retry()}),hO(1,25),_S()}}function sye(e,t){1&e&&(bS(0),hO(1,30),SS())}function uye(e,t){1&e&&(bS(0),hO(1,31),SS())}function cye(e,t){if(1&e&&gS(0,uye,2,0,"ng-container",27),2&e){MS();var n=yS(5),r=MS();kS("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function lye(e,t){1&e&&(bS(0),hO(1,32),SS())}function fye(e,t){if(1&e){var n=PS();wS(0,"button",26),IS("click",function(){return tC(n),MS().next()}),gS(1,sye,2,0,"ng-container",27),gS(2,cye,1,2,"ng-template",null,28,JT),gS(4,lye,2,0,"ng-template",null,29,JT),_S()}if(2&e){var r=yS(3),i=MS();LE(1),kS("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function hye(e,t){if(1&e){var n=PS();wS(0,"button",33),IS("click",function(){return tC(n),MS().start()}),hO(1,34),_S()}}function dye(e,t){if(1&e){var n=PS();wS(0,"button",35),IS("click",function(){return tC(n),MS().playLocally()}),hO(1,36),_S()}}function vye(e,t){if(1&e){var n=PS();wS(0,"button",37),IS("click",function(){return tC(n),MS().createGame()}),hO(1,38),_S()}}function pye(e,t){if(1&e){var n=PS();wS(0,"button",39),IS("click",function(){return tC(n),MS().showSolution()}),hO(1,40),_S()}}function gye(e,t){if(1&e&&(bS(0),wS(1,"option",42),iP(2),_S(),SS()),2&e){var n=MS(),r=n.index,i=n.$implicit;LE(1),NS("id","step_",r,""),kS("value",r),LE(1),aP(i.title)}}function yye(e,t){1&e&&(bS(0),iP(1,"v "),SS())}function mye(e,t){1&e&&iP(0,"x ")}function kye(e,t){if(1&e&&(wS(0,"option",43),gS(1,yye,2,0,"ng-container",27),gS(2,mye,1,0,"ng-template",null,44,JT),wS(4,"span",45),iP(5),_S(),_S()),2&e){var n=yS(3),r=MS(),i=r.index,a=r.$implicit,o=MS();kS("value",i),LE(1),kS("ngIf",o.stepFinished[i])("ngIfElse",n),LE(3),NS("id","step_",i,""),LE(1),aP(a.title)}}function Cye(e,t){if(1&e&&(bS(0),gS(1,gye,3,3,"ng-container",27),gS(2,kye,6,5,"ng-template",null,41,JT),SS()),2&e){var n=t.index,r=yS(3),i=MS();LE(1),kS("ngIf",n===i.stepIndex)("ngIfElse",r)}}var wye=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r,i,a,o,s){var u;return hy(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(Gp||(Gp=Gg(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=MB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,TB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.role=X7.ZERO,u}return vy(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return TB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){TB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){TB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t,r=this.steps[this.stepIndex];if(this.currentMessage=r.instruction,this.currentReason=MB.empty(),r.previousState.isPresent()){var i=new Lte(r.previousState.get());t=MB.of(i)}else t=MB.empty();this.gameComponent.rules.node=new Lte(r.state,t,r.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:TB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],D7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),TB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.mother.get().gameState,o=t.gameComponent.rules.node.gameState,(s=OB.getNonNullable(i.predicate)(e,a,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=MB.of(s.getReason())):i.isAnyMove()?(TB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(D7(i.isMove(),"cannot reach here with a click step"),(u=i).acceptedMoves.some(function(t){return t.equals(e)})?(TB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(u.getSuccessMessage())):(TB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=MB.of(u.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){TB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(TB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=MB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return LB.failure(iye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,OB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),LB.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),LB.SUCCESS):LB.failure(iye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){TB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=MB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){TB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=cy(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:TB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),D7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof Ite?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=OB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=OB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(ype);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(mS(SO),mS(jD),mS(pF),mS(x7),mS(tT),mS(z7))},e.\u0275cmp=lk({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[Xb],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize($p||($p=Gg(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Zp||(Zp=Gg(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(qp||(qp=Gg(["Ok"]))),$localize(Wp||(Wp=Gg(["Continue"]))),$localize(jp||(jp=Gg(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Yp||(Yp=Gg(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Kp||(Kp=Gg(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Qp||(Qp=Gg(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(Xp||(Xp=Gg(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"div",1),wS(2,"div",2),ES(3,"progress",3),wS(4,"div",4),wS(5,"p",5),iP(6),_S(),ES(7,"p",6),_S(),gS(8,aye,5,1,"div",7),wS(9,"div",8),gS(10,oye,2,0,"button",9),gS(11,fye,6,2,"button",10),gS(12,hye,2,0,"button",11),gS(13,dye,2,0,"button",12),gS(14,vye,2,0,"button",13),gS(15,pye,2,0,"button",14),wS(16,"div",15),wS(17,"select",16),IS("change",function(e){return t.changeStep(e)}),gS(18,Cye,4,2,"ng-container",17),_S(),_S(),_S(),_S(),_S(),wS(19,"div",18),wS(20,"div",19),ES(21,"app-game-includer"),_S(),_S(),_S()),2&e&&(LE(3),fS("value",t.successfulSteps)("max",t.getNumberOfSteps()),LE(3),uP("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),LE(1),kS("innerHTML",t.currentMessage,T_),LE(1),kS("ngIf",t.currentReason.isPresent()),LE(2),kS("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),LE(1),kS("ngIf",!1===t.tutorialOver),LE(1),kS("ngIf",t.tutorialOver),LE(1),kS("ngIf",t.tutorialOver),LE(1),kS("ngIf",t.tutorialOver),LE(1),kS("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),LE(3),kS("ngForOf",t.steps),LE(1),kS("ngClass",t.getBoardHighlight()))},directives:[aR,rR,tR,ppe,Ox,Rx],encapsulation:2,changeDetection:0}),e}();function _ye(e,t){if(1&e&&(wS(0,"div",35),wS(1,"div",36),hO(2,37),_S(),wS(3,"div",38),iP(4),_S(),_S()),2&e){var n=MS();LE(4),aP(n.errorMessage)}}var Eye=function(){return["/login"]},bye=function(){var e=function(){function e(t,n){hy(this,e),this.authService=t,this.router=n,this.faEye=y9,this.registrationForm=new sx({email:new ox,username:new ox,password:new ox})}return vy(e,[{key:"registerWithEmail",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Jp||(Jp=Gg(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(z7),mS(pF))},e.\u0275cmp=lk({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(eg||(eg=Gg(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(tg||(tg=Gg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(ng||(ng=Gg(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(rg||(rg=Gg(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(ig||(ig=Gg(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(ag||(ag=Gg(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(og||(og=Gg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(sg||(sg=Gg(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(ug||(ug=Gg(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(cg||(cg=Gg(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(lg||(lg=Gg(["Register with Google"]))),[1,"help","level-right"],$localize(fg||(fg=Gg(["Have an account?"]))),[3,"routerLink"],$localize(hg||(hg=Gg(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(dg||(dg=Gg(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"p",1),hO(2,2),_S(),wS(3,"form",3),wS(4,"div",4),wS(5,"div",5),wS(6,"label",6),hO(7,7),_S(),_S(),wS(8,"div",8),wS(9,"div",9),wS(10,"div",10),ES(11,"input",11),wS(12,"p",12),hO(13,13),_S(),_S(),_S(),_S(),_S(),wS(14,"div",4),wS(15,"div",5),wS(16,"label",14),hO(17,15),_S(),_S(),wS(18,"div",8),wS(19,"div",9),wS(20,"div",10),ES(21,"input",16),_S(),_S(),_S(),_S(),wS(22,"div",4),wS(23,"div",5),wS(24,"label",17),hO(25,18),_S(),_S(),wS(26,"div",8),wS(27,"div",9),wS(28,"div",19),ES(29,"input",20),wS(30,"span",21),ES(31,"fa-icon",22),_S(),wS(32,"p",23),hO(33,24),_S(),_S(),_S(),_S(),_S(),wS(34,"div",4),ES(35,"div",5),wS(36,"div",8),wS(37,"div",9),wS(38,"div",10),wS(39,"button",25),IS("click",function(){return t.registerWithEmail()}),hO(40,26),_S(),_S(),_S(),_S(),_S(),wS(41,"div",4),ES(42,"div",5),wS(43,"div",27),gS(44,_ye,5,1,"div",28),_S(),_S(),wS(45,"div",4),ES(46,"div",5),wS(47,"div",8),wS(48,"button",29),IS("click",function(){return t.registerWithGoogle()}),hO(49,30),_S(),_S(),_S(),wS(50,"p",31),bS(51),hO(52,32),SS(),iP(53,"\xa0 "),wS(54,"a",33),hO(55,34),_S(),_S(),_S(),_S()),2&e&&(LE(3),kS("formGroup",t.registrationForm),LE(28),kS("icon",t.faEye),LE(1),kS("ngClass",t.getPasswordHelpClass()),LE(7),kS("disabled",!t.canRegister()),LE(5),kS("ngIf",t.errorMessage),LE(10),kS("routerLink",PT(6,Eye)))},directives:[px,FM,wx,oM,LM,Ex,Vve,xx,$ee,Bve,tR,aR,mF],encapsulation:2}),e}(),Sye=function(){var e=function(){function e(t){hy(this,e),this.router=t}return vy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF))},e.\u0275cmp=lk({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(vg||(vg=Gg(["Play offline"])))]},template:function(e,t){1&e&&(wS(0,"app-pick-game",0),IS("pickGame",function(e){return t.pickGame(e)}),_S(),wS(1,"button",1),IS("click",function(){return t.playLocally()}),hO(2,2),_S()),2&e&&(LE(1),kS("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),Pye=function(){var e=function(){function e(t){hy(this,e),this.router=t}return vy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(pF))},e.\u0275cmp=lk({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(pg||(pg=Gg(["Learn the rules"])))]},template:function(e,t){1&e&&(wS(0,"app-pick-game",0),IS("pickGame",function(e){return t.pickGame(e)}),_S(),wS(1,"button",1),IS("click",function(){return t.launchTutorial()}),hO(2,2),_S()),2&e&&(LE(1),kS("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),Oye=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=lk({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(gg||(gg=Gg(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(wS(0,"p"),hO(1,0),_S())},encapsulation:2}),e}();function Tye(e,t){if(1&e&&(AC(),ES(0,"polygon",4)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessQueenComponent.HEPTAGON)}}function Iye(e,t){if(1&e&&(AC(),ES(0,"polygon",4)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Aye(e,t){if(1&e&&(AC(),ES(0,"circle",5)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Rye(e,t){if(1&e&&(bS(0),AC(),ES(1,"circle",6),ES(2,"circle",6),ES(3,"circle",6),SS()),2&e){var n=MS();LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Mye(e,t){if(1&e&&(AC(),wS(0,"g"),ES(1,"circle",7),ES(2,"circle",7),ES(3,"circle",7),_S()),2&e){var n=MS();LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),LE(1),fS("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),LE(1),fS("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function xye(e,t){if(1&e&&(AC(),wS(0,"g",8),ES(1,"circle",9),ES(2,"circle",9),ES(3,"circle",9),_S()),2&e){var n=MS();kS("ngClass",n.pieceClasses),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var Nye=vy(function e(){hy(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=_ce,this.horizontalDotsRadius=_ce.SPACE_SIZE/15});function Dye(e,t){if(1&e&&(AC(),ES(0,"polygon",4)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessDroneComponent.PENTAGON)}}function Lye(e,t){if(1&e&&(AC(),ES(0,"polygon",4)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Fye(e,t){if(1&e&&(AC(),ES(0,"circle",5)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Uye(e,t){if(1&e&&(bS(0),AC(),ES(1,"circle",6),ES(2,"circle",6),SS()),2&e){var n=MS();LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Vye(e,t){if(1&e&&(AC(),wS(0,"g",7),ES(1,"circle",8),ES(2,"circle",8),_S()),2&e){var n=MS();kS("ngClass",n.pieceClasses),LE(1),fS("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),LE(1),fS("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Bye(e,t){if(1&e&&(AC(),wS(0,"g",7),ES(1,"circle",9),ES(2,"circle",9),_S()),2&e){var n=MS();kS("ngClass",n.pieceClasses),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Nye.HEPTAGON=_ce.getRegularPolygon(7),Nye.EIGHT_POINTED_STAR=_ce.getNPointedStar(8,0),Nye.\u0275fac=function(e){return new(e||Nye)},Nye.\u0275cmp=lk({type:Nye,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(gS(0,Tye,1,3,"polygon",0),gS(1,Iye,1,3,"polygon",0),gS(2,Aye,1,5,"circle",1),gS(3,Rye,4,9,"ng-container",2),gS(4,Mye,4,9,"g",2),gS(5,xye,4,10,"g",3)),2&e&&(kS("ngIf","Polygon"===t.style.shape),LE(1),kS("ngIf","Star"===t.style.shape),LE(1),kS("ngIf","Circle"===t.style.shape),LE(1),kS("ngIf","Concentric Circles"===t.style.points),LE(1),kS("ngIf","Dots"===t.style.points),LE(1),kS("ngIf","Horizontal Points"===t.style.points))},directives:[aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var zye=vy(function e(){hy(this,e),this.MartianChessComponent=_ce,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=_ce.SPACE_SIZE/15});function Hye(e,t){if(1&e&&(AC(),ES(0,"polygon",5)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessPawnComponent.TRIANGLE)}}function Gye(e,t){if(1&e&&(AC(),ES(0,"polygon",5)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function $ye(e,t){if(1&e&&(AC(),ES(0,"circle",6)),2&e){var n=MS();kS("id",n.mainShapeId)("ngClass",n.pieceClasses),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Zye(e,t){if(1&e&&(AC(),ES(0,"circle",7)),2&e){var n=MS();fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function qye(e,t){if(1&e&&(AC(),ES(0,"circle",8)),2&e){var n=MS();fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Wye(e,t){if(1&e&&(AC(),wS(0,"g",9),ES(1,"circle",10),_S()),2&e){var n=MS();kS("ngClass",n.pieceClasses),LE(1),fS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}zye.FOUR_POINTED_STAR_VERTICAL=_ce.getNPointedStar(4,0),zye.PENTAGON=_ce.getRegularPolygon(5),zye.\u0275fac=function(e){return new(e||zye)},zye.\u0275cmp=lk({type:zye,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(gS(0,Dye,1,3,"polygon",0),gS(1,Lye,1,3,"polygon",0),gS(2,Fye,1,5,"circle",1),gS(3,Uye,3,6,"ng-container",2),gS(4,Vye,3,7,"g",3),gS(5,Bye,3,7,"g",3)),2&e&&(kS("ngIf","Polygon"===t.style.shape),LE(1),kS("ngIf","Star"===t.style.shape),LE(1),kS("ngIf","Circle"===t.style.shape),LE(1),kS("ngIf","Concentric Circles"===t.style.points),LE(1),kS("ngIf","Dots"===t.style.points),LE(1),kS("ngIf","Horizontal Points"===t.style.points))},directives:[aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var jye=function(){function e(){hy(this,e),this.MartianChessComponent=_ce,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=_ce.SPACE_SIZE/15}return vy(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return _ce.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=_ce.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();jye.FOUR_POINTED_STAR_DIAGONAL=_ce.getNPointedStar(4,45),jye.TRIANGLE_Y_OFFSET=jye.yOffsetForVerticalCentering(),jye.TRIANGLE=jye.getTriangle(),jye.\u0275fac=function(e){return new(e||jye)},jye.\u0275cmp=lk({type:jye,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(gS(0,Hye,1,3,"polygon",0),gS(1,Gye,1,3,"polygon",0),gS(2,$ye,1,5,"circle",1),gS(3,Zye,1,3,"circle",2),gS(4,qye,1,3,"circle",3),gS(5,Wye,2,4,"g",4)),2&e&&(kS("ngIf","Polygon"===t.style.shape),LE(1),kS("ngIf","Star"===t.style.shape),LE(1),kS("ngIf","Circle"===t.style.shape),LE(1),kS("ngIf","Concentric Circles"===t.style.points),LE(1),kS("ngIf","Dots"===t.style.points),LE(1),kS("ngIf","Horizontal Points"===t.style.points))},directives:[aR,tR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Yye={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"},Kye=function(){var e=function(){function e(t){hy(this,e),this.authService=t}return vy(e,[{key:"canActivate",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.subscribeToUser((n=PB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Lw(z7))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Qye=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e)).router=r,i}return vy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Kye);return e.\u0275fac=function(t){return new(t||e)(Lw(z7),Lw(pF))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Xye(e,t){1&e&&(wS(0,"p",20),hO(1,21),_S())}function Jye(e,t){if(1&e){var n=PS();wS(0,"div",7),wS(1,"p",8),hO(2,9),_S(),wS(3,"div",10),wS(4,"p",11),hO(5,12),_S(),wS(6,"button",13),IS("click",function(){return tC(n),MS().finalizeEmailVerification()}),hO(7,14),_S(),_S(),wS(8,"div",15),wS(9,"p",11),hO(10,16),_S(),wS(11,"button",17),IS("click",function(){return tC(n),MS().sendEmailVerification()}),hO(12,18),_S(),_S(),gS(13,Xye,2,0,"p",19),_S()}if(2&e){var r=MS();LE(2),dO(r.emailAddress),vO(2),LE(11),kS("ngIf",r.success)}}function eme(e,t){if(1&e){var n=PS();wS(0,"div",24),wS(1,"div",8),hO(2,25),_S(),wS(3,"form",26),wS(4,"div",27),wS(5,"div",28),ES(6,"input",29),_S(),wS(7,"div",28),wS(8,"button",30),IS("click",function(){tC(n);var e=MS(2);return e.pickUsername(e.usernameForm.value)}),hO(9,31),_S(),_S(),_S(),_S(),_S()}if(2&e){var r=MS(2);LE(3),kS("formGroup",r.usernameForm)}}var tme=function(){return["/lobby"]};function nme(e,t){1&e&&(wS(0,"div",32),lO(1,33),ES(2,"a",34),fO(),_S()),2&e&&(LE(2),kS("routerLink",PT(1,tme)))}function rme(e,t){if(1&e&&(bS(0),gS(1,eme,10,1,"div",22),gS(2,nme,3,2,"div",23),SS()),2&e){var n=MS();LE(1),kS("ngIf",!n.success),LE(1),kS("ngIf",n.success)}}function ime(e,t){if(1&e&&(wS(0,"div",35),wS(1,"div",36),iP(2),_S(),_S()),2&e){var n=MS();LE(2),aP(n.errorMessage)}}var ame=function(){var e=function(){function e(t,n){hy(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new sx({username:new ox})}return vy(e,[{key:"ngOnInit",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.subscribeToUser(function(){var t=PB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(yg||(yg=Gg(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(z7),mS(pF))},e.\u0275cmp=lk({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(mg||(mg=Gg(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(kg||(kg=Gg(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(Cg||(Cg=Gg(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(wg||(wg=Gg(["Finalize email verification"]))),[1,"level-left"],$localize(_g||(_g=Gg(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(Eg||(Eg=Gg(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(bg||(bg=Gg(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(Sg||(Sg=Gg(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(Pg||(Pg=Gg(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(Og||(Og=Gg(["Pick username"]))),["id","success",1,"message-body"],$localize(Tg||(Tg=Gg(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"div",1),wS(2,"div",2),hO(3,3),_S(),gS(4,Jye,14,2,"div",4),gS(5,rme,3,2,"ng-container",5),_S(),gS(6,ime,3,1,"div",6),_S()),2&e&&(LE(4),kS("ngIf","send-email"===t.verificationType),LE(1),kS("ngIf","enter-username"===t.verificationType),LE(1),kS("ngIf",t.errorMessage))},directives:[aR,px,FM,wx,oM,xx,LM,Ex,mF],encapsulation:2}),e}(),ome=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e)).router=r,i}return vy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Kye);return e.\u0275fac=function(t){return new(t||e)(Lw(z7),Lw(pF))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),sme=function(){var e=function(e){ey(n,e);var t=ny(n);function n(e,r){var i;return hy(this,n),(i=t.call(this,e)).router=r,i}return vy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Kye);return e.\u0275fac=function(t){return new(t||e)(Lw(z7),Lw(pF))},e.\u0275prov=Nm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function ume(e,t){1&e&&(wS(0,"p",12),hO(1,13),_S())}function cme(e,t){if(1&e&&(wS(0,"div",14),wS(1,"div",15),hO(2,16),_S(),wS(3,"div",17),iP(4),_S(),_S()),2&e){var n=MS();LE(4),aP(n.errorMessage.get())}}var lme=function(){return{standalone:!0}},fme=function(){var e=function(){function e(t){hy(this,e),this.authService=t,this.success=!1,this.errorMessage=MB.empty(),this.email=""}return vy(e,[{key:"resetPassword",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=MB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=MB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(z7))},e.\u0275cmp=lk({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(Ig||(Ig=Gg(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(Ag||(Ag=Gg(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(Rg||(Rg=Gg(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(Mg||(Mg=Gg(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(xg||(xg=Gg(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Ng||(Ng=Gg(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"p",1),hO(2,2),_S(),wS(3,"div",3),wS(4,"div",4),wS(5,"input",5),IS("ngModelChange",function(e){return t.email=e}),_S(),wS(6,"p",6),hO(7,7),_S(),gS(8,ume,2,0,"p",8),_S(),_S(),wS(9,"button",9),IS("click",function(){return t.resetPassword()}),hO(10,10),_S(),gS(11,cme,5,1,"div",11),_S()),2&e&&(LE(5),kS("ngModel",t.email)("ngModelOptions",PT(5,lme)),LE(3),kS("ngIf",t.success),LE(1),kS("disabled",""===t.email),LE(2),kS("ngIf",t.errorMessage.isPresent()))},directives:[oM,Vve,xx,LM,vx,aR],encapsulation:2}),e}();function hme(e,t){if(1&e&&(wS(0,"option",13),iP(1),_S()),2&e){var n=t.$implicit,r=MS();kS("value",n.value)("selected",n.value===r.currentTheme),LE(1),oP(" ",n.name," ")}}function dme(e,t){if(1&e&&(wS(0,"option",13),iP(1),_S()),2&e){var n=t.$implicit,r=MS();kS("value",n.value)("selected",n.value===r.currentLanguage),LE(1),oP(" ",n.name," ")}}var vme=function(){var e=function(){function e(t,n){hy(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Dg||(Dg=Gg(["Light"])))},{value:"dark",name:$localize(Lg||(Lg=Gg(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return vy(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(h9),mS(d9))},e.\u0275cmp=lk({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Fg||(Fg=Gg(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Ug||(Ug=Gg(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Vg||(Vg=Gg(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(wS(0,"div",0),wS(1,"p",1),hO(2,2),_S(),wS(3,"div",3),wS(4,"label",4),hO(5,5),_S(),wS(6,"div",6),wS(7,"div",7),wS(8,"select",8),IS("change",function(e){return t.changeTheme(e)}),gS(9,hme,2,3,"option",9),_S(),_S(),_S(),_S(),wS(10,"div",3),wS(11,"label",10),hO(12,11),_S(),wS(13,"div",6),wS(14,"div",7),wS(15,"select",12),IS("change",function(e){return t.changeLanguage(e)}),gS(16,dme,2,3,"option",9),_S(),_S(),_S(),_S(),_S()),2&e&&(LE(9),kS("ngForOf",t.availableThemes),LE(7),kS("ngForOf",t.availableLanguages))},directives:[rR,Ox,Rx],encapsulation:2}),e}(),pme=function(){var e=vy(function e(){hy(this,e)});return e.ALREADY_INGAME=function(){return $localize(Bg||(Bg=Gg(["You are already in a game. Finish it or cancel it first."])))},e}(),gme=function(){var e=function(){function e(t,n,r,i,a,o){hy(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.activePartsService=a,this.gameService=o}return vy(e,[{key:"ngOnInit",value:function(){var e=this;return PB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return OB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(D7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",gpe.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartConfigRoomAndChat(e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(pme.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return MB.ofNullable(xve.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return PB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.activePartsService.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(mS(jD),mS(pF),mS(z7),mS(x7),mS(qve),mS(s9))},e.\u0275cmp=lk({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(zg||(zg=Gg(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(wS(0,"p"),hO(1,0),_S())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[gP.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),hP[t]=e,n&&(hP[t][gP.ExtraData]=n)}(e,void 0,void 0)}(bB());var yme=[{path:"login",component:$ve},{path:"lobby",component:hpe,canActivate:[Qye]},{path:"settings",component:vme},{path:"register",component:bye,canActivate:[sme]},{path:"reset-password",component:fme,canActivate:[sme]},{path:"notFound/:message",component:dpe},{path:"nextGameLoading",component:Oye,canActivate:[Qye]},{path:"verify-account",component:ame,canActivate:[ome]},{path:"play",component:Wve,canActivate:[Qye]},{path:"play/:compo",component:gme,canActivate:[Qye]},{path:"play/:compo/:id",component:Uge,canActivate:[Qye]},{path:"local",component:Sye},{path:"local/:compo",component:rye},{path:"tutorial",component:Pye},{path:"tutorial/:compo",component:wye},{path:"",component:Uve},{path:"**",component:dpe}],mme=function(){function e(){hy(this,e)}return vy(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:e4,providers:[{provide:K3,useFactory:J3(e),multi:!0,deps:[wI,Kb,z3].concat(n)}]}}(function(){return t4(Yye)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:h7,providers:[{provide:u7,useFactory:c7(e),multi:!0,deps:[wI,Kb,z3,Y3,[new $w,W8],[new $w,N4]].concat(n)}]}}(function(){var e=k7();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:X8,providers:[{provide:j8,useFactory:Y8(e),multi:!0,deps:[wI,Kb,z3,Y3,[new $w,N4]].concat(n)}]}}(function(){return e7()})}}]),e}(),kme=function(){var e=vy(function e(){hy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=vk({type:e,bootstrap:[ate]}),e.\u0275inj=Dm({providers:[z7,s9,o9,F7,A7,d9,{provide:cI,useValue:f9.getLocale()}],imports:[[mme.app(),mme.firestore(),mme.auth(),qR,_N,AF.forRoot(yme,{useHash:!1}),Ux,Fx,_B,Zee]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map(fk)},r.pipeDefs=function(){return n.map(hk)}}(_ce,[rR,tR,aR,jye,zye,Nye],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var Cme=function(){function e(t){hy(this,e),this.digits=t}return vy(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),wme=function(){function e(t){hy(this,e),this.powerOfTwos=[t]}return vy(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=Cme.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),_me=function(){function e(t){hy(this,e),this.base=t,this.exponents=[new wme(Cme.one())]}return vy(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new wme(n)}return this.exponents[e]}}]),e}();function Eme(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=bme(t,0),r=bme(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function bme(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=Sme(r=Ome(r,Rme(e,n,Pme.Little)),i=Ome(i,Rme(e,n+4,Pme.Little)),t=Ome(t,Rme(e,n+8,Pme.Little)));r=o[0],i=o[1],t=o[2]}return r=Ome(r,Rme(e,n,Pme.Little)),i=Ome(i,Rme(e,n+4,Pme.Little)),t=Ome(t,a),Sme(r,i,t=Ome(t,Rme(e,n+8,Pme.Little)<<8))[2]}function Sme(e,t,n){return e=Ime(e,t),e=Ime(e,n),e^=n>>>13,t=Ime(t,n),t=Ime(t,e),t^=e<<8,n=Ime(n,e),n=Ime(n,t),n^=t>>>13,e=Ime(e,t),e=Ime(e,n),e^=n>>>12,t=Ime(t,n),t=Ime(t,e),t^=e<<16,n=Ime(n,e),n=Ime(n,t),n^=t>>>5,e=Ime(e,t),e=Ime(e,n),e^=n>>>3,t=Ime(t,n),t=Ime(t,e),t^=e<<10,n=Ime(n,e),n=Ime(n,t),[e,t,n^=t>>>15]}var Pme=((Pme=Pme||{})[Pme.Little=0]="Little",Pme[Pme.Big=1]="Big",Pme);function Ome(e,t){return Tme(e,t)[1]}function Tme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Ime(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Ame(e,t){return t>=e.length?0:e[t]}function Rme(e,t,n){var r=0;if(n===Pme.Big)for(var i=0;i<4;i++)r+=Ame(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Ame(e,t+a)<<8*a;return r}var Mme=new _me(256);function xme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function Nme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Dme=function(e){ey(n,e);var t=ny(n);function n(e){var r;return hy(this,n),(r=t.call(this,"No translation found for ".concat(Fme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return vy(n)}(Kg(Error));function Lme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Fme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Ume(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=xme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=Hg(i.split("\u241f")),o=a[0],s=a.slice(1),u=Wg(o.split("@@",2),2),c=u[0],l=u[1],f=Wg(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=xme(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?Nme(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Eme(e);if(t){var r=Eme(t);n=function(e,t){var n=e[0],r=t[0],i=Tme(e[1],t[1]),a=i[0],o=i[1];return[Ome(Ome(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=Mme.toThePowerOf(0).multiplyBy(t);return Mme.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Dme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Fme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Vme(){(function(){if(xI)throw new Error("Cannot enable prod mode after platform setup.");MI=!1})(),$R().bootstrapModule(kme).catch(function(e){return console.error(e)})}var Bme=f9.getLocale();"en"!==Bme?fetch("/assets/"+Bme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Ume),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:Lme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Vme()}).catch(function(e){console.log(e)}):Vme()}},function(e){e(e.s=4975)}])}();