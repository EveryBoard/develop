!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,b,E,P,S,O,T,I,A,M,x,R,N,D,L,F,U,V,B,z,H,G,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,be,Ee,Pe,Se,Oe,Te,Ie,Ae,Me,xe,Re,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,bt,Et,Pt,St,Ot,Tt,It,At,Mt,xt,Rt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,bn,En,Pn,Sn,On,Tn,In,An,Mn,xn,Rn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,br,Er,Pr,Sr,Or,Tr,Ir,Ar,Mr,xr,Rr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,bi,Ei,Pi,Si,Oi,Ti,Ii,Ai,Mi,xi,Ri,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,ba,Ea,Pa,Sa,Oa,Ta,Ia,Aa,Ma,xa,Ra,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,bo,Eo,Po,So,Oo,To,Io,Ao,Mo,xo,Ro,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,bs,Es,Ps,Ss,Os,Ts,Is,As,Ms,xs,Rs,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,bu,Eu,Pu,Su,Ou,Tu,Iu,Au,Mu,xu,Ru,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,bc,Ec,Pc,Sc,Oc,Tc,Ic,Ac,Mc,xc,Rc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,bl,El,Pl,Sl,Ol,Tl,Il,Al,Ml,xl,Rl,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,bf,Ef,Pf,Sf,Of,Tf,If,Af,Mf,xf,Rf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,bh,Eh,Ph,Sh,Oh,Th,Ih,Ah,Mh,xh,Rh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,bd,Ed,Pd,Sd,Od,Td,Id,Ad,Md,xd,Rd,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,bv,Ev,Pv,Sv,Ov,Tv,Iv,Av,Mv,xv,Rv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,bp,Ep,Pp,Sp,Op,Tp,Ip,Ap,Mp,xp,Rp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg,wg,_g,bg,Eg,Pg,Sg,Og,Tg,Ig,Ag,Mg,xg,Rg,Ng,Dg,Lg,Fg,Ug,Vg,Bg,zg,Hg,Gg,$g,Zg,qg,Wg,jg,Yg,Kg,Qg,Xg;function Jg(e){return oy(e)||ky(e)||wy(e)||ay()}function ey(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ny(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(n),!0).forEach(function(t){ry(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ty(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ry(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iy(e,t){return oy(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||wy(e,t)||ay()}function ay(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oy(e){if(Array.isArray(e))return e}function sy(e){var t="function"==typeof Map?new Map:void 0;return sy=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return uy(e,arguments,yy(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),hy(r,e)},sy(e)}function uy(e,t,n){return uy=gy()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&hy(i,n.prototype),i},uy.apply(null,arguments)}function cy(){return cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ly(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},cy.apply(this,arguments)}function ly(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yy(e)););return e}function fy(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hy(e,t)}function hy(e,t){return hy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hy(e,t)}function dy(e){var t=gy();return function(){var n,r=yy(e);if(t){var i=yy(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vy(this,n)}}function vy(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return py(e)}function py(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function yy(e){return yy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yy(e)}function my(e){return function(e){if(Array.isArray(e))return _y(e)}(e)||ky(e)||wy(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ky(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Cy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=wy(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function wy(e,t){if(e){if("string"==typeof e)return _y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_y(e,t):void 0}}function _y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function by(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ey(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Py(e,t,n){return t&&Ey(e.prototype,t),n&&Ey(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},7994:function(ty,ay,oy){"use strict";var ly,hy;function gy(e){return"function"==typeof e}function ky(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var wy=ky(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function _y(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Ey=function(){function e(t){by(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return Py(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Cy(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(gy(a))try{a()}catch(i){e=i instanceof wy?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Cy(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{Ty(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof wy?e=[].concat(my(e),my(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new wy(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)Ty(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&_y(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&_y(n,t),t instanceof e&&t._removeParent(this)}}]),e}();Ey.EMPTY=function(){var e=new Ey;return e.closed=!0,e}();var Sy=Ey.EMPTY;function Oy(e){return e instanceof Ey||e&&"closed"in e&&gy(e.remove)&&gy(e.add)&&gy(e.unsubscribe)}function Ty(e){gy(e)?e():e.unsubscribe()}var Iy=null,Ay=null,My=void 0,xy=!1,Ry=!1,Ny={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Ny.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=Ny.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function Dy(e){Ny.setTimeout(function(){if(!Iy)throw e;Iy(e)})}function Ly(){}var Fy=Uy("C",void 0,void 0);function Uy(e,t,n){return{kind:e,value:t,error:n}}var Vy=null;function By(e){if(xy){var t=!Vy;if(t&&(Vy={errorThrown:!1,error:null}),e(),t){var n=Vy,r=n.errorThrown,i=n.error;if(Vy=null,r)throw i}}else e()}var zy=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,Oy(e)&&e.add(py(r))):r.destination=qy,r}return Py(n,[{key:"next",value:function(e){this.isStopped?Zy(Uy("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?Zy(Uy("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?Zy(Fy,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,cy(yy(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Hy(e,t,n)}}]),n}(Ey),Hy=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a,o,s;if(by(this,n),o=t.call(this),gy(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,py(o)&&Ry?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?Gy(s):Ly,error:Gy(null!==(a=r)&&void 0!==a?a:$y),complete:i?Gy(i):Ly},vy(o)}return Py(n)}(zy);function Gy(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){xy?function(e){xy&&Vy&&(Vy.errorThrown=!0,Vy.error=e)}(t):Dy(t)}}}function $y(e){throw e}function Zy(e,t){var n=Ay;n&&Ny.setTimeout(function(){return n(e,t)})}var qy={closed:!0,next:Ly,error:$y,complete:Ly},Wy="function"==typeof Symbol&&Symbol.observable||"@@observable";function jy(e){return e}var Yy=function(){var e=function(){function e(t){by(this,e),t&&(this._subscribe=t)}return Py(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof zy||function(e){return e&&gy(e.next)&&gy(e.error)&&gy(e.complete)}(e)&&Oy(e)}(e)?e:new Hy(e,t,n);return By(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Ky(t))(function(t,r){var i=new Hy({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Wy,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?jy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Ky(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Ky(e){var t;return null!==(t=null!=e?e:My)&&void 0!==t?t:Promise}var Qy=ky(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Xy=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Py(n,[{key:"lift",value:function(e){var t=new Jy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new Qy}},{key:"next",value:function(e){var t=this;By(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Cy(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;By(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;By(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),cy(yy(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?Sy:(r.push(e),new Ey(function(){return _y(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Yy;return e.source=this,e}}]),n}(Yy);return e.create=function(e,t){return new Jy(e,t)},e}(),Jy=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).destination=e,i.source=r,i}return Py(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Sy}}]),n}(Xy);function em(e){return gy(null==e?void 0:e.lift)}function tm(e){return function(t){if(em(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var nm=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s,u,c,l;return by(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:cy((s=py(l),yy(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:cy((u=py(l),yy(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:cy((c=py(l),yy(n.prototype)),"_complete",c),l}return Py(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;cy(yy(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(zy);function rm(e,t){return tm(function(n,r){var i=0;n.subscribe(new nm(r,function(n){r.next(e.call(t,n,i++))}))})}function im(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function am(e){return this instanceof am?(this.v=e,this):new am(e)}function om(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof am?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function sm(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var um=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function cm(e){return gy(null==e?void 0:e.then)}function lm(e){return gy(e[Wy])}function fm(e){return Symbol.asyncIterator&&gy(null==e?void 0:e[Symbol.asyncIterator])}function hm(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var dm="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function vm(e){return gy(null==e?void 0:e[dm])}function pm(e){return om(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,am(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,am(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,am(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function gm(e){return gy(null==e?void 0:e.getReader)}function ym(e){if(e instanceof Yy)return e;if(null!=e){if(lm(e))return function(e){return new Yy(function(t){var n=e[Wy]();if(gy(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(um(e))return function(e){return new Yy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(cm(e))return function(e){return new Yy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Dy)})}(e);if(fm(e))return mm(e);if(vm(e))return function(e){return new Yy(function(t){var n,r=Cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(gm(e))return function(e){return mm(pm(e))}(e)}throw hm(e)}function mm(e){return new Yy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=sm(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function km(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Cm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return gy(t)?Cm(function(n,r){return rm(function(e,i){return t(n,e,r,i)})(ym(e(n,r)))},n):("number"==typeof t&&(n=t),tm(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;ym(n(i,l++)).subscribe(new nm(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new nm(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function wm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Cm(jy,e)}var _m=new Yy(function(e){return e.complete()});function bm(e){return e[e.length-1]}function Em(e){return gy(bm(e))?e.pop():void 0}function Pm(e){return function(e){return e&&gy(e.schedule)}(bm(e))?e.pop():void 0}function Sm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tm(function(n,r){n.subscribe(new nm(r,function(n){return km(r,e,function(){return r.next(n)},t)},function(){return km(r,e,function(){return r.complete()},t)},function(n){return km(r,e,function(){return r.error(n)},t)}))})}function Om(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tm(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Tm(e,t){if(!e)throw new Error("Iterable cannot be null");return new Yy(function(n){km(n,t,function(){var r=e[Symbol.asyncIterator]();km(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Im(e,t){return t?function(e,t){if(null!=e){if(lm(e))return function(e,t){return ym(e).pipe(Om(t),Sm(t))}(e,t);if(um(e))return function(e,t){return new Yy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(cm(e))return function(e,t){return ym(e).pipe(Om(t),Sm(t))}(e,t);if(fm(e))return Tm(e,t);if(vm(e))return function(e,t){return new Yy(function(n){var r;return km(n,t,function(){r=e[dm](),km(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return gy(null==r?void 0:r.return)&&r.return()}})}(e,t);if(gm(e))return function(e,t){return Tm(pm(e),t)}(e,t)}throw hm(e)}(e,t):ym(e)}function Am(e){return e<=0?function(){return _m}:tm(function(t,n){var r=0;t.subscribe(new nm(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function Mm(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(Am(1)).subscribe(function(){return e()})}function xm(e){for(var t in e)if(e[t]===xm)return t;throw Error("Could not find renamed property on target object.")}function Rm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Nm(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Nm).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Dm(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Lm=xm({__forward_ref__:xm});function Fm(e){return e.__forward_ref__=Fm,e.toString=function(){return Nm(this())},e}function Um(e){return Vm(e)?e():e}function Vm(e){return"function"==typeof e&&e.hasOwnProperty(Lm)&&e.__forward_ref__===Fm}var Bm=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return Py(n)}(sy(Error));function zm(e){return"string"==typeof e?e:null==e?"":String(e)}function Hm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():zm(e)}function Gm(e,t){var n=t?" in ".concat(t):"";throw new Bm("201","No provider for ".concat(Hm(e)," found").concat(n))}function $m(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function Zm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function qm(e){return{providers:e.providers||[],imports:e.imports||[]}}function Wm(e){return jm(e,Qm)||jm(e,Jm)}function jm(e,t){return e.hasOwnProperty(t)?e[t]:null}function Ym(e){return e&&(e.hasOwnProperty(Xm)||e.hasOwnProperty(ek))?e[Xm]:null}var Km,Qm=xm({"\u0275prov":xm}),Xm=xm({"\u0275inj":xm}),Jm=xm({ngInjectableDef:xm}),ek=xm({ngInjectorDef:xm}),tk=((tk=tk||{})[tk.Default=0]="Default",tk[tk.Host=1]="Host",tk[tk.Self=2]="Self",tk[tk.SkipSelf=4]="SkipSelf",tk[tk.Optional=8]="Optional",tk);function nk(e){var t=Km;return Km=e,t}function rk(e,t,n){var r=Wm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&tk.Optional?null:void 0!==t?t:void Gm(Nm(e),"Injector")}function ik(e){return{toString:e}.toString()}var ak=((ak=ak||{})[ak.OnPush=0]="OnPush",ak[ak.Default=1]="Default",ak),ok=((ok=ok||{})[ok.Emulated=0]="Emulated",ok[ok.None=2]="None",ok[ok.ShadowDom=3]="ShadowDom",ok),sk="undefined"!=typeof globalThis&&globalThis,uk="undefined"!=typeof window&&window,ck="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,lk=sk||"undefined"!=typeof global&&global||uk||ck,fk={},hk=[],dk=xm({"\u0275cmp":xm}),vk=xm({"\u0275dir":xm}),pk=xm({"\u0275pipe":xm}),gk=xm({"\u0275mod":xm}),yk=xm({"\u0275loc":xm}),mk=xm({"\u0275fac":xm}),kk=xm({__NG_ELEMENT_ID__:xm}),Ck=0;function wk(e){return ik(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===ak.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||hk,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||ok.Emulated,id:"c",styles:e.styles||hk,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=Ck++,n.inputs=Sk(e.inputs,t),n.outputs=Sk(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(_k)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(bk)}:null,n})}function _k(e){return Ik(e)||function(e){return e[vk]||null}(e)}function bk(e){return function(e){return e[pk]||null}(e)}var Ek={};function Pk(e){return ik(function(){var t={type:e.type,bootstrap:e.bootstrap||hk,declarations:e.declarations||hk,imports:e.imports||hk,exports:e.exports||hk,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Ek[e.id]=e.type),t})}function Sk(e,t){if(null==e)return fk;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var Ok=wk;function Tk(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Ik(e){return e[dk]||null}function Ak(e,t){var n=e[gk]||null;if(!n&&!0===t)throw new Error("Type ".concat(Nm(e)," does not have '\u0275mod' property."));return n}function Mk(e){return Array.isArray(e)&&"object"==typeof e[1]}function xk(e){return Array.isArray(e)&&!0===e[1]}function Rk(e){return 0!=(8&e.flags)}function Nk(e){return 2==(2&e.flags)}function Dk(e){return 1==(1&e.flags)}function Lk(e){return null!==e.template}function Fk(e){return 0!=(512&e[2])}function Uk(e,t){return e.hasOwnProperty(mk)?e[mk]:null}var Vk=function(){function e(t,n,r){by(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return Py(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Bk(){return zk}function zk(e){return e.type.prototype.ngOnChanges&&(e.setInput=Gk),Hk}function Hk(){var e=Zk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===fk)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Gk(e,t,n,r){var i=Zk(e)||function(e,t){return e[$k]=t}(e,{previous:fk,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new Vk(u&&u.currentValue,t,o===fk),e[r]=t}Bk.ngInherit=!0;var $k="__ngSimpleChanges__";function Zk(e){return e[$k]||null}var qk,Wk="http://www.w3.org/2000/svg";function jk(){return void 0!==qk?qk:"undefined"!=typeof document?document:void 0}function Yk(e){return!!e.listen}var Kk={createRenderer:function(e,t){return jk()}};function Qk(e){for(;Array.isArray(e);)e=e[0];return e}function Xk(e,t){return Qk(t[e])}function Jk(e,t){return Qk(t[e.index])}function eC(e,t){return e.data[t]}function tC(e,t){return e[t]}function nC(e,t){var n=t[e];return Mk(n)?n:n[0]}function rC(e){return 4==(4&e[2])}function iC(e){return 128==(128&e[2])}function aC(e,t){return null==t?null:e[t]}function oC(e){e[18]=0}function sC(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var uC={lFrame:NC(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function cC(){return uC.bindingsEnabled}function lC(){return uC.lFrame.lView}function fC(){return uC.lFrame.tView}function hC(e){return uC.lFrame.contextLView=e,e[8]}function dC(){for(var e=vC();null!==e&&64===e.type;)e=e.parent;return e}function vC(){return uC.lFrame.currentTNode}function pC(){var e=uC.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function gC(e,t){var n=uC.lFrame;n.currentTNode=e,n.isParent=t}function yC(){return uC.lFrame.isParent}function mC(){uC.lFrame.isParent=!1}function kC(){return uC.isInCheckNoChangesMode}function CC(e){uC.isInCheckNoChangesMode=e}function wC(){var e=uC.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function _C(){return uC.lFrame.bindingIndex}function bC(){return uC.lFrame.bindingIndex++}function EC(e){var t=uC.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function PC(e){uC.lFrame.inI18n=e}function SC(e,t){var n=uC.lFrame;n.bindingIndex=n.bindingRootIndex=e,OC(t)}function OC(e){uC.lFrame.currentDirectiveIndex=e}function TC(){return uC.lFrame.currentQueryIndex}function IC(e){uC.lFrame.currentQueryIndex=e}function AC(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function MC(e,t,n){if(n&tk.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&tk.Host||(r=AC(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=uC.lFrame=RC();return a.currentTNode=t,a.lView=e,!0}function xC(e){var t=RC(),n=e[1];uC.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function RC(){var e=uC.lFrame,t=null===e?null:e.child;return null===t?NC(e):t}function NC(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function DC(){var e=uC.lFrame;return uC.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var LC=DC;function FC(){var e=DC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function UC(){return uC.lFrame.selectedIndex}function VC(e){uC.lFrame.selectedIndex=e}function BC(){var e=uC.lFrame;return eC(e.tView,e.selectedIndex)}function zC(){uC.lFrame.currentNamespace=Wk}function HC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function GC(e,t,n){qC(e,t,3,n)}function $C(e,t,n,r){(3&e[2])===n&&qC(e,t,n,r)}function ZC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function qC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(WC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function WC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var jC=Py(function e(t,n,r){by(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function YC(e,t,n){for(var r=Yk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];QC(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function KC(e){return 3===e||4===e||6===e}function QC(e){return 64===e.charCodeAt(0)}function XC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||JC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function JC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function ew(e){return-1!==e}function tw(e){return 32767&e}function nw(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var rw=!0;function iw(e){var t=rw;return rw=e,t}var aw=0;function ow(e,t){var n=uw(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,sw(r.data,e),sw(t,null),sw(r.blueprint,null));var i=cw(e,t),a=e.injectorIndex;if(ew(i))for(var o=tw(i),s=nw(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function sw(e,t){e.push(0,0,0,0,0,0,0,0,t)}function uw(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function cw(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function lw(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(kk)&&(r=n[kk]),null==r&&(r=n[kk]=aw++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function fw(e,t,n){if(n&tk.Optional)return e;Gm(t,"NodeInjector")}function hw(e,t,n,r){if(n&tk.Optional&&void 0===r&&(r=null),0==(n&(tk.Self|tk.Host))){var i=e[9],a=nk(void 0);try{return i?i.get(t,r,n&tk.Optional):rk(t,r,n&tk.Optional)}finally{nk(a)}}return fw(r,t,n)}function dw(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tk.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(kk)?e[kk]:void 0;return"number"==typeof t?t>=0?255&t:pw:t}(n);if("function"==typeof a){if(!MC(t,e,r))return r&tk.Host?fw(i,n,r):hw(t,n,r,i);try{var o=a(r);if(null!=o||r&tk.Optional)return o;Gm(n)}finally{LC()}}else if("number"==typeof a){var s=null,u=uw(e,t),c=-1,l=r&tk.Host?t[16][6]:null;for((-1===u||r&tk.SkipSelf)&&(-1!==(c=-1===u?cw(e,t):t[u+8])&&Cw(r,!1)?(s=t[1],u=tw(c),t=nw(c,t)):u=-1);-1!==u;){var f=t[1];if(kw(a,u,f.data)){var h=gw(u,t,n,s,r,l);if(h!==vw)return h}-1!==(c=t[u+8])&&Cw(r,t[1].data[u+8]===l)&&kw(a,u,t)?(s=f,u=tw(c),t=nw(c,t)):u=-1}}}return hw(t,n,r,i)}var vw={};function pw(){return new ww(dC(),lC())}function gw(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=yw(s,o,n,null==r?Nk(s)&&rw:r!=o&&0!=(3&s.type),i&tk.Host&&a===s);return null!==u?mw(t,o,u,s):vw}function yw(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&Lk(d)&&d.type===n)return u}return null}function mw(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof jC}(i)){var o=i;o.resolving&&function(e,t){throw new Bm("200","Circular dependency in DI detected for ".concat(e))}(Hm(a[n]));var s=iw(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?nk(o.injectImpl):null;MC(e,r,tk.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=zk(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&nk(u),iw(s),o.resolving=!1,LC()}}return i}function kw(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Cw(e,t){return!(e&tk.Self||e&tk.Host&&t)}var ww=function(){function e(t,n){by(this,e),this._tNode=t,this._lView=n}return Py(e,[{key:"get",value:function(e,t,n){return dw(this._tNode,this._lView,e,n,t)}}]),e}();function _w(e){return ik(function(){for(var t=e.prototype.constructor,n=t[mk]||bw(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[mk]||bw(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function bw(e){return Vm(e)?function(){var t=bw(Um(e));return t&&t()}:Uk(e)}function Ew(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(KC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(dC(),e)}var Pw="__parameters__";function Sw(e,t,n){return ik(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=uy(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(Pw)?e[Pw]:Object.defineProperty(e,Pw,{value:[]})[Pw];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var Ow=function(){function e(t,n){by(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Zm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return Py(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Tw=new Ow("AnalyzeForEntryComponents"),Iw=Function;function Aw(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),Aw(r,t)):t!==e&&t.push(r)}return t}function Mw(e,t){e.forEach(function(e){return Array.isArray(e)?Mw(e,t):t(e)})}function xw(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Rw(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Nw(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function Dw(e,t,n){var r=Fw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function Lw(e,t){var n=Fw(e,t);if(n>=0)return e[1|n]}function Fw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var Uw,Vw={},Bw="__NG_DI_FLAG__",zw="ngTempTokenPath",Hw=/\n/gm,Gw="__source",$w=xm({provide:String,useValue:xm});function Zw(e){var t=Uw;return Uw=e,t}function qw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tk.Default;if(void 0===Uw)throw new Error("inject() must be called from an injection context");return null===Uw?rk(e,void 0,t):Uw.get(e,t&tk.Optional?null:void 0,t)}function Ww(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tk.Default;return(Km||qw)(Um(e),t)}function jw(e){for(var t=[],n=0;n<e.length;n++){var r=Um(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=tk.Default,o=0;o<r.length;o++){var s=r[o],u=Kw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Ww(i,a))}else t.push(Ww(r))}return t}function Yw(e,t){return e[Bw]=t,e.prototype[Bw]=t,e}function Kw(e){return e[Bw]}function Qw(e,t,n,r){var i=e[zw];throw t[Gw]&&i.unshift(t[Gw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=Nm(t);if(Array.isArray(t))i=t.map(Nm).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):Nm(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Hw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[zw]=null,e}var Xw,Jw,e_=Yw(Sw("Inject",function(e){return{token:e}}),-1),t_=Yw(Sw("Optional"),8),n_=Yw(Sw("SkipSelf"),4);function r_(e){var t;return(null===(t=function(){if(void 0===Xw&&(Xw=null,lk.trustedTypes))try{Xw=lk.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Xw}())||void 0===t?void 0:t.createHTML(e))||e}function i_(e){var t;return(null===(t=function(){if(void 0===Jw&&(Jw=null,lk.trustedTypes))try{Jw=lk.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Jw}())||void 0===t?void 0:t.createHTML(e))||e}var a_=function(){function e(t){by(this,e),this.changingThisBreaksApplicationSecurity=t}return Py(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),o_=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(a_),s_=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(a_),u_=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(a_),c_=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(a_),l_=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(a_);function f_(e){return e instanceof a_?e.changingThisBreaksApplicationSecurity:e}function h_(e,t){var n=d_(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function d_(e){return e instanceof a_&&e.getTypeName()||null}function v_(e){var t=new g_(e);return function(){try{return!!(new window.DOMParser).parseFromString(r_(""),"text/html")}catch(e){return!1}}()?new p_(t):t}var p_=function(){function e(t){by(this,e),this.inertDocumentHelper=t}return Py(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(r_(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),g_=function(){function e(t){if(by(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return Py(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=r_(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=r_(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),y_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,m_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function k_(e){return(e=String(e)).match(y_)||e.match(m_)?e:"unsafe:"+e}function C_(e){return(e=String(e)).split(",").map(function(e){return k_(e.trim())}).join(", ")}function w_(e){var t,n={},r=Cy(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function __(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var b_,E_=w_("area,br,col,hr,img,wbr"),P_=w_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),S_=w_("rp,rt"),O_=__(E_,__(P_,w_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),__(S_,w_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),__(S_,P_)),T_=w_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),I_=w_("srcset"),A_=__(T_,I_,w_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),w_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),M_=w_("script,style,template"),x_=function(){function e(){by(this,e),this.sanitizedSomething=!1,this.buf=[]}return Py(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!O_.hasOwnProperty(t))return this.sanitizedSomething=!0,!M_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(A_.hasOwnProperty(o)){var s=i.value;T_[o]&&(s=k_(s)),I_[o]&&(s=C_(s)),this.buf.push(" ",a,'="',D_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();O_.hasOwnProperty(t)&&!E_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(D_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),R_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,N_=/([^\#-~ |!])/g;function D_(e){return e.replace(/&/g,"&amp;").replace(R_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(N_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function L_(e,t){var n=null;try{b_=b_||v_(e);var r=t?String(t):"";n=b_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=b_.getInertBodyElement(r)}while(r!==a);return r_((new x_).sanitizeChildren(F_(n)||n))}finally{if(n)for(var o=F_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function F_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var U_=((U_=U_||{})[U_.NONE=0]="NONE",U_[U_.HTML=1]="HTML",U_[U_.STYLE=2]="STYLE",U_[U_.SCRIPT=3]="SCRIPT",U_[U_.URL=4]="URL",U_[U_.RESOURCE_URL=5]="RESOURCE_URL",U_);function V_(e){var t=z_();return t?i_(t.sanitize(U_.HTML,e)||""):h_(e,"HTML")?i_(f_(e)):L_(jk(),zm(e))}function B_(e){var t=z_();return t?t.sanitize(U_.URL,e)||"":h_(e,"URL")?f_(e):k_(zm(e))}function z_(){var e=lC();return e&&e[12]}var H_="__ngContext__";function G_(e,t){e[H_]=t}function $_(e){var t=function(e){return e[H_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Z_(e){return e.ngOriginalError}function q_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var W_=function(){function e(){by(this,e),this._console=console}return Py(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||q_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(Z_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&Z_(e);t&&Z_(t);)t=Z_(t);return t||null}}]),e}(),j_=/^>|^->|<!--|-->|--!>|<!-$/g,Y_=/(<|>)/,K_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(lk);function Q_(e){return e instanceof Function?e():e}var X_,J_=((J_=J_||{})[J_.Important=1]="Important",J_[J_.DashCase=2]="DashCase",J_);function eb(e,t){return X_(e,t)}function tb(e){var t=e[3];return xk(t)?t[3]:t}function nb(e){return ib(e[13])}function rb(e){return ib(e[4])}function ib(e){for(;null!==e&&!xk(e);)e=e[4];return e}function ab(e,t,n,r,i){if(null!=r){var a,o=!1;xk(r)?a=r:Mk(r)&&(o=!0,r=r[0]);var s=Qk(r);0===e&&null!==n?null==i?yb(t,n,s):gb(t,n,s,i||null,!0):1===e&&null!==n?gb(t,n,s,i||null,!0):2===e?Ib(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==Qk(n)&&ab(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];Mb(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function ob(e,t){return Yk(e)?e.createText(t):e.createTextNode(t)}function sb(e,t,n){Yk(e)?e.setValue(t,n):t.textContent=n}function ub(e,t){return e.createComment(function(e){return e.replace(j_,function(e){return e.replace(Y_,"\u200b$1\u200b")})}(t))}function cb(e,t,n){return Yk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function lb(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,sC(i,-1)),n.splice(r,1)}function fb(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&lb(i,r),t>0&&(e[n-1][4]=r[4]);var a=Rw(e,10+t);!function(e,t){Mb(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function hb(e,t){if(!(256&t[2])){var n=t[11];Yk(n)&&n.destroyNode&&Mb(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return db(e[1],e);for(;t;){var n=null;if(Mk(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)Mk(t)&&db(t[1],t),t=t[3];null===t&&(t=e),Mk(t)&&db(t[1],t),n=t&&t[4]}t=n}}(t)}}function db(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof jC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):Qk(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&Yk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&xk(t[3])){n!==t[3]&&lb(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function vb(e,t,n){return pb(e,t.parent,n)}function pb(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===ok.None||i===ok.Emulated)return null}return Jk(r,n)}function gb(e,t,n,r,i){Yk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function yb(e,t,n){Yk(e)?e.appendChild(t,n):t.appendChild(n)}function mb(e,t,n,r,i){null!==r?gb(e,t,n,r,i):yb(e,t,n)}function kb(e,t){return Yk(e)?e.parentNode(t):t.parentNode}function Cb(e,t,n){return bb(e,t,n)}function wb(e,t,n){return 40&e.type?Jk(e,n):null}var _b,bb=wb;function Eb(e,t){bb=e,_b=t}function Pb(e,t,n,r){var i=vb(e,r,t),a=t[11],o=Cb(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)mb(a,i,n[s],o,!1);else mb(a,i,n,o,!1);void 0!==_b&&_b(a,r,t,n,i)}function Sb(e,t){if(null!==t){var n=t.type;if(3&n)return Jk(t,e);if(4&n)return Tb(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return Sb(e,r);var i=e[t.index];return xk(i)?Tb(-1,i):Qk(i)}if(32&n)return eb(t,e)()||Qk(e[t.index]);var a=Ob(e,t);return null!==a?Array.isArray(a)?a[0]:Sb(tb(e[16]),a):Sb(e,t.next)}return null}function Ob(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Tb(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return Sb(r,i)}return t[7]}function Ib(e,t,n){var r=kb(e,t);r&&function(e,t,n,r){Yk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function Ab(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&G_(Qk(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)Ab(e,t,n.child,r,i,a,!1),ab(t,e,i,s,a);else if(32&u){for(var c=eb(n,r),l=void 0;l=c();)ab(t,e,i,l,a);ab(t,e,i,s,a)}else 16&u?xb(e,t,r,n,i,a):ab(t,e,i,s,a);n=o?n.projectionNext:n.next}}function Mb(e,t,n,r,i,a){Ab(n,r,e.firstChild,t,i,a,!1)}function xb(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)ab(t,e,i,s[u],a);else Ab(e,t,s,o[3],i,a,!0)}function Rb(e,t,n){Yk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Nb(e,t,n){Yk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function Db(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var Lb="ng-template";function Fb(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==Db((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function Ub(e){return 4===e.type&&e.value!==Lb}function Vb(e,t,n){return t===(4!==e.type||n?e.value:Lb)}function Bb(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(KC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!Vb(e,u,n)||""===u&&1===t.length){if(zb(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!Fb(e.attrs,c,n)){if(zb(r))return!1;o=!0}continue}var l=Hb(8&r?"class":u,i,Ub(e),n);if(-1===l){if(zb(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==Db(h,c,0)||2&r&&c!==f){if(zb(r))return!1;o=!0}}}}else{if(!o&&!zb(r)&&!zb(u))return!1;if(o&&zb(u))continue;o=!1,r=u|1&r}}return zb(r)||o}function zb(e){return 0==(1&e)}function Hb(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function Gb(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(Bb(e,t[r],n))return!0;return!1}function $b(e,t){return e?":not("+t.trim()+")":t}function Zb(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!zb(o)&&(t+=$b(a,i),i=""),r=o,a=a||!zb(r);n++}return""!==i&&(t+=$b(a,i)),t}var qb={};function Wb(e){jb(fC(),lC(),UC()+e,kC())}function jb(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&GC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&$C(t,a,0,n)}VC(n)}function Yb(e,t){return e<<17|t<<2}function Kb(e){return e>>17&32767}function Qb(e){return 2|e}function Xb(e){return(131068&e)>>2}function Jb(e,t){return-131069&e|t<<2}function eE(e){return 1|e}function tE(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];IC(i),o.contentQueries(2,t[a],a)}}}function nE(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,oC(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function rE(e,t,n,r,i){var a=e.data[t];if(null===a)a=iE(e,t,n,r,i),uC.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=pC();a.injectorIndex=null===o?-1:o.injectorIndex}return gC(a,!0),a}function iE(e,t,n,r,i){var a=vC(),o=yC(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function aE(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function oE(e,t,n){xC(t);try{var r=e.viewQuery;null!==r&&UE(1,r,n);var i=e.template;null!==i&&cE(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&tE(e,t),e.staticViewQueries&&UE(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)RE(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,FC()}}function sE(e,t,n,r){var i=t[2];if(256!=(256&i)){xC(t);var a=kC();try{oC(t),function(e){uC.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&cE(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&GC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&$C(t,u,0,null),ZC(t,0)}if(function(e){for(var t=nb(e);null!==t;t=rb(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&sC(a,1),i[2]|=1024}}(t),function(e){for(var t=nb(e);null!==t;t=rb(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];iC(r)&&sE(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&tE(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&GC(t,c)}else{var l=e.contentHooks;null!==l&&$C(t,l,1),ZC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)VC(~i);else{var a=i,o=n[++r],s=n[++r];SC(o,a),s(2,t[a])}}}finally{VC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)ME(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&UE(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&GC(t,d)}else{var v=e.viewHooks;null!==v&&$C(t,v,2),ZC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,sC(t[3],-1))}finally{FC()}}}function uE(e,t,n,r){var i=t[10],a=!kC(),o=rC(t);try{a&&!o&&i.begin&&i.begin(),o&&oE(e,t,r),sE(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function cE(e,t,n,r,i){var a=UC(),o=2&r;try{VC(-1),o&&t.length>20&&jb(e,t,20,kC()),n(r,i)}finally{VC(a)}}function lE(e,t,n){if(Rk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function fE(e,t,n){!cC()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||ow(n,t),G_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=Lk(u);c&&PE(t,n,u);var l=mw(t,e,s,n);G_(l,t),null!==o&&TE(0,s-i,l,u,0,o),c&&(nC(n.index,t)[8]=l)}}(e,t,n,Jk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=uC.lFrame.currentDirectiveIndex;try{VC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];OC(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&CE(u,c)}}finally{VC(-1),OC(o)}}(e,t,n))}function hE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function dE(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=vE(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function vE(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:qb);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function pE(e,t,n,r){var i=BE(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&zE(e).push(r,i.length-1))}function gE(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function yE(e,t,n,r,i,a,o,s){var u,c=Jk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(GE(e,n,u,r,i),Nk(t)&&function(e,t){var n=nC(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Yk(a)?a.setProperty(c,r,i):QC(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function mE(e,t,n,r){var i=!1;if(cC()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];Gb(n,o.selectors,!1)&&(i||(i=[]),lw(ow(n,t),e,o.type),Lk(o)?(wE(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,bE(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=aE(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=XC(n.mergedAttrs,d.hostAttrs),EE(e,n,t,f,d),_E(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||Ub(t)?null:IE(l,i);a.push(f),o=gE(l,u,o),s=gE(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new Bm("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=XC(n.mergedAttrs,n.attrs),i}function kE(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function CE(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function wE(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function _E(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Lk(t)&&(n[""]=e)}}function bE(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function EE(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=Uk(i.type)),o=new jC(a,Lk(i),null);e.blueprint[r]=o,n[r]=o,kE(e,t,0,r,aE(e,n,i.hostVars,qb),i)}function PE(e,t,n){var r=Jk(t,e),i=dE(n),a=e[10],o=NE(e,nE(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function SE(e,t,n,r,i,a){var o=Jk(e,t);OE(t[11],o,a,e.value,n,r,i)}function OE(e,t,n,r,i,a,o){if(null==a)Yk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?zm(a):o(a,r||"",i);Yk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function TE(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function IE(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function AE(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function ME(e,t){var n=nC(t,e);if(iC(n)){var r=n[1];80&n[2]?sE(r,n,r.template,n[8]):n[5]>0&&xE(n)}}function xE(e){for(var t=nb(e);null!==t;t=rb(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];sE(i,r,i.template,r[8])}else r[5]>0&&xE(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=nC(a[o],e);iC(s)&&s[5]>0&&xE(s)}}function RE(e,t){var n=nC(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),oE(r,n,n[8])}function NE(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function DE(e){for(;e;){e[2]|=64;var t=tb(e);if(Fk(e)&&!t)return e;e=t}return null}function LE(e,t,n){var r=t[10];r.begin&&r.begin();try{sE(e,t,e.template,n)}catch(i){throw HE(t,i),i}finally{r.end&&r.end()}}function FE(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=$_(n),i=r[1];uE(i,r,i.template,n)}}(e[8])}function UE(e,t,n){IC(0),t(e,n)}var VE=Promise.resolve(null);function BE(e){return e[7]||(e[7]=[])}function zE(e){return e.cleanup||(e.cleanup=[])}function HE(e,t){var n=e[9],r=n?n.get(W_,null):null;r&&r.handleError(t)}function GE(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function $E(e,t,n){var r=Xk(t,e);sb(e[11],r,n)}function ZE(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=Dm(i,s):2==a&&(r=Dm(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var qE,WE=new Ow("INJECTOR",-1),jE=function(){function e(){by(this,e)}return Py(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vw;if(t===Vw){var n=new Error("NullInjectorError: No provider for ".concat(Nm(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),YE=new Ow("Set Injector scope."),KE={},QE={};function XE(){return void 0===qE&&(qE=new jE),qE}function JE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new eP(e,n,t||XE(),r)}var eP=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;by(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&Mw(n,function(e){return i.processProvider(e,t,n)}),Mw([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(WE,rP(void 0,this));var s=this.records.get(YE);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:Nm(t))}return Py(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tk.Default;this.assertNotDestroyed();var r,i=Zw(this),a=nk(void 0);try{if(!(n&tk.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof Ow)&&Wm(e);o=s&&this.injectableDefInScope(s)?rP(tP(e),KE):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&tk.Self?XE():this.parent).get(e,t=n&tk.Optional&&t===Vw?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[zw]=u[zw]||[]).unshift(Nm(e)),i)throw u;return Qw(u,e,"R3InjectorError",this.source)}throw u}finally{nk(a),Zw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(Nm(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=Um(e)))return!1;var i=Ym(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Ym(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{Mw(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;Mw(i,function(e){return r.processProvider(e,n,i||hk)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=Uk(o)||function(){return new o};this.records.set(o,rP(f,KE));var h=i.providers;if(null!=h&&!s){var d=e;Mw(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=aP(e=Um(e))?e:Um(e&&e.provide),a=iP(r=e)?rP(void 0,r.useValue):rP(nP(r),KE);if(aP(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=rP(void 0,KE,!0)).factory=function(){return jw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===KE&&(t.value=QE,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=Um(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function tP(e){var t=Wm(e),n=null!==t?t.factory:Uk(e);if(null!==n)return n;if(e instanceof Ow)throw new Error("Token ".concat(Nm(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=Nw(t,"?");throw new Error("Can't resolve all parameters for ".concat(Nm(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[Qm]||e[Jm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function nP(e,t,n){var r;if(aP(e)){var i=Um(e);return Uk(i)||tP(i)}if(iP(e))r=function(){return Um(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,my(jw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Ww(Um(e.useExisting))};else{var a=Um(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Uk(a)||tP(a);r=function(){return uy(a,my(jw(e.deps)))}}return r}function rP(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function iP(e){return null!==e&&"object"==typeof e&&$w in e}function aP(e){return"function"==typeof e}var oP=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=JE(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},sP=function(){var e=function(){function e(){by(this,e)}return Py(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?oP(e,t,""):oP(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Vw,e.NULL=new jE,e.\u0275prov=Zm({token:e,providedIn:"any",factory:function(){return Ww(WE)}}),e.__NG_ELEMENT_ID__=-1,e}();function uP(e,t){HC($_(e)[1],dC())}function cP(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(Lk(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=lP(e.inputs),a.declaredInputs=lP(e.declaredInputs),a.outputs=lP(e.outputs);var o=i.hostBindings;o&&dP(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&fP(e,s),u&&hP(e,u),Rm(e.inputs,i.inputs),Rm(e.declaredInputs,i.declaredInputs),Rm(e.outputs,i.outputs),Lk(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===cP&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=XC(i.hostAttrs,n=XC(n,i.hostAttrs))}}(r)}function lP(e){return e===fk?{}:e===hk?[]:e}function fP(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function hP(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function dP(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var vP=null;function pP(){if(!vP){var e=lk.Symbol;if(e&&e.iterator)vP=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(vP=r)}}return vP}var gP=function(){function e(t){by(this,e),this.wrapped=t}return Py(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function yP(e){return!!mP(e)&&(Array.isArray(e)||!(e instanceof Map)&&pP()in e)}function mP(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function kP(e,t,n){return e[t]=n}function CP(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function wP(e,t,n,r){var i=CP(e,t,n);return CP(e,t+1,r)||i}function _P(e,t,n,r){var i=lC();return CP(i,bC(),t)&&(fC(),SE(BC(),i,e,t,n,r)),_P}function bP(e,t,n,r){return CP(e,bC(),n)?t+zm(n)+r:qb}function EP(e,t,n,r,i,a){var o=wP(e,_C(),n,i);return EC(2),o?t+zm(n)+r+zm(i)+a:qb}function PP(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=wP(e,t,n,r);return CP(e,t+2,i)||a}(e,_C(),n,i,o);return EC(3),u?t+zm(n)+r+zm(i)+a+zm(o)+s:qb}function SP(e,t,n,r,i,a){var o=lC(),s=bP(o,t,n,r);return s!==qb&&SE(BC(),o,e,s,i,a),SP}function OP(e,t,n,r,i,a,o,s){var u=lC(),c=fC(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=rE(t,e,4,o||null,aC(c,s));mE(t,n,l,aC(c,u)),HC(t,l);var f=l.tViews=vE(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];gC(f,!1);var h=u[11].createComment("");Pb(c,u,h,f),G_(h,u),NE(u,u[l]=AE(h,u,h,f)),Dk(f)&&fE(c,u,f),null!=o&&hE(u,f,s)}function TP(e){return tC(uC.lFrame.contextLView,20+e)}function IP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tk.Default,n=lC();return null===n?Ww(e,t):dw(dC(),n,Um(e),t)}function AP(e,t,n){var r=lC();return CP(r,bC(),t)&&yE(fC(),BC(),r,e,t,r[11],n,!1),AP}function MP(e,t,n,r,i){var a=i?"class":"style";GE(e,n,t.inputs[a],a,r)}function xP(e,t,n,r){var i=lC(),a=fC(),o=20+e,s=i[11],u=i[o]=cb(s,t,uC.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=rE(t,e,2,i,aC(s,a));return mE(t,n,u,aC(s,o)),null!==u.attrs&&ZE(u,u.attrs,!1),null!==u.mergedAttrs&&ZE(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];gC(c,!0);var l=c.mergedAttrs;null!==l&&YC(s,u,l);var f=c.classes;null!==f&&Nb(s,u,f);var h=c.styles;null!==h&&Rb(s,u,h),64!=(64&c.flags)&&Pb(a,i,u,c),0===uC.lFrame.elementDepthCount&&G_(u,i),uC.lFrame.elementDepthCount++,Dk(c)&&(fE(a,i,c),lE(a,c,i)),null!==r&&hE(i,c)}function RP(){var e=dC();yC()?mC():gC(e=e.parent,!1);var t=e;uC.lFrame.elementDepthCount--;var n=fC();n.firstCreatePass&&(HC(n,e),Rk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&MP(n,t,lC(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&MP(n,t,lC(),t.stylesWithoutHost,!1)}function NP(e,t,n,r){xP(e,t,n,r),RP()}function DP(e,t,n){var r=lC(),i=fC(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=aC(a,r),s=rE(t,e,8,"ng-container",o);return null!==o&&ZE(s,o,!0),mE(t,n,s,aC(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];gC(o,!0);var s=r[a]=r[11].createComment("");Pb(i,r,s,o),G_(s,r),Dk(o)&&(fE(i,r,o),lE(i,o,r)),null!=n&&hE(r,o)}function LP(){var e=dC(),t=fC();yC()?mC():gC(e=e.parent,!1),t.firstCreatePass&&(HC(t,e),Rk(e)&&t.queries.elementEnd(e))}function FP(){return lC()}function UP(e){return!!e&&"function"==typeof e.then}var VP=function(e){return!!e&&"function"==typeof e.subscribe};function BP(e,t,n,r){var i=lC(),a=fC(),o=dC();return function(e,t,n,r,i,a,o,s){var u=Dk(r),c=e.firstCreatePass&&zE(e),l=t[8],f=BE(t),h=!0;if(3&r.type||s){var d=Jk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s(Qk(e[r.index]))}:r.index;if(Yk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=HP(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=HP(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=HP(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var b=t[k[_]][k[_+1]].subscribe(a),E=f.length;f.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),BP}function zP(e,t,n,r){try{return!1!==n(r)}catch(i){return HE(e,i),!1}}function HP(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?nC(e.index,t):t;0==(32&t[2])&&DE(o);for(var s=zP(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=zP(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function GP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(uC.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,uC.lFrame.contextLView))[8]}(e)}function $P(e,t,n){return ZP(e,"",t,"",n),$P}function ZP(e,t,n,r,i){var a=lC(),o=bP(a,t,n,r);return o!==qb&&yE(fC(),BC(),a,e,o,a[11],i,!1),ZP}function qP(e,t,n,r,i,a,o){var s=lC(),u=EP(s,t,n,r,i,a);return u!==qb&&yE(fC(),BC(),s,e,u,s[11],o,!1),qP}function WP(e,t,n,r,i,a,o,s,u){var c=lC(),l=PP(c,t,n,r,i,a,o,s);return l!==qb&&yE(fC(),BC(),c,e,l,c[11],u,!1),WP}function jP(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?Kb(a):Xb(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];YP(e[s],t)&&(u=!0,e[s+1]=r?eE(c):Qb(c)),s=r?Kb(c):Xb(c)}u&&(e[n+1]=r?Qb(a):eE(a))}function YP(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Fw(e,t)>=0}var KP={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function QP(e){return e.substring(KP.key,KP.keyEnd)}function XP(e){return e.substring(KP.value,KP.valueEnd)}function JP(e,t){var n=KP.textEnd,r=KP.key=eS(e,t,n);return n===r?-1:(r=KP.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=tS(e,r,n),r=KP.value=eS(e,r,n),r=KP.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=nS(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=nS(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),tS(e,r,n))}function eS(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function tS(e,t,n,r){return(t=eS(e,t,n))<n&&t++,t}function nS(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function rS(e,t){return function(e,t,n,r){var i=lC(),a=fC(),o=EC(2);a.firstUpdatePass&&sS(a,e,o,true),t!==qb&&CP(i,o,t)&&fS(a,a.data[UC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=Nm(f_(e))),e}(t),true,o)}(e,t),rS}function iS(e){!function(e,t,n,r){var i=fC(),a=EC(2);i.firstUpdatePass&&sS(i,null,a,r);var o=lC();if(n!==qb&&CP(o,a,n)){var s=i.data[UC()];if(vS(s,r)&&!oS(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=Dm(u,n||"")),MP(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===qb&&(i=hk);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&fS(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return hk;var r=[],i=f_(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(lS,aS,e,!1)}function aS(e,t){for(var n=function(e){return function(e){KP.key=0,KP.keyEnd=0,KP.value=0,KP.valueEnd=0,KP.textEnd=e.length}(e),JP(e,eS(e,0,KP.textEnd))}(t);n>=0;n=JP(t,n))lS(e,QP(t),XP(t))}function oS(e,t){return t>=e.expandoStartIndex}function sS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[UC()],o=oS(e,n);vS(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=uC.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=cS(n=uS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=uS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==Xb(r))return e[Kb(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[Kb(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=cS(s=uS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=cS(r,e[a].hostAttrs,n);return cS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=Kb(o),u=Xb(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||Fw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=Kb(e[s+1]);e[r+1]=Yb(h,s),0!==h&&(e[h+1]=Jb(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=Yb(s,0),0!==s&&(e[s+1]=Jb(e[s+1],r)),s=r;else e[r+1]=Yb(u,0),0===s?s=r:e[u+1]=Jb(e[u+1],r),u=r;l&&(e[r+1]=Qb(e[r+1])),jP(e,c,r,!0),jP(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&Fw(a,t)>=0&&(n[r+1]=eE(n[r+1]))}(t,c,e,r,a),o=Yb(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function uS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=cS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function cS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Dw(e,o,!!n||t[++a]))}return void 0===e?null:e}function lS(e,t,n){Dw(e,t,f_(n))}function fS(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];dS(function(e){return 1==(1&e)}(c)?hS(u,t,n,i,Xb(c),o):void 0)||(dS(a)||function(e){return 2==(2&e)}(c)&&(a=hS(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Yk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:J_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=J_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Xk(UC(),n),i,a))}}function hS(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===qb&&(h=f?hk:void 0);var d=f?Lw(h,r):l===r?h:void 0;if(c&&!dS(d)&&(d=Lw(u,r)),dS(d)&&(o=d,s))return o;var v=e[i+1];i=s?Kb(v):Xb(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=Lw(p,r))}return o}function dS(e){return void 0!==e}function vS(e,t){return 0!=(e.flags&(t?16:32))}function pS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=lC(),r=fC(),i=e+20,a=r.firstCreatePass?rE(r,i,1,t,null):r.data[i],o=n[i]=ob(n[11],t);Pb(r,n,o,a),gC(a,!1)}function gS(e){return yS("",e,""),gS}function yS(e,t,n){var r=lC(),i=bP(r,e,t,n);return i!==qb&&$E(r,UC(),i),yS}function mS(e,t,n,r,i){var a=lC(),o=EP(a,e,t,n,r,i);return o!==qb&&$E(a,UC(),o),mS}function kS(e,t,n,r,i,a,o){var s=lC(),u=PP(s,e,t,n,r,i,a,o);return u!==qb&&$E(s,UC(),u),kS}function CS(e,t,n){var r=lC();return CP(r,bC(),t)&&yE(fC(),BC(),r,e,t,r[11],n,!0),CS}var wS=void 0,_S=["en",[["a","p"],["AM","PM"],wS],[["AM","PM"],wS,wS],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wS,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wS,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wS,"{1} 'at' {0}",wS],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],bS={};function ES(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=SS(t);if(n)return n;var r=t.split("-")[0];if(n=SS(r))return n;if("en"===r)return _S;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function PS(e){return ES(e)[OS.PluralCase]}function SS(e){return e in bS||(bS[e]=lk.ng&&lk.ng.common&&lk.ng.common.locales&&lk.ng.common.locales[e]),bS[e]}var OS=((OS=OS||{})[OS.LocaleId=0]="LocaleId",OS[OS.DayPeriodsFormat=1]="DayPeriodsFormat",OS[OS.DayPeriodsStandalone=2]="DayPeriodsStandalone",OS[OS.DaysFormat=3]="DaysFormat",OS[OS.DaysStandalone=4]="DaysStandalone",OS[OS.MonthsFormat=5]="MonthsFormat",OS[OS.MonthsStandalone=6]="MonthsStandalone",OS[OS.Eras=7]="Eras",OS[OS.FirstDayOfWeek=8]="FirstDayOfWeek",OS[OS.WeekendRange=9]="WeekendRange",OS[OS.DateFormat=10]="DateFormat",OS[OS.TimeFormat=11]="TimeFormat",OS[OS.DateTimeFormat=12]="DateTimeFormat",OS[OS.NumberSymbols=13]="NumberSymbols",OS[OS.NumberFormats=14]="NumberFormats",OS[OS.CurrencyCode=15]="CurrencyCode",OS[OS.CurrencySymbol=16]="CurrencySymbol",OS[OS.CurrencyName=17]="CurrencyName",OS[OS.Currencies=18]="Currencies",OS[OS.Directionality=19]="Directionality",OS[OS.PluralCase=20]="PluralCase",OS[OS.ExtraData=21]="ExtraData",OS),TS=["zero","one","two","few","many"],IS="en-US",AS={marker:"element"},MS={marker:"ICU"},xS=((xS=xS||{})[xS.SHIFT=2]="SHIFT",xS[xS.APPEND_EAGERLY=1]="APPEND_EAGERLY",xS[xS.COMMENT=2]="COMMENT",xS),RS=IS;function NS(e){(function(e,t){null==e&&$m("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(RS=e.toLowerCase().replace(/_/g,"-"))}function DS(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?wb(e,0,n):Qk(n[i])}function LS(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)gb(e,o,n[a[u]],s,!1)}}function FS(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];US(r)||VS(r,t)&&null===BS(r)&&zS(r,t.index)}}function US(e){return!(64&e.type)}function VS(e,t){return US(t)||e.index>t.index}function BS(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function zS(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(Eb(DS,LS),e.insertBeforeIndex=t)}function HS(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function GS(e,t,n){var r=iE(e,n,64,null,null);return FS(t,r),r}function $S(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function ZS(e){return e>>>17}function qS(e){return(131070&e)>>>1}var WS=0,jS=0;function YS(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=ob(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=ZS(u),f=void 0,h=void 0;if(null===o&&(o=l,i=kb(a,r)),l===o?(f=r,h=i):(f=null,h=Qk(n[l])),null!==h){var d=qS(u);gb(a,h,n[d],f,!1);var v=HS(e,d);if(null!==v&&"object"==typeof v){var p=$S(v,n);null!==p&&YS(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];OE(a,Xk(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case MS:var m=t[++s],k=t[++s];null===n[k]&&G_(n[k]=ub(a,m),n);break;case AS:var C=t[++s],w=t[++s];null===n[w]&&G_(n[w]=cb(a,C,null),n)}}}function KS(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=zm(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?OE(t[11],t[f],null,v,h,u,d):yE(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&sb(t[11],p,u);break;case 2:XS(e,HS(e,f),t,u);break;case 3:QS(e,HS(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=HS(e,g>>>2);t[y.currentCaseLViewIndex]<0&&QS(e,y,r,t)}}a+=s}}function QS(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=WS;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),KS(e,r,t.update[i],n,a)}}function XS(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=PS(t)(parseInt(e,10)),r=TS[n];return void 0!==r?r:"other"}(t,RS);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if($S(t,n)!==i&&(JS(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&YS(e,t.create[i],n,a)}}function JS(e,t,n){var r=$S(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Xk(o,n);null!==s&&Ib(n[11],s)}else JS(e,HS(e,~o),n)}}function eO(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=$S(e,n);t=null!==i?e.remove[i]:hk}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var tO=/\ufffd(\d+):?\d*\ufffd/gi,nO=/\ufffd(\d+)\ufffd/,rO=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,iO=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,aO=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,oO=/\uE500/g;function sO(e,t,n,r,i,a,o){var s=aE(e,r,1,null),u=s<<xS.SHIFT,c=pC();t===c&&(c=null),null===c&&(u|=xS.APPEND_EAGERLY),o&&(u|=xS.COMMENT,function(e){void 0===X_&&(X_=e())}(eO)),i.push(u,null===a?"":a);var l=iE(e,s,o?32:1,null===a?"":a,null);FS(n,l);var f=l.index;return gC(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(Eb(DS,LS),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&$m("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function uO(e,t,n,r,i,a,o){var s=o.match(tO),u=sO(e,t,n,a,r,s?null:o,!1);s&&cO(i,o,u.index,null,0,null)}function cO(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(tO),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=lO(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function lO(e){return 1<<Math.min(e,31)}function fO(e){for(var t,n,r="",i=0,a=!1;null!==(t=iO.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function hO(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:aE(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(lO(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=pO(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function dO(e){for(var t=[],n=[],r=1,i=0,a=vO(e=e.replace(rO,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=vO(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function vO(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);rO.test(s)?i.push(dO(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function pO(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=v_(jk()).getInertBodyElement(o),h=F_(f)||f;return h?gO(e,t,n,r,u,c,l,h,i,s,0):0}function gO(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=aE(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(O_.hasOwnProperty(p)){kO(i,AS,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(tO)?A_.hasOwnProperty(k)&&cO(o,m.value,d,m.name,0,T_[k]?k_:I_[k]?C_:null):CO(i,d,m)}f=gO(e,t,n,r,i,a,o,h,d,c,l+1)|f,yO(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match(tO);kO(i,null,w?"":C,u,d),yO(a,d,l),w&&(f=cO(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=nO.exec(h.textContent||"");if(_){var b=c[parseInt(_[1],10)];kO(i,MS,"",u,d),hO(e,n,r,u,b,d),mO(a,d,l)}}h=h.nextSibling}return f}function yO(e,t,n){0===n&&e.push(t)}function mO(e,t,n){0===n&&(e.push(~t),e.push(t))}function kO(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function CO(e,t,n){e.push(t<<1|1,n.name,n.value)}function wO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=fC(),i=lC(),a=20+e,o=aC(r.consts,t),s=pC();r.firstCreatePass&&function(e,t,n,r,i,a){var o=pC(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return fO(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return fO(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(oO," ")}(i).split(aO),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=vO(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&uO(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));hO(e,n,u,t,y,sO(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),gC(pC(),!1);else{var C=GS(e,c[0],k);c.unshift([]),gC(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=pb(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&xS.COMMENT)===xS.COMMENT,c=(o&xS.APPEND_EAGERLY)===xS.APPEND_EAGERLY,l=o>>>xS.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):ob(i,s)),c&&null!==n&&gb(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),PC(!0)}function _O(){PC(!1)}function bO(e,t,n){wO(e,t,n),_O()}function EO(e){return function(e){e&&(WS|=1<<Math.min(jS,31)),jS++}(CP(lC(),bC(),e)),EO}function PO(e){!function(e,t,n){if(jS>0){var r=e.data[n];KS(e,t,Array.isArray(r)?r:r.update,_C()-jS-1,WS)}WS=0,jS=0}(fC(),lC(),e+20)}function SO(e,t,n,r,i){if(e=Um(e),Array.isArray(e))for(var a=0;a<e.length;a++)SO(e[a],t,n,r,i);else{var o=fC(),s=lC(),u=aP(e)?e:Um(e.provide),c=nP(e),l=dC(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(aP(e)||!e.multi){var v=new jC(c,i,IP),p=IO(u,t,i?f:f+d,h);-1===p?(lw(ow(l,s),o,u),OO(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=IO(u,t,f+d,h),y=IO(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){lw(ow(l,s),o,u);var C=function(e,t,n,r,i){var a=new jC(e,n,IP);return a.multi=[],a.index=t,a.componentProviders=0,TO(a,i,r&&!n),a}(i?MO:AO,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),OO(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else OO(o,e,g>-1?g:y,TO(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function OO(e,t,n,r){var i=aP(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function TO(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function IO(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function AO(e,t,n,r){return xO(this.multi,[])}function MO(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=mw(n,n[1],this.providerFactory.index,r);xO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else xO(a,i=[]);return i}function xO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function RO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=fC();if(r.firstCreatePass){var i=Lk(e);SO(n,r.data,r.blueprint,i,!0),SO(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var NO=Py(function e(){by(this,e)}),DO=function(){function e(){by(this,e)}return Py(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(Nm(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),LO=function(){var e=Py(function e(){by(this,e)});return e.NULL=new DO,e}();function FO(){}function UO(e,t){return new BO(Jk(e,t))}var VO=function(){return UO(dC(),lC())},BO=function(){var e=Py(function e(t){by(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=VO,e}();function zO(e){return e instanceof BO?e.nativeElement:e}var HO=Py(function e(){by(this,e)}),GO=function(){var e=Py(function e(){by(this,e)});return e.__NG_ELEMENT_ID__=function(){return $O()},e}(),$O=function(){var e=lC(),t=nC(dC().index,e);return function(e){return e[11]}(Mk(t)?t:e)},ZO=function(){var e=Py(function e(){by(this,e)});return e.\u0275prov=Zm({token:e,providedIn:"root",factory:function(){return null}}),e}(),qO=Py(function e(t){by(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),WO=new qO("12.2.16"),jO=function(){function e(){by(this,e)}return Py(e,[{key:"supports",value:function(e){return yP(e)}},{key:"create",value:function(e){return new KO(e)}}]),e}(),YO=function(e,t){return t},KO=function(){function e(t){by(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||YO}return Py(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<eT(n,r,i)?t:n,o=eT(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!yP(e))throw new Error("Error trying to diff '".concat(Nm(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[pP()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new QO(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new JO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new JO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),QO=Py(function e(t,n){by(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),XO=function(){function e(){by(this,e),this._head=null,this._tail=null}return Py(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),JO=function(){function e(){by(this,e),this.map=new Map}return Py(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new XO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function eT(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var tT=function(){function e(){by(this,e)}return Py(e,[{key:"supports",value:function(e){return e instanceof Map||mP(e)}},{key:"create",value:function(){return new nT}}]),e}(),nT=function(){function e(){by(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Py(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||mP(e)))throw new Error("Error trying to diff '".concat(Nm(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new rT(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),rT=Py(function e(t){by(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function iT(){return new aT([new jO])}var aT=function(){var e=function(){function e(t){by(this,e),this.factories=t}return Py(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||iT())},deps:[[e,new n_,new t_]]}}}]),e}();return e.\u0275prov=Zm({token:e,providedIn:"root",factory:iT}),e}();function oT(){return new sT([new tT])}var sT=function(){var e=function(){function e(t){by(this,e),this.factories=t}return Py(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||oT())},deps:[[e,new n_,new t_]]}}}]),e}();return e.\u0275prov=Zm({token:e,providedIn:"root",factory:oT}),e}();function uT(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(Qk(a)),xk(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&uT(s[1],s,u,r)}var c=n.type;if(8&c)uT(e,t,n.child,r);else if(32&c)for(var l=eb(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=Ob(t,n);if(Array.isArray(h))r.push.apply(r,my(h));else{var d=tb(t[16]);uT(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var cT=function(){function e(t,n){by(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return Py(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return uT(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(xk(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(fb(e,n),Rw(t,n))}this._attachedToViewContainer=!1}hb(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){pE(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){DE(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){LE(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){CC(!0);try{LE(e,t,n)}finally{CC(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,Mb(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),lT=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e))._view=e,r}return Py(n,[{key:"detectChanges",value:function(){FE(this._view)}},{key:"checkNoChanges",value:function(){!function(e){CC(!0);try{FE(e)}finally{CC(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(cT),fT=function(e){return function(e,t,n){if(Nk(e)&&!n){var r=nC(e.index,t);return new cT(r,r)}return 47&e.type?new cT(t[16],t):null}(dC(),lC(),16==(16&e))},hT=function(){var e=Py(function e(){by(this,e)});return e.__NG_ELEMENT_ID__=fT,e}(),dT=[new tT],vT=new aT([new jO]),pT=new sT(dT),gT=function(){return kT(dC(),lC())},yT=function(){var e=Py(function e(){by(this,e)});return e.__NG_ELEMENT_ID__=gT,e}(),mT=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return Py(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=nE(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),oE(t,n,e),new cT(n)}}]),n}(yT);function kT(e,t){return 4&e.type?new mT(t,e,UO(e,t)):null}var CT=Py(function e(){by(this,e)}),wT=Py(function e(){by(this,e)}),_T=function(){return OT(dC(),lC())},bT=function(){var e=Py(function e(){by(this,e)});return e.__NG_ELEMENT_ID__=_T,e}(),ET=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return Py(n,[{key:"element",get:function(){return UO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new ww(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=cw(this._hostTNode,this._hostLView);if(ew(e)){var t=nw(e,this._hostLView),n=tw(e);return new ww(t[1].data[n+8],t)}return new ww(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=PT(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(CT,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(xk(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],xw(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=Tb(u,c),f=r[11],h=kb(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,Mb(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),xw(ST(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=PT(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=fb(this._lContainer,t);n&&(Rw(ST(this._lContainer),t),hb(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=fb(this._lContainer,t);return n&&null!=Rw(ST(this._lContainer),t)?new cT(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(bT);function PT(e){return e[8]}function ST(e){return e[8]||(e[8]=[])}function OT(e,t){var n,r=t[e.index];if(xk(r))n=r;else{var i;if(8&e.type)i=Qk(r);else{var a=t[11];i=a.createComment("");var o=Jk(e,t);gb(a,kb(a,o),i,function(e,t){return Yk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=AE(r,t,i,e),NE(t,n)}return new ET(n,e,t)}var TT={},IT=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).ngModule=e,r}return Py(n,[{key:"resolveComponentFactory",value:function(e){var t=Ik(e);return new xT(t,this.ngModule)}}]),n}(LO);function AT(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var MT=new Ow("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return K_}}),xT=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(Zb).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return Py(n,[{key:"inputs",get:function(){return AT(this.componentDef.inputs)}},{key:"outputs",get:function(){return AT(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,TT,i);return a!==TT||r===TT?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(HO,Kk),u=o.get(ZO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(Yk(e))return e.selectRootElement(t,n===ok.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):cb(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Wk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:K_,clean:VE,playerHandler:null,flags:0},v=vE(0,null,null,1,0,null,null,null,null,null),p=nE(null,v,d,h,null,null,s,c,u,o);xC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=rE(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(ZE(s,u,!0),null!==e&&(YC(i,e,u),null!==s.classes&&Nb(i,e,s.classes),null!==s.styles&&Rb(i,e,s.styles)));var c=r.createRenderer(e,t),l=nE(n,dE(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(lw(ow(s,n),o,t.type),wE(o,s),bE(s,n.length,1)),NE(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)YC(c,f,["ng-version",WO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!zb(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&YC(c,f,m),k&&k.length>0&&Nb(c,f,k.join(" "))}if(a=eC(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=dC();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),EE(e,r,t,aE(e,t,1,null),n));var i=mw(t,e,r.directiveStart,r);G_(i,t);var a=Jk(r,t);return a&&G_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=dC();t.contentQueries(1,o,s.directiveStart)}var u=dC();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(VC(u.index),kE(n[1],u,0,u.directiveStart,u.directiveEnd,t),CE(t,o)),o}(g,this.componentDef,p,d,[uP]),oE(v,p,null)}finally{FC()}return new RT(this.componentType,i,UO(a,p),p,a)}}]),n}(NO),RT=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new lT(a),s.componentType=e,s}return Py(n,[{key:"injector",get:function(){return new ww(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return Py(function e(){by(this,e)})}()),NT=new Map,DT=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;by(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=py(i),i.destroyCbs=[],i.componentFactoryResolver=new IT(py(i));var a=Ak(e),o=e[yk]||null;return o&&NS(o),i._bootstrapComponents=Q_(a.bootstrap),i._r3Injector=JE(e,r,[{provide:CT,useValue:py(i)},{provide:LO,useValue:i.componentFactoryResolver}],Nm(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return Py(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sP.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tk.Default;return e===sP||e===CT||e===WE?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(CT),LT=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).moduleType=e,null!==Ak(e)&&function(e){var t=new Set;!function e(n){var r=Ak(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(Nm(t)," vs ").concat(Nm(t.name)))}(i,NT.get(i),n),NT.set(i,n));var a,o=Cy(Q_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return Py(n,[{key:"create",value:function(e){return new DT(this.moduleType,e)}}]),n}(wT);function FT(e,t,n){var r=wC()+e,i=lC();return i[r]===qb?kP(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function UT(e,t,n,r){return BT(lC(),wC(),e,t,n,r)}function VT(e,t){var n=e[t];return n===qb?void 0:n}function BT(e,t,n,r,i,a){var o=t+n;return CP(e,o,i)?kP(e,o+1,a?r.call(a,i):r(i)):VT(e,o+1)}function zT(e,t){var n,r=fC(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Bm("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=Uk(n.type)),o=nk(IP);try{var s=iw(!1),u=a();return iw(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,lC(),i,u),u}finally{nk(o)}}function HT(e,t,n){var r=e+20,i=lC(),a=tC(i,r);return $T(i,GT(i,r)?BT(i,wC(),t,a.transform,n,a):a.transform(n))}function GT(e,t){return e[1].data[t].pure}function $T(e,t){return gP.isWrapped(t)&&(t=gP.unwrap(t),e[_C()]=qb),t}function ZT(e){return function(t){setTimeout(e,void 0,t)}}var qT=function(e){fy(n,e);var t=dy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return by(this,n),(e=t.call(this)).__isAsync=r,e}return Py(n,[{key:"emit",value:function(e){cy(yy(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=ZT(u),s&&(s=ZT(s)),c&&(c=ZT(c)));var f=cy(yy(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof Ey&&e.add(f),f}}]),n}(Xy);function WT(){return this._results[pP()]()}var jT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];by(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=pP(),r=e.prototype;r[n]||(r[n]=WT)}return Py(e,[{key:"changes",get:function(){return this._changes||(this._changes=new qT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=Aw(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var YT=function(){function e(t){by(this,e),this.queryList=t,this.matches=null}return Py(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),KT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];by(this,e),this.queries=t}return Py(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==sI(e,t).matches&&this.queries[t].setDirty()}}]),e}(),QT=Py(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;by(this,e),this.predicate=t,this.flags=n,this.read=r}),XT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];by(this,e),this.queries=t}return Py(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),JT=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;by(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return Py(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,eI(t,i)),this.matchTNodeWithReadOption(e,t,yw(t,e,i,!1,!1))}else n===yT?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,yw(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===BO||r===bT||r===yT&&4&t.type)this.addMatch(t.index,-2);else{var i=yw(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function eI(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function tI(e,t,n,r){return-1===n?function(e,t){return 11&e.type?UO(e,t):4&e.type?kT(e,t):null}(t,e):-2===n?function(e,t,n){return n===BO?UO(t,e):n===yT?kT(t,e):n===bT?OT(t,e):void 0}(e,t,r):mw(e,e[1],n,t)}function nI(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:tI(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function rI(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=nI(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&rI(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];rI(p[1],p,c,r)}}}return r}function iI(e){var t=lC(),n=fC(),r=TC();IC(r+1);var i=sI(n,r);if(e.dirty&&rC(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?rI(n,t,r,[]):nI(n,t,i,r);e.reset(a,zO),e.notifyOnChanges()}return!0}return!1}function aI(e,t,n){var r=fC();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new XT),e.queries.track(new JT(t,-1))}(r,new QT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new jT(4==(4&n));pE(e,t,r,r.destroy),null===t[19]&&(t[19]=new KT),t[19].queries.push(new YT(r))}(r,lC(),t)}function oI(){return e=lC(),t=TC(),e[19].queries[t].queryList;var e,t}function sI(e,t){return e.queries.getByIndex(t)}function uI(e,t){return kT(e,t)}var cI=new Ow("Application Initializer"),lI=function(){var e=function(){function e(t){var n=this;by(this,e),this.appInits=t,this.resolve=FO,this.reject=FO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return Py(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(UP(r))t.push(r);else if(VP(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(cI,8))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),fI=new Ow("AppId"),hI={provide:fI,useFactory:function(){return"".concat(dI()).concat(dI()).concat(dI())},deps:[]};function dI(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var vI=new Ow("Platform Initializer"),pI=new Ow("Platform ID"),gI=new Ow("appBootstrapListener"),yI=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),mI=new Ow("LocaleId"),kI=new Ow("DefaultCurrencyCode"),CI=Py(function e(t,n){by(this,e),this.ngModuleFactory=t,this.componentFactories=n}),wI=function(e){return new LT(e)},_I=wI,bI=function(e){return Promise.resolve(wI(e))},EI=function(e){var t=wI(e),n=Q_(Ak(e).declarations).reduce(function(e,t){var n=Ik(t);return n&&e.push(new xT(n)),e},[]);return new CI(t,n)},PI=EI,SI=function(e){return Promise.resolve(EI(e))},OI=function(){var e=function(){function e(){by(this,e),this.compileModuleSync=_I,this.compileModuleAsync=bI,this.compileModuleAndAllComponentsSync=PI,this.compileModuleAndAllComponentsAsync=SI}return Py(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),TI=Promise.resolve(0);function II(e){"undefined"==typeof Zone?TI.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var AI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(by(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qT(!1),this.onMicrotaskEmpty=new qT(!1),this.onStable=new qT(!1),this.onError=new qT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=lk.requestAnimationFrame,t=lk.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(lk,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,RI(e),e.isCheckStableRunning=!0,xI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),RI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return NI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),DI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return NI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),DI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,RI(e),xI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return Py(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,MI,FO,FO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),MI={};function xI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function RI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function NI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function DI(e){e._nesting--,xI(e)}var LI,FI=function(){function e(){by(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qT,this.onMicrotaskEmpty=new qT,this.onStable=new qT,this.onError=new qT}return Py(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),UI=function(){var e=function(){function e(t){var n=this;by(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return Py(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){AI.assertNotInAngularZone(),II(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())II(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(AI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),VI=function(){var e=function(){function e(){by(this,e),this._applications=new Map,BI.addToWindow(this)}return Py(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return BI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),BI=new(function(){function e(){by(this,e)}return Py(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),zI=!0,HI=!1,GI=new Ow("AllowMultipleToken"),$I=Py(function e(t,n){by(this,e),this.name=t,this.token=n});function ZI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new Ow(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=qI();if(!a||a.injector.get(GI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:YE,useValue:"platform"});!function(e){if(LI&&!LI.destroyed&&!LI.injector.get(GI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");LI=e.get(WI);var t=e.get(vI,null);t&&t.forEach(function(e){return e()})}(sP.create({providers:o,name:r}))}return function(e){var t=qI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function qI(){return LI&&!LI.destroyed?LI:null}var WI=function(){var e=function(){function e(t){by(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return Py(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new FI:("zone.js"===e?void 0:e)||new AI({enableLongStackTrace:(HI=!0,zI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:AI,useValue:r}];return r.run(function(){var a=sP.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(W_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){KI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(lI)).runInitializers(),s.donePromise.then(function(){return NS(o.injector.get(mI,IS)||IS),n._moduleDoBootstrap(o),o}));return UP(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=jI({},n);return function(e,t,n){var r=new LT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(YI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(Nm(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(sP))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function jI(e,t){return Array.isArray(t)?t.reduce(jI,e):Object.assign(Object.assign({},e),t)}var YI=function(){var e=function(){function e(t,n,r,i,a){var o=this;by(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Yy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Yy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){AI.assertNotInAngularZone(),II(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){AI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Pm(t),i=function(e,t){return"number"==typeof bm(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?ym(a[0]):wm(i)(Im(a,r)):_m}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Xy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return tm(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=Mm(d,u))}),g.subscribe(v),t||(t=new Hy({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=Mm(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=Mm(h,o),g.complete()}}),Im(e).subscribe(t))})(e)}}()))}return Py(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof NO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(CT),a=n.create(sP.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(UI,null),u=s&&a.injector.get(VI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),KI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Cy(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;KI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(gI,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(AI),Ww(sP),Ww(W_),Ww(LO),Ww(lI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function KI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var QI=Py(function e(){by(this,e)}),XI=Py(function e(){by(this,e)}),JI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},eA=function(){var e=function(){function e(t,n){by(this,e),this._compiler=t,this._config=n||JI}return Py(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=iy(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),oy(8255)(r).then(function(e){return e[i]}).then(function(e){return tA(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=iy(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),oy(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return tA(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(OI),Ww(XI,8))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function tA(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var nA=ZI(null,"core",[{provide:pI,useValue:"unknown"},{provide:WI,deps:[sP]},{provide:VI,deps:[]},{provide:yI,deps:[]}]),rA=[{provide:YI,useClass:YI,deps:[AI,sP,W_,LO,lI]},{provide:MT,deps:[AI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:lI,useClass:lI,deps:[[new t_,cI]]},{provide:OI,useClass:OI,deps:[]},hI,{provide:aT,useFactory:function(){return vT},deps:[]},{provide:sT,useFactory:function(){return pT},deps:[]},{provide:mI,useFactory:function(e){return NS(e=e||"undefined"!=typeof $localize&&$localize.locale||IS),e},deps:[[new e_(mI),new t_,new n_]]},{provide:kI,useValue:"USD"}],iA=function(){var e=Py(function e(t){by(this,e)});return e.\u0275fac=function(t){return new(t||e)(Ww(YI))},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:rA}),e}(),aA=null;function oA(){return aA}var sA=new Ow("DocumentToken"),uA=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({factory:cA,token:e,providedIn:"platform"}),e}();function cA(){return Ww(fA)}var lA=new Ow("Location Initialized"),fA=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this))._doc=e,r._init(),r}return Py(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return oA().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=oA().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=oA().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){hA()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){hA()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(uA);return e.\u0275fac=function(t){return new(t||e)(Ww(sA))},e.\u0275prov=Zm({factory:dA,token:e,providedIn:"platform"}),e}();function hA(){return!!window.history.pushState}function dA(){return new fA(Ww(sA))}function vA(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function pA(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function gA(e){return e&&"?"!==e[0]?"?"+e:e}var yA=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({factory:mA,token:e,providedIn:"root"}),e}();function mA(e){var t=Ww(sA).location;return new CA(Ww(uA),t&&t.origin||"")}var kA=new Ow("appBaseHref"),CA=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;if(by(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,vy(i)}return Py(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return vA(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+gA(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+gA(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+gA(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(yA);return e.\u0275fac=function(t){return new(t||e)(Ww(uA),Ww(kA,8))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),wA=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return Py(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=vA(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+gA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+gA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(yA);return e.\u0275fac=function(t){return new(t||e)(Ww(uA),Ww(kA,8))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),_A=function(){var e=function(){function e(t,n){var r=this;by(this,e),this._subject=new qT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=pA(EA(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return Py(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+gA(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,EA(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+gA(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+gA(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(yA),Ww(uA))},e.normalizeQueryParams=gA,e.joinWithSlash=vA,e.stripTrailingSlash=pA,e.\u0275prov=Zm({factory:bA,token:e,providedIn:"root"}),e}();function bA(){return new _A(Ww(yA),Ww(uA))}function EA(e){return e.replace(/\/index.html$/,"")}var PA=((PA=PA||{})[PA.Decimal=0]="Decimal",PA[PA.Percent=1]="Percent",PA[PA.Currency=2]="Currency",PA[PA.Scientific=3]="Scientific",PA),SA=((SA=SA||{})[SA.Zero=0]="Zero",SA[SA.One=1]="One",SA[SA.Two=2]="Two",SA[SA.Few=3]="Few",SA[SA.Many=4]="Many",SA[SA.Other=5]="Other",SA),OA=((OA=OA||{})[OA.Format=0]="Format",OA[OA.Standalone=1]="Standalone",OA),TA=((TA=TA||{})[TA.Narrow=0]="Narrow",TA[TA.Abbreviated=1]="Abbreviated",TA[TA.Wide=2]="Wide",TA[TA.Short=3]="Short",TA),IA=((IA=IA||{})[IA.Short=0]="Short",IA[IA.Medium=1]="Medium",IA[IA.Long=2]="Long",IA[IA.Full=3]="Full",IA),AA=((AA=AA||{})[AA.Decimal=0]="Decimal",AA[AA.Group=1]="Group",AA[AA.List=2]="List",AA[AA.PercentSign=3]="PercentSign",AA[AA.PlusSign=4]="PlusSign",AA[AA.MinusSign=5]="MinusSign",AA[AA.Exponential=6]="Exponential",AA[AA.SuperscriptingExponent=7]="SuperscriptingExponent",AA[AA.PerMille=8]="PerMille",AA[AA.Infinity=9]="Infinity",AA[AA.NaN=10]="NaN",AA[AA.TimeSeparator=11]="TimeSeparator",AA[AA.CurrencyDecimal=12]="CurrencyDecimal",AA[AA.CurrencyGroup=13]="CurrencyGroup",AA);function MA(e,t){return FA(ES(e)[OS.DateFormat],t)}function xA(e,t){return FA(ES(e)[OS.TimeFormat],t)}function RA(e,t){return FA(ES(e)[OS.DateTimeFormat],t)}function NA(e,t){var n=ES(e),r=n[OS.NumberSymbols][t];if(void 0===r){if(t===AA.CurrencyDecimal)return n[OS.NumberSymbols][AA.Decimal];if(t===AA.CurrencyGroup)return n[OS.NumberSymbols][AA.Group]}return r}var DA=PS;function LA(e){if(!e[OS.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[OS.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function FA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function UA(e){var t=iy(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var VA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,BA={},zA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,HA=((HA=HA||{})[HA.Short=0]="Short",HA[HA.ShortGMT=1]="ShortGMT",HA[HA.Long=2]="Long",HA[HA.Extended=3]="Extended",HA),GA=((GA=GA||{})[GA.FullYear=0]="FullYear",GA[GA.Month=1]="Month",GA[GA.Date=2]="Date",GA[GA.Hours=3]="Hours",GA[GA.Minutes=4]="Minutes",GA[GA.Seconds=5]="Seconds",GA[GA.FractionalSeconds=6]="FractionalSeconds",GA[GA.Day=7]="Day",GA),$A=(($A=$A||{})[$A.DayPeriods=0]="DayPeriods",$A[$A.Days=1]="Days",$A[$A.Months=2]="Months",$A[$A.Eras=3]="Eras",$A);function ZA(e,t,n,r){var i=function(e){if(iM(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=iy(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return qA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(VA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!iM(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=WA(n,t)||t;for(var a,o=[];t;){if(!(a=zA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=rM(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(rM(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(nM[e])return nM[e];var t;switch(e){case"G":case"GG":case"GGG":t=QA($A.Eras,TA.Abbreviated);break;case"GGGG":t=QA($A.Eras,TA.Wide);break;case"GGGGG":t=QA($A.Eras,TA.Narrow);break;case"y":t=KA(GA.FullYear,1,0,!1,!0);break;case"yy":t=KA(GA.FullYear,2,0,!0,!0);break;case"yyy":t=KA(GA.FullYear,3,0,!1,!0);break;case"yyyy":t=KA(GA.FullYear,4,0,!1,!0);break;case"Y":t=tM(1);break;case"YY":t=tM(2,!0);break;case"YYY":t=tM(3);break;case"YYYY":t=tM(4);break;case"M":case"L":t=KA(GA.Month,1,1);break;case"MM":case"LL":t=KA(GA.Month,2,1);break;case"MMM":t=QA($A.Months,TA.Abbreviated);break;case"MMMM":t=QA($A.Months,TA.Wide);break;case"MMMMM":t=QA($A.Months,TA.Narrow);break;case"LLL":t=QA($A.Months,TA.Abbreviated,OA.Standalone);break;case"LLLL":t=QA($A.Months,TA.Wide,OA.Standalone);break;case"LLLLL":t=QA($A.Months,TA.Narrow,OA.Standalone);break;case"w":t=eM(1);break;case"ww":t=eM(2);break;case"W":t=eM(1,!0);break;case"d":t=KA(GA.Date,1);break;case"dd":t=KA(GA.Date,2);break;case"c":case"cc":t=KA(GA.Day,1);break;case"ccc":t=QA($A.Days,TA.Abbreviated,OA.Standalone);break;case"cccc":t=QA($A.Days,TA.Wide,OA.Standalone);break;case"ccccc":t=QA($A.Days,TA.Narrow,OA.Standalone);break;case"cccccc":t=QA($A.Days,TA.Short,OA.Standalone);break;case"E":case"EE":case"EEE":t=QA($A.Days,TA.Abbreviated);break;case"EEEE":t=QA($A.Days,TA.Wide);break;case"EEEEE":t=QA($A.Days,TA.Narrow);break;case"EEEEEE":t=QA($A.Days,TA.Short);break;case"a":case"aa":case"aaa":t=QA($A.DayPeriods,TA.Abbreviated);break;case"aaaa":t=QA($A.DayPeriods,TA.Wide);break;case"aaaaa":t=QA($A.DayPeriods,TA.Narrow);break;case"b":case"bb":case"bbb":t=QA($A.DayPeriods,TA.Abbreviated,OA.Standalone,!0);break;case"bbbb":t=QA($A.DayPeriods,TA.Wide,OA.Standalone,!0);break;case"bbbbb":t=QA($A.DayPeriods,TA.Narrow,OA.Standalone,!0);break;case"B":case"BB":case"BBB":t=QA($A.DayPeriods,TA.Abbreviated,OA.Format,!0);break;case"BBBB":t=QA($A.DayPeriods,TA.Wide,OA.Format,!0);break;case"BBBBB":t=QA($A.DayPeriods,TA.Narrow,OA.Format,!0);break;case"h":t=KA(GA.Hours,1,-12);break;case"hh":t=KA(GA.Hours,2,-12);break;case"H":t=KA(GA.Hours,1);break;case"HH":t=KA(GA.Hours,2);break;case"m":t=KA(GA.Minutes,1);break;case"mm":t=KA(GA.Minutes,2);break;case"s":t=KA(GA.Seconds,1);break;case"ss":t=KA(GA.Seconds,2);break;case"S":t=KA(GA.FractionalSeconds,1);break;case"SS":t=KA(GA.FractionalSeconds,2);break;case"SSS":t=KA(GA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=XA(HA.Short);break;case"ZZZZZ":t=XA(HA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=XA(HA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=XA(HA.Long);break;default:return null}return nM[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function qA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function WA(e,t){var n=function(e){return ES(e)[OS.LocaleId]}(e);if(BA[n]=BA[n]||{},BA[n][t])return BA[n][t];var r="";switch(t){case"shortDate":r=MA(e,IA.Short);break;case"mediumDate":r=MA(e,IA.Medium);break;case"longDate":r=MA(e,IA.Long);break;case"fullDate":r=MA(e,IA.Full);break;case"shortTime":r=xA(e,IA.Short);break;case"mediumTime":r=xA(e,IA.Medium);break;case"longTime":r=xA(e,IA.Long);break;case"fullTime":r=xA(e,IA.Full);break;case"short":var i=WA(e,"shortTime"),a=WA(e,"shortDate");r=jA(RA(e,IA.Short),[i,a]);break;case"medium":var o=WA(e,"mediumTime"),s=WA(e,"mediumDate");r=jA(RA(e,IA.Medium),[o,s]);break;case"long":var u=WA(e,"longTime"),c=WA(e,"longDate");r=jA(RA(e,IA.Long),[u,c]);break;case"full":var l=WA(e,"fullTime"),f=WA(e,"fullDate");r=jA(RA(e,IA.Full),[l,f])}return r&&(BA[n][t]=r),r}function jA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function YA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function KA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case GA.FullYear:return t.getFullYear();case GA.Month:return t.getMonth();case GA.Date:return t.getDate();case GA.Hours:return t.getHours();case GA.Minutes:return t.getMinutes();case GA.Seconds:return t.getSeconds();case GA.FractionalSeconds:return t.getMilliseconds();case GA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===GA.Hours)0===s&&-12===n&&(s=12);else if(e===GA.FractionalSeconds)return function(e,t){return YA(e,3).substr(0,t)}(s,t);var u=NA(o,AA.MinusSign);return YA(s,t,u,r,i)}}function QA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OA.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case $A.Months:return function(e,t,n){var r=ES(e),i=FA([r[OS.MonthsFormat],r[OS.MonthsStandalone]],t);return FA(i,n)}(t,i,r)[e.getMonth()];case $A.Days:return function(e,t,n){var r=ES(e),i=FA([r[OS.DaysFormat],r[OS.DaysStandalone]],t);return FA(i,n)}(t,i,r)[e.getDay()];case $A.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=ES(e);return LA(t),(t[OS.ExtraData][2]||[]).map(function(e){return"string"==typeof e?UA(e):[UA(e[0]),UA(e[1])]})}(t),c=function(e,t,n){var r=ES(e);LA(r);var i=FA([r[OS.ExtraData][0],r[OS.ExtraData][1]],t)||[];return FA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=iy(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=ES(e),i=FA([r[OS.DayPeriodsFormat],r[OS.DayPeriodsStandalone]],t);return FA(i,n)}(t,i,r)[o<12?0:1];case $A.Eras:return function(e,t){return FA(ES(e)[OS.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function XA(e){return function(t,n,r){var i=-1*r,a=NA(n,AA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case HA.Short:return(i>=0?"+":"")+YA(o,2,a)+YA(Math.abs(i%60),2,a);case HA.ShortGMT:return"GMT"+(i>=0?"+":"")+YA(o,1,a);case HA.Long:return"GMT"+(i>=0?"+":"")+YA(o,2,a)+":"+YA(Math.abs(i%60),2,a);case HA.Extended:return 0===r?"Z":(i>=0?"+":"")+YA(o,2,a)+":"+YA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function JA(e){return qA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function eM(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=JA(n),u=function(e){var t=qA(e,0,1).getDay();return qA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return YA(i,e,NA(r,AA.MinusSign))}}function tM(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return YA(JA(n).getFullYear(),e,NA(r,AA.MinusSign),t)}}var nM={};function rM(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function iM(e){return e instanceof Date&&!isNaN(e.valueOf())}var aM=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function oM(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var sM=Py(function e(){by(this,e)}),uM=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).locale=e,r}return Py(n,[{key:"getPluralCategory",value:function(e,t){switch(DA(t||this.locale)(e)){case SA.Zero:return"zero";case SA.One:return"one";case SA.Two:return"two";case SA.Few:return"few";case SA.Many:return"many";default:return"other"}}}]),n}(sM);return e.\u0275fac=function(t){return new(t||e)(Ww(mI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function cM(e,t){t=encodeURIComponent(t);var n,r=Cy(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=iy(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var lM=function(){var e=function(){function e(t,n,r,i){by(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return Py(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(yP(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(Nm(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(aT),IP(sT),IP(BO),IP(GO))},e.\u0275dir=Ok({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),fM=function(){function e(t,n,r,i){by(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return Py(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),hM=function(){var e=function(){function e(t,n,r){by(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return Py(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new fM(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new dM(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new dM(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(bT),IP(yT),IP(aT))},e.\u0275dir=Ok({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),dM=Py(function e(t,n){by(this,e),this.record=t,this.view=n}),vM=function(){var e=function(){function e(t,n){by(this,e),this._viewContainer=t,this._context=new pM,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return Py(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){gM("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){gM("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(bT),IP(yT))},e.\u0275dir=Ok({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),pM=Py(function e(){by(this,e),this.$implicit=null,this.ngIf=null});function gM(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(Nm(t),"'."))}var yM=function(){var e=function(){function e(t){by(this,e),this._locale=t}return Py(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(aM);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=oM(v)),null!=p&&(f=oM(p)),null!=g?h=oM(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(NA(n,r)),C.length&&(s+=NA(n,i)+C.join("")),k&&(s+=NA(n,AA.Exponential)+"+"+k)}else s=NA(n,AA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return ES(e)[OS.NumberFormats][t]}(t,PA.Decimal),NA(t,AA.MinusSign)),t,AA.Group,AA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(Nm(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(mI,16))},e.\u0275pipe=Tk({name:"number",type:e,pure:!0}),e}(),mM=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[{provide:sM,useClass:uM}]}),e}(),kM=function(){var e=Py(function e(){by(this,e)});return e.\u0275prov=Zm({token:e,providedIn:"root",factory:function(){return new CM(Ww(sA),window)}}),e}(),CM=function(){function e(t,n){by(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return Py(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=wM(this.window.history)||wM(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function wM(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var _M,bM=Py(function e(){by(this,e)}),EM=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(PM=PM||document.querySelector("base"))?PM.getAttribute("href"):null;return null==t?null:function(e){(_M=_M||document.createElement("a")).setAttribute("href",e);var t=_M.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){PM=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return cM(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,aA||(aA=e)}}]),n}(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return Py(n)}(function(){return Py(function e(){by(this,e)})}())),PM=null,SM=new Ow("TRANSITION_ID"),OM=[{provide:cI,useFactory:function(e,t,n){return function(){n.get(lI).donePromise.then(function(){for(var n=oA(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[SM,sA,sP],multi:!0}],TM=function(){function e(){by(this,e)}return Py(e,[{key:"addToWindow",value:function(e){lk.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},lk.getAllAngularTestabilities=function(){return e.getAllTestabilities()},lk.getAllAngularRootElements=function(){return e.getAllRootElements()},lk.frameworkStabilizers||(lk.frameworkStabilizers=[]),lk.frameworkStabilizers.push(function(e){var t=lk.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?oA().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,BI=t}}]),e}(),IM=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),AM=new Ow("EventManagerPlugins"),MM=function(){var e=function(){function e(t,n){var r=this;by(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return Py(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(AM),Ww(AI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),xM=function(){function e(t){by(this,e),this._doc=t}return Py(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=oA().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),RM=function(){var e=function(){function e(){by(this,e),this._stylesSet=new Set}return Py(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),NM=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return Py(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(DM),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(DM)})}}]),n}(RM);return e.\u0275fac=function(t){return new(t||e)(Ww(sA))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function DM(e){oA().remove(e)}var LM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},FM=/%COMP%/g;function UM(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?UM(e,i,n):(i=i.replace(FM,e),n.push(i))}return n}function VM(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var BM=function(){var e=function(){function e(t,n,r){by(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new zM(t)}return Py(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case ok.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new HM(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case ok.ShadowDom:return new GM(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=UM(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(MM),Ww(NM),Ww(fI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),zM=function(){function e(t){by(this,e),this.eventManager=t,this.data=Object.create(null)}return Py(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(LM[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=LM[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=LM[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(J_.DashCase|J_.Important)?e.style.setProperty(t,n,r&J_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&J_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,VM(n)):this.eventManager.addEventListener(e,t,VM(n))}}]),e}(),HM=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;by(this,n),(o=t.call(this,e)).component=i;var s=UM(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(FM,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(FM,a+"-"+i.id),o}return Py(n,[{key:"applyToHost",value:function(e){cy(yy(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=cy(yy(n.prototype),"createElement",this).call(this,e,t);return cy(yy(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(zM),GM=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;by(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=UM(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return Py(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return cy(yy(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return cy(yy(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return cy(yy(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(cy(yy(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(zM),$M=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,e)}return Py(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(Ww(sA))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),ZM=["alt","control","meta","shift"],qM={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},WM={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},jM={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},YM=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,e)}return Py(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return oA().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(ZM.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&WM.hasOwnProperty(t)&&(t=WM[t]))}return qM[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),ZM.forEach(function(r){r!=n&&jM[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(Ww(sA))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),KM=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({factory:function(){return Ww(QM)},token:e,providedIn:"root"}),e}(),QM=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this))._doc=e,r}return Py(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case U_.NONE:return t;case U_.HTML:return h_(t,"HTML")?f_(t):L_(this._doc,String(t)).toString();case U_.STYLE:return h_(t,"Style")?f_(t):t;case U_.SCRIPT:if(h_(t,"Script"))return f_(t);throw new Error("unsafe value used in a script context");case U_.URL:return d_(t),h_(t,"URL")?f_(t):k_(String(t));case U_.RESOURCE_URL:if(h_(t,"ResourceURL"))return f_(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new o_(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new s_(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new u_(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new c_(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new l_(e)}(e)}}]),n}(KM);return e.\u0275fac=function(t){return new(t||e)(Ww(sA))},e.\u0275prov=Zm({factory:function(){return function(e){return new QM(e.get(sA))}(Ww(WE))},token:e,providedIn:"root"}),e}(),XM=[{provide:pI,useValue:"browser"},{provide:vI,useValue:function(){EM.makeCurrent(),TM.init()},multi:!0},{provide:sA,useFactory:function(){return e=document,qk=e,document;var e},deps:[]}],JM=ZI(nA,"browser",XM),ex=[[],{provide:YE,useValue:"root"},{provide:W_,useFactory:function(){return new W_},deps:[]},{provide:AM,useClass:$M,multi:!0,deps:[sA,AI,pI]},{provide:AM,useClass:YM,multi:!0,deps:[sA]},[],{provide:BM,useClass:BM,deps:[MM,NM,fI]},{provide:HO,useExisting:BM},{provide:RM,useExisting:NM},{provide:NM,useClass:NM,deps:[sA]},{provide:UI,useClass:UI,deps:[AI]},{provide:MM,useClass:MM,deps:[AM,AI]},{provide:bM,useClass:IM,deps:[]},[]],tx=function(){var e=function(){function e(t){if(by(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return Py(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:fI,useValue:t.appId},{provide:SM,useExisting:fI},OM]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(e,12))},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:ex,imports:[mM,iA]}),e}();"undefined"!=typeof window&&window;var nx=Array.isArray,rx=Object.getPrototypeOf,ix=Object.prototype,ax=Object.keys;function ox(e){if(1===e.length){var t=e[0];if(nx(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&rx(e)===ix}(t)){var n=ax(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var sx=Array.isArray;function ux(e){return rm(function(t){return function(e,t){return sx(t)?e.apply(void 0,my(t)):e(t)}(e,t)})}function cx(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var lx=function(){var e=function(){function e(t,n){by(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return Py(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(GO),IP(BO))},e.\u0275dir=Ok({type:e}),e}(),fx=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n)}(lx);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275dir=Ok({type:t,features:[cP]}),t}(),hx=new Ow("NgValueAccessor"),dx={provide:hx,useExisting:Fm(function(){return px}),multi:!0},vx=new Ow("CompositionEventMode"),px=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=oA()?oA().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return Py(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(lx);return e.\u0275fac=function(t){return new(t||e)(IP(GO),IP(BO),IP(vx,8))},e.\u0275dir=Ok({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&BP("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[RO([dx]),cP]}),e}();function gx(e){return null==e||0===e.length}function yx(e){return null!=e&&"number"==typeof e.length}var mx=new Ow("NgValidators"),kx=new Ow("NgAsyncValidators"),Cx=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,wx=function(){function e(){by(this,e)}return Py(e,null,[{key:"min",value:function(e){return t=e,function(e){if(gx(e.value)||gx(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(gx(e.value)||gx(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return _x(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return gx((t=e).value)||Cx.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return gx(e.value)||!yx(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return bx(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(gx(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):Ex;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return Ax(e)}},{key:"composeAsync",value:function(e){return xx(e)}}]),e}();function _x(e){return gx(e.value)?{required:!0}:null}function bx(e){return function(t){return yx(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function Ex(e){return null}function Px(e){return null!=e}function Sx(e){var t=UP(e)?Im(e):e;return VP(t),t}function Ox(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function Tx(e,t){return t.map(function(t){return t(e)})}function Ix(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function Ax(e){if(!e)return null;var t=e.filter(Px);return 0==t.length?null:function(e){return Ox(Tx(e,t))}}function Mx(e){return null!=e?Ax(Ix(e)):null}function xx(e){if(!e)return null;var t=e.filter(Px);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Em(t),i=ox(t),a=i.args,o=i.keys,s=new Yy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;ym(a[t]).subscribe(new nm(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?cx(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(ux(r)):s}(Tx(e,t).map(Sx)).pipe(rm(Ox))}}function Rx(e){return null!=e?xx(Ix(e)):null}function Nx(e,t){return null===e?[t]:Array.isArray(e)?[].concat(my(e),[t]):[e,t]}function Dx(e){return e._rawValidators}function Lx(e){return e._rawAsyncValidators}function Fx(e){return e?Array.isArray(e)?e:[e]:[]}function Ux(e,t){return Array.isArray(e)?e.includes(t):e===t}function Vx(e,t){var n=Fx(t);return Fx(e).forEach(function(e){Ux(n,e)||n.push(e)}),n}function Bx(e,t){return Fx(t).filter(function(t){return!Ux(e,t)})}var zx=function(){var e=function(){function e(){by(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return Py(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=Mx(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Rx(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ok({type:e}),e}(),Hx=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(zx);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275dir=Ok({type:t,features:[cP]}),t}(),Gx=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return Py(n)}(zx),$x=function(){function e(t){by(this,e),this._cd=t}return Py(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),Zx=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,e)}return Py(n)}($x);return e.\u0275fac=function(t){return new(t||e)(IP(Gx,2))},e.\u0275dir=Ok({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&rS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[cP]}),e}(),qx=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,e)}return Py(n)}($x);return e.\u0275fac=function(t){return new(t||e)(IP(Hx,10))},e.\u0275dir=Ok({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&rS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[cP]}),e}();function Wx(e,t){return[].concat(my(t.path),[e])}function jx(e,t){Qx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Jx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Jx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function Yx(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),Xx(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function Kx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Qx(e,t){var n=Dx(e);null!==t.validator?e.setValidators(Nx(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=Lx(e);null!==t.asyncValidator?e.setAsyncValidators(Nx(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};Kx(t._rawValidators,i),Kx(t._rawAsyncValidators,i)}function Xx(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=Dx(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=Lx(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return Kx(t._rawValidators,s),Kx(t._rawAsyncValidators,s),n}function Jx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function eR(e,t){Qx(e,t)}function tR(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function nR(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function rR(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===px?n=e:function(e){return Object.getPrototypeOf(e.constructor)===fx}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function iR(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var aR="VALID",oR="INVALID",sR="PENDING",uR="DISABLED";function cR(e){return(dR(e)?e.validators:e)||null}function lR(e){return Array.isArray(e)?Mx(e):e||null}function fR(e,t){return(dR(t)?t.asyncValidators:e)||null}function hR(e){return Array.isArray(e)?Rx(e):e||null}function dR(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var vR=function(){function e(t,n){by(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=lR(this._rawValidators),this._composedAsyncValidatorFn=hR(this._rawAsyncValidators)}return Py(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===aR}},{key:"invalid",get:function(){return this.status===oR}},{key:"pending",get:function(){return this.status==sR}},{key:"disabled",get:function(){return this.status===uR}},{key:"enabled",get:function(){return this.status!==uR}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=lR(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=hR(e)}},{key:"addValidators",value:function(e){this.setValidators(Vx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(Vx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(Bx(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(Bx(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return Ux(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return Ux(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=sR,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=uR,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=aR,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===aR||this.status===sR)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?uR:aR}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=sR,this._hasOwnPendingAsyncValidator=!0;var n=Sx(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof gR?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof yR&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new qT,this.statusChanges=new qT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?uR:this.errors?oR:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(sR)?sR:this._anyControlsHaveStatus(oR)?oR:aR}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){dR(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),pR=function(e){fy(n,e);var t=dy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return by(this,n),(e=t.call(this,cR(i),fR(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return Py(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){iR(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){iR(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(vR),gR=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,cR(r),fR(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Py(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof pR?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(vR),yR=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,cR(r),fR(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Py(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof pR?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Cy(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(vR),mR={provide:Hx,useExisting:Fm(function(){return CR})},kR=Promise.resolve(null),CR=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new qT,i.form=new gR({},Mx(e),Rx(r)),i}return Py(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;kR.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),jx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;kR.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),iR(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;kR.then(function(){var n=t._findContainer(e.path),r=new gR({});eR(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;kR.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;kR.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,nR(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(Hx);return e.\u0275fac=function(t){return new(t||e)(IP(mx,10),IP(kx,10))},e.\u0275dir=Ok({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&BP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[RO([mR]),cP]}),e}(),wR={provide:Gx,useExisting:Fm(function(){return bR})},_R=Promise.resolve(null),bR=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this)).control=new pR,o._registered=!1,o.update=new qT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=rR(0,a),o}return Py(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),tR(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?Wx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){jx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;_R.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;_R.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(Gx);return e.\u0275fac=function(t){return new(t||e)(IP(Hx,9),IP(mx,10),IP(kx,10),IP(hx,10))},e.\u0275dir=Ok({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[RO([wR]),cP,Bk]}),e}(),ER=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ok({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),PR=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({}),e}(),SR={provide:hx,useExisting:Fm(function(){return OR}),multi:!0},OR=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(fx);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275dir=Ok({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&BP("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[RO([SR]),cP]}),t}(),TR=new Ow("NgModelWithFormControlWarning"),IR={provide:Hx,useExisting:Fm(function(){return AR})},AR=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new qT,i._setValidators(e),i._setAsyncValidators(r),i}return Py(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(Xx(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return jx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){Yx(e.control||null,e,!1),iR(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,nR(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(Yx(n||null,t),r instanceof pR&&(jx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);eR(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return Xx(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){Qx(this.form,this),this._oldForm&&Xx(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(Hx);return e.\u0275fac=function(t){return new(t||e)(IP(mx,10),IP(kx,10))},e.\u0275dir=Ok({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&BP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[RO([IR]),cP,Bk]}),e}(),MR={provide:Gx,useExisting:Fm(function(){return xR})},xR=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new qT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=rR(0,a),s}return Py(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),tR(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return Wx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(Gx);return e.\u0275fac=function(t){return new(t||e)(IP(Hx,13),IP(mx,10),IP(kx,10),IP(hx,10),IP(TR,8))},e.\u0275dir=Ok({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[RO([MR]),cP,Bk]}),e._ngModelWarningSentOnce=!1,e}(),RR={provide:hx,useExisting:Fm(function(){return DR}),multi:!0};function NR(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var DR=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Py(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=NR(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(fx);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275dir=Ok({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&BP("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[RO([RR]),cP]}),t}(),LR=function(){var e=function(){function e(t,n,r){by(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return Py(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(NR(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(BO),IP(GO),IP(DR,9))},e.\u0275dir=Ok({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),FR={provide:hx,useExisting:Fm(function(){return VR}),multi:!0};function UR(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var VR=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Py(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(fx);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275dir=Ok({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&BP("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[RO([FR]),cP]}),t}(),BR=function(){var e=function(){function e(t,n,r){by(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return Py(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(UR(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(UR(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(BO),IP(GO),IP(VR,9))},e.\u0275dir=Ok({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),zR={provide:mx,useExisting:Fm(function(){return HR}),multi:!0},HR=function(){var e=function(){function e(){by(this,e),this._required=!1}return Py(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?_x(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ok({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&_P("required",t.required?"":null)},inputs:{required:"required"},features:[RO([zR])]}),e}(),GR={provide:mx,useExisting:Fm(function(){return $R}),multi:!0},$R=function(){var e=function(){function e(){by(this,e),this._validator=Ex}return Py(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?bx(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):Ex}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ok({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&_P("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[RO([GR]),Bk]}),e}(),ZR=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({imports:[[PR]]}),e}(),qR=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({imports:[ZR]}),e}(),WR=function(){var e=function(){function e(){by(this,e)}return Py(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:TR,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({imports:[ZR]}),e}(),jR=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new gR(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new pR(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new yR(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof pR||e instanceof gR||e instanceof yR?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({factory:function(){return new e},token:e,providedIn:WR}),e}();function YR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Im(t,Pm(t))}function KR(e,t){return gy(t)?Cm(e,t,1):Cm(e,1)}function QR(e,t){return tm(function(n,r){var i=0;n.subscribe(new nm(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var XR=Py(function e(){by(this,e)}),JR=Py(function e(){by(this,e)}),eN=function(){function e(t){var n=this;by(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return Py(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,my(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),tN=function(){function e(){by(this,e)}return Py(e,[{key:"encodeKey",value:function(e){return iN(e)}},{key:"encodeValue",value:function(e){return iN(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),nN=/%(\d[a-f0-9])/gi,rN={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function iN(e){return encodeURIComponent(e).replace(nN,function(e,t){var n;return null!==(n=rN[t])&&void 0!==n?n:e})}function aN(e){return"".concat(e)}var oN=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(by(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new tN,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=iy(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return Py(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(aN(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(aN(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),sN=function(){function e(){by(this,e),this.map=new Map}return Py(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function uN(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function cN(e){return"undefined"!=typeof Blob&&e instanceof Blob}function lN(e){return"undefined"!=typeof FormData&&e instanceof FormData}var fN=function(){function e(t,n,r,i){var a;if(by(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new eN),this.context||(this.context=new sN),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new oN,this.urlWithParams=n}return Py(e,[{key:"serializeBody",value:function(){return null===this.body?null:uN(this.body)||cN(this.body)||lN(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof oN?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||lN(this.body)?null:cN(this.body)?this.body.type||null:uN(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof oN?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),hN=((hN=hN||{})[hN.Sent=0]="Sent",hN[hN.UploadProgress=1]="UploadProgress",hN[hN.ResponseHeader=2]="ResponseHeader",hN[hN.DownloadProgress=3]="DownloadProgress",hN[hN.Response=4]="Response",hN[hN.User=5]="User",hN),dN=Py(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";by(this,e),this.headers=t.headers||new eN,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),vN=function(e){fy(n,e);var t=dy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return by(this,n),(e=t.call(this,r)).type=hN.ResponseHeader,e}return Py(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(dN),pN=function(e){fy(n,e);var t=dy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return by(this,n),(e=t.call(this,r)).type=hN.Response,e.body=void 0!==r.body?r.body:null,e}return Py(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(dN),gN=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return Py(n)}(dN);function yN(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var mN=function(){var e=function(){function e(t){by(this,e),this.handler=t}return Py(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof fN?n=e:(r=o.headers instanceof eN?o.headers:new eN(o.headers),o.params&&(i=o.params instanceof oN?o.params:new oN({fromObject:o.params})),n=new fN(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=YR(n).pipe(KR(function(e){return a.handler.handle(e)}));if(e instanceof fN||"events"===o.observe)return s;var u=s.pipe(QR(function(e){return e instanceof pN}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(rm(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(rm(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(rm(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(rm(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new oN).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,yN(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,yN(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,yN(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(XR))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),kN=function(){function e(t,n){by(this,e),this.next=t,this.interceptor=n}return Py(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),CN=new Ow("HTTP_INTERCEPTORS"),wN=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),_N=/^\)\]\}',?\n/,bN=function(){var e=function(){function e(t){by(this,e),this.xhrFactory=t}return Py(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Yy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new eN(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new vN({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(_N,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new pN({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new gN({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new gN({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:hN.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:hN.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:hN.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(bM))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),EN=new Ow("XSRF_COOKIE_NAME"),PN=new Ow("XSRF_HEADER_NAME"),SN=Py(function e(){by(this,e)}),ON=function(){var e=function(){function e(t,n,r){by(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return Py(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=cM(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(sA),Ww(pI),Ww(EN))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),TN=function(){var e=function(){function e(t,n){by(this,e),this.tokenService=t,this.headerName=n}return Py(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(SN),Ww(PN))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),IN=function(){var e=function(){function e(t,n){by(this,e),this.backend=t,this.injector=n,this.chain=null}return Py(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(CN,[]);this.chain=t.reduceRight(function(e,t){return new kN(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(JR),Ww(sP))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),AN=function(){var e=function(){function e(){by(this,e)}return Py(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:TN,useClass:wN}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:EN,useValue:t.cookieName}:[],t.headerName?{provide:PN,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[TN,{provide:CN,useExisting:TN,multi:!0},{provide:SN,useClass:ON},{provide:EN,useValue:"XSRF-TOKEN"},{provide:PN,useValue:"X-XSRF-TOKEN"}]}),e}(),MN=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[mN,{provide:XR,useClass:IN},bN,{provide:JR,useExisting:bN}],imports:[[AN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),xN=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this))._value=e,r}return Py(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=cy(yy(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){cy(yy(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Xy);function RN(e,t,n){e?km(n,e,t):t()}var NN=ky(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function DN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wm(1)(Im(t,Pm(t)))}function LN(e){return new Yy(function(t){ym(e()).subscribe(t)})}function FN(){return tm(function(e,t){var n=null;e._refCount++;var r=new nm(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var UN=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,em(e)&&(i.lift=e.lift),i}return Py(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new Ey;var n=this.getSubject();t.add(this.source.subscribe(new nm(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=Ey.EMPTY)}return t}},{key:"refCount",value:function(){return FN()(this)}}]),n}(Yy);function VN(e,t){return tm(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new nm(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;ym(e(n,u)).subscribe(i=new nm(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function BN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new nm(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function zN(e,t){return tm(BN(e,t,arguments.length>=2,!0))}function HN(e){return tm(function(t,n){var r,i=null,a=!1;i=t.subscribe(new nm(n,void 0,void 0,function(o){r=ym(e(o,HN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function GN(e){return e<=0?function(){return _m}:tm(function(t,n){var r=[];t.subscribe(new nm(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Cy(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function $N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZN;return tm(function(t,n){var r=!1;t.subscribe(new nm(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function ZN(){return new NN}function qN(e){return tm(function(t,n){var r=!1;t.subscribe(new nm(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function WN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?QR(function(t,n){return e(t,n,r)}):jy,Am(1),n?qN(t):$N(function(){return new NN}))}}function jN(e,t,n){var r=gy(e)||t||n?{next:e,error:t,complete:n}:e;return r?tm(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new nm(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):jy}var YN=Py(function e(t,n){by(this,e),this.id=t,this.url=n}),KN=function(e){fy(n,e);var t=dy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return by(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return Py(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(YN),QN=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return Py(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(YN),XN=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).reason=i,a}return Py(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(YN),JN=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).error=i,a}return Py(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(YN),eD=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Py(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(YN),tD=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Py(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(YN),nD=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return Py(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(YN),rD=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Py(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(YN),iD=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Py(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(YN),aD=function(){function e(t){by(this,e),this.route=t}return Py(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),oD=function(){function e(t){by(this,e),this.route=t}return Py(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),sD=function(){function e(t){by(this,e),this.snapshot=t}return Py(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),uD=function(){function e(t){by(this,e),this.snapshot=t}return Py(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),cD=function(){function e(t){by(this,e),this.snapshot=t}return Py(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),lD=function(){function e(t){by(this,e),this.snapshot=t}return Py(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),fD=function(){function e(t,n,r){by(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return Py(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),hD="primary",dD=function(){function e(t){by(this,e),this.params=t||{}}return Py(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function vD(e){return new dD(e)}var pD="ngNavigationCancelingError";function gD(e){var t=Error("NavigationCancelingError: "+e);return t[pD]=!0,t}function yD(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function mD(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!kD(e[n=r[a]],t[n]))return!1;return!0}function kD(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=my(e).sort(),r=my(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function CD(e){return Array.prototype.concat.apply([],e)}function wD(e){return e.length>0?e[e.length-1]:null}function _D(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function bD(e){return VP(e)?e:UP(e)?Im(Promise.resolve(e)):YR(e)}var ED={exact:function e(t,n,r){if(!RD(t.segments,n.segments)||!ID(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:OD},PD={exact:function(e,t){return mD(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return kD(e[n],t[n])})},ignored:function(){return!0}};function SD(e,t,n){return ED[n.paths](e.root,t.root,n.matrixParams)&&PD[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function OD(e,t,n){return TD(e,t,t.segments,n)}function TD(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!RD(i,n)||t.hasChildren()||!ID(i,n,r))}if(e.segments.length===n.length){if(!RD(e.segments,n)||!ID(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!OD(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(RD(e.segments,o)&&ID(e.segments,o,r)&&e.children[hD])&&TD(e.children[hD],t,s,r)}function ID(e,t,n){return t.every(function(t,r){return PD[n](e[r].parameters,t.parameters)})}var AD=function(){function e(t,n,r){by(this,e),this.root=t,this.queryParams=n,this.fragment=r}return Py(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=vD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return LD.serialize(this)}}]),e}(),MD=function(){function e(t,n){var r=this;by(this,e),this.segments=t,this.children=n,this.parent=null,_D(n,function(e,t){return e.parent=r})}return Py(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return FD(this)}}]),e}(),xD=function(){function e(t,n){by(this,e),this.path=t,this.parameters=n}return Py(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=vD(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return $D(this)}}]),e}();function RD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var ND=Py(function e(){by(this,e)}),DD=function(){function e(){by(this,e)}return Py(e,[{key:"parse",value:function(e){var t=new YD(e);return new AD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(UD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(BD(t),"=").concat(BD(e))}).join("&"):"".concat(BD(t),"=").concat(BD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),LD=new DD;function FD(e){return e.segments.map(function(e){return $D(e)}).join("/")}function UD(e,t){if(!e.hasChildren())return FD(e);if(t){var n=e.children[hD]?UD(e.children[hD],!1):"",r=[];return _D(e.children,function(e,t){t!==hD&&r.push("".concat(t,":").concat(UD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return _D(e.children,function(e,r){r===hD&&(n=n.concat(t(e,r)))}),_D(e.children,function(e,r){r!==hD&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===hD?[UD(e.children[hD],!1)]:["".concat(n,":").concat(UD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[hD]?"".concat(FD(e),"/").concat(i[0]):"".concat(FD(e),"/(").concat(i.join("//"),")")}function VD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function BD(e){return VD(e).replace(/%3B/gi,";")}function zD(e){return VD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function HD(e){return decodeURIComponent(e)}function GD(e){return HD(e.replace(/\+/g,"%20"))}function $D(e){return"".concat(zD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(zD(t),"=").concat(zD(e[t]))}).join("")}(e.parameters))}var ZD=/^[^\/()?;=#]+/;function qD(e){var t=e.match(ZD);return t?t[0]:""}var WD=/^[^=?&#]+/,jD=/^[^?&#]+/,YD=function(){function e(t){by(this,e),this.url=t,this.remaining=t}return Py(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new MD([],{}):new MD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[hD]=new MD(e,t)),n}},{key:"parseSegment",value:function(){var e=qD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new xD(HD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=qD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=qD(this.remaining);r&&(n=r,this.capture(n))}e[HD(t)]=HD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(WD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(jD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=GD(t),a=GD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=qD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=hD);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[hD]:new MD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),KD=function(){function e(t){by(this,e),this._root=t}return Py(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=QD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=QD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=XD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return XD(e,this._root).map(function(e){return e.value})}}]),e}();function QD(e,t){if(e===t.value)return t;var n,r=Cy(t.children);try{for(r.s();!(n=r.n()).done;){var i=QD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function XD(e,t){if(e===t.value)return[t];var n,r=Cy(t.children);try{for(r.s();!(n=r.n()).done;){var i=XD(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var JD=function(){function e(t,n){by(this,e),this.value=t,this.children=n}return Py(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function eL(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var tL=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e)).snapshot=r,sL(py(i),e),i}return Py(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(KD);function nL(e,t){var n=function(e,t){var n=new aL([],{},{},"",{},hD,t,null,e.root,-1,{});return new oL("",new JD(n,[]))}(e,t),r=new xN([new xD("",{})]),i=new xN({}),a=new xN({}),o=new xN({}),s=new xN(""),u=new rL(r,i,o,s,a,hD,t,n.root);return u.snapshot=n.root,new tL(new JD(u,[]),n)}var rL=function(){function e(t,n,r,i,a,o,s,u){by(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return Py(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(rm(function(e){return vD(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(rm(function(e){return vD(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function iL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var aL=function(){function e(t,n,r,i,a,o,s,u,c,l,f){by(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return Py(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=vD(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=vD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),oL=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,r)).url=e,sL(py(i),r),i}return Py(n,[{key:"toString",value:function(){return uL(this._root)}}]),n}(KD);function sL(e,t){t.value._routerState=e,t.children.forEach(function(t){return sL(e,t)})}function uL(e){var t=e.children.length>0?" { ".concat(e.children.map(uL).join(", ")," } "):"";return"".concat(e.value).concat(t)}function cL(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,mD(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),mD(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!mD(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),mD(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function lL(e,t){var n=mD(e.params,t.params)&&function(e,t){return RD(e,t)&&e.every(function(e,n){return mD(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||lL(e.parent,t.parent))}function fL(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Cy(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return fL(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return fL(e,t)})}(e,t,n);return new JD(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return hL(t,o),o}}var s=function(e){return new rL(new xN(e.url),new xN(e.params),new xN(e.queryParams),new xN(e.fragment),new xN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return fL(e,t)});return new JD(s,u)}function hL(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)hL(e.children[n],t.children[n])}function dL(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function vL(e){return"object"==typeof e&&null!=e&&e.outlets}function pL(e,t,n,r,i){var a={};return r&&_D(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new AD(n.root===e?t:gL(n.root,e,t),a,i)}function gL(e,t,n){var r={};return _D(e.children,function(e,i){r[i]=e===t?n:gL(e,t,n)}),new MD(e.segments,r)}var yL=function(){function e(t,n,r){if(by(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&dL(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(vL);if(i&&i!==wD(r))throw new Error("{outlets:{}} has to be the last command")}return Py(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),mL=Py(function e(t,n,r){by(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function kL(e,t,n){if(e||(e=new MD([],{})),0===e.segments.length&&e.hasChildren())return CL(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(vL(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!EL(u,c,o))return a;r+=2}else{if(!EL(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new MD(e.segments.slice(0,r.pathIndex),{});return a.children[hD]=new MD(e.segments.slice(r.pathIndex),e.children),CL(a,0,i)}return r.match&&0===i.length?new MD(e.segments,{}):r.match&&!e.hasChildren()?wL(e,t,n):r.match?CL(e,0,i):wL(e,t,n)}function CL(e,t,n){if(0===n.length)return new MD(e.segments,{});var r=function(e){return vL(e[0])?e[0].outlets:ry({},hD,e)}(n),i={};return _D(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=kL(e.children[r],t,n))}),_D(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new MD(e.segments,i)}function wL(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(vL(a)){var o=_L(a.outlets);return new MD(r,o)}if(0===i&&dL(n[0]))r.push(new xD(e.segments[t].path,bL(n[0]))),i++;else{var s=vL(a)?a.outlets[hD]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&dL(u)?(r.push(new xD(s,bL(u))),i+=2):(r.push(new xD(s,{})),i++)}}return new MD(r,{})}function _L(e){var t={};return _D(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=wL(new MD([],{}),0,e))}),t}function bL(e){var t={};return _D(e,function(e,n){return t[n]="".concat(e)}),t}function EL(e,t,n){return e==n.path&&mD(t,n.parameters)}var PL=function(){function e(t,n,r,i){by(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return Py(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),cL(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=eL(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),_D(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=eL(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=eL(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new lD(e.value.snapshot))}),e.children.length&&this.forwardEvent(new uD(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(cL(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),SL(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function SL(e){cL(e.value),e.children.forEach(SL)}var OL=Py(function e(t,n){by(this,e),this.routes=t,this.module=n});function TL(e){return"function"==typeof e}function IL(e){return e instanceof AD}var AL=Symbol("INITIAL_VALUE");function ML(){return VN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Pm(t),i=Em(t),a=ox(t),o=a.args,s=a.keys;if(0===o.length)return Im([],r);var u=new Yy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jy;return function(r){RN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){RN(t,function(){var u=Im(e[i],t),c=!1;u.subscribe(new nm(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return cx(s,e)}:jy));return i?u.pipe(ux(i)):u}(e.map(function(e){return e.pipe(Am(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Pm(t);return tm(function(e,n){(r?DN(t,e,r):DN(t,e)).subscribe(n)})}(AL))})).pipe(zN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==AL?e:(r===AL&&(n=!0),n||!1!==r&&i!==t.length-1&&!IL(r)?e:r)},e)},AL),QR(function(e){return e!==AL}),rm(function(e){return IL(e)?e:!0===e}),Am(1))})}var xL=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=wk({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&NP(0,"router-outlet")},directives:function(){return[IF]},encapsulation:2}),e}();function RL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];NL(r,DL(t,r))}}function NL(e,t){e.children&&RL(e.children,t)}function DL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function LL(e){var t=e.children&&e.children.map(LL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==hD&&(n.component=xL),n}function FL(e){return e.outlet||hD}function UL(e,t){var n=e.filter(function(e){return FL(e)===t});return n.push.apply(n,my(e.filter(function(e){return FL(e)!==t}))),n}var VL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function BL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},VL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||yD)(n,e,t);if(!i)return Object.assign({},VL);var a={};_D(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function zL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return HL(e,t,n)&&FL(n)!==hD})}(e,n,r)){var a=new MD(t,function(e,t,n,r){var i={};i[hD]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Cy(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&FL(s)!==hD){var u=new MD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[FL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new MD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return HL(e,t,n)})}(e,n,r)){var o=new MD(e.segments,function(e,t,n,r,i,a){var o,s={},u=Cy(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(HL(e,n,c)&&!i[FL(c)]){var l=new MD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[FL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new MD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function HL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function GL(e,t,n,r){return!!(FL(e)===r||r!==hD&&HL(t,n,e))&&("**"===e.path||BL(t,e,n).matched)}function $L(e,t,n){return 0===t.length&&!e.children[n]}var ZL=Py(function e(t){by(this,e),this.segmentGroup=t||null}),qL=Py(function e(t){by(this,e),this.urlTree=t});function WL(e){return new Yy(function(t){return t.error(new ZL(e))})}function jL(e){return new Yy(function(t){return t.error(new qL(e))})}function YL(e){return new Yy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var KL=function(){function e(t,n,r,i,a){by(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(CT)}return Py(e,[{key:"apply",value:function(){var e=this,t=zL(this.urlTree.root,[],[],this.config).segmentGroup,n=new MD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,hD).pipe(rm(function(t){return e.createUrlTree(QL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(HN(function(t){if(t instanceof qL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof ZL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,hD).pipe(rm(function(n){return t.createUrlTree(QL(n),e.queryParams,e.fragment)})).pipe(HN(function(e){throw e instanceof ZL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new MD([],ry({},hD,e)):e;return new AD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(rm(function(e){return new MD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return Im(i).pipe(KR(function(i){var a=n.children[i],o=UL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(rm(function(e){return{segment:e,outlet:i}}))}),zN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?QR(function(t,n){return e(t,n,r)}):jy,GN(1),n?qN(t):$N(function(){return new NN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return Im(n).pipe(KR(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(HN(function(e){if(e instanceof ZL)return YR(null);throw e}))}),WN(function(e){return!!e}),HN(function(e,n){if(e instanceof NN||"EmptyError"===e.name){if($L(t,r,i))return YR(new MD([],{}));throw new ZL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return GL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):WL(t):WL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?jL(a):this.lineralizeSegments(n,a).pipe(Cm(function(n){var a=new MD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=BL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return WL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?jL(h):this.lineralizeSegments(r,h).pipe(Cm(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?YR(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(rm(function(e){return n._loadedConfig=e,new MD(r,{})})):YR(new MD(r,{}));var o=BL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return WL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Cm(function(e){var r=e.module,o=e.routes,s=zL(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new MD(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(rm(function(e){return new MD(u,e)}));if(0===o.length&&0===f.length)return YR(new MD(u,{}));var d=FL(n)===i;return a.expandSegment(r,h,o,f,d?hD:i,!0).pipe(rm(function(e){return new MD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?YR(new OL(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?YR(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Cm(function(n){return n?r.configLoader.load(e.injector,t).pipe(rm(function(e){return t._loadedConfig=e,e})):(i=t,new Yy(function(e){return e.error(gD("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):YR(new OL([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?YR(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&TL(a.canLoad))i=o.canLoad(t,n);else{if(!TL(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return bD(i)})).pipe(ML(),jN(function(e){if(IL(e)){var t=gD('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),rm(function(e){return!0===e})):YR(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return YR(n);if(r.numberOfChildren>1||!r.children[hD])return YL(e.redirectTo);r=r.children[hD]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new AD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return _D(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return _D(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new MD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function QL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=QL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[hD]){var t=e.children[hD];return new MD(e.segments.concat(t.segments),t.children)}return e}(new MD(e.segments,t))}var XL=Py(function e(t){by(this,e),this.path=t,this.route=this.path[this.path.length-1]}),JL=Py(function e(t,n){by(this,e),this.component=t,this.route=n});function eF(e,t,n){var r=e._root;return nF(r,t?t._root:null,n,[r.value])}function tF(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function nF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=eL(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!RD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!RD(e.url,t.url)||!mD(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lL(e,t)||!mD(e.queryParams,t.queryParams);default:return!lL(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new XL(r)):(a.data=o.data,a._resolvedData=o._resolvedData),nF(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new JL(s.outlet.component,o))}else o&&rF(t,s,i),i.canActivateChecks.push(new XL(r)),nF(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),_D(a,function(e,t){return rF(e,n.getContext(t),i)}),i}function rF(e,t,n){var r=eL(e),i=e.value;_D(r,function(e,r){rF(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new JL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var iF=Py(function e(){by(this,e)});function aF(e){return new Yy(function(t){return t.error(e)})}var oF=function(){function e(t,n,r,i,a,o){by(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return Py(e,[{key:"recognize",value:function(){var e=zL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,hD);if(null===t)return null;var n=new aL([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},hD,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new JD(n,t),i=new oL(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=iL(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=UL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,my(u))}var c=sF(n);return c.sort(function(e,t){return e.value.outlet===hD?-1:t.value.outlet===hD?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return $L(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!GL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?wD(n).parameters:{};i=new aL(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,lF(e),FL(e),e.component,e,uF(t),cF(t)+n.length,fF(e))}else{var u=BL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new aL(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,lF(e),FL(e),e.component,e,uF(t),cF(t)+a.length,fF(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=zL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new JD(i,v)]}if(0===l.length&&0===d.length)return[new JD(i,[])];var p=FL(e)===r,g=this.processSegment(l,h,d,p?hD:r);return null===g?null:[new JD(i,g)]}}]),e}();function sF(e){var t,n=[],r=new Set,i=Cy(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,my(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Cy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=sF(u.children);n.push(new JD(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function uF(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function cF(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function lF(e){return e.data||{}}function fF(e){return e.resolve||{}}function hF(e){return VN(function(t){var n=e(t);return n?Im(n).pipe(rm(function(){return t})):YR(t)})}var dF=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n)}(function(){function e(){by(this,e)}return Py(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),vF=new Ow("ROUTES"),pF=function(){function e(t,n,r,i){by(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return Py(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(rm(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new OL(CD(i.injector.get(vF,void 0,tk.Self|tk.Optional)).map(LL),i)}),HN(function(e){throw t._loader$=void 0,e}));return t._loader$=new UN(r,function(){return new Xy}).pipe(FN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Im(this.loader.load(e)):bD(e()).pipe(Cm(function(e){return e instanceof wT?YR(e):Im(t.compiler.compileModuleAsync(e))}))}}]),e}(),gF=Py(function e(){by(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new yF,this.attachRef=null}),yF=function(){function e(){by(this,e),this.contexts=new Map}return Py(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new gF,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),mF=function(){function e(){by(this,e)}return Py(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function kF(e){throw e}function CF(e,t,n){return t.parse("/")}function wF(e,t){return YR(null)}var _F={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},EF=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;by(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Xy,this.errorHandler=kF,this.malformedUriErrorHandler=CF,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:wF,afterPreactivation:wF},this.urlHandlingStrategy=new mF,this.routeReuseStrategy=new dF,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(CT),this.console=a.get(yI);var l=a.get(AI);this.isNgZoneEnabled=l instanceof AI&&AI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new AD(new MD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new pF(o,s,function(e){return c.triggerEvent(new aD(e))},function(e){return c.triggerEvent(new oD(e))}),this.routerState=nL(this.currentUrlTree,this.rootComponentType),this.transitions=new xN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return Py(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(QR(function(e){return 0!==e.id}),rm(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),VN(function(e){var r=!1,i=!1;return YR(e).pipe(jN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),VN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return PF(e.source)&&(t.browserUrlTree=e.extractedUrl),YR(e).pipe(VN(function(e){var r=t.transitions.getValue();return n.next(new KN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?_m:Promise.resolve(e)}),function(e,t,n,r){return VN(function(i){return function(e,t,n,r,i){return new KL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(rm(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),jN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return Cm(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new oF(e,t,n,r,a,o).recognize();return null===s?aF(new iF):YR(s)}catch(i){return aF(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(rm(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),jN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new eD(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new KN(o,t.serializeUrl(s),u,c);n.next(f);var h=nL(s,t.rootComponentType).snapshot;return YR(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),_m}),hF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),jN(function(e){var n=new tD(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),rm(function(e){return Object.assign(Object.assign({},e),{guards:eF(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Cm(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?YR(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Im(e).pipe(Cm(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?YR(a.map(function(a){var o,s=tF(a,t,i);if(function(e){return e&&TL(e.canDeactivate)}(s))o=bD(s.canDeactivate(e,t,n,r));else{if(!TL(s))throw new Error("Invalid CanDeactivate guard");o=bD(s(e,t,n,r))}return o.pipe(WN())})).pipe(ML()):YR(!0)}(e.component,e.route,n,t,r)}),WN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Cm(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return Im(t).pipe(KR(function(t){return DN(function(e,t){return null!==e&&t&&t(new sD(e)),YR(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new cD(e)),YR(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return LN(function(){return YR(t.guards.map(function(i){var a,o=tF(i,t.node,n);if(function(e){return e&&TL(e.canActivateChild)}(o))a=bD(o.canActivateChild(r,e));else{if(!TL(o))throw new Error("Invalid CanActivateChild guard");a=bD(o(r,e))}return a.pipe(WN())})).pipe(ML())})});return YR(i).pipe(ML())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return YR(!0);var i=r.map(function(r){return LN(function(){var i,a=tF(r,t,n);if(function(e){return e&&TL(e.canActivate)}(a))i=bD(a.canActivate(t,e));else{if(!TL(a))throw new Error("Invalid CanActivate guard");i=bD(a(t,e))}return i.pipe(WN())})});return YR(i).pipe(ML())}(e,t.route,n))}),WN(function(e){return!0!==e},!0))}(r,o,e,t):YR(n)}),rm(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),jN(function(e){if(IL(e.guardsResult)){var n=gD('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new nD(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),QR(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),hF(function(e){if(e.guards.canActivateChecks.length)return YR(e).pipe(jN(function(e){var n=new rD(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),VN(function(e){var n=!1;return YR(e).pipe(function(e,t){return Cm(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return YR(n);var a=0;return Im(i).pipe(KR(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return YR({});var a={};return Im(i).pipe(Cm(function(i){return function(e,t,n,r){var i=tF(e,t,r);return bD(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(jN(function(e){a[i]=e}))}),GN(1),Cm(function(){return Object.keys(a).length===i.length?YR(a):_m}))}(e._resolve,e,t,r).pipe(rm(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),iL(e,n).resolve),null}))}(n.route,r,e,t)}),jN(function(){return a++}),GN(1),Cm(function(e){return a===i.length?YR(n):_m}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),jN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),jN(function(e){var n=new iD(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),hF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),rm(function(e){var n=function(e,t,n){var r=fL(e,t._root,n?n._root:void 0);return new tL(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),jN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return rm(function(r){return new PL(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),jN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return tm(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),HN(function(r){if(i=!0,function(e){return e&&e[pD]}(r)){var a=IL(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new XN(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||PF(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new JN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return _m}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){RL(e),this.config=e.map(LL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return pL(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new yL(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return _D(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(my(e),[{outlets:a}])}if(r.segmentPath)return[].concat(my(e),[r.segmentPath])}return"string"!=typeof r?[].concat(my(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(my(e),[r])},[]);return new yL(n,t,r)}(n);if(a.toRoot())return pL(t.root,new MD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new mL(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new mL(r,r===t.root,0)}var i=dL(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new mL(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?CL(o.segmentGroup,o.index,a.commands):kL(o.segmentGroup,o.index,a.commands);return pL(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=IL(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},_F):!1===t?Object.assign({},bF):t,IL(e))return SD(this.currentUrlTree,e,n);var r=this.parseUrl(e);return SD(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new QN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=PF(t)&&l&&!PF(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new XN(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(Iw),Ww(ND),Ww(yF),Ww(_A),Ww(sP),Ww(QI),Ww(OI),Ww(void 0))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function PF(e){return"imperative"!==e}var SF=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Xy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return Py(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:TF(this.skipLocationChange),replaceUrl:TF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:TF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(rL),Ew("tabindex"),IP(GO),IP(BO))},e.\u0275dir=Ok({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&BP("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Bk]}),e}(),OF=function(){var e=function(){function e(t,n,r){var i=this;by(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Xy,this.subscription=t.events.subscribe(function(e){e instanceof QN&&i.updateTargetUrlAndHref()})}return Py(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:TF(this.skipLocationChange),replaceUrl:TF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:TF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(rL),IP(yA))},e.\u0275dir=Ok({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&BP("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(CS("href",t.href,B_),_P("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Bk]}),e}();function TF(e){return""===e||!!e}var IF=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new qT,this.deactivateEvents=new qT,this.name=i||hD,t.onChildOutletCreated(this.name,this)}return Py(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new AF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(yF),IP(bT),IP(LO),Ew("name"),IP(hT))},e.\u0275dir=Ok({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),AF=function(){function e(t,n,r){by(this,e),this.route=t,this.childContexts=n,this.parent=r}return Py(e,[{key:"get",value:function(e,t){return e===rL?this.route:e===yF?this.childContexts:this.parent.get(e,t)}}]),e}(),MF=Py(function e(){by(this,e)}),xF=function(){function e(){by(this,e)}return Py(e,[{key:"preload",value:function(e,t){return YR(null)}}]),e}(),RF=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new pF(n,r,function(e){return t.triggerEvent(new aD(e))},function(e){return t.triggerEvent(new oD(e))})}return Py(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(QR(function(e){return e instanceof QN}),KR(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(CT);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return Im(r).pipe(wm(),rm(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?YR(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Cm(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(EF),Ww(QI),Ww(OI),Ww(sP),Ww(MF))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),NF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};by(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return Py(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof KN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof QN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof fD&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new fD(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(EF),Ww(kM),Ww(void 0))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),DF=new Ow("ROUTER_CONFIGURATION"),LF=new Ow("ROUTER_FORROOT_GUARD"),FF=[_A,{provide:ND,useClass:DD},{provide:EF,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new EF(null,e,t,n,r,i,a,CD(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[ND,yF,_A,sP,QI,OI,vF,DF,[function(){return Py(function e(){by(this,e)})}(),new t_],[function(){return Py(function e(){by(this,e)})}(),new t_]]},yF,{provide:rL,useFactory:function(e){return e.routerState.root},deps:[EF]},{provide:QI,useClass:eA},RF,xF,function(){function e(){by(this,e)}return Py(e,[{key:"preload",value:function(e,t){return t().pipe(HN(function(){return YR(null)}))}}]),e}(),{provide:DF,useValue:{enableTracing:!1}}];function UF(){return new $I("Router",EF)}var VF=function(){var e=function(){function e(t,n){by(this,e)}return Py(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[FF,GF(t),{provide:LF,useFactory:HF,deps:[[EF,new t_,new n_]]},{provide:DF,useValue:n||{}},{provide:yA,useFactory:zF,deps:[uA,[new e_(kA),new t_],DF]},{provide:NF,useFactory:BF,deps:[EF,kM,DF]},{provide:MF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:xF},{provide:$I,multi:!0,useFactory:UF},[$F,{provide:cI,multi:!0,useFactory:ZF,deps:[$F]},{provide:WF,useFactory:qF,deps:[$F]},{provide:gI,multi:!0,useExisting:WF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[GF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(LF,8),Ww(EF,8))},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({}),e}();function BF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new NF(e,t,n)}function zF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new wA(e,t):new CA(e,t)}function HF(e){return"guarded"}function GF(e){return[{provide:Tw,multi:!0,useValue:e},{provide:vF,multi:!0,useValue:e}]}var $F=function(){var e=function(){function e(t){by(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Xy}return Py(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(lA,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(EF),i=e.injector.get(DF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?YR(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(DF),n=this.injector.get(RF),r=this.injector.get(NF),i=this.injector.get(EF),a=this.injector.get(YI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(sP))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}();function ZF(e){return e.appInitializer.bind(e)}function qF(e){return e.bootstrapListener.bind(e)}var WF=new Ow("Router Initializer"),jF=Py(function e(){by(this,e)}),YF="*";function KF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function QF(e){return{type:6,styles:e,offset:null}}function XF(e){Promise.resolve(null).then(e)}var JF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;by(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return Py(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;XF(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),eU=function(){function e(t){var n=this;by(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?XF(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return Py(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function tU(){return"undefined"!=typeof window&&void 0!==window.document}function nU(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function rU(e){switch(e.length){case 0:return new JF;case 1:return e[0];default:return new eU(e)}}function iU(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case YF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function aU(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&oU(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&oU(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&oU(n,"destroy",e))})}}function oU(e,t,n){var r,i=sU(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function sU(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function uU(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function cU(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var lU=function(e,t){return!1},fU=function(e,t){return!1},hU=function(e,t,n){return[]},dU=nU();(dU||"undefined"!=typeof Element)&&(lU=tU()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},fU=function(){if(dU||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:fU}(),hU=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var vU=null,pU=!1;function gU(e){vU||(vU=("undefined"!=typeof document?document.body:null)||{},pU=!!vU.style&&"WebkitAppearance"in vU.style);var t=!0;return vU.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in vU.style)&&pU&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in vU.style)),t}var yU=fU,mU=lU,kU=hU;function CU(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var wU=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"validateStyleProperty",value:function(e){return gU(e)}},{key:"matchesElement",value:function(e,t){return yU(e,t)}},{key:"containsElement",value:function(e,t){return mU(e,t)}},{key:"query",value:function(e,t,n){return kU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new JF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),_U=function(){var e=Py(function e(){by(this,e)});return e.NOOP=new wU,e}(),bU="ng-enter",EU="ng-leave",PU="ng-trigger",SU=".ng-trigger",OU="ng-animating",TU=".ng-animating";function IU(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:AU(parseFloat(t[1]),t[2])}function AU(e,t){return"s"===t?1e3*e:e}function MU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=AU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=AU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function xU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function RU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else xU(e,n);return n}function NU(e,t,n){return n?t+":"+n+";":""}function DU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=NU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=NU(0,ZU(i),e.style[i]));e.setAttribute("style",t)}function LU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=$U(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),nU()&&DU(e))}function FU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=$U(t);e.style[n]=""}),nU()&&DU(e))}function UU(e){return Array.isArray(e)?1==e.length?e[0]:KF(e):e}var VU=new RegExp("{{\\s*(.+?)\\s*}}","g");function BU(e){var t=[];if("string"==typeof e){for(var n;n=VU.exec(e);)t.push(n[1]);VU.lastIndex=0}return t}function zU(e,t,n){var r=e.toString(),i=r.replace(VU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function HU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var GU=/-+([a-z0-9])/g;function $U(e){return e.replace(GU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function ZU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function qU(e,t){return 0===e||0===t}function WU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=YU(e,t)})},s=1;s<t.length;s++)o()}return t}function jU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function YU(e,t){return window.getComputedStyle(e)[t]}function KU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(JU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(JU(s,a))}(e,n,t)}):n.push(e),n}var QU=new Set(["true","1"]),XU=new Set(["false","0"]);function JU(e,t){var n=QU.has(e)||XU.has(e),r=QU.has(t)||XU.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?QU.has(e):XU.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?QU.has(t):XU.has(t)),o&&s}}var eV=new RegExp("s*:selfs*,?","g");function tV(e,t,n){return new nV(e).build(t,n)}var nV=function(){function e(t){by(this,e),this._driver=t}return Py(e,[{key:"build",value:function(e,t){var n=new rV(t);return this._resetContextStyleTimingState(n),jU(this,UU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(iV(e)){var t=e;Object.keys(t).forEach(function(e){BU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=HU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=jU(this,UU(e.animation),t);return{type:1,matchers:KU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:aV(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return jU(n,e,t)}),options:aV(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=jU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:aV(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return oV(MU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=oV(0,0,"");return i.dynamic=!0,i.strValue=r,i}return oV((n=n||MU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:QF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=QF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==YF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(iV(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=BU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(iV(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(iV(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:jU(this,UU(e.animation),t),options:aV(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:aV(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:aV(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(eV,"")),e=e.replace(/@\*/g,SU).replace(/@\w+/g,function(e){return SU+"-"+e.substr(1)}).replace(/:animating/g,TU),[e,t]}(e.selector),a=iy(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,uU(t.collectedStyles,t.currentQuerySelector,{});var u=jU(this,UU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:aV(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:MU(e.timings,t.errors,!0);return{type:12,animation:jU(this,UU(e.animation),t),timings:n,options:null}}}]),e}(),rV=Py(function e(t){by(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function iV(e){return!Array.isArray(e)&&"object"==typeof e}function aV(e){return e?(e=xU(e)).params&&(e.params=function(e){return e?xU(e):null}(e.params)):e={},e}function oV(e,t,n){return{duration:e,delay:t,easing:n}}function sV(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var uV=function(){function e(){by(this,e),this._map=new Map}return Py(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,my(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),cV=new RegExp(":enter","g"),lV=new RegExp(":leave","g");function fV(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new hV).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var hV=function(){function e(){by(this,e)}return Py(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new uV;var l=new vV(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),jU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[sV(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?IU(n.duration):null,a=null!=n.delay?IU(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),jU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=dV);var o=IU(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return jU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?IU(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),jU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return MU(t.params?zU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?IU(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=dV);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),jU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;jU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),dV={},vV=function(){function e(t,n,r,i,a,o,s,u){by(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=dV,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new pV(this._driver,n,0),s.push(this.currentTimeline)}return Py(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=IU(r.duration)),null!=r.delay&&(i.delay=IU(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=zU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=dV,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new gV(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(cV,"."+this._enterClassName)).replace(lV,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,my(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),pV=function(){function e(t,n,r,i){by(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return Py(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||YF,t._currentKeyframe[e]=YF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=YF}):RU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=zU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:YF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=RU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==YF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?HU(t.values()):[],o=n.size?HU(n.values()):[];if(r){var s=i[0],u=xU(s);s.offset=0,u.offset=1,i=[s,u]}return sV(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),gV=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return by(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return Py(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=RU(e[0],!1);u.offset=0,a.push(u);var c=RU(e[0],!1);c.offset=yV(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=RU(e[f],!1);h.offset=yV((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return sV(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(pV);function yV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var mV=Py(function e(){by(this,e)}),kV=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"normalizePropertyName",value:function(e,t){return $U(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(CV[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(mV),CV=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function wV(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var _V={},bV=function(){function e(t,n,r){by(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return Py(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||_V,h=this.buildStyles(n,o&&o.params||_V,l),d=s&&s.params||_V,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:fV(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return wV(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=uU(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=uU(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=HU(p.values());return wV(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),EV=function(){function e(t,n,r){by(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return Py(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=xU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=zU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),PV=function(){function e(t,n,r){var i=this;by(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new EV(e.style,e.options&&e.options.params||{},r)}),SV(this.states,"true","1"),SV(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new bV(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new bV(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return Py(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function SV(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var OV=new uV,TV=function(){function e(t,n,r){by(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return Py(e,[{key:"register",value:function(e,t){var n=[],r=tV(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=iU(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=fV(this._driver,t,o,bU,EU,{},{},i,OV,a)).forEach(function(e){var t=uU(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,YF)})});var u=rU(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=sU(t,"","","");return aU(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),IV="ng-animate-queued",AV="ng-animate-disabled",MV=".ng-animate-disabled",xV=[],RV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},NV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},DV="__ng_removed",LV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";by(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=xU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return Py(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),FV="void",UV=new LV(FV),VV=function(){function e(t,n,r){by(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,WV(n,this._hostClassName)}return Py(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=uU(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=uU(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(WV(e,PU),WV(e,PU+"-"+t),u[t]=UV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new zV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(WV(e,PU),WV(e,PU+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new LV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=UV),c.value===FV||u.value!==c.value){var l=uU(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(WV(e,IV),o.onStart(function(){jV(e,IV)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){FU(e,v),LU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,SU,!0);r.forEach(function(e){if(!e[DV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,FV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&rU(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||UV,u=new LV(FV),c=new zV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[DV];(!s||s===RV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){WV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=sU(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,aU(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),BV=function(){function e(t,n,r){by(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return Py(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new VV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(HV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(HV(t)){var i=t[DV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),WV(e,AV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),jV(e,AV))}},{key:"removeNode",value:function(e,t,n,r){if(HV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[DV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return HV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,SU,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,TU,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return rU(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[DV];if(n&&n.setForRemoval){if(e[DV]=RV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,MV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,MV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)WV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?rU(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new uV,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=ZV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=bU+p++;v.set(t,n),e.forEach(function(e){return WV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[DV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,b=ZV(h,Array.from(y));b.forEach(function(e,t){var n=EU+p++;_.set(t,n),e.forEach(function(e){return WV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return jV(e,n)})}),b.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return jV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],P=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[DV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)P.push(g);else{if(h)return t.onStart(function(){return FU(a,g.fromStyles)}),t.onDestroy(function(){return LU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return FU(a,g.fromStyles)}),t.onDestroy(function(){return LU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return uU(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(P.length){var O=[];P.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){uU(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return QV(e,u,c)}),M=new Map;$V(M,this.driver,m,c,YF).forEach(function(e){QV(e,u,c)&&A.push(e)});var x=new Map;d.forEach(function(e,t){$V(x,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=M.get(e),n=x.get(e);M.set(e,Object.assign(Object.assign({},t),n))});var R=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return LU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,x,M);if(o.setRealPlayer(d),u===D)R.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=rU(v)),i.push(o)}}else FU(t,s.fromStyles),o.onDestroy(function(){return LU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=rU(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[DV];if(jV(F,EU),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,my(B));for(var z=this.driver.query(F,TU,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,my(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?YV(this,F,$):this.processLeaveNode(F)}}return g.length=0,R.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),R}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[DV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==FV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Cy(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=uU(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}FU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[DV];if(d&&d.removedBeforeQueried)return new JF(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return KV(e,t),t}((n.get(h)||xV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=iU(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new zV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){uU(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return WV(e,OU)});var d=rU(h);return d.onDestroy(function(){l.forEach(function(e){return jV(e,OU)}),LU(u,t.toStyles)}),f.forEach(function(e){uU(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new JF(e.duration,e.delay)}}]),e}(),zV=function(){function e(t,n,r){by(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new JF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return Py(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return aU(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){uU(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function HV(e){return e&&1===e.nodeType}function GV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function $V(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(GV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[DV]=NV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return GV(e,a[s++])}),o}function ZV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var qV="$$classes";function WV(e,t){if(e.classList)e.classList.add(t);else{var n=e[qV];n||(n=e[qV]={}),n[t]=!0}}function jV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[qV];n&&delete n[t]}}function YV(e,t,n){rU(n).onDone(function(){return e.processLeaveNode(t)})}function KV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof eU?KV(r.players,t):t.push(r)}}function QV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var XV=function(){function e(t,n,r){var i=this;by(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new BV(t,n,r),this._timelineEngine=new TV(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return Py(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=tV(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new PV(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=iy(cU(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=iy(cU(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function JV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=tB(t[0]),t.length>1&&(r=tB(t[t.length-1]))):t&&(n=tB(t)),n||r?new eB(e,n,r):null}var eB=function(){var e=function(){function e(t,n,r){by(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return Py(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&LU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(LU(this._element,this._initialStyles),this._endStyles&&(LU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(FU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(FU(this._element,this._endStyles),this._endStyles=null),LU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function tB(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];nB(i)&&((t=t||{})[i]=e[i])}return t}function nB(e){return"display"===e||"position"===e}var rB="animation",iB="animationend",aB=function(){function e(t,n,r,i,a,o,s){var u=this;by(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return Py(e,[{key:"apply",value:function(){(function(e,t){var n=fB(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),lB(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),cB(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){oB(this._element,this._name,"paused")}},{key:"resume",value:function(){oB(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=sB(this._element,this._name);this._position=e*this._duration,lB(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),cB(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=fB(e,"").split(","),r=uB(n,t);r>=0&&(n.splice(r,1),lB(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function oB(e,t,n){lB(e,"PlayState",n,sB(e,t))}function sB(e,t){var n=fB(e,"");return n.indexOf(",")>0?uB(n.split(","),t):uB([n],t)}function uB(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function cB(e,t,n){n?e.removeEventListener(iB,t):e.addEventListener(iB,t)}function lB(e,t,n,r){var i=rB+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function fB(e,t){return e.style[rB+t]||""}var hB=function(){function e(t,n,r,i,a,o,s,u){by(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return Py(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new aB(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:YU(e.element,r))})}this.currentSnapshot=t}}]),e}(),dB=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=CU(r),i}return Py(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),cy(yy(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),cy(yy(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,cy(yy(n.prototype),"destroy",this).call(this))}}]),n}(JF),vB=function(){function e(){by(this,e),this._count=0}return Py(e,[{key:"validateStyleProperty",value:function(e){return gU(e)}},{key:"matchesElement",value:function(e,t){return yU(e,t)}},{key:"containsElement",value:function(e,t){return mU(e,t)}},{key:"query",value:function(e,t,n){return kU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return CU(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof hB}),s={};qU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=WU(e,t,s));if(0==n)return new dB(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=JV(e,t),h=new hB(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),pB=function(){function e(t,n,r,i){by(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return Py(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:YU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),gB=function(){function e(){by(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(yB().toString()),this._cssKeyframesDriver=new vB}return Py(e,[{key:"validateStyleProperty",value:function(e){return gU(e)}},{key:"matchesElement",value:function(e,t){return yU(e,t)}},{key:"containsElement",value:function(e,t){return mU(e,t)}},{key:"query",value:function(e,t,n){return kU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof pB});qU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=JV(e,t=WU(e,t=t.map(function(e){return RU(e,!1)}),u));return new pB(e,t,s,l)}}]),e}();function yB(){return tU()&&Element.prototype.animate||{}}var mB=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:ok.None,styles:[],data:{animation:[]}}),i}return Py(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?KF(e):e;return wB(this._renderer,null,t,"register",[n]),new kB(t,this._renderer)}}]),n}(jF);return e.\u0275fac=function(t){return new(t||e)(Ww(HO),Ww(sA))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),kB=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return Py(n,[{key:"create",value:function(e,t){return new CB(this._id,e,t||{},this._renderer)}}]),n}(function(){return Py(function e(){by(this,e)})}()),CB=function(){function e(t,n,r,i){by(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return Py(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wB(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function wB(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var _B="@.disabled",bB=function(){var e=function(){function e(t,n,r){by(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return Py(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new EB("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new PB(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=iy(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(HO),Ww(XV),Ww(AI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),EB=function(){function e(t,n,r){by(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return Py(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==_B?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),PB=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return Py(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==_B?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=iy(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(EB),SB=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){return by(this,n),t.call(this,e.body,r,i)}return Py(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(XV);return e.\u0275fac=function(t){return new(t||e)(Ww(sA),Ww(_U),Ww(mV))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac}),e}(),OB=new Ow("AnimationModuleType"),TB=[{provide:jF,useClass:mB},{provide:mV,useFactory:function(){return new kV}},{provide:XV,useClass:SB},{provide:HO,useFactory:function(e,t,n){return new bB(e,t,n)},deps:[BM,XV,AI]}],IB=[{provide:_U,useFactory:function(){return"function"==typeof yB()?new gB:new vB}},{provide:OB,useValue:"BrowserAnimations"}].concat(TB),AB=[{provide:_U,useClass:wU},{provide:OB,useValue:"NoopAnimations"}].concat(TB),MB=function(){var e=function(){function e(){by(this,e)}return Py(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?AB:IB}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:IB,imports:[tx]}),e}(),xB=oy(9575),RB=oy.n(xB);function NB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function DB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){NB(a,r,i,o,s,"next",e)}function s(e){NB(a,r,i,o,s,"throw",e)}o(void 0)})}}var LB=function(){function e(){by(this,e)}return Py(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Cy(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function FB(e,t){e&&console.log(t)}function UB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===UB(n[o],r[o]))return!1}return!0}return e===t}function VB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===VB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function BB(e,t){if(VB(e)&&VB(t))return UB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var zB=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&BB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),HB=function(){function e(){by(this,e)}return Py(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&BB(this.get(),e.get())}}],[{key:"success",value:function(e){return new GB(e)}},{key:"failure",value:function(e){return new $B(e)}}]),e}(),GB=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).value=e,r}return Py(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return zB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(HB),$B=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).reason=e,r}return Py(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return zB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(HB),ZB=function(){function e(t){by(this,e),this.reason=t}return Py(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?HB.success(e):HB.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return HB.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();ZB.SUCCESS=new ZB(null);var qB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},WB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(qB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},jB=function(e){return function(e){var t=qB(e);return WB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},YB=function(){function e(){var t=this;by(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return Py(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function KB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function QB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(KB())}function XB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function JB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ez(){var e=KB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function tz(){return"object"==typeof indexedDB}function nz(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function rz(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var iz=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(py(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(py(a),az.prototype.create),a}return Py(n)}(sy(Error)),az=function(){function e(t,n,r){by(this,e),this.service=t,this.serviceName=n,this.errors=r}return Py(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(oz,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new iz(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),oz=/\{\$([^}]+)}/g;function sz(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(uz(s)&&uz(u)){if(!sz(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function uz(e){return null!==e&&"object"==typeof e}function cz(e){for(var t=[],n=function(){var e=iy(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function lz(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=iy(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function fz(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var hz=function(){function e(t,n){var r=this;by(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return Py(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=dz),void 0===r.error&&(r.error=dz),void 0===r.complete&&(r.complete=dz);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function dz(){}function vz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function pz(e){return e&&e._delegate?e._delegate:e}var gz,yz,mz=function(){function e(t,n,r){by(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return Py(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),kz="[DEFAULT]",Cz=function(){function e(t,n){by(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return Py(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new YB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:kz})}catch(u){}var t,n=Cy(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=iy(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kz;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(my(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),my(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kz;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kz;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Cy(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=iy(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===kz?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kz;return this.component?this.component.multipleInstances?e:kz:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),wz=function(){function e(t){by(this,e),this.name=t,this.providers=new Map}return Py(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Cz(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),_z=[],bz=function(){return(e=bz||(bz={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",bz;var e}(),Ez={debug:bz.DEBUG,verbose:bz.VERBOSE,info:bz.INFO,warn:bz.WARN,error:bz.ERROR,silent:bz.SILENT},Pz=bz.INFO,Sz=(ry(ly={},bz.DEBUG,"log"),ry(ly,bz.VERBOSE,"log"),ry(ly,bz.INFO,"info"),ry(ly,bz.WARN,"warn"),ry(ly,bz.ERROR,"error"),ly),Oz=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=Sz[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},Tz=function(){function e(t){by(this,e),this.name=t,this._logLevel=Pz,this._logHandler=Oz,this._userLogHandler=null,_z.push(this)}return Py(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in bz))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?Ez[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,bz.DEBUG].concat(t)),this._logHandler.apply(this,[this,bz.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,bz.VERBOSE].concat(t)),this._logHandler.apply(this,[this,bz.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,bz.INFO].concat(t)),this._logHandler.apply(this,[this,bz.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,bz.WARN].concat(t)),this._logHandler.apply(this,[this,bz.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,bz.ERROR].concat(t)),this._logHandler.apply(this,[this,bz.ERROR].concat(t))}}]),e}(),Iz=new WeakMap,Az=new WeakMap,Mz=new WeakMap,xz=new WeakMap,Rz=new WeakMap,Nz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Az.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Mz.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dz(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Dz(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Dz(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&Iz.set(t,e)}).catch(function(){}),Rz.set(t,e),t}(e);if(xz.has(e))return xz.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yz||(yz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Lz(this),n),Dz(Iz.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Dz(e.apply(Lz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Lz(this),t].concat(r));return Mz.set(a,t.sort?t.sort():[t]),Dz(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!Az.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});Az.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,gz||(gz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Nz):e)}(e);return t!==e&&(xz.set(e,t),Rz.set(t,e)),t}var Lz=function(e){return Rz.get(e)};function Fz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Dz(s);return i&&s.addEventListener("upgradeneeded",function(e){i(Dz(s.result),e.oldVersion,e.newVersion,Dz(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function Uz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),Dz(r).then(function(){})}var Vz,Bz=["get","getKey","getAll","getAllKeys","count"],zz=["put","add","delete","clear"],Hz=new Map;function Gz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(Hz.get(t))return Hz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=zz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Bz.includes(n))){var a,o=(a=DB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return Hz.set(t,o),o}}}Nz=ny(ny({},Vz=Nz),{},{get:function(e,t,n){return Gz(e,t)||Vz.get(e,t,n)},has:function(e,t){return!!Gz(e,t)||Vz.has(e,t)}});var $z=function(){function e(t){by(this,e),this.container=t}return Py(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),Zz="@firebase/app",qz=new Tz("@firebase/app"),Wz="[DEFAULT]",jz=(ry(hy={},Zz,"fire-core"),ry(hy,"@firebase/app-compat","fire-core-compat"),ry(hy,"@firebase/analytics","fire-analytics"),ry(hy,"@firebase/analytics-compat","fire-analytics-compat"),ry(hy,"@firebase/app-check","fire-app-check"),ry(hy,"@firebase/app-check-compat","fire-app-check-compat"),ry(hy,"@firebase/auth","fire-auth"),ry(hy,"@firebase/auth-compat","fire-auth-compat"),ry(hy,"@firebase/database","fire-rtdb"),ry(hy,"@firebase/database-compat","fire-rtdb-compat"),ry(hy,"@firebase/functions","fire-fn"),ry(hy,"@firebase/functions-compat","fire-fn-compat"),ry(hy,"@firebase/installations","fire-iid"),ry(hy,"@firebase/installations-compat","fire-iid-compat"),ry(hy,"@firebase/messaging","fire-fcm"),ry(hy,"@firebase/messaging-compat","fire-fcm-compat"),ry(hy,"@firebase/performance","fire-perf"),ry(hy,"@firebase/performance-compat","fire-perf-compat"),ry(hy,"@firebase/remote-config","fire-rc"),ry(hy,"@firebase/remote-config-compat","fire-rc-compat"),ry(hy,"@firebase/storage","fire-gcs"),ry(hy,"@firebase/storage-compat","fire-gcs-compat"),ry(hy,"@firebase/firestore","fire-fst"),ry(hy,"@firebase/firestore-compat","fire-fst-compat"),ry(hy,"fire-js","fire-js"),ry(hy,"firebase","fire-js-all"),hy),Yz=new Map,Kz=new Map;function Qz(e,t){try{e.container.addComponent(t)}catch(n){qz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Xz(e){var t=e.name;if(Kz.has(t))return qz.debug("There were multiple attempts to register component ".concat(t,".")),!1;Kz.set(t,e);var n,r=Cy(Yz.values());try{for(r.s();!(n=r.n()).done;){Qz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function Jz(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var eH=new az("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),tH=function(){function e(t,n,r){var i=this;by(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mz("app",function(){return i},"PUBLIC"))}return Py(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw eH.create("app-deleted",{appName:this._name})}}]),e}(),nH="9.9.0";function rH(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wz,t=Yz.get(e);if(!t)throw eH.create("no-app",{appName:e});return t}function iH(){return Array.from(Yz.values())}function aH(e,t,n){var r,i=null!==(r=jz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void qz.warn(s.join(" "))}Xz(new mz("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var oH="firebase-heartbeat-store",sH=null;function uH(){return sH||(sH=Fz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(oH)}}).catch(function(e){throw eH.create("storage-open",{originalErrorMessage:e.message})})),sH}function cH(){return cH=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,uH();case 3:return e.abrupt("return",e.sent.transaction(oH).objectStore(oH).get(hH(t)));case 6:throw e.prev=6,e.t0=e.catch(0),eH.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),cH.apply(this,arguments)}function lH(e,t){return fH.apply(this,arguments)}function fH(){return fH=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,uH();case 3:return i=e.sent.transaction(oH,"readwrite"),e.next=6,i.objectStore(oH).put(n,hH(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),eH.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),fH.apply(this,arguments)}function hH(e){return"".concat(e.name,"!").concat(e.options.appId)}var dH=function(){function e(t){var n=this;by(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new pH(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return Py(e,[{key:"triggerHeartbeat",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=vH(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=vH(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=Cy(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),gH(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),gH(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=jB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function vH(){return(new Date).toISOString().substring(0,10)}var pH=function(){function e(t){by(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return Py(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!tz()&&nz().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return cH.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",lH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",lH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(my(i.heartbeats),my(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function gH(e){return jB(JSON.stringify({version:2,heartbeats:e})).length}Xz(new mz("platform-logger",function(e){return new $z(e)},"PRIVATE")),Xz(new mz("heartbeat",function(e){return new dH(e)},"PRIVATE")),aH(Zz,"0.7.28",""),aH(Zz,"0.7.28","esm2017"),aH("fire-js","");var yH,mH="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},kH={},CH=CH||{},wH=mH||self;function _H(){}function bH(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function EH(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var PH="closure_uid_"+(1e9*Math.random()>>>0),SH=0;function OH(e,t,n){return e.call.apply(e.bind,arguments)}function TH(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function IH(e,t,n){return(IH=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?OH:TH).apply(null,arguments)}function AH(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function MH(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function xH(){this.s=this.s,this.o=this.o}var RH={};xH.prototype.s=!1,xH.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,PH)&&e[PH]||(e[PH]=++SH)}(this);delete RH[e]}},xH.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var NH=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},DH=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function LH(e){return Array.prototype.concat.apply([],arguments)}function FH(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function UH(e){return/^[\s\xa0]*$/.test(e)}var VH,BH=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function zH(e,t){return-1!=e.indexOf(t)}function HH(e,t){return e<t?-1:e>t?1:0}e:{var GH=wH.navigator;if(GH){var $H=GH.userAgent;if($H){VH=$H;break e}}VH=""}function ZH(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function qH(e){var t={};for(var n in e)t[n]=e[n];return t}var WH="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jH(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<WH.length;a++)n=WH[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function YH(e){return YH[" "](e),e}YH[" "]=_H;var KH,QH=zH(VH,"Opera"),XH=zH(VH,"Trident")||zH(VH,"MSIE"),JH=zH(VH,"Edge"),eG=JH||XH,tG=zH(VH,"Gecko")&&!(zH(VH.toLowerCase(),"webkit")&&!zH(VH,"Edge"))&&!(zH(VH,"Trident")||zH(VH,"MSIE"))&&!zH(VH,"Edge"),nG=zH(VH.toLowerCase(),"webkit")&&!zH(VH,"Edge");function rG(){var e=wH.document;return e?e.documentMode:void 0}e:{var iG="",aG=function(){var e=VH;return tG?/rv:([^\);]+)(\)|;)/.exec(e):JH?/Edge\/([\d\.]+)/.exec(e):XH?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):nG?/WebKit\/(\S+)/.exec(e):QH?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(aG&&(iG=aG?aG[1]:""),XH){var oG=rG();if(null!=oG&&oG>parseFloat(iG)){KH=String(oG);break e}}KH=iG}var sG={};var uG=wH.document&&XH&&(rG()||parseInt(KH,10))||void 0,cG=function(){if(!wH.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{wH.addEventListener("test",_H,t),wH.removeEventListener("test",_H,t)}catch(n){}return e}();function lG(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function fG(e,t){if(lG.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(tG){e:{try{YH(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:hG[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&fG.Z.h.call(this)}}lG.prototype.h=function(){this.defaultPrevented=!0},MH(fG,lG);var hG={2:"touch",3:"pen",4:"mouse"};fG.prototype.h=function(){fG.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var dG="closure_listenable_"+(1e6*Math.random()|0),vG=0;function pG(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++vG,this.ca=this.fa=!1}function gG(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function yG(e){this.src=e,this.g={},this.h=0}function mG(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=NH(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(gG(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function kG(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}yG.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=kG(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new pG(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var CG="closure_lm_"+(1e6*Math.random()|0),wG={};function _G(e,t,n,r,i){if(r&&r.once)return EG(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)_G(e,t[a],n,r,i);return null}return n=MG(n),e&&e[dG]?e.N(t,n,EH(r)?!!r.capture:!!r,i):bG(e,t,n,!1,r,i)}function bG(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=EH(i)?!!i.capture:!!i,s=IG(e);if(s||(e[CG]=s=new yG(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=TG;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)cG||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(OG(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function EG(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)EG(e,t[a],n,r,i);return null}return n=MG(n),e&&e[dG]?e.O(t,n,EH(r)?!!r.capture:!!r,i):bG(e,t,n,!0,r,i)}function PG(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)PG(e,t[a],n,r,i);else r=EH(r)?!!r.capture:!!r,n=MG(n),e&&e[dG]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=kG(a=e.g[t],n,r,i))&&(gG(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=IG(e))&&(t=e.g[t.toString()],e=-1,t&&(e=kG(t,n,r,i)),(n=-1<e?t[e]:null)&&SG(n))}function SG(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[dG])mG(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(OG(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=IG(t))?(mG(n,e),0==n.h&&(n.src=null,t[CG]=null)):gG(e)}}}function OG(e){return e in wG?wG[e]:wG[e]="on"+e}function TG(e,t){if(e.ca)e=!0;else{t=new fG(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&SG(e),e=n.call(r,t)}return e}function IG(e){return(e=e[CG])instanceof yG?e:null}var AG="__closure_events_fn_"+(1e9*Math.random()>>>0);function MG(e){return"function"==typeof e?e:(e[AG]||(e[AG]=function(t){return e.handleEvent(t)}),e[AG])}function xG(){xH.call(this),this.i=new yG(this),this.P=this,this.I=null}function RG(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new lG(t,e);else if(t instanceof lG)t.target=t.target||e;else{var i=t;jH(t=new lG(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=NG(o,r,!0,t)&&i}if(i=NG(o=t.g=e,r,!0,t)&&i,i=NG(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=NG(o=t.g=n[a],r,!1,t)&&i}function NG(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&mG(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}MH(xG,xH),xG.prototype[dG]=!0,xG.prototype.removeEventListener=function(e,t,n,r){PG(this,e,t,n,r)},xG.prototype.M=function(){if(xG.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)gG(n[r]);delete t.g[e],t.h--}}this.I=null},xG.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},xG.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var DG=wH.JSON.stringify;function LG(){var e=GG,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var FG,UG=new(function(){function e(t,n){by(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return Py(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new VG},function(e){return e.reset()}),VG=function(){function e(){by(this,e),this.next=this.g=this.h=null}return Py(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function BG(e){wH.setTimeout(function(){throw e},0)}function zG(e,t){FG||function(){var e=wH.Promise.resolve(void 0);FG=function(){e.then($G)}}(),HG||(FG(),HG=!0),GG.add(e,t)}var HG=!1,GG=new(function(){function e(){by(this,e),this.h=this.g=null}return Py(e,[{key:"add",value:function(e,t){var n=UG.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function $G(){for(var e;e=LG();){try{e.h.call(e.g)}catch(n){BG(n)}var t=UG;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}HG=!1}function ZG(e,t){xG.call(this),this.h=e||1,this.g=t||wH,this.j=IH(this.kb,this),this.l=Date.now()}function qG(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function WG(e,t,n){if("function"==typeof e)n&&(e=IH(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=IH(e.handleEvent,e)}return 2147483647<Number(t)?-1:wH.setTimeout(e,t||0)}function jG(e){e.g=WG(function(){e.g=null,e.i&&(e.i=!1,jG(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}MH(ZG,xG),(yH=ZG.prototype).da=!1,yH.S=null,yH.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),RG(this,"tick"),this.da&&(qG(this),this.start()))}},yH.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},yH.M=function(){ZG.Z.M.call(this),qG(this),delete this.g};var YG=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return Py(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:jG(this)}},{key:"M",value:function(){cy(yy(n.prototype),"M",this).call(this),this.g&&(wH.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(xH);function KG(e){xH.call(this),this.h=e,this.g={}}MH(KG,xH);var QG=[];function XG(e,t,n,r){Array.isArray(n)||(n&&(QG[0]=n.toString()),n=QG);for(var i=0;i<n.length;i++){var a=_G(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function JG(e){ZH(e.g,function(e,t){this.g.hasOwnProperty(t)&&SG(e)},e),e.g={}}function e$(){this.g=!0}function t$(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return DG(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}KG.prototype.M=function(){KG.Z.M.call(this),JG(this)},KG.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},e$.prototype.Aa=function(){this.g=!1},e$.prototype.info=function(){};var n$={},r$=null;function i$(){return r$=r$||new xG}function a$(e){lG.call(this,n$.Ma,e)}function o$(e){var t=i$();RG(t,new a$(t,e))}function s$(e,t){lG.call(this,n$.STAT_EVENT,e),this.stat=t}function u$(e){var t=i$();RG(t,new s$(t,e))}function c$(e,t){lG.call(this,n$.Na,e),this.size=t}function l$(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return wH.setTimeout(function(){e()},t)}n$.Ma="serverreachability",MH(a$,lG),n$.STAT_EVENT="statevent",MH(s$,lG),n$.Na="timingevent",MH(c$,lG);var f$={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},h$={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function d$(){}function v$(){}d$.prototype.h=null;var p$,g$={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function y$(){lG.call(this,"d")}function m$(){lG.call(this,"c")}function k$(){}function C$(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new KG(this),this.P=_$,this.W=new ZG(e=eG?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new w$}function w$(){this.i=null,this.g="",this.h=!1}MH(y$,lG),MH(m$,lG),MH(k$,d$),k$.prototype.g=function(){return new XMLHttpRequest},k$.prototype.i=function(){return{}},p$=new k$;var _$=45e3,b$={},E$={};function P$(e,t,n){e.K=1,e.v=j$(H$(t)),e.s=n,e.U=!0,S$(e,null)}function S$(e,t){e.F=Date.now(),A$(e),e.A=H$(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),sZ(n.h,"t",r),e.C=0,n=e.l.H,e.h=new w$,e.g=sq(e.l,n?t:null,!e.s),0<e.O&&(e.L=new YG(IH(e.Ia,e,e.g),e.O)),XG(e.V,e.g,"readystatechange",e.gb),t=e.H?qH(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),o$(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function O$(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function T$(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=I$(e,n))==E$){4==t&&(e.o=4,u$(14),i=!1),t$(e.j,e.m,null,"[Incomplete Response]");break}if(r==b$){e.o=4,u$(15),t$(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}t$(e.j,e.m,r,null),D$(e,r)}O$(e)&&r!=E$&&r!=b$&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,u$(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),JZ(t),t.L=!0,u$(11))):(t$(e.j,e.m,n,"[Invalid Chunked Response]"),N$(e),R$(e))}function I$(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?E$:(n=Number(t.substring(n,r)),isNaN(n)?b$:(r+=1)+n>t.length?E$:(t=t.substr(r,n),e.C=r+n,t))}function A$(e){e.Y=Date.now()+e.P,M$(e,e.P)}function M$(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=l$(IH(e.eb,e),t)}function x$(e){e.B&&(wH.clearTimeout(e.B),e.B=null)}function R$(e){0==e.l.G||e.I||nq(e.l,e)}function N$(e){x$(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,qG(e.W),JG(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function D$(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||dZ(n.i,e)))if(n.I=e.N,!e.J&&dZ(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=l$(IH(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;tq(n),$Z(n)}XZ(n),u$(18)}if(1>=hZ(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else iq(n,11)}else if((e.J||n.g==e)&&tq(n),!UH(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(zH(l,"spdy")||zH(l,"quic")||zH(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(vZ(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,W$(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=oq(r,r.H?r.la:null,r.W),d.J){pZ(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(x$(v),A$(v)),r.g=d}else QZ(r);0<n.l.length&&WZ(n)}else"stop"!=a[0]&&"close"!=a[0]||iq(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?iq(n,7):GZ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}o$(4)}catch(m){}}function L$(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(bH(e)||"string"==typeof e)DH(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(bH(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(bH(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function F$(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof F$)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function U$(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];V$(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)V$(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function V$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(yH=C$.prototype).setTimeout=function(e){this.P=e},yH.gb=function(e){e=e.target;var t=this.L;t&&3==UZ(e)?t.l():this.Ia(e)},yH.Ia=function(e){try{if(e==this.g)e:{var t=UZ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||eG||this.g&&(this.h.h||this.g.ga()||VZ(this.g)))){this.I||4!=t||7==n||o$(8==n||0>=r?3:2),x$(this);var i=this.g.ba();this.N=i;t:if(O$(this)){var a=VZ(this.g);e="";var o=a.length,s=4==UZ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){N$(this),R$(this);var u="";break t}this.h.i=new wH.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!UH(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,u$(12),N$(this),R$(this);break e}t$(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,D$(this,i)}this.U?(T$(this,t,u),eG&&this.i&&3==t&&(XG(this.V,this.W,"tick",this.fb),this.W.start())):(t$(this.j,this.m,u,null),D$(this,u)),4==t&&N$(this),this.i&&!this.I&&(4==t?nq(this.l,this):(this.i=!1,A$(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,u$(12)):(this.o=0,u$(13)),N$(this),R$(this)}}}catch(h){}},yH.fb=function(){if(this.g){var e=UZ(this.g),t=this.g.ga();this.C<t.length&&(x$(this),T$(this,e,t),this.i&&4!=e&&A$(this))}},yH.cancel=function(){this.I=!0,N$(this)},yH.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(o$(3),u$(17)),N$(this),this.o=2,R$(this)):M$(this,this.Y-e)},(yH=F$.prototype).R=function(){U$(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},yH.T=function(){return U$(this),this.g.concat()},yH.get=function(e,t){return V$(this.h,e)?this.h[e]:t},yH.set=function(e,t){V$(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},yH.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var B$=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function z$(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof z$){this.g=void 0!==t?t:e.g,G$(this,e.j),this.s=e.s,$$(this,e.i),Z$(this,e.m),this.l=e.l,t=e.h;var n=new rZ;n.i=t.i,t.g&&(n.g=new F$(t.g),n.h=t.h),q$(this,n),this.o=e.o}else e&&(n=String(e).match(B$))?(this.g=!!t,G$(this,n[1]||"",!0),this.s=Y$(n[2]||""),$$(this,n[3]||"",!0),Z$(this,n[4]),this.l=Y$(n[5]||"",!0),q$(this,n[6]||"",!0),this.o=Y$(n[7]||"")):(this.g=!!t,this.h=new rZ(null,this.g))}function H$(e){return new z$(e)}function G$(e,t,n){e.j=n?Y$(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function $$(e,t,n){e.i=n?Y$(t,!0):t}function Z$(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function q$(e,t,n){t instanceof rZ?(e.h=t,function(e,t){t&&!e.j&&(iZ(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(aZ(this,t),sZ(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=K$(t,tZ)),e.h=new rZ(t,e.g))}function W$(e,t,n){e.h.set(t,n)}function j$(e){return W$(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Y$(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function K$(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Q$),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Q$(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}z$.prototype.toString=function(){var e=[],t=this.j;t&&e.push(K$(t,X$,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(K$(t,X$,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(K$(n,"/"==n.charAt(0)?eZ:J$,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",K$(n,nZ)),e.join("")};var X$=/[#\/\?@]/g,J$=/[#\?:]/g,eZ=/[#\?]/g,tZ=/[#\?@]/g,nZ=/#/g;function rZ(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function iZ(e){e.g||(e.g=new F$,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function aZ(e,t){iZ(e),t=uZ(e,t),V$(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,V$((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&U$(e)))}function oZ(e,t){return iZ(e),t=uZ(e,t),V$(e.g.h,t)}function sZ(e,t,n){aZ(e,t),0<n.length&&(e.i=null,e.g.set(uZ(e,t),FH(n)),e.h+=n.length)}function uZ(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function cZ(e){this.l=e||lZ,e=wH.PerformanceNavigationTiming?0<(e=wH.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(wH.g&&wH.g.Ea&&wH.g.Ea()&&wH.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(yH=rZ.prototype).add=function(e,t){iZ(this),this.i=null,e=uZ(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},yH.forEach=function(e,t){iZ(this),this.g.forEach(function(n,r){DH(n,function(n){e.call(t,n,r,this)},this)},this)},yH.T=function(){iZ(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},yH.R=function(e){iZ(this);var t=[];if("string"==typeof e)oZ(this,e)&&(t=LH(t,this.g.get(uZ(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=LH(t,e[n])}return t},yH.set=function(e,t){return iZ(this),this.i=null,oZ(this,e=uZ(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},yH.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},yH.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var lZ=10;function fZ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function hZ(e){return e.h?1:e.g?e.g.size:0}function dZ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function vZ(e,t){e.g?e.g.add(t):e.h=t}function pZ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function gZ(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Cy(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return FH(e.i)}function yZ(){}function mZ(){this.g=new yZ}function kZ(e,t,n){var r=n||"";try{L$(e,function(e,n){var i=e;EH(e)&&(i=DG(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function CZ(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function wZ(e){this.l=e.$b||null,this.j=e.ib||!1}function _Z(e,t){xG.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=bZ,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}cZ.prototype.cancel=function(){if(this.i=gZ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Cy(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},yZ.prototype.stringify=function(e){return wH.JSON.stringify(e,void 0)},yZ.prototype.parse=function(e){return wH.JSON.parse(e,void 0)},MH(wZ,d$),wZ.prototype.g=function(){return new _Z(this.l,this.j)},wZ.prototype.i=function(e){return function(){return e}}({}),MH(_Z,xG);var bZ=0;function EZ(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function PZ(e){e.readyState=4,e.l=null,e.j=null,e.A=null,SZ(e)}function SZ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(yH=_Z.prototype).open=function(e,t){if(this.readyState!=bZ)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,SZ(this)},yH.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||wH).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},yH.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,PZ(this)),this.readyState=bZ},yH.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,SZ(this)),this.g&&(this.readyState=3,SZ(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==wH.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;EZ(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},yH.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?PZ(this):SZ(this),3==this.readyState&&EZ(this)}},yH.Ua=function(e){this.g&&(this.response=this.responseText=e,PZ(this))},yH.Ta=function(e){this.g&&(this.response=e,PZ(this))},yH.ha=function(){this.g&&PZ(this)},yH.setRequestHeader=function(e,t){this.v.append(e,t)},yH.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},yH.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(_Z.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var OZ=wH.JSON.parse;function TZ(e){xG.call(this),this.headers=new F$,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=IZ,this.K=this.L=!1}MH(TZ,xG);var IZ="",AZ=/^https?$/i,MZ=["POST","PUT"];function xZ(e){return"content-type"==e.toLowerCase()}function RZ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,NZ(e),LZ(e)}function NZ(e){e.D||(e.D=!0,RG(e,"complete"),RG(e,"error"))}function DZ(e){if(e.h&&void 0!==CH&&(!e.C[1]||4!=UZ(e)||2!=e.ba()))if(e.v&&4==UZ(e))WG(e.Fa,0,e);else if(RG(e,"readystatechange"),4==UZ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(B$)[1]||null;if(!a&&wH.self&&wH.self.location){var o=wH.self.location.protocol;a=o.substr(0,o.length-1)}i=!AZ.test(a?a.toLowerCase():"")}t=i}if(t)RG(e,"complete"),RG(e,"success");else{e.m=6;try{var s=2<UZ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",NZ(e)}}finally{LZ(e)}}}function LZ(e,t){if(e.g){FZ(e);var n=e.g,r=e.C[0]?_H:null;e.g=null,e.C=null,t||RG(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function FZ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(wH.clearTimeout(e.A),e.A=null)}function UZ(e){return e.g?e.g.readyState:0}function VZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case IZ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function BZ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return ZH(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):W$(e,t,n))}function zZ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function HZ(e){this.za=0,this.l=[],this.h=new e$,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=zZ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=zZ("baseRetryDelayMs",5e3,e),this.$a=zZ("retryDelaySeedMs",1e4,e),this.Ya=zZ("forwardChannelMaxRetries",2,e),this.ra=zZ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new cZ(e&&e.concurrentRequestLimit),this.Ca=new mZ,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function GZ(e){if(ZZ(e),3==e.G){var t=e.V++,n=H$(e.F);W$(n,"SID",e.J),W$(n,"RID",t),W$(n,"TYPE","terminate"),YZ(e,n),(t=new C$(e,e.h,t,void 0)).K=2,t.v=j$(H$(n)),n=!1,wH.navigator&&wH.navigator.sendBeacon&&(n=wH.navigator.sendBeacon(t.v.toString(),"")),!n&&wH.Image&&((new Image).src=t.v,n=!0),n||(t.g=sq(t.l,null),t.g.ea(t.v)),t.F=Date.now(),A$(t)}aq(e)}function $Z(e){e.g&&(JZ(e),e.g.cancel(),e.g=null)}function ZZ(e){$Z(e),e.u&&(wH.clearTimeout(e.u),e.u=null),tq(e),e.i.cancel(),e.m&&("number"==typeof e.m&&wH.clearTimeout(e.m),e.m=null)}function qZ(e,t){e.l.push(new(function(){return Py(function e(t,n){by(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&WZ(e)}function WZ(e){fZ(e.i)||e.m||(e.m=!0,zG(e.Ha,e),e.C=0)}function jZ(e,t){var n;n=t?t.m:e.V++;var r=H$(e.F);W$(r,"SID",e.J),W$(r,"RID",n),W$(r,"AID",e.U),YZ(e,r),e.o&&e.s&&BZ(r,e.o,e.s),n=new C$(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=KZ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),vZ(e.i,n),P$(n,r,t)}function YZ(e,t){e.j&&L$({},function(e,n){W$(t,n,e)})}function KZ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?IH(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{kZ(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function QZ(e){e.g||e.u||(e.Y=1,zG(e.Ga,e),e.A=0)}function XZ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=l$(IH(e.Ga,e),rq(e,e.A)),e.A++,0))}function JZ(e){null!=e.B&&(wH.clearTimeout(e.B),e.B=null)}function eq(e){e.g=new C$(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=H$(e.oa);W$(t,"RID","rpc"),W$(t,"SID",e.J),W$(t,"CI",e.N?"0":"1"),W$(t,"AID",e.U),YZ(e,t),W$(t,"TYPE","xmlhttp"),e.o&&e.s&&BZ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=j$(H$(t)),n.s=null,n.U=!0,S$(n,e)}function tq(e){null!=e.v&&(wH.clearTimeout(e.v),e.v=null)}function nq(e,t){var n=null;if(e.g==t){tq(e),JZ(e),e.g=null;var r=2}else{if(!dZ(e.i,t))return;n=t.D,pZ(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;RG(r=i$(),new c$(r,n,t,i)),WZ(e)}else QZ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(hZ(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=l$(IH(e.Ha,e,t),rq(e,e.C)),e.C++,0)))}(e,t)||2==r&&XZ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:iq(e,5);break;case 4:iq(e,10);break;case 3:iq(e,6);break;default:iq(e,2)}}function rq(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function iq(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=IH(e.jb,e);n||(n=new z$("//www.google.com/images/cleardot.gif"),wH.location&&"http"==wH.location.protocol||G$(n,"https"),j$(n)),function(e,t){var n=new e$;if(wH.Image){var r=new Image;r.onload=AH(CZ,n,r,"TestLoadImage: loaded",!0,t),r.onerror=AH(CZ,n,r,"TestLoadImage: error",!1,t),r.onabort=AH(CZ,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=AH(CZ,n,r,"TestLoadImage: timeout",!1,t),wH.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else u$(2);e.G=0,e.j&&e.j.va(t),aq(e),ZZ(e)}function aq(e){e.G=0,e.I=-1,e.j&&((0!=gZ(e.i).length||0!=e.l.length)&&(e.i.i.length=0,FH(e.l),e.l.length=0),e.j.ua())}function oq(e,t,n){var r=function(e){return e instanceof z$?H$(e):new z$(e,void 0)}(n);if(""!=r.i)t&&$$(r,t+"."+r.i),Z$(r,r.m);else{var i=wH.location;r=function(e,t,n,r){var i=new z$(null,void 0);return e&&G$(i,e),t&&$$(i,t),n&&Z$(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&ZH(e.aa,function(e,t){W$(r,t,e)}),n=e.sa,(t=e.D)&&n&&W$(r,t,n),W$(r,"VER",e.ma),YZ(e,r),r}function sq(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new TZ(n&&e.Ba&&!e.qa?new wZ({ib:!0}):e.qa)).L=e.H,t}function uq(){}function cq(){if(XH&&!(10<=Number(uG)))throw Error("Environmental error: no available transport.")}function lq(e,t){xG.call(this),this.g=new HZ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!UH(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!UH(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new dq(this)}function fq(e){y$.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hq(){m$.call(this),this.status=1}function dq(e){this.g=e}(yH=TZ.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():p$.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:p$),this.g.onreadystatechange=IH(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void RZ(this,a)}e=n||"";var i=new F$(this.headers);r&&L$(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=xZ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=wH.FormData&&e instanceof wH.FormData,!(0<=NH(MZ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{FZ(this),0<this.B&&((this.K=function(e){return XH&&function(){return e=sG,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=BH(String(KH)).split("."),n=BH("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=HH(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||HH(0==a[2].length,0==o[2].length)||HH(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=IH(this.pa,this)):this.A=WG(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){RZ(this,a)}},yH.pa=function(){void 0!==CH&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,RG(this,"timeout"),this.abort(8))},yH.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,RG(this,"complete"),RG(this,"abort"),LZ(this))},yH.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),LZ(this,!0)),TZ.Z.M.call(this)},yH.Fa=function(){this.s||(this.F||this.v||this.l?DZ(this):this.cb())},yH.cb=function(){DZ(this)},yH.ba=function(){try{return 2<UZ(this)?this.g.status:-1}catch(e){return-1}},yH.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},yH.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),OZ(t)}},yH.Da=function(){return this.m},yH.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(yH=HZ.prototype).ma=8,yH.G=1,yH.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},yH.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new C$(this,this.h,e,void 0),n=this.s;if(this.P&&(n?jH(n=qH(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=KZ(this,t,r),W$(i=H$(this.F),"RID",e),W$(i,"CVER",22),this.D&&W$(i,"X-HTTP-Session-Id",this.D),YZ(this,i),this.o&&n&&BZ(i,this.o,n),vZ(this.i,t),this.Ra&&W$(i,"TYPE","init"),this.ja?(W$(i,"$req",r),W$(i,"SID","null"),t.$=!0,P$(t,i,null)):P$(t,i,r),this.G=2}}else 3==this.G&&(e?jZ(this,e):0==this.l.length||fZ(this.i)||jZ(this))},yH.Ga=function(){if(this.u=null,eq(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=l$(IH(this.bb,this),e)}},yH.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,u$(10),$Z(this),eq(this))},yH.ab=function(){null!=this.v&&(this.v=null,$Z(this),XZ(this),u$(19))},yH.jb=function(e){e?(this.h.info("Successfully pinged google.com"),u$(2)):(this.h.info("Failed to ping google.com"),u$(1))},(yH=uq.prototype).xa=function(){},yH.wa=function(){},yH.va=function(){},yH.ua=function(){},yH.Oa=function(){},cq.prototype.g=function(e,t){return new lq(e,t)},MH(lq,xG),lq.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),zG(IH(e.hb,e,t))),u$(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=oq(e,null,e.W),WZ(e)},lq.prototype.close=function(){GZ(this.g)},lq.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,qZ(this.g,t)}else this.v?((t={}).__data__=DG(e),qZ(this.g,t)):qZ(this.g,e)},lq.prototype.M=function(){this.g.j=null,delete this.j,GZ(this.g),delete this.g,lq.Z.M.call(this)},MH(fq,y$),MH(hq,m$),MH(dq,uq),dq.prototype.xa=function(){RG(this.g,"a")},dq.prototype.wa=function(e){RG(this.g,new fq(e))},dq.prototype.va=function(e){RG(this.g,new hq(e))},dq.prototype.ua=function(){RG(this.g,"b")},cq.prototype.createWebChannel=cq.prototype.g,lq.prototype.send=lq.prototype.u,lq.prototype.open=lq.prototype.m,lq.prototype.close=lq.prototype.close,f$.NO_ERROR=0,f$.TIMEOUT=8,f$.HTTP_ERROR=6,h$.COMPLETE="complete",v$.EventType=g$,g$.OPEN="a",g$.CLOSE="b",g$.ERROR="c",g$.MESSAGE="d",xG.prototype.listen=xG.prototype.N,TZ.prototype.listenOnce=TZ.prototype.O,TZ.prototype.getLastError=TZ.prototype.La,TZ.prototype.getLastErrorCode=TZ.prototype.Da,TZ.prototype.getStatus=TZ.prototype.ba,TZ.prototype.getResponseJson=TZ.prototype.Qa,TZ.prototype.getResponseText=TZ.prototype.ga,TZ.prototype.send=TZ.prototype.ea;var vq=kH.createWebChannelTransport=function(){return new cq},pq=kH.getStatEventTarget=function(){return i$()},gq=kH.ErrorCode=f$,yq=kH.EventType=h$,mq=kH.Event=n$,kq=kH.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Cq=kH.FetchXmlHttpFactory=wZ,wq=kH.WebChannel=v$,_q=kH.XhrIo=TZ,bq="@firebase/firestore",Eq=function(){function e(t){by(this,e),this.uid=t}return Py(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Eq.UNAUTHENTICATED=new Eq(null),Eq.GOOGLE_CREDENTIALS=new Eq("google-credentials-uid"),Eq.FIRST_PARTY=new Eq("first-party-uid"),Eq.MOCK_USER=new Eq("mock-user");var Pq="9.9.0",Sq=new Tz("@firebase/firestore");function Oq(){return Sq.logLevel}function Tq(e){if(Sq.logLevel<=bz.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mq);Sq.debug.apply(Sq,["Firestore (".concat(Pq,"): ").concat(e)].concat(my(i)))}}function Iq(e){if(Sq.logLevel<=bz.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mq);Sq.error.apply(Sq,["Firestore (".concat(Pq,"): ").concat(e)].concat(my(i)))}}function Aq(e){if(Sq.logLevel<=bz.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Mq);Sq.warn.apply(Sq,["Firestore (".concat(Pq,"): ").concat(e)].concat(my(i)))}}function Mq(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Pq,") INTERNAL ASSERTION FAILED: ")+e;throw Iq(t),new Error(t)}function Rq(e,t){e||xq()}function Nq(e,t){return e}var Dq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Lq=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return Py(n)}(iz),Fq=Py(function e(){var t=this;by(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),Uq=Py(function e(t,n){by(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),Vq=function(){function e(){by(this,e)}return Py(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(Eq.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),Bq=function(){function e(t){by(this,e),this.t=t,this.currentUser=Eq.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Py(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new Fq;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new Fq,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){Tq("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(Tq("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Fq)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(Tq("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Rq("string"==typeof n.accessToken),new Uq(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Rq(null===e||"string"==typeof e),new Eq(e)}}]),e}(),zq=Py(function e(t,n,r){by(this,e),this.type="FirstParty",this.user=Eq.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),Hq=function(){function e(t,n,r){by(this,e),this.h=t,this.l=n,this.m=r}return Py(e,[{key:"getToken",value:function(){return Promise.resolve(new zq(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(Eq.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Gq=Py(function e(t){by(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),$q=function(){function e(t){by(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return Py(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&Tq("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,Tq("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){Tq("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):Tq("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(Rq("string"==typeof t.token),e.p=t.token,new Gq(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Zq(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var qq=function(){function e(){by(this,e)}return Py(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Zq(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Wq(e,t){return e<t?-1:e>t?1:0}function jq(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var Yq=function(){function e(t,n){if(by(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Lq(Dq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Lq(Dq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Lq(Dq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Lq(Dq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return Py(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Wq(this.nanoseconds,e.nanoseconds):Wq(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Kq=function(){function e(t){by(this,e),this.timestamp=t}return Py(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Yq(0,0))}},{key:"max",value:function(){return new e(new Yq(253402300799,999999999))}}]),e}(),Qq=function(){function e(t,n,r){by(this,e),void 0===n?n=0:n>t.length&&xq(),void 0===r?r=t.length-n:r>t.length-n&&xq(),this.segments=t,this.offset=n,this.len=r}return Py(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Xq=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,my(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Qq),Jq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,eW=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Jq.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Lq(Dq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Lq(Dq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new Lq(Dq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Qq),tW=function(){function e(t){by(this,e),this.path=t}return Py(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Xq.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Xq.fromString(t))}},{key:"fromName",value:function(t){return new e(Xq.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Xq.emptyPath())}},{key:"comparator",value:function(e,t){return Xq.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Xq(t.slice()))}}]),e}();function nW(e){return new rW(e.readTime,e.key,-1)}var rW=function(){function e(t,n,r){by(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return Py(e,null,[{key:"min",value:function(){return new e(Kq.min(),tW.empty(),-1)}},{key:"max",value:function(){return new e(Kq.max(),tW.empty(),-1)}}]),e}();function iW(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=tW.comparator(e.documentKey,t.documentKey))?n:Wq(e.largestBatchId,t.largestBatchId)}var aW="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function oW(e){return sW.apply(this,arguments)}function sW(){return sW=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Dq.FAILED_PRECONDITION&&t.message===aW){e.next=2;break}throw t;case 2:Tq("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),sW.apply(this,arguments)}var uW=function(){function e(t){var n=this;by(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return Py(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&xq(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Cy(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function cW(e){return"IndexedDbTransactionError"===e.name}var lW=function(){function e(t,n){var r=this;by(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return Py(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function fW(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function hW(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function dW(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}lW.ot=-1;var vW=function(){function e(t,n){by(this,e),this.comparator=t,this.root=n||gW.EMPTY}return Py(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,gW.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,gW.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new pW(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new pW(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new pW(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new pW(this.root,e,this.comparator,!0)}}]),e}(),pW=function(){function e(t,n,r,i){by(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return Py(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),gW=function(){function e(t,n,r,i,a){by(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return Py(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw xq();var e=this.left.check();if(e!==this.right.check())throw xq();return e+(this.isRed()?0:1)}}]),e}();gW.EMPTY=null,gW.RED=!0,gW.BLACK=!1,gW.EMPTY=new(function(){function e(){by(this,e),this.size=0}return Py(e,[{key:"key",get:function(){throw xq()}},{key:"value",get:function(){throw xq()}},{key:"color",get:function(){throw xq()}},{key:"left",get:function(){throw xq()}},{key:"right",get:function(){throw xq()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new gW(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var yW=function(){function e(t){by(this,e),this.comparator=t,this.data=new vW(this.comparator)}return Py(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new mW(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new mW(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),mW=function(){function e(t){by(this,e),this.iter=t}return Py(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),kW=function(){function e(t){by(this,e),this.fields=t,t.sort(eW.comparator)}return Py(e,[{key:"unionWith",value:function(t){var n,r=new yW(eW.comparator),i=Cy(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=Cy(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=Cy(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return jq(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),CW=function(e){function t(e){by(this,t),this.binaryString=e}return Py(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Wq(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();CW.EMPTY_BYTE_STRING=new CW("");var wW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _W(e){if(Rq(!!e),"string"==typeof e){var t=0,n=wW.exec(e);if(Rq(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:bW(e.seconds),nanos:bW(e.nanos)}}function bW(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function EW(e){return"string"==typeof e?CW.fromBase64String(e):CW.fromUint8Array(e)}function PW(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function SW(e){var t=e.mapValue.fields.__previous_value__;return PW(t)?SW(t):t}function OW(e){var t=_W(e.mapValue.fields.__local_write_time__.timestampValue);return new Yq(t.seconds,t.nanos)}var TW=Py(function e(t,n,r,i,a,o,s,u){by(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),IW=function(){function e(t,n){by(this,e),this.projectId=t,this.database=n||"(default)"}return Py(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function AW(e){return null==e}function MW(e){return 0===e&&1/e==-1/0}var xW={fields:{__type__:{stringValue:"__max__"}}};function RW(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?PW(e)?4:WW(e)?9007199254740991:10:xq()}function NW(e,t){if(e===t)return!0;var n,r=RW(e);if(r!==RW(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return OW(e).isEqual(OW(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=_W(e.timestampValue),r=_W(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,EW(e.bytesValue).isEqual(EW(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return bW(e.geoPointValue.latitude)===bW(t.geoPointValue.latitude)&&bW(e.geoPointValue.longitude)===bW(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return bW(e.integerValue)===bW(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=bW(e.doubleValue),r=bW(t.doubleValue);return n===r?MW(n)===MW(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return jq(e.arrayValue.values||[],t.arrayValue.values||[],NW);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(fW(n)!==fW(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!NW(n[i],r[i])))return!1;return!0}(e,t);default:return xq()}}function DW(e,t){return void 0!==(e.values||[]).find(function(e){return NW(e,t)})}function LW(e,t){if(e===t)return 0;var n,r,i,a,o=RW(e),s=RW(t);if(o!==s)return Wq(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Wq(e.booleanValue,t.booleanValue);case 2:return r=t,i=bW((n=e).integerValue||n.doubleValue),a=bW(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return FW(e.timestampValue,t.timestampValue);case 4:return FW(OW(e),OW(t));case 5:return Wq(e.stringValue,t.stringValue);case 6:return function(e,t){var n=EW(e),r=EW(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Wq(n[i],r[i]);if(0!==a)return a}return Wq(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Wq(bW(e.latitude),bW(t.latitude));return 0!==n?n:Wq(bW(e.longitude),bW(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=LW(n[i],r[i]);if(a)return a}return Wq(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===xW&&t===xW)return 0;if(e===xW)return 1;if(t===xW)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Wq(r[o],a[o]);if(0!==s)return s;var u=LW(n[r[o]],i[a[o]]);if(0!==u)return u}return Wq(r.length,a.length)}(e.mapValue,t.mapValue);default:throw xq()}}function FW(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Wq(e,t);var n=_W(e),r=_W(t),i=Wq(n.seconds,r.seconds);return 0!==i?i:Wq(n.nanos,r.nanos)}function UW(e){return VW(e)}function VW(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=_W(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?EW(e.bytesValue).toBase64():"referenceValue"in e?tW.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Cy(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=VW(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Cy(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(VW(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):xq();var t,n,r}function BW(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function zW(e){return!!e&&"integerValue"in e}function HW(e){return!!e&&"arrayValue"in e}function GW(e){return!!e&&"nullValue"in e}function $W(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ZW(e){return!!e&&"mapValue"in e}function qW(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return hW(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=qW(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=qW(e.arrayValue.values[r]);return n}return Object.assign({},e)}function WW(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var jW=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!ZW(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qW(t)}},{key:"setAll",value:function(e){var t=this,n=eW.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=qW(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());ZW(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return NW(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];ZW(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){hW(t,function(t,n){return e[t]=n});var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(qW(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function YW(e){var t=[];return hW(e.fields,function(e,n){var r=new eW([e]);if(ZW(n)){var i=YW(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Cy(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new kW(t)}var KW=function(){function e(t,n,r,i,a,o){by(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return Py(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=jW.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=jW.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Kq.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Kq.min(),Kq.min(),jW.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Kq.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Kq.min(),jW.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Kq.min(),jW.empty(),2)}}]),e}(),QW=Py(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;by(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function XW(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new QW(e,t,n,r,i,a,o)}function JW(e){var t=Nq(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+UW(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),AW(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return UW(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return UW(e)}).join(",")),t.ut=n}return t.ut}function ej(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!dj(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!NW(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!pj(e.startAt,t.startAt)&&pj(e.endAt,t.endAt)}function tj(e){return tW.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var nj=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return Py(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(LW(t,this.value)):null!==t&&RW(this.value)===RW(t)&&this.at(LW(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return xq()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new rj(e,t,r):"array-contains"===t?new sj(e,r):"in"===t?new uj(e,r):"not-in"===t?new cj(e,r):"array-contains-any"===t?new lj(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new ij(e,n):new aj(e,n)}}]),n}(function(){return Py(function e(){by(this,e)})}()),rj=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r,i)).key=tW.fromName(i.referenceValue),a}return Py(n,[{key:"matches",value:function(e){var t=tW.comparator(e.key,this.key);return this.at(t)}}]),n}(nj),ij=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,"in",r)).keys=oj(0,r),i}return Py(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(nj),aj=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,"not-in",r)).keys=oj(0,r),i}return Py(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(nj);function oj(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return tW.fromName(e.referenceValue)})}var sj=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,"array-contains",r)}return Py(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return HW(t)&&DW(t.arrayValue,this.value)}}]),n}(nj),uj=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,"in",r)}return Py(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&DW(this.value.arrayValue,t)}}]),n}(nj),cj=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,"not-in",r)}return Py(n,[{key:"matches",value:function(e){if(DW(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!DW(this.value.arrayValue,t)}}]),n}(nj),lj=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,"array-contains-any",r)}return Py(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!HW(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return DW(t.value.arrayValue,e)})}}]),n}(nj),fj=Py(function e(t,n){by(this,e),this.position=t,this.inclusive=n}),hj=Py(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";by(this,e),this.field=t,this.dir=n});function dj(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function vj(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?tW.comparator(tW.fromName(o.referenceValue),n.key):LW(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function pj(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!NW(e.position[n],t.position[n]))return!1;return!0}var gj=Py(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;by(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function yj(e){return new gj(e)}function mj(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function kj(e){var t,n=Cy(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function Cj(e){return null!==e.collectionGroup}function wj(e){var t=Nq(e);if(null===t.lt){t.lt=[];var n=kj(t),r=mj(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new hj(n)),t.lt.push(new hj(eW.keyField(),"asc"));else{var i,a=!1,o=Cy(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new hj(eW.keyField(),u))}}}return t.lt}function _j(e){var t=Nq(e);if(!t.ft)if("F"===t.limitType)t.ft=XW(t.path,t.collectionGroup,wj(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Cy(wj(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new hj(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new fj(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new fj(t.startAt.position,t.startAt.inclusive):null;t.ft=XW(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function bj(e,t,n){return new gj(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ej(e,t){return ej(_j(e),_j(t))&&e.limitType===t.limitType}function Pj(e){return"".concat(JW(_j(e)),"|lt:").concat(e.limitType)}function Sj(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(UW(t.value));var t}).join(", "),"]")),AW(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return UW(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return UW(e)}).join(",")),"Target(".concat(t,")")}(_j(e)),"; limitType=").concat(e.limitType,")")}function Oj(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):tW.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Cy(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Cy(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=wj(o),i=s,a=vj(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=vj(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,wj(o),s)));var n,r,i,a,o,s}function Tj(e){return function(t,n){var r,i=!1,a=Cy(wj(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=Ij(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function Ij(e,t,n){var r,i,a,o,s=e.field.isKeyField()?tW.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?LW(a,o):xq());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return xq()}}function Aj(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:MW(t)?"-0":t}}function Mj(e){return{integerValue:""+e}}var xj=Py(function e(){by(this,e),this._=void 0});function Rj(e,t,n){return e instanceof Lj?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof Fj?Uj(e,t):e instanceof Vj?Bj(e,t):function(e,t){var n=Dj(e,t),r=Hj(n)+Hj(e._t);return zW(n)&&zW(e._t)?Mj(r):Aj(e.wt,r)}(e,t);var r,i,a}function Nj(e,t,n){return e instanceof Fj?Uj(e,t):e instanceof Vj?Bj(e,t):n}function Dj(e,t){return e instanceof zj?zW(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var Lj=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n)}(xj),Fj=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).elements=e,r}return Py(n)}(xj);function Uj(e,t){var n,r=Gj(t),i=Cy(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return NW(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Vj=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).elements=e,r}return Py(n)}(xj);function Bj(e,t){var n,r=Gj(t),i=Cy(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!NW(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var zj=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).wt=e,i._t=r,i}return Py(n)}(xj);function Hj(e){return bW(e.integerValue||e.doubleValue)}function Gj(e){return HW(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var $j=Py(function e(t,n){by(this,e),this.field=t,this.transform=n}),Zj=Py(function e(t,n){by(this,e),this.version=t,this.transformResults=n}),qj=function(){function e(t,n){by(this,e),this.updateTime=t,this.exists=n}return Py(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Wj(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var jj=Py(function e(){by(this,e)});function Yj(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new sY(e.key,qj.none()):new eY(e.key,e.data,qj.none());var n,r=e.data,i=jW.empty(),a=new yW(eW.comparator),o=Cy(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new tY(e.key,i,new kW(a.toArray()),qj.none())}function Kj(e,t,n){var r,i,a,o,s;e instanceof eY?(i=t,a=n,o=(r=e).value.clone(),s=rY(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof tY?function(e,t,n){if(Wj(e.precondition,t)){var r=rY(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(nY(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function Qj(e,t,n,r){return e instanceof eY?function(e,t,n,r){if(!Wj(e.precondition,t))return n;var i=e.value.clone(),a=iY(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof tY?function(e,t,n,r){if(!Wj(e.precondition,t))return n;var i=iY(e.fieldTransforms,r,t),a=t.data;return a.setAll(nY(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,Wj(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Xj(e,t){var n,r=null,i=Cy(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=Dj(a.transform,o||null);null!=s&&(null===r&&(r=jW.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function Jj(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&jq(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof Fj&&r instanceof Fj||n instanceof Vj&&r instanceof Vj?jq(n.elements,r.elements,NW):n instanceof zj&&r instanceof zj?NW(n._t,r._t):n instanceof Lj&&r instanceof Lj);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var eY=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return by(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return Py(n,[{key:"getFieldMask",value:function(){return null}}]),n}(jj),tY=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return by(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return Py(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(jj);function nY(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function rY(e,t,n){var r=new Map;Rq(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,Nj(o,s,n[i]))}return r}function iY(e,t,n){var r,i=new Map,a=Cy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,Rj(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var aY,oY,sY=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return Py(n,[{key:"getFieldMask",value:function(){return null}}]),n}(jj),uY=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return Py(n,[{key:"getFieldMask",value:function(){return null}}]),n}(jj),cY=Py(function e(t){by(this,e),this.count=t});function lY(e){switch(e){default:return xq();case Dq.CANCELLED:case Dq.UNKNOWN:case Dq.DEADLINE_EXCEEDED:case Dq.RESOURCE_EXHAUSTED:case Dq.INTERNAL:case Dq.UNAVAILABLE:case Dq.UNAUTHENTICATED:return!1;case Dq.INVALID_ARGUMENT:case Dq.NOT_FOUND:case Dq.ALREADY_EXISTS:case Dq.PERMISSION_DENIED:case Dq.FAILED_PRECONDITION:case Dq.ABORTED:case Dq.OUT_OF_RANGE:case Dq.UNIMPLEMENTED:case Dq.DATA_LOSS:return!0}}function fY(e){if(void 0===e)return Iq("GRPC error has no .code"),Dq.UNKNOWN;switch(e){case aY.OK:return Dq.OK;case aY.CANCELLED:return Dq.CANCELLED;case aY.UNKNOWN:return Dq.UNKNOWN;case aY.DEADLINE_EXCEEDED:return Dq.DEADLINE_EXCEEDED;case aY.RESOURCE_EXHAUSTED:return Dq.RESOURCE_EXHAUSTED;case aY.INTERNAL:return Dq.INTERNAL;case aY.UNAVAILABLE:return Dq.UNAVAILABLE;case aY.UNAUTHENTICATED:return Dq.UNAUTHENTICATED;case aY.INVALID_ARGUMENT:return Dq.INVALID_ARGUMENT;case aY.NOT_FOUND:return Dq.NOT_FOUND;case aY.ALREADY_EXISTS:return Dq.ALREADY_EXISTS;case aY.PERMISSION_DENIED:return Dq.PERMISSION_DENIED;case aY.FAILED_PRECONDITION:return Dq.FAILED_PRECONDITION;case aY.ABORTED:return Dq.ABORTED;case aY.OUT_OF_RANGE:return Dq.OUT_OF_RANGE;case aY.UNIMPLEMENTED:return Dq.UNIMPLEMENTED;case aY.DATA_LOSS:return Dq.DATA_LOSS;default:return xq()}}(oY=aY||(aY={}))[oY.OK=0]="OK",oY[oY.CANCELLED=1]="CANCELLED",oY[oY.UNKNOWN=2]="UNKNOWN",oY[oY.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oY[oY.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oY[oY.NOT_FOUND=5]="NOT_FOUND",oY[oY.ALREADY_EXISTS=6]="ALREADY_EXISTS",oY[oY.PERMISSION_DENIED=7]="PERMISSION_DENIED",oY[oY.UNAUTHENTICATED=16]="UNAUTHENTICATED",oY[oY.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oY[oY.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oY[oY.ABORTED=10]="ABORTED",oY[oY.OUT_OF_RANGE=11]="OUT_OF_RANGE",oY[oY.UNIMPLEMENTED=12]="UNIMPLEMENTED",oY[oY.INTERNAL=13]="INTERNAL",oY[oY.UNAVAILABLE=14]="UNAVAILABLE",oY[oY.DATA_LOSS=15]="DATA_LOSS";var hY=function(){function e(t,n){by(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return Py(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=iy(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){hW(this.inner,function(t,n){var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=iy(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return dW(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),dY=new vW(tW.comparator);function vY(){return dY}var pY=new vW(tW.comparator);function gY(){for(var e=pY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function yY(e){var t=pY;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function mY(){return CY()}function kY(){return CY()}function CY(){return new hY(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var wY=new vW(tW.comparator),_Y=new yW(tW.comparator);function bY(){for(var e=_Y,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var EY=new yW(Wq);function PY(){return EY}var SY=function(){function e(t,n,r,i,a){by(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return Py(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,OY.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Kq.min(),r,PY(),vY(),bY())}}]),e}(),OY=function(){function e(t,n,r,i,a){by(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return Py(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(CW.EMPTY_BYTE_STRING,n,bY(),bY(),bY())}}]),e}(),TY=Py(function e(t,n,r,i){by(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),IY=Py(function e(t,n){by(this,e),this.targetId=t,this.It=n}),AY=Py(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CW.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;by(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),MY=function(){function e(){by(this,e),this.Tt=0,this.Et=NY(),this.At=CW.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return Py(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=bY(),t=bY(),n=bY();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:xq()}}),new OY(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=NY()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),xY=function(){function e(t){by(this,e),this.Mt=t,this.Ft=new Map,this.$t=vY(),this.Bt=RY(),this.Lt=new yW(Wq)}return Py(e,[{key:"Ut",value:function(e){var t,n=Cy(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=Cy(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:xq()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(tj(i))if(0===n){var a=new tW(i.path);this.Kt(t,a,KW.newNoDocument(a,Kq.min()))}else Rq(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&tj(a.target)){var o=new tW(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,KW.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=bY();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new SY(e,n,this.Lt,this.$t,r);return this.$t=vY(),this.Bt=RY(),this.Lt=new yW(Wq),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new MY,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new yW(Wq),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||Tq("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new MY),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function RY(){return new vW(tW.comparator)}function NY(){return new vW(tW.comparator)}var DY={asc:"ASCENDING",desc:"DESCENDING"},LY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FY=Py(function e(t,n){by(this,e),this.databaseId=t,this.dt=n});function UY(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function VY(e,t){return e.dt?t.toBase64():t.toUint8Array()}function BY(e,t){return UY(e,t.toTimestamp())}function zY(e){return Rq(!!e),Kq.fromTimestamp((t=_W(e),new Yq(t.seconds,t.nanos)));var t}function HY(e,t){return(n=e,new Xq(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function GY(e){var t=Xq.fromString(e);return Rq(sK(t)),t}function $Y(e,t){return HY(e.databaseId,t.path)}function ZY(e,t){var n=GY(t);if(n.get(1)!==e.databaseId.projectId)throw new Lq(Dq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Lq(Dq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new tW(jY(n))}function qY(e,t){return HY(e.databaseId,t)}function WY(e){return new Xq(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function jY(e){return Rq(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function YY(e,t,n){return{name:$Y(e,t),fields:n.value.mapValue.fields}}function KY(e,t){return{documents:[qY(e,t.path)]}}function QY(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=qY(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=qY(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if($W(e.value))return{unaryFilter:{field:nK(e.field),op:"IS_NAN"}};if(GW(e.value))return{unaryFilter:{field:nK(e.field),op:"IS_NULL"}}}else if("!="===e.op){if($W(e.value))return{unaryFilter:{field:nK(e.field),op:"IS_NOT_NAN"}};if(GW(e.value))return{unaryFilter:{field:nK(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nK(e.field),op:tK(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:nK((t=e).field),direction:eK(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||AW(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function XY(e){var t=function(e){var t=GY(e);return 4===t.length?Xq.emptyPath():jY(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Rq(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=JY(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new hj(rK((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return AW(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new fj((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new fj(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new gj(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function JY(e){return e?void 0!==e.unaryFilter?[aK(e)]:void 0!==e.fieldFilter?[iK(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return JY(e)}).reduce(function(e,t){return e.concat(t)}):xq():[]}function eK(e){return DY[e]}function tK(e){return LY[e]}function nK(e){return{fieldPath:e.canonicalString()}}function rK(e){return eW.fromServerFormat(e.fieldPath)}function iK(e){return nj.create(rK(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xq()}}(e.fieldFilter.op),e.fieldFilter.value)}function aK(e){switch(e.unaryFilter.op){case"IS_NAN":var t=rK(e.unaryFilter.field);return nj.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=rK(e.unaryFilter.field);return nj.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=rK(e.unaryFilter.field);return nj.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=rK(e.unaryFilter.field);return nj.create(i,"!=",{nullValue:"NULL_VALUE"});default:return xq()}}function oK(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function sK(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var uK=function(){function e(t,n,r,i){by(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return Py(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Kj(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=Cy(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Qj(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=Cy(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=Qj(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=kY();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=Yj(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Kq.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},bY())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&jq(this.mutations,e.mutations,function(e,t){return Jj(e,t)})&&jq(this.baseMutations,e.baseMutations,function(e,t){return Jj(e,t)})}}]),e}(),cK=function(){function e(t,n,r,i){by(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return Py(e,null,[{key:"from",value:function(t,n,r){Rq(t.mutations.length===r.length);for(var i=wY,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),lK=function(){function e(t,n){by(this,e),this.largestBatchId=t,this.mutation=n}return Py(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),fK=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Kq.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kq.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:CW.EMPTY_BYTE_STRING;by(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return Py(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),hK=Py(function e(t){by(this,e),this.ne=t});function dK(e){var t=XY({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?bj(t,t.limit,"L"):t}var vK=function(){function e(){by(this,e)}return Py(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(bW(e.integerValue));else if("doubleValue"in e){var n=bW(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),MW(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(EW(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?WW(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):xq()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),tW.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();vK.ye=new vK;var pK=function(){function e(){by(this,e),this.ze=new gK}return Py(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),uW.resolve()}},{key:"getCollectionParents",value:function(e,t){return uW.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return uW.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return uW.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return uW.resolve(null)}},{key:"getIndexType",value:function(e,t){return uW.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return uW.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return uW.resolve(null)}},{key:"getMinOffset",value:function(e,t){return uW.resolve(rW.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return uW.resolve(rW.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return uW.resolve()}},{key:"updateIndexEntries",value:function(e,t){return uW.resolve()}}]),e}(),gK=function(){function e(){by(this,e),this.index={}}return Py(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new yW(Xq.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new yW(Xq.comparator)).toArray()}}]),e}();new Uint8Array(0);var yK=function(){function e(t,n,r){by(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Py(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();yK.DEFAULT_COLLECTION_PERCENTILE=10,yK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yK.DEFAULT=new yK(41943040,yK.DEFAULT_COLLECTION_PERCENTILE,yK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yK.DISABLED=new yK(-1,0,0);var mK=function(){function e(t){by(this,e),this.En=t}return Py(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),kK=Py(function e(t,n){by(this,e),this.overlayedDocument=t,this.mutatedFields=n}),CK=function(){function e(t,n,r,i){by(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return Py(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&Qj(r.mutation,e,kW.empty(),Yq.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,bY()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bY(),i=mY();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=gY();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=mY();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,bY())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=vY(),a=CY(),o=CY();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof tY)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),Qj(o.mutation,t,o.mutation.getFieldMask(),Yq.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new kK(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=CY(),i=new vW(function(e,t){return e-t}),a=bY();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=Cy(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||kW.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||bY()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=kY();c.forEach(function(e){if(!a.has(e)){var n=Yj(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return uW.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return tW.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Cj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):uW.resolve(mY()),s=-1,u=a;return o.next(function(t){return uW.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?uW.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,bY())}).next(function(e){return{batchId:s,changes:yY(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new tW(t)).next(function(e){var t=gY();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=gY();return this.indexManager.getCollectionParents(e,i).next(function(o){return uW.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new gj(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,KW.newInvalidDocument(n)))});var n=gY();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&Qj(a.mutation,i,kW.empty(),Yq.now()),Oj(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):uW.resolve(KW.newInvalidDocument(t))}}]),e}(),wK=function(){function e(t){by(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return Py(e,[{key:"getBundleMetadata",value:function(e,t){return uW.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:zY(n.createTime)}),uW.resolve()}},{key:"getNamedQuery",value:function(e,t){return uW.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:dK(n.bundledQuery),readTime:zY(n.readTime)}),uW.resolve();var n}}]),e}(),_K=function(){function e(){by(this,e),this.overlays=new vW(tW.comparator),this.Xn=new Map}return Py(e,[{key:"getOverlay",value:function(e,t){return uW.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=mY();return uW.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),uW.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),uW.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=mY(),i=t.length+1,a=new tW(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return uW.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new vW(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=mY(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=mY(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return uW.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new lK(t,n));var a=this.Xn.get(t);void 0===a&&(a=bY(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),bK=function(){function e(){by(this,e),this.Zn=new yW(EK.ts),this.es=new yW(EK.ns)}return Py(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new EK(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new EK(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new tW(new Xq([])),r=new EK(n,e),i=new EK(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new tW(new Xq([])),n=new EK(t,e),r=new EK(t,e+1),i=bY();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new EK(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),EK=function(){function e(t,n){by(this,e),this.key=t,this.ls=n}return Py(e,null,[{key:"ts",value:function(e,t){return tW.comparator(e.key,t.key)||Wq(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Wq(e.ls,t.ls)||tW.comparator(e.key,t.key)}}]),e}(),PK=function(){function e(t,n){by(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new yW(EK.ts)}return Py(e,[{key:"checkEmpty",value:function(e){return uW.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new uK(i,t,n,r);this.mutationQueue.push(a);var o,s=Cy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new EK(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return uW.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return uW.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return uW.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return uW.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return uW.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new EK(t,0),i=new EK(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),uW.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new yW(Wq);return t.forEach(function(e){var t=new EK(e,0),i=new EK(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),uW.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;tW.isDocumentKey(i)||(i=i.child(""));var a=new EK(new tW(i),0),o=new yW(Wq);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),uW.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Rq(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return uW.forEach(t.mutations,function(i){var a=new EK(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new EK(t,0),r=this.ds.firstAfterOrEqual(n);return uW.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return uW.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),SK=function(){function e(t){by(this,e),this.ps=t,this.docs=new vW(tW.comparator),this.size=0}return Py(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return uW.resolve(n?n.document.mutableCopy():KW.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=vY();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():KW.newInvalidDocument(e))}),uW.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=vY(),i=new tW(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||iW(nW(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return uW.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){xq()}},{key:"Is",value:function(e,t){return uW.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new OK(this)}},{key:"getSize",value:function(e){return uW.resolve(this.size)}}]),e}(),OK=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).zn=e,r}return Py(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),uW.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){by(this,e),this.changes=new hY(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return Py(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,KW.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?uW.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),TK=function(){function e(t){by(this,e),this.persistence=t,this.Ts=new hY(function(e){return JW(e)},ej),this.lastRemoteSnapshotVersion=Kq.min(),this.highestTargetId=0,this.Es=0,this.As=new bK,this.targetCount=0,this.Rs=mK.An()}return Py(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),uW.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return uW.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return uW.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),uW.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),uW.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new mK(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,uW.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),uW.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,uW.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),uW.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return uW.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return uW.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),uW.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),uW.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),uW.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return uW.resolve(n)}},{key:"containsKey",value:function(e,t){return uW.resolve(this.As.containsKey(t))}}]),e}(),IK=function(){function e(t,n){var r=this;by(this,e),this.bs={},this.overlays={},this.Ps=new lW(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new TK(this),this.indexManager=new pK,this.remoteDocumentCache=new SK(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new hK(n),this.Ds=new wK(this.wt)}return Py(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new _K,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new PK(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;Tq("MemoryPersistence","Starting transaction:",e);var i=new AK(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return uW.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),AK=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return Py(n)}(function(){function e(){by(this,e),this.onCommittedListeners=[]}return Py(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),MK=function(){function e(t){by(this,e),this.persistence=t,this.ks=new bK,this.Os=null}return Py(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw xq()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),uW.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),uW.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),uW.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return uW.forEach(this.Fs,function(r){var i=tW.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,Kq.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return uW.or([function(){return uW.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),xK=function(){function e(t,n,r,i){by(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return Py(e,null,[{key:"Vi",value:function(t,n){var r,i=bY(),a=bY(),o=Cy(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),RK=function(){function e(){by(this,e),this.Si=!1}return Py(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return uW.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Kq.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(Oq()<=bz.DEBUG&&Tq("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Sj(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Kq.fromTimestamp(1e9===r?new Yq(n+1,0):new Yq(n,r));return new rW(i,tW.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new yW(Tj(e));return t.forEach(function(t,r){Oj(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return Oq()<=bz.DEBUG&&Tq("QueryEngine","Using full collection scan to execute query:",Sj(t)),this.Di.getDocumentsMatchingQuery(e,t,rW.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),NK=function(){function e(t,n,r,i){by(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new vW(Wq),this.Bi=new hY(function(e){return JW(e)},ej),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return Py(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CK(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function DK(e,t){return LK.apply(this,arguments)}function LK(){return LK=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nq(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=bY(),u=Cy(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=Cy(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Cy(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Cy(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),LK.apply(this,arguments)}function FK(e,t){var n=Nq(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=uW.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);Rq(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=bY(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function UK(e){var t=Nq(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function VK(e,t){var n=Nq(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken(CW.EMPTY_BYTE_STRING,Kq.min()).withLastLimboFreeSnapshotVersion(Kq.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=vY(),u=bY();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=bY(),i=bY();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=vY();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Kq.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Tq("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(Kq.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return uW.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function BK(e,t){var n=Nq(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function zK(e,t){var n=Nq(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,uW.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new fK(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function HK(e,t,n){return GK.apply(this,arguments)}function GK(){return GK=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Nq(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),cW(e.t1)){e.next=12;break}throw e.t1;case 12:Tq("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),GK.apply(this,arguments)}function $K(e,t,n){var r=Nq(e),i=Kq.min(),a=bY();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=_j(t),c=Nq(o),l=c.Bi.get(u),void 0!==l?uW.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:Kq.min(),n?a:bY())}).next(function(e){return function(e,t,n){var r=Kq.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var ZK=function(){function e(){by(this,e),this.activeTargetIds=PY()}return Py(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),qK=function(){function e(){by(this,e),this.Fr=new ZK,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Py(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new ZK,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),WK=function(){function e(){by(this,e)}return Py(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),jK=function(){function e(){var t=this;by(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return Py(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){Tq("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Cy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){Tq("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Cy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),YK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},KK=function(){function e(t){by(this,e),this.jr=t.jr,this.Wr=t.Wr}return Py(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),QK=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return Py(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new _q;o.listenOnce(yq.COMPLETE,function(){try{switch(o.getLastErrorCode()){case gq.NO_ERROR:var t=o.getResponseJson();Tq("Connection","XHR received:",JSON.stringify(t)),i(t);break;case gq.TIMEOUT:Tq("Connection",'RPC "'+e+'" timed out'),a(new Lq(Dq.DEADLINE_EXCEEDED,"Request time out"));break;case gq.HTTP_ERROR:var n=o.getStatus();if(Tq("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(Dq).indexOf(c)>=0?c:Dq.UNKNOWN);a(new Lq(s,r.message))}else a(new Lq(Dq.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Lq(Dq.UNAVAILABLE,"Connection failed."));break;default:xq()}}finally{Tq("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=vq(),a=pq(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Cq({})),this.uo(o.initMessageHeaders,t,n),QB()||JB()||KB().indexOf("Electron/")>=0||ez()||KB().indexOf("MSAppHost/")>=0||XB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");Tq("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new KK({jr:function(e){l?Tq("Connection","Not sending because WebChannel is closed:",e):(c||(Tq("Connection","Opening WebChannel transport."),u.open(),c=!0),Tq("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,wq.EventType.OPEN,function(){l||Tq("Connection","WebChannel transport opened.")}),h(u,wq.EventType.CLOSE,function(){l||(l=!0,Tq("Connection","WebChannel transport closed"),f.eo())}),h(u,wq.EventType.ERROR,function(e){l||(l=!0,Aq("Connection","WebChannel transport errored:",e),f.eo(new Lq(Dq.UNAVAILABLE,"The operation could not be completed")))}),h(u,wq.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];Rq(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Tq("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=aY[e];if(void 0!==t)return fY(t)}(a),s=i.message;void 0===o&&(o=Dq.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new Lq(o,s)),u.close()}else Tq("Connection","WebChannel received:",n),f.no(n)}}),h(a,mq.STAT_EVENT,function(e){e.stat===kq.PROXY?Tq("Connection","Detected buffering proxy"):e.stat===kq.NOPROXY&&Tq("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){by(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Py(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);Tq("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return Tq("RestConnection","Received: ",e),e},function(t){throw Aq("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Pq,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(YK[e])}}]),e}());function XK(){return"undefined"!=typeof document?document:null}function JK(e){return new FY(e,!0)}var eQ=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;by(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return Py(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&Tq("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),tQ=function(){function e(t,n,r,i,a,o,s,u){by(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new eQ(t,n)}return Py(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===Dq.RESOURCE_EXHAUSTED?(Iq(t.toString()),Iq("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===Dq.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=iy(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new Lq(Dq.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return Tq("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(Tq("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),nQ=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return Py(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:xq(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(Rq(void 0===t||"string"==typeof t),CW.fromBase64String(t||"")):(Rq(void 0===t||t instanceof Uint8Array),CW.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?Dq.UNKNOWN:fY(e.code);return new Lq(t,e.message||"")}(s);n=new AY(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=ZY(e,c.document.name),f=zY(c.document.updateTime),h=new jW({mapValue:{fields:c.document.fields}}),d=KW.newFoundDocument(l,f,h);n=new TY(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=ZY(e,v.document),g=v.readTime?zY(v.readTime):Kq.min(),y=KW.newNoDocument(p,g);n=new TY([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=ZY(e,m.document);n=new TY([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return xq();var C=t.filter,w=new cY(C.count||0);n=new IY(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Kq.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Kq.min():t.readTime?zY(t.readTime):Kq.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=WY(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=tj(i)?{documents:KY(t,i)}:{query:QY(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=VY(t,n.resumeToken):n.snapshotVersion.compareTo(Kq.min())>0&&(r.readTime=UY(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xq()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=WY(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(tQ),rQ=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return Py(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,cy(yy(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(Rq(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(Rq(void 0!==t),e.map(function(e){return function(e,t){var n=zY(e.updateTime?e.updateTime:t);return n.isEqual(Kq.min())&&(n=zY(t)),new Zj(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=zY(e.commitTime);return this.listener.Jo(n,t)}return Rq(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=WY(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof eY)n={update:YY(e,t.key,t.value)};else if(t instanceof sY)n={delete:$Y(e,t.key)};else if(t instanceof tY)n={update:YY(e,t.key,t.data),updateMask:oK(t.fieldMask)};else{if(!(t instanceof uY))return xq();n={verify:$Y(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Lj)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Fj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Vj)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zj)return{fieldPath:t.field.canonicalString(),increment:n._t};throw xq()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:BY(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:xq()),n}(t.wt,e)})};this.Mo(n)}}]),n}(tQ),iQ=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return Py(n,[{key:"tu",value:function(){if(this.Zo)throw new Lq(Dq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=iy(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Dq.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Lq(Dq.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=iy(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Dq.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Lq(Dq.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return Py(function e(){by(this,e)})}()),aQ=function(){function e(t,n){by(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return Py(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(Iq(t),this.su=!1):Tq("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),oQ=Py(function e(t,n,r,i,a){by(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(DB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=yQ(o),!e.t0){e.next=5;break}return Tq("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Nq(t)).lu.add(4),e.next=4,cQ(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,sQ(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new aQ(r,i)});function sQ(e){return uQ.apply(this,arguments)}function uQ(){return uQ=DB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!yQ(t)){e.next=18;break}n=Cy(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),uQ.apply(this,arguments)}function cQ(e){return lQ.apply(this,arguments)}function lQ(){return lQ=DB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Cy(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),lQ.apply(this,arguments)}function fQ(e,t){var n=Nq(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),gQ(n)?pQ(n):ZQ(n).Co()&&dQ(n,t))}function hQ(e,t){var n=Nq(e),r=ZQ(n);n.hu.delete(t),r.Co()&&vQ(n,t),0===n.hu.size&&(r.Co()?r.ko():yQ(n)&&n._u.set("Unknown"))}function dQ(e,t){e.wu.Nt(t.targetId),ZQ(e).Qo(t)}function vQ(e,t){e.wu.Nt(t),ZQ(e).jo(t)}function pQ(e){e.wu=new xY({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),ZQ(e).start(),e._u.iu()}function gQ(e){return yQ(e)&&!ZQ(e).Do()&&e.hu.size>0}function yQ(e){return 0===Nq(e).lu.size}function mQ(e){e.wu=void 0}function kQ(e){return CQ.apply(this,arguments)}function CQ(){return CQ=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){dQ(t,e)});case 1:case"end":return e.stop()}},e)})),CQ.apply(this,arguments)}function wQ(e,t){return _Q.apply(this,arguments)}function _Q(){return _Q=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:mQ(t),gQ(t)?(t._u.uu(n),pQ(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),_Q.apply(this,arguments)}function bQ(e,t,n){return EQ.apply(this,arguments)}function EQ(){return EQ=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof AY&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Cy(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Tq("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,PQ(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof TY?t.wu.Ut(n):n instanceof IY?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Kq.min())){e.next=29;break}return e.prev=14,e.next=17,UK(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(CW.EMPTY_BYTE_STRING,n.snapshotVersion)),vQ(e,t);var r=new fK(n.target,t,1,n.sequenceNumber);dQ(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Tq("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,PQ(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),EQ.apply(this,arguments)}function PQ(e,t,n){return SQ.apply(this,arguments)}function SQ(){return SQ=DB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(cW(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,cQ(t);case 5:t._u.set("Offline"),r||(r=function(){return UK(t.localStore)}),t.asyncQueue.enqueueRetryable(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Tq("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,sQ(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),SQ.apply(this,arguments)}function OQ(e,t){return t().catch(function(n){return PQ(e,n,t)})}function TQ(e){return IQ.apply(this,arguments)}function IQ(){return IQ=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Nq(t),r=qQ(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!AQ(n)){e.next=19;break}return e.prev=3,e.next=6,BK(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,MQ(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,PQ(n,e.t0);case 17:e.next=2;break;case 19:xQ(n)&&RQ(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),IQ.apply(this,arguments)}function AQ(e){return yQ(e)&&e.au.length<10}function MQ(e,t){e.au.push(t);var n=qQ(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function xQ(e){return yQ(e)&&!qQ(e).Do()&&e.au.length>0}function RQ(e){qQ(e).start()}function NQ(e){return DQ.apply(this,arguments)}function DQ(){return DQ=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:qQ(t).Xo();case 1:case"end":return e.stop()}},e)})),DQ.apply(this,arguments)}function LQ(e){return FQ.apply(this,arguments)}function FQ(){return FQ=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=qQ(t),r=Cy(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),FQ.apply(this,arguments)}function UQ(e,t,n){return VQ.apply(this,arguments)}function VQ(){return VQ=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=cK.from(i,n,r),e.next=3,OQ(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,TQ(t);case 5:case"end":return e.stop()}},e)})),VQ.apply(this,arguments)}function BQ(e,t){return zQ.apply(this,arguments)}function zQ(){return zQ=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&qQ(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!lY(i=n.code)||i===Dq.ABORTED){e.next=7;break}return r=t.au.shift(),qQ(t).No(),e.next=5,OQ(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,TQ(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:xQ(t)&&RQ(t);case 5:case"end":return e.stop()}},e)})),zQ.apply(this,arguments)}function HQ(e,t){return GQ.apply(this,arguments)}function GQ(){return GQ=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Nq(t)).asyncQueue.verifyOperationInProgress(),Tq("RemoteStore","RemoteStore received new credentials"),i=yQ(r),r.lu.add(3),e.next=6,cQ(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,sQ(r);case 12:case"end":return e.stop()}},e)})),GQ.apply(this,arguments)}function $Q(){return $Q=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Nq(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,sQ(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,cQ(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),$Q.apply(this,arguments)}function ZQ(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:kQ.bind(null,e),Jr:wQ.bind(null,e),Go:bQ.bind(null,e)},(i=Nq(t)).tu(),new nQ(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),gQ(e)?pQ(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:mQ(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function qQ(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:NQ.bind(null,e),Jr:BQ.bind(null,e),Yo:LQ.bind(null,e),Jo:UQ.bind(null,e)},(i=Nq(t)).tu(),new rQ(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,TQ(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(Tq("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var WQ=function(){function e(t,n,r,i,a){by(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Fq,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return Py(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Lq(Dq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function jQ(e,t){if(Iq("AsyncQueue","".concat(t,": ").concat(e)),cW(e))return new Lq(Dq.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var YQ=function(){function e(t){by(this,e),this.comparator=t?function(e,n){return t(e,n)||tW.comparator(e.key,n.key)}:function(e,t){return tW.comparator(e.key,t.key)},this.keyedMap=gY(),this.sortedSet=new vW(this.comparator)}return Py(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),KQ=function(){function e(){by(this,e),this.yu=new vW(tW.comparator)}return Py(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):xq():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),QQ=function(){function e(t,n,r,i,a,o,s,u){by(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return Py(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ej(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,YQ.emptySet(n),a,r,i,!0,!1)}}]),e}(),XQ=Py(function e(){by(this,e),this.Iu=void 0,this.listeners=[]}),JQ=Py(function e(){by(this,e),this.queries=new hY(function(e){return Pj(e)},Ej),this.onlineState="Unknown",this.Tu=new Set});function eX(e,t){return tX.apply(this,arguments)}function tX(){return tX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Nq(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new XQ),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=jQ(e.t0,"Initialization of query '".concat(Sj(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&oX(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),tX.apply(this,arguments)}function nX(e,t){return rX.apply(this,arguments)}function rX(){return rX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Nq(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),rX.apply(this,arguments)}function iX(e,t){var n,r=Nq(e),i=!1,a=Cy(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Cy(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&oX(r)}function aX(e,t,n){var r=Nq(e),i=r.queries.get(t);if(i){var a,o=Cy(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function oX(e){e.Tu.forEach(function(e){e.next()})}var sX=function(){function e(t,n,r){by(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return Py(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Cy(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new QQ(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=QQ.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),uX=Py(function e(t){by(this,e),this.key=t}),cX=Py(function e(t){by(this,e),this.key=t}),lX=function(){function e(t,n){by(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=bY(),this.mutatedKeys=bY(),this.Lu=Tj(t),this.Uu=new YQ(this.Lu)}return Py(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new KQ,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=Oj(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xq()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new QQ(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new KQ,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=bY(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new cX(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new uX(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=bY();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return QQ.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),fX=Py(function e(t,n,r){by(this,e),this.query=t,this.targetId=n,this.view=r}),hX=Py(function e(t){by(this,e),this.key=t,this.Xu=!1}),dX=function(){function e(t,n,r,i,a,o){by(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new hY(function(e){return Pj(e)},Ej),this.ec=new Map,this.nc=new Set,this.sc=new vW(tW.comparator),this.ic=new Map,this.rc=new bK,this.oc={},this.uc=new Map,this.cc=mK.Rn(),this.onlineState="Unknown",this.ac=void 0}return Py(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function vX(e,t){return pX.apply(this,arguments)}function pX(){return pX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=HX(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,zK(r.localStore,_j(n));case 8:return s=e.sent,r.isPrimaryClient&&fQ(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,gX(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),pX.apply(this,arguments)}function gX(e,t,n,r){return yX.apply(this,arguments)}function yX(){return yX=DB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=DB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,$K(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(NX(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,$K(t.localStore,n,!0);case 3:return a=e.sent,o=new lX(n,a.ji),s=o.Ku(a.documents),u=OY.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),NX(t,r,c.zu),l=new fX(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),yX.apply(this,arguments)}function mX(e,t){return kX.apply(this,arguments)}function kX(){return kX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Nq(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!Ej(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,HK(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),hQ(r.remoteStore,i.targetId),xX(r,i.targetId)}).catch(oW);case 9:e.next=14;break;case 11:return xX(r,i.targetId),e.next=14,HK(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),kX.apply(this,arguments)}function CX(){return CX=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=GX(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Nq(e),a=Yq.now(),o=t.reduce(function(e,t){return e.add(t.key)},bY());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=vY(),u=bY();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=Cy(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Xj(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new tY(c.key,l,YW(l.value.mapValue),qj.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:yY(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new vW(Wq)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,FX(i,a.changes);case 9:return e.next=11,TQ(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=jQ(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])})),CX.apply(this,arguments)}function wX(e,t){return _X.apply(this,arguments)}function _X(){return _X=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nq(t),e.prev=1,e.next=4,VK(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(Rq(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?Rq(n.Xu):e.removedDocuments.size>0&&(Rq(n.Xu),n.Xu=!1))}),e.next=8,FX(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,oW(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),_X.apply(this,arguments)}function bX(e,t,n){var r=Nq(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=Nq(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Cy(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&oX(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function EX(e,t,n){return PX.apply(this,arguments)}function PX(){return PX=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Nq(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new vW(tW.comparator)).insert(o,KW.newNoDocument(o,Kq.min())),u=bY().add(o),c=new SY(Kq.min(),new Map,new yW(Wq),s,u),e.next=9,wX(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),LX(i),e.next=16;break;case 14:return e.next=16,HK(i.localStore,n,!1).then(function(){return xX(i,n,r)}).catch(oW);case 16:case"end":return e.stop()}},e)})),PX.apply(this,arguments)}function SX(e,t){return OX.apply(this,arguments)}function OX(){return OX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nq(t),i=n.batch.batchId,e.prev=1,e.next=4,FK(r.localStore,n);case 4:return a=e.sent,MX(r,i,null),AX(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,FX(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,oW(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),OX.apply(this,arguments)}function TX(e,t,n){return IX.apply(this,arguments)}function IX(){return IX=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Nq(t),e.prev=1,e.next=4,function(e,t){var n=Nq(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return Rq(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,MX(i,n,r),AX(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,FX(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,oW(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),IX.apply(this,arguments)}function AX(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function MX(e,t,n){var r=Nq(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function xX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Cy(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||RX(e,t)})}function RX(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(hQ(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),LX(e))}function NX(e,t,n){var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof uX?(e.rc.addReference(a.key,t),DX(e,a)):a instanceof cX?(Tq("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||RX(e,a.key)):xq()}}catch(o){i.e(o)}finally{i.f()}}function DX(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(Tq("SyncEngine","New document in limbo: "+n),e.nc.add(r),LX(e))}function LX(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new tW(Xq.fromString(t)),r=e.cc.next();e.ic.set(r,new hX(n)),e.sc=e.sc.insert(n,r),fQ(e.remoteStore,new fK(_j(yj(n.path)),r,2,lW.ot))}}function FX(e,t,n){return UX.apply(this,arguments)}function UX(){return UX=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Nq(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=xK.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nq(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return uW.forEach(n,function(t){return uW.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return uW.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),cW(e.t0)){e.next=10;break}throw e.t0;case 10:Tq("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Cy(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),UX.apply(this,arguments)}function VX(e,t){return BX.apply(this,arguments)}function BX(){return BX=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Nq(t)).currentUser.isEqual(n)){e.next=12;break}return Tq("SyncEngine","User change. New user:",n.toKey()),e.next=5,DK(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new Lq(Dq.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,FX(r,i.Ki);case 12:case"end":return e.stop()}},e)})),BX.apply(this,arguments)}function zX(e,t){var n=Nq(e),r=n.ic.get(t);if(r&&r.Xu)return bY().add(r.key);var i=bY(),a=n.ec.get(t);if(!a)return i;var o,s=Cy(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function HX(e){var t=Nq(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wX.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=zX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=EX.bind(null,t),t.Zu.Go=iX.bind(null,t.eventManager),t.Zu.lc=aX.bind(null,t.eventManager),t}function GX(e){var t=Nq(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=SX.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=TX.bind(null,t),t}var $X=function(){function e(){by(this,e),this.synchronizeTabs=!1}return Py(e,[{key:"initialize",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=JK(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new NK(e,t,n,r)}(this.persistence,new RK,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new IK(MK.Ms,this.wt)}},{key:"dc",value:function(e){return new qK}},{key:"terminate",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),ZX=function(){function e(){by(this,e)}return Py(e,[{key:"initialize",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return bX(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=VX.bind(null,n.syncEngine),r.next=12,function(e,t){return $Q.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new JQ}},{key:"createDatastore",value:function(e){var t=JK(e.databaseInfo.databaseId),n=new QK(e.databaseInfo);return new iQ(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return bX(o.syncEngine,e,0)},a=jK.V()?new jK:new WK,new oQ(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new dX(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Nq(t),Tq("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,cQ(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),qX=function(){function e(t){by(this,e),this.observer=t,this.muted=!1}return Py(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),WX=function(){function e(t,n,r,i){var a=this;by(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Eq.UNAUTHENTICATED,this.clientId=qq.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Tq("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return Tq("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return Py(e,[{key:"getConfiguration",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Lq(Dq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Fq;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=jQ(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function jX(e,t){return YX.apply(this,arguments)}function YX(){return YX=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Tq("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,DK(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),YX.apply(this,arguments)}function KX(e,t){return QX.apply(this,arguments)}function QX(){return QX=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,XX(t);case 3:return r=e.sent,Tq("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return HQ(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return HQ(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),QX.apply(this,arguments)}function XX(e){return JX.apply(this,arguments)}function JX(){return JX=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Tq("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,jX(t,new $X);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),JX.apply(this,arguments)}function eJ(e){return tJ.apply(this,arguments)}function tJ(){return tJ=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Tq("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,KX(t,new ZX);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),tJ.apply(this,arguments)}function nJ(e){return rJ.apply(this,arguments)}function rJ(){return rJ=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eJ(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=vX.bind(null,n.syncEngine),r.onUnlisten=mX.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),rJ.apply(this,arguments)}var iJ=new Map;function aJ(e,t,n){if(!n)throw new Lq(Dq.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function oJ(e){if(!tW.isDocumentKey(e))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function sJ(e){if(tW.isDocumentKey(e))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function uJ(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":xq()}function cJ(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Lq(Dq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=uJ(e);throw new Lq(Dq.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var lJ=function(){function e(t){var n;if(by(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Lq(Dq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Lq(Dq.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Lq(Dq.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return Py(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),fJ=function(){function e(t,n,r){by(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lJ({}),this._settingsFrozen=!1,t instanceof IW?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Lq(Dq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new IW(e.options.projectId)}(t))}return Py(e,[{key:"app",get:function(){if(!this._app)throw new Lq(Dq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Lq(Dq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lJ(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Vq;switch(e.type){case"gapi":var t=e.client;return Rq(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Hq(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Lq(Dq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=iJ.get(e))&&(Tq("ComponentProvider","Removing Datastore"),iJ.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),hJ=function(){function e(t,n,r){by(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return Py(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new vJ(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),dJ=function(){function e(t,n,r){by(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return Py(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),vJ=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r,yj(i)))._path=i,a.type="collection",a}return Py(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new hJ(this.firestore,null,new tW(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(dJ);function pJ(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=pz(e),1===arguments.length&&(t=qq.I()),aJ("doc","path",t),e instanceof fJ){var a=Xq.fromString.apply(Xq,[t].concat(r));return oJ(a),new hJ(e,null,new tW(a))}if(!(e instanceof hJ||e instanceof vJ))throw new Lq(Dq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Xq.fromString.apply(Xq,[t].concat(r)));return oJ(o),new hJ(e.firestore,e instanceof vJ?e.converter:null,new tW(o))}var gJ=function(){function e(){var t=this;by(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new eQ(this,"async_queue_retry"),this.Kc=function(){var e=XK();e&&Tq("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=XK();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return Py(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=XK();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new Fq;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),cW(t.t0)){t.next=12;break}throw t.t0;case 12:Tq("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,Iq("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=WQ.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&xq()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=Cy(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Cy(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function yJ(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var mJ=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new gJ,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return Py(n,[{key:"_terminate",value:function(){return this._firestoreClient||CJ(this),this._firestoreClient.terminate()}}]),n}(fJ);function kJ(e){return e._firestoreClient||CJ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function CJ(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new TW(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new WX(e._authCredentials,e._appCheckCredentials,e._queue,a)}var wJ=function(){function e(){by(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new eW(n)}return Py(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),_J=function(){function e(t){by(this,e),this._byteString=t}return Py(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(CW.fromBase64String(t))}catch(n){throw new Lq(Dq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(CW.fromUint8Array(t))}}]),e}(),bJ=Py(function e(t){by(this,e),this._methodName=t}),EJ=function(){function e(t,n){if(by(this,e),!isFinite(t)||t<-90||t>90)throw new Lq(Dq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Lq(Dq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Py(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Wq(this._lat,e._lat)||Wq(this._long,e._long)}}]),e}(),PJ=/^__.*__$/,SJ=function(){function e(t,n,r){by(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Py(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new tY(e,this.data,this.fieldMask,t,this.fieldTransforms):new eY(e,this.data,t,this.fieldTransforms)}}]),e}(),OJ=function(){function e(t,n,r){by(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Py(e,[{key:"toMutation",value:function(e,t){return new tY(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function TJ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xq()}}var IJ=function(){function e(t,n,r,i,a,o){by(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return Py(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return HJ(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(TJ(this.Zc)&&PJ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),AJ=function(){function e(t,n,r){by(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||JK(t)}return Py(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new IJ({Zc:e,methodName:t,ca:n,path:eW.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function MJ(e){var t=e._freezeSettings(),n=JK(e._databaseId);return new AJ(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xJ(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);UJ("Data must be an object, but it was:",o,r);var s,u,c=LJ(r,o);if(a.merge)s=new kW(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=Cy(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=VJ(t,d,n);if(!o.contains(v))throw new Lq(Dq.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));GJ(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new kW(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new SJ(new jW(c),s,u)}var RJ=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(bJ),NJ=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"_toFieldTransform",value:function(e){return new $j(e.path,new Lj)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(bJ);function DJ(e,t){if(FJ(e=pz(e)))return UJ("Unsupported field value:",t,e),LJ(e,t);if(e instanceof bJ)return function(e,t){if(!TJ(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Cy(e);try{for(a.s();!(n=a.n()).done;){var o=DJ(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=pz(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!MW(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Mj(t):Aj(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Yq.fromDate(e);return{timestampValue:UY(t.wt,n)}}if(e instanceof Yq){var r=new Yq(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:UY(t.wt,r)}}if(e instanceof EJ)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof _J)return{bytesValue:VY(t.wt,e._byteString)};if(e instanceof hJ){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:HY(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(uJ(e)))}(e,t)}function LJ(e,t){var n={};return dW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):hW(e,function(e,r){var i=DJ(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function FJ(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Yq||e instanceof EJ||e instanceof _J||e instanceof hJ||e instanceof bJ)}function UJ(e,t,n){if(!FJ(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=uJ(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function VJ(e,t,n){if((t=pz(t))instanceof wJ)return t._internalPath;if("string"==typeof t)return zJ(e,t);throw HJ("Field path arguments must be of type string or ",e,!1,void 0,n)}var BJ=new RegExp("[~\\*/\\[\\]]");function zJ(e,t,n){if(t.search(BJ)>=0)throw HJ("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return uy(wJ,my(t.split(".")))._internalPath}catch(r){throw HJ("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function HJ(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new Lq(Dq.INVALID_ARGUMENT,s+e+u)}function GJ(e,t){return e.some(function(e){return e.isEqual(t)})}var $J=function(){function e(t,n,r,i,a){by(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Py(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new hJ(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new ZJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(qJ("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),ZJ=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"data",value:function(){return cy(yy(n.prototype),"data",this).call(this)}}]),n}($J);function qJ(e,t){return"string"==typeof t?zJ(e,t):t instanceof wJ?t._internalPath:t._delegate._internalPath}var WJ=function(){function e(t,n){by(this,e),this.hasPendingWrites=t,this.fromCache=n}return Py(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),jJ=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Py(n,[{key:"exists",value:function(){return cy(yy(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new YJ(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(qJ("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}($J),YJ=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return cy(yy(n.prototype),"data",this).call(this,e)}}]),n}(jJ),KJ=function(){function e(t,n,r,i){by(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new WJ(i.hasPendingWrites,i.fromCache),this.query=r}return Py(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new YJ(n._firestore,n._userDataWriter,r.key,r,new WJ(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Lq(Dq.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new YJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new WJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new YJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new WJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:QJ(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function QJ(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xq()}}function XJ(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Lq(Dq.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var JJ=Py(function e(){by(this,e)});var e1=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return Py(n,[{key:"_apply",value:function(e){var t,n,r,i=MJ(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){i1(o,a);var u,c=[],l=Cy(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(r1(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=r1(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||i1(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return DJ(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=nj.create(i,a,s);return function(e,t){if(t.ht()){var n=kj(e);if(null!==n&&!n.isEqual(t.field))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=mj(e);null!==r&&a1(0,t.field,r)}var i=function(e,t){var n,r=Cy(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new Lq(Dq.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new dJ(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new gj(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(JJ);var t1=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return Py(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new hj(t,n);return function(e,t){if(null===mj(e)){var n=kj(e);null!==n&&a1(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new dJ(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new gj(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(JJ);var n1=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return Py(n,[{key:"_apply",value:function(e){return new dJ(e.firestore,e.converter,bj(e._query,this.ma,this.ga))}}]),n}(JJ);function r1(e,t,n){if("string"==typeof(n=pz(n))){if(""===n)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cj(t)&&-1!==n.indexOf("/"))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(Xq.fromString(n));if(!tW.isDocumentKey(r))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return BW(e,new tW(r))}if(n instanceof hJ)return BW(e,n._key);throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(uJ(n),"."))}function i1(e,t){if(!Array.isArray(e)||0===e.length)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Lq(Dq.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function a1(e,t,n){if(!n.isEqual(t))throw new Lq(Dq.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function o1(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var s1=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).firestore=e,r}return Py(n,[{key:"convertBytes",value:function(e){return new _J(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new hJ(this.firestore,null,t)}}]),n}(function(){function e(){by(this,e)}return Py(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(RW(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bW(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(EW(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw xq()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return hW(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new EJ(bW(e.latitude),bW(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=SW(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(OW(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=_W(e);return new Yq(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Xq.fromString(e);Rq(sK(n));var r=new IW(n.get(1),n.get(3)),i=new tW(n.popFirst(5));return r.isEqual(t)||Iq("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function u1(e,t){return n=kJ(e),r=t,i=new Fq,n.asyncQueue.enqueueAndForget(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return CX.apply(this,arguments)},e.next=3,function(e){return eJ(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function c1(e,t,n){var r=n.docs.get(t._key),i=new s1(e);return new jJ(e,i,t._key,r,new WJ(n.hasPendingWrites,n.fromCache),t.converter)}function l1(){return new NJ("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Pq="9.9.0",Xz(new mz("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new mJ(i,new Bq(e.getProvider("auth-internal")),new $q(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),aH(bq,"3.4.12",e),aH(bq,"3.4.12","esm2017")}(),aH("firebase","9.9.0","app");var f1="@firebase/installations",h1="0.5.12",d1="w:".concat(h1),v1="FIS_v2",p1=new az("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function g1(e){return e instanceof iz&&e.code.includes("request-failed")}function y1(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function m1(e){return{token:e.token,requestStatus:2,expiresIn:P1(e.expiresIn),creationTime:Date.now()}}function k1(e,t){return C1.apply(this,arguments)}function C1(){return C1=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",p1.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),C1.apply(this,arguments)}function w1(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function _1(e,t){var n=t.refreshToken,r=w1(e);return r.append("Authorization",function(e){return"".concat(v1," ").concat(e)}(n)),r}function b1(e){return E1.apply(this,arguments)}function E1(){return E1=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),E1.apply(this,arguments)}function P1(e){return Number(e.replace("s","000"))}function S1(e,t){return O1.apply(this,arguments)}function O1(){return O1=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=y1(r),s=w1(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:v1,appId:r.appId,sdkVersion:d1})},e.next=11,b1(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:m1(h.authToken)});case 17:return e.next=19,k1("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),O1.apply(this,arguments)}function T1(e){return new Promise(function(t){setTimeout(t,e)})}var I1=/^[cdef][\w-]{21}$/;function A1(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,my(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return I1.test(t)?t:""}catch(n){return""}}function M1(e){return"".concat(e.appName,"!").concat(e.appId)}var x1=new Map;function R1(e,t){var n=M1(e);N1(n,t),function(e,t){var n=(!D1&&"BroadcastChannel"in self&&((D1=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){N1(e.data.key,e.data.fid)}),D1);n&&n.postMessage({key:e,fid:t}),0===x1.size&&D1&&(D1.close(),D1=null)}(n,t)}function N1(e,t){var n=x1.get(e);if(n){var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var D1=null,L1="firebase-installations-store",F1=null;function U1(){return F1||(F1=Fz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(L1)}})),F1}function V1(e,t){return B1.apply(this,arguments)}function B1(){return B1=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=M1(t),e.next=3,U1();case 3:return i=e.sent.transaction(L1,"readwrite"),a=i.objectStore(L1),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&R1(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),B1.apply(this,arguments)}function z1(e){return H1.apply(this,arguments)}function H1(){return H1=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=M1(t),e.next=3,U1();case 3:return r=e.sent.transaction(L1,"readwrite"),e.next=6,r.objectStore(L1).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),H1.apply(this,arguments)}function G1(e,t){return $1.apply(this,arguments)}function $1(){return $1=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=M1(t),e.next=3,U1();case 3:return i=e.sent.transaction(L1,"readwrite"),a=i.objectStore(L1),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&R1(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),$1.apply(this,arguments)}function Z1(e){return q1.apply(this,arguments)}function q1(){return q1=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G1(t.appConfig,function(e){var r=W1(e),i=j1(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),q1.apply(this,arguments)}function W1(e){return J1(e||{fid:A1(),registrationStatus:0})}function j1(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(p1.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return Y1.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:K1(e)}:{installationEntry:t}}function Y1(){return Y1=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S1(t,n);case 3:return r=e.sent,e.abrupt("return",V1(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!g1(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,z1(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,V1(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),Y1.apply(this,arguments)}function K1(e){return Q1.apply(this,arguments)}function Q1(){return Q1=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X1(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,T1(100);case 6:return e.next=8,X1(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,Z1(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),Q1.apply(this,arguments)}function X1(e){return G1(e,function(e){if(!e)throw p1.create("installation-not-found");return J1(e)})}function J1(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function e0(e,t){return t0.apply(this,arguments)}function t0(){return t0=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n0(r,n),o=_1(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:d1,appId:r.appId}})},e.next=10,b1(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=m1,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,k1("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),t0.apply(this,arguments)}function n0(e,t){var n=t.fid;return"".concat(y1(e),"/").concat(n,"/authTokens:generate")}function r0(e){return i0.apply(this,arguments)}function i0(){return i0=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,G1(t.appConfig,function(e){if(!l0(e))throw p1.create("not-registered");var i=e.authToken;if(!n&&f0(i))return e;if(1===i.requestStatus)return r=a0(t,n),e;if(!navigator.onLine)throw p1.create("app-offline");var a=h0(e);return r=u0(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),i0.apply(this,arguments)}function a0(e,t){return o0.apply(this,arguments)}function o0(){return o0=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s0(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,T1(100);case 6:return e.next=8,s0(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?r0(t,n):i);case 13:case"end":return e.stop()}},e)})),o0.apply(this,arguments)}function s0(e){return G1(e,function(e){if(!l0(e))throw p1.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function u0(e,t){return c0.apply(this,arguments)}function c0(){return c0=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,e0(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,V1(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),g1(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,V1(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,z1(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),c0.apply(this,arguments)}function l0(e){return void 0!==e&&2===e.registrationStatus}function f0(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function h0(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function d0(){return d0=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,Z1(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):r0(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),d0.apply(this,arguments)}function v0(){return v0=DB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,p0(r);case 4:return e.next=6,r0(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),v0.apply(this,arguments)}function p0(e){return g0.apply(this,arguments)}function g0(){return g0=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z1(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),g0.apply(this,arguments)}function y0(e){return p1.create("missing-app-config-values",{valueName:e})}var m0="installations";Xz(new mz(m0,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw y0("App Configuration");if(!e.name)throw y0("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw y0(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Jz(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),Xz(new mz("installations-internal",function(e){var t=Jz(e.getProvider("app").getImmediate(),m0).getImmediate();return{getId:function(){return function(e){return d0.apply(this,arguments)}(t)},getToken:function(e){return function(e){return v0.apply(this,arguments)}(t,e)}}},"PRIVATE")),aH(f1,h1),aH(f1,h1,"esm2017");var k0="@firebase/remote-config",C0=new az("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),w0=function(){function e(t,n,r,i){by(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return Py(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=iy(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function _0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var b0=function(){function e(t,n,r,i,a,o){by(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return Py(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=iy(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:_0()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),C0.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),C0.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw C0.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),E0=function(){function e(t,n){by(this,e),this.client=t,this.storage=n}return Py(e,[{key:"fetch",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return DB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(C0.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof iz&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+vz(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),P0=function(){function e(t,n,r,i,a){by(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return Py(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function S0(e,t){var n,r=e.target.error||void 0;return C0.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var O0="app_namespace_store",T0=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(S0(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(O0,{keyPath:"compositeKey"})}}catch(r){t(C0.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});by(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return Py(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([O0],"readonly").objectStore(O0),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(S0(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(C0.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([O0],"readwrite").objectStore(O0),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(S0(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(C0.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([O0],"readwrite").objectStore(O0),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(S0(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(C0.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),I0=function(){function e(t){by(this,e),this.storage=t}return Py(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function A0(){return(A0=DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(tz()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,nz();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}Xz(new mz("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw C0.create("registration-window");if(!tz())throw C0.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw C0.create("registration-project-id");if(!s)throw C0.create("registration-api-key");if(!u)throw C0.create("registration-app-id");var c=new T0(u,r.name,n=n||"firebase"),l=new I0(c),f=new Tz(k0);f.logLevel=bz.ERROR;var h=new b0(i,nH,n,o,s,u),d=new E0(h,c),v=new w0(d,c,l,f),p=new P0(r,v,l,c,f);return function(e){var t=pz(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),aH(k0,"0.3.11"),aH(k0,"0.3.11","esm2017");var M0="/firebase-messaging-sw.js",x0="/firebase-cloud-messaging-push-scope",R0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",N0="google.c.a.c_id",D0="google.c.a.c_l",L0="google.c.a.ts",F0="google.c.a.e",U0=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(U0||(U0={})),U0);function V0(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,my(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function B0(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var z0="fcm_token_details_db",H0="fcm_token_object_Store";function G0(e){return $0.apply(this,arguments)}function $0(){return $0=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(z0);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,Fz(z0,5,{upgrade:(r=DB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(H0)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(H0),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:V0(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:V0(f.auth),p256dh:V0(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:V0(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:V0(h.auth),p256dh:V0(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:V0(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,Uz(z0);case 13:return e.next=15,Uz("fcm_vapid_details_db");case 15:return e.next=17,Uz("undefined");case 17:return e.abrupt("return",Z0(n)?n:null);case 18:case"end":return e.stop()}},e)})),$0.apply(this,arguments)}function Z0(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var q0="firebase-messaging-store",W0=null;function j0(){return W0||(W0=Fz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(q0)}})),W0}function Y0(e){return K0.apply(this,arguments)}function K0(){return K0=DB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t2(t),e.next=3,j0();case 3:return e.next=5,e.sent.transaction(q0).objectStore(q0).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,G0(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,Q0(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),K0.apply(this,arguments)}function Q0(e,t){return X0.apply(this,arguments)}function X0(){return X0=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t2(t),e.next=3,j0();case 3:return i=e.sent.transaction(q0,"readwrite"),e.next=6,i.objectStore(q0).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),X0.apply(this,arguments)}function J0(e){return e2.apply(this,arguments)}function e2(){return e2=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t2(t),e.next=3,j0();case 3:return r=e.sent.transaction(q0,"readwrite"),e.next=6,r.objectStore(q0).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),e2.apply(this,arguments)}function t2(e){return e.appConfig.appId}var n2=new az("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function r2(e,t){return i2.apply(this,arguments)}function i2(){return i2=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l2(t);case 2:return i=e.sent,a=h2(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(c2(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),n2.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw n2.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw n2.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),i2.apply(this,arguments)}function a2(e,t){return o2.apply(this,arguments)}function o2(){return o2=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l2(t);case 2:return i=e.sent,a=h2(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(c2(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),n2.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw n2.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw n2.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),o2.apply(this,arguments)}function s2(e,t){return u2.apply(this,arguments)}function u2(){return u2=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l2(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(c2(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw n2.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),n2.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),u2.apply(this,arguments)}function c2(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function l2(e){return f2.apply(this,arguments)}function f2(){return f2=DB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),f2.apply(this,arguments)}function h2(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==R0&&(a.web.applicationPubKey=i),a}function d2(e){return v2.apply(this,arguments)}function v2(){return v2=DB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w2(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:V0(n.getKey("auth")),p256dh:V0(n.getKey("p256dh"))},e.next=6,Y0(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!b2(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?y2(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,s2(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",k2(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),v2.apply(this,arguments)}function p2(e){return g2.apply(this,arguments)}function g2(){return g2=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y0(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,s2(t.firebaseDependencies,n.token);case 7:return e.next=9,J0(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),g2.apply(this,arguments)}function y2(e,t){return m2.apply(this,arguments)}function m2(){return m2=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a2(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,Q0(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,p2(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),m2.apply(this,arguments)}function k2(e,t){return C2.apply(this,arguments)}function C2(){return C2=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r2(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,Q0(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),C2.apply(this,arguments)}function w2(e,t){return _2.apply(this,arguments)}function _2(){return _2=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:B0(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),_2.apply(this,arguments)}function b2(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function E2(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function P2(e){return"object"==typeof e&&!!e&&N0 in e}function S2(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function O2(e){return n2.create("missing-app-config-values",{valueName:e})}S2("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),S2("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var T2=function(){function e(t,n,r){by(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw O2("App Configuration Object");if(!e.name)throw O2("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw O2(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return Py(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function I2(e){return A2.apply(this,arguments)}function A2(){return A2=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(M0,{scope:x0});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),n2.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),A2.apply(this,arguments)}function M2(e,t){return x2.apply(this,arguments)}function x2(){return x2=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,I2(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw n2.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),x2.apply(this,arguments)}function R2(e,t){return N2.apply(this,arguments)}function N2(){return N2=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=R0);case 1:case"end":return e.stop()}},e)})),N2.apply(this,arguments)}function D2(){return D2=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw n2.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw n2.create("permission-blocked");case 8:return e.next=10,R2(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,M2(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",d2(t));case 13:case"end":return e.stop()}},e)})),D2.apply(this,arguments)}function L2(e,t,n){return F2.apply(this,arguments)}function F2(){return F2=DB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=U2(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[N0],message_name:r[D0],message_time:r[L0],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),F2.apply(this,arguments)}function U2(e){switch(e){case U0.NOTIFICATION_CLICKED:return"notification_open";case U0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function V2(){return V2=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===U0.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(E2(r)):t.onMessageHandler.next(E2(r))),i=r.data,e.t0=P2(i)&&"1"===i[F0],!e.t0){e.next=9;break}return e.next=9,L2(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),V2.apply(this,arguments)}var B2="@firebase/messaging";function z2(){return(z2=DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nz();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&tz()&&rz()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}Xz(new mz("messaging",function(e){var t=new T2(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return V2.apply(this,arguments)}(t,e)}),t},"PUBLIC")),Xz(new mz("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return D2.apply(this,arguments)}(t,e)}}},"PRIVATE")),aH(B2,"0.9.16"),aH(B2,"0.9.16","esm2017");var H2="analytics",G2="firebase_id",$2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Z2="https://www.googletagmanager.com/gtag/js",q2=new Tz("@firebase/analytics");function W2(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function j2(e,t){var n=document.createElement("script");n.src="".concat(Z2,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function Y2(e,t,n,r,i,a){return K2.apply(this,arguments)}function K2(){return K2=DB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,W2(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),q2.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),K2.apply(this,arguments)}function Q2(e,t,n,r,i){return X2.apply(this,arguments)}function X2(){return X2=DB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,W2(r);case 7:u=e.sent,c=Cy(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),q2.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),X2.apply(this,arguments)}function J2(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(Z2))return r}return null}var e3=new az("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),t3=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;by(this,e),this.throttleMetadata=t,this.intervalMillis=n}return Py(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function n3(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function r3(e){return i3.apply(this,arguments)}function i3(){return i3=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:n3(i)},o=$2.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw e3.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),i3.apply(this,arguments)}function a3(e){return o3.apply(this,arguments)}function o3(){return o3=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:t3,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw e3.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw e3.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new d3,e.abrupt("return",(setTimeout(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),s3({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),o3.apply(this,arguments)}function s3(e,t,n){return u3.apply(this,arguments)}function u3(){return u3=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:t3,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,c3(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(q2.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,r3(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),l3(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(q2.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?vz(a,o.intervalMillis,30):vz(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),q2.debug("Calling attemptFetch again in ".concat(d," millis")),s3(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),u3.apply(this,arguments)}function c3(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(e3.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function l3(e){if(!(e instanceof iz&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var f3,h3,d3=function(){function e(){by(this,e),this.listeners=[]}return Py(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function v3(){return v3=DB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),v3.apply(this,arguments)}function p3(e){h3=e}function g3(e){f3=e}function y3(){return m3.apply(this,arguments)}function m3(){return m3=DB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(tz()){e.next=2;break}return e.abrupt("return",(q2.warn(e3.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,nz();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(q2.warn(e3.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),m3.apply(this,arguments)}function k3(){return k3=DB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=a3(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&q2.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return q2.error(e)}),n.push(c),l=y3().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=iy(f,2),d=h[0],v=h[1],J2()||j2(o,d.measurementId),h3&&(a("consent","default",h3),p3(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[G2]=v),a("config",d.measurementId,p),f3&&(a("set",f3),g3(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),k3.apply(this,arguments)}var C3,w3,_3=function(){function e(t){by(this,e),this.app=t}return Py(e,[{key:"_delete",value:function(){return delete b3[this.app.options.appId],Promise.resolve()}}]),e}(),b3={},E3=[],P3={},S3="dataLayer",O3=!1;function T3(){return(T3=DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!XB()&&rz()&&tz()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,nz();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var I3="@firebase/analytics";Xz(new mz(H2,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(XB()&&e.push("This is a browser extension environment."),rz()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=e3.create("invalid-analytics-context",{errorInfo:t});q2.warn(n.message)}}();var r=e.options.appId;if(!r)throw e3.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw e3.create("no-api-key");q2.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=b3[r])throw e3.create("already-exists",{id:r});if(!O3){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(S3);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=DB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,Q2(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,Y2(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),q2.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(b3,E3,P3,S3,"gtag"),a=i.wrappedGtag,o=i.gtagCore;w3=a,C3=o,O3=!0}return b3[r]=function(e,t,n,r,i,a,o){return k3.apply(this,arguments)}(e,E3,P3,t,C3,S3,n),new _3(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Xz(new mz("analytics-internal",function(e){try{var t=e.getProvider(H2).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=pz(e),function(e,t,n,r,i){return v3.apply(this,arguments)}(w3,b3[e.app.options.appId],t,n,r).catch(function(e){return q2.error(e)})}(t,e,n,r)}}}catch(t){throw e3.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),aH(I3,"0.8.0"),aH(I3,"0.8.0","esm2017");var A3=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this)}return Py(n,[{key:"schedule",value:function(e){return this}}]),n}(Ey),M3={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=M3.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=M3.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},x3=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return Py(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return M3.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;M3.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,_y(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,cy(yy(n.prototype),"unsubscribe",this).call(this)}}}]),n}(A3),R3={now:function(){return(R3.delegate||Date).now()},delegate:void 0},N3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;by(this,e),this.schedulerActionCtor=t,this.now=n}return Py(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();N3.now=R3.now;var D3=function(e){fy(n,e);var t=dy(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N3.now;return by(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return Py(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(N3),L3=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n)}(D3))(function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Py(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?cy(yy(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?cy(yy(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?cy(yy(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(x3)),F3=new D3(x3),U3=new qO("7.4.1"),V3="__angularfire_symbol__analyticsIsSupportedValue",B3="__angularfire_symbol__analyticsIsSupported",z3="__angularfire_symbol__remoteConfigIsSupportedValue",H3="__angularfire_symbol__remoteConfigIsSupported",G3="__angularfire_symbol__messagingIsSupportedValue",$3="__angularfire_symbol__messagingIsSupported";function Z3(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[B3]||(globalThis[B3]=function(){return T3.apply(this,arguments)}().then(function(e){return globalThis[V3]=e}).catch(function(){return globalThis[V3]=!1})),globalThis[$3]||(globalThis[$3]=function(){return z2.apply(this,arguments)}().then(function(e){return globalThis[G3]=e}).catch(function(){return globalThis[G3]=!1})),globalThis[H3]||(globalThis[H3]=function(){return A0.apply(this,arguments)}().then(function(e){return globalThis[z3]=e}).catch(function(){return globalThis[z3]=!1}));var q3=function(e,t){var n=t?[t]:iH(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function W3(){}var j3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L3;by(this,e),this.zone=t,this.delegate=n}return Py(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),Y3=function(){function e(t){by(this,e),this.zone=t,this.task=null}return Py(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",W3,{},W3,W3)}),t.pipe(jN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),K3=function(){var e=Py(function e(t){by(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new j3(Zone.current)}),this.insideAngular=t.run(function(){return new j3(Zone.current,F3)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Ww(AI))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Q3(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function X3(e){return Q3().ngZone.runOutsideAngular(function(){return e()})}function J3(e){return Q3().ngZone.run(function(){return e()})}function e4(e){return Q3(),function(e){return function(t){return(t=t.lift(new Y3(e.ngZone))).pipe(Om(e.outsideAngular),Sm(e.insideAngular))}}(Q3())(e)}var t4=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),J3(function(){return e.apply(n,r)})}},n4=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=J3(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",W3,{},W3,W3)}))),i[a]=t4(i[a],n));var o=X3(function(){return e.apply(r,i)});if(!t){if(o instanceof Yy){var s=Q3();return o.pipe(Om(s.outsideAngular),Sm(s.insideAngular))}return J3(function(){return o})}return o instanceof Yy?o.pipe(e4):o instanceof Promise?J3(function(){return new Promise(function(e,t){return o.then(function(t){return J3(function(){return e(t)})},function(e){return J3(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:J3(function(){return o})}},r4=Py(function e(t){return by(this,e),t}),i4=Py(function e(){return by(this,e),iH()}),a4=new Ow("angularfire2._apps"),o4={provide:r4,useFactory:function(e){return e&&1===e.length?e[0]:new r4(rH())},deps:[[new t_,a4]]},s4={provide:i4,deps:[[new t_,a4]]};function u4(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new r4(r)}}var c4=function(){var e=Py(function e(t){by(this,e),aH("angularfire",U3.full,"core"),aH("angularfire",U3.full,"app"),aH("angular",WO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Ww(pI))},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[o4,s4]}),e}(),l4=n4(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:Wz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw eH.create("bad-app-name",{appName:String(r)});var i=Yz.get(r);if(i){if(sz(e,i.options)&&sz(n,i.config))return i;throw eH.create("duplicate-app",{appName:r})}var a,o=new wz(r),s=Cy(Kz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new tH(e,n,o);return Yz.set(r,c),c},!0),f4=new Map,h4={activated:!1,tokenObservers:[]},d4={initialized:!1,enabled:!1};function v4(e){return f4.get(e)||h4}function p4(e,t){f4.set(e,t)}function g4(){return d4}var y4=function(){function e(t,n,r,i,a){if(by(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return Py(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new YB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new YB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),m4=new az("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function k4(e){if(!v4(e).activated)throw m4.create("use-before-activation",{appName:e.name})}function C4(e,t){return w4.apply(this,arguments)}function w4(){return w4=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),m4.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw m4.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),m4.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw m4.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),w4.apply(this,arguments)}function _4(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var b4="firebase-app-check-store",E4=null;function P4(){return E4||(E4=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(m4.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(b4,{keyPath:"compositeKey"})}}catch(r){t(m4.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),E4)}function S4(){return S4=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P4();case 2:return r=e.sent.transaction(b4,"readwrite"),i=r.objectStore(b4).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(m4.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),S4.apply(this,arguments)}var O4=new Tz("@firebase/app-check");function T4(e,t){return tz()?function(e,t){return function(e,t){return S4.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){O4.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function I4(){return g4().enabled}function A4(){return M4.apply(this,arguments)}function M4(){return M4=DB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=g4()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),M4.apply(this,arguments)}var x4={error:"UNKNOWN_ERROR"};function R4(e){return WB.encodeString(JSON.stringify(e),!1)}function N4(e){return D4.apply(this,arguments)}function D4(){return D4=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],k4(r=t.app),i=v4(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&V4(s)&&(o=s);case 10:if(n||!o||!V4(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!I4()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=C4,e.t2=_4,e.t3=r,e.next=21,A4();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,T4(r,l);case 31:return p4(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?O4.warn(e.t7.message):O4.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},p4(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,T4(r,o);case 48:e.next=51;break;case 50:u=B4(a);case 51:return c&&U4(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),D4.apply(this,arguments)}function L4(e,t){var n=v4(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),p4(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function F4(e){var t=e.app,n=v4(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new y4(DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!v4(t).token){n.next=6;break}return n.next=3,N4(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,N4(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=v4(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),p4(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function U4(e,t){var n,r=Cy(v4(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function V4(e){return e.expireTimeMillis-Date.now()>0}function B4(e){return{token:R4(x4),error:e}}var z4=function(){function e(t,n){by(this,e),this.app=t,this.heartbeatServiceProvider=n}return Py(e,[{key:"_delete",value:function(){var e,t=Cy(v4(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;L4(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),H4="app-check-internal";Xz(new mz("app-check",function(e){return function(e,t){return new z4(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(H4).initialize()})),Xz(new mz(H4,function(e){return function(e){return{getToken:function(t){return N4(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=v4(i),o={next:n,error:void 0,type:"INTERNAL"};if(p4(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(my(a.tokenObservers),[o])})),a.token&&V4(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),F4(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return F4(e)})}(e,0,t)},removeTokenListener:function(t){return L4(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),aH("@firebase/app-check","0.5.11");var G4=Py(function e(){return by(this,e),q3("app-check")});"undefined"!=typeof window&&window;var $4=new az("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Z4=new Tz("@firebase/auth");function q4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Z4.logLevel<=bz.ERROR&&Z4.error.apply(Z4,["Auth (9.9.0): ".concat(e)].concat(n))}function W4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Q4.apply(void 0,[e].concat(n))}function j4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Q4.apply(void 0,[e].concat(n))}function Y4(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ry({},t,n));return new az("auth","Firebase",r).create(t,{appName:e.name})}function K4(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&W4(e,"argument-error"),Y4(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function Q4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=my(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(my(o)))}return $4.create.apply($4,[e].concat(n))}function X4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw Q4.apply(void 0,[t].concat(r))}function J4(e){var t="INTERNAL ASSERTION FAILED: "+e;throw q4(t),new Error(t)}function e5(e,t){e||J4(t)}var t5=new Map;function n5(e){e5(e instanceof Function,"Expected a class definition");var t=t5.get(e);return t?(e5(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,t5.set(e,t),t)}function r5(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function i5(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var a5=function(){function e(t,n){by(this,e),this.shortDelay=t,this.longDelay=n,e5(n>t,"Short delay should be less than long delay!"),this.isMobile=QB()||JB()}return Py(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===i5()||"https:"===i5()||XB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function o5(e,t){e5(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var s5=function(){function e(){by(this,e)}return Py(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void J4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void J4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void J4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),u5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},c5=new a5(3e4,6e4);function l5(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function f5(e,t,n,r){return h5.apply(this,arguments)}function h5(){return h5=DB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",d5(t,a,DB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=cz(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),s5.fetch()(y5(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),h5.apply(this,arguments)}function d5(e,t,n){return v5.apply(this,arguments)}function v5(){return v5=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},u5),n),e.prev=2,a=new m5(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw k5(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=iy(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw k5(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw k5(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw k5(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw Y4(t,d,h);case 25:W4(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof iz)){e.next=32;break}throw e.t0;case 32:W4(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),v5.apply(this,arguments)}function p5(e,t,n,r){return g5.apply(this,arguments)}function g5(){return g5=DB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,f5(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&W4(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),g5.apply(this,arguments)}function y5(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?o5(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var m5=function(){function e(t){var n=this;by(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(j4(n.auth,"network-request-failed"))},c5.get())})}return Py(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function k5(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=j4(e,t,r);return i.customData._tokenResponse=n,i}function C5(){return C5=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f5(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),C5.apply(this,arguments)}function w5(e,t){return _5.apply(this,arguments)}function _5(){return _5=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f5(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),_5.apply(this,arguments)}function b5(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function E5(){return E5=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=pz(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,X4((a=S5(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:b5(P5(a.auth_time)),issuedAtTime:b5(P5(a.iat)),expirationTime:b5(P5(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),E5.apply(this,arguments)}function P5(e){return 1e3*Number(e)}function S5(e){var t,n=iy(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return q4("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return WB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(q4("Failed to decode base64 JWT payload"),null)}catch(s){return q4("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function O5(e,t){return T5.apply(this,arguments)}function T5(){return T5=DB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof iz&&I5(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),T5.apply(this,arguments)}function I5(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var A5=function(){function e(t){by(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return Py(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),M5=function(){function e(t,n){by(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return Py(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=b5(this.lastLoginAt),this.creationTime=b5(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function x5(e){return R5.apply(this,arguments)}function R5(){return R5=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,O5(t,w5(r,{idToken:i}));case 6:X4(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?L5(o.providerUserInfo):[],u=D5(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new M5(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),R5.apply(this,arguments)}function N5(){return N5=DB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=pz(t),e.next=3,x5(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),N5.apply(this,arguments)}function D5(e,t){return[].concat(my(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),my(t))}function L5(e){return e.map(function(e){var t=e.providerId,n=im(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function F5(){return F5=DB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d5(t,{},DB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=cz({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=y5(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",s5.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),F5.apply(this,arguments)}var U5=function(){function e(){by(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Py(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){X4(e.idToken,"internal-error"),X4(void 0!==e.idToken,"internal-error"),X4(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=S5(e);return X4(t,"internal-error"),X4(void 0!==t.exp,"internal-error"),X4(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(X4(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return F5.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return J4("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(X4("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(X4("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(X4("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function V5(e,t){X4("string"==typeof e||void 0===e,"internal-error",{appName:t})}var B5=function(){function e(t){by(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=im(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new A5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?my(a.providerData):[],this.metadata=new M5(a.createdAt||void 0,a.lastLoginAt||void 0)}return Py(e,[{key:"getIdToken",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O5(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(X4(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return E5.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return N5.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(X4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){X4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,x5(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,O5(e,function(e,t){return C5.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,b=n.stsTokenManager;X4(k&&b,t,"internal-error");var E=U5.fromJSON(this.name,b);X4("string"==typeof k,t,"internal-error"),V5(f,t.name),V5(h,t.name),X4("boolean"==typeof C,t,"internal-error"),X4("boolean"==typeof w,t,"internal-error"),V5(d,t.name),V5(v,t.name),V5(p,t.name),V5(g,t.name),V5(y,t.name),V5(m,t.name);var P=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(P.providerData=_.map(function(e){return Object.assign({},e)})),g&&(P._redirectEventId=g),P}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return DB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new U5).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,x5(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),z5=function(){var e=function(){function e(){by(this,e),this.type="NONE",this.storage={}}return Py(e,[{key:"_isAvailable",value:function(){return DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function H5(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var G5=function(){function e(t,n,r){by(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=H5(this.userKey,a.apiKey,o),this.fullPersistenceKey=H5("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return Py(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?B5._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return DB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(n5(z5),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||n5(z5),s=H5(r,t.config.apiKey,t.name),u=null,c=Cy(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=B5._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function $5(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(j5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Z5(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(K5(t))return"Blackberry";if(Q5(t))return"Webos";if(q5(t))return"Safari";if((t.includes("chrome/")||W5(t))&&!t.includes("edge/"))return"Chrome";if(Y5(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function Z5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/firefox\//i.test(e)}function q5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function W5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/crios\//i.test(e)}function j5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/iemobile/i.test(e)}function Y5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/android/i.test(e)}function K5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/blackberry/i.test(e)}function Q5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/webos/i.test(e)}function X5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function J5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return X5(e)||Y5(e)||Q5(e)||K5(e)||/windows phone/i.test(e)||j5(e)}function e6(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=$5(KB());break;case"Worker":t="".concat($5(KB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var t6=function(){function e(t){by(this,e),this.auth=t,this.queue=[]}return Py(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=Cy(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=Cy(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),n6=function(){function e(t,n,r){by(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new i6(this),this.idTokenSubscription=new i6(this),this.beforeStateQueue=new t6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$4,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return Py(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=n5(t)),this._initializationPromise=this.queue(DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,G5.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return X4(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x5(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?pz(e):null,n.abrupt("return",(r&&X4(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&X4(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(n5(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new az("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return X4(r=e&&n5(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,G5.create(t,[n5(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return X4(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return X4(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=e6(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function r6(e){return pz(e)}var i6=function(){function e(t){var n,r=this;by(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new hz(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return Py(e,[{key:"next",get:function(){return X4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),a6=function(){function e(t,n){by(this,e),this.providerId=t,this.signInMethod=n}return Py(e,[{key:"toJSON",value:function(){return J4("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return J4("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return J4("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return J4("not implemented")}}]),e}();function o6(){return o6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),o6.apply(this,arguments)}function s6(){return s6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p5(t,"POST","/v1/accounts:signInWithPassword",l5(t,n)));case 1:case"end":return e.stop()}},e)})),s6.apply(this,arguments)}function u6(e,t){return c6.apply(this,arguments)}function c6(){return c6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f5(t,"POST","/v1/accounts:sendOobCode",l5(t,n)));case 1:case"end":return e.stop()}},e)})),c6.apply(this,arguments)}function l6(e,t){return f6.apply(this,arguments)}function f6(){return f6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u6(t,n));case 1:case"end":return e.stop()}},e)})),f6.apply(this,arguments)}function h6(e,t){return d6.apply(this,arguments)}function d6(){return d6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u6(t,n));case 1:case"end":return e.stop()}},e)})),d6.apply(this,arguments)}function v6(){return v6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p5(t,"POST","/v1/accounts:signInWithEmailLink",l5(t,n)));case 1:case"end":return e.stop()}},e)})),v6.apply(this,arguments)}function p6(){return p6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p5(t,"POST","/v1/accounts:signInWithEmailLink",l5(t,n)));case 1:case"end":return e.stop()}},e)})),p6.apply(this,arguments)}var g6=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return by(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return Py(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return s6.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return v6.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:W4(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return o6.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return p6.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:W4(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(a6);function y6(e,t){return m6.apply(this,arguments)}function m6(){return m6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p5(t,"POST","/v1/accounts:signInWithIdp",l5(t,n)));case 1:case"end":return e.stop()}},e)})),m6.apply(this,arguments)}var k6=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return Py(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return y6(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,y6(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,y6(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cz(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):W4("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=im(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(a6),C6=function(){function e(t){var n,r,i,a,o,s;by(this,e);var u=lz(fz(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);X4(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return Py(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=lz(fz(e)).link,n=t?lz(fz(t)).deep_link_id:null,r=lz(fz(e)).deep_link_id;return(r?lz(fz(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),w6=function(){var e=function(){function e(){by(this,e),this.providerId=e.PROVIDER_ID}return Py(e,null,[{key:"credential",value:function(e,t){return g6._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=C6.parseLink(t);return X4(n,"argument-error"),g6._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),_6=function(){function e(t){by(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return Py(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),b6=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).scopes=[],e}return Py(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return my(this.scopes)}}]),n}(_6),E6=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return Py(n,null,[{key:"credential",value:function(e,t){return k6._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(b6);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function P6(e,t){return S6.apply(this,arguments)}function S6(){return S6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p5(t,"POST","/v1/accounts:signUp",l5(t,n)));case 1:case"end":return e.stop()}},e)})),S6.apply(this,arguments)}var O6=function(){function e(t){by(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return Py(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return DB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,B5._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=T6(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=T6(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function T6(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var I6=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o,s;return by(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(py(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return Py(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(iz);function A6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?I6._fromErrorAndOperation(e,n,t,r):n})}function M6(e,t){return x6.apply(this,arguments)}function x6(){return x6=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=O5,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",O6._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),x6.apply(this,arguments)}function R6(){return R6=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,O5(t,A6(a,o,n,t),r);case 5:return X4((s=e.sent).idToken,a,"internal-error"),X4(u=S5(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(X4(t.uid===c,a,"user-mismatch"),O6._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&W4(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),R6.apply(this,arguments)}function N6(e,t){return D6.apply(this,arguments)}function D6(){return D6=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,A6(t,i,n);case 4:return a=e.sent,e.next=7,O6._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),D6.apply(this,arguments)}function L6(){return L6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N6(r6(t),n));case 1:case"end":return e.stop()}},e)})),L6.apply(this,arguments)}function F6(e,t,n){var r;X4((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),X4(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(X4(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(X4(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function U6(){return U6=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=pz(t),a={requestType:"PASSWORD_RESET",email:n},r&&F6(i,a,r),e.next=4,h6(i,a);case 4:case"end":return e.stop()}},e)})),U6.apply(this,arguments)}function V6(){return V6=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r6(t),e.next=3,P6(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,O6._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),V6.apply(this,arguments)}function B6(){return B6=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=pz(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&F6(r.auth,i,n),e.next=8,l6(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),B6.apply(this,arguments)}function z6(e,t){return H6.apply(this,arguments)}function H6(){return H6=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),H6.apply(this,arguments)}function G6(){return G6=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=pz(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,O5(a,z6(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),G6.apply(this,arguments)}new WeakMap;var $6="__sak",Z6=function(){function e(t,n){by(this,e),this.storageRetriever=t,this.type=n}return Py(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem($6,"1"),this.storage.removeItem($6),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),q6=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=KB();return q5(e)||X5(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=J5(),e._shouldAllowMigration=!0,e}return Py(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);ez()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return DB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,cy(yy(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,cy(yy(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,cy(yy(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(Z6);return e.type="LOCAL",e}(),W6=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return Py(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(Z6);return e.type="SESSION",e}(),j6=function(){var e=function(){function e(t){by(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return Py(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=DB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function Y6(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var K6=function(){function e(t){by(this,e),this.target=t,this.handlers=new Set}return Py(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return DB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=Y6("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function Q6(){return window}function X6(){return void 0!==Q6().WorkerGlobalScope&&"function"==typeof Q6().importScripts}function J6(){return(J6=DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var e8="firebaseLocalStorageDb",t8="firebaseLocalStorage",n8="fbase_key",r8=function(){function e(t){by(this,e),this.request=t}return Py(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function i8(e,t){return e.transaction([t8],t?"readwrite":"readonly").objectStore(t8)}function a8(){var e=indexedDB.open(e8,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(t8,{keyPath:n8})}catch(r){n(r)}}),e.addEventListener("success",DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(t8)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(e8);return new r8(e).toPromise()}();case 8:return n.t0=t,n.next=11,a8();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function o8(e,t,n){return s8.apply(this,arguments)}function s8(){return s8=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i8(t,!0).put((ry(i={},n8,n),ry(i,"value",r),i)),e.abrupt("return",new r8(a).toPromise());case 2:case"end":return e.stop()}},e)})),s8.apply(this,arguments)}function u8(){return u8=DB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i8(t,!1).get(n),e.next=3,new r8(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),u8.apply(this,arguments)}function c8(e,t){var n=i8(e,!0).delete(t);return new r8(n).toPromise()}var l8=function(){var e=function(){function e(){by(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return Py(e,[{key:"_openDb",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,a8();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",X6()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=j6._getInstance(X6()?self:null),e.receiver._subscribe("keyChanged",function(){var t=DB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=DB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return J6.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new K6(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return DB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,a8();case 5:return t=e.sent,e.next=8,o8(t,$6,"1");case 8:return e.next=10,c8(t,$6);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return o8(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return u8.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return c8(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=i8(e,!1).getAll();return new r8(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Cy(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function f8(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function h8(e,t){return t?n5(t):(X4(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}f8("rcb"),new a5(3e4,6e4);var d8=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,"custom","custom")).params=e,r}return Py(n,[{key:"_getIdTokenResponse",value:function(e){return y6(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return y6(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return y6(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(a6);function v8(e){return N6(e.auth,new d8(e),e.bypassAuthState)}function p8(e){var t=e.auth,n=e.user;return X4(n,t,"internal-error"),function(e,t){return R6.apply(this,arguments)}(n,new d8(e),e.bypassAuthState)}function g8(e){return y8.apply(this,arguments)}function y8(){return y8=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(X4(r,n,"internal-error"),M6(r,new d8(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),y8.apply(this,arguments)}var m8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];by(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return Py(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=DB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return v8;case"linkViaPopup":case"linkViaRedirect":return g8;case"reauthViaPopup":case"reauthViaRedirect":return p8;default:W4(this.auth,"internal-error")}}},{key:"resolve",value:function(e){e5(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){e5(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),k8=new a5(2e3,1e4);function C8(){return C8=DB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r6(t),K4(t,n,_6),a=h8(i,r),e.abrupt("return",new w8(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),C8.apply(this,arguments)}var w8=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=py(s),s}return Py(n,[{key:"executeNotNull",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(X4(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e5(1===e.filter.length,"Popup operations only handle one event"),n=Y6(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(j4(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(j4(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(j4(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,k8.get())}()}}]),n}(m8);return e.currentPopupAction=null,e}(),_8=new Map,b8=function(e){fy(n,e);var t=dy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return by(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return Py(n,[{key:"execute",value:function(){var e=this,t=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=_8.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return E8.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,cy(yy(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:_8.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||_8.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return cy(yy(n.prototype),"onAuthEvent",t)},i=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(m8);function E8(){return E8=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=O8(n),i=S8(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),E8.apply(this,arguments)}function P8(e,t){_8.set(e._key(),t)}function S8(e){return n5(e._redirectPersistence)}function O8(e){return H5("pendingRedirect",e.config.apiKey,e.name)}function T8(e,t){return I8.apply(this,arguments)}function I8(){return I8=DB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=r6(t),a=h8(i,n),e.next=5,new b8(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),I8.apply(this,arguments)}var A8=function(){function e(t){by(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return Py(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x8(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!x8(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(j4(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(M8(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(M8(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function M8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function x8(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function R8(e){return N8.apply(this,arguments)}function N8(){return N8=DB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",f5(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),N8.apply(this,arguments)}var D8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,L8=/^https?/;function F8(){return F8=DB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,R8(t);case 4:n=e.sent,r=n.authorizedDomains,i=Cy(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!U8(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:W4(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),F8.apply(this,arguments)}function U8(e){var t=r5(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!L8.test(r))return!1;if(D8.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var V8=new a5(3e4,6e4);function B8(){var e=Q6().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=my(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var z8=null;function H8(e){return z8=z8||function(e){return new Promise(function(t,n){var r,i,a;function o(){B8(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){B8(),n(j4(e,"network-request-failed"))},timeout:V8.get()})}if(null===(i=null===(r=Q6().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=Q6().gapi)||void 0===a?void 0:a.load)){var s=f8("iframefcb");return Q6()[s]=function(){gapi.load?o():n(j4(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=j4("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw z8=null,e})}(e),z8}var G8=new a5(5e3,15e3),$8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Z8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q8(e){var t=e.config;X4(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?o5(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:nH},i=Z8.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(cz(r).slice(1))}function W8(){return W8=DB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H8(t);case 2:return n=e.sent,r=Q6().gapi,e.abrupt("return",(X4(r,t,"internal-error"),n.open({where:document.body,url:q8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$8,dontclear:!0},function(e){return new Promise((n=DB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){Q6().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=j4(t,"network-request-failed"),o=Q6().setTimeout(function(){i(a)},G8.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),W8.apply(this,arguments)}var j8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Y8=function(){function e(t){by(this,e),this.window=t,this.associatedEvent=null}return Py(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function K8(e,t,n,r,i,a){X4(e.config.authDomain,e,"auth-domain-config-required"),X4(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:nH,eventId:i};if(t instanceof _6){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=iy(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof b6){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?o5(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(cz(d).slice(1))}var Q8="webStorageSupport",X8=function(){function e(){by(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=W6,this._completeRedirectFn=T8,this._overrideRedirectResult=P8}return Py(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e5(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=K8(e,t,n,r5(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},j8),{width:r.toString(),height:i.toString(),top:a,left:o}),c=KB().toLowerCase();n&&(s=W5(c)?"_blank":n),Z5(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=iy(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KB();return X5(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new Y8(null);var f=window.open(t||"",s,l);X4(f,e,"popup-blocked");try{f.focus()}catch(h){}return new Y8(f)}(e,s,Y6()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){Q6().location.href=e}(K8(e,t,n,r5(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(e5(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return W8.apply(this,arguments)}(e);case 2:return r=n.sent,i=new A8(e),n.abrupt("return",(r.register("authEvent",function(t){return X4(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(Q8,{type:Q8},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Q8];void 0!==i&&t(!!i),W4(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return F8.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return J5()||q5()||X5()}}]),e}(),J8="@firebase/auth",e7=function(){function e(t){by(this,e),this.auth=t,this.internalListeners=new Map}return Py(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){X4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){Xz(new mz("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){X4(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),X4(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:e6(e)},a=new n6(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(n5);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),Xz(new mz("auth-internal",function(e){var t=r6(e.getProvider("auth").getImmediate());return new e7(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),aH(J8,"0.20.5",void 0),aH(J8,"0.20.5","esm2017")}("Browser");var t7=Py(function e(t){return by(this,e),t}),n7=Py(function e(){return by(this,e),q3("auth")}),r7=new Ow("angularfire2.auth-instances");function i7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new t7(r)}}var a7={provide:n7,deps:[[new t_,r7]]},o7={provide:t7,useFactory:function(e,t){var n=Z3("auth",e,t);return n&&new t7(n)},deps:[[new t_,r7],r4]},s7=function(){var e=Py(function e(){by(this,e),aH("angularfire",U3.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[o7,a7]}),e}(),u7=n4(function(e,t,n){return V6.apply(this,arguments)},!0),c7=n4(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH(),t=Jz(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=Jz(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(sz(n.getOptions(),null!=t?t:{}))return r;W4(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:X8,persistence:[l8,q6,W6]})},!0),l7=n4(function(e,t,n,r){return pz(e).onAuthStateChanged(t,n,r)},!0),f7=n4(function(e,t){return B6.apply(this,arguments)},!0),h7=n4(function(e,t,n){return U6.apply(this,arguments)},!0),d7=n4(function(e,t,n){return function(e,t){return L6.apply(this,arguments)}(pz(e),w6.credential(t,n))},!0),v7=n4(function(e,t,n){return C8.apply(this,arguments)},!0),p7=n4(function(e,t){return G6.apply(this,arguments)},!0),g7=Py(function e(t){return by(this,e),t}),y7=new Ow("angularfire2.firestore-instances");function m7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new g7(r)}}var k7={provide:Py(function e(){return by(this,e),q3("firestore")}),deps:[[new t_,y7]]},C7={provide:g7,useFactory:function(e,t){var n=Z3("firestore",e,t);return n&&new g7(n)},deps:[[new t_,y7],r4]},w7=function(){var e=Py(function e(){by(this,e),aH("angularfire",U3.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({providers:[C7,k7]}),e}(),_7=n4(function(e,t){var n=cJ(e.firestore,mJ),r=pJ(e),i=o1(e.converter,t);return u1(n,[xJ(MJ(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,qj.exists(!1))]).then(function(){return r})},!0),b7=n4(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=pz(e),aJ("collection","path",t),e instanceof fJ){var a=Xq.fromString.apply(Xq,[t].concat(r));return sJ(a),new vJ(e,null,a)}if(!(e instanceof hJ||e instanceof vJ))throw new Lq(Dq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Xq.fromString.apply(Xq,[t].concat(r)));return sJ(o),new vJ(e.firestore,null,o)},!0),E7=n4(function(e){return u1(cJ(e.firestore,mJ),[new sY(e._key,qj.none())])},!0),P7=n4(pJ,!0),S7=n4(function(e){e=cJ(e,hJ);var t=cJ(e.firestore,mJ);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Fq;return e.asyncQueue.enqueueAndForget(DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new qX({next:function(a){t.enqueueAndForget(function(){return nX(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new Lq(Dq.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new Lq(Dq.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new sX(yj(n.path),a,{includeMetadataChanges:!0,Du:!0});return eX(e,o)},i.next=3,nJ(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(kJ(t),e._key).then(function(n){return c1(t,e,n)})},!0),O7=n4(function(e){e=cJ(e,dJ);var t=cJ(e.firestore,mJ),n=kJ(t),r=new s1(t);return XJ(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Fq;return e.asyncQueue.enqueueAndForget(DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new qX({next:function(n){t.enqueueAndForget(function(){return nX(e,o)}),n.fromCache&&"server"===r.source?i.reject(new Lq(Dq.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new sX(n,a,{includeMetadataChanges:!0,Du:!0});return eX(e,o)},i.next=3,nJ(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new KJ(t,r,e,n)})},!0),T7=n4(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH();return Jz(e,"firestore").getImmediate()},!0),I7=n4(function(e){return function(e,t){if(t<=0)throw new Lq(Dq.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new n1("limit",e,"F")},!0),A7=n4(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=pz(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||yJ(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(yJ(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof hJ)l=cJ(e.firestore,mJ),f=yj(e._key.path),c={next:function(t){n[u]&&n[u](c1(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=cJ(e,dJ);l=cJ(v.firestore,mJ),f=v._query;var p=new s1(l);c={next:function(e){n[u]&&n[u](new KJ(l,p,v,e))},error:n[u+1],complete:n[u+2]},XJ(e._query)}return function(e,t,n,r){var i=new qX(r),a=new sX(t,i,n);return e.asyncQueue.enqueueAndForget(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=eX,t.next=3,nJ(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=nX,t.next=3,nJ(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(kJ(l),f,h,c)},!0),M7=n4(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=qJ("orderBy",e);return new t1(r,n)},!0),x7=n4(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),R7=n4(function(e,t,n){e=cJ(e,hJ);var r=cJ(e.firestore,mJ),i=o1(e.converter,t,n);return u1(r,[xJ(MJ(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,qj.none())])},!0),N7=n4(function(e,t,n){e=cJ(e,hJ);for(var r,i=cJ(e.firestore,mJ),a=MJ(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=pz(t))||t instanceof wJ?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[VJ(t,r,n)],u=[i];if(a.length%2!=0)throw new Lq(Dq.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(VJ(t,a[c])),u.push(a[c+1]);for(var l=[],f=jW.empty(),h=s.length-1;h>=0;--h)if(!GJ(l,s[h])){var d=s[h],v=u[h];v=pz(v);var p=o.ia(d);if(v instanceof RJ)l.push(d);else{var g=DJ(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new kW(l);return new OJ(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);UJ("Data must be an object, but it was:",i,r);var a=[],o=jW.empty();hW(r,function(e,r){var s=zJ(t,e,n);r=pz(r);var u=i.ia(s);if(r instanceof RJ)a.push(s);else{var c=DJ(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new kW(a);return new OJ(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),u1(i,[r.toMutation(e._key,qj.exists(!0))])},!0),D7=n4(function(e,t,n){var r=t,i=qJ("where",e);return new e1(i,r,n)},!0),L7=function(){var e=function(){function e(t,n){by(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=b7(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return Py(e,[{key:"create",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,_7(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,S7(P7(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?zB.of(LB.getNonNullable(i.data())):zB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(FB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),N7(P7(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return FB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),E7(P7(this.collection,t))}},{key:"set",value:function(t,n){return FB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),R7(P7(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return new Ey(A7(P7(this.collection,e),function(e){t(zB.ofNullable(e.data()))}))}},{key:"findWhere",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,O7(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;FB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return new Ey(A7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(FB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(FB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(FB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))}))}},{key:"constructQuery",value:function(e,t,n){var r=x7(this.collection);null!=t&&(r=x7(r,M7(t))),null!=n&&(r=x7(r,I7(n)));var i,a=Cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=x7(r,D7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,r,e)}return Py(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),F7=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),r=t.call(this,"chats",e),FB(n.VERBOSE,"ChatDAO.constructor"),r}return Py(n)}(L7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(g7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),U7=function(){var n=Py(function e(){by(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=ey(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=ey(["This message is forbidden."])))},n}(),V7=function(){var e=function(){function e(t){by(this,e),this.chatDAO=t,FB(e.VERBOSE,"ChatService.constructor")}return Py(e,[{key:"addMessage",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}},{key:"deleteChat",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(FB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!1!==i.userCanSendMessage(t.name,e)){a.next=2;break}return a.abrupt("return",ZB.failure(U7.CANNOT_SEND_MESSAGE()));case 2:if(!i.isForbiddenMessage(n)){a.next=4;break}return a.abrupt("return",ZB.failure(U7.FORBIDDEN_MESSAGE()));case 4:return o={content:n,sender:t,postedTime:l1(),currentTurn:r},a.next=7,i.addMessage(e,o);case 7:return a.abrupt("return",ZB.SUCCESS);case 8:case"end":return a.stop()}},a)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(F7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B7=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,"errors",e)}return Py(n)}(L7);return e.\u0275fac=function(t){return new(t||e)(Ww(g7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),z7=oy(5378),H7=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,z7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),G7=function(){function e(t,n,r){by(this,e),this.errorDAO=t,this.router=n,this.messageDisplayer=r,e.setSingletonInstance(this)}return Py(e,[{key:"findErrors",value:function(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}},{key:"logError",value:function(e,t,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(n||(n=ey(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.findErrors(e,o,t,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:e,route:o,message:t,firstEncounter:l1(),lastEncounter:l1(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:l1(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=zB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),ZB.failure(e+": "+t)}}]),e}();function $7(e,t){if(!1===e)throw G7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}G7.singleton=zB.empty(),G7.\u0275fac=function(e){return new(e||G7)(Ww(B7),Ww(EF),Ww(H7))},G7.\u0275prov=Zm({token:G7,factory:G7.\u0275fac,providedIn:"root"});var Z7=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),r=t.call(this,n.COLLECTION_NAME,e),FB(n.VERBOSE,"UserDAO.constructor"),r}return Py(n)}(L7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Ww(g7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),q7=function(){var e=function(){function e(t){by(this,e),this.userDAO=t}return Py(e,[{key:"usernameIsAvailable",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.userDAO.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",zB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",($7(null!=i,"should not receive a lastUpdateTime equal to null"),zB.of(i)));case 7:case"end":return n.stop()}},n)}))()}},{key:"updatePresenceToken",value:function(e){return this.userDAO.update(e,{lastUpdateTime:l1()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(Z7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),W7=function(e){fy(n,e);var t=dy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R3;return by(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return Py(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),cy(yy(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Xy),j7=function(){var e=Py(function e(){by(this,e)});return e.YOU_ARE_ALREADY_PLAYING=function(){return $localize(r||(r=ey(["You are already playing in another game."])))},e.YOU_ARE_ALREADY_CREATING=function(){return $localize(i||(i=ey(["You are already the creator of another game."])))},e.YOU_ARE_ALREADY_CHOSEN_OPPONENT=function(){return $localize(a||(a=ey(["You are already the chosen opponent in another game."])))},e.YOU_ARE_ALREADY_CANDIDATE=function(){return $localize(o||(o=ey(["You are already candidate in another game."])))},e.YOU_ARE_ALREADY_OBSERVING=function(){return $localize(s||(s=ey(["You are already observing another game."])))},e}(),Y7=function(){function e(){by(this,e)}return Py(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return u7(e,t,n)}},{key:"sendEmailVerification",value:function(e){return f7(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return h7(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d7(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v7(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return p7(e,t)}}]),e}(),K7=function(){function e(t,n,r,i){by(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return Py(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}},{key:"equals",value:function(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}]),e}();K7.NOT_CONNECTED=new K7("",zB.empty(),zB.empty(),!1);var Q7=function(){var e=function(){function e(t,n,r){by(this,e);var i,a=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=zB.empty(),this.userSubscription=new Ey,FB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new W7(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new Ey(l7(this.auth,(i=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(FB(e.VERBOSE,"User is not connected"),a.userSubscription.unsubscribe(),a.userRS.next(K7.NOT_CONNECTED),a.user=zB.empty()):($7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),a.userSubscription=a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get(),i=r.username;FB(e.VERBOSE,"User ".concat(i," is connected, and the verified status is ").concat(a.emailVerified(n)));var o=!0===a.emailVerified(n)&&null!=i;if(!0===o&&!1===r.verified)return a.userService.markAsVerified(n.uid);var s=new K7(n.uid,zB.ofNullable(n.email),zB.ofNullable(i),o);!1===a.user.equalsValue(s)&&(a.user=zB.of(s),a.userRS.next(s))}}));case 1:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)})))}return Py(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Y7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",ZB.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",ZB.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return FB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),a.next=3,i.userService.usernameIsAvailable(t);case 3:if(!a.sent){a.next=7;break}a.t0=i.registerAfterUsernameCheck(t,n,r),a.next=8;break;case 7:a.t0=HB.failure($localize(u||(u=ey(["This username is already in use."]))));case 8:return a.abrupt("return",a.t0);case 9:case"end":return a.stop()}},a)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Y7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,Y7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=LB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",HB.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",HB.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(c||(c=ey(["This email address is already in use."])));case"auth/invalid-email":return $localize(l||(l=ey(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(f||(f=ey(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(h||(h=ey(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(d||(d=ey(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(v||(v=ey(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(p||(p=ey(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(g||(g=ey(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return G7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(FB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=zB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",G7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",G7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,Y7.sendEmailVerification(r.get());case 9:return n.abrupt("return",ZB.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",ZB.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return FB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,Y7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",ZB.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",ZB.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=ZB,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new E6).addScope("profile"),n.addScope("email"),t.next=5,Y7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",HB.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",HB.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!zB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=ZB.SUCCESS,t.next=7;break;case 6:t.t0=ZB.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"subscribeToUser",value:function(e){return this.userObs.subscribe(e)}},{key:"setUsername",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",ZB.failure($localize(y||(y=ey(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userService.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",ZB.failure($localize(m||(m=ey(["This username is already in use, please select a different one."])))));case 9:return r=LB.getNonNullable(t.auth.currentUser),n.next=12,Y7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userService.setUsername(r.uid,e);case 14:return n.next=16,t.userService.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",ZB.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",ZB.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=LB.getNonNullable(t.auth.currentUser),n.next=4,Y7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",ZB.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",ZB.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=LB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"sendPresenceToken",value:function(){return $7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(Z7),Ww(q7),Ww(t7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),X7=Py(function e(t){by(this,e),this.value=t});X7.HARD_DRAW=new X7(0),X7.RESIGN=new X7(1),X7.ESCAPE=new X7(2),X7.VICTORY=new X7(3),X7.TIMEOUT=new X7(4),X7.UNACHIEVED=new X7(5),X7.AGREED_DRAW_BY_ZERO=new X7(6),X7.AGREED_DRAW_BY_ONE=new X7(7);var J7=function(){function e(t,n){by(this,e),this.id=t,this.data=n}return Py(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===X7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===X7.AGREED_DRAW_BY_ZERO.value||this.data.result===X7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===X7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:($7(this.data.result===X7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),LB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===X7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===X7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===X7.RESIGN.value}},{key:"getWinner",value:function(){return zB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return zB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,ny(ny({},this.data),{},{winner:t,loser:n}))}}]),e}(),e9=function(){function e(t){by(this,e),this.value=t}return Py(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return $7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();e9.CREATOR=new e9("CREATOR"),e9.RANDOM=new e9("RANDOM"),e9.CHOSEN_PLAYER=new e9("CHOSEN_PLAYER");var t9=function(){function e(t){by(this,e),this.value=t}return Py(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();t9.STANDARD=new t9("STANDARD"),t9.BLITZ=new t9("BLITZ"),t9.CUSTOM=new t9("CUSTOM"),t9.NORMAL_MOVE_DURATION=120,t9.NORMAL_PART_DURATION=1800,t9.BLITZ_MOVE_DURATION=30,t9.BLITZ_PART_DURATION=900;var n9=Py(function e(t){by(this,e),this.value=t});n9.PART_CREATED=new n9(0),n9.CONFIG_PROPOSED=new n9(2),n9.PART_STARTED=new n9(3),n9.PART_FINISHED=new n9(4);var r9=Py(function e(){by(this,e)}),i9=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return $7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){fy(s,n);var o=dy(s);function s(){return by(this,s),o.apply(this,arguments)}return Py(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=LB.getNonNullable(n).type,a=LB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(r9),a9=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return $7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){fy(a,n);var i=dy(a);function a(){return by(this,a),i.apply(this,arguments)}return Py(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){fy(a,n);var i=dy(a);function a(){return by(this,a),i.apply(this,arguments)}return Py(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){fy(a,n);var i=dy(a);function a(){return by(this,a),i.apply(this,arguments)}return Py(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){fy(r,t);var n=dy(r);function r(){return by(this,r),n.apply(this,arguments)}return Py(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(i9);a9.booleanEncoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(a9));var o9=function(){function e(){by(this,e),this.value=2}return Py(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PLAYER_NONE"}},{key:"equals",value:function(e){return this===e}}]),e}();o9.NONE=new o9;var s9,u9=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return this===e.ZERO?"PLAYER_ZERO":(LB.expectToBe(this,e.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(LB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(LB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();u9.numberEncoder=a9.ofN(2,function(e){return e.value},function(e){return 2===e?s9.NONE:u9.of(e)}),u9.ZERO=new u9(0),u9.ONE=new u9(1),u9.PLAYERS=[u9.ZERO,u9.ONE],function(e){e.ZERO=u9.ZERO,e.ONE=u9.ONE,e.NONE=o9.NONE}(s9||(s9={}));var c9=function(){function e(){by(this,e)}return Py(e,null,[{key:"rematchAccepted",value:function(e,t){return l9("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return u9.of(LB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return LB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return LB.getNonNullable(e.data).partId}}]),e}();function l9(e,t){return{code:e,data:t}}function f9(e){return function(t){return l9(e,{player:t.value})}}c9.drawProposed=f9("DrawProposed"),c9.drawRefused=f9("DrawRefused"),c9.takeBackAsked=f9("TakeBackAsked"),c9.takeBackRefused=f9("TakeBackRefused"),c9.takeBackAccepted=f9("TakeBackAccepted"),c9.rematchProposed=f9("RematchProposed"),c9.addTurnTime=f9("AddTurnTime"),c9.addGlobalTime=f9("AddGlobalTime");var h9=function(){function e(){by(this,e)}return Py(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===BB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),d9=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),r=t.call(this,"parts",e),FB(n.VERBOSE,"PartDAO.constructor"),r}return Py(n)}(L7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(g7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),v9=Py(function e(t,n,r){by(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),p9=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),r=t.call(this,"config-room",e),FB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return Py(n)}(L7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(g7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),g9=function(){var e=function(){function e(t,n){by(this,e),this.configRoomDAO=t,this.connectedUserService=n,FB(e.VERBOSE,"ConfigRoomService.constructor")}return Py(e,[{key:"addCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}},{key:"subscribeToChanges",value:function(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new v9(function(e){var r,i=Cy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Cy(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Cy(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}},{key:"createInitialConfigRoom",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:e9.RANDOM.value,partType:t9.STANDARD.value,partStatus:n9.PART_CREATED.value,maximalMoveDuration:t9.NORMAL_MOVE_DURATION,totalPartDuration:t9.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=ZB.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.addCandidate(t,i);case 13:r.t0=ZB.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"cancelJoining",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"ConfigRoomService.cancelJoining(".concat(t,")")),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if((a=r.sent).isAbsent()){r.next=10;break}return s=a.get(),u=[n.removeCandidate(t,i)],(null===(o=s.chosenOpponent)||void 0===o?void 0:o.id)===i.id&&u.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:n9.PART_CREATED.value})),r.next=10,Promise.all(u);case 10:case"end":return r.stop()}},r)}))()}},{key:"deleteConfigRoom",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return FB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(".concat(t)),i.next=3,Promise.all(n.map(function(e){return r.removeCandidate(t,e)}));case 3:return i.next=5,r.configRoomDAO.delete(t);case 5:case"end":return i.stop()}},i)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a,o){var s=this;return DB(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(FB(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:a,totalPartDuration:o}}),s.configRoomDAO.update(t,{partStatus:n9.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:a.value})));case 1:case"end":return u.stop()}},u)}))()}},{key:"setChosenOpponent",value:function(t,n){return FB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t,", ").concat(n.name,")")),this.configRoomDAO.update(t,{chosenOpponent:n})}},{key:"reviewConfig",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(FB(e.VERBOSE,"ConfigRoomService.reviewConfig(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:n9.PART_CREATED.value})));case 1:case"end":return r.stop()}},r)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(FB(e.VERBOSE,"ConfigRoomService.reviewConfigAndRemoveChosenOpponent(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:n9.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t){return FB(e.VERBOSE,"ConfigRoomService.acceptConfig(".concat(t)),this.configRoomDAO.update(t,{partStatus:n9.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(FB(e.VERBOSE,"ConfigRoomService.create(".concat(t)+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"ConfigRoomService.readConfigRoomById(".concat(t,")")),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(k||(k=ey(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(Ww(p9),Ww(Q7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),y9=function(){var e=function(){function e(t,n,r,i){by(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,FB(e.VERBOSE,"GameService.constructor")}return Py(e,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=ny(ny({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.partDAO.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"getPartValidity",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?ZB.failure("NONEXISTENT_PART"):i.get().typeGame===t?ZB.SUCCESS:ZB.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){FB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:X7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return FB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){FB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=e9.of(e.firstPlayer);return r===e9.RANDOM&&(r=Math.random()<.5?e9.CREATOR:e9.CHOSEN_PLAYER),r===e9.CREATOR?(t=e.creator,n=LB.getNonNullable(e.chosenOpponent)):(t=LB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:l1(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return FB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return FB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig(t);case 3:return i.abrupt("return",r.startGameWithConfig(t,u9.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"subscribeToChanges",value:function(e,t){return this.partDAO.subscribeToChanges(e,t)}},{key:"resign",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:X7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:X7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,c9.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===u9.ZERO?X7.AGREED_DRAW_BY_ZERO:X7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,c9.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,c9.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return FB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=LB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=LB.getNonNullable(o.playerOne),u=e9.CHOSEN_PLAYER):(l=o.playerZero,u=e9.CREATOR),f=ny(ny({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:n9.PART_STARTED.value}),h=i.getStartingConfig(f),d=ny({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:X7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,c9.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,c9.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return $7(c9.getPlayer(LB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=c9.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:l1(),remainingMsForZero:LB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:LB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=c9.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:c9.addGlobalTime(r.getOpponent())},o=r===u9.ZERO?ny(ny({},o),{},{remainingMsForOne:LB.getNonNullable(n.remainingMsForOne)+3e5}):ny(ny({},o),{},{remainingMsForZero:LB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:c9.addTurnTime(e.getOpponent())},i.next=3,r.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return DB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return FB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=h9.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:l1()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=ny(ny({},p),{},{winner:s,loser:u,result:X7.VICTORY.value}):!0===o&&(p=ny(ny({},p),{},{result:X7.HARD_DRAW.value})),l.next=14,c.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?ny(ny({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?ny(ny({},e),{},{remainingMsForZero:LB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?ny(ny({},e),{},{remainingMsForOne:LB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(d9),Ww(Q7),Ww(g9),Ww(V7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),m9={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},k9={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},C9={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},w9=function(){function e(){by(this,e)}return Py(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),_9=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return zB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return w9.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),b9=function(){var e=function(){function e(t,n){by(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return Py(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return zB.of(t)}return zB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(sA),Ww(_9))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),E9={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},P9={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},S9={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},O9={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},T9={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},I9={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},A9={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]},M9=function(){function e(){by(this,e)}return Py(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return BB(t,e)})||t.push(e)}),t}}]),e}(),x9=function(e){function t(e){by(this,t),this.values=void 0===e?[]:M9.toComparableSet(e)}return Py(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Cy(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Cy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Cy(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Cy(this.values);try{for(n.s();!(t=n.n()).done;){if(BB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Cy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?zB.of(this.values[0]):zB.empty()}},{key:"isEmpty",value:function(){return 0===this.values.length}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),R9=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];by(this,e),this.map=t,this.isImmutable=n}return Py(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Cy(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(BB(r.key,e))return zB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return zB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Cy(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Cy(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(BB(i.key,e)){var a=i.value;return i.value=t,zB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),zB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return BB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new x9(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Cy(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(BB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Cy(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Cy(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if($7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===BB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),N9=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"reverse",value:function(){var e,t=new n,r=Cy(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new x9;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(R9),D9=function(){function e(t,n){var r=this;by(this,e),this.userDAO=t,this.connectedUserService=n,this.userSubscription=new Ey,this.observedPartLoading=!0,this.observedPart=zB.empty(),this.observedPartRS=new W7(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(e){r.onUserUpdate(e)})}return Py(e,[{key:"onUserUpdate",value:function(e){var t=this;e===K7.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(zB.empty())):this.userSubscription=this.userDAO.subscribeToChanges(e.id,function(e){$7(e.isPresent(),"When observing part service, user was expected to already have a document!");var n=e.get();t.updateObservedPartWithDoc(n.observedPart)})}},{key:"updateObservedPartWithDoc",value:function(e){var t=this.observedPart,n=null==e&&t.isAbsent(),r=null!=e&&t.equalsValue(e);(!1===n&&!1===r||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=zB.ofNullable(e),this.observedPartRS.next(this.observedPart))}},{key:"updateObservedPart",value:function(e){var t=ny(ny({},this.observedPart.getOrElse(e)),e);return $7(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}},{key:"removeObservedPart",value:function(){return $7(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}},{key:"subscribeToObservedPart",value:function(e){return this.observedPartObs.subscribe(e)}},{key:"canUserCreate",value:function(){if(this.observedPart.isAbsent())return ZB.SUCCESS;var t=e.roleToMessage.get(this.observedPart.get().role).get()();return ZB.failure(t)}},{key:"canUserJoin",value:function(t,n){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return ZB.SUCCESS;if(n&&"Observer"===this.observedPart.get().role)return ZB.SUCCESS;var r=e.roleToMessage.get(this.observedPart.get().role).get()();return ZB.failure(r)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();function L9(e){return(L9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){F9(e,t,n[t])})}return e}function V9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}D9.roleToMessage=new R9([{key:"Candidate",value:j7.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:j7.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:j7.YOU_ARE_ALREADY_CREATING},{key:"Player",value:j7.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:j7.YOU_ARE_ALREADY_OBSERVING}]),D9.\u0275fac=function(e){return new(e||D9)(Ww(Z7),Ww(Q7))},D9.\u0275prov=Zm({token:D9,factory:D9.\u0275fac,providedIn:"root"});var B9={},z9={};try{"undefined"!=typeof window&&(B9=window),"undefined"!=typeof document&&(z9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Jme){}var H9=(B9.navigator||{}).userAgent,G9=void 0===H9?"":H9,$9=B9,Z9=z9,q9=!!Z9.documentElement&&!!Z9.head&&"function"==typeof Z9.addEventListener&&"function"==typeof Z9.createElement,W9=(~G9.indexOf("MSIE")||G9.indexOf("Trident/"),"___FONT_AWESOME___"),j9="svg-inline--fa",Y9=[1,2,3,4,5,6,7,8,9,10],K9=Y9.concat([11,12,13,14,15,16,17,18,19,20]),Q9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},X9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",Q9.GROUP,Q9.SWAP_OPACITY,Q9.PRIMARY,Q9.SECONDARY].concat(Y9.map(function(e){return"".concat(e,"x")})).concat(K9.map(function(e){return"w-".concat(e)})),$9.FontAwesomeConfig||{});Z9&&"function"==typeof Z9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=V9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=Z9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(X9[n]=r)});var J9=U9({},{familyPrefix:"fa",replacementClass:j9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},X9);J9.autoReplaceSvg||(J9.observeMutations=!1);var eee=U9({},J9);$9.FontAwesomeConfig=eee;var tee=$9||{};tee[W9]||(tee[W9]={}),tee[W9].styles||(tee[W9].styles={}),tee[W9].hooks||(tee[W9].hooks={}),tee[W9].shims||(tee[W9].shims=[]);var nee=tee[W9],ree=[];q9&&((Z9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Z9.readyState)||Z9.addEventListener("DOMContentLoaded",function e(){Z9.removeEventListener("DOMContentLoaded",e),ree.map(function(e){return e()})}));var iee,aee="pending",oee="fulfilled",see="rejected",uee=function(){},cee="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,lee="undefined"==typeof setImmediate?setTimeout:setImmediate,fee=[];function hee(){for(var e=0;e<fee.length;e++)fee[e][0](fee[e][1]);fee=[],iee=!1}function dee(e,t){fee.push([e,t]),iee||(iee=!0,lee(hee,0))}function vee(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=oee;try{r=i(r)}catch(o){mee(a,o)}}pee(a,r)||(n===oee&&gee(a,r),n===see&&mee(a,r))}function pee(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===L9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?yee(e,r):gee(e,r))},function(t){n||(n=!0,mee(e,t))}),!0}}catch(i){return n||mee(e,i),!0}return!1}function gee(e,t){(e===t||!pee(e,t))&&yee(e,t)}function yee(e,t){e._state===aee&&(e._state="settled",e._data=t,dee(Cee,e))}function mee(e,t){e._state===aee&&(e._state="settled",e._data=t,dee(wee,e))}function kee(e){e._then=e._then.forEach(vee)}function Cee(e){e._state=oee,kee(e)}function wee(e){e._state=see,kee(e),!e._handled&&cee&&global.process.emit("unhandledRejection",e._data,e)}function _ee(e){global.process.emit("rejectionHandled",e)}function bee(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof bee))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){mee(t,e)}try{e(function(e){gee(t,e)},n)}catch(r){n(r)}}(e,this)}bee.prototype={constructor:bee,_state:aee,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(uee),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===see&&cee&&dee(_ee,this)),this._state===oee||this._state===see?dee(vee,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},bee.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new bee(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},bee.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new bee(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},bee.resolve=function(e){return e&&"object"===L9(e)&&e.constructor===bee?e:new bee(function(t){t(e)})},bee.reject=function(e){return new bee(function(t,n){n(e)})};var Eee={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Pee(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function See(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Oee(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function Tee(e){return e.size!==Eee.size||e.x!==Eee.x||e.y!==Eee.y||e.rotate!==Eee.rotate||e.flipX||e.flipY}function Iee(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var Aee={x:0,y:0,width:"100%",height:"100%"};function Mee(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function xee(e){return"g"===e.tag?e.children:[e]}function Ree(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[eee.replacementClass,a?"".concat(eee.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:U9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||Pee())},children:[u]});var _=U9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:U9({},w,f.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=Iee({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:U9({},Aee,{fill:"white"})},l=o.children?{children:o.children.map(Mee)}:{},f={tag:"g",attributes:U9({},u.inner),children:[Mee(U9({tag:o.tag,attributes:U9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:U9({},u.outer),children:[f]},d="mask-".concat(a||Pee()),v="clip-".concat(a||Pee()),p={tag:"mask",attributes:U9({},Aee,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:xee(s)},p]};return t.push(g,{tag:"rect",attributes:U9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},Aee)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=Oee(e.styles);if(a.length>0&&(n.style=a),Tee(i)){var o=Iee({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:U9({},o.outer),children:[{tag:"g",attributes:U9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:U9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),E=b.attributes;return _.children=b.children,_.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:U9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(eee.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(Tee(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=Oee(U9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var Nee=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function Dee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof nee.hooks.addPack||i?nee.styles[e]=U9({},nee.styles[e]||{},a):nee.hooks.addPack(e,a),"fas"===e&&Dee("fa",t)}var Lee=nee.styles,Fee=nee.shims,Uee=function(){var e=function(e){return Nee(Lee,function(t,n,r){return t[r]=Nee(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in Lee;Nee(Fee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function Vee(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function Bee(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?See(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(See(e[n]),'" ')},"").trim()}(r),">").concat(a.map(Bee).join(""),"</").concat(t,">")}function zee(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}Uee(),(zee.prototype=Object.create(Error.prototype)).constructor=zee;var Hee={fill:"currentColor"},Gee={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},$ee=(U9({},Hee,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),U9({},Gee,{attributeName:"opacity"}));function Zee(e){var t=e[0],n=e[1],r=V9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(eee.familyPrefix,"-").concat(Q9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(eee.familyPrefix,"-").concat(Q9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(eee.familyPrefix,"-").concat(Q9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}U9({},Hee,{cx:"256",cy:"364",r:"28"}),U9({},Gee,{attributeName:"r",values:"28;14;28;28;14;28;"}),U9({},$ee,{values:"1;0;1;1;0;1;"}),U9({},Hee,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),U9({},$ee,{values:"1;0;0;0;0;1;"}),U9({},Hee,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),U9({},$ee,{values:"0;0;1;1;0;0;"});var qee=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=U9({},e.definitions[t]||{},i[t]),Dee(t,i[t]),Uee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function Wee(){eee.autoAddCss&&!Qee&&(function(e){if(e&&q9){var t=Z9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=Z9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}Z9.head.insertBefore(t,r)}}(function(){var e="fa",t=j9,n=eee.familyPrefix,r=eee.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Qee=!0)}function jee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return Bee(e)})}}),Object.defineProperty(e,"node",{get:function(){if(q9){var t=Z9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Yee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return Vee(Kee.definitions,n,r)||Vee(nee.styles,n,r)}var Kee=new qee,Qee=!1,Xee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Yee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Yee(i||{})),e(r,U9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Eee:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return jee(U9({type:"icon"},e),function(){return Wee(),eee.autoA11y&&(f?y["aria-labelledby"]="".concat(eee.replacementClass,"-title-").concat(d||Pee()):(y["aria-hidden"]="true",y.focusable="false")),Ree({icons:{main:Zee(_),mask:s?Zee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:U9({},Eee,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Jee=["*"],ete=function(e){var t,n=(ry(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),ry(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),ry(t,"fa-pull-".concat(e.pull),null!==e.pull),ry(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},tte=function(){var e=Py(function e(){by(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),nte=function(){var e=function(){function e(){by(this,e),this.definitions={}}return Py(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Cy(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,my(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),rte=function(){var e=function(){function e(){by(this,e),this.stackItemSize="1x"}return Py(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ok({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Bk]}),e}(),ite=function(){var e=function(){function e(t,n){by(this,e),this.renderer=t,this.elementRef=n}return Py(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(GO),IP(BO))},e.\u0275cmp=wk({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Bk],ngContentSelectors:Jee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=lC()[16][6];if(!t.projection)for(var n=t.projection=Nw(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=lC(),i=fC(),a=rE(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),mC(),64!=(64&a.flags)&&function(e,t,n){xb(t[11],0,t,n,vb(e,n,t),Cb(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),ate=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return Py(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(my(ete(e)),my(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Xee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(KM),IP(tte),IP(nte),IP(rte,8),IP(ite,8))},e.\u0275cmp=wk({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(CS("innerHTML",t.renderedIconHTML,V_),_P("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Bk],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),ote=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e}),e.\u0275inj=qm({}),e}();function ste(e,t){if(1&e&&(DP(0),bO(1,27),LP()),2&e){var n=GP(2);Wb(1),EO(n.observedPart.get().typeGame)(null==n.observedPart.get().opponent?null:n.observedPart.get().opponent.name),PO(1)}}function ute(e,t){if(1&e&&(DP(0),bO(1,29),LP()),2&e){var n=GP(3);Wb(1),EO(n.observedPart.get().typeGame)(null==n.observedPart.get().opponent?null:n.observedPart.get().opponent.name),PO(1)}}function cte(e,t){if(1&e&&(DP(0),bO(1,30),LP()),2&e){var n=GP(3);Wb(1),EO(n.observedPart.get().typeGame),PO(1)}}function lte(e,t){if(1&e&&(OP(0,ute,2,2,"ng-container",23),OP(1,cte,2,1,"ng-template",null,28,uI)),2&e){var n=TP(2);AP("ngIf",GP(2).observedPart.get().opponent)("ngIfElse",n)}}function fte(e,t){if(1&e){var n=FP();xP(0,"a",25),BP("click",function(){return hC(n),GP().navigateToPart()}),OP(1,ste,2,2,"ng-container",23),OP(2,lte,3,2,"ng-template",null,26,uI),RP()}if(2&e){var r=TP(3),i=GP();Wb(1),AP("ngIf","Observer"===i.observedPart.get().role||"Candidate"===i.observedPart.get().role)("ngIfElse",r)}}function hte(e,t){if(1&e&&(DP(0),NP(1,"fa-icon",31),LP()),2&e){var n=GP();Wb(1),AP("icon",n.faSpinner)}}function dte(e,t){if(1&e){var n=FP();DP(0),xP(1,"div",9),xP(2,"a",33),pS(3),RP(),xP(4,"div",12),xP(5,"a",34),BP("click",function(){return hC(n),GP(2).logout()}),bO(6,35),RP(),RP(),RP(),LP()}if(2&e){var r=GP(2);Wb(3),gS(r.username.get())}}var vte=function(){return["/register"]},pte=function(){return["/login"]};function gte(e,t){1&e&&(xP(0,"div",36),xP(1,"a",37),xP(2,"strong"),bO(3,38),RP(),RP(),xP(4,"a",39),bO(5,40),RP(),RP()),2&e&&(Wb(1),AP("routerLink",FT(2,vte)),Wb(3),AP("routerLink",FT(3,pte)))}function yte(e,t){if(1&e&&(OP(0,dte,7,1,"ng-container",23),OP(1,gte,6,4,"ng-template",null,32,uI)),2&e){var n=TP(2);AP("ngIf",GP().username.isPresent())("ngIfElse",n)}}var mte=function(){return["/"]},kte=function(){return["/play"]},Cte=function(){return["/lobby"]},wte=function(){return["/local"]},_te=function(){return["/tutorial"]},bte=function(){return["/settings"]},Ete=function(){var e=function(){function e(t,n,r,i){by(this,e),this.router=t,this.connectedUserService=n,this.observedPartService=r,this.userService=i,this.loading=!0,this.username=zB.empty(),this.faCog=P9,this.faSpinner=A9,this.showMenu=!1,this.observedPart=zB.empty()}return Py(e,[{key:"ngOnInit",value:function(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(function(t){e.observedPart=t})}},{key:"logout",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"navigateToPart",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id]));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(Q7),IP(D9),IP(q7))},e.\u0275cmp=wk({type:e,selectors:[["app-header"]],decls:36,vars:20,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(C||(C=ey(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(w||(w=ey(["Play online"]))),[1,"navbar-dropdown"],$localize(_||(_=ey(["Create a game"]))),$localize(b||(b=ey(["Join a game"]))),$localize(E||(E=ey(["Play offline"]))),$localize(P||(P=ey(["Create a game"]))),$localize(S||(S=ey(["Learn the rules"]))),[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",$localize(O||(O=ey(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],$localize(T||(T=ey(["",":INTERPOLATION: by ",":INTERPOLATION_1:"])),"\ufffd0\ufffd","\ufffd1\ufffd"),["waitingForOpponent",""],$localize(I||(I=ey(["",":INTERPOLATION: against ",":INTERPOLATION_1:"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(A||(A=ey(["",":INTERPOLATION: (waiting for opponent)"])),"\ufffd0\ufffd"),[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],$localize(M||(M=ey(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(x||(x=ey(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(R||(R=ey(["Log in"])))]},template:function(e,t){if(1&e&&(xP(0,"nav",0),xP(1,"div",1),xP(2,"a",2),NP(3,"img",3),RP(),xP(4,"a",4),BP("click",function(){return t.showMenu=!t.showMenu}),NP(5,"span",5),NP(6,"span",5),NP(7,"span",5),RP(),RP(),xP(8,"div",6),BP("click",function(){return t.showMenu=!t.showMenu}),xP(9,"div",7),xP(10,"a",2),bO(11,8),RP(),xP(12,"div",9),xP(13,"a",10),bO(14,11),RP(),xP(15,"div",12),xP(16,"a",2),bO(17,13),RP(),xP(18,"a",2),bO(19,14),RP(),RP(),RP(),xP(20,"div",9),xP(21,"a",10),bO(22,15),RP(),xP(23,"div",12),xP(24,"a",2),bO(25,16),RP(),xP(26,"a",2),bO(27,17),RP(),RP(),RP(),RP(),xP(28,"div",18),OP(29,fte,4,2,"a",19),xP(30,"a",20),NP(31,"fa-icon",21),RP(),xP(32,"div",22),OP(33,hte,2,1,"ng-container",23),OP(34,yte,3,2,"ng-template",null,24,uI),RP(),RP(),RP(),RP()),2&e){var n=TP(35);Wb(2),AP("routerLink",FT(13,mte)),Wb(2),AP("ngClass",t.showMenu?"is-active":""),Wb(4),AP("ngClass",t.showMenu?"is-active":""),Wb(2),AP("routerLink",FT(14,mte)),Wb(6),AP("routerLink",FT(15,kte)),Wb(2),AP("routerLink",FT(16,Cte)),Wb(6),AP("routerLink",FT(17,wte)),Wb(2),AP("routerLink",FT(18,_te)),Wb(3),AP("ngIf",t.observedPart.isPresent()),Wb(1),AP("routerLink",FT(19,bte)),Wb(1),AP("icon",t.faCog),Wb(2),AP("ngIf",t.loading)("ngIfElse",n)}},directives:[OF,lM,vM,ate],encapsulation:2}),e}(),Pte=function(){var e=Py(function e(t,n){by(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=C9,this.faFacebook=m9,this.faGithub=k9});return e.\u0275fac=function(t){return new(t||e)(IP(b9),IP(G7))},e.\u0275cmp=wk({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(N||(N=ey(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(NP(0,"app-header"),xP(1,"main",0),NP(2,"router-outlet"),RP(),xP(3,"footer",1),xP(4,"div",2),xP(5,"p"),xP(6,"span"),wO(7,3),NP(8,"strong"),_O(),RP(),pS(9," \xa0 "),xP(10,"a",4),NP(11,"fa-icon",5),RP(),pS(12,"\xa0 "),xP(13,"a",6),NP(14,"fa-icon",5),RP(),pS(15,"\xa0 "),xP(16,"a",7),NP(17,"fa-icon",5),RP(),RP(),RP(),RP()),2&e&&(Wb(11),AP("icon",t.faGithub),Wb(3),AP("icon",t.faTwitter),Wb(3),AP("icon",t.faFacebook))},directives:[Ete,IF,ate],encapsulation:2}),e}(),Ste=function(){function e(t,n){by(this,e),this.x=t,this.y=n}return Py(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),Ote=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Ste),Tte=function(){function e(){by(this,e)}return Py(e,[{key:"of",value:function(e,t){var n,r=Cy(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return HB.success(i)}}catch(a){r.e(a)}finally{r.f()}return HB.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?HB.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):HB.failure(xte.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return HB.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return HB.failure("Invalid int direction: ".concat(e))}}}]),e}(),Ite=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(Ote);Ite.UP=new Ite(0,-1),Ite.UP_RIGHT=new Ite(1,-1),Ite.RIGHT=new Ite(1,0),Ite.DOWN_RIGHT=new Ite(1,1),Ite.DOWN=new Ite(0,1),Ite.DOWN_LEFT=new Ite(-1,1),Ite.LEFT=new Ite(-1,0),Ite.UP_LEFT=new Ite(-1,-1),Ite.factory=new(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).all=[Ite.UP,Ite.UP_RIGHT,Ite.RIGHT,Ite.DOWN_RIGHT,Ite.DOWN,Ite.DOWN_LEFT,Ite.LEFT,Ite.UP_LEFT],e}return Py(n)}(Tte)),Ite.DIRECTIONS=Ite.factory.all,Ite.DIAGONALS=[Ite.UP_RIGHT,Ite.DOWN_RIGHT,Ite.DOWN_LEFT,Ite.UP_LEFT],Ite.ORTHOGONALS=[Ite.UP,Ite.RIGHT,Ite.DOWN,Ite.LEFT],Ite.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return $7("string"==typeof e,"Invalid encoded direction"),Ite.factory.fromString(e).get()}}]),n}(r9));var Ate=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}},{key:"rotateClockwise",value:function(){return n.factory.of(-this.y,this.x).get()}}]),n}(Ote);Ate.UP=new Ate(0,-1),Ate.RIGHT=new Ate(1,0),Ate.DOWN=new Ate(0,1),Ate.LEFT=new Ate(-1,0),Ate.factory=new(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).all=[Ate.UP,Ate.RIGHT,Ate.DOWN,Ate.LEFT],e}return Py(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?HB.success(Ate.UP):1===e&&0===t?HB.success(Ate.RIGHT):0===e&&1===t?HB.success(Ate.DOWN):-1===e&&0===t?HB.success(Ate.LEFT):HB.failure("Invalid orthogonal from x and y")}}]),n}(Tte)),Ate.ORTHOGONALS=Ate.factory.all,Ate.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return $7("string"==typeof e,"Invalid encoded orthogonal"),Ate.factory.fromString(e).get()}}]),n}(r9));var Mte=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 3}},{key:"encodeNumber",value:function(e){return e===Ate.UP?0:e===Ate.RIGHT?1:e===Ate.DOWN?2:3}},{key:"decodeNumber",value:function(e){switch(e){case 0:return Ate.UP;case 1:return Ate.RIGHT;case 2:return Ate.DOWN;default:return LB.expectToBe(e,3,"Encoded orthogonal should be 3 for LEFT but got ".concat(e," instead")),Ate.LEFT}}}]),n}(a9),xte=function(){var e=Py(function e(){by(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(D||(D=ey(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),Rte=function(){function e(t,n){by(this,e),this.x=t,this.y=n}return Py(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return Ite.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return a9.tuple([a9.numberEncoder(t),a9.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();Rte.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return $7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new Rte(t.x,t.y)}}]),n}(r9));var Nte=function(){var e=function(){function e(t){by(this,e),this.messageDisplayer=t,this.Player=u9,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=zB.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}return Py(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?ZB.SUCCESS:(this.messageDisplayer.gameMessage(e),ZB.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case u9.ZERO:return"player0-fill";case u9.ONE:return"player1-fill";default:return LB.expectToBe(e,s9.NONE),""}}},{key:"pass",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",G7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Dte=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new Rte(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Cy(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new Rte(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(Nte);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275cmp=wk({type:t,selectors:[["ng-component"]],features:[cP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Lte=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===u9.ZERO?e.ZERO:(LB.expectToBe(t,u9.ONE),e.ONE)}}]),e}();Lte.ZERO=new Lte(u9.ZERO.value),Lte.ONE=new Lte(u9.ONE.value),Lte.EMPTY=new Lte(s9.NONE.value),Lte.UNREACHABLE=new Lte(3);var Fte=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return LB.expectToBe(e,n.LEFT),300}}}]),n}(Ote);Fte.UP=new Fte(0,-1),Fte.LEFT=new Fte(-1,0),Fte.UP_RIGHT=new Fte(1,-1),Fte.DOWN_LEFT=new Fte(-1,1),Fte.RIGHT=new Fte(1,0),Fte.DOWN=new Fte(0,1),Fte.factory=new(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).all=[Fte.UP,Fte.UP_RIGHT,Fte.RIGHT,Fte.DOWN,Fte.DOWN_LEFT,Fte.LEFT],e}return Py(n)}(Tte)),Fte.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case Fte.UP:return 0;case Fte.UP_RIGHT:return 1;case Fte.RIGHT:return 2;case Fte.DOWN:return 3;case Fte.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return $7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),Fte.factory.all[e]}}]),n}(a9));var Ute=function(){function e(t,n,r){by(this,e),this.size=t,this.origin=n,this.orientation=r}return Py(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new Rte(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new Rte(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new Rte(t.x+i.x,t.y+i.y))}return n}}]),e}(),Vte=Py(function e(){by(this,e)}),Bte=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return Py(n)}(Vte);Bte.INSTANCE=new Bte;var zte=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return Py(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(Vte);zte.INSTANCE=new zte;var Hte=function(){var e=Py(function e(){by(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(L||(L=ey(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(F||(F=ey(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(U||(U=ey(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(V||(V=ey(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(B||(B=ey(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(z||(z=ey(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(H||(H=ey(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(G||(G=ey(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize($||($=ey(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(Z||(Z=ey(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(q||(q=ey(["There is a piece between the piece you chose and its landing space."])))},e}(),Gte=function(){function e(t,n){by(this,e),this.ruler=t,this.name=n}return Py(e,[{key:"toString",value:function(){return this.name}}]),e}(),$te=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),Zte=function(){function e(t){by(this,e),this.turn=t}return Py(e,[{key:"getCurrentPlayer",value:function(){return u9.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?u9.ZERO:u9.ONE}}]),e}(),qte=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,r)).board=e,i}return Py(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?zB.of(this.board[e.y][e.x]):zB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new Rte(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Cy(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=iy(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new Rte(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return h9.copyBiArray(this.board)}}]),n}(Zte),Wte=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==Lte.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===Lte.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Lte.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=Lte.EMPTY,t=Lte.UNREACHABLE,r=Lte.ZERO,i=Lte.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(qte),jte=Py(function e(){by(this,e)}),Yte=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).coord=new Rte(e,r),i}return Py(n)}(jte),Kte=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;if(by(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return vy(a)}return Py(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return HB.success(new n(e,t,zB.empty()))}catch(r){return HB.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];h9.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=Fte.factory.fromDelta(a.x,a.y);if(o.isFailure())return HB.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?HB.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):HB.success(new n(i[1],r,zB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Yte);Kte.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=Fte.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new Rte(i,r);if(0===e)return Kte.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new Rte(s,o);return Kte.fromDoubleCoord(a,u,n).get()}}]),n}(a9));var Qte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(Qte||(Qte={})),Qte),Xte=function(){var e=Py(function e(){by(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),Jte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zB.empty(),i=arguments.length>3?arguments[3]:void 0;if(by(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=zB.empty(),this.hopedValue=new R9,this.ownValue=new R9,this.possibleMoves=new R9,this.ownValue=new R9,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Xte.createdNodes++,FB(e.VERBOSE||!1,"creating "+this.myToString())}return Py(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Xte.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return FB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return FB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);$7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=zB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new x9(n)),new x9(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===u9.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===u9.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=Cy(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===u9.ZERO?n:r))break;c===u9.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();$7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=zB.of(new e(o,zB.of(this),zB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){$7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Cy(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return zB.of(r)}}catch(i){n.e(i)}finally{n.f()}return zB.empty()}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Cy(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(FB(e.VERBOSE||n,"VICTORY"),Qte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(FB(e.VERBOSE||n,"PRE_VICTORY_MIN"),Qte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(FB(e.VERBOSE||n,"PRE_VICTORY_MAX"),Qte.PRE_VICTORY):(FB(e.VERBOSE||n,"DEFAULT"),Qte.DEFAULT)}}]),e}();Jte.VERBOSE=!1,Jte.minimaxes=new R9;var ene=function(){function e(t,n){by(this,e),this.isEndGame=t,this.winner=n}return Py(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===u9.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===u9.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();ene.ZERO_WON=new ene(!0,u9.ZERO),ene.ONE_WON=new ene(!0,u9.ONE),ene.DRAW=new ene(!0,s9.NONE),ene.ONGOING=new ene(!1,s9.NONE);var tne=function(){function e(t){by(this,e),this.stateType=t,this.setInitialBoard()}return Py(e,[{key:"choose",value:function(e){var t=!1;FB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){FB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return $7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),FB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(FB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return FB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;FB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new Jte(i,zB.of(this.node),zB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){var e=this.stateType.getInitialState();Jte.ruler=this,this.node=new Jte(e)}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Cy(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);$7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),nne=function(){var e=Py(function e(){by(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(W||(W=ey(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(j||(j=ey(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(Y||(Y=ey(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(K||(K=ey(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(Q||(Q=ey(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(X||(X=ey(["This space is not aligned with the current line."])))},e}(),rne=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return new Wte(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?ZB.failure(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Lte.ofPlayer(t.getCurrentOpponent())?ZB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):ZB.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=Lte.ofPlayer(t.getCurrentPlayer()),o=Lte.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?HB.failure(nne.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?HB.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=Lte.ofPlayer(n.getCurrentOpponent()),s=Lte.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?HB.failure(nne.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===Lte.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?HB.failure(nne.CANNOT_PUSH_YOUR_OWN_PIECES()):HB.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=Lte.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return HB.failure(nne.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=Lte.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return HB.failure(nne.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===Lte.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return HB.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?ene.ZERO_WON:t[1]>5?ene.ONE_WON:ene.ONGOING}}]),n}(tne),ine=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new Rte(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Cy(Fte.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Kte.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=Cy(Fte.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Kte.fromDoubleCoord(o,p,c).get();rne.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new x9(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=rne.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Wte(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=rne.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n=e.gameState.getScores();return new $te(n[1]-n[0])}}]),n}(Gte),ane=function(){function e(t,n,r){by(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=zB.empty(),this.previousState=zB.empty()}return Py(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=zB.of(e),this}},{key:"withPreviousState",value:function(e){return this.previousState=zB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new sne(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new cne(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new une(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new lne(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new fne(e,t,n)}}]),e}(),one=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return Py(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(ane),sne=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,$7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return Py(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(one),une=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return Py(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(one),cne=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return Py(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(one),lne=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return Py(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(one),fne=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isInformation",value:function(){return!0}}]),n}(ane),hne=Lte.EMPTY,dne=Lte.UNREACHABLE,vne=Lte.ZERO,pne=Lte.ONE,gne=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(J||(J=ey(["Initial board and goal of the game"]))),$localize(ee||(ee=ey(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Wte.getInitialState()),ane.anyMove($localize(te||(te=ey(["Moving a piece"]))),$localize(ne||(ne=ey(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Wte.getInitialState(),Kte.fromSingleCoord(new Rte(2,6),Fte.UP).get(),$localize(re||(re=ey(["Congratulations!"])))),ane.fromMove($localize(ie||(ie=ey(["Pushing"]))),$localize(ae||(ae=ey(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Wte([[dne,dne,dne,dne,hne,vne,vne,pne,pne],[dne,dne,dne,hne,hne,hne,hne,hne,hne],[dne,dne,hne,vne,vne,vne,pne,vne,hne],[dne,hne,hne,hne,hne,hne,hne,hne,hne],[hne,hne,hne,hne,vne,vne,vne,pne,pne],[hne,hne,hne,hne,hne,hne,hne,hne,dne],[hne,hne,hne,hne,vne,pne,hne,dne,dne],[hne,hne,hne,vne,hne,hne,dne,dne,dne],[hne,hne,vne,hne,hne,dne,dne,dne,dne]],0),[Kte.fromSingleCoord(new Rte(4,4),Fte.RIGHT).get()],$localize(oe||(oe=ey(["Congratulations! You know everything you need to start a game!"]))),$localize(se||(se=ey(["Failed!"]))))]});function yne(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",6),BP("click",function(){hC(n);var e=GP(2).index,t=GP().index;return GP().onPieceClick(e,t)}),RP()}if(2&e){var r=GP(2).index,i=GP().index,a=GP();qP("id","piece_",r,"_",i,""),AP("ngClass",a.getPieceClasses(r,i)),_P("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function mne(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"polygon",4),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onSpaceClick(e,t)}),RP(),OP(2,yne,1,6,"circle",5),RP()}if(2&e){var r=GP(),i=r.index,a=r.$implicit,o=GP().index,s=GP();Wb(1),qP("id","space_",i,"_",o,""),AP("ngClass",s.getSquareClasses(i,o)),_P("points",s.getHexaCoordsBy(i,o)),Wb(1),AP("ngIf",s.isPiece(a))}}function kne(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,mne,3,5,"g",3),RP()),2&e){var n=t.$implicit,r=GP(2);Wb(1),AP("ngIf",r.isBoard(n))}}function Cne(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,kne,2,1,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function wne(e,t){1&e&&(zC(),xP(0,"marker",7),NP(1,"polygon",8),RP()),2&e&&ZP("id","arrowhead_",t.$implicit.dir.toString(),"")}function _ne(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),NP(1,"line",9),xP(2,"line",10),BP("click",function(){var e=hC(n).$implicit;return GP().chooseDirection(e.dir)}),RP(),xP(3,"polygon",11),BP("click",function(){var e=hC(n).$implicit;return GP().chooseDirection(e.dir)}),RP(),RP()}if(2&e){var r=t.$implicit;Wb(1),ZP("id","line_start_",r.dir.toString(),""),_P("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),Wb(1),ZP("id","line_end_",r.dir.toString(),""),_P("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),Wb(1),ZP("id","direction_",r.dir.toString(),""),_P("transform",r.transformation)}}var bne=Py(function e(t,n,r,i,a,o){by(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),Ene=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new rne(Wte),r.availableMinimaxes=[new ine(r.rules,"Dummy")],r.encoder=Kte.encoder,r.tutorial=(new gne).tutorial,r.scores=zB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new Ute(r.SPACE_SIZE,new Rte(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),Bte.INSTANCE),r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=zB.of(this.getState().getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.getState().getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=ZB.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new Rte(e,t)],n.showPossibleDirections(),ZB.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.getState(),r=Lte.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Cy(Fte.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Kte.fromSingleCoord(i,u).get():Kte.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=Fte.getAngle(u)+150,p=new bne(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new Rte(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==Lte.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==Lte.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new Rte(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),ZB.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(nne.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.getState().getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),ZB.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Rte(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),ZB.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=Ite.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=Ite.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),h9.sortByDescending(r.selecteds,Kte.sortCoord),r.showPossibleDirections(),ZB.SUCCESS):r.cancelMove(nne.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(nne.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),ZB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Kte.fromSingleCoord(a,e).get():Kte.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#space_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new Rte(e,t),a=Cy(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",ZB.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Rte(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved-fill"),r}},{key:"getPieceClasses",value:function(e,t){var n=new Rte(e,t),r=u9.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("selected-stroke"),i}}]),n}(Dte);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-abalone"]],features:[cP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Cne,2,1,"g",1),xP(2,"defs"),OP(3,wne,2,1,"marker",2),RP(),OP(4,_ne,4,12,"g",1),RP()),2&e&&(Wb(1),AP("ngForOf",t.hexaBoard),Wb(2),AP("ngForOf",t.directions),Wb(1),AP("ngForOf",t.directions))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Pne=function(){function e(t){by(this,e),this.x=t}return Py(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return $7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();Pne.ZERO=new Pne(0),Pne.ONE=new Pne(1),Pne.TWO=new Pne(2),Pne.THREE=new Pne(3);var Sne=function(){var e=Py(function e(){by(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ue||(ue=ey(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(ce||(ce=ey(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(le||(le=ey(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(fe||(fe=ey(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(he||(he=ey(["There is no possible transfer from that square!"])))},e}(),One=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return Py(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return LB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(zB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return HB.failure(Sne.PIECE_SHOULD_MOVE_DOWNWARD());var r=LB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(zB.empty())&&n.starting.equals(zB.of(e))}));return HB.success(r)}}]),n}(jte);One.ALL_MOVES=[new One(Pne.ZERO,zB.of(u9.ZERO),zB.empty()),new One(Pne.ONE,zB.of(u9.ZERO),zB.empty()),new One(Pne.TWO,zB.of(u9.ZERO),zB.empty()),new One(Pne.THREE,zB.of(u9.ZERO),zB.empty()),new One(Pne.ZERO,zB.of(u9.ONE),zB.empty()),new One(Pne.ONE,zB.of(u9.ONE),zB.empty()),new One(Pne.TWO,zB.of(u9.ONE),zB.empty()),new One(Pne.THREE,zB.of(u9.ONE),zB.empty()),new One(Pne.TWO,zB.empty(),zB.of(Pne.THREE)),new One(Pne.ONE,zB.empty(),zB.of(Pne.THREE)),new One(Pne.ZERO,zB.empty(),zB.of(Pne.THREE)),new One(Pne.ONE,zB.empty(),zB.of(Pne.TWO)),new One(Pne.ZERO,zB.empty(),zB.of(Pne.TWO)),new One(Pne.ZERO,zB.empty(),zB.of(Pne.ONE))],One.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return One.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=One.ALL_MOVES.findIndex(function(t){return t.equals(e)});return $7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return $7(e<One.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),One.ALL_MOVES[e]}}]),n}(a9));var Tne=function(){function e(t){by(this,e),this.containing=t}return Py(e,[{key:"isFull",value:function(){return this.count(u9.ZERO)+this.count(u9.ONE)>=this.count(s9.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(u9.ZERO),r=this.count(u9.ONE),i=this.count(s9.NONE);return t===u9.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(u9.ZERO),r=this.count(u9.ONE),i=this.count(s9.NONE);return t===u9.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(u9.ZERO),t=this.count(u9.ONE);return e>t?u9.ZERO:t>e?u9.ONE:s9.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return HB.failure("invalid starting space");var i=new R9([{key:u9.ZERO,value:t},{key:u9.ONE,value:n},{key:s9.NONE,value:r}]);i.makeImmutable();var a=new e(i);return HB.success(a)}}]),e}(),Ine=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return Py(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&h9.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=Tne.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new R9;return u.set(u9.ZERO,r),u.set(u9.ONE,i),new n(e,a,u)}}]),n}(Zte);return e.PIECES_PER_PLAYER=10,e}(),Ane=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,Ine)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new Ine(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===Pne.THREE)return i.updateAt(e.landing,o);var s=Pne.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new Ine(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?HB.failure(Sne.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?HB.failure(Sne.NO_PIECE_REMAINING_TO_DROP()):HB.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?HB.failure(Sne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(Pne.from(n)).isFull())return ene.ONGOING;var r=t.getPieceAt(Pne.THREE).getDominatingPlayer();return $7(r.isPlayer(),"winner can only be a player if the game is finished"),ene.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n)),n.singleton.get()}}]),n}(tne);Ane.singleton=zB.empty();var Mne=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return One.ALL_MOVES.filter(function(e){return Ane.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=Ane.get().getGameStatus(e);if(t.isEndGame)return $te.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new $te(n.getScoreModifier()):new $te(0)}}]),n}(Gte),xne=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(de||(de=ey(["Initial board and goal of the game"]))),$localize(ve||(ve=ey(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),Ine.getInitialState()),ane.anyMove($localize(pe||(pe=ey(["Drop"]))),$localize(ge||(ge=ey(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),Ine.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),One.drop(Pne.ZERO,u9.ZERO),$localize(ye||(ye=ey(["Congratulations!"])))),ane.fromPredicate($localize(me||(me=ey(["Transfer"]))),$localize(ke||(ke=ey(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),Ine.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),One.transfer(Pne.TWO,Pne.ZERO).get(),function(e,t,n){return e.isDrop()?ZB.failure($localize(Ce||(Ce=ey(["This move is a drop, please do a transfer!"])))):ZB.SUCCESS},$localize(we||(we=ey(["Congratulations!"])))),ane.fromPredicate($localize(_e||(_e=ey(["Victory"]))),$localize(be||(be=ey(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),Ine.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),One.drop(Pne.TWO,u9.ONE),function(e,t,n){return e.isDrop()?e.piece.equalsValue(u9.ONE)?ZB.SUCCESS:ZB.failure($localize(Ee||(Ee=ey(["You actively made your opponent win!"])))):ZB.failure($localize(Pe||(Pe=ey(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(Se||(Se=ey(["Congratulations!"]))))]});function Rne(e,t){if(1&e&&(zC(),NP(0,"circle",5)),2&e){var n=t.$implicit,r=GP();_P("cx",r.getRemainingPieceCx(n))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Nne(e,t){if(1&e&&(zC(),NP(0,"circle",6)),2&e){var n=t.$implicit,r=GP();_P("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(n))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Dne(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",9),BP("click",function(){hC(n);var e=GP().index,t=GP();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),RP()}if(2&e){var r=GP().index,i=GP();ZP("id","dropArrow_zero_",r,""),AP("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),_P("points",i.ARROW_COORD)("transform","translate("+i.SPACE_SIZE/2+" "+-i.SPACE_SIZE/2+")")}}function Lne(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",9),BP("click",function(){hC(n);var e=GP().index,t=GP();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),RP()}if(2&e){var r=GP().index,i=GP();ZP("id","dropArrow_one_",r,""),AP("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),_P("points",i.ARROW_COORD)("transform","translate(0 "+-i.SPACE_SIZE/2+")")}}function Fne(e,t){if(1&e){var n=FP();zC(),DP(0),xP(1,"circle",10),BP("click",function(){hC(n);var e=GP().index;return GP().onSquareClick(e)}),RP(),LP()}if(2&e){var r=t.$implicit,i=GP(),a=i.index,o=i.$implicit,s=GP();Wb(1),WP("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),AP("ngClass",s.getPieceClasses(a,r,o)),_P("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function Une(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),OP(1,Dne,1,4,"polygon",7),OP(2,Lne,1,4,"polygon",7),xP(3,"rect",8),BP("click",function(){var e=hC(n).index;return GP().onSquareClick(e)}),RP(),OP(4,Fne,2,6,"ng-container",4),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP();_P("transform",a.getBlockTransform(i)),Wb(1),AP("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),Wb(1),AP("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),Wb(1),ZP("id","square_",i,""),AP("ngClass",a.getSquareClasses(i)),_P("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}var Vne=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).PlayerOrNone=s9,r.BOARD_WIDTH=4*r.SPACE_SIZE,r.BOARD_HEIGHT=4.5*r.SPACE_SIZE,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=Ine.PIECES_PER_PLAYER,r.selectedPiece=zB.empty(),r.leftPiece=zB.empty(),r.droppedPiece=zB.empty(),r.displayableArrow=[],r.rules=Ane.get(),r.hasAsymetricBoard=!0,r.availableMinimaxes=[new Mne(r.rules,"ApagosDummyMinimax")],r.encoder=One.encoder,r.tutorial=(new xne).tutorial,r.PIECE_RADIUS=2*r.SPACE_SIZE/(r.PIECES_PER_PLAYER+.5),r.updateBoard(),r}return Py(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=zB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(u9.ZERO).get(),this.remainingOne=e.remaining.get(u9.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=zB.empty(),this.leftPiece=zB.empty(),this.selectedPiece=zB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=zB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===u9.ZERO?n-1:e.count(s9.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=zB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=zB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.getState(),t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(u9.ZERO).get()>0&&this.displayableArrow.push({x:t,player:u9.ZERO}),e.remaining.get(u9.ONE).get()>0&&this.displayableArrow.push({x:t,player:u9.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=this.SPACE_SIZE/2,i=this.SPACE_SIZE/2;if(1===n.count(s9.NONE))return new Rte(r,i);var a=n.count(s9.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new Rte(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getBlockTransform",value:function(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected-stroke"):this.movedSquare.includes(e)&&t.push("last-move-stroke"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===u9.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=Pne.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=One.transfer(Pne.from(s),a).get()):o=One.drop(a,t),u=n.getState(),r.abrupt("return",n.chooseMove(o,u));case 7:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(u9.ZERO),o=n.count(u9.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected-stroke");else if(this.droppedPiece.equalsValue(r))i.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.getState().getCurrentOpponent()===u9.ZERO?a++:o++}var s=n.count(s9.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0-fill":e>=t+n?"player1-fill":""}},{key:"onSquareClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),ZB.SUCCESS));case 5:return i=t.getState().getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(Sne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=zB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Sne.NO_POSSIBLE_TRANSFER_REMAINS()):ZB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.getState().getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}},{key:"getRemainingPieceCx",value:function(e){return(e+.5)*this.PIECE_RADIUS*1.5}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(Nte);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-apagos"]],features:[cP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"g"),OP(2,Rne,1,3,"circle",1),OP(3,Nne,1,3,"circle",2),RP(),xP(4,"g",3),OP(5,Une,5,8,"g",4),RP(),RP()),2&e&&(_P("viewBox",-t.STROKE_WIDTH/2+" "+-t.STROKE_WIDTH/2+" "+(t.BOARD_WIDTH+t.STROKE_WIDTH)+" "+(t.BOARD_HEIGHT+t.STROKE_WIDTH)),Wb(1),_P("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),Wb(1),AP("ngForOf",t.range(t.remainingOne)),Wb(1),AP("ngForOf",t.range(t.remainingZero)),Wb(2),AP("ngForOf",t.board))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Bne=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getViewBox",value:function(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}]),n}(Nte);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275cmp=wk({type:t,selectors:[["ng-component"]],features:[cP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),zne=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).captured=i,a}return Py(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(h9.createTable(6,2,4),0,[0,0])}}]),n}(qte),Hne=function(){var e=Py(function e(){by(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(Oe||(Oe=ey(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NON_EMPTY_HOUSE=function(){return $localize(Te||(Te=ey(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(Ie||(Ie=ey(["You should distribute but you do not."])))},e}(),Gne=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){FB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer(),o=t.getCurrentOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,o,s),c=u[u.length-1];return c.y===o?new zne(s,t.turn+1,t.captured):this.applyPotentialCapture(a,c,s,t)}},{key:"applyPotentialCapture",value:function(e,t,r,i){var a=i.getCurrentOpponent(),o=[i.captured[0],i.captured[1]],s=n.captureIfLegal(t.x,t.y,e,r);o[e.value]+=s.capturedSum;var u=s.resultingBoard;if(n.mustMansoon(e,u)){var c=n.mansoon(a,u);return o[a.value]+=c.capturedSum,new zne(c.resultingBoard,i.turn+1,o)}return new zne(u,i.turn+1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mustMansoon",value:function(e,t){return n.isStarving(e,t)&&!1===n.canDistribute(e.getOpponent(),t)}},{key:"mansoon",value:function(e,t){var n=h9.copyBiArray(t),r=0,i=[[0,0,0,0,0,0],[0,0,0,0,0,0]],a=0,o=e.getOpponent().value;do{r+=n[o][a],i[o][a]=n[o][a],n[o][a]=0,a++}while(a<6);return{capturedSum:r,captureMap:i,resultingBoard:n}}},{key:"isLegal",value:function(e,t){var r=t.getCurrentOpponent(),i=r.value,a=e.x;if(0===t.getPieceAtXY(a,i))return HB.failure(Hne.MUST_CHOOSE_NON_EMPTY_HOUSE());var o=n.isStarving(r,t.board),s=!1===n.doesDistribute(a,i,t.board);return o&&s?HB.failure(Hne.SHOULD_DISTRIBUTE()):HB.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e.getOpponent().value,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0,r=e.getOpponent().value;do{if(t[r][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e],o=[];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,o.push(new Rte(e,t)),a--);return o}},{key:"capture",value:function(e,t,n,r){var i=h9.copyBiArray(r);$7(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");var a=i[t][e],o=0,s=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(a<2||a>3)return{capturedSum:0,captureMap:s,resultingBoard:i};var u=-1,c=-1;n===u9.ONE&&(u=1,c=6);do{s[t][e]=a,o+=a,i[t][e]=0,a=i[t][e+=u]}while(e!==c&&(2===a||3===a));return{capturedSum:o,captureMap:s,resultingBoard:i}}},{key:"captureIfLegal",value:function(e,t,r,i){var a=h9.copyBiArray(i),o=n.capture(e,t,r,i),s=n.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&s?{capturedSum:0,resultingBoard:a,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?ene.ZERO_WON:t.captured[1]>24?ene.ONE_WON:24===t.captured[0]&&24===t.captured[1]?ene.DRAW:ene.ONGOING}}]),n}(tne);return e.VERBOSE=!1,e}(),$ne=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).x=e,r}return Py(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return $7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(jte);$ne.ZERO=new $ne(0),$ne.ONE=new $ne(1),$ne.TWO=new $ne(2),$ne.THREE=new $ne(3),$ne.FOUR=new $ne(4),$ne.FIVE=new $ne(5),$ne.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return $ne.from(e)}}]),n}(a9));var Zne=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=(r.turn+1)%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=$ne.from(a),Gne.isLegal(t,r).isSuccess()&&(t=$ne.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent().value,i=n.value;return h9.sortByDescending(t,function(t){var a,o=e.gameState.getCopiedBoard(),s=o[r][t.x],u=Gne.distribute(t.x,r,o),c=u[u.length-1],l=0;return c.y===r?(a=0,s<=6&&(l=10)):a=Gne.captureIfLegal(c.x,i,n,o).capturedSum,100*a+l-s}),t}},{key:"getBoardValue",value:function(e){var t=Gne.getGameStatus(e);if(t.isEndGame)return $te.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new $te(n[1]-n[0])}}]),n}(Gte),qne=Py(function e(){by(this,e),this.tutorial=[ane.anyMove($localize(Ae||(Ae=ey(["Sowing"]))),$localize(Me||(Me=ey(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown. The spaces in Awal\xe9 are called the houses.\n         As you're playing first, the 6 houses on the bottom are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),zne.getInitialState(),$ne.ZERO,$localize(xe||(xe=ey(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),ane.anyMove($localize(Re||(Re=ey(["Big sowing"]))),$localize(Ne||(Ne=ey(["You are still the first player.\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new zne([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),$ne.ONE,$localize(De||(De=ey(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),ane.fromMove($localize(Le||(Le=ey(["Simple capture"]))),$localize(Fe||(Fe=ey(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>The houses on the bottom are yours, do a capture!"]))),new zne([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[$ne.ZERO],$localize(Ue||(Ue=ey(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Ve||(Ve=ey(["Failed. Try again and sow from the leftmost house."])))),ane.fromMove($localize(Be||(Be=ey(["Multiple captures"]))),$localize(ze||(ze=ey(["By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>The houses on the bottom are yours, do a capture!"]))),new zne([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[$ne.ZERO],$localize(He||(He=ey(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Ge||(Ge=ey(["Failed. Try again."])))),ane.fromMove($localize($e||($e=ey(["Interrupted capture"]))),$localize(Ze||(Ze=ey(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>The houses on the bottom are yours, do a capture!"]))),new zne([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[$ne.ZERO],$localize(qe||(qe=ey(["Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house."]))),$localize(We||(We=ey(["Failed. Try again."])))),ane.fromMove($localize(je||(je=ey(["Capture on the other side only"]))),$localize(Ye||(Ye=ey(["Your houses are the one below. Try to capture the two leftmost houses of the opponent."]))),new zne([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[$ne.ONE],$localize(Ke||(Ke=ey(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Qe||(Qe=ey(["You have only captured one house, try again!"])))),ane.fromMove($localize(Xe||(Xe=ey(["Do not starve"]))),$localize(Je||(Je=ey(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Your houses are the one below. Try it."]))),new zne([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[$ne.ZERO],$localize(et||(et=ey(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(tt||(tt=ey(["Failed. Try again."])))),ane.anyMove($localize(nt||(nt=ey(["Feeding is mandatory"]))),$localize(rt||(rt=ey(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!"]))),new zne([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),$ne.THREE,$localize(it||(it=ey(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),ane.anyMove($localize(at||(at=ey(["End of the game"]))),$localize(ot||(ot=ey(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>Your houses are still the bottom one, sow the leftmost house."]))),new zne([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),$ne.ZERO,$localize(st||(st=ey(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Wne(e,t){if(1&e){var n=FP();zC(),xP(0,"text",7),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),pS(1),RP()}if(2&e){var r=GP().index,i=GP().index,a=GP();qP("id","captured_",r,"_",i,""),_P("x",65+100*r)("y",81+120*i)("transform",a.getPieceRotation(r,i)),Wb(1),yS(" ",-a.captured[i][r]," ")}}function jne(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"circle",4),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),RP(),xP(2,"text",5),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),pS(3),RP(),OP(4,Wne,2,6,"text",6),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","click_",i,"_",a,""),AP("ngClass",o.getSpaceClasses(i,a)),_P("cx",o.getPieceCx(i))("cy",o.getPieceCy(a)),Wb(1),qP("id","number_",i,"__",a,""),_P("x",50+100*i)("y",66+120*a)("transform",o.getPieceRotation(i,a)),Wb(1),yS(" ",r," "),Wb(1),AP("ngIf",o.captured[a][i]>0)}}function Yne(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,jne,5,12,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}var Kne=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).last=zB.empty(),r.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],r.filledCoords=[],r.hasAsymetricBoard=!0,r.scores=zB.of([0,0]),r.rules=new Gne(zne),r.availableMinimaxes=[new Zne(r.rules,"AwaleMinimax")],r.encoder=$ne.encoder,r.tutorial=(new qne).tutorial,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){var e=this.getState();this.scores=zB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentPlayer().value;this.last=zB.of(new Rte(t.get().x,n)),this.showPreviousMove()}else this.last=zB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=this.rules.node.mother.get().gameState,n=h9.copyBiArray(t.board),r=t.getCurrentOpponent().value;this.filledCoords=Gne.distribute(e.x,r,n);var i=this.filledCoords[this.filledCoords.length-1];if(i.y!==r){var a=Gne.captureIfLegal(i.x,i.y,t.getCurrentPlayer(),n);this.captured=a.captureMap;var o=this.getState().getCurrentPlayer();Gne.mustMansoon(o.getOpponent(),a.resultingBoard)&&(this.captured=Gne.mansoon(o,a.resultingBoard).captureMap)}}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t!==n.getState().getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(Hne.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=zB.empty(),a=$ne.from(e),r.abrupt("return",n.chooseMove(a,n.getState()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSpaceClasses",value:function(e,t){var n=new Rte(e,t),r="player"+(t+1)%2+"-fill";return this.captured[t][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(n)?["moved-stroke","last-move-stroke",r]:this.filledCoords.some(function(e){return e.equals(n)})?["moved-stroke",r]:[r]}},{key:"getPieceCx",value:function(e){return 50+100*e}},{key:"getPieceCy",value:function(e){return 50+120*e}},{key:"getPieceRotation",value:function(e,t){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(t)+")"}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-awale-component"]],features:[cP],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),NP(1,"rect",1),OP(2,Yne,2,1,"g",2),NP(3,"line",3),RP()),2&e&&(_P("transform",t.rotation),Wb(2),AP("ngForOf",t.board))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qne=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;if(by(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(Hte.MOVE_CANNOT_BE_STATIC());return i.end=r,vy(i)}return Py(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return Ite.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){fy(a,r);var i=dy(a);function a(){var n;return by(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return Py(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Rte((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new Rte((r-=r%1)%e,o);return n(s,a)}}]),a}(a9))}}]),n}(Yte),Xne=function(){var e=Py(function e(){by(this,e)});return e.LANDING_ON_OCCUPIED_SQUARE=function(){return $localize(ut||(ut=ey(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(ct||(ct=ey(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(lt||(lt=ey(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(ft||(ft=ey(["Tafl moves must be orthogonal."])))},e}(),Jne=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;if(by(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(Xne.MOVE_MUST_BE_ORTHOGONAL());return vy(i)}return Py(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(Qne),ere=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return HB.success(r)}catch(r){return HB.failure(r.message)}}}]),n}(Jne);ere.encoder=Qne.getEncoder(7,7,ere.of);var tre={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:u9.ZERO},nre=function(){function e(t,n){by(this,e),this.owner=t,this.king=n}return Py(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();nre.UNOCCUPIED=new nre(s9.NONE,!1),nre.PLAYER_ONE_KING=new nre(s9.ONE,!0),nre.INVADERS=new nre(s9.ZERO,!1),nre.DEFENDERS=new nre(s9.ONE,!1);var rre=Py(function e(t){by(this,e),this.value=t});rre.NONE=new rre("NONE"),rre.OPPONENT=new rre("OPPONENT"),rre.PLAYER=new rre("PLAYER");var ire=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new Rte(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===s9.NONE?rre.NONE:e===n?rre.PLAYER:rre.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(qte),are=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=nre.UNOCCUPIED,t=nre.INVADERS,r=nre.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,nre.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(ire),ore=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return Py(n,[{key:"isLegal",value:function(e,t){FB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?HB.failure(i.getReason()):HB.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===rre.NONE)return ZB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE());if(r===rre.OPPONENT)return ZB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==rre.NONE)return ZB.failure(Xne.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return ZB.failure(Xne.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return ZB.failure(Xne.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==nre.UNOCCUPIED)return ZB.failure(Hte.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return ZB.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===rre.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):zB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===rre.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===rre.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):zB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):rre.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):rre.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):rre.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===rre.PLAYER?1:0;return 2===(i+=t===rre.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(FB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),zB.of(r)):zB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return zB.of(t)}else{var i=r===rre.PLAYER,a=n===rre.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return zB.of(t)}return zB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=rre.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===rre.NONE?!1===this.isThrone(i,s)?(FB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),zB.empty()):(FB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),zB.of(o)):u===rre.PLAYER?(FB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),zB.of(o)):(FB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),zB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return zB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===rre.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===rre.PLAYER||l&&s)?(FB(n.VERBOSE||!1,"king captured by 4 invaders"),zB.of(t)):zB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){FB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=nre.UNOCCUPIED;var u,c=Cy(Ate.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=nre.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?ene.getVictory(t.get()):ene.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return FB(t,"The king is dead, victory to invader"),zB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(FB(t,"The king escape, victory to defender"),zB.of(this.getDefender())):this.isPlayerImmobilized(u9.ZERO,e)?(FB(t,"Zero has no move, victory to one"),zB.of(u9.ONE)):this.isPlayerImmobilized(u9.ONE,e)?(FB(t,"One has no move, victory to zero"),zB.of(u9.ZERO)):(FB(t,"no victory"),zB.empty())}},{key:"getKingCoord",value:function(e){FB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return zB.of(new Rte(r,t));return zB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);FB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Cy(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Cy(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new Rte(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Cy(Ate.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===s9.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(tne);return e.VERBOSE=!1,e}(),sre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,are,tre,ere.of)}return Py(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Jte.ruler=this.singleton,n.singleton}}]),n}(ore),ure=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=nre.UNOCCUPIED,a.captureds=[],a.chosen=zB.empty(),a.lastMove=zB.empty(),a}return Py(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){FB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.getState().getCurrentOpponent(),r=Cy(Ate.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===rre.OPPONENT,s=this.getState().getPieceAt(a)===nre.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===s9.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(FB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new Rte(e,t),r.abrupt("return",n.chosen.equalsValue(a)?(n.cancelMoveAttempt(),ZB.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(a)?n.choosePiece(a):n.chooseDestination(e,t));case 6:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(FB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen.get(),a=new Rte(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=8;break}return r.next=5,n.chooseMove(o.get(),n.getState());case 5:r.t0=r.sent,r.next=9;break;case 8:r.t0=n.cancelMove(o.getReason());case 9:return r.abrupt("return",r.t0);case 10:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){return FB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[e.y][e.x]===nre.UNOCCUPIED?this.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=zB.of(e),this.updateViewInfo(),FB(this.VERBOSE,"selected piece = ("+e.x+", "+e.y+")"),ZB.SUCCESS):this.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e){var t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===rre.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=zB.empty(),this.updateViewInfo()}},{key:"isThrone",value:function(e,t){var n=this.getState();return this.rules.isThrone(n,new Rte(e,t))}},{key:"isCentralThrone",value:function(e,t){return this.getState().isCentralThrone(new Rte(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new Rte(e,t),i=this.getState().getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equalsValue(r)&&n.push("selected-stroke"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new Rte(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured-fill");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved-fill")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new Rte(n,t);this.isClickable(r)&&e.push(r)}return e}},{key:"isClickable",value:function(e){return this.pieceBelongToCurrentPlayer(e)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===nre.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(Bne),cre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){FB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?h9.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):h9.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new $te(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(u9.ZERO,t).length,i=this.ruler.getPlayerListPawns(u9.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=u9.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=u9.ONE.getScoreModifier(),new $te(r*a+i*o)}}]),n}(Gte),lre=function(){function e(t,n){by(this,e),this.directThreats=t,this.mover=n}return Py(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),fre=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,new x9([e]),r)).directThreat=e,i.mover=r,i}return Py(n)}(lre),hre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){fy(r,e);var n=dy(r);function r(e){var t;if(by(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Cy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return vy(t)}return Py(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Cy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Cy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(x9,Symbol.iterator)),dre=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return Py(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n,r=e.gameState,i=nre.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=Cy(u9.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=Cy(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Cy(Ate.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new $te(a)}},{key:"getPiecesMap",value:function(e){for(var t=nre.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new Rte(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===u9.ZERO?n.push(o):r.push(o))}return new R9([{key:u9.ZERO,value:new hre(n)},{key:u9.ONE,value:new hre(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new R9,i=Cy(u9.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Cy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new x9(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);$7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=Cy(Ate.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=Cy(Ate.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===nre.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new fre(u,new hre(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==u9.ONE&&t.getPieceAt(e)!==nre.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Cy(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new R9,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new hre(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Cy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=Cy(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Cy(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new fre(d.directThreat,new hre(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new x9(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=Cy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(cre),vre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=nre.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=Cy(u9.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new hre,p=Cy(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Cy(Ate.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(P){m.e(P)}finally{m.f()}}}}catch(P){p.e(P)}finally{p.f()}var w,_=Cy(v);try{for(_.s();!(w=_.n()).done;){var b=w.value,E=this.getControlledPieceValue(b.x,b.y,a);s+=d.getScoreModifier()*E}}catch(P){_.e(P)}finally{_.f()}}}catch(P){f.e(P)}finally{f.f()}return new $te(s)}},{key:"getControlledPieceValue",value:function(e,t,n){var r=1;return(0===e||e===n-1)&&(r*=n),(0===t||t===n-1)&&(r*=n),r}}]),n}(dre);vre.SCORE_BY_THREATENED_PIECE=530,vre.SCORE_BY_SAFE_PIECE=16*vre.SCORE_BY_THREATENED_PIECE+1;var pre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=nre.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=Cy(u9.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new hre,g=Cy(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=Cy(Ate.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,b=Cy(p);try{for(b.s();!(_=b.n()).done;){var E=_.value,P=this.getControlledPieceValue(E.x,E.y,i);u+=v.getScoreModifier()*P}}catch(O){b.e(O)}finally{b.f()}}}catch(O){h.e(O)}finally{h.f()}var S=this.getStepForEscape(r);return new $te(531*S*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?zB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?zB.of(t):(t++,r.push.apply(r,my(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Cy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Cy(Ate.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===nre.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(vre);pre.SCORE_BY_THREATENED_PIECE=530,pre.SCORE_BY_SAFE_PIECE=16*vre.SCORE_BY_THREATENED_PIECE+1,pre.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var gre=nre.UNOCCUPIED,yre=nre.INVADERS,mre=nre.DEFENDERS,kre=nre.PLAYER_ONE_KING,Cre=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(ht||(ht=ey(["Goal of the game"]))),$localize(dt||(dt=ey(["Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),are.getInitialState()),ane.anyMove($localize(vt||(vt=ey(["Moving"]))),$localize(pt||(pt=ey(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),are.getInitialState(),ere.of(new Rte(3,1),new Rte(1,1)),$localize(gt||(gt=ey(["Congratulations!"])))),ane.fromMove($localize(yt||(yt=ey(["Capturing a soldier (1/2)"]))),$localize(mt||(mt=ey(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new are([[gre,gre,gre,yre,gre,gre,gre],[gre,gre,gre,yre,gre,gre,gre],[yre,gre,gre,mre,gre,gre,gre],[gre,gre,mre,kre,mre,yre,yre],[gre,gre,yre,gre,gre,gre,gre],[gre,gre,gre,mre,gre,yre,gre],[gre,gre,gre,yre,gre,gre,gre]],1),[ere.of(new Rte(3,5),new Rte(2,5))],$localize(kt||(kt=ey(["Congratulations, that will teach him a lesson!"]))),$localize(Ct||(Ct=ey(["Failed, you missed an opportunity to capture a piece of the opponent."])))),ane.fromMove($localize(wt||(wt=ey(["Capturing a soldier (2/2)"]))),$localize(_t||(_t=ey(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new are([[gre,gre,gre,yre,gre,gre,gre],[gre,gre,yre,gre,gre,gre,gre],[gre,gre,gre,mre,gre,gre,gre],[yre,mre,gre,gre,mre,yre,yre],[gre,mre,gre,gre,gre,gre,gre],[gre,yre,gre,kre,gre,yre,gre],[gre,gre,gre,yre,gre,gre,gre]],12),[ere.of(new Rte(2,1),new Rte(3,1)),ere.of(new Rte(3,0),new Rte(3,1))],$localize(bt||(bt=ey(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(Et||(Et=ey(["Failed, you did not do the expected move."])))),ane.fromMove($localize(Pt||(Pt=ey(["Capturing the king on his throne"]))),$localize(St||(St=ey(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new are([[gre,gre,gre,gre,gre,gre,gre],[gre,gre,gre,mre,gre,gre,gre],[gre,gre,gre,yre,gre,gre,gre],[gre,yre,gre,kre,yre,gre,gre],[gre,gre,gre,yre,gre,gre,gre],[gre,mre,gre,gre,gre,gre,gre],[gre,gre,gre,gre,gre,gre,gre]],72),[ere.of(new Rte(1,3),new Rte(2,3))],$localize(Ot||(Ot=ey(["Congratulations, you won!"]))),$localize(Tt||(Tt=ey(["Failed, you let the king run away."])))),ane.fromMove($localize(It||(It=ey(["Capturing the king next to his throne"]))),$localize(At||(At=ey(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new are([[gre,gre,yre,gre,gre,gre,gre],[gre,gre,gre,yre,gre,gre,gre],[gre,gre,gre,kre,yre,gre,gre],[gre,yre,mre,gre,mre,gre,gre],[gre,gre,gre,yre,gre,gre,gre],[gre,gre,gre,gre,gre,gre,gre],[gre,gre,gre,gre,gre,gre,gre]],72),[ere.of(new Rte(2,0),new Rte(2,2))],$localize(Mt||(Mt=ey(["The king is dead, long live the king. Congratulations, you won."]))),$localize(xt||(xt=ey(["Failed!"])))),ane.fromMove($localize(Rt||(Rt=ey(["Capturing the king far from his throne"]))),$localize(Nt||(Nt=ey(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new are([[gre,gre,gre,gre,gre,gre,gre],[gre,gre,gre,gre,gre,gre,gre],[gre,yre,gre,yre,gre,gre,gre],[yre,gre,gre,gre,mre,gre,gre],[gre,gre,gre,mre,gre,gre,gre],[gre,gre,gre,gre,gre,gre,gre],[gre,kre,gre,yre,gre,gre,gre]],72),[ere.of(new Rte(3,6),new Rte(2,6))],$localize(Dt||(Dt=ey(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Lt||(Lt=ey(["Failed!"]))))]});function wre(e,t){1&e&&(zC(),NP(0,"polygon",8))}function _re(e,t){1&e&&(zC(),NP(0,"rect",9))}function bre(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,wre,1,0,"polygon",6),OP(2,_re,1,0,"ng-template",null,7,uI),RP()),2&e){var n=TP(3),r=GP().index,i=GP().index,a=GP();Wb(1),AP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Ere(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13),NP(4,"line",13),NP(5,"line",13),RP()),2&e){var n=GP(2).index,r=GP().index,i=GP();Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Pre(e,t){if(1&e&&(zC(),NP(0,"polyline",16)),2&e){var n=GP(3).index,r=GP().index;AP("ngClass",GP().viewInfo.pieceClasses[r][n])}}function Sre(e,t){if(1&e&&(zC(),NP(0,"line",13),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13)),2&e){var n=GP(3).index,r=GP().index,i=GP();AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Ore(e,t){if(1&e&&(zC(),OP(0,Pre,1,1,"polyline",14),OP(1,Sre,4,20,"ng-template",null,15,uI)),2&e){var n=TP(2),r=GP(2).index,i=GP().index;AP("ngIf",GP().isKing(r,i))("ngIfElse",n)}}function Tre(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",10),OP(2,Ere,6,25,"g",11),OP(3,Ore,3,2,"ng-template",null,12,uI),RP()),2&e){var n=TP(4),r=GP().index,i=GP().index,a=GP();Wb(1),qP("id","piece_",r,"_",i,""),AP("ngClass",a.viewInfo.pieceClasses[i][r]),_P("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),Wb(1),AP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Ire(e,t){if(1&e){var n=FP();zC(),xP(0,"g",3),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(1,"rect",4),OP(2,bre,4,2,"g",5),OP(3,Tre,5,8,"g",5),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();qP("id","click_",r,"_",i,""),_P("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),Wb(1),AP("ngClass",a.getRectClasses(r,i)),_P("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),Wb(1),AP("ngIf",a.board[i][r]!==a.EMPTY)}}function Are(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Ire,4,8,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Mre(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",17),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),qP("id","click_",r.x,"_",r.y,""),_P("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var xre=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e,!1,ere.from)).rules=sre.get(),r.availableMinimaxes=[new cre(r.rules,"DummyBot"),new dre(r.rules,"Piece > Influence"),new vre(r.rules,"Piece > Control"),new pre(r.rules,"Escape > Piece > Control")],r.encoder=ere.encoder,r.tutorial=(new Cre).tutorial,r}return Py(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(ure);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-brandhub"]],features:[cP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Are,2,1,"g",1),OP(2,Mre,2,6,"g",1),RP()),2&e&&(_P("viewBox",t.getViewBox()),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.getClickables()))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Rre=function(){var e,t=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return Py(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Rte(.5*this.SPACE_SIZE*e,i);return[o,new Rte(n,a),new Rte(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Rte(.5*this.SPACE_SIZE*e,a);return[o,new Rte(n,i),new Rte(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(Nte);return t.\u0275fac=function(n){return(e||(e=_w(t)))(n||t)},t.\u0275cmp=wk({type:t,selectors:[["ng-component"]],features:[cP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Nre=function(){var e=Py(function e(){by(this,e)});return e.INVALID_DISTANCE=function(){return $localize(Ft||(Ft=ey(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(Ut||(Ut=ey(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Vt||(Vt=ey(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Bt||(Bt=ey(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(zt||(zt=ey(["You cannot capture your own pieces."])))},e}(),Dre=function(){function e(t,n){by(this,e),this.direction=t,this.str=n}return Py(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(Nre.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();Dre.LEFT=new Dre(new Ste(-2,0),"LEFT"),Dre.UP_LEFT=new Dre(Ite.UP_LEFT,"UP_LEFT"),Dre.UP_RIGHT=new Dre(Ite.UP_RIGHT,"UP_RIGHT"),Dre.RIGHT=new Dre(new Ste(2,0),"RIGHT"),Dre.DOWN_LEFT=new Dre(Ite.DOWN_LEFT,"DOWN_LEFT"),Dre.DOWN_RIGHT=new Dre(Ite.DOWN_RIGHT,"DOWN_RIGHT"),Dre.STEPS=[Dre.LEFT,Dre.UP_LEFT,Dre.UP_RIGHT,Dre.RIGHT,Dre.DOWN_LEFT,Dre.DOWN_RIGHT];var Lre=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return Py(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new Rte(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(zB.of(e),zB.of(t),zB.of(r),zB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(zB.empty(),zB.empty(),zB.empty(),zB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=Dre.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(jte);Lre.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?Lre.fromTilesExchange(new Rte(n,t)):Lre.fromMovement(new Rte(n,t),Dre.STEPS[e-1])}}]),n}(a9));var Fre=function(){function e(){by(this,e)}return Py(e,null,[{key:"getNeighbors",value:function(e){var t=new Rte(e.x-1,e.y),n=new Rte(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new Rte(e.x,e.y-1)]:[t,n,new Rte(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new Rte(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return zB.of(o);s++}a++}return zB.empty()}},{key:"isSpaceDark",value:function(e){return(e.x+e.y)%2==0}}]),e}(),Ure=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Cy(Fre.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(qte),Vre=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return Py(n,[{key:"applyLegalMovement",value:function(e){FB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=Lte.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Lte.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){FB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Cy(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return Fre.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,Lte.EMPTY).length}},{key:"capture",value:function(e){FB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return FB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=Lte.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){FB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Cy(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===Lte.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){$7(this.getPieceAt(e)!==Lte.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Ste(n,t),1);if(this.getPieceAt(r)!==Lte.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=zB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==Lte.UNREACHABLE&&(r.isAbsent()&&(r=zB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){FB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=Lte.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Cy(Dre.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===Lte.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new Rte(n,t),Lte.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new Rte(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new Rte(e.x+1,e.y-1),new Rte(e.x+3,e.y+0),new Rte(e.x+3,e.y+1),new Rte(e.x+1,e.y+2),new Rte(e.x-1,e.y+1),new Rte(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=Lte.EMPTY,t=Lte.UNREACHABLE,r=Lte.ZERO,i=Lte.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(Ure);Vre.VERBOSE=!1,Vre.NEIGHBORS_TILES_DIRECTIONS=[new Ste(0,-2),new Ste(3,-1),new Ste(3,1),new Ste(0,2),new Ste(-3,1),new Ste(-3,-1)],Vre.isInRange=function(e){return e.isInRange(15,10)};var Bre=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=Lte.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new Vre(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new Vre(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return FB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new Vre(a.board,t.turn+1,a.tiles,a.captures);return FB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return HB.failure(Nre.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===Lte.UNREACHABLE||n===Lte.EMPTY?HB.failure(Nre.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?HB.failure(Nre.CANNOT_CAPTURE_OWN_PIECES()):HB.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===Lte.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return HB.failure(n)}if(t.getPieceAt(e.landingCoord.get())===Lte.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return HB.failure(r)}var i=t.getPieceAt(e.start.get());return i===Lte.EMPTY?HB.failure(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?HB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?ene.ZERO_WON:t.captures[1]>=18?ene.ONE_WON:ene.ONGOING}}]),n}(tne);return e.VERBOSE=!1,e}(),zre=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=Lte.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new Rte(o,a);if(n.getPieceAt(s)===i){var u=Lre.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Rte(a,i);if(n.getPieceAt(o).is(r)){var s,u=Cy(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Lre.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=Bre.getGameStatus(e);if(t.isEndGame)return $te.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new $te(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return h9.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(Gte),Hre=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=Bre.getGameStatus(e);if(t.isEndGame)return $te.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=Cy(u9.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=Cy(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new $te(u)}},{key:"getPiecesMap",value:function(e){for(var t=new R9,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Rte(a,i),s=e.getPieceAt(o);s===Lte.ZERO?n.push(o):s===Lte.ONE&&r.push(o)}return t.set(u9.ZERO,new hre(n)),t.set(u9.ONE,new hre(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new R9,i=Cy(u9.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Cy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=u9.of(t.getPieceAt(e).value).getOpponent(),i=zB.empty(),a=zB.empty(),o=[],s=Fre.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=Cy(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=zB.of(c));else if(l===Lte.EMPTY){if(i.isPresent())return zB.empty();i=zB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=Cy(Dre.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return zB.of(new lre(new hre(o),new hre(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new hre(o);return zB.of(new lre(p,new hre([a.get()])))}return zB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=zB.empty(),a=Vre.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new Ste(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=zB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=Vre.getTilesUpperLeftCoord(e),i=Cy(Dre.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=Vre.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===Lte.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new R9,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new hre(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Cy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=zB.empty(),h=Cy(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=Cy(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=zB.of(new lre(l.directThreats,new hre(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=Cy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(zre);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),Gre=Lte.EMPTY,$re=Lte.UNREACHABLE,Zre=Lte.ZERO,qre=Lte.ONE,Wre=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Ht||(Ht=ey(["Board and goal of the game"]))),$localize(Gt||(Gt=ey(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),Vre.getInitialState()),ane.anyMove($localize($t||($t=ey(["Move"]))),$localize(Zt||(Zt=ey(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),Vre.getInitialState(),Lre.fromCoordToCoord(new Rte(3,5),new Rte(5,5)),$localize(qt||(qt=ey(["Congratulations! Let's see captures now."])))),ane.fromMove($localize(Wt||(Wt=ey(["Capture"]))),$localize(jt||(jt=ey(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new Vre([[$re,$re,$re,$re,$re,$re,Zre,Gre,Zre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Zre,Gre,Gre,Gre,Gre,Gre,Zre,Gre,Gre,$re,$re,$re],[Gre,qre,Gre,qre,Zre,qre,Gre,Gre,Zre,Gre,Gre,qre,Gre,qre,Gre],[qre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,qre,Gre,Gre,Gre,qre],[Gre,qre,Gre,qre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,qre,Gre,qre,Gre],[Gre,Zre,Gre,Zre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Zre,Gre,Zre,Gre],[Zre,Gre,Gre,Gre,Zre,Gre,Gre,Gre,Gre,Gre,Zre,Gre,Gre,Gre,Zre],[Gre,Zre,Gre,Zre,Gre,Gre,qre,Gre,qre,Gre,Gre,Zre,Gre,Zre,Gre],[$re,$re,$re,Gre,Gre,qre,Gre,Gre,Gre,qre,Gre,Gre,$re,$re,$re],[$re,$re,$re,$re,$re,$re,qre,Gre,qre,$re,$re,$re,$re,$re,$re]],3,[0,0],[0,0]),[Lre.fromCoordToCoord(new Rte(5,2),new Rte(4,1)),Lre.fromCoordToCoord(new Rte(3,4),new Rte(4,3))],$localize(Yt||(Yt=ey(["Congratulations!"]))),$localize(Kt||(Kt=ey(["Failed, you have not captured any piece."])))),ane.fromMove($localize(Qt||(Qt=ey(["Gain a tile"]))),$localize(Xt||(Xt=ey(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new Vre([[$re,$re,$re,$re,$re,$re,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,qre,Gre,Gre,$re,$re,$re,$re,$re,$re],[Gre,Gre,Gre,$re,$re,$re,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[Gre,Gre,qre,Gre,Gre,Gre,Gre,Zre,Gre,$re,$re,$re,$re,$re,$re],[Gre,Gre,Gre,qre,Gre,Gre,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Zre,$re,$re,$re],[Gre,Gre,Zre,Gre,Gre,qre,Gre,Gre,Gre,Gre,Zre,Gre,Gre,Gre,Zre],[Gre,Gre,Gre,Gre,Gre,Gre,qre,Gre,qre,Gre,Gre,Zre,Gre,Zre,Gre],[$re,$re,$re,Gre,Gre,qre,Gre,Gre,Gre,qre,Gre,Gre,$re,$re,$re],[$re,$re,$re,$re,$re,$re,qre,Gre,qre,$re,$re,$re,$re,$re,$re]],2,[0,0],[0,0]),[Lre.fromCoordToCoord(new Rte(2,6),new Rte(4,6)),Lre.fromCoordToCoord(new Rte(2,6),new Rte(3,5)),Lre.fromCoordToCoord(new Rte(2,6),new Rte(3,7))],$localize(Jt||(Jt=ey(["Congratulations!"]))),$localize(en||(en=ey(["Failed, you have not gained the two tiles that you could, try again!"])))),ane.fromMove($localize(tn||(tn=ey(["Exchanging a tile"]))),$localize(nn||(nn=ey(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new Vre([[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,Zre,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,Gre,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,Gre,qre,Gre,qre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,qre,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,qre,Gre,qre,$re,$re,$re,$re,$re,$re]],1,[0,2],[0,0]),[Lre.fromTilesExchange(new Rte(5,5))],$localize(rn||(rn=ey(["Congratulations!"]))),$localize(an||(an=ey(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),ane.fromMove($localize(on||(on=ey(["Special capture"]))),$localize(sn||(sn=ey(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new Vre([[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,Gre,Gre,Zre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,Zre,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Zre,qre,Gre,qre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,qre,Zre,Gre,Gre,Gre,$re,$re,$re,$re,$re,$re],[$re,$re,$re,Gre,Gre,qre,$re,$re,$re,$re,$re,$re,$re,$re,$re],[$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re,$re]],1,[0,0],[0,0]),[Lre.fromCoordToCoord(new Rte(7,6),new Rte(6,5)),Lre.fromCoordToCoord(new Rte(7,6),new Rte(8,5))],$localize(un||(un=ey(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(cn||(cn=ey(["Failed!"]))))]});function jre(e,t){if(1&e&&(zC(),NP(0,"polygon",13)),2&e){var n=GP().index,r=GP().index,i=GP();AP("ngClass",i.getPyramidClass(n,r)),_P("points",i.getPyramidCoordinate(n,r))}}function Yre(e,t){if(1&e&&(zC(),NP(0,"polygon",15)),2&e){var n=GP(2).index,r=GP().index,i=GP();AP("ngClass",i.getEmptyClass(n,r)),_P("points",i.getTriangleCoordinate(n,r))}}function Kre(e,t){if(1&e&&(zC(),OP(0,Yre,1,2,"polygon",14)),2&e){var n=GP().index,r=GP().index;AP("ngIf",GP().isEmptySpace(n,r))}}function Qre(e,t){if(1&e&&(zC(),NP(0,"polygon",16)),2&e){var n=GP().index,r=GP().index,i=GP();qP("id","dark_line_",n,"_",r,""),_P("points",i.getLineCoordinate(n,r))}}function Xre(e,t){if(1&e&&(zC(),NP(0,"polygon",17)),2&e){var n=GP().index,r=GP().index,i=GP();qP("id","dark_line_",n,"_",r,""),_P("points",i.getLineCoordinate(n,r))}}function Jre(e,t){if(1&e){var n=FP();zC(),xP(0,"g",8),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),OP(1,jre,1,2,"polygon",9),OP(2,Kre,1,1,"ng-template",null,10,uI),OP(4,Qre,1,3,"polygon",11),OP(5,Xre,1,3,"polygon",12),RP()}if(2&e){var r=t.$implicit,i=t.index,a=TP(3),o=GP().index,s=GP();qP("id","click_",i,"_",o,""),Wb(1),AP("ngIf",s.isPyramid(i,o))("ngIfElse",a),Wb(3),AP("ngIf",r!==s.NONE),Wb(1),AP("ngIf",r!==s.NONE)}}function eie(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Jre,6,6,"g",7),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function tie(e,t){if(1&e&&(zC(),NP(0,"polygon",18)),2&e){var n=t.$implicit;_P("points",GP().getTriangleCoordinate(n.x,n.y))}}function nie(e,t){if(1&e&&(zC(),NP(0,"polygon",19)),2&e){var n=GP();_P("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function rie(e,t){if(1&e&&(zC(),NP(0,"polygon",19)),2&e){var n=GP();_P("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function iie(e,t){if(1&e&&(zC(),NP(0,"polygon",20)),2&e){var n=GP();qP("id","selected_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),_P("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function aie(e,t){if(1&e&&(zC(),xP(0,"g",21),NP(1,"polygon",22),xP(2,"text",23),pS(3),RP(),RP()),2&e){var n=GP();Wb(1),_P("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),Wb(1),_P("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Wb(1),gS(n.tiles[0])}}function oie(e,t){if(1&e&&(zC(),xP(0,"g",24),NP(1,"polygon",25),xP(2,"text",26),pS(3),RP(),RP()),2&e){var n=GP();Wb(1),_P("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),Wb(1),_P("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Wb(1),gS(n.tiles[1])}}var sie=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=Lte.UNREACHABLE,r.chosenCoord=zB.empty(),r.lastStart=zB.empty(),r.lastEnd=zB.empty(),r.possibleLandings=[],r.scores=zB.of([0,0]),r.rules=new Bre(Vre),r.availableMinimaxes=[new zre(r.rules,"Normal"),new Hre(r.rules,"Piece > Threat > Tiles")],r.encoder=Lre.encoder,r.tutorial=(new Wre).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){this.chosenCoord=zB.empty(),this.state=this.getState(),this.scores=zB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=zB.empty(),this.lastEnd=zB.empty()),this.board=this.getState().board}},{key:"showHighlight",value:function(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=zB.empty(),this.possibleLandings=[]}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Rte(e,t),o=n.state.getCurrentPlayer(),r.abrupt("return",n.chosenCoord.equalsValue(a)?(n.cancelMoveAttempt(),ZB.SUCCESS):n.chosenCoord.isAbsent()||n.state.getPieceAt(a).is(o)?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=Lre.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=zB.of(e),t.showHighlight(),ZB.SUCCESS):t.cancelMove(Nre.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.possibleLandings.some(function(t){return t.equals(e)})){n.next=3;break}return r=Lre.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 3:return n.abrupt("return",t.cancelMove(Nre.INVALID_DISTANCE()));case 4:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===Lte.ZERO?this.getPlayerClass(u9.ZERO):n===Lte.ONE?this.getPlayerClass(u9.ONE):"captured-fill"}},{key:"isEmptySpace",value:function(e,t){return this.board[t][e]===Lte.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===Lte.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===Lte.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===Lte.EMPTY?(e+t)%2==1?"background":"background2":"captured-alternate-fill"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(Rre);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-coerceo"]],features:[cP],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0-fill"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1-fill"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,eie,2,1,"g",1),OP(2,tie,1,1,"polygon",2),OP(3,nie,1,1,"polygon",3),OP(4,rie,1,1,"polygon",3),OP(5,iie,1,3,"polygon",4),OP(6,aie,4,6,"g",5),OP(7,oie,4,6,"g",6),RP()),2&e&&(_P("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.possibleLandings),Wb(1),AP("ngIf",t.lastStart.isPresent()),Wb(1),AP("ngIf",t.lastEnd.isPresent()),Wb(1),AP("ngIf",t.chosenCoord.isPresent()),Wb(1),AP("ngIf",t.mustShowTilesOf(0)),Wb(1),AP("ngIf",t.mustShowTilesOf(1)))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),uie=function(){var e=Py(function e(){by(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(ln||(ln=ey(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(fn||(fn=ey(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(hn||(hn=ey(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(dn||(dn=ey(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(vn||(vn=ey(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(pn||(pn=ey(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(gn||(gn=ey(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),cie=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(h9.createTable(n.WIDTH,n.HEIGHT,s9.NONE),0)}}]),n}(qte);cie.WIDTH=17,cie.HEIGHT=17,cie.CENTRAL_ZONE_TOP_LEFT=new Rte(4,6),cie.CENTRAL_ZONE_BOTTOM_RIGHT=new Rte(12,10),cie.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],cie.ALL_SHELTERS=new x9(cie.SHELTERS_INDICES.flatMap(function(e){return[new Rte(e,0),new Rte(e,cie.HEIGHT-1),new Rte(0,e),new Rte(cie.WIDTH-1,e)]})).toList();var lie=function(e){fy(n,e);var t=dy(n);function n(e){return by(this,n),t.call(this,e.x,e.y)}return Py(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(cie.WIDTH,cie.HEIGHT)?HB.success(new n(e)):HB.failure("Move out of board")}}]),n}(Yte);lie.encoder=function(){function e(){by(this,e)}return Py(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){fy(a,r);var i=dy(a);function a(){var e;return by(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return Py(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Rte((r-=r%1)%e,i);return n(a)}}]),a}(a9))}}]),e}().getEncoder(cie.WIDTH,cie.HEIGHT,function(e){return lie.of(e).get()});var fie=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(cie.WIDTH,cie.HEIGHT)&&t.isInRange(cie.WIDTH,cie.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?HB.success(new n(e,t)):HB.failure(uie.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):HB.failure("Move out of board")}}]),n}(Qne);fie.encoder=Qne.getEncoder(cie.WIDTH,cie.HEIGHT,function(e,t){return fie.of(e,t).get()});var hie=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).coords=e,r}return Py(n,[{key:"addJump",value:function(e){var t=h9.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return HB.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Cy(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(cie.WIDTH,cie.HEIGHT))return HB.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return HB.failure(uie.INVALID_JUMP());return new hre(e).size()===e.length?HB.success(new n(e)):HB.failure(uie.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(jte);hie.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).coordEncoder=Rte.numberEncoder(cie.WIDTH,cie.HEIGHT),e}return Py(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){$7(null!=LB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=LB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return hie.of(t).get()}}]),n}(i9));var die=i9.disjunction3(lie.encoder,fie.encoder,hie.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),vie=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,cie)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=s9.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=s9.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new cie(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?HB.failure(uie.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?HB.failure(uie.MUST_DROP_IN_CENTRAL_ZONE()):HB.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?HB.failure(uie.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):HB.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return HB.failure(uie.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE());var n,r=Cy(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===s9.NONE)return HB.failure(uie.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Cy(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return HB.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new Rte(e.x+2,e.y),new Rte(e.x-2,e.y),new Rte(e.x,e.y+2),new Rte(e.x,e.y-2),new Rte(e.x+2,e.y+2),new Rte(e.x+2,e.y-2),new Rte(e.x-2,e.y+2),new Rte(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];hie.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Cy(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Cy(cie.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return ene.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return ene.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n)),n.singleton.get()}}]),n}(tne);vie.singleton=zB.empty();var pie=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}},{key:"sortByNumberOfJump",value:function(e){return e.sort(function(e,t){var n=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(t.isDrop()?1:t.isSimple()?2:t.coords.length)-n})}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=cie.CENTRAL_ZONE_TOP_LEFT,r=cie.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===s9.NONE&&t.push(lie.of(new Rte(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<cie.HEIGHT;r++)for(var i=0;i<cie.WIDTH;i++){var a=new Rte(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new Rte(t.x+1,t.y),new Rte(t.x-1,t.y),new Rte(t.x,t.y+1),new Rte(t.x,t.y-1),new Rte(t.x+1,t.y+1),new Rte(t.x+1,t.y-1),new Rte(t.x-1,t.y+1),new Rte(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=fie.of(t,a);o.isSuccess()&&vie.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new x9,i=Cy(vie.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=hie.of([t,a]).get();vie.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=vie.get().nextJumps(t,e),i=new x9(r),a=Cy(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new R9([{key:u9.ZERO,value:0},{key:u9.ONE,value:0}]),i=0;i<cie.HEIGHT;i++)for(var a=0;a<cie.WIDTH;a++){var o=new Rte(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new $te(s.getVictoryValue())}else{var u,c=100,l=Cy(cie.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===s9.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new $te(n)}}]),n}(Gte),gie=s9.NONE,yie=s9.ZERO,mie=s9.ONE,kie=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(yn||(yn=ey(["Board and aim of the game"]))),$localize(mn||(mn=ey(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),cie.getInitialState()),ane.anyMove($localize(kn||(kn=ey(["Initial phase"]))),$localize(Cn||(Cn=ey(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),cie.getInitialState(),lie.of(new Rte(7,7)).get(),$localize(wn||(wn=ey(["Congratulations!"])))),ane.fromPredicate($localize(_n||(_n=ey(["Simple move"]))),$localize(bn||(bn=ey(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new cie([[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,yie,mie,mie,yie,yie,mie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,mie,yie,mie,yie,yie,yie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,mie,gie,gie,gie,gie,gie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,yie,mie,mie,mie,yie,yie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,mie,mie,mie,mie,mie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie]],40),fie.of(new Rte(4,6),new Rte(3,5)).get(),function(e,t,n){return e.isSimple()?ZB.SUCCESS:ZB.failure($localize(En||(En=ey(["You have made a jump, not a simple move. Try again!"]))))},$localize(Pn||(Pn=ey(["Congratulations!"])))),ane.fromPredicate($localize(Sn||(Sn=ey(["Jumps"]))),$localize(On||(On=ey(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new cie([[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,yie,mie,mie,yie,yie,mie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,mie,yie,mie,yie,yie,yie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,mie,gie,gie,gie,gie,gie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,yie,mie,mie,mie,yie,yie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,mie,mie,mie,mie,mie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie]],40),hie.of([new Rte(6,7),new Rte(6,5)]).get(),function(e,t,n){return e.isJump()?ZB.SUCCESS:ZB.failure($localize(Tn||(Tn=ey(["You have not performed a jump. Try again!"]))))},$localize(In||(In=ey(["Congratulations!"])))),ane.fromMove($localize(An||(An=ey(["Chaining jumps in a single move"]))),$localize(Mn||(Mn=ey(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new cie([[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,mie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,mie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,mie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,yie,gie,mie,yie,yie,mie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,gie,yie,mie,yie,yie,yie,yie,mie,gie,gie,gie,gie],[gie,gie,gie,gie,yie,mie,gie,gie,gie,gie,gie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,yie,mie,mie,mie,yie,yie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,mie,yie,mie,mie,mie,mie,mie,mie,yie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie],[gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie,gie]],40),[hie.of([new Rte(8,6),new Rte(6,4),new Rte(6,2),new Rte(6,0)]).get()],$localize(xn||(xn=ey(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Rn||(Rn=ey(["You have not performed a triple jump. Try again!"]))))]});function Cie(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",9),BP("click",function(){hC(n);var e=GP().$implicit;return GP(2).onClick(e.coord)}),RP()}if(2&e){var r=GP().$implicit,i=GP(2);_P("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function wie(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",6),BP("click",function(){hC(n);var e=GP().$implicit;return GP(2).onClick(e.coord)}),RP()}if(2&e){var r=GP(),i=r.index,a=r.$implicit,o=GP().index,s=GP();qP("id","piece_",i,"_",o,""),AP("ngClass",a.pieceClasses),_P("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function _ie(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",6),BP("click",function(){var e=hC(n).$implicit;return GP(2).onClick(e.coord)}),RP(),OP(2,Cie,1,4,"rect",7),OP(3,wie,1,6,"circle",8),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","click_",i,"_",a,""),AP("ngClass",r.squareClasses),_P("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r.isShelter),Wb(1),AP("ngIf",r.hasPiece)}}function bie(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,_ie,4,9,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Eie(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",10),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),AP("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),_P("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Pie(e,t){if(1&e&&(zC(),NP(0,"circle",11)),2&e){var n=t.$implicit,r=GP();ZP("id","sidePiece_0_",n,""),_P("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Sie(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=t.$implicit,r=GP();ZP("id","sidePiece_1_",n,""),_P("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Oie(e,t){if(1&e&&(zC(),NP(0,"rect",13)),2&e){var n=GP();_P("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var Tie=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).ALL_SHELTERS=cie.ALL_SHELTERS,r.CENTRAL_ZONE_START=cie.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Ste(cie.CENTRAL_ZONE_BOTTOM_RIGHT.x-cie.CENTRAL_ZONE_TOP_LEFT.x+1,cie.CENTRAL_ZONE_BOTTOM_RIGHT.y-cie.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=zB.empty(),r.jumpInConstruction=zB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=vie.get(),r.availableMinimaxes=[new pie(r.rules,"ConspirateursMinimax")],r.encoder=die,r.tutorial=(new kie).tutorial,r}return Py(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<cie.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<cie.WIDTH;n++){var r=new Rte(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Cy(cie.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Cy(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved-fill")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected-stroke")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=vie.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Cy(cie.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory-fill")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";var t,n=Cy(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=zB.empty(),this.selected=zB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected.equalsValue(e)?t.cancelMoveAttempt():(t.selected=zB.of(e),t.jumpInConstruction=zB.empty()),t.updateViewInfo(),ZB.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=lie.of(e),n.abrupt("return",($7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=zB.of(e),t.updateViewInfo(),ZB.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=fie.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=hie.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(Nte);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-conspirateurs"]],features:[cP],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,bie,2,1,"g",1),OP(2,Eie,2,5,"g",1),OP(3,Pie,1,4,"circle",2),OP(4,Sie,1,4,"circle",3),OP(5,Oie,1,4,"rect",4),NP(6,"polyline",5),RP()),2&e&&(Wb(1),AP("ngForOf",t.viewInfo.boardInfo),Wb(1),AP("ngForOf",t.ALL_SHELTERS),Wb(1),AP("ngForOf",t.range(t.viewInfo.sidePieces[0])),Wb(1),AP("ngForOf",t.range(t.viewInfo.sidePieces[1])),Wb(1),AP("ngIf",t.viewInfo.dropPhase),Wb(1),_P("points",t.viewInfo.lastMoveArrow))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Iie=function(){function e(t,n){by(this,e),this.owner=t,this.otherPieceType=n}return Py(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===u9.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===u9.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();Iie.encoder=a9.tuple([u9.numberEncoder,a9.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return Iie.of(e[0],e[1])}),Iie.EMPTY=new Iie(s9.NONE,!1),Iie.ZERO_FIRST=new Iie(u9.ZERO,!1),Iie.ZERO_SECOND=new Iie(u9.ZERO,!0),Iie.ONE_FIRST=new Iie(u9.ONE,!1),Iie.ONE_SECOND=new Iie(u9.ONE,!0),Iie.PLAYER_PIECES=[Iie.ZERO_FIRST,Iie.ZERO_SECOND,Iie.ONE_FIRST,Iie.ONE_SECOND];var Aie=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;if(by(this,n),(i=t.call(this)).target=e,i.piece=r,r===Iie.EMPTY)throw new Error("Cannot drop an empty piece");return vy(i)}return Py(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(jte);Aie.encoder=a9.tuple([a9.numberEncoder(7),Iie.encoder],function(e){return[e.target,e.piece]},function(e){return new Aie(e[0],e[1])});var Mie=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return Py(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new Rte(e.x,3-e.y),t)}}]),n}(jte);Mie.encoder=a9.tuple([Rte.numberEncoder(8,4),a9.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new Mie(e[0],e[1]?"clockwise":"counterclockwise")});var xie=a9.disjunction(Aie.encoder,Mie.encoder,function(e){return e.isDrop()}),Rie=function(){var e=Py(function e(){by(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Nn||(Nn=ey(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(Dn||(Dn=ey(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Ln||(Ln=ey(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(Fn||(Fn=ey(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(Un||(Un=ey(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),Nie=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return Py(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==Iie.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=Iie.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==Iie.EMPTY&&i[n.pieceIndex(s)]--}return $7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case Iie.ZERO_FIRST:return 0;case Iie.ZERO_SECOND:return 1;case Iie.ONE_FIRST:return 2;default:return LB.expectToBe(e,Iie.ONE_SECOND),3}}}]),n}(qte);return e.WIDTH=8,e.HEIGHT=4,e}(),Die=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,Nie)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=h9.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=h9.copyImmutableArray(t.remainingPieces);return r[Nie.pieceIndex(e.piece)]-=1,new Nie(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=h9.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<Nie.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==Iie.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=Iie.EMPTY,i++,a++;return new Nie(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?HB.failure(Rie.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===Nie.HEIGHT?HB.failure(Rie.SPACE_IS_FULL()):HB.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Nie.HEIGHT?HB.failure(Rie.TARGET_STACK_TOO_HIGH()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return $7(n.owner.isPlayer(),"highest alignment is owned by a player"),ene.getVictory(n.owner)}return ene.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<Nie.WIDTH/2;t++)for(var n=Nie.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Nie.WIDTH/2,n);if(r!==Iie.EMPTY&&r===i)return zB.of(new Rte(t,n))}return zB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new Mie(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new Mie(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n)),n.singleton.get()}}]),n}(tne);Die.singleton=zB.empty();var Lie=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Cy(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new Mie(i,"clockwise"),new Mie(i,"counterclockwise")];a<o.length;a++){var s=o[a];Die.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<Nie.WIDTH;r++){var i,a=Cy(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new Aie(r,o);Die.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Cy(Iie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Nie.HEIGHT;r++)for(var i=0;i<Nie.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new Rte(i,r));return t}},{key:"getBoardValue",value:function(e){var t=Die.get().getGameStatus(e);return new $te(t.isEndGame?t.toBoardValue():0)}}]),n}(Gte),Fie=Iie.EMPTY,Uie=Iie.ZERO_FIRST,Vie=Iie.ZERO_SECOND,Bie=Iie.ONE_FIRST,zie=Iie.ONE_SECOND,Hie=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Vn||(Vn=ey(["Initial board and player pieces"]))),$localize(Bn||(Bn=ey(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),Nie.getInitialState()),ane.fromMove($localize(zn||(zn=ey(["Goal of the game"]))),$localize(Hn||(Hn=ey(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),Nie.fromRepresentation([[Fie,Fie,Fie,Fie,Fie,Fie,Fie,Fie],[Fie,Fie,Fie,Fie,Fie,Fie,Fie,Fie],[Fie,Fie,Fie,Fie,Bie,Fie,Fie,Fie],[Uie,Fie,Fie,Fie,Uie,Fie,Fie,Fie]],3),[new Aie(0,Iie.ONE_FIRST)],$localize(Gn||(Gn=ey(["Congratulations, you won!"]))),$localize($n||($n=ey(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),ane.fromMove($localize(Zn||(Zn=ey(["Types of move"]))),$localize(qn||(qn=ey(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),Nie.fromRepresentation([[Fie,Fie,Fie,Fie,Fie,Fie,Fie,Fie],[Fie,Fie,Fie,Fie,zie,Fie,Fie,Fie],[Fie,Fie,Fie,Fie,Uie,Fie,Fie,Fie],[Bie,Fie,Fie,Fie,Vie,Fie,Fie,Fie]],4),[Mie.fromRepresentation(new Rte(4,3),"counterclockwise"),Mie.fromRepresentation(new Rte(4,3),"clockwise"),Mie.fromRepresentation(new Rte(4,2),"counterclockwise"),Mie.fromRepresentation(new Rte(4,2),"clockwise")],$localize(Wn||(Wn=ey(["Congratulations!"]))),$localize(jn||(jn=ey(["Failed, try to move one of your piece that is already on the board."])))),ane.fromMove($localize(Yn||(Yn=ey(["Special case"]))),$localize(Kn||(Kn=ey(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),Nie.fromRepresentation([[Fie,Fie,Fie,Fie,Uie,Fie,Fie,Fie],[Fie,Fie,Fie,Fie,zie,Fie,Fie,Uie],[Fie,Fie,Fie,Fie,Uie,Fie,Fie,zie],[Fie,Bie,Fie,Fie,Vie,Fie,Fie,Bie]],8),[Mie.fromRepresentation(new Rte(4,2),"counterclockwise")],$localize(Qn||(Qn=ey(["Congratulations!"]))),$localize(Xn||(Xn=ey(["Failed, try to shift a stack of pieces to the left."]))))]});function Gie(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"path",5),BP("click",function(){var e=hC(n).$implicit;return GP().onSpaceClick(e)}),RP(),xP(2,"path",6),BP("click",function(){var e=hC(n).$implicit;return GP().onSpaceClick(e)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),ZP("id","click_",r,""),AP("ngClass",i.viewInfo.boardInfo[r].spaceClasses),_P("d",i.BOARD_PATHS[r]),Wb(1),AP("ngClass",i.viewInfo.boardInfo[r].spaceClasses),_P("d",i.DECORATION_PATHS[r])}}function $ie(e,t){if(1&e){var n=FP();zC(),xP(0,"g",8),BP("click",function(){var e=hC(n).$implicit,t=GP().$implicit;return GP().onPieceInGameClick(t,e.y)}),NP(1,"use",9),NP(2,"use",10),RP()}if(2&e){var r=t.$implicit;qP("id","click_",GP().$implicit,"_",r.y,""),AP("ngClass",r.foregroundClasses),Wb(1),AP("ngClass",r.backgroundClasses),_P("x",r.drawPosition.x)("y",r.drawPosition.y),Wb(1),_P("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Zie(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,$ie,3,8,"g",7),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function qie(e,t){if(1&e){var n=FP();zC(),xP(0,"g",12),BP("click",function(){var e=hC(n),t=e.$implicit,r=e.index;return GP(2).onRemainingPieceClick(t.actualPiece,r)}),NP(1,"use",9),NP(2,"use",10),RP()}if(2&e){var r=t.$implicit,i=t.index;WP("id","piece_",r.actualPiece.owner.toString(),"_",r.actualPiece.otherPieceType?1:0,"_",i,""),AP("ngClass",r.foregroundClasses),Wb(1),AP("ngClass",r.backgroundClasses),_P("x",r.drawPosition.x)("y",r.drawPosition.y),Wb(1),_P("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Wie(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,qie,3,9,"g",11),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",r.viewInfo.remainingPieces.get(n).get())}}var jie=function(){return[0,1,2,3,4,5,6,7]},Yie=function(){return[2,1,3,0,4,7,5,6]},Kie=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=zB.empty(),r.viewInfo={boardInfo:[],remainingPieces:new R9([{key:u9.ZERO,value:[]},{key:u9.ONE,value:[]}])},r.rules=Die.get(),r.availableMinimaxes=[new Lie(r.rules,"DiamDummyMinimax")],r.encoder=xie,r.tutorial=(new Hie).tutorial,r}return Py(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new Aie(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%Nie.WIDTH!==e){n.next=10;break}i=new Mie(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(Nie.WIDTH-1))%Nie.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(Rie.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new Mie(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(Rie.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Rte(e,t),r.abrupt("return",n.getState().getPieceAt(a).owner===n.getCurrentPlayer()?(n.isSelected(null,a)?n.cancelMoveAttempt():n.selected=zB.of({type:"pieceFromBoard",position:a}),n.updateViewInfo(),ZB.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()));case 5:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay(n.getPieceId(e,t)),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?zB.empty():zB.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),ZB.SUCCESS):n.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceId",value:function(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}},{key:"isSelected",value:function(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new Rte(r,i);return[{start:zB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<Nie.HEIGHT&&t.getPieceAtXY(n,o)!==Iie.EMPTY;o++,i++)a.push({start:zB.of(new Rte(n,o)),end:new Rte(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<Nie.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;$7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<Nie.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved-fill"):(t.getTarget()===n||t.start.x===n)&&r.push("moved-fill"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;$7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Cy(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move-stroke")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new R9([{key:u9.ZERO,value:[]},{key:u9.ONE,value:[]}]);var t,n=this.isPlayerTurn(),r=Cy(Iie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected-stroke"),n&&o===a-1&&i.owner===e&&s.push("clickable-stroke-hover");var u=this.viewInfo.remainingPieces.get(i.owner).get(),c=[];c.push(i.otherPieceType?"player"+i.owner.value+"-alternate-fill":"player"+i.owner.value+"-fill"),u.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i}),this.viewInfo.remainingPieces.put(i.owner,u)}}catch(l){r.e(l)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===u9.ZERO?-100:600,i=e.otherPieceType?100:450,new Rte(r,i).getNext(new Ste(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<Nie.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new Rte(e,i);if(a!==Iie.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected-stroke"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-stroke-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Ste(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=zB.empty(),this.updateBoard()}}]),n}(Nte);Kie.CENTER=[new Rte(40,160),new Rte(100,50),new Rte(255,2),new Rte(400,50),new Rte(460,160),new Rte(400,270),new Rte(255,320),new Rte(100,270)],Kie.PIECE_HEIGHT=36,Kie.\u0275fac=function(e){return new(e||Kie)(IP(H7))},Kie.\u0275cmp=wk({type:Kie,selectors:[["app-diam"]],features:[cP],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"defs"),xP(2,"g",1),NP(3,"path",2),NP(4,"ellipse",3),RP(),RP(),OP(5,Gie,3,5,"g",4),OP(6,Zie,2,1,"g",4),OP(7,Wie,2,1,"g",4),RP()),2&e&&(Wb(5),AP("ngForOf",FT(3,jie)),Wb(1),AP("ngForOf",FT(4,Yie)),Wb(1),AP("ngForOf",t.Player.PLAYERS))},directives:[hM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Qie=function(){function e(t,n){by(this,e),this.offset=t,this.constant=n}return Py(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return Fte.DOWN;case"r":return Fte.RIGHT;case"s":return Fte.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?zB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?zB.of(e.constantR(a)):r!==i&&a!==o&&s===u?zB.of(e.constantS(s)):zB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Cy(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),Xie=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedSpaces=o,u.empty=s,$7(u.excludedSpaces.length<u.height/2+1,"Invalid excluded spaces specification for HexagonalGameState."),u}return Py(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(var n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;var r,i=Cy(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(Qie.constantQ(t));for(var n=0;n<this.height;n++)e.push(Qie.constantR(n));for(var r=this.excludedSpaces.length;r<this.height+this.excludedSpaces.length;r++)e.push(Qie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new Rte(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new Rte(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new Rte(e.offset,0):new Rte(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=G7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new Rte(e.x+t,e.y-t),new Rte(e.x+t,e.y),new Rte(e.x-t,e.y+t),new Rte(e.x-t,e.y),new Rte(e.x,e.y+t),new Rte(e.x,e.y-t)]}}]),n}(qte),Jie=function(){function e(t,n,r){by(this,e),this.owner=t,this.size=n,this.source=r}return Py(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Jie.sizeEncoder=a9.numberEncoder(49),Jie.encoder=a9.tuple([a9.booleanEncoder,u9.numberEncoder,Jie.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Jie(e[1],e[2],e[0])}),Jie.MAX_SIZE=49,Jie.EMPTY=new Jie(s9.NONE,0,!1),Jie.UNREACHABLE=new Jie(s9.NONE,-1,!1),Jie.PLAYER_ZERO=new Jie(u9.ZERO,1,!1),Jie.PLAYER_ONE=new Jie(u9.ONE,1,!1),Jie.SOURCE=new Jie(s9.NONE,1,!0);var eae=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Jie.EMPTY)).alreadyPassed=i,a}return Py(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new Rte(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return Xie.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=h9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Jie.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=Jie.UNREACHABLE,t=Jie.PLAYER_ZERO,n=Jie.PLAYER_ONE,r=Jie.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Jie.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(Xie);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e}(),tae=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!eae.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!eae.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(Qne);tae.PASS=new tae(new Rte(-1,-1),new Rte(-2,-2)),tae.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return tae.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new tae(new Rte((e=e/16|0)%16,r),new Rte(n,t))}}]),n}(a9));var nae=function(){var e=Py(function e(){by(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Jn||(Jn=ey(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(er||(er=ey(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(tr||(tr=ey(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(nr||(nr=ey(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(rr||(rr=ey(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(ir||(ir=ey(["The stack must land on an occupied space."])))},e}(),rae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isMovablePiece",value:function(e,t){$7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?ZB.failure(nae.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?ZB.failure(nae.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?ZB.SUCCESS:ZB.failure(nae.CANT_REACH_TARGET()):ZB.failure(nae.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;Xie.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=h9.createTable(eae.WIDTH,eae.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Jie.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===tae.PASS)return new eae(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Jie.EMPTY).setAt(e.end,Jie.append(r,i));return this.removeDisconnectedPieces(new eae(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==tae.PASS||t.alreadyPassed?HB.failure(Hte.MUST_PASS()):HB.success(void 0);if(e===tae.PASS)return HB.failure(Hte.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?HB.failure(nae.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?HB.failure(nae.EMPTY_TARGET_STACK()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?ene.ZERO_WON:r[0]<r[1]?ene.ONE_WON:ene.DRAW:ene.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==Xie.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return Xie.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(u9.ZERO)?t+=i.getSize():i.belongsTo(u9.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(tne),iae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return rae.getMovablePieces(n).forEach(function(e){return rae.pieceTargets(n,e).forEach(function(t){var n=tae.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(tae.PASS)&&r.push(tae.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=rae.getScores(t);return 0===rae.getMovablePieces(t).length?new $te(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new $te(n[0]-n[1])}}]),n}(Gte),aae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=cy(yy(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return h9.sortByDescending(r,function(e){$7(e!==tae.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=rae.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n=e.gameState,r=rae.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(u9.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(u9.ONE)}).length;return new $te((s*r[1]-o*r[0])/a)}}]),n}(iae),oae=Jie.EMPTY,sae=Jie.UNREACHABLE,uae=Jie.SOURCE,cae=Jie.PLAYER_ZERO,lae=Jie.PLAYER_ONE,fae=new Jie(u9.ZERO,2,!1),hae=new Jie(u9.ONE,2,!1),dae=new Jie(u9.ZERO,4,!1),vae=new Jie(u9.ONE,4,!1),pae=Py(function e(){by(this,e),this.tutorial=[ane.anyMove($localize(ar||(ar=ey(["Moving"]))),$localize(or||(or=ey(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),eae.getInitialState(),tae.of(new Rte(2,0),new Rte(3,0)),$localize(sr||(sr=ey(["Congratulations!"])))),ane.fromPredicate($localize(ur||(ur=ey(["Disconnection"]))),$localize(cr||(cr=ey(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new eae([[sae,sae,lae,uae,oae,oae,oae,oae,oae,oae,oae],[sae,oae,cae,oae,oae,oae,oae,oae,oae,oae,oae],[oae,oae,vae,oae,oae,oae,oae,lae,uae,oae,oae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,oae,sae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,sae,sae]],0,!1),tae.of(new Rte(2,1),new Rte(2,0)),function(e,t,n){return e.end.equals(new Rte(3,0))?ZB.failure($localize(lr||(lr=ey(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):($7(e.end.equals(new Rte(2,0)),"player made an impossible move"),ZB.SUCCESS)},$localize(fr||(fr=ey(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),ane.fromPredicate($localize(hr||(hr=ey(["Moving on a source"]))),$localize(dr||(dr=ey(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new eae([[sae,sae,uae,lae,oae,oae,oae,oae,oae,oae,oae],[sae,cae,cae,oae,oae,oae,oae,oae,oae,oae,oae],[oae,lae,cae,lae,oae,oae,cae,hae,uae,oae,oae],[oae,oae,lae,oae,oae,oae,oae,oae,oae,oae,sae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,sae,sae]],0,!1),tae.of(new Rte(2,1),new Rte(2,0)),function(e,t,n){return e.end.equals(new Rte(2,0))?ZB.SUCCESS:ZB.failure($localize(vr||(vr=ey(["You have not taken possession of a source, try again."]))))},$localize(pr||(pr=ey(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),ane.informational($localize(gr||(gr=ey(["Passing"]))),$localize(yr||(yr=ey(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new eae([[sae,sae,uae,oae,oae,oae,oae,oae,oae,oae,oae],[sae,oae,fae,oae,oae,oae,oae,oae,oae,oae,oae],[oae,oae,hae,oae,oae,oae,oae,hae,uae,dae,oae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,oae,sae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,sae,sae]],0,!1)),ane.fromMove($localize(mr||(mr=ey(["End of the game"]))),$localize(kr||(kr=ey(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new eae([[sae,sae,uae,oae,oae,oae,oae,oae,oae,oae,oae],[sae,oae,cae,oae,oae,oae,oae,oae,oae,oae,oae],[oae,oae,oae,oae,oae,oae,oae,oae,uae,dae,oae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,oae,sae],[oae,oae,oae,oae,oae,oae,oae,oae,oae,sae,sae]],0,!1),[tae.of(new Rte(2,1),new Rte(2,0))],$localize(Cr||(Cr=ey(["Congratulations, you won 6 - 0!"]))),$localize(wr||(wr=ey(["Bad idea, by moving on the source you would have won a point."]))))]});function gae(e,t){if(1&e&&(zC(),NP(0,"circle",10)),2&e){var n=GP().$implicit,r=GP().$implicit,i=GP();AP("ngClass",i.getPieceClasses(n)),_P("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function yae(e,t){if(1&e&&(zC(),NP(0,"polygon",11)),2&e){var n=GP().$implicit,r=GP().$implicit,i=GP();_P("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function mae(e,t){if(1&e){var n=FP();zC(),xP(0,"text",12),BP("click",function(){hC(n);var e=GP(2).$implicit;return GP().onClick(e.x,e.y)}),pS(1),RP()}if(2&e){var r=GP().$implicit,i=GP().$implicit,a=GP();_P("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),Wb(1),gS(r.getSize())}}function kae(e,t){if(1&e){var n=FP();zC(),xP(0,"g",5),BP("click",function(){hC(n);var e=GP().$implicit;return GP().onClick(e.x,e.y)}),NP(1,"polygon",6),OP(2,gae,1,4,"circle",7),OP(3,yae,1,1,"polygon",8),OP(4,mae,2,3,"text",9),RP()}if(2&e){var r=t.$implicit,i=GP().$implicit,a=GP();qP("id","click_",i.x,"_",i.y,""),Wb(1),_P("points",a.getHexaCoordsAt(i)),Wb(1),AP("ngIf",r.getSize()>0),Wb(1),AP("ngIf",r.containsSource()),Wb(1),AP("ngIf",r.getSize()>1)}}var Cae=function(e){return[e]};function wae(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,kae,5,6,"g",4),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",UT(1,Cae,r.state.getPieceAt(n)))}}function _ae(e,t){if(1&e&&(zC(),xP(0,"text",16),pS(1),RP()),2&e){var n=GP().$implicit,r=GP();_P("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),Wb(1),gS(n.spaceContent.getSize())}}function bae(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"polygon",13),NP(2,"circle",14),OP(3,_ae,2,3,"text",15),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),_P("points",r.getHexaCoordsAt(n.coord)),Wb(1),qP("id","captured_",n.coord.x,"_",n.coord.y,""),AP("ngClass",r.getPieceClasses(n.spaceContent)),_P("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),Wb(1),AP("ngIf",n.spaceContent.getSize()>1)}}function Eae(e,t){if(1&e&&(zC(),DP(0),NP(1,"polygon",17),NP(2,"polygon",17),LP()),2&e){var n=GP();Wb(1),_P("points",n.getHexaCoordsAt(n.lastMove.get().coord)),Wb(1),_P("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function Pae(e,t){if(1&e&&(zC(),NP(0,"polygon",18)),2&e){var n=GP();_P("points",n.getHexaCoordsAt(n.chosen.get()))}}var Sae=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).lastMove=zB.empty(),r.chosen=zB.empty(),r.disconnecteds=[],r.rules=new rae(eae),r.availableMinimaxes=[new iae(r.rules,"DvonnMinimax"),new aae(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=tae.encoder,r.tutorial=(new pae).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=zB.of(rae.getScores(r.getState())),r.hexaLayout=new Ute(1.5*r.SPACE_SIZE,new Rte(-r.SPACE_SIZE,2*r.SPACE_SIZE),Bte.INSTANCE),r.state=r.getState(),r.hexaBoard=r.getState().board,r}return Py(n,[{key:"hideLastMove",value:function(){this.lastMove=zB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=zB.of(rae.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.getState(),n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new Rte(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new Rte(r,n),spaceContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=zB.empty()}},{key:"pass",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(tae.PASS,e.getState());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new Rte(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),ZB.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new Rte(e,t),r=this.rules.isMovablePiece(this.getState(),n);return r.isSuccess()?(this.chosen=zB.of(n),ZB.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Rte(e,t),o=tae.of(i,a),r.abrupt("return",n.chooseMove(o,n.getState()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"nonplayer-stroke","dashed-stroke"]:[t]}}]),n}(Dte);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-dvonn"]],features:[cP],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,wae,2,3,"g",1),OP(2,bae,4,8,"g",1),OP(3,Eae,3,2,"ng-container",2),OP(4,Pae,1,1,"polygon",3),RP()),2&e&&(Wb(1),AP("ngForOf",t.state.allCoords()),Wb(1),AP("ngForOf",t.disconnecteds),Wb(1),AP("ngIf",t.lastMove.isPresent()),Wb(1),AP("ngIf",t.chosen.isPresent()))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Oae=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(Oae||(Oae={})),Oae),Tae=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return u9.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return u9.ONE;default:return s9.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return Oae.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return Oae.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return Oae.SMALL;default:return LB.expectToBe(this,e.NONE),Oae.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return LB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===u9.ZERO&&t===Oae.BIG?e.BIG_DARK:n===u9.ZERO&&t===Oae.MEDIUM?e.MEDIUM_DARK:n===u9.ZERO&&t===Oae.SMALL?e.SMALL_DARK:n===u9.ONE&&t===Oae.BIG?e.BIG_LIGHT:n===u9.ONE&&t===Oae.MEDIUM?e.MEDIUM_LIGHT:n===u9.ONE&&t===Oae.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();Tae.SMALL_DARK=new Tae(0),Tae.SMALL_LIGHT=new Tae(1),Tae.MEDIUM_DARK=new Tae(2),Tae.MEDIUM_LIGHT=new Tae(3),Tae.BIG_DARK=new Tae(4),Tae.BIG_LIGHT=new Tae(5),Tae.NONE=new Tae(6);var Iae=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return Py(n,[{key:"getRemainingPieces",value:function(){return h9.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new Aae(s9.NONE,s9.NONE,s9.NONE).encode(),t=h9.createTable(3,3,e);return new n(h9.mapBiArray(t,function(e){return Aae.decode(e)}),0,[Tae.BIG_DARK,Tae.BIG_DARK,Tae.BIG_LIGHT,Tae.BIG_LIGHT,Tae.MEDIUM_DARK,Tae.MEDIUM_DARK,Tae.MEDIUM_LIGHT,Tae.MEDIUM_LIGHT,Tae.SMALL_DARK,Tae.SMALL_DARK,Tae.SMALL_LIGHT,Tae.SMALL_LIGHT])}}]),n}(qte),Aae=function(){function e(t,n,r){by(this,e),this.small=t,this.medium=n,this.big=r}return Py(e,[{key:"isEmpty",value:function(){return this.small===s9.NONE&&this.medium===s9.NONE&&this.big===s9.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(Tae.ofSizeAndPlayer(Oae.SMALL,this.small)),this.medium.isPlayer()&&e.push(Tae.ofSizeAndPlayer(Oae.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Tae.ofSizeAndPlayer(Oae.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=Tae.ofSizeAndPlayer(Oae.SMALL,this.small),t=Tae.ofSizeAndPlayer(Oae.MEDIUM,this.medium),n=Tae.ofSizeAndPlayer(Oae.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===u9.ZERO?Tae.BIG_DARK:this.big===u9.ONE?Tae.BIG_LIGHT:this.medium===u9.ZERO?Tae.MEDIUM_DARK:this.medium===u9.ONE?Tae.MEDIUM_LIGHT:this.small===u9.ZERO?Tae.SMALL_DARK:this.small===u9.ONE?Tae.SMALL_LIGHT:Tae.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===Tae.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?zB.of(this.put(e)):zB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===Tae.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case Oae.BIG:t=new e(this.small,this.medium,s9.NONE);break;case Oae.MEDIUM:t=new e(this.small,s9.NONE,s9.NONE);break;default:LB.expectToBe(r,Oae.SMALL),t=new e(s9.NONE,s9.NONE,s9.NONE)}return{removedSpace:t,removedPiece:n}}},{key:"put",value:function(t){if(t===Tae.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case Oae.BIG:return new e(this.small,this.medium,n);case Oae.MEDIUM:return $7(this.big===s9.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return LB.expectToBe(r,Oae.SMALL),$7(this.big===s9.NONE,"Cannot put a piece on top of a bigger one"),$7(this.medium===s9.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){$7(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),$7(t>=0,"To small representation for EncapsuleSpace: "+t),$7(t<=26,"To big representation for EncapsuleSpace: "+t);var n=u9.numberEncoder.decodeNumber(t%3);t-=n.value;var r=u9.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,u9.numberEncoder.decodeNumber(t/=3))}}]),e}();Aae.EMPTY=new Aae(s9.NONE,s9.NONE,s9.NONE);var Mae=function(){var e=Py(function e(){by(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(_r||(_r=ey(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(br||(br=ey(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(Er||(Er=ey(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(Pr||(Pr=ey(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.END_YOUR_MOVE=function(){return $localize(Sr||(Sr=ey(["You are performing a move, you must select a landing square."])))},e}(),xae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=Aae.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=Aae.decode(c).removeBiggest();i[u.y][u.x]=Aae.decode(l.removedSpace.encode()),r=l.removedPiece}return new Iae(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=Cy(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return zB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===s9.NONE?zB.empty():t[0]===t[1]&&t[1]===t[2]?zB.of(t[0]):zB.empty()}},{key:"isLegal",value:function(e,t){var n;if(FB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return HB.failure(Mae.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?HB.success(i.get()):HB.failure(Mae.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?ene.getVictory(t.get()):ene.ONGOING}}]),n}(tne);xae.LINES=[[new Rte(0,0),new Rte(0,1),new Rte(0,2)],[new Rte(1,0),new Rte(1,1),new Rte(1,2)],[new Rte(2,0),new Rte(2,1),new Rte(2,2)],[new Rte(0,0),new Rte(1,0),new Rte(2,0)],[new Rte(0,1),new Rte(1,1),new Rte(2,1)],[new Rte(0,2),new Rte(1,2),new Rte(2,2)],[new Rte(0,0),new Rte(1,1),new Rte(2,2)],[new Rte(0,2),new Rte(1,1),new Rte(2,0)]];var Rae=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return Py(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(zB.of(e),t,zB.empty())}},{key:"fromDrop",value:function(e,t){return new n(zB.empty(),t,zB.of(e))}}]),n}(jte);Rae.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new Rte(r,n);if(0===t){var a=Tae.of(e);return Rae.fromDrop(a,i)}var o=e%3;e-=o;var s=new Rte((e/=3)%3,o);return Rae.fromMove(s,i)}}]),n}(a9));var Nae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=xae.getGameStatus(e);return new $te(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=M9.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new Rte(s,o),l=Cy(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=Rae.fromDrop(f,c);xae.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new Rte(v,d);if(!p.equals(c)){var g=Rae.fromMove(c,p);xae.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(Gte),Dae=new Aae(s9.NONE,s9.NONE,s9.NONE),Lae=new Aae(u9.ZERO,s9.NONE,s9.NONE),Fae=new Aae(s9.NONE,u9.ZERO,s9.NONE),Uae=new Aae(s9.NONE,s9.NONE,u9.ZERO),Vae=new Aae(u9.ONE,s9.NONE,s9.NONE),Bae=new Aae(s9.NONE,s9.NONE,u9.ONE),zae=new Aae(u9.ONE,u9.ZERO,s9.NONE),Hae=new Aae(u9.ZERO,u9.ZERO,s9.NONE),Gae=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Or||(Or=ey(["Goal of the game"]))),$localize(Tr||(Tr=ey(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new Iae([[Lae,Vae,Bae],[Dae,Fae,Dae],[Dae,Dae,Uae]],0,[Tae.SMALL_DARK,Tae.MEDIUM_DARK,Tae.BIG_DARK,Tae.SMALL_LIGHT,Tae.MEDIUM_LIGHT,Tae.MEDIUM_LIGHT,Tae.BIG_LIGHT])),ane.anyMove($localize(Ir||(Ir=ey(["Putting a piece"]))),$localize(Ar||(Ar=ey(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),Iae.getInitialState(),Rae.fromDrop(Tae.SMALL_DARK,new Rte(1,1)),$localize(Mr||(Mr=ey(["Congratulations!"])))),ane.fromMove($localize(xr||(xr=ey(["Moving"]))),$localize(Rr||(Rr=ey(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new Iae([[Lae,Bae,Dae],[Dae,Dae,Dae],[Dae,Dae,Dae]],0,[]),[Rae.fromMove(new Rte(0,0),new Rte(2,0)),Rae.fromMove(new Rte(0,0),new Rte(0,1)),Rae.fromMove(new Rte(0,0),new Rte(1,1)),Rae.fromMove(new Rte(0,0),new Rte(2,1)),Rae.fromMove(new Rte(0,0),new Rte(0,2)),Rae.fromMove(new Rte(0,0),new Rte(1,2)),Rae.fromMove(new Rte(0,0),new Rte(2,2))],$localize(Nr||(Nr=ey(["Congratulations!"]))),$localize(Dr||(Dr=ey(["Failed. Try again."])))),ane.fromPredicate($localize(Lr||(Lr=ey(["Particularity"]))),$localize(Fr||(Fr=ey(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new Iae([[zae,Dae,Vae],[Hae,Bae,Bae],[Dae,Dae,Dae]],0,[Tae.MEDIUM_DARK,Tae.BIG_DARK,Tae.MEDIUM_LIGHT,Tae.MEDIUM_LIGHT]),Rae.fromMove(new Rte(0,1),new Rte(0,2)),function(e,t,n){if(e.landingCoord.equals(new Rte(0,2))){if(e.isDropping())return ZB.failure($localize(Ur||(Ur=ey(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new Rte(0,1)))return ZB.SUCCESS}return ZB.failure($localize(Vr||(Vr=ey(["Failed. Try again."]))))},$localize(Br||(Br=ey(["Congratulations!"]))))]});function $ae(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"circle",6),BP("click",function(){var e=hC(n),t=e.$implicit,r=e.index;return GP().onPieceClick(0,t,r)}),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP();Wb(1),qP("id","piece_0_",r.toString(),"_",i,""),AP("ngClass",a.getSidePieceClasses(r,i)),_P("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function Zae(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",9),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onBoardClick(e,t)}),RP()}if(2&e){var r=t.$implicit,i=GP().index,a=GP().index,o=GP();AP("ngClass",o.getPieceClasses(r)),_P("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function qae(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",7),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onBoardClick(e,t)}),RP(),OP(2,Zae,1,4,"circle",8),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","click_",i,"_",a,""),AP("ngClass",o.getRectClasses(i,a)),_P("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngForOf",o.getListPieces(r))}}function Wae(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,qae,3,8,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function jae(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",10),BP("click",function(){hC(n);var e=GP();return e.onBoardClick(e.chosenCoord.get().x,e.chosenCoord.get().y)}),RP()}if(2&e){var r=GP();qP("id","chosenCoord_",r.chosenCoord.get().x,"_",r.chosenCoord.get().y,""),_P("x",r.SPACE_SIZE*r.chosenCoord.get().x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*r.chosenCoord.get().y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Yae(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"circle",6),BP("click",function(){var e=hC(n),t=e.$implicit,r=e.index;return GP().onPieceClick(1,t,r)}),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP();Wb(1),qP("id","piece_1_",r.toString(),"_",i,""),AP("ngClass",a.getSidePieceClasses(r,i)),_P("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Kae=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=zB.empty(),r.lastStartingCoord=zB.empty(),r.chosenCoord=zB.empty(),r.chosenPiece=zB.empty(),r.remainingPieceLeftX=[],r.rules=new xae(Iae),r.availableMinimaxes=[new Nae(r.rules,"EncapsuleMinimax")],r.encoder=Rae.encoder,r.tutorial=(new Gae).tutorial,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard();var t=this.rules.node.move;this.calculateLeftX(),t.isPresent()?(this.lastLandingCoord=zB.of(t.get().landingCoord),this.lastStartingCoord=t.get().startingCoord):(this.lastLandingCoord=zB.empty(),this.lastStartingCoord=zB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.getState().getRemainingPiecesOfPlayer(u9.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Rte(e,t),o=n.getState(),!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=zB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=Rae.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.getState()));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(Mae.INVALID_PIECE_SELECTED()):ZB.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",(n.cancelMoveAttempt(),ZB.SUCCESS));case 11:return u=Rae.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.getState()));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=zB.empty(),this.chosenPiece=zB.empty(),this.chosenPieceIndex=zB.empty()}},{key:"onPieceClick",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a="#piece_"+e+"_"+t.toString()+"_"+n,o=r.canUserPlay(a),i.abrupt("return",o.isFailure()?r.cancelMove(o.getReason()):!1===r.getState().isDroppable(t)?r.cancelMove(Mae.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece.equalsValue(t)&&r.chosenPieceIndex.equalsValue(n)?(r.chosenPiece=zB.empty(),r.chosenPieceIndex=zB.empty()):(r.chosenPiece=zB.of(t),r.chosenPieceIndex=zB.of(n)),ZB.SUCCESS):r.cancelMove(Mae.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved-fill":""}},{key:"isSelected",value:function(e,t){var n=new Rte(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return $7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case Oae.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case Oae.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return LB.expectToBe(e.getSize(),Oae.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(t)&&n.push("selected-stroke"),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-encapsule"]],features:[cP],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingPiecePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPiecePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"g",null,1),OP(3,$ae,2,6,"g",2),RP(),xP(4,"g",null,3),OP(6,Wae,2,1,"g",2),OP(7,jae,1,6,"rect",4),RP(),xP(8,"g",null,5),OP(10,Yae,2,6,"g",2),RP(),RP()),2&e&&(Wb(1),_P("transform","translate("+t.STROKE_WIDTH+", 0)"),Wb(2),AP("ngForOf",t.getRemainingPieces(0)),Wb(1),_P("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Wb(2),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.chosenCoord.isPresent()),Wb(1),_P("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Wb(2),AP("ngForOf",t.getRemainingPieces(1)))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qae=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;if(by(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return vy(s)}return Py(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Yte);Qae.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=Ite.factory.fromInt(t);return new Qae(a,i,r+1,n+1,o.get())}}]),n}(a9));var Xae=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=s9.NONE,t=s9.ZERO,r=s9.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(qte),Jae=function(){var e=Py(function e(){by(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(zr||(zr=ey(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Hr||(Hr=ey(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Gr||(Gr=ey(["Your phalanx must be bigger than the one you are capturing."])))},e.SQUARE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize($r||($r=ey(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Zr||(Zr=ey(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(qr||(qr=ey(["A single piece cannot make a capture."])))},e.SQUARE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Wr||(Wr=ey(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(jr||(jr=ey(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=function(){return $localize(Yr||(Yr=ey(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Kr||(Kr=ey(["A phalanx cannot contain a piece of the opponent."])))},e}(),eoe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new Xae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(u9.ZERO,0),r=t.count(u9.ONE,11);if(t.turn%2==0){if(n>r)return ene.ZERO_WON}else if(r>n)return ene.ONE_WON;return!1===t.doesOwnPiece(u9.ZERO)?ene.ONE_WON:!1===t.doesOwnPiece(u9.ONE)?ene.ZERO_WON:ene.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return HB.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=h9.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:HB.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return ZB.failure(Jae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===s9.NONE)return ZB.failure(Jae.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(a===i)return ZB.failure(Jae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return ZB.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=s9.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return HB.failure(Jae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return HB.failure(Jae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?HB.failure(Jae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?HB.failure(Hte.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=s9.NONE,n[a.y][a.x]=r,HB.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=s9.NONE),++a>=n.movedPieces)return HB.failure(Jae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return HB.success(t)}}]),n}(tne),toe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return h9.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new $te(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new Rte(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[Ite.UP_LEFT,Ite.UP,Ite.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=s9.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new Rte(u,s);if(o.getPieceAt(c)===n){var l,f=Cy(Ite.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new Qae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new Qae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return eoe.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(Gte),noe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=toe.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return h9.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new $te(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new Rte(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===u9.ZERO?(o=12-n,s=[Ite.UP_LEFT,Ite.UP,Ite.UP_RIGHT]):(o=n+1,s=[Ite.DOWN_LEFT,Ite.DOWN,Ite.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Cy(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(Gte),roe=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return Py(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Rte(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Rte(n,11))===u9.ZERO&&(t+=u9.ZERO.getScoreModifier()),e.getPieceAt(new Rte(n,0))===u9.ONE&&(t+=u9.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Rte(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new Rte(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===s9.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Rte(n,0))===u9.ZERO&&(t+=u9.ZERO.getScoreModifier()),e.getPieceAt(new Rte(n,11))===u9.ONE&&(t+=u9.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Rte(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new Rte(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=Cy(Ite.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===s9.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===u9.ZERO?n=Math.max(n,d):s===u9.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*u9.ZERO.getScoreModifier()+r*u9.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new $te(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new $te(r+i+a+o+s+u)}}]),n}(toe),ioe=s9.NONE,aoe=s9.ZERO,ooe=s9.ONE,soe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Qr||(Qr=ey(["Initial board"]))),$localize(Xr||(Xr=ey(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),Xae.getInitialState()),ane.informational($localize(Jr||(Jr=ey(["Goal of the game (1/2)"]))),$localize(ei||(ei=ey(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new Xae([[ioe,ioe,ioe,ioe,ioe,aoe,ioe,ioe,ooe,ooe,ooe,ooe,ooe,ooe],[ioe,ioe,ioe,ioe,ioe,aoe,ioe,ioe,ioe,ioe,ioe,ioe,ooe,ooe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,aoe,aoe,aoe,aoe,ioe,ioe,ioe]],0)),ane.informational($localize(ti||(ti=ey(["Goal of the game (2/2)"]))),$localize(ni||(ni=ey(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new Xae([[ioe,ioe,ioe,ioe,ioe,aoe,ioe,ioe,ioe,ioe,ooe,ooe,ooe,ooe],[ioe,ioe,ioe,ioe,ioe,aoe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ooe,ooe,ioe,ioe,ioe,aoe,aoe,ioe,aoe,aoe,aoe,aoe]],1)),ane.fromPredicate($localize(ri||(ri=ey(["Moving a piece"]))),$localize(ii||(ii=ey(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),Xae.getInitialState(),new Qae(0,10,1,1,Ite.UP),function(e,t,n){return 1===e.movedPieces?ZB.SUCCESS:ZB.failure($localize(ai||(ai=ey(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(oi||(oi=ey(["This is how you move a single piece."])))),ane.fromPredicate($localize(si||(si=ey(["Moving a phalanx"]))),$localize(ui||(ui=ey(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),Xae.getInitialState(),new Qae(0,11,2,1,Ite.UP),function(e,t,n){return e.movedPieces>1?ZB.SUCCESS:ZB.failure($localize(ci||(ci=ey(["Failed! You moved only one piece."]))))},$localize(li||(li=ey(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),ane.fromMove($localize(fi||(fi=ey(["Capture"]))),$localize(hi||(hi=ey(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new Xae([[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ooe,ooe,ooe,ooe,ooe,ooe],[ioe,ioe,ioe,ioe,ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ooe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ooe,ooe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,aoe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,aoe,ioe,ioe,ioe,ioe,ooe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,aoe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,aoe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe,ioe],[ioe,ioe,ioe,ioe,ioe,ioe,ioe,aoe,aoe,aoe,aoe,aoe,aoe,aoe]],0),[new Qae(2,10,4,2,Ite.UP)],$localize(di||(di=ey(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(vi||(vi=ey(["Failed, you have not captured the phalanx."]))))]});function uoe(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",4),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),RP()}if(2&e){var r=GP().index,i=GP().index,a=GP();AP("ngClass",a.getPieceClasses(r,i)),_P("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function coe(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",2),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),RP(),OP(2,uoe,1,4,"circle",3),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();Wb(1),qP("id","click_",r,"_",i,""),AP("ngClass",a.getRectClasses(r,i)),_P("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngIf",a.board[i][r]!==a.NONE)}}function loe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,coe,3,8,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function foe(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",5),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),_P("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var hoe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).NONE=s9.NONE,r.firstPiece=zB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=zB.empty(),r.phalanxDirection=zB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.hasAsymetricBoard=!0,r.rules=new eoe(Xae),r.availableMinimaxes=[new toe(r.rules,"Normal"),new noe(r.rules,"Positional"),new roe(r.rules,"Attack")],r.encoder=Qae.encoder,r.tutorial=(new soe).tutorial,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){this.firstPiece=zB.empty(),this.lastPiece=zB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.getState().getCurrentOpponent(),a=n.getState().getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=zB.of(new Rte(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),ZB.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(LB.expectToBe(n.board[t][e],s9.NONE),n.cancelMove(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Cy(Ite.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=Ite.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=Ite.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptySpaces()}},{key:"getNeighboringEmptySpaces",value:function(){var e,t=[],n=Cy(Ite.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===s9.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.getState().getCurrentPlayer(),i=this.getState().getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=zB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=zB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Rte(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),ZB.SUCCESS));case 3:if(o=n.getState().getCurrentOpponent(),s=n.getState().getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Jae.SQUARE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===s9.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new Qae(a.x,a.y,1,1,c)):n.cancelMove(Jae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Jae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return LB.expectToBe(n.board[t][e],s),l=new Qae(a.x,a.y,u,1,c),f=n.getState(),h=eoe.getPhalanxValidity(f,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=zB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=zB.of(c),ZB.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.getState().getCurrentPlayer(),a=new Rte(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Jae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=Ite.factory.fromMove(o,s).get(),c=Ite.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=zB.of(s),n.lastPiece=zB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Jae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=14;break}return r.abrupt("return",n.thirdClickOnPlayerPiece(a,u,i));case 14:return l=n.firstPiece.get().getDistance(n.lastPiece.get())+1,f=n.lastPiece.get().getDistance(a),h=new Qae(n.firstPiece.get().x,n.firstPiece.get().y,l,f,u),r.abrupt("return",n.tryMove(h));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClickOnPlayerPiece",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r.lastPiece=zB.of(e),a=r.firstPiece.get().getDistance(e)+1,o=new Qae(r.firstPiece.get().x,r.firstPiece.get().y,a,1,t),s=eoe.getPhalanxValidity(r.rules.node.gameState,o),i.abrupt("return",s.isFailure()?r.cancelMove(s.getReason()):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getValidExtensions(n),r.phalanxValidLandings=r.getPhalanxValidLandings(),ZB.SUCCESS));case 3:case"end":return i.stop()}},i)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=zB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",ZB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=zB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),ZB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=zB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=zB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),ZB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.getState();return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new Rte(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["selected-stroke"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new Rte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured-fill"]:this.moveds.some(function(e){return e.equals(n)})?["moved-fill"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.getState().getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new Rte(r,n));return e}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-epaminondas"]],features:[cP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,loe,2,1,"g",1),OP(2,foe,2,4,"g",1),RP()),2&e&&(_P("transform",t.rotation),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.getHighlightedCoords()))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function doe(e){return new(function(t){fy(r,t);var n=dy(r);function r(){return by(this,r),n.apply(this,arguments)}return Py(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?zB.empty():zB.of(e.decode(t))}}]),r}(r9))}var voe=function(){function e(t){if(by(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Qie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=h9.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=zB.empty(),i=Cy(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive coords");r=zB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return Py(e,[{key:"toString",value:function(){var e,t="",n=Cy(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return Qie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();voe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return Rte.encoder.encode(e)})}},{key:"decode",value:function(e){return new voe(e.map(function(e){return Rte.encoder.decode(e)}))}}]),n}(r9));var poe=function(){function e(t,n){by(this,e),this.coord=t,this.direction=n}return Py(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();poe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=doe(Fte.encoder),e}return Py(n,[{key:"encode",value:function(e){return{coord:Rte.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return $7(null!=t.coord,"Invalid encoded GipfPlacement"),new poe(Rte.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(r9));var goe=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return Py(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===h9.compareArray(this.initialCaptures,e.initialCaptures)||!1===h9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(jte);goe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encodeMove",value:function(e){var t={placement:poe.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=voe.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=voe.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return $7(null!=t.placement,"Invalid encoded GipfMove"),new goe(poe.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",voe.encoder.decode),this.decodeArray(t,"finalCapture",voe.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(i9));var yoe=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,r,e,7,7,[3,2,1],Lte.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return Py(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&h9.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=h9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Lte.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=Lte.EMPTY,t=Lte.UNREACHABLE,r=Lte.ZERO,i=Lte.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(Xie),moe=function(){var e=Py(function e(){by(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(pi||(pi=ey(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(gi||(gi=ey(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(yi||(yi=ey(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(mi||(mi=ey(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(ki||(ki=ey(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(Ci||(Ci=ey(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(wi||(wi=ey(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(_i||(_i=ey(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(bi||(bi=ey(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),koe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return new yoe(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==Lte.EMPTY;)o.push(s),s=s.getNext(a);return $7(i.isOnBoard(s)&&i.getPieceAt(s)===Lte.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():HB.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Cy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return ZB.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return ZB.failure(moe.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?ZB.SUCCESS:ZB.failure(moe.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?ZB.SUCCESS:ZB.failure(moe.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==Lte.EMPTY){if(t.direction.isAbsent())return ZB.failure(moe.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return ZB.failure(moe.PLACEMENT_ON_COMPLETE_LINE());var i,a=Cy(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return ZB.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return ZB.failure(moe.INVALID_PLACEMENT_DIRECTION())}return ZB.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return zte.INSTANCE.isOnBorder(e,t)?ZB.SUCCESS:ZB.failure(moe.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,u9.ZERO),i=n.getPlayerScore(t,u9.ONE);return r.isAbsent()?ene.ONE_WON:i.isAbsent()?ene.ZERO_WON:ene.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,Lte.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new yoe(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return zte.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===Lte.EMPTY?t.push(new poe(r,zB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new poe(r,zB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===Lte.EMPTY)return zB.of(r);return zB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=Lte.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==Lte.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==Lte.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new yoe(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(zte.INSTANCE.isTopLeftCorner(e,t))return[Fte.RIGHT,Fte.DOWN,Fte.UP_RIGHT];if(zte.INSTANCE.isTopCorner(e,t))return[Fte.DOWN,Fte.DOWN_LEFT,Fte.RIGHT];if(zte.INSTANCE.isTopRightCorner(e,t))return[Fte.DOWN_LEFT,Fte.DOWN,Fte.LEFT];if(zte.INSTANCE.isBottomLeftCorner(e,t))return[Fte.UP_RIGHT,Fte.UP,Fte.RIGHT];if(zte.INSTANCE.isBottomCorner(e,t))return[Fte.UP,Fte.LEFT,Fte.UP_RIGHT];if(zte.INSTANCE.isBottomRightCorner(e,t))return[Fte.LEFT,Fte.UP,Fte.DOWN_LEFT];if(zte.INSTANCE.isOnTopLeftBorder(e,t))return[Fte.RIGHT,Fte.DOWN];if(zte.INSTANCE.isOnLeftBorder(e,t))return[Fte.UP_RIGHT,Fte.RIGHT];if(zte.INSTANCE.isOnBottomLeftBorder(e,t))return[Fte.UP,Fte.UP_RIGHT];if(zte.INSTANCE.isOnBottomRightBorder(e,t))return[Fte.LEFT,Fte.UP];if(zte.INSTANCE.isOnRightBorder(e,t))return[Fte.LEFT,Fte.DOWN_LEFT];if(zte.INSTANCE.isOnTopRightBorder(e,t))return[Fte.DOWN_LEFT,Fte.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return zB.of({0:o,1:s,2:a});return zB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==Lte.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==Lte.EMPTY;c=c.getNext(a))n.push(c);return new voe(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return zB.empty();var i=e.getNumberOfPiecesCaptured(t);return zB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,u9.ZERO),r=n.getPlayerScore(e,u9.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(tne),Coe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=koe.getPlayerScore(t,u9.ZERO),r=koe.getPlayerScore(t,u9.ONE);return n.isAbsent()?new $te(u9.ONE.getVictoryValue()):r.isAbsent()?new $te(u9.ZERO.getVictoryValue()):new $te(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return koe.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=koe.applyCaptures(r,e);koe.getPlacements(i).forEach(function(e){var a=koe.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new goe(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=koe.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Cy(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(h9.copyImmutableArray(u)):o?(a.push(h9.copyImmutableArray(u)),u.push(n),a.push(h9.copyImmutableArray(u))):(u.push(n),a.push(h9.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(Gte),woe=Py(function e(t,n,r,i,a,o){by(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),_oe=Lte.UNREACHABLE,boe=Lte.EMPTY,Eoe=Lte.ZERO,Poe=Lte.ONE,Soe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Ei||(Ei=ey(["Goal of the game"]))),$localize(Pi||(Pi=ey(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),yoe.getInitialState()),ane.anyMove($localize(Si||(Si=ey(["Pushing"]))),$localize(Oi||(Oi=ey(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),yoe.getInitialState(),new goe(new poe(new Rte(3,0),zB.of(Fte.DOWN)),[],[]),$localize(Ti||(Ti=ey(["Congratulations!"])))),ane.fromMove($localize(Ii||(Ii=ey(["Capture (1/3)"]))),$localize(Ai||(Ai=ey(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new yoe([[_oe,_oe,_oe,Eoe,Poe,boe,boe],[_oe,_oe,boe,boe,boe,boe,boe],[_oe,boe,boe,boe,boe,boe,boe],[Eoe,Eoe,Eoe,boe,boe,boe,boe],[Poe,boe,boe,boe,boe,boe,_oe],[boe,boe,boe,Poe,boe,_oe,_oe],[boe,boe,boe,Poe,_oe,_oe,_oe]],42,[8,8],[0,0]),[new goe(new poe(new Rte(0,3),zB.of(Fte.RIGHT)),[],[new voe([new Rte(0,3),new Rte(1,3),new Rte(2,3),new Rte(3,3)])])],$localize(Mi||(Mi=ey(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(xi||(xi=ey(["Failed!"])))),ane.fromMove($localize(Ri||(Ri=ey(["Capture (2/3)"]))),$localize(Ni||(Ni=ey(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new yoe([[_oe,_oe,_oe,boe,boe,boe,boe],[_oe,_oe,boe,Poe,boe,boe,boe],[_oe,boe,boe,Eoe,boe,boe,boe],[Eoe,Eoe,Eoe,Poe,boe,boe,boe],[boe,boe,boe,Eoe,boe,boe,_oe],[boe,boe,boe,Eoe,boe,_oe,_oe],[boe,boe,boe,Poe,_oe,_oe,_oe]],42,[8,4],[2,3]),[new goe(new poe(new Rte(0,3),zB.of(Fte.RIGHT)),[],[new voe([new Rte(3,1),new Rte(3,2),new Rte(3,3),new Rte(3,4),new Rte(3,5),new Rte(3,6)])])],$localize(Di||(Di=ey(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Li||(Li=ey(["Failed, the best capture was taking 2 of your opponent's pieces"])))),ane.fromMove($localize(Fi||(Fi=ey(["Capture (3/3)"]))),$localize(Ui||(Ui=ey(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new yoe([[_oe,_oe,_oe,Eoe,boe,boe,Eoe],[_oe,_oe,boe,Eoe,boe,boe,Eoe],[_oe,Eoe,Eoe,boe,Eoe,Poe,Eoe],[boe,boe,boe,Eoe,boe,boe,Eoe],[boe,boe,boe,Eoe,boe,boe,_oe],[Eoe,Eoe,Eoe,Poe,Poe,_oe,_oe],[boe,boe,boe,Eoe,_oe,_oe,_oe]],42,[8,4],[2,3]),[new goe(new poe(new Rte(3,6),zB.of(Fte.UP)),[new voe([new Rte(6,0),new Rte(6,1),new Rte(6,2),new Rte(6,3)])],[new voe([new Rte(0,5),new Rte(1,5),new Rte(2,5),new Rte(3,5),new Rte(4,5)]),new voe([new Rte(1,2),new Rte(2,2),new Rte(3,2),new Rte(4,2),new Rte(5,2)])]),new goe(new poe(new Rte(4,6),zB.of(Fte.UP)),[new voe([new Rte(6,0),new Rte(6,1),new Rte(6,2),new Rte(6,3)])],[new voe([new Rte(0,5),new Rte(1,5),new Rte(2,5),new Rte(3,5),new Rte(4,5)]),new voe([new Rte(3,0),new Rte(3,1),new Rte(3,2),new Rte(3,3),new Rte(3,4)])]),new goe(new poe(new Rte(3,6),zB.of(Fte.UP)),[new voe([new Rte(6,0),new Rte(6,1),new Rte(6,2),new Rte(6,3)])],[new voe([new Rte(1,2),new Rte(2,2),new Rte(3,2),new Rte(4,2),new Rte(5,2)]),new voe([new Rte(0,5),new Rte(1,5),new Rte(2,5),new Rte(3,5),new Rte(4,5)])])],$localize(Vi||(Vi=ey(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Bi||(Bi=ey(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function Ooe(e,t){if(1&e&&(zC(),NP(0,"circle",13)),2&e){var n=GP().$implicit,r=GP();AP("ngClass",r.getPieceClass(n)),_P("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function Toe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",10),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e)}),NP(1,"polygon",11),OP(2,Ooe,1,4,"circle",12),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","click_",r.x,"_",r.y,""),Wb(1),qP("id","space_",r.x,"_",r.y,""),AP("ngClass",i.getSpaceClass(r)),_P("points",i.getHexaCoordsAt(r)),Wb(1),AP("ngIf",i.isPiece(r))}}function Ioe(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",16),BP("click",function(){var e=hC(n).$implicit;return GP(2).onClick(e)}),RP()}if(2&e){var r=t.$implicit;_P("points",GP(2).getHexaCoordsAt(r))}}function Aoe(e,t){if(1&e&&(zC(),xP(0,"g",14),OP(1,Ioe,1,1,"polygon",15),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n.capturedSpaces)}}function Moe(e,t){if(1&e){var n=FP();zC(),xP(0,"line",17),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.destination)}),RP()}if(2&e){var r=t.$implicit;_P("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function xoe(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",18),RP()),2&e){var n=t.$implicit,r=GP().$implicit,i=GP();Wb(1),qP("id","piece_",r.value,"_",n,""),AP("ngClass",i.getPlayerClass(r)),_P("cx",i.getRemainingPieceCx(r,n))("cy",i.getRemainingPieceCy(r))("r",.5*i.SPACE_SIZE)}}function Roe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,xoe,2,6,"g",8),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",r.getPlayerSidePieces(n))}}function Noe(e,t){if(1&e&&(zC(),NP(0,"line",19)),2&e){var n=GP();_P("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var Doe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).inserted=zB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.HEXAGON_WIDTH=r.SPACE_SIZE,r.SHARED_HEXAGON_X=Math.cos(30)*r.HEXAGON_WIDTH*.5,r.BOARD_WIDTH=r.HEXAGON_WIDTH+6*(r.HEXAGON_WIDTH-r.SHARED_HEXAGON_X)+3*r.STROKE_WIDTH/2,r.BOARD_HEIGHT=7*r.HEXAGON_WIDTH+4.5*r.STROKE_WIDTH,r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=zB.empty(),r.placementEntrance=zB.empty(),r.finalCaptures=[],r.hasAsymetricBoard=!0,r.scores=zB.of([0,0]),r.rules=new koe(yoe),r.availableMinimaxes=[new Coe(r.rules,"GipfMinimax")],r.encoder=goe.encoder,r.tutorial=(new Soe).tutorial,r.SPACE_SIZE=40,r.constructedState=r.getState(),r.hexaLayout=new Ute(1.5*r.SPACE_SIZE,new Rte(r.HEXAGON_WIDTH/2+3*r.STROKE_WIDTH/4,-r.HEXAGON_WIDTH),zte.INSTANCE),r}return Py(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt()}},{key:"showLastMove",value:function(){this.inserted=zB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=zB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new woe(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(e),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==Lte.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:return r.abrupt("return",(LB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),t.selectPlacementDirectionOrPlacementCoord(e)));case 9:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(moe.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(moe.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=koe.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=koe.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():ZB.SUCCESS):(LB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):ZB.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,ZB.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=koe.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,ZB.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=koe.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,ZB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Cy(koe.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===koe.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new woe(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.placementEntrance.equalsValue(e)?(t.cancelMoveAttempt(),ZB.SUCCESS):(t.placementEntrance=zB.of(e),t.constructedState.getPieceAt(e)===Lte.EMPTY?t.selectPlacementDirection(zB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(moe.NO_DIRECTIONS_AVAILABLE()),ZB.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=zB.of(new poe(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=koe.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"selectPlacementDirectionOrPlacementCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==(r=t.placementEntrance.get()).isAlignedWith(e)&&1===r.getDistance(e)){n.next=3;break}return n.abrupt("return",t.selectPlacementCoord(e));case 3:return i=Fte.factory.fromMove(r,e),n.abrupt("return",t.selectPlacementDirection(i.toOptional()));case 5:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new goe(t,e,n),i.next=3,r.chooseMove(a,r.getState(),r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.getState(),this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=zB.empty(),this.placement=zB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured-fill":this.moved.some(function(t){return t.equals(e)})?"moved-fill":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(u9.of(t.value))}},{key:"getRemainingPieceCy",value:function(e){return e===u9.ONE?25:this.BOARD_HEIGHT-25}},{key:"getRemainingPieceCx",value:function(e,t){var n=20+t*this.SPACE_SIZE*.5;return e===u9.ONE?n:this.BOARD_WIDTH-(15+n)}}]),n}(Dte);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-gipf"]],features:[cP],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"defs"),xP(2,"marker",1),NP(3,"polygon",2),RP(),xP(4,"marker",3),NP(5,"polygon",4),RP(),RP(),OP(6,Toe,3,7,"g",5),OP(7,Aoe,2,1,"g",6),OP(8,Moe,1,4,"line",7),OP(9,Roe,2,1,"g",8),OP(10,Noe,1,4,"line",9),RP()),2&e&&(_P("viewBox",-t.STROKE_WIDTH+" 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),Wb(6),AP("ngForOf",t.getAllCoords()),Wb(1),AP("ngForOf",t.possibleCaptures),Wb(1),AP("ngForOf",t.arrows),Wb(1),AP("ngForOf",t.Player.PLAYERS),Wb(1),AP("ngIf",t.inserted.isPresent()))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Loe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Yte);Loe.PASS=new Loe(-1,0),Loe.ACCEPT=new Loe(-2,0),Loe.PASS_NUMBER=-1,Loe.ACCEPT_NUMBER=-2,Loe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===Loe.PASS_NUMBER)return Loe.PASS;var t=e%19;return new Loe(t,(e-t)/19)}}]),n}(a9));var Foe=function(){function e(t,n){by(this,e),this.player=t,this.type=n}return Py(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return $7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return $7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===u9.ZERO?e.DARK:e.LIGHT}}]),e}();Foe.DARK=new Foe(u9.ZERO,"alive"),Foe.LIGHT=new Foe(u9.ONE,"alive"),Foe.EMPTY=new Foe(s9.NONE,"empty"),Foe.DEAD_DARK=new Foe(u9.ZERO,"dead"),Foe.DEAD_LIGHT=new Foe(u9.ONE,"dead"),Foe.DARK_TERRITORY=new Foe(s9.NONE,"territory"),Foe.LIGHT_TERRITORY=new Foe(s9.NONE,"territory");var Uoe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(Uoe||(Uoe={})),Uoe),Voe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return Py(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,zB.empty(),Uoe.PLAYING)}},{key:"getStartingBoard",value:function(){return h9.createTable(n.WIDTH,n.HEIGHT,Foe.EMPTY)}}]),n}(qte);return e.WIDTH=13,e.HEIGHT=13,e}(),Boe=function(){var e=function(){function e(t){by(this,e),this.color=t}return Py(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),zoe=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return Py(n,[{key:"getCoords",value:function(){return this.color===Foe.DARK?this.darkCoords:this.color===Foe.LIGHT?this.lightCoords:this.color===Foe.DEAD_DARK?this.deadDarkCoords:this.color===Foe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch($7(!1===this.contains(e),"This group already contains "+e.toString()),t){case Foe.DARK:this.darkCoords=Boe.insertAsEntryPoint(this.darkCoords,e);break;case Foe.LIGHT:this.lightCoords=Boe.insertAsEntryPoint(this.lightCoords,e);break;case Foe.DEAD_DARK:this.deadDarkCoords=Boe.insertAsEntryPoint(this.deadDarkCoords,e);break;case Foe.DEAD_LIGHT:this.deadLightCoords=Boe.insertAsEntryPoint(this.deadLightCoords,e);break;default:LB.expectToBeMultiple(t,[Foe.EMPTY,Foe.DARK_TERRITORY,Foe.LIGHT_TERRITORY]),this.emptyCoords=Boe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new R9;e.set(Foe.EMPTY,this.emptyCoords.length),e.set(Foe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Foe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==Foe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Foe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Foe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Foe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Foe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(Boe),Hoe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getNewInstance",value:function(e){return new zoe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return Ate.ORTHOGONALS}}]),n}(function(){function e(){by(this,e)}return Py(e,[{key:"getGroupDatas",value:function(e,t){FB(Boe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){FB(Boe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Cy(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),Goe=function(){var e=Py(function e(){by(this,e)});return e.ILLEGAL_KO=function(){return $localize(zi||(zi=ey(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Hi||(Hi=ey(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Gi||(Gi=ey(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize($i||($i=ey(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Zi||(Zi=ey(["You cannot commit suicide."])))},e}(),$oe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return FB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(FB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(FB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(FB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(FB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(FB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===Uoe.PLAYING,a=t.phase===Uoe.PASSED;return FB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?HB.success([]):HB.failure(Goe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===Uoe.ACCEPT;return t.phase===Uoe.COUNTING||o?HB.success([]):HB.failure(Goe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(FB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?HB.success([]):HB.failure(Goe.OCCUPIED_INTERSECTION())):(FB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new Hoe).getGroupDatas(i,t),s=o.emptyCoords,u=Foe.pieceBelongTo(a,u9.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return zB.of(r)}return zB.empty()}},{key:"markTerritoryAndCount",value:function(e){FB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Cy(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===Foe.LIGHT){a[1]+=s.emptyCoords.length;var c,l=Cy(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=Foe.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{$7(u===Foe.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=Cy(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=Foe.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new Voe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===Foe.DARK_TERRITORY?(n[i][a]=Foe.EMPTY,r[0]=r[0]-1):t===Foe.LIGHT_TERRITORY&&(n[i][a]=Foe.EMPTY,r[1]=r[1]-1);return new Voe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new Hoe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new Rte(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===Foe.DEAD_DARK?r++:t===Foe.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();$7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new Hoe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case Foe.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=Cy(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=Foe.DARK}}catch(y){o.e(y)}finally{o.f()}break;case Foe.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=Cy(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=Foe.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case Foe.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=Cy(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=Foe.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:LB.expectToBe(r.color,Foe.DARK),i[1]+=2*r.darkCoords.length;var v,p=Cy(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=Foe.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new Voe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===Uoe.FINISHED?t.captured[0]>t.captured[1]?ene.ZERO_WON:t.captured[1]>t.captured[0]?ene.ONE_WON:ene.DRAW:ene.ONGOING}},{key:"isPass",value:function(e){return e.equals(Loe.PASS)}},{key:"isAccept",value:function(e){return e.equals(Loe.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===Uoe.COUNTING||t.phase===Uoe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return HB.failure(Goe.ILLEGAL_KO());[Uoe.COUNTING,Uoe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(Zoe.isCapturing(i))return HB.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?Foe.DARK:Foe.LIGHT;var a=0===(new Hoe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=Foe.EMPTY,a?HB.failure(Goe.CANNOT_COMMIT_SUICIDE()):HB.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){FB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new Zoe,o=Cy(Ate.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?Foe.LIGHT:Foe.DARK)){FB(n.VERBOSE||!1,"a group could be captured");var o=(new Hoe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return FB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===Uoe.PASSED?(t=Uoe.COUNTING,r=new Voe(i,a,o+1,zB.empty(),t),r=n.markTerritoryAndCount(r)):($7(e.phase===Uoe.PLAYING,"Cannot pass in counting phase!"),t=Uoe.PASSED,r=new Voe(i,a,o+1,zB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===Uoe.COUNTING?Uoe.ACCEPT:Uoe.FINISHED,new Voe(n,e.getCapturedCopy(),e.turn+1,zB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;FB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[Uoe.COUNTING,Uoe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=Foe.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=Cy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=Foe.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new Voe(s,p,l,v,Uoe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new Rte(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){FB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new Voe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,zB.empty(),Uoe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(tne);return e.VERBOSE=!1,e}(),Zoe=function(){function e(){by(this,e),this.capturedCoords=[]}return Py(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),qoe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){FB($oe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===Uoe.PLAYING||t.phase===Uoe.PASSED)return n.push(Loe.PASS),n;FB($oe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[Loe.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new Loe(i,r),e.getPieceAt(t.coord)===Foe.EMPTY&&$oe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Cy($oe.getGroupsDatasWhere(r,function(e){return e!==Foe.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new Loe(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===Foe.DARK?Foe.DEAD_DARK:e===Foe.LIGHT?Foe.DEAD_LIGHT:e.isTerritory()?Foe.EMPTY:e}),n=new Voe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=$oe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Cy(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Cy(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=$oe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=$oe.getGameStatus(e);if(n.isEndGame)return new $te(n.toBoardValue());FB($oe.VERBOSE||!1,"GoRules.getBoardValue");var r=$oe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new $te(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(Gte),Woe=Foe.LIGHT,joe=Foe.DARK,Yoe=Foe.DEAD_LIGHT,Koe=Foe.LIGHT_TERRITORY,Qoe=Foe.DARK_TERRITORY,Xoe=Foe.EMPTY,Joe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(qi||(qi=ey(["Preliminary information"]))),$localize(Wi||(Wi=ey(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),Voe.getInitialState()),ane.informational($localize(ji||(ji=ey(["Goal of the game"]))),$localize(Yi||(Yi=ey(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new Voe([[Xoe,joe,Xoe,Xoe,Woe,Woe],[Xoe,joe,Xoe,Xoe,Woe,Xoe],[Xoe,joe,joe,Woe,Woe,Xoe],[Xoe,Xoe,joe,Woe,Xoe,Xoe],[Xoe,Xoe,joe,Woe,Xoe,Xoe],[Xoe,Xoe,joe,Woe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING)),ane.fromMove($localize(Ki||(Ki=ey(["Simple capture"]))),$localize(Qi||(Qi=ey(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new Voe([[Xoe,Xoe,Xoe,Xoe,Xoe],[Xoe,Xoe,joe,Xoe,Xoe],[Xoe,joe,Woe,Xoe,Xoe],[Xoe,Xoe,joe,Xoe,Xoe],[Xoe,Xoe,Xoe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING),[new Loe(3,2)],$localize(Xi||(Xi=ey(["Congratulations, you have earned one point."]))),$localize(Ji||(Ji=ey(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),ane.fromMove($localize(ea||(ea=ey(["Capturing multiple stones"]))),$localize(ta||(ta=ey(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new Voe([[Xoe,joe,Xoe,Xoe,Xoe],[joe,Woe,Xoe,Xoe,Xoe],[joe,Woe,Woe,joe,Xoe],[Xoe,joe,joe,Xoe,Xoe],[Xoe,Xoe,Xoe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING),[new Loe(2,1)],$localize(na||(na=ey(["Congratulations, you have earned three points and formed a territory."]))),$localize(ra||(ra=ey(["Failed, you have not captured the group. Play on the last liberty of that group."])))),ane.informational($localize(ia||(ia=ey(["Suicide"]))),$localize(aa||(aa=ey(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new Voe([[Xoe,joe,Xoe,Xoe,Xoe],[joe,Xoe,Xoe,Xoe,Xoe],[joe,Xoe,Xoe,Xoe,Woe],[Woe,joe,Xoe,Woe,Xoe],[Xoe,Woe,Xoe,Woe,joe]],[0,0],0,zB.empty(),Uoe.PLAYING)),ane.informational($localize(oa||(oa=ey(["Life and death (death)"]))),$localize(sa||(sa=ey(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new Voe([[Xoe,Xoe,Xoe,Xoe,Xoe],[joe,joe,joe,Xoe,Xoe],[Woe,Woe,joe,Xoe,Xoe],[Xoe,Woe,joe,Xoe,Xoe],[Woe,Woe,joe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING)),ane.informational($localize(ua||(ua=ey(["Life and death (eyes)"]))),$localize(ca||(ca=ey(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new Voe([[Xoe,joe,Woe,Xoe,Xoe],[Woe,joe,Woe,Xoe,Xoe],[joe,joe,Woe,Xoe,Xoe],[Woe,joe,Woe,Xoe,Xoe],[Xoe,joe,Woe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING)),ane.informational($localize(la||(la=ey(["Seki"]))),$localize(fa||(fa=ey(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new Voe([[Xoe,Woe,joe,Xoe,Woe,joe,Xoe],[Xoe,Woe,joe,joe,Woe,joe,Xoe],[Xoe,Woe,joe,joe,Woe,joe,Xoe],[Xoe,Woe,joe,joe,Woe,joe,Xoe],[Xoe,Woe,joe,Woe,Woe,joe,Xoe],[Xoe,Woe,joe,Woe,Woe,joe,Xoe],[Xoe,Woe,joe,Xoe,Woe,joe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING)),ane.fromMove($localize(ha||(ha=ey(["Ko"]))),$localize(da||(da=ey(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new Voe([[Xoe,Xoe,Xoe,Xoe,Xoe,Xoe,Xoe],[Xoe,Xoe,Xoe,Xoe,Xoe,Xoe,Xoe],[Xoe,Xoe,Xoe,joe,Woe,Xoe,Xoe],[Xoe,Xoe,joe,Woe,Xoe,Woe,Xoe],[Xoe,Xoe,Xoe,joe,Woe,Xoe,Xoe],[Xoe,Xoe,Xoe,Xoe,Xoe,Xoe,Xoe],[Xoe,Xoe,Xoe,Xoe,Xoe,Xoe,Xoe]],[0,0],0,zB.empty(),Uoe.PLAYING),[new Loe(4,3)],$localize(va||(va=ey(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(pa||(pa=ey(["Failed!"])))),ane.fromMove($localize(ga||(ga=ey(["End of the game"]))),$localize(ya||(ya=ey(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new Voe([[Woe,joe,joe,joe,joe,joe,Qoe,Qoe,Qoe],[Woe,Woe,Woe,Woe,joe,joe,joe,Qoe,Qoe],[Woe,Koe,Woe,Woe,joe,Yoe,Yoe,joe,Qoe],[joe,Woe,Woe,Woe,Woe,joe,Qoe,Qoe,Qoe],[Xoe,Woe,Koe,Woe,joe,joe,Yoe,joe,Qoe],[Woe,Koe,Woe,Woe,joe,joe,joe,joe,joe],[Woe,Woe,joe,joe,joe,Woe,Woe,joe,Woe],[joe,joe,joe,Woe,Woe,Woe,Koe,Woe,Woe],[Qoe,Qoe,joe,joe,joe,Woe,Woe,Koe,Koe]],[0,0],0,zB.empty(),Uoe.COUNTING),[new Loe(0,3)],$localize(ma||(ma=ey(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(ka||(ka=ey(["Failed, try again."]))))]});function ese(e,t){if(1&e&&(zC(),NP(0,"circle",10)),2&e){var n=GP(2).index,r=GP().index;_P("cx",25+50*n)("cy",25+50*r)("r",22)}}function tse(e,t){if(1&e){var n=FP();zC(),xP(0,"line",11),BP("click",function(){hC(n);var e=GP(2).index,t=GP().index;return GP().onClick(e,t)}),RP()}if(2&e){var r=GP(2).index,i=GP().index;_P("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function nse(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"circle",7),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),RP(),OP(2,ese,1,3,"circle",8),OP(3,tse,1,4,"line",9),RP()}if(2&e){var r=GP().index,i=GP().index,a=GP();Wb(1),AP("ngClass",a.getSpaceClass(r,i)),_P("cx",25+50*r)("cy",25+50*i)("r",22),Wb(1),AP("ngIf",a.isLastSpace(r,i)),Wb(1),AP("ngIf",a.isDead(r,i))}}function rse(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",15),BP("click",function(){hC(n);var e=GP(2).index,t=GP().index;return GP().onClick(e,t)}),RP()}if(2&e){var r=GP(2),i=r.index,a=r.$implicit,o=GP().index,s=GP();_P("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function ise(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",12),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),RP(),xP(1,"line",13),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),RP(),xP(2,"line",13),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().onClick(e,t)}),RP(),OP(3,rse,1,4,"circle",14)}if(2&e){var r=GP().index,i=GP().index,a=GP();qP("id","click_",r,"_",i,""),_P("x",50*r)("y",50*i),Wb(1),_P("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),Wb(1),_P("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),Wb(1),AP("ngIf",a.isTerritory(r,i))}}function ase(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,nse,4,6,"g",5),OP(2,ise,4,13,"ng-template",null,6,uI),RP()),2&e){var n=t.index,r=TP(3),i=GP().index,a=GP();Wb(1),AP("ngIf",a.spaceIsFull(n,i))("ngIfElse",r)}}function ose(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,ase,4,2,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function sse(e,t){if(1&e&&(zC(),NP(0,"rect",16)),2&e){var n=GP();_P("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function use(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",17),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP()}if(2&e){var r=t.$implicit;_P("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var cse=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).ko=zB.empty(),r.last=zB.empty(),r.captures=[],r.GoPiece=Foe,r.scores=zB.of([0,0]),r.rules=new $oe(Voe),r.availableMinimaxes=[new qoe(r.rules,"GoMinimax")],r.encoder=Loe.encoder,r.tutorial=(new Joe).tutorial,r.canPass=!0,r.updateBoard(),r}return Py(n,[{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=zB.empty(),a=new Loe(e,t),r.abrupt("return",n.chooseMove(a,n.getState(),n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){FB(n.VERBOSE,"updateBoard");var e=this.getState(),t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=zB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==Uoe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new Rte(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===Foe.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getState().phase,t.abrupt("return",n===Uoe.PLAYING||n===Uoe.PASSED?e.onClick(Loe.PASS.coord.x,Loe.PASS.coord.y):($7(n===Uoe.COUNTING||n===Uoe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Loe.ACCEPT.coord.x,Loe.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"spaceIsFull",value:function(e,t){return this.getState().getPieceAtXY(e,t)!==Foe.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastSpace",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.getState().isDead(new Rte(e,t))}},{key:"isTerritory",value:function(e,t){return this.getState().isTerritory(new Rte(e,t))}}]),n}(Bne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-go"]],features:[cP],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),NP(1,"rect",1),OP(2,ose,2,1,"g",2),OP(3,sse,1,2,"rect",3),OP(4,use,1,3,"circle",4),RP()),2&e&&(_P("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Wb(1),_P("width",50*t.board.length)("height",50*t.board.length),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.ko.isPresent()),Wb(1),AP("ngForOf",t.captures))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),lse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getMaximalDistance",value:function(){return 11}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return HB.success(r)}catch(r){return HB.failure(r.message)}}}]),n}(Jne);lse.encoder=Qne.getEncoder(11,11,lse.of);var fse={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:u9.ZERO},hse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=nre.UNOCCUPIED,t=nre.INVADERS,r=nre.DEFENDERS;return new n([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,r,e,e,e,e,t],[t,e,e,e,r,r,r,e,e,e,t],[t,t,e,r,r,nre.PLAYER_ONE_KING,r,r,e,t,t],[t,e,e,e,r,r,r,e,e,e,t],[t,e,e,e,e,r,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}}]),n}(ire),dse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,hse,fse,lse.of)}return Py(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Jte.ruler=this.singleton,n.singleton}}]),n}(ore),vse=nre.UNOCCUPIED,pse=nre.INVADERS,gse=nre.DEFENDERS,yse=nre.PLAYER_ONE_KING,mse=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Ca||(Ca=ey(["Goal of the game"]))),$localize(wa||(wa=ey(["Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),hse.getInitialState()),ane.anyMove($localize(_a||(_a=ey(["Moving"]))),$localize(ba||(ba=ey(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),hse.getInitialState(),lse.of(new Rte(5,1),new Rte(1,1)),$localize(Ea||(Ea=ey(["Congratulations!"])))),ane.fromMove($localize(Pa||(Pa=ey(["Capturing a soldier (1/2)"]))),$localize(Sa||(Sa=ey(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new hse([[vse,vse,vse,vse,pse,pse,pse,pse,vse,vse,vse],[vse,vse,vse,vse,vse,pse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[pse,vse,vse,vse,vse,gse,vse,vse,vse,vse,pse],[pse,vse,vse,pse,gse,gse,gse,vse,vse,vse,pse],[pse,pse,vse,gse,gse,yse,gse,gse,vse,pse,pse],[pse,vse,vse,vse,gse,gse,gse,vse,vse,vse,pse],[pse,vse,vse,vse,vse,gse,vse,vse,vse,vse,pse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,pse,vse,vse,vse,vse,vse],[vse,vse,vse,pse,pse,pse,pse,pse,vse,vse,vse]],1),[lse.of(new Rte(5,3),new Rte(3,3))],$localize(Oa||(Oa=ey(["Congratulations, that will teach him a lesson!"]))),$localize(Ta||(Ta=ey(["Failed, you missed an opportunity to capture a piece of the opponent."])))).withPreviousMove(lse.of(new Rte(3,0),new Rte(3,4))).withPreviousState(hse.getInitialState()),ane.fromMove($localize(Ia||(Ia=ey(["Capturing a soldier (2/2)"]))),$localize(Aa||(Aa=ey(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new hse([[vse,vse,vse,pse,pse,pse,pse,pse,vse,vse,vse],[vse,gse,vse,vse,vse,pse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,gse,vse,vse,vse,vse,pse],[pse,vse,vse,vse,vse,gse,gse,vse,vse,vse,pse],[pse,pse,yse,vse,gse,vse,gse,gse,vse,vse,pse],[vse,vse,pse,vse,vse,gse,gse,vse,vse,vse,pse],[pse,vse,vse,vse,vse,gse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,pse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,pse,pse,pse,pse,vse,pse,vse,vse]],12),[lse.of(new Rte(3,0),new Rte(3,5)),lse.of(new Rte(3,10),new Rte(3,5))],$localize(Ma||(Ma=ey(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(xa||(xa=ey(["Failed, you did not do the expected move."])))),ane.fromMove($localize(Ra||(Ra=ey(["Capturing the king (1/2)"]))),$localize(Na||(Na=ey(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new hse([[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,pse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[pse,yse,vse,pse,vse,vse,vse,vse,vse,vse,vse],[vse,pse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse]],72),[lse.of(new Rte(3,4),new Rte(2,4))],$localize(Da||(Da=ey(["Congratulations, you won!"]))),$localize(La||(La=ey(["Failed, you let the king run away."])))),ane.fromMove($localize(Fa||(Fa=ey(["Capturing the king (2/2)"]))),$localize(Ua||(Ua=ey(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new hse([[vse,vse,pse,yse,pse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,gse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,pse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse],[vse,vse,vse,vse,vse,vse,vse,vse,vse,vse,vse]],72),[lse.of(new Rte(3,3),new Rte(3,1))],$localize(Va||(Va=ey(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ba||(Ba=ey(["Failed!"]))))]});function kse(e,t){1&e&&(zC(),NP(0,"polygon",8))}function Cse(e,t){1&e&&(zC(),NP(0,"rect",9))}function wse(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,kse,1,0,"polygon",6),OP(2,Cse,1,0,"ng-template",null,7,uI),RP()),2&e){var n=TP(3),r=GP().index,i=GP().index,a=GP();Wb(1),AP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function _se(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13),NP(4,"line",13),NP(5,"line",13),RP()),2&e){var n=GP(2).index,r=GP().index,i=GP();Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function bse(e,t){if(1&e&&(zC(),NP(0,"polyline",16)),2&e){var n=GP(3).index,r=GP().index;AP("ngClass",GP().viewInfo.pieceClasses[r][n])}}function Ese(e,t){if(1&e&&(zC(),NP(0,"line",13),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13)),2&e){var n=GP(3).index,r=GP().index,i=GP();AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Pse(e,t){if(1&e&&(zC(),OP(0,bse,1,1,"polyline",14),OP(1,Ese,4,20,"ng-template",null,15,uI)),2&e){var n=TP(2),r=GP(2).index,i=GP().index;AP("ngIf",GP().isKing(r,i))("ngIfElse",n)}}function Sse(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",10),OP(2,_se,6,25,"g",11),OP(3,Pse,3,2,"ng-template",null,12,uI),RP()),2&e){var n=TP(4),r=GP().index,i=GP().index,a=GP();Wb(1),qP("id","piece_",r,"_",i,""),AP("ngClass",a.viewInfo.pieceClasses[i][r]),_P("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),Wb(1),AP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Ose(e,t){if(1&e){var n=FP();zC(),xP(0,"g",3),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(1,"rect",4),OP(2,wse,4,2,"g",5),OP(3,Sse,5,8,"g",5),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();qP("id","click_",r,"_",i,""),_P("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),Wb(1),AP("ngClass",a.getRectClasses(r,i)),_P("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),Wb(1),AP("ngIf",a.board[i][r]!==a.EMPTY)}}function Tse(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Ose,4,8,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Ise(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",17),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),qP("id","click_",r.x,"_",r.y,""),_P("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Ase=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e,!1,lse.from)).rules=dse.get(),r.availableMinimaxes=[new cre(r.rules,"DummyBot"),new dre(r.rules,"Piece > Influence"),new vre(r.rules,"Piece > Control"),new pre(r.rules,"Escape > Piece > Control")],r.encoder=lse.encoder,r.tutorial=(new mse).tutorial,r}return Py(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(ure);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-hnefatafl"]],features:[cP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Tse,2,1,"g",1),OP(2,Ise,2,6,"g",1),RP()),2&e&&(_P("viewBox",t.getViewBox()),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.getClickables()))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Mse=function(){function e(t,n,r){by(this,e),this.value=t,this.name=n,this.rgb=r}return Py(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return LB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Mse.ANY=new Mse(0,"any","#000"),Mse.ORANGE=new Mse(1,"orange","#d67421"),Mse.BLUE=new Mse(2,"blue","#006bac"),Mse.PURPLE=new Mse(3,"purple","#6f3787"),Mse.PINK=new Mse(4,"pink","#d2719e"),Mse.YELLOW=new Mse(5,"yellow","#e2c200"),Mse.RED=new Mse(6,"red","#d23339"),Mse.GREEN=new Mse(7,"green","#009157"),Mse.BROWN=new Mse(8,"brown","#562500");var xse=function(){function e(t,n){by(this,e),this.player=t,this.color=n}return Py(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(s9.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Mse.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Mse.ORANGE),BLUE:new e(t,Mse.BLUE),PURPLE:new e(t,Mse.PURPLE),PINK:new e(t,Mse.PINK),YELLOW:new e(t,Mse.YELLOW),RED:new e(t,Mse.RED),GREEN:new e(t,Mse.GREEN),BROWN:new e(t,Mse.BROWN)}}}]),e}();xse.EMPTY=new xse(s9.NONE,Mse.ANY),xse.ZERO=xse.createPlayerColors(u9.ZERO),xse.ONE=xse.createPlayerColors(u9.ONE);var Rse=function(){function e(){by(this,e)}return Py(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=xse.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return xse.of(u9.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return xse.of(u9.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(xse.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new Rte(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Rse.INITIAL=Rse.getInitialBoard(),Rse.SIZE=8,Rse.COLORS=h9.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Mse.of);var Nse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this)}return Py(n,[{key:"isPieceMove",value:function(){return!1}},{key:"length",value:function(){return 0}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"KamisadoMove(PASS)"}}]),n}(jte);Nse.PASS=new Nse;var Dse,Lse=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"isPieceMove",value:function(){return!0}},{key:"equals",value:function(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Rse.SIZE,Rse.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Rse.SIZE,Rse.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(Qne);!function(e){e.PASS=Nse.PASS,e.of=function(e,t){return Lse.of(e,t)},e.encoder=new(function(t){fy(r,t);var n=dy(r);function r(){return by(this,r),n.apply(this,arguments)}return Py(r,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}},{key:"decodeNumber",value:function(t){if(0===t)return e.PASS;var n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new Rte((t=t/16|0)%16,i),new Rte(r,n))}}]),r}(a9))}(Dse||(Dse={}));var Fse=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o){var s;return by(this,n),(s=t.call(this,h9.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return Py(n,null,[{key:"getInitialState",value:function(){return new n(0,Mse.ANY,zB.empty(),!1,Rse.INITIAL)}}]),n}(qte),Use=function(){var e=Py(function e(){by(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(za||(za=ey(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(Ha||(Ha=ey(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(Ga||(Ga=ey(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize($a||($a=ey(["You must play with the selected piece."])))},e}(),Vse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"nextCoordToPlay",value:function(e,t){return zB.ofNullable(Rse.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.getCopiedBoard();a[i.y][i.x]=a[r.y][r.x],a[r.y][r.x]=xse.EMPTY;var o=Rse.getColorAt(i.x,i.y),s=this.nextCoordToPlay(t,o);return new Fse(t.turn+1,o,s,!1,a)}var u=this.nextCoordToPlay(t,t.colorToPlay);return new Fse(t.turn+1,t.colorToPlay,u,!0,t.board)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return ene.getDefeat(r);var i=iy(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?ene.ONE_WON:0===a?ene.ZERO_WON:ene.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new Rte(0,7),new Rte(1,7),new Rte(2,7),new Rte(3,7),new Rte(4,7),new Rte(5,7),new Rte(6,7),new Rte(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Cy(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Rse.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===u9.ONE?[Ite.DOWN,Ite.DOWN_LEFT,Ite.DOWN_RIGHT]:[Ite.UP,Ite.UP_LEFT,Ite.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===u9.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?($7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Dse.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Cy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Cy(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<Rse.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!Rse.isEmptyAt(e.board,h))break;var d=Dse.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Rse.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);$7(i!==xse.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===u9.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE());if(a!==Mse.ANY&&o.color!==a)return HB.failure(Use.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return HB.failure(Hte.MUST_CLICK_ON_EMPTY_SPACE());var s=Ite.factory.fromMove(r,i);if(s.isFailure())return HB.failure(Use.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return HB.failure(Use.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return HB.failure(Use.MOVE_BLOCKED());return HB.success(void 0)}return this.isLegalPass(t)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?HB.success(void 0):HB.failure(Hte.CANNOT_PASS())}}]),n}(tne),Bse=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=Vse.getListMovesFromState(e.gameState);return h9.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Vse.mustPass(t)&&t.alreadyPassed)return new $te(n.getDefeatValue());var r=iy(Vse.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new $te(7===a?u9.ONE.getVictoryValue():0===i?u9.ZERO.getVictoryValue():a-(7-i))}}]),n}(Gte),zse=xse.EMPTY,Hse=xse.ZERO.ORANGE,Gse=xse.ONE.ORANGE,$se=xse.ZERO.BLUE,Zse=xse.ONE.BLUE,qse=xse.ZERO.PURPLE,Wse=xse.ONE.PURPLE,jse=xse.ZERO.PINK,Yse=xse.ONE.PINK,Kse=xse.ZERO.YELLOW,Qse=xse.ONE.YELLOW,Xse=xse.ZERO.RED,Jse=xse.ONE.RED,eue=xse.ZERO.GREEN,tue=xse.ONE.GREEN,nue=xse.ZERO.BROWN,rue=xse.ONE.BROWN,iue=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Za||(Za=ey(["Goal of the game"]))),$localize(qa||(qa=ey(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Fse(5,Mse.ORANGE,zB.empty(),!1,[[nue,Zse,Wse,Yse,Qse,Jse,tue,rue],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,Gse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,eue,Xse,Kse,jse,qse,$se,Hse]])).withPreviousMove(Dse.of(new Rte(0,7),new Rte(0,0))),ane.anyMove($localize(Wa||(Wa=ey(["Initial board and initial move"]))),$localize(ja||(ja=ey(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Fse.getInitialState(),Dse.of(new Rte(7,7),new Rte(3,3)),$localize(Ya||(Ya=ey(["Perfect! Note that each of your piece has a different color."])))),ane.fromMove($localize(Ka||(Ka=ey(["Moving"]))),$localize(Qa||(Qa=ey(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Fse(1,Mse.PINK,zB.of(new Rte(3,0)),!1,[[Gse,Zse,Wse,Yse,Qse,Jse,tue,rue],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,$se,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[nue,eue,Xse,Kse,jse,qse,zse,Hse]]),[Dse.of(new Rte(3,0),new Rte(3,6)),Dse.of(new Rte(3,0),new Rte(4,1))],$localize(Xa||(Xa=ey(["Congratulations!"]))),$localize(Ja||(Ja=ey(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(Dse.of(new Rte(6,7),new Rte(6,5))),ane.informational($localize(eo||(eo=ey(["Stuck situation"]))),$localize(to||(to=ey(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Fse(1,Mse.PINK,zB.of(new Rte(3,6)),!1,[[Gse,Zse,Wse,zse,Qse,Jse,tue,rue],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,zse,$se],[zse,zse,zse,zse,zse,zse,zse,zse],[zse,zse,zse,Yse,zse,zse,zse,zse],[nue,eue,Xse,Kse,jse,qse,zse,Hse]])).withPreviousMove(Dse.of(new Rte(6,5),new Rte(7,4))),ane.fromMove($localize(no||(no=ey(["Victory by blocking"]))),$localize(ro||(ro=ey(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Fse(2,Mse.RED,zB.of(new Rte(2,4)),!1,[[zse,Zse,Wse,zse,zse,Jse,zse,zse],[zse,zse,zse,Qse,zse,zse,zse,zse],[zse,zse,zse,Yse,zse,Wse,zse,zse],[zse,zse,zse,Kse,zse,zse,zse,zse],[zse,zse,Xse,zse,zse,zse,zse,zse],[zse,zse,zse,zse,zse,zse,tue,zse],[Gse,zse,zse,zse,zse,jse,zse,rue],[nue,eue,zse,zse,zse,zse,$se,Hse]]),[Dse.of(new Rte(2,4),new Rte(0,2))],$localize(io||(io=ey(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(ao||(ao=ey(["Failed!"])))).withPreviousMove(Dse.of(new Rte(4,0),new Rte(3,1)))]});function aue(e,t){if(1&e&&(zC(),NP(0,"circle",8)),2&e){var n=GP(),r=n.$implicit,i=n.index,a=GP().index,o=GP();AP("ngClass",o.piecePlayerClass(r)),_P("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function oue(e,t){if(1&e&&(zC(),NP(0,"rect",9)),2&e){var n=GP(),r=n.index,i=n.$implicit,a=GP().index,o=GP();_P("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function sue(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"g",4),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(2,"rect",5),OP(3,aue,1,4,"circle",6),OP(4,oue,1,7,"rect",7),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","click_",i,"_",a,""),Wb(1),_P("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),Wb(1),AP("ngIf",r!==o.UNOCCUPIED),Wb(1),AP("ngIf",r!==o.UNOCCUPIED)}}function uue(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,sue,5,9,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function cue(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"rect",10),NP(2,"rect",10),RP()),2&e){var n=GP();Wb(1),_P("x",n.lastPieceMove.get().coord.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),Wb(1),_P("x",n.lastPieceMove.get().end.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function lue(e,t){if(1&e&&(zC(),NP(0,"circle",11)),2&e){var n=GP();_P("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}var fue=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).UNOCCUPIED=xse.EMPTY,r.lastMove=zB.empty(),r.lastPieceMove=zB.empty(),r.chosen=zB.empty(),r.chosenAutomatically=!1,r.hasAsymetricBoard=!0,r.rules=new Vse(Fse),r.availableMinimaxes=[new Bse(r.rules,"KamisadoMinimax")],r.encoder=Dse.encoder,r.tutorial=(new iue).tutorial,r.canPass=!1,r.updateBoard(),r}return Py(n,[{key:"backgroundColor",value:function(e,t){return Rse.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===u9.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=zB.empty(),this.lastMove.isPresent()){var t=this.lastMove.get();t.isPieceMove()&&(this.lastPieceMove=zB.of(t))}this.canPass=Vse.mustPass(e);var n=this.rules.getGameStatus(this.rules.node)!==ene.ONGOING;this.canPass||e.coordToPlay.isAbsent()||n?(this.chosenAutomatically=!1,this.chosen=zB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",($7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Dse.PASS,e.getState())));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Rte(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(Hte.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),ZB.SUCCESS));case 10:if(o=n.getState().getPieceAtXY(e,t),s=n.getState().getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Use.PLAY_WITH_SELECTED_PIECE()):(n.chosen=zB.of(a),ZB.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.getState().getPieceAtXY(e,t),r=this.getState().getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=zB.of(new Rte(e,t)),ZB.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Rte(e,t),o=Dse.of(i,a),r.abrupt("return",n.chooseMove(o,n.getState()));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=zB.empty())}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-kamisado"]],features:[cP],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,uue,2,1,"g",1),OP(2,cue,3,8,"g",2),OP(3,lue,1,3,"circle",3),RP()),2&e&&(_P("viewBox",t.getViewBox())("transform",t.rotation),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.lastPieceMove.isPresent()),Wb(1),AP("ngIf",t.chosen.isPresent()))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hue=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,null,[{key:"getInitialState",value:function(){var e=s9.NONE,t=s9.ZERO,r=s9.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(qte);return e.SIZE=8,e}(),due=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).direction=i,a.direction=Ite.factory.fromMove(e,r).get(),a}return Py(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=Ite.factory.fromMove(e,t);return r.isFailure()?HB.failure(r.getReason()):e.isNotInRange(hue.SIZE,hue.SIZE)?HB.failure("start coord is not in range"):t.isNotInRange(hue.SIZE,hue.SIZE)?HB.failure("end coord is not in range"):HB.success(new n(e,t,r.get()))}}]),n}(Qne);due.encoder=Qne.getEncoder(hue.SIZE,hue.SIZE,function(e,t){return due.of(e,t).get()});var vue=function(){var e=Py(function e(){by(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(oo||(oo=ey(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(so||(so=ey(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(uo||(uo=ey(["This piece has no possible move, select another one."])))},e}(),pue=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=s9.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new hue(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=iy(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?ene.ZERO_WON:i>1&&1===a?ene.ONE_WON:ene.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<hue.SIZE;r++)for(var i=0;i<hue.SIZE;i++){var a=new Rte(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=Cy(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=due.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=h9.createTable(hue.SIZE,hue.SIZE,-1),r=[0,0],i=0,a=0;a<hue.SIZE;a++)for(var o=0;o<hue.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new Rte(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new Rte(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=LB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Cy(Ite.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===s9.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?HB.failure(vue.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?HB.failure(vue.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?HB.failure(Hte.CANNOT_SELF_CAPTURE()):HB.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Cy(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];hue.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case Ite.UP:case Ite.DOWN:return[new Rte(e.x,0),Ite.DOWN];case Ite.LEFT:case Ite.RIGHT:return[new Rte(0,e.y),Ite.RIGHT];case Ite.UP_RIGHT:case Ite.DOWN_LEFT:return[new Rte(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Ite.UP_RIGHT];default:return LB.expectToBeMultiple(t,[Ite.UP_LEFT,Ite.DOWN_RIGHT]),[new Rte(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Ite.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=iy(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?zB.of(s9.NONE):1===r?zB.of(u9.ZERO):1===i?zB.of(u9.ONE):zB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Cy(Ite.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=due.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(tne),gue=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){return pue.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=iy(pue.getNumberOfGroups(t),2),r=n[0],i=n[1];return new $te(1===r&&i>1?u9.ZERO.getVictoryValue():r>1&&1===i?u9.ONE.getVictoryValue():100/r*u9.ZERO.getScoreModifier()+100/i*u9.ONE.getScoreModifier())}}]),n}(Gte),yue=s9.NONE,mue=s9.ZERO,kue=s9.ONE,Cue=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(co||(co=ey(["Goal of the game"]))),$localize(lo||(lo=ey(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new hue([[yue,yue,yue,yue,yue,yue,yue,yue],[kue,yue,yue,yue,mue,yue,yue,kue],[yue,yue,mue,mue,kue,yue,yue,yue],[yue,yue,yue,mue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0)),ane.anyMove($localize(fo||(fo=ey(["Initial board and initial move"]))),$localize(ho||(ho=ey(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),hue.getInitialState(),due.of(new Rte(1,7),new Rte(1,5)).get(),$localize(vo||(vo=ey(["Congratulations!"])))),ane.fromMove($localize(po||(po=ey(["Jumping"]))),$localize(go||(go=ey(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new hue([[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,kue,mue,mue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,yue,yue,mue]],0),[due.of(new Rte(3,1),new Rte(6,1)).get()],$localize(yo||(yo=ey(["Congratulations!"]))),$localize(mo||(mo=ey(["Failed. You did not jump over one of your pieces."])))),ane.fromMove($localize(ko||(ko=ey(["Moving"]))),$localize(Co||(Co=ey(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new hue([[yue,yue,yue,yue,yue,yue,kue,yue],[yue,yue,yue,yue,yue,mue,yue,yue],[yue,yue,yue,yue,kue,yue,yue,yue],[yue,yue,yue,mue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,kue,yue,kue],[yue,yue,yue,mue,yue,yue,kue,kue],[yue,yue,yue,mue,yue,yue,yue,yue]],0),[due.of(new Rte(3,3),new Rte(3,0)).get(),due.of(new Rte(3,3),new Rte(0,0)).get(),due.of(new Rte(3,3),new Rte(2,3)).get(),due.of(new Rte(3,3),new Rte(4,3)).get()],$localize(wo||(wo=ey(["Congratulations!"]))),$localize(_o||(_o=ey(["Failed. This was not one of the expected moves."])))),ane.fromPredicate($localize(bo||(bo=ey(["Capturing"]))),$localize(Eo||(Eo=ey(["If a move ends on an opponent's piece, it is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new hue([[yue,mue,yue,mue,mue,mue,mue,yue],[kue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,mue,yue,kue,yue,yue,yue],[kue,yue,yue,yue,yue,yue,yue,kue],[kue,yue,yue,yue,yue,yue,yue,kue],[kue,yue,yue,yue,yue,yue,yue,kue],[kue,yue,yue,yue,yue,yue,yue,kue],[yue,mue,mue,mue,mue,mue,mue,yue]],0),due.of(new Rte(2,2),new Rte(4,2)).get(),function(e,t,n){return t.getPieceAt(e.end)===s9.ONE?ZB.SUCCESS:ZB.failure($localize(Po||(Po=ey(["Failed!"]))))},$localize(So||(So=ey(["Congratulations!"])))),ane.fromMove($localize(Oo||(Oo=ey(["Tie"]))),$localize(To||(To=ey(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new hue([[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[mue,yue,yue,mue,kue,mue,yue,yue],[yue,yue,yue,mue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,yue,yue,kue],[yue,yue,yue,yue,yue,yue,yue,yue]],0),[due.of(new Rte(0,2),new Rte(4,2)).get()],$localize(Io||(Io=ey(["Congratulations!"]))),$localize(Ao||(Ao=ey(["Failed!"]))))]});function wue(e,t){if(1&e&&(zC(),NP(0,"circle",6)),2&e){var n=GP().index,r=GP().index,i=GP();qP("id","piece_",n,"_",r,""),AP("ngClass",i.getPieceClasses(n,r)),_P("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function _ue(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"g",3),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(2,"rect",4),OP(3,wue,1,6,"circle",5),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","click_",i,"_",a,""),Wb(1),AP("ngClass",o.getSquareClasses(i,a)),_P("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r!==o.EMPTY)}}function bue(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,_ue,4,8,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Eue(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",7),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP()}if(2&e){var r=t.$implicit,i=GP();_P("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var Pue=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=s9.NONE,r.targets=[],r.selected=zB.empty(),r.lastMove=zB.empty(),r.captured=zB.empty(),r.rules=new pue(hue),r.availableMinimaxes=[new gue(r.rules,"LinesOfActionMinimax")],r.encoder=due.encoder,r.tutorial=(new Cue).tutorial,r.updateBoard(),r}return Py(n,[{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Rte(e,t),!n.selected.equalsValue(a)){r.next=6;break}return r.abrupt("return",(n.cancelMoveAttempt(),ZB.SUCCESS));case 6:return o=n.getState().getCurrentPlayer(),r.abrupt("return",n.selected.isAbsent()||n.getState().getPieceAt(a)===o?n.select(a):n.concludeMove(a));case 8:case"end":return r.stop()}},r)}))()}},{key:"concludeMove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=due.of(t.selected.get(),e),n.abrupt("return",r.isSuccess()?t.chooseMove(r.get(),t.rules.node.gameState):t.cancelMove(r.getReason()));case 2:case"end":return n.stop()}},n)}))()}},{key:"select",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=zB.of(e),t.targets=pue.possibleTargets(t.getState(),t.selected.get()),0===t.targets.length?t.cancelMove(vue.PIECE_CANNOT_MOVE()):ZB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?zB.of(e.end):zB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=zB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new Rte(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured-fill"];if(n.equals(r)||n.equals(i))return["moved-fill"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new Rte(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected-stroke"),i}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-linesofaction"]],features:[cP],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,bue,2,1,"g",1),OP(2,Eue,1,4,"rect",2),RP()),2&e&&(Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.targets))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Sue=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return by(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return Py(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(Yte);Sue.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encodeMove",value:function(e){return{coord:Rte.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return $7(null!=t.coord,"Invalid encoded LodestoneMove"),$7(null!=t.direction,"Invalid encoded LodestoneMove"),$7(null!=t.orientation,"Invalid encoded LodestoneMove"),$7(null!=t.captures,"Invalid encoded LodestoneMove"),new Sue(Rte.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(i9));var Oue=function(){var e=Py(function e(){by(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(Mo||(Mo=ey(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(xo||(xo=ey(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(Ro||(Ro=ey(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(No||(No=ey(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(Do||(Do=ey(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(Lo||(Lo=ey(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),Tue=function(){function e(t){by(this,e),this.unreachable=t}return Py(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();Tue.UNREACHABLE=new Tue(!0),Tue.EMPTY=new Tue(!1);var Iue=function(){function e(t){by(this,e),this.owner=t}return Py(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===u9.ZERO?e.ZERO:e.ONE}}]),e}();Iue.ZERO=new Iue(u9.ZERO),Iue.ONE=new Iue(u9.ONE);var Aue=function(){function e(t,n,r){by(this,e),this.owner=t,this.direction=n,this.orientation=r}return Py(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();Aue.LODESTONES={0:{push:{diagonal:new Aue(u9.ZERO,"push","diagonal"),orthogonal:new Aue(u9.ZERO,"push","orthogonal")},pull:{diagonal:new Aue(u9.ZERO,"pull","diagonal"),orthogonal:new Aue(u9.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Aue(u9.ONE,"push","diagonal"),orthogonal:new Aue(u9.ONE,"push","orthogonal")},pull:{diagonal:new Aue(u9.ONE,"pull","diagonal"),orthogonal:new Aue(u9.ONE,"pull","orthogonal")}}};var Mue=function(){function e(t,n){by(this,e),this.width=t,this.pieces=n}return Py(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):($7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),zB.empty());for(var r=h9.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(Iue.of(t));return zB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:Tue.EMPTY}}]),e}();Mue.POSITIONS=["top","bottom","left","right"],Mue.EMPTY_5=new Mue(5,[]),Mue.EMPTY_3=new Mue(3,[]);var xue=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return Py(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=Cy(Mue.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return zB.empty();var n=this.getPieceAt(t.get());switch($7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return zB.of("pull");case"pull":return zB.of("push")}}}],[{key:"getInitialState",value:function(){var e=Tue.EMPTY,t=Iue.ZERO,r=Iue.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new R9,{top:zB.of(Mue.EMPTY_5),bottom:zB.of(Mue.EMPTY_5),left:zB.of(Mue.EMPTY_5),right:zB.of(Mue.EMPTY_5)})}}]),n}(qte);return e.SIZE=8,e}(),Rue=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,xue)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=h9.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=ny({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new xue(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=Cy(Mue.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(xue.SIZE,xue.SIZE);i=i.getNext(n)){var a,o=Cy(u9.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=Tue.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return HB.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return HB.failure(Oue.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=Cy(Mue.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return HB.failure(Oue.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return HB.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=h9.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=Tue.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=Aue.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=Cy("diagonal"===r?Ite.DIAGONALS:Ite.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=Tue.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=Tue.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=Cy("diagonal"===r?Ite.DIAGONALS:Ite.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,xue.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=Tue.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=Tue.EMPTY)}else o.push(l),t[l.y][l.x]=Tue.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?ZB.failure(Oue.MUST_FLIP_LODESTONE()):ZB.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return ZB.failure(Oue.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return ZB.failure(Hte.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?ZB.failure(Hte.MUST_CLICK_ON_EMPTY_SQUARE()):ZB.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?ene.DRAW:0===t[0]?ene.ONE_WON:0===t[1]?ene.ZERO_WON:ene.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n)),n.singleton.get()}}]),n}(tne);Rue.THREATENED_COORD_RANGE=R9.from({top:{startForBigPlate:new Rte(0,0),startForSmallPlate:new Rte(0,1),direction:Ite.RIGHT},bottom:{startForBigPlate:new Rte(0,xue.SIZE-1),startForSmallPlate:new Rte(0,xue.SIZE-2),direction:Ite.RIGHT},left:{startForBigPlate:new Rte(0,0),startForSmallPlate:new Rte(1,0),direction:Ite.DOWN},right:{startForBigPlate:new Rte(xue.SIZE-1,0),startForSmallPlate:new Rte(xue.SIZE-2,0),direction:Ite.DOWN}}),Rue.singleton=zB.empty();var Nue=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=Cy(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=Rue.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=Cy(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new Sue(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new x9([{top:0,bottom:0,left:0,right:0}]);var n,r=new x9,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=Cy(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(ny(ny({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(ny(ny({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(ny(ny({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(ny(ny({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<xue.SIZE;r++)for(var i=0;i<xue.SIZE;i++){var a=new Rte(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?u9.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?u9.ONE.getVictoryValue():n[0]*u9.ZERO.getScoreModifier()+n[1]*u9.ONE.getScoreModifier(),new $te(t)}}]),n}(Gte),Due=Tue.UNREACHABLE,Lue=Tue.EMPTY,Fue=Iue.ZERO,Uue=Iue.ONE,Vue=Aue.of(u9.ONE,{direction:"push",orientation:"orthogonal"}),Bue={top:zB.of(Mue.EMPTY_5),bottom:zB.of(Mue.EMPTY_5),left:zB.of(Mue.EMPTY_5),right:zB.of(Mue.EMPTY_5)},zue=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Fo||(Fo=ey(["Board and aim of the game"]))),$localize(Uo||(Uo=ey(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),xue.getInitialState()),ane.forClick($localize(Vo||(Vo=ey(["Selecting a lodestone"]))),$localize(Bo||(Bo=ey(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),xue.getInitialState(),["#lodestone_push_diagonal"],$localize(zo||(zo=ey(["Congratulations!"]))),$localize(Ho||(Ho=ey(["This is not the right lodestone, try again."])))),ane.informational($localize(Go||(Go=ey(["The repelling lodestone"]))),$localize($o||($o=ey(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),xue.getInitialState()),ane.informational($localize(Zo||(Zo=ey(["The attracting lodestone"]))),$localize(qo||(qo=ey(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),xue.getInitialState()),ane.informational($localize(Wo||(Wo=ey(["Flipping the lodestone"]))),$localize(jo||(jo=ey(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),xue.getInitialState()),ane.fromPredicate($localize(Yo||(Yo=ey(["Capturing"]))),$localize(Ko||(Ko=ey(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),xue.getInitialState(),new Sue(new Rte(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t,n){return 32===n.remainingSpaces()?ZB.failure($localize(Qo||(Qo=ey(["You have not captured any of the opponent's pieces, try again!"])))):ZB.SUCCESS},"Congratulations!"),ane.fromPredicate($localize(Xo||(Xo=ey(["Crumbling a first pressure plate"]))),$localize(Jo||(Jo=ey(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new xue([[Lue,Lue,Lue,Lue,Uue,Lue,Lue,Lue],[Lue,Lue,Fue,Lue,Lue,Uue,Lue,Lue],[Lue,Lue,Vue,Lue,Lue,Lue,Lue,Fue],[Lue,Lue,Lue,Lue,Uue,Lue,Lue,Fue],[Lue,Lue,Lue,Lue,Lue,Fue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue]],0,new R9([{key:u9.ONE,value:new Rte(2,2)}]),ny(ny({},Bue),{},{top:Mue.EMPTY_5.addCaptured(u9.ONE,4)})),new Sue(new Rte(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return 5===n.pressurePlates.top.get().width?ZB.failure($localize(es||(es=ey(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):ZB.SUCCESS},"Congratulations!"),ane.fromPredicate($localize(ts||(ts=ey(["Crumbling a second pressure plate"]))),$localize(ns||(ns=ey(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new xue([[Due,Due,Due,Due,Due,Due,Due,Due],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Fue],[Lue,Lue,Lue,Lue,Lue,Fue,Lue,Fue],[Lue,Vue,Lue,Lue,Uue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Uue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue]],0,new R9([{key:u9.ONE,value:new Rte(1,4)}]),ny(ny({},Bue),{},{top:Mue.EMPTY_3.addCaptured(u9.ONE,2)})),new Sue(new Rte(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return n.pressurePlates.top.isPresent()?ZB.failure($localize(rs||(rs=ey(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):ZB.SUCCESS},"Congratulations!"),ane.informational($localize(is||(is=ey(["Minimal board"]))),$localize(as||(as=ey(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new xue([[Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Fue,Uue,Lue,Lue,Due,Due],[Due,Due,Vue,Uue,Lue,Lue,Due,Due],[Due,Due,Lue,Fue,Fue,Lue,Due,Due],[Due,Due,Fue,Lue,Lue,Lue,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due]],0,new R9([{key:u9.ONE,value:new Rte(2,3)}]),{top:zB.empty(),bottom:zB.empty(),left:zB.empty(),right:zB.empty()})),ane.fromMove($localize(os||(os=ey(["Making the lodestone fall"]))),$localize(ss||(ss=ey(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new xue([[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Uue,Lue,Lue],[Lue,Lue,Lue,Vue,Lue,Lue,Fue,Lue],[Lue,Lue,Fue,Fue,Uue,Lue,Lue,Fue],[Lue,Lue,Lue,Lue,Lue,Fue,Lue,Lue],[Lue,Lue,Fue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Uue,Lue,Lue,Lue,Lue,Lue],[Lue,Lue,Lue,Lue,Lue,Lue,Lue,Lue]],0,new R9([{key:u9.ONE,value:new Rte(3,2)}]),ny(ny({},Bue),{},{top:Mue.EMPTY_5.addCaptured(u9.ONE,4)})),[new Sue(new Rte(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(us||(us=ey(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(cs||(cs=ey(["Failed, try again."])))),ane.fromMove($localize(ls||(ls=ey(["End of the game"]))),$localize(fs||(fs=ey(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new xue([[Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due],[Due,Uue,Fue,Uue,Lue,Lue,Due,Due],[Due,Uue,Vue,Lue,Uue,Lue,Due,Due],[Due,Lue,Lue,Fue,Fue,Lue,Due,Due],[Due,Uue,Fue,Lue,Uue,Lue,Due,Due],[Due,Lue,Lue,Lue,Fue,Lue,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due]],0,new R9([{key:u9.ONE,value:new Rte(2,3)}]),{top:zB.empty(),bottom:Mue.EMPTY_3.addCaptured(u9.ZERO,2),left:zB.of(Mue.EMPTY_3),right:zB.empty()}),[new Sue(new Rte(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(hs||(hs=ey(["Congratulations, you won!"]))),$localize(ds||(ds=ey(["This is not the winning move. Try again."]))))]});function Hue(e,t){if(1&e&&(zC(),NP(0,"circle",10)),2&e){var n=GP(2),r=n.index,i=n.$implicit,a=GP().index,o=GP();qP("id","piece_",r,"_",a,""),AP("ngClass",i.pieceClasses),_P("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Gue(e,t){if(1&e&&(zC(),NP(0,"polygon",15)),2&e){var n=GP().$implicit,r=GP(3).$implicit,i=GP(2);SP("transform","rotate(",90*n,")"),AP("ngClass",r.lodestone.movingClass),_P("points",i.TRIANGLE_OUT)}}function $ue(e,t){if(1&e&&(zC(),NP(0,"polygon",15)),2&e){var n=GP().$implicit,r=GP(3).$implicit,i=GP(2);SP("transform","rotate(",90*n,")"),AP("ngClass",r.lodestone.movingClass),_P("points",i.TRIANGLE_IN)}}function Zue(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Gue,1,3,"polygon",14),OP(2,$ue,1,3,"polygon",14),RP()),2&e){var n=GP(3).$implicit;Wb(1),AP("ngIf","push"===n.lodestone.direction),Wb(1),AP("ngIf","pull"===n.lodestone.direction)}}var que=function(){return[0,1,2,3]};function Wue(e,t){if(1&e&&(zC(),xP(0,"g",11),NP(1,"circle",12),NP(2,"circle",13),xP(3,"g"),OP(4,Zue,3,2,"g",1),RP(),RP()),2&e){var n=GP(2),r=n.index,i=n.$implicit,a=GP().index,o=GP();_P("transform",o.getSquareTransform(r,a)),Wb(1),AP("ngClass",i.lodestone.selectedClass),_P("r",o.PIECE_RADIUS),Wb(1),AP("ngClass",i.lodestone.pieceClasses),_P("r",o.PIECE_RADIUS/4),Wb(1),SP("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),Wb(1),AP("ngForOf",FT(7,que))}}function jue(e,t){if(1&e){var n=FP();zC(),xP(0,"g",6),BP("click",function(){hC(n);var e=GP().$implicit;return GP(2).selectCoord(e.coord)}),NP(1,"rect",7),OP(2,Hue,1,6,"circle",8),OP(3,Wue,5,8,"g",9),RP()}if(2&e){var r=GP(),i=r.index,a=r.$implicit,o=GP().index,s=GP();qP("id","square_",i,"_",o,""),Wb(1),AP("ngClass",a.squareClasses),_P("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),Wb(1),AP("ngIf",a.hasPiece),Wb(1),AP("ngIf",a.lodestone)}}function Yue(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,jue,4,9,"g",5),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngIf",!1===n.crumbled)}}function Kue(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Yue,2,1,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Que(e,t){if(1&e&&(zC(),xP(0,"g",16),NP(1,"circle",17),RP()),2&e){var n=t.$implicit,r=t.index,i=GP();ZP("id","capture_",r,""),_P("transform",i.getCaptureTransform(r)),Wb(1),AP("ngClass",n.pieceClasses),_P("r",i.PIECE_RADIUS)}}function Xue(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"polygon",15),RP()),2&e){var n=t.$implicit,r=GP().$implicit,i=GP();Wb(1),SP("transform","rotate(",90*n,")"),AP("ngClass",r.movingClass),_P("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Jue(e,t){if(1&e){var n=FP();zC(),xP(0,"g",6),BP("click",function(){var e=hC(n).$implicit;return GP().selectLodestone(e)}),NP(1,"circle",12),NP(2,"circle",13),xP(3,"g"),OP(4,Xue,2,3,"g",1),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP();qP("id","lodestone_",r.direction,"_",r.orientation,""),_P("transform",a.getAvailableLodestoneTransform(i)),Wb(1),AP("ngClass",r.selectedClass),_P("r",a.PIECE_RADIUS),Wb(1),AP("ngClass",r.pieceClasses),_P("r",a.PIECE_RADIUS/4),Wb(1),SP("transform","rotate(","diagonal"===r.orientation?45:0,")"),Wb(1),AP("ngForOf",FT(9,que))}}function ece(e,t){if(1&e&&(zC(),NP(0,"circle",10)),2&e){var n=GP(),r=n.index,i=n.$implicit,a=GP().$implicit,o=GP();qP("id","platePiece_",a.position,"_",r,""),AP("ngClass",i.pieceClasses),_P("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function tce(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"g",6),BP("click",function(){var e=hC(n),t=e.$implicit,r=e.index,i=GP().$implicit;return GP().onPressurePlateClick(t.temporary,i.position,r)}),NP(2,"rect",18),OP(3,ece,1,6,"circle",8),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().$implicit,o=GP();_P("transform",o.getPressurePlateTransform(a.position)),Wb(1),qP("id","plate_",a.position,"_",i,""),Wb(1),qP("id","plateSquare_",a.position,"_",i,""),AP("ngClass",r.squareClasses),_P("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r.hasPiece)}}function nce(e,t){if(1&e&&(zC(),xP(0,"g",16),OP(1,tce,4,11,"g",1),RP()),2&e){var n=t.$implicit;ZP("id","pressurePlate_",n.position,""),Wb(1),AP("ngForOf",n.coords)}}function rce(e,t){if(1&e&&(zC(),NP(0,"rect",19)),2&e){var n=GP();qP("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),_P("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var ice=function(e){fy(n,e);var t=dy(n);function n(e){var r;by(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:zB.empty(),pressurePlateShift:{top:new Ste(0,0),left:new Ste(0,0),right:new Ste(0,0),bottom:new Ste(0,0)}},r.stateAfterPlacingLodestone=zB.empty(),r.lastInfos=zB.empty(),r.capturesToPlace=0,r.selectedCoord=zB.empty(),r.selectedLodestone=zB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=Rue.get(),r.tutorial=(new zue).tutorial,r.availableMinimaxes=[new Nue(r.rules,"LodestoneDummyMinimax")],r.encoder=Sue.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.getState(),r.scores=zB.of([0,0]),r}return Py(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(Oue.MUST_PLACE_CAPTURES()));case 5:return i=Rue.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),ZB.SUCCESS):(t.selectedCoord=zB.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),ZB.SUCCESS)));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return $7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),a=Aue.of(i,e),n.abrupt("return",t.selectedLodestone.equalsValue(a)?(t.cancelMoveAttempt(),ZB.SUCCESS):(t.selectedLodestone=zB.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),ZB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.selectedCoord.isPresent(),"coord should have been selected"),$7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),$7(Rue.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=Rue.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=zB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=zB.of(e.displayedState),e.updateViewInfo(),ZB.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.selectedCoord.isPresent(),"coord should have been selected"),$7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new Sue(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(Oue.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=h9.copyBiArray(a.board),u=ny({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Rue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new xue(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),ZB.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=h9.copyBiArray(a.board),u=ny({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Rue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new xue(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),ZB.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=zB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=zB.empty(),this.lastInfos=zB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=h9.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=Tue.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=zB.empty(),this.selectedLodestone=zB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<xue.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<xue.SIZE;t++){var n=new Rte(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:zB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=Aue.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected-stroke"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=Cy(Mue.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=zB.of(Rue.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=Cy(Mue.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=LB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved-fill"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=Cy(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved-fill")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=Cy(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill")}}catch(s){n.e(s)}finally{n.f()}var i,a=Cy(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured-fill")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Rte(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new Rte(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new Rte(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new Rte(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(xue.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(xue.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(Nte);ice.PRESSURE_PLATE_EXTRA_SHIFT=.2,ice.PRESSURE_PLATES_POSITIONS=R9.from({top:{startForBigPlate:new Rte(.5,-1-ice.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Rte(1.5,0-ice.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ite.RIGHT},bottom:{startForBigPlate:new Rte(.5,8+ice.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Rte(1.5,7+ice.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ite.RIGHT},left:{startForBigPlate:new Rte(-1-ice.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Rte(0-ice.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ite.DOWN},right:{startForBigPlate:new Rte(8+ice.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Rte(7+ice.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ite.DOWN}}),ice.\u0275fac=function(e){return new(e||ice)(IP(H7))},ice.\u0275cmp=wk({type:ice,selectors:[["app-lodestone"]],features:[cP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Kue,2,1,"g",1),OP(2,Que,2,4,"g",2),OP(3,Jue,5,10,"g",3),OP(4,nce,2,2,"g",2),OP(5,rce,1,6,"rect",4),RP()),2&e&&(Wb(1),AP("ngForOf",t.viewInfo.boardInfo),Wb(1),AP("ngForOf",t.viewInfo.capturesToPlace),Wb(1),AP("ngForOf",t.viewInfo.availableLodestones),Wb(1),AP("ngForOf",t.viewInfo.pressurePlates),Wb(1),AP("ngIf",t.viewInfo.selected.isPresent()))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var ace=function(){var e=Py(function e(){by(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(vs||(vs=ey(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(ps||(ps=ey(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize(gs||(gs=ey(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(ys||(ys=ey(["Drones must move one or two steps in any direction."])))},e}(),oce=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return Py(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return HB.failure(ace.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return HB.failure(ace.END_COORD_OUT_OF_RANGE());if(t.equals(e))return HB.failure(Hte.MOVE_CANNOT_BE_STATIC());var i=Ite.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?HB.failure(i.getReason()):HB.success(new n(e,t,r))}}]),n}(Qne);oce.encoder=a9.tuple([Rte.numberEncoder(4,8),Rte.numberEncoder(4,8),a9.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return oce.from(e[0],e[1],e[2]).get()});var sce=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){$7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?zB.of(e.from(r)):zB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(LB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();sce.EMPTY=new sce(0),sce.PAWN=new sce(1),sce.DRONE=new sce(2),sce.QUEEN=new sce(3);var uce=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).ruler=e,i}return Py(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=Cy(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case sce.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case sce.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case sce.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new Rte(t,n),a=[],o=Cy(Ite.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(sce.DRONE),s=!1===e.isTherePieceOnPlayerSide(sce.QUEEN),u=e.lastMove,c=Cy(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===sce.EMPTY)this.add(i,oce.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=sce.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=oce.from(t,l).get();(d===sce.DRONE&&o||d===sce.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,oce.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new Rte(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=Cy(Ite.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(sce.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(sce.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new Rte(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(u9.ZERO);t=e.gameState.getScoreOf(u9.ONE)-r}return new $te(t)}}]),n}(Gte),cce=function(){function e(t){by(this,e),this.captures=t,t.makeImmutable()}return Py(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new R9,i=Cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),lce=function(e){fy(n,e);var t=dy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zB.empty(),s=arguments.length>4?arguments[4]:void 0;return by(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new R9([{key:u9.ZERO,value:cce.from([])},{key:u9.ONE,value:cce.from([])}])),s.makeImmutable(),i.captured=s,i}return Py(n,[{key:"getPlayerTerritory",value:function(e){return e===u9.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=Cy(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(u9.ZERO)?zB.of(u9.ZERO):this.isTerritoryEmpty(u9.ONE)?zB.of(u9.ONE):zB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=Cy(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==sce.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(e).get();return[t.captures.get(sce.PAWN).getOrElse(0),t.captures.get(sce.DRONE).getOrElse(0),t.captures.get(sce.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=sce.EMPTY,t=sce.PAWN,r=sce.DRONE,i=sce.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,zB.empty())}}]),n}(qte);lce.PLAYER_ZERO_TERRITORY=new x9([4,5,6,7]),lce.PLAYER_ONE_TERRITORY=new x9([0,1,2,3]);var fce=function(){var e=Py(function e(){by(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(ms||(ms=ey(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(ks||(ks=ey(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(Cs||(Cs=ey(["You cannot perform a move that is the reverse of the previous one."])))},e}(),hce=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=sce.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=zB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new lce(i,t.turn+1,zB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return HB.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return HB.failure(fce.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return HB.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){$7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==sce.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==sce.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return HB.failure(fce.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return HB.failure(fce.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return HB.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return HB.failure(fce.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===sce.EMPTY)return HB.failure(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===sce.PAWN)return e.isValidForPawn()?HB.success(void 0):HB.failure(ace.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===sce.DRONE&&!1===e.isValidForDrone())return HB.failure(ace.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=Cy(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==sce.EMPTY)return HB.failure(Hte.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return HB.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return sce.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,ene.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=ene.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return ene.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(u9.ZERO),r=e.getScoreOf(u9.ONE);return n>r?ene.ZERO_WON:r>n?ene.ONE_WON:t}}]),n}(tne);hce.STARTING_COUNT_DOWN=zB.of(7);var dce=function(){var e=Py(function e(){by(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(ws||(ws=ey(["Failed, you did not capture any piece."])))},e}(),vce=sce.EMPTY,pce=sce.PAWN,gce=sce.DRONE,yce=sce.QUEEN,mce=function(){return $localize(_s||(_s=ey(["This is not a field promotion!"])))},kce=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(bs||(bs=ey(["Goal of the game"]))),$localize(Es||(Es=ey(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),lce.getInitialState()),ane.informational($localize(Ps||(Ps=ey(["The pieces"]))),$localize(Ss||(Ss=ey(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),lce.getInitialState()),ane.fromPredicate($localize(Os||(Os=ey(["Moving pawns"]))),$localize(Ts||(Ts=ey(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),lce.getInitialState(),oce.from(new Rte(2,5),new Rte(1,4)).get(),function(e,t,n){return n.getPieceAt(e.end)===sce.PAWN?ZB.SUCCESS:ZB.failure($localize(Is||(Is=ey(["This is not a pawn!"]))))},$localize(As||(As=ey(["Congratulations!"])))),ane.fromPredicate($localize(Ms||(Ms=ey(["Moving drones"]))),$localize(xs||(xs=ey(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),lce.getInitialState(),oce.from(new Rte(1,7),new Rte(0,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===sce.DRONE?ZB.SUCCESS:ZB.failure($localize(Rs||(Rs=ey(["This is not a drone!"]))))},$localize(Ns||(Ns=ey(["Congratulations!"])))),ane.fromPredicate($localize(Ds||(Ds=ey(["Moving queens"]))),$localize(Ls||(Ls=ey(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new lce([[gce,pce,vce,vce],[yce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,yce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[yce,gce,pce,vce]],1),oce.from(new Rte(2,3),new Rte(2,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===sce.QUEEN?ZB.SUCCESS:ZB.failure($localize(Fs||(Fs=ey(["This is not a queen!"]))))},$localize(Us||(Us=ey(["Congratulations!"])))),ane.fromMove($localize(Vs||(Vs=ey(["Capture"]))),$localize(Bs||(Bs=ey(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new lce([[gce,pce,pce,vce],[vce,vce,vce,vce],[yce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,pce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,gce,pce,vce]],1),[oce.from(new Rte(0,2),new Rte(2,4)).get()],$localize(zs||(zs=ey(["Congratulations! By capturing that pawn, you won one point."]))),dce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ane.fromMove($localize(Hs||(Hs=ey(["Field Promotion (1/2)"]))),$localize(Gs||(Gs=ey(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new lce([[vce,vce,vce,yce],[vce,pce,vce,vce],[vce,vce,pce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,yce],[vce,vce,gce,vce],[vce,pce,vce,vce]],1),[oce.from(new Rte(1,1),new Rte(2,2)).get(),oce.from(new Rte(2,2),new Rte(1,1)).get()],$localize($s||($s=ey(["Congratulations!"]))),mce()),ane.fromPredicate($localize(Zs||(Zs=ey(["Field Promotion (2/2)"]))),$localize(qs||(qs=ey(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new lce([[pce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,gce,vce],[vce,pce,vce,vce]],0),oce.from(new Rte(1,7),new Rte(2,6)).get(),function(e,t,n){return n.getPieceAt(e.end)===sce.QUEEN?ZB.SUCCESS:ZB.failure(mce())},$localize(Ws||(Ws=ey(["Congratulations!"])))),ane.fromPredicate($localize(js||(js=ey(["Call the clock"]))),$localize(Ys||(Ys=ey(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),lce.getInitialState(),oce.from(new Rte(1,5),new Rte(0,4),!0).get(),function(e,t,n){return e.calledTheClock?ZB.SUCCESS:ZB.failure($localize(Ks||(Ks=ey(["You did not call the clock!"]))))},$localize(Qs||(Qs=ey(["Congratulations!"])))),ane.fromMove($localize(Xs||(Xs=ey(["Restarting the clock"]))),$localize(Js||(Js=ey(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new lce([[vce,vce,vce,vce],[vce,pce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,pce],[vce,vce,gce,vce],[vce,pce,vce,vce]],15,zB.empty(),zB.of(1)),[oce.from(new Rte(1,1),new Rte(2,2)).get()],$localize(eu||(eu=ey(["Congratulations!"]))),$localize(tu||(tu=ey(["This is not a capture, the game is now over, please retry!"])))),ane.anyMove($localize(nu||(nu=ey(["End game (by clock)"]))),$localize(ru||(ru=ey(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new lce([[vce,vce,vce,yce],[vce,pce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[gce,vce,vce,vce],[vce,vce,vce,vce],[vce,gce,vce,vce]],15,zB.empty(),zB.of(1)),oce.from(new Rte(1,1),new Rte(2,2)).get(),$localize(iu||(iu=ey(["Congratulations!"])))),ane.fromPredicate($localize(au||(au=ey(["End by emptyness"]))),$localize(ou||(ou=ey(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new lce([[vce,vce,vce,yce],[vce,pce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,pce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce],[vce,vce,vce,vce]],0),oce.from(new Rte(2,4),new Rte(1,3)).get(),function(e,t,n){return 3===e.end.y?ZB.SUCCESS:ZB.failure($localize(su||(su=ey(["Your piece is still in you territory!"]))))},$localize(uu||(uu=ey(["Congratulations!"]))))]});function Cce(e,t){if(1&e&&(zC(),NP(0,"g",19)),2&e){var n=GP(2).index,r=GP().index,i=GP();iS(i.style),qP("mainShapeId","pawn_",n,"_",r,""),AP("pieceClasses",i.getPieceClasses(n,r))}}function wce(e,t){if(1&e&&(zC(),NP(0,"g",20)),2&e){var n=GP(2).index,r=GP().index,i=GP();iS(i.style),qP("mainShapeId","drone_",n,"_",r,""),AP("pieceClasses",i.getPieceClasses(n,r))}}function _ce(e,t){if(1&e&&(zC(),NP(0,"g",21)),2&e){var n=GP(2).index,r=GP().index,i=GP();iS(i.style),qP("mainShapeId","queen_",n,"_",r,""),AP("pieceClasses",i.getPieceClasses(n,r))}}function bce(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Cce,1,5,"g",16),OP(2,wce,1,5,"g",17),OP(3,_ce,1,5,"g",18),RP()),2&e){var n=GP(),r=n.index,i=n.$implicit,a=GP().index,o=GP();_P("transform",o.getPieceLocation(r,a)),Wb(1),AP("ngIf",i===o.pieces.PAWN),Wb(1),AP("ngIf",i===o.pieces.DRONE),Wb(1),AP("ngIf",i===o.pieces.QUEEN)}}function Ece(e,t){if(1&e){var n=FP();zC(),xP(0,"g",14),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(1,"rect",15),OP(2,bce,4,4,"g",13),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();qP("id","click_",i,"_",a,""),_P("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),Wb(1),qP("id","square_",i,"_",a,""),AP("ngClass",o.getSquareClasses(i,a)),_P("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r!==o.pieces.EMPTY)}}function Pce(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",22),BP("click",function(){var e=hC(n).$implicit;return GP(3).onClick(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP(3);Wb(1),qP("id","indicator_",r.x,"_",r.y,""),_P("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function Sce(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Pce,2,7,"g",1),RP()),2&e){var n=GP(2);Wb(1),AP("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function Oce(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Ece,3,11,"g",12),OP(2,Sce,2,1,"g",13),RP()),2&e){var n=t.$implicit,r=GP();_P("transform","translate("+r.SPACE_SIZE+", 0)"),Wb(1),AP("ngForOf",n),Wb(1),AP("ngIf",r.selectedPieceInfo.isPresent())}}function Tce(e,t){if(1&e&&(zC(),xP(0,"text",23),pS(1),RP()),2&e){var n=GP();AP("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),_P("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),Wb(1),gS(n.countDown.get())}}function Ice(e,t){if(1&e&&(zC(),NP(0,"polyline",24)),2&e){var n=GP();AP("ngClass",n.getClockCircleClasses()),_P("points",n.clockNeedlesPoints)}}var Ace=function(e){return[e]};function Mce(e,t){if(1&e){var n=FP();zC(),DP(0),xP(1,"g",27),BP("click",function(){var e=hC(n).index;return GP(2).chooseStyle(e)}),RP(),LP()}if(2&e){var r=t.$implicit,i=t.index,a=GP(2);Wb(1),iS(r.style),AP("id",r.name)("pieceClasses",UT(5,Ace,"player"+a.getCurrentPlayer().value+"-fill")),_P("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function xce(e,t){if(1&e&&(zC(),xP(0,"g",25),NP(1,"rect",26),OP(2,Mce,2,7,"ng-container",1),RP()),2&e){var n=GP();Wb(1),_P("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),Wb(1),AP("ngForOf",n.listOfStyles)}}function Rce(e,t){if(1&e&&(zC(),xP(0,"text",33),pS(1),RP()),2&e){var n=GP(2).$implicit,r=GP().$implicit,i=GP();AP("ngClass","player"+(0===r.value?1:0)+"-fill"),_P("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),Wb(1),gS(n+" x ")}}function Nce(e,t){if(1&e&&(zC(),NP(0,"g",34)),2&e){var n=GP(3).$implicit;iS(GP().style),AP("pieceClasses",UT(3,Ace,"player"+(0===n.value?1:0)+"-fill"))}}function Dce(e,t){if(1&e&&(zC(),NP(0,"g",35)),2&e){var n=GP(3).$implicit;iS(GP().style),AP("pieceClasses",UT(3,Ace,"player"+(0===n.value?1:0)+"-fill"))}}function Lce(e,t){if(1&e&&(zC(),NP(0,"g",36)),2&e){var n=GP(3).$implicit;iS(GP().style),AP("pieceClasses",UT(3,Ace,"player"+(0===n.value?1:0)+"-fill"))}}function Fce(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Rce,2,4,"text",29),xP(2,"g",28),OP(3,Nce,1,5,"g",30),OP(4,Dce,1,5,"g",31),OP(5,Lce,1,5,"g",32),RP(),RP()),2&e){var n=GP(),r=n.index,i=n.$implicit,a=GP().$implicit,o=GP();_P("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),Wb(1),AP("ngIf",i>1),Wb(1),qP("id","piece_",r,"_player_",a.value,""),_P("transform","translate("+o.SPACE_SIZE+", 0)"),Wb(1),AP("ngIf",0===r),Wb(1),AP("ngIf",1===r),Wb(1),AP("ngIf",2===r)}}function Uce(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Fce,6,8,"g",13),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngIf",n>0)}}function Vce(e,t){if(1&e&&(zC(),xP(0,"g"),xP(1,"g",28),OP(2,Uce,2,1,"g",1),RP(),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),ZP("id","capture_of_player_",n.value,""),_P("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n.value*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),Wb(1),AP("ngForOf",r.state.getCapturesOf(n))}}var Bce=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=sce,r.selectedPieceInfo=zB.empty(),r.countDown=zB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.hasAsymetricBoard=!0,r.rules=new hce(lce),r.availableMinimaxes=[new uce(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=oce.encoder,r.tutorial=(new kce).tutorial,r.scores=zB.of([0,0]),r.updateBoard(),r}return Py(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.getState(),this.board=this.state.board;var e=this.state.getScoreOf(u9.ZERO),t=this.state.getScoreOf(u9.ONE);this.countDown=this.state.countDown,this.scores=zB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new Rte(e,t),r=[];return r.push(t>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==sce.EMPTY&&this.getState().isInOpponentTerritory(new Rte(0,t))&&r.push("last-move-stroke"),r}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new Rte(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),ZB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=zB.of({selectedPiece:e,legalLandings:r}),ZB.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===sce.PAWN?Ite.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===sce.DRONE?2:8)).filter(function(n){var r=oce.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return Ite.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===sce.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),ZB.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return $7((i=oce.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.getState(),n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=oce.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==sce.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=zB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),ZB.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===u9.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new Rte(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved-fill"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===sce.EMPTY||i.gameState.isInOpponentTerritory(new Rte(0,t))?r.push("moved-fill"):r.push("captured-fill"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new Rte(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new Rte(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=Cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(Bne);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-martian-chess"]],features:[cP],decls:14,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Oce,3,3,"g",1),xP(2,"g",2),BP("click",function(){return t.onClockClick()}),NP(3,"rect",3),NP(4,"circle",4),OP(5,Tce,2,5,"text",5),OP(6,Ice,1,2,"polyline",6),RP(),xP(7,"g",7),xP(8,"g",8),BP("click",function(){return t.onModeCogClick()}),NP(9,"rect",3),NP(10,"path",9),RP(),OP(11,xce,3,5,"g",10),RP(),xP(12,"g",11),OP(13,Vce,3,3,"g",1),RP(),RP()),2&e&&(_P("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT)("transform",t.rotation),Wb(1),AP("ngForOf",t.board),Wb(1),_P("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),Wb(1),_P("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),Wb(1),AP("ngClass",t.getClockCircleClasses()),_P("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),Wb(1),AP("ngIf",t.countDown.isPresent()),Wb(1),AP("ngIf",t.countDown.isAbsent()),Wb(1),_P("transform",t.configViewTranslation),Wb(2),_P("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),Wb(1),AP("ngClass",t.getPlayerClass(t.getCurrentPlayer())),_P("transform",t.configCogTransformation),Wb(1),AP("ngIf",t.displayModePanel),Wb(2),AP("ngForOf",t.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zce=Number.MAX_SAFE_INTEGER,Hce=Number.MIN_SAFE_INTEGER,Gce=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,h9.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return Py(n,null,[{key:"getInitialState",value:function(){return new n(0,new Rte(0,0))}}]),n}(qte);Gce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Gce.BOARD_1=[[0,+zce,-1,-1],[1,2,+zce,-1],[+Hce,3,4,-1],[-1,+Hce,+Hce,-1]],Gce.BOARD_2=[[0,+zce,-1,-1],[+zce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Gce.BOARD_3=[[0,1,+Hce,-1],[1,+Hce,-1,-1],[+Hce,-1,-1,-1],[-1,-1,-1,-1]],Gce.BOARD_4=[[0,1,+Hce,-1],[1,+Hce,-1,-1],[+Hce,-1,-1,-1],[-1,-1,-1,1]],Gce.initialBoard=Gce.BOARD_0;var $ce=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new Rte(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Gce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?HB.failure("incorrect move"):HB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===u9.ZERO.getVictoryValue()?ene.ZERO_WON:n===u9.ONE.getVictoryValue()?ene.ONE_WON:t.location.equals(new Rte(3,3))?0===n?ene.DRAW:n>0?ene.ONE_WON:ene.ZERO_WON:ene.ONGOING}}]),n}(tne),Zce=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).right=e,r}return Py(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(jte);Zce.RIGHT=new Zce(!0),Zce.DOWN=new Zce(!1),Zce.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Zce.RIGHT:Zce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(a9));var qce=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=$ce.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n=e.gameState;return new $te(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Zce.RIGHT),n.location.y<3&&t.push(Zce.DOWN),t}}]),n}(Gte);function Wce(e,t){1&e&&(DP(0),pS(1,"("),LP())}function jce(e,t){1&e&&(DP(0),pS(1,")"),LP())}function Yce(e,t){if(1&e&&(xP(0,"td"),OP(1,Wce,2,0,"ng-container",3),pS(2),OP(3,jce,2,0,"ng-container",3),RP()),2&e){var n=t.$implicit,r=t.index,i=GP().index,a=GP();Wb(1),AP("ngIf",a.coord.x===r&&a.coord.y===i),Wb(1),yS(" ",n," "),Wb(1),AP("ngIf",a.coord.x===r&&a.coord.y===i)}}function Kce(e,t){if(1&e&&(xP(0,"tr"),OP(1,Yce,4,3,"td",0),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}var Qce=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).coord=new Rte(-1,-1),r.rules=new $ce(Gce),r.availableMinimaxes=[new qce(r.rules,"MinimaxTestingMinimax")],r.encoder=Zce.encoder,r}return Py(n,[{key:"chooseRight",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Zce.RIGHT,e.getState()));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Zce.DOWN,e.getState()));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-minimax-testing"]],features:[cP],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(xP(0,"table"),OP(1,Kce,2,1,"tr",0),xP(2,"div",1),BP("click",function(){return t.chooseRight()}),pS(3," goRight "),RP(),xP(4,"div",2),BP("click",function(){return t.chooseDown()}),pS(5," goDown "),RP(),xP(6,"div"),pS(7),RP(),RP()),2&e&&(Wb(1),AP("ngForOf",t.board),Wb(6),yS(" ",t.coord," "))},directives:[hM,vM],encapsulation:2}),e}(),Xce=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,null,[{key:"getInitialState",value:function(){return new n(h9.createTable(7,6,s9.NONE),0)}}]),n}(qte),Jce=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this)).x=e,r}return Py(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(jte);Jce.ZERO=new Jce(0),Jce.ONE=new Jce(1),Jce.TWO=new Jce(2),Jce.THREE=new Jce(3),Jce.FOUR=new Jce(4),Jce.FIVE=new Jce(5),Jce.SIX=new Jce(6),Jce.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Jce.of(e)}}]),n}(a9));var ele=function(){var e=Py(function e(){by(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(cu||(cu=ey(["Please put your piece in an incomplete column."])))},e}(),tle=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedSpace(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Xce(a,s+1)}},{key:"isLegal",value:function(e,t){return FB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?HB.failure(ele.COLUMN_IS_FULL()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new Rte(r,i));if(Jte.getScoreStatus(a)===Qte.VICTORY)return ene.getVictory(t.getCurrentOpponent())}return 42===t.turn?ene.DRAW:ene.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Rte(r,i));(a===u9.ZERO.getVictoryValue()||a===u9.ONE.getVictoryValue())&&t.push(new Rte(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){FB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Rte(r,i));if(Jte.getScoreStatus(a)!==Qte.DEFAULT)return FB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new $te(a);t+=a}return new $te(t)}},{key:"getLowestUnoccupiedSpace",value:function(e,t){for(var n=0;n<6&&e[n][t]===s9.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new Rte(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return $7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===u9.ONE?u9.ZERO:u9.ONE}},{key:"getSquareScore",value:function(e,t){FB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),FB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new R9,u=new R9,c=Cy(Ite.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[Ite.UP,Ite.UP_RIGHT,Ite.RIGHT,Ite.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return FB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){FB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===s9.NONE){var a=Jce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return FB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(tne);return e.VERBOSE=!1,e}(),nle=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){return tle.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return FB(tle.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),tle.getBoardValue(t)}}]),n}(Gte),rle=s9.NONE,ile=s9.ZERO,ale=s9.ONE,ole=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(lu||(lu=ey(["Goal of the game"]))),$localize(fu||(fu=ey(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Xce.getInitialState()),ane.anyMove($localize(hu||(hu=ey(["Dropping a piece"]))),$localize(du||(du=ey(["Click on any space in any column."]))),Xce.getInitialState(),Jce.THREE,$localize(vu||(vu=ey(["As you can see, the piece falls at the bottom of the column."])))),ane.fromMove($localize(pu||(pu=ey(["Victory"]))),$localize(gu||(gu=ey(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Xce([[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,ale,rle,rle,rle],[rle,rle,rle,ale,rle,rle,rle],[rle,rle,ile,ile,ile,ale,rle]],0),[Jce.of(1)],$localize(yu||(yu=ey(["You won!"]))),$localize(mu||(mu=ey(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),ane.fromMove($localize(ku||(ku=ey(["Other victory"]))),$localize(Cu||(Cu=ey(["You can also align 4 pieces diagonally or vertically."]))),new Xce([[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle,rle],[rle,rle,rle,ile,ale,rle,rle],[rle,rle,ile,ile,ale,rle,rle],[rle,ile,ale,ile,ile,rle,rle]],0),[Jce.of(3),Jce.of(4)],$localize(wu||(wu=ey(["You won!"]))),$localize(_u||(_u=ey(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function sle(e,t){if(1&e&&(zC(),NP(0,"circle",8)),2&e){var n=GP().index,r=GP().index,i=GP();AP("ngClass",i.getSquareFillClass(n,r)),_P("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function ule(e,t){if(1&e){var n=FP();zC(),xP(0,"g",5),BP("click",function(){var e=hC(n).index;return GP(2).onClick(e)}),NP(1,"rect",6),OP(2,sle,1,4,"circle",7),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();ZP("id","click_",i,""),Wb(1),_P("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r!==o.EMPTY)}}function cle(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,ule,3,6,"g",4),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function lle(e,t){if(1&e&&(zC(),NP(0,"rect",9)),2&e){var n=GP();_P("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function fle(e,t){if(1&e&&(zC(),NP(0,"rect",10)),2&e){var n=t.$implicit,r=GP();qP("id","victory_coord_",n.x,"_",n.y,""),_P("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var hle=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).EMPTY=s9.NONE,r.victoryCoords=[],r.rules=new tle(Xce),r.availableMinimaxes=[new nle(r.rules,"P4Minimax")],r.encoder=Jce.encoder,r.tutorial=(new ole).tutorial,r.updateBoard(),r}return Py(n,[{key:"onClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Jce.of(e),n.next=6,t.chooseMove(i,t.getState());case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.getState(),t=this.rules.node.move;this.victoryCoords=tle.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.getState(),t=this.rules.node.move,n=tle.getLowestUnoccupiedSpace(e.board,t.get().x)+1;this.last=zB.of(new Rte(t.get().x,n))}},{key:"hideLastMove",value:function(){this.last=zB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(Bne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-p4"]],features:[cP],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,cle,2,1,"g",1),OP(2,lle,1,4,"rect",2),OP(3,fle,1,6,"rect",3),RP()),2&e&&(Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.last.isPresent()),Wb(1),AP("ngForOf",t.victoryCoords))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dle=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(by(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return vy(a)}return Py(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,zB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,zB.empty())}}]),n}(Yte);dle.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encodeMove",value:function(e){var t={coord:Rte.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=Rte.encoder.decode(t.coord),r=zB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return dle.withRotation(n.x,n.y,r.get(),i)}return dle.rotationless(n.x,n.y)}}]),n}(i9));var vle=function(){var e=Py(function e(){by(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(bu||(bu=ey(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(Eu||(Eu=ey(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),ple=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return Py(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(Ite.UP,1)),i=this.getPieceAt(t.getNext(Ite.UP_LEFT,1));return this.getPieceAt(t.getNext(Ite.RIGHT,1))===r&&this.getPieceAt(t.getNext(Ite.DOWN,1))===r&&this.getPieceAt(t.getNext(Ite.LEFT,1))===r&&this.getPieceAt(t.getNext(Ite.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Ite.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Ite.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Cy(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=Cy(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(h9.createTable(6,6,s9.NONE),0)}},{key:"getBlockCenter",value:function(e){return new Rte(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(qte);ple.ROTATION_MAP=[[new Rte(-1,-1),new Rte(1,-1)],[new Rte(0,-1),new Rte(1,0)],[new Rte(1,-1),new Rte(1,1)],[new Rte(1,0),new Rte(0,1)],[new Rte(1,1),new Rte(-1,1)],[new Rte(0,1),new Rte(-1,0)],[new Rte(-1,1),new Rte(-1,-1)],[new Rte(-1,0),new Rte(0,-1)]];var gle=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return HB.failure(vle.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return HB.failure(vle.CANNOT_ROTATE_NEUTRAL_BLOCK())}return HB.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Cy(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?ene.DRAW:ene.ZERO_WON:!0===r[1]?ene.ONE_WON:36===t.turn?ene.DRAW:ene.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n(ple))),n.singleton.get()}}]),n}(tne);gle.singleton=zB.empty(),gle.VICTORY_SOURCE=[[new Rte(1,0),new Ste(1,1),!1],[new Rte(0,1),new Ste(1,1),!1],[new Rte(4,0),new Ste(-1,1),!1],[new Rte(5,1),new Ste(-1,1),!1],[new Rte(1,1),new Ste(1,1),!0],[new Rte(4,1),new Ste(-1,1),!0],[new Rte(0,1),new Ste(0,1),!0],[new Rte(1,1),new Ste(0,1),!0],[new Rte(2,1),new Ste(0,1),!0],[new Rte(3,1),new Ste(0,1),!0],[new Rte(4,1),new Ste(0,1),!0],[new Rte(5,1),new Ste(0,1),!0],[new Rte(1,0),new Ste(1,0),!0],[new Rte(1,1),new Ste(1,0),!0],[new Rte(1,2),new Ste(1,0),!0],[new Rte(1,3),new Ste(1,0),!0],[new Rte(1,4),new Ste(1,0),!0],[new Rte(1,5),new Ste(1,0),!0]];var yle=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Cy(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=dle.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Cy(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(dle.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new Rte(r,n);e.getPieceAt(i)===s9.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new $te(gle.get().getGameStatus(e).toBoardValue())}}]),n}(Gte);yle.FIRST_TURN_MOVES=[dle.rotationless(0,0),dle.rotationless(1,0),dle.rotationless(2,0),dle.rotationless(0,1),dle.rotationless(1,1),dle.rotationless(0,2)];var mle=s9.NONE,kle=s9.ZERO,Cle=s9.ONE,wle=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Pu||(Pu=ey(["Initial board"]))),$localize(Su||(Su=ey(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),ple.getInitialState()),ane.informational($localize(Ou||(Ou=ey(["Goal of the game"]))),$localize(Tu||(Tu=ey(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new ple([[kle,mle,mle,kle,Cle,mle],[kle,Cle,mle,mle,mle,mle],[kle,mle,Cle,mle,mle,mle],[kle,mle,mle,mle,mle,Cle],[kle,mle,mle,mle,Cle,mle],[mle,mle,mle,mle,mle,mle]],10)).withPreviousMove(dle.withRotation(0,0,0,!1)),ane.fromPredicate($localize(Iu||(Iu=ey(["Simple move"]))),$localize(Au||(Au=ey(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new ple([[mle,mle,mle,mle,mle,mle],[mle,kle,mle,mle,Cle,mle],[mle,mle,mle,mle,mle,mle],[mle,mle,mle,mle,mle,mle],[mle,Cle,mle,mle,kle,mle],[mle,mle,mle,mle,mle,mle]],10),dle.rotationless(2,2),function(e,t,n){return e.blockTurned.isPresent()?ZB.failure($localize(Mu||(Mu=ey(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):ZB.SUCCESS},$localize(xu||(xu=ey(["Congratulations!"])))),ane.fromPredicate($localize(Ru||(Ru=ey(["Move with rotation"]))),$localize(Nu||(Nu=ey(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new ple([[mle,mle,mle,mle,mle,mle],[mle,kle,mle,mle,Cle,mle],[mle,mle,mle,mle,mle,mle],[mle,mle,mle,mle,mle,mle],[mle,Cle,mle,mle,kle,mle],[mle,mle,mle,mle,mle,mle]],10),dle.withRotation(0,0,0,!0),function(e,t,n){return e.blockTurned.isPresent()?ZB.SUCCESS:ZB.failure($localize(Du||(Du=ey(["You made a move without rotation, try again!"]))))},$localize(Lu||(Lu=ey(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function _le(e,t){if(1&e){var n=FP();zC(),DP(0),xP(1,"circle",9),BP("click",function(){var e=hC(n).$implicit,t=GP().$implicit,r=GP().index,i=GP().index;return GP().onClick(3*r+e,3*i+t)}),RP(),LP()}if(2&e){var r=t.$implicit,i=GP().$implicit,a=GP(),o=a.index,s=a.$implicit,u=GP(),c=u.index,l=u.$implicit,f=GP();Wb(1),qP("id","click_",3*o+r,"_",3*c+i,""),AP("ngClass",f.getSquareClasses(3*o+r,3*c+i)),_P("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var ble=function(){return[0,1,2]};function Ele(e,t){1&e&&(zC(),DP(0),OP(1,_le,2,6,"ng-container",3),LP()),2&e&&(Wb(1),AP("ngForOf",FT(1,ble)))}function Ple(e,t){if(1&e&&(zC(),DP(0),NP(1,"rect",8),OP(2,Ele,2,2,"ng-container",3),LP()),2&e){var n=t.$implicit,r=t.index,i=GP(),a=i.index,o=i.$implicit,s=GP();Wb(1),AP("ngClass",s.getBlockClasses(r,a)),_P("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),Wb(1),AP("ngForOf",FT(8,ble))}}var Sle=function(e){return[0,e]};function Ole(e,t){if(1&e&&(zC(),DP(0),OP(1,Ple,3,9,"ng-container",3),LP()),2&e){var n=GP();Wb(1),AP("ngForOf",UT(1,Sle,n.BLOCK_SEPARATION))}}function Tle(e,t){if(1&e&&(zC(),NP(0,"circle",10)),2&e){var n=GP();qP("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),AP("ngClass",n.getPlayerClass(n.getCurrentPlayer())),_P("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function Ile(e,t){if(1&e){var n=FP();zC(),xP(0,"path",11),BP("click",function(){var e=hC(n).$implicit;return GP().rotate(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),_P("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Ale(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=t.$implicit,r=GP();qP("id","victoryCoord_",n.x,"_",n.y,""),AP("ngClass",r.getSquareClasses(n.x,n.y)),_P("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Mle(e,t){if(1&e){var n=FP();zC(),xP(0,"g",13),BP("click",function(){return hC(n),GP().skipRotation()}),NP(1,"circle",14),NP(2,"line",15),RP()}if(2&e){var r=GP();Wb(1),_P("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),Wb(1),_P("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var xle=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new gle(ple),r.availableMinimaxes=[new yle(r.rules,"PentagoMinimax")],r.encoder=dle.encoder,r.tutorial=(new wle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new Rte(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new Rte(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?LB.getNonNullable(ple.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:LB.getNonNullable(ple.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Ste(i%2==0?1:4,i<2?1:4),1),this.lastDrop=zB.of(r)}else this.lastDrop=zB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=zB.empty(),this.movedBlock=zB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=zB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(Hte.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=dle.rotationless(e,t),o=n.getState(),4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=zB.of(new Rte(e,t)),n.displayArrows(s.neutralBlocks),ZB.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved-fill"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new Rte(e,t))&&n.push("last-move-stroke"),n}},{key:"rotate",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=dle.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.getState()));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=dle.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.getState()));case 5:case"end":return t.stop()}},t)}))()}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-pentago"]],features:[cP],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"defs"),xP(2,"marker",1),NP(3,"polygon",2),RP(),RP(),OP(4,Ole,2,3,"ng-container",3),OP(5,Tle,1,6,"circle",4),OP(6,Ile,1,4,"path",5),OP(7,Ale,1,7,"circle",6),OP(8,Mle,3,9,"g",7),RP()),2&e&&(Wb(4),AP("ngForOf",UT(5,Sle,t.BLOCK_SEPARATION)),Wb(1),AP("ngIf",t.currentDrop.isPresent()),Wb(1),AP("ngForOf",t.arrows),Wb(1),AP("ngForOf",t.victoryCoords),Wb(1),AP("ngIf",t.canSkipRotation))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Rle=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;if(by(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return vy(a)}return Py(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new Rte(this.x-1,this.y-1),r=new Rte(this.x,this.y-1),i=new Rte(this.x-1,this.y),a=new Rte(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new Rte(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?zB.empty():zB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?zB.empty():zB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(Rte),Nle=function(){var e=Py(function e(){by(this,e)});return e.MUST_CAPTURE_MAXIMUM_TWO_PIECES=function(){return $localize(Fu||(Fu=ey(["You must capture one or two pieces, not more."])))},e}(),Dle=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return Py(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=zB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=zB.empty(),n=zB.empty();if(e.length>0&&(t=zB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=zB.of(e[1]),e[1].isUpperThan(e[0])&&(t=zB.of(e[1]),n=zB.of(e[0])),e.length>2)throw new Error(Nle.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=zB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(jte);Dle.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Rle.encode(e.landingCoord),n=Rle.encodeOptional(e.startingCoord),r=Rle.encodeOptional(e.firstCapture);return 270400*Rle.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Rle.decode(e%64);e-=e%64;var n=Rle.decodeToOptional((e/=64)%65);e-=e%65;var r=Rle.decodeToOptional((e/=65)%65);e-=e%65;var i=Rle.decodeToOptional(e/=65);return new Dle(n,t,r,i)}}]),n}(a9));var Lle=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,r)).boards=e,i}return Py(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:s9.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:s9.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:s9.NONE}),t=n?this.turn+1:this.turn,this.setBoardAtCoords(r,t)}},{key:"setBoardAtCoords",value:function(e,t){var r,i=[h9.copyBiArray(this.boards[0]),h9.copyBiArray(this.boards[1]),h9.copyBiArray(this.boards[2]),h9.copyBiArray(this.boards[3])],a=Cy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=Cy(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===s9.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Cy(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[s9.NONE.value]=0,e[u9.ZERO.value]=0,e[u9.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Rle(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removePieceAt",value:function(e){return this.setBoardAtCoords([{coord:e,value:s9.NONE}],this.turn)}},{key:"dropCurrentPlayersPieceAt",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=Cy(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Cy(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new Rle(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([h9.createTable(4,4,s9.NONE),h9.createTable(3,3,s9.NONE),h9.createTable(2,2,s9.NONE),[[s9.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return LB.expectToBe(e,2),[0,1]}}}]),n}(Zte),Fle=function(){var e=Py(function e(){by(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Uu||(Uu=ey(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Vu||(Vu=ey(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(Bu||(Bu=ey(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(zu||(zu=ey(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Hu||(Hu=ey(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Gu||(Gu=ey(["Your second capture is invalid."])))},e}(),Ule=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return HB.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return HB.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:HB.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return HB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===s9.NONE)return HB.failure(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removePieceAt(e.startingCoord.get());return HB.success(a)}return HB.failure(Fle.CANNOT_MOVE_SUPPORTING_PIECE())}return HB.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?HB.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):HB.failure(Fle.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return HB.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return HB.failure(Fle.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?HB.success(void 0):HB.failure(Fle.INVALID_SECOND_CAPTURE())}return HB.failure(Fle.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Rle(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Cy(e.freeToMove);try{var i=function(){var r,i=t.value,a=Cy(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=Dle.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Cy(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Dle.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[Ate.UP,Ate.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[Ate.LEFT,Ate.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new x9,r=Cy(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new x9([i]));var a,o=Cy(e.removePieceAt(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new x9([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[u9.ZERO.value]?ene.ONE_WON:15===t[u9.ONE.value]?ene.ZERO_WON:ene.ONGOING}}]),n}(tne),Vle=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Ule.getGameStatus(e);if(t.isEndGame)return new $te(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new $te(n[u9.ZERO.value]-n[u9.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Ule.getStateInfo(n),a=Ule.getClimbingMoves(i),o=Ule.getDropMoves(i),s=Cy(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new x9;Ule.canCapture(c,u.landingCoord)?l=Ule.getPossibleCaptures(c):r.push(u);var f,h=Cy(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=Dle.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(Gte),Ble=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t=Vle.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(Vle),zle=s9.NONE,Hle=s9.ZERO,Gle=s9.ONE,$le=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize($u||($u=ey(["Goal of the game"]))),$localize(Zu||(Zu=ey(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),Lle.getInitialState()),ane.anyMove($localize(qu||(qu=ey(["Dropping a piece"]))),$localize(Wu||(Wu=ey(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),Lle.getInitialState(),Dle.fromDrop(new Rle(1,1,0),[]),$localize(ju||(ju=ey(["There you go, as simple as that."])))),ane.fromMove($localize(Yu||(Yu=ey(["Climbing"]))),$localize(Ku||(Ku=ey(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new Lle([[[Hle,Gle,zle,zle],[Gle,Hle,zle,zle],[zle,zle,zle,zle],[zle,zle,zle,Hle]],[[zle,zle,zle],[zle,zle,zle],[zle,zle,zle]],[[zle,zle],[zle,zle]],[[zle]]],0),[Dle.fromClimb(new Rle(3,3,0),new Rle(0,0,1),[])],$localize(Qu||(Qu=ey(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(Xu||(Xu=ey(["Failed!"])))),ane.fromMove($localize(Ju||(Ju=ey(["Square (1/2)"]))),$localize(ec||(ec=ey(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move."]))),new Lle([[[Hle,Hle,zle,zle],[zle,Hle,zle,zle],[zle,zle,zle,zle],[zle,zle,zle,zle]],[[zle,zle,zle],[zle,zle,zle],[zle,zle,zle]],[[zle,zle],[zle,zle]],[[zle]]],0),[Dle.fromDrop(new Rle(0,1,0),[new Rle(0,0,0)]),Dle.fromDrop(new Rle(0,1,0),[new Rle(0,1,0)]),Dle.fromDrop(new Rle(0,1,0),[new Rle(1,0,0)]),Dle.fromDrop(new Rle(0,1,0),[new Rle(1,1,0)])],$localize(tc||(tc=ey(["Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece."]))),$localize(nc||(nc=ey(["Failed!"])))),ane.fromPredicate($localize(rc||(rc=ey(["Square (2/2)"]))),$localize(ic||(ic=ey(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces before validating."]))),new Lle([[[Hle,Hle,zle,zle],[zle,Hle,zle,zle],[zle,zle,zle,zle],[zle,zle,zle,zle]],[[zle,zle,zle],[zle,zle,zle],[zle,zle,zle]],[[zle,zle],[zle,zle]],[[zle]]],0),Dle.fromDrop(new Rle(0,1,0),[new Rle(0,0,0),new Rle(1,0,0)]),function(e,t,n){return e.secondCapture.isPresent()?ZB.SUCCESS:e.firstCapture.isPresent()?ZB.failure($localize(ac||(ac=ey(["Failed, you only captured one piece."])))):ZB.failure(dce.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(oc||(oc=ey(["Congratulations, you have saved up two pieces."]))))]});function Zle(e,t){if(1&e&&(zC(),NP(0,"circle",8)),2&e){var n=t.$implicit,r=GP().$implicit,i=GP();qP("id","piece_",r.value,"_",n,""),AP("ngClass",i.getPlayerClass(r)),_P("cx",i.SPACE_SIZE/4+n/15*(i.BOARD_WIDTH-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(r))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function qle(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Zle,1,6,"circle",7),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",r.getPlayerSidePieces(n))}}function Wle(e,t){if(1&e){var n=FP();zC(),xP(0,"circle",12),BP("click",function(){hC(n);var e=GP(2).$implicit,t=GP().$implicit,r=GP().$implicit;return GP().onPieceClick(e,t,r)}),RP()}if(2&e){var r=GP(2).$implicit,i=GP().$implicit,a=GP().$implicit,o=GP();WP("id","piece_",r,"_",i,"_",a,""),AP("ngClass",o.getPieceClasses(r,i,a)),_P("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function jle(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",12),BP("click",function(){hC(n);var e=GP(2).$implicit,t=GP().$implicit,r=GP().$implicit;return GP().onDrop(e,t,r)}),RP()}if(2&e){var r=GP(2).$implicit,i=GP().$implicit,a=GP().$implicit,o=GP();WP("id","drop_",r,"_",i,"_",a,""),AP("ngClass",o.getSquareClasses(r,i,a)),_P("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Yle(e,t){if(1&e&&(zC(),DP(0),OP(1,Wle,1,7,"circle",10),OP(2,jle,1,8,"ng-template",null,11,uI),LP()),2&e){var n=TP(3),r=GP().$implicit,i=GP().$implicit,a=GP().$implicit,o=GP();Wb(1),AP("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Kle(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Yle,4,2,"ng-container",9),RP()),2&e){var n=t.$implicit,r=GP().$implicit,i=GP().$implicit,a=GP();Wb(1),AP("ngIf",a.mustDraw(n,r,i))}}function Qle(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Kle,2,1,"g",1),RP()),2&e){var n=GP().$implicit,r=GP();Wb(1),AP("ngForOf",r.getLevelRange(n))}}function Xle(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Qle,2,1,"g",1),RP()),2&e){var n=t.$implicit,r=GP();Wb(1),AP("ngForOf",r.getLevelRange(n))}}function Jle(e,t){if(1&e&&(zC(),NP(0,"rect",13)),2&e){var n=GP();WP("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),_P("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCxByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCyByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))}}function efe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",14),BP("click",function(){return hC(n),GP().validateCapture()}),NP(1,"circle",15),NP(2,"polygon",16),RP()}if(2&e){var r=GP();_P("transform","translate("+4*r.SPACE_SIZE+" "+4*r.SPACE_SIZE+")"),Wb(1),AP("ngClass",r.getCaptureValidationButtonClasses()),_P("cx",r.STROKE_WIDTH/2)("cy",r.STROKE_WIDTH/2)("r",r.SPACE_SIZE/2)}}function tfe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",17),BP("click",function(){var e=hC(n).$implicit;return GP().onPieceClick(e.x,e.y,e.z)}),NP(1,"line",18),NP(2,"line",18),RP()}if(2&e){var r=t.$implicit,i=GP();WP("id","capturable_",r.x,"_",r.y,"_",r.z,""),_P("transform","translate("+i.getPieceCxByCoord(r)+" "+i.getPieceCyByCoord(r)+")"),Wb(1),_P("x1",-.25*i.getPieceRadius(r.z))("y1",-.25*i.getPieceRadius(r.z))("x2",.25*i.getPieceRadius(r.z))("y2",.25*i.getPieceRadius(r.z)),Wb(1),_P("x1",.25*i.getPieceRadius(r.z))("y1",-.25*i.getPieceRadius(r.z))("x2",-.25*i.getPieceRadius(r.z))("y2",.25*i.getPieceRadius(r.z))}}var nfe=function(){return[0,1,2]},rfe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).BOARD_WIDTH=4*r.SPACE_SIZE+r.STROKE_WIDTH,r.PIECE_ROW_HEIGHT=r.SPACE_SIZE/2,r.BOARD_HEIGHT=r.BOARD_WIDTH+2*r.PIECE_ROW_HEIGHT,r.lastLandingCoord=zB.empty(),r.lastStartingCoord=zB.empty(),r.lastFirstCapture=zB.empty(),r.lastSecondCapture=zB.empty(),r.highCapture=zB.empty(),r.capturables=[],r.chosenStartingCoord=zB.empty(),r.chosenLandingCoord=zB.empty(),r.chosenFirstCapture=zB.empty(),r.chosenSecondCapture=zB.empty(),r.lastMove=zB.empty(),r.remainingPieces={0:15,1:15},r.hasAsymetricBoard=!0,r.rules=new Ule(Lle),r.availableMinimaxes=[new Vle(r.rules,"PylosMinimax"),new Ble(r.rules,"PylosOrderedMinimax")],r.encoder=Dle.encoder,r.tutorial=(new $le).tutorial,r.updateBoard(),r}return Py(n,[{key:"getPiecesCyForPlayer",value:function(e){return e===u9.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}},{key:"getLevelRange",value:function(e){return Lle.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new Rle(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Rle(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(Fle.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenStartingCoord.equalsValue(o)?(r.cancelMoveAttempt(),ZB.SUCCESS):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=zB.of(e),t.constructedState=t.constructedState.removePieceAt(e),ZB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.equalsValue(e)?(t.chosenFirstCapture=zB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),ZB.SUCCESS):t.chosenSecondCapture.equalsValue(e)?(t.chosenSecondCapture=zB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),ZB.SUCCESS):t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=zB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),ZB.SUCCESS):t.chosenSecondCapture.isAbsent()?(t.chosenSecondCapture=zB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),ZB.SUCCESS):t.cancelMove(Nle.MUST_CAPTURE_MAXIMUM_TWO_PIECES()));case 1:case"end":return n.stop()}},n)}))()}},{key:"updateCapturableList",value:function(){this.capturables=this.constructedState.getFreeToMoves()}},{key:"getCaptureValidationButtonClasses",value:function(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}},{key:"validateCapture",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#capture_validation"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?ZB.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()]));case 2:case"end":return t.stop()}},t)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?Dle.fromDrop(t.chosenLandingCoord.get(),e):Dle.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=zB.empty(),this.chosenLandingCoord=zB.empty(),this.chosenFirstCapture=zB.empty(),this.chosenSecondCapture=zB.empty(),this.capturables=[]}},{key:"onDrop",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Rle(e,t,n),i.abrupt("return",Ule.canCapture(r.constructedState,o)?(r.chosenLandingCoord=zB.of(o),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(o),r.updateCapturableList(),ZB.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=zB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Fle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Rle(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured-fill"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved-fill"]}else if(this.justClimbed(r))return["moved-fill"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return this.SPACE_SIZE*(.45+.025*e)}},{key:"getPieceCx",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+e*this.SPACE_SIZE}},{key:"getPieceCy",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+t*this.SPACE_SIZE}},{key:"getPieceCxByCoord",value:function(e){return this.getPieceCx(e.x,e.y,e.z)}},{key:"getPieceCyByCoord",value:function(e){return this.getPieceCy(e.x,e.y,e.z)}},{key:"isOccupied",value:function(e,t,n){var r=new Rle(e,t,n);if(this.justClimbed(r))return!1;var i=this.getState().getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Rle(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected-stroke"),this.isCaptured(r)&&i.push("pre-captured-fill"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e.value],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=zB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=zB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=zB.empty(),this.lastLandingCoord=zB.empty(),this.lastFirstCapture=zB.empty(),this.lastSecondCapture=zB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(Nte);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-pylos"]],features:[cP],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],[1,"base","captured","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"g"),OP(2,qle,2,1,"g",1),RP(),xP(3,"g",null,2),NP(5,"rect",3),OP(6,Xle,2,1,"g",1),OP(7,Jle,1,7,"rect",4),OP(8,efe,3,5,"g",5),OP(9,tfe,3,12,"g",6),RP(),RP()),2&e&&(_P("viewBox","0 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT),Wb(1),_P("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),Wb(1),AP("ngForOf",t.Player.PLAYERS),Wb(1),_P("transform","translate("+t.STROKE_WIDTH/2+" "+(t.STROKE_WIDTH/2+t.PIECE_ROW_HEIGHT)+")"),Wb(2),_P("width",4*t.SPACE_SIZE)("height",4*t.SPACE_SIZE),Wb(1),AP("ngForOf",FT(10,nfe)),Wb(1),AP("ngIf",t.highCapture.isPresent()),Wb(1),AP("ngIf",t.chosenLandingCoord.isPresent()),Wb(1),AP("ngForOf",t.capturables))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ife=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();ife.AAAA=new ife(0),ife.AAAB=new ife(1),ife.AABA=new ife(2),ife.AABB=new ife(3),ife.ABAA=new ife(4),ife.ABAB=new ife(5),ife.ABBA=new ife(6),ife.ABBB=new ife(7),ife.BAAA=new ife(8),ife.BAAB=new ife(9),ife.BABA=new ife(10),ife.BABB=new ife(11),ife.BBAA=new ife(12),ife.BBAB=new ife(13),ife.BBBA=new ife(14),ife.BBBB=new ife(15),ife.EMPTY=new ife(16),ife.pieces=[ife.AAAA,ife.AAAB,ife.AABA,ife.AABB,ife.ABAA,ife.ABAB,ife.ABBA,ife.ABBB,ife.BAAA,ife.BAAB,ife.BABA,ife.BABB,ife.BBAA,ife.BBAB,ife.BBBA,ife.BBBB];var afe=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).piece=i,a}return Py(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Yte);afe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new afe(e/=4,n,ife.fromInt(t))}}]),n}(a9));var ofe=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return Py(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Cy(ife.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(h9.createTable(4,4,ife.EMPTY),0,ife.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(qte),sfe=function(){var e=Py(function e(){by(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(sc||(sc=ey(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(uc||(uc=ey(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(cc||(cc=ey(["You cannot give the piece that was in your hands."])))},e}(),ufe=function(){function e(t){by(this,e),this.subCriterion=[zB.empty(),zB.empty(),zB.empty(),zB.empty()],this.subCriterion[0]=zB.of(8==(8&t.value)),this.subCriterion[1]=zB.of(4==(4&t.value)),this.subCriterion[2]=zB.of(2==(2&t.value)),this.subCriterion[3]=zB.of(1==(1&t.value))}return Py(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=zB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),cfe=function(){function e(t,n){by(this,e),this.initialCoord=t,this.direction=n}return Py(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),lfe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new ofe(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:Qte.DEFAULT,sensitiveSquares:new hre},a=Cy(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===Qte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Cy(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==ife.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?ZB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):a===ife.EMPTY?15===t.turn?ZB.SUCCESS:ZB.failure(sfe.MUST_GIVE_A_PIECE()):ofe.isAlreadyOnBoard(a,o)?ZB.failure(sfe.PIECE_ALREADY_ON_BOARD()):s===a?ZB.failure(sfe.CANNOT_GIVE_PIECE_IN_HAND()):ZB.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===Qte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Qte.VICTORY,sensitiveSquares:new hre}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new ufe(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:Qte.VICTORY,sensitiveSquares:new hre};a.get().matchPiece(t.pieceInHand)&&(r.score=Qte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=zB.empty(),a=zB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===ife.EMPTY){if(!i.isAbsent())return{sensitiveCoord:zB.of(o),commonCriterion:a,boardStatus:zB.of(r)};i=zB.of(o)}else a.isAbsent()?(a=zB.of(new ufe(u)),FB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),FB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:zB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=u9.of(t%2);return e===Qte.VICTORY?ene.getDefeat(n):16===t?ene.DRAW:ene.ONGOING}}]),n}(tne);lfe.VERBOSE=!1,lfe.lines=[new cfe(new Rte(0,0),Ite.DOWN),new cfe(new Rte(1,0),Ite.DOWN),new cfe(new Rte(2,0),Ite.DOWN),new cfe(new Rte(3,0),Ite.DOWN),new cfe(new Rte(0,0),Ite.RIGHT),new cfe(new Rte(0,1),Ite.RIGHT),new cfe(new Rte(0,2),Ite.RIGHT),new cfe(new Rte(0,3),Ite.RIGHT),new cfe(new Rte(0,0),Ite.DOWN_RIGHT),new cfe(new Rte(0,3),Ite.UP_RIGHT)];var ffe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===ife.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new afe(s,o,ife.EMPTY);return t.push(u),t}var c,l=Cy(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new afe(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:Qte.DEFAULT,sensitiveSquares:new hre},a=Cy(lfe.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=lfe.updateBoardStatus(o,r,i)).score===Qte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===Qte.DEFAULT)return new $te(0);var n=u9.of(t%2);return new $te(e===Qte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(Gte),hfe=ife.AABA,dfe=ife.AABB,vfe=ife.ABAA,pfe=ife.ABAB,gfe=ife.ABBA,yfe=ife.BAAA,mfe=ife.BAAB,kfe=ife.BABB,Cfe=ife.BBAA,wfe=ife.BBAB,_fe=ife.BBBA,bfe=ife.BBBB,Efe=ife.EMPTY,Pfe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(lc||(lc=ey(["Goal of the game"]))),$localize(fc||(fc=ey(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new ofe([[_fe,Cfe,vfe,hfe],[Efe,Efe,Efe,Efe],[Efe,Efe,Efe,Efe],[Efe,Efe,Efe,Efe]],7,ife.ABAB)),ane.anyMove($localize(hc||(hc=ey(["Placement"]))),$localize(dc||(dc=ey(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new ofe([[_fe,dfe,gfe,Efe],[Efe,Efe,Efe,Efe],[Efe,yfe,Efe,Efe],[Efe,Efe,Efe,Efe]],7,ife.ABAA),new afe(2,2,ife.BAAB),$localize(vc||(vc=ey(["Perfect!"])))),ane.fromMove($localize(pc||(pc=ey(["Situation"]))),$localize(gc||(gc=ey(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new ofe([[bfe,_fe,wfe,Efe],[vfe,kfe,Cfe,Efe],[pfe,yfe,mfe,Efe],[Efe,Efe,Efe,Efe]],7,ife.AABA),[new afe(3,3,ife.AABB)],$localize(yc||(yc=ey(["Well done!"]))),$localize(mc||(mc=ey(["Failed!"]))))]});function Sfe(e,t){if(1&e&&(zC(),NP(0,"rect",12)),2&e){var n=GP(2),r=n.$implicit,i=n.index,a=GP().index,o=GP();AP("ngClass",o.getPieceClasses(r.value)),_P("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function Ofe(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=GP(2),r=n.$implicit,i=n.index,a=GP().index,o=GP();AP("ngClass",o.getPieceClasses(r.value)),_P("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function Tfe(e,t){if(1&e&&(zC(),NP(0,"circle")),2&e){var n=GP(2).index,r=GP().index,i=GP();_P("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Ife(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Sfe,1,5,"rect",10),OP(2,Ofe,1,4,"ng-template",null,11,uI),OP(4,Tfe,1,3,"circle",7),RP()),2&e){var n=TP(3),r=GP().$implicit,i=GP(2);Wb(1),AP("ngIf",r.isRectangle())("ngIfElse",n),Wb(3),AP("ngIf",i.pieceHasDot(r.value))}}function Afe(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",9),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().chooseCoord(e,t)}),RP(),OP(2,Ife,5,3,"g",7),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","chooseCoord_",i,"_",a,""),AP("ngClass",o.getSquareClasses(i,a)),_P("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r!==o.EMPTY)}}function Mfe(e,t){if(1&e&&(zC(),xP(0,"g",null,8),OP(2,Afe,3,8,"g",2),RP()),2&e){var n=t.$implicit;Wb(2),AP("ngForOf",n)}}function xfe(e,t){if(1&e&&(zC(),NP(0,"rect",17)),2&e){var n=GP(2);AP("ngClass",n.getPieceClasses(n.pieceInHand.value)),_P("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Rfe(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=GP(2);AP("ngClass",n.getPieceClasses(n.pieceInHand.value)),_P("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Nfe(e,t){if(1&e&&(zC(),NP(0,"circle")),2&e){var n=GP(2);_P("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function Dfe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",13,14),BP("click",function(){return hC(n),GP().deselectDroppedPiece()}),NP(2,"rect",15),OP(3,xfe,1,5,"rect",16),OP(4,Rfe,1,4,"ng-template",null,11,uI),OP(6,Nfe,1,3,"circle",7),RP()}if(2&e){var r=TP(5),i=GP();qP("id","droppedPiece_",i.chosen.get().x,"_",i.chosen.get().y,""),_P("transform","translate("+i.chosen.get().x*i.SPACE_SIZE+" "+i.chosen.get().y*i.SPACE_SIZE+")"),Wb(2),_P("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Wb(1),AP("ngIf",i.pieceInHand.isRectangle())("ngIfElse",r),Wb(3),AP("ngIf",i.pieceHasDot(i.pieceInHand.value))}}function Lfe(e,t){if(1&e&&(zC(),xP(0,"g",null,18),NP(2,"rect",19),RP()),2&e){var n=t.$implicit,r=GP();Wb(2),_P("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Ffe(e,t){if(1&e&&(zC(),NP(0,"rect",12)),2&e){var n=GP(2);AP("ngClass",n.getPieceClasses(n.pieceInHand.value)),_P("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Ufe(e,t){if(1&e&&(zC(),NP(0,"circle",21)),2&e){var n=GP(2);AP("ngClass",n.getPieceClasses(n.pieceInHand.value)),_P("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Vfe(e,t){1&e&&(zC(),NP(0,"circle",22)),2&e&&_P("cy",.75*GP(2).SPACE_SIZE)("r",10)}function Bfe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Ffe,1,6,"rect",10),OP(2,Ufe,1,3,"ng-template",null,11,uI),OP(4,Vfe,1,2,"circle",20),RP()),2&e){var n=TP(3),r=GP();Wb(1),AP("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Wb(3),AP("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function zfe(e,t){if(1&e&&(zC(),NP(0,"rect",27)),2&e){var n=GP(2).index,r=GP().index,i=GP();ZP("id","chosenPiece_",4*r+n,""),_P("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Hfe(e,t){if(1&e&&(zC(),NP(0,"rect",12)),2&e){var n=GP(2).index,r=GP().index,i=GP();AP("ngClass",i.getPieceClasses(4*r+n)),_P("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Gfe(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=GP(2).index,r=GP().index,i=GP();AP("ngClass",i.getPieceClasses(4*r+n)),_P("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function $fe(e,t){if(1&e&&(zC(),NP(0,"circle")),2&e){var n=GP(2).index,r=GP().index,i=GP();_P("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Zfe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",13),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().choosePiece(4*t+e)}),OP(1,zfe,1,5,"rect",26),OP(2,Hfe,1,5,"rect",10),OP(3,Gfe,1,4,"ng-template",null,11,uI),OP(5,$fe,1,3,"circle",7),RP()}if(2&e){var r=TP(4),i=GP().index,a=GP().index,o=GP();ZP("id","choosePiece_",4*a+i,""),Wb(1),AP("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.fromInt(4*a+i))),Wb(1),AP("ngIf",(4*a+i)%4<2)("ngIfElse",r),Wb(3),AP("ngIf",o.pieceHasDot(4*a+i))}}function qfe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Zfe,6,5,"g",3),RP()),2&e){var n=t.index,r=GP().index,i=GP();Wb(1),AP("ngIf",i.isRemaining(4*r+n))}}function Wfe(e,t){if(1&e&&(zC(),xP(0,"g",null,23),NP(2,"rect",24,25),OP(4,qfe,2,1,"g",2),RP()),2&e){var n=t.$implicit,r=GP();_P("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),Wb(2),_P("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),Wb(2),AP("ngForOf",n)}}var jfe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).EMPTY=ife.EMPTY,r.QuartoPiece=ife,r.chosen=zB.empty(),r.lastMove=zB.empty(),r.pieceInHand=ife.EMPTY,r.pieceToGive=zB.empty(),r.victoriousCoords=[],r.rules=new lfe(ofe),r.availableMinimaxes=[new ffe(r.rules,"QuartoMinimax")],r.encoder=afe.encoder,r.tutorial=(new Pfe).tutorial,r.pieceInHand=r.getState().pieceInHand,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){var e=this.getState(),t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=zB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==ife.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.getState().turn){r.next=7;break}return a=new afe(e,t,ife.EMPTY),r.abrupt("return",n.chooseMove(a,n.getState()));case 7:if(!n.pieceToGive.isAbsent()){r.next=9;break}return r.abrupt("return",ZB.SUCCESS);case 9:return o=new afe(e,t,n.pieceToGive.get()),r.abrupt("return",n.chooseMove(o,n.getState()));case 11:return r.abrupt("return",n.cancelMove(Hte.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),!t.pieceToGive.equalsValue(ife.fromInt(e))){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),ZB.SUCCESS));case 5:if(t.pieceToGive=zB.of(ife.fromInt(e)),!t.chosen.isAbsent()){n.next=7;break}return n.abrupt("return",ZB.SUCCESS);case 7:return i=t.chosen.get(),a=new afe(i.x,i.y,t.pieceToGive.get()),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 9:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=zB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=zB.empty(),this.chosen=zB.empty()}},{key:"deselectDroppedPiece",value:function(){var e=this.chosen.getOrElse(new Rte(404,404)),t=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return t.isFailure()?this.cancelMove(t.getReason()):(this.cancelMoveAttempt(),ZB.SUCCESS)}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=zB.of(new Rte(e,t))}},{key:"isRemaining",value:function(e){return ofe.isGivable(ife.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new Rte(e,t);return this.lastMove.equalsValue(n)?["moved-fill"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0-fill":"player1-fill"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==ife.EMPTY.value&&e%8<4}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-quarto"]],features:[cP],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"g",1),OP(2,Mfe,3,1,"g",2),OP(3,Dfe,7,8,"g",3),OP(4,Lfe,3,3,"g",2),xP(5,"g",null,4),NP(7,"rect",5,6),OP(9,Bfe,5,3,"g",7),RP(),OP(10,Wfe,5,6,"g",2),RP(),RP()),2&e&&(_P("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Wb(2),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.chosen.isPresent()),Wb(1),AP("ngForOf",t.victoriousCoords),Wb(1),_P("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Wb(2),_P("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Wb(2),AP("ngIf",t.chosen.isAbsent()),Wb(1),AP("ngForOf",t.board))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yfe=function(){var e=Py(function e(){by(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(kc||(kc=ey(["You must pick a space from the edge of the board."])))},e}(),Kfe=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;by(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===Ate.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===Ate.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===Ate.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===Ate.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return Py(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?ZB.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?ZB.failure(Yfe.NO_INSIDE_CLICK()):ZB.SUCCESS}}]),n}(Yte);Kfe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=Ate.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Kfe(e/=5,n,t)}}]),n}(a9));var Qfe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(h9.createTable(5,5,s9.NONE),0)}}]),n}(qte),Xfe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?HB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[u9.ZERO.value]),a=n.getFullestLine(r[u9.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===u9.ZERO||a<5)?ene.ZERO_WON:5===a?ene.ONE_WON:ene.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new Rte(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new Rte(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new Rte(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new Rte(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(Ate.LEFT),0!==e.y&&t.push(Ate.UP),4!==e.x&&t.push(Ate.RIGHT),4!==e.y&&t.push(Ate.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[u9.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[u9.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new Rte(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new Rte(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new Rte(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new Rte(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,my(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(tne),Jfe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Xfe.getVerticalCoords(e),i=Cy(Xfe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Cy(Xfe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Kfe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Xfe.getLinesSums(t),r=Xfe.getFullestLine(n[u9.ZERO.value]),i=Xfe.getFullestLine(n[u9.ONE.value]),a=t.getCurrentPlayer();return new $te(5===r&&(a===u9.ZERO||i<5)?u9.ZERO.getVictoryValue():5===i?u9.ONE.getVictoryValue():i-r)}}]),n}(Gte),ehe=s9.NONE,the=s9.ZERO,nhe=s9.ONE,rhe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Cc||(Cc=ey(["Goal of the game."]))),$localize(wc||(wc=ey(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),Qfe.getInitialState()),ane.fromMove($localize(_c||(_c=ey(["What a move looks like (without animation)"]))),$localize(bc||(bc=ey(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new Qfe([[ehe,ehe,ehe,ehe,ehe],[ehe,ehe,ehe,ehe,ehe],[ehe,ehe,ehe,ehe,ehe],[ehe,ehe,ehe,ehe,ehe],[the,the,the,the,ehe]],1),[new Kfe(4,4,Ate.LEFT)],$localize(Ec||(Ec=ey(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(Pc||(Pc=ey(["Failed!"])))),ane.fromMove($localize(Sc||(Sc=ey(["Victory"]))),$localize(Oc||(Oc=ey(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new Qfe([[ehe,nhe,ehe,nhe,nhe],[ehe,the,the,ehe,the],[nhe,nhe,nhe,the,nhe],[the,ehe,the,nhe,nhe],[nhe,the,ehe,nhe,the]],31),[new Kfe(3,0,Ate.DOWN)],$localize(Tc||(Tc=ey(["Congratulations, you won!"]))),$localize(Ic||(Ic=ey(["Failed!"]))))]});function ihe(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"circle",4),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onBoardClick(e,t)}),RP(),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();Wb(1),qP("id","click_",r,"_",i,""),AP("ngClass",a.getPieceClasses(r,i)),_P("r",.45*a.SPACE_SIZE)("cx",(r+.5)*a.SPACE_SIZE)("cy",(i+.5)*a.SPACE_SIZE)}}function ahe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,ihe,2,6,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function ohe(e,t){if(1&e){var n=FP();zC(),xP(0,"use",6),BP("click",function(){var e=hC(n).$implicit;return GP(2).chooseDirection(e)}),RP()}if(2&e){var r=t.$implicit,i=GP(2);ZP("id","chooseDirection_",r,""),_P("transform",i.getArrowTransform(r))}}function she(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,ohe,1,2,"use",5),RP()),2&e){var n=GP();Wb(1),AP("ngForOf",n.getPossiblesDirections())}}var uhe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).lastMoveCoord=zB.empty(),r.chosenCoord=zB.empty(),r.victoriousCoords=[],r.rules=new Xfe(Qfe),r.availableMinimaxes=[new Jfe(r.rules,"QuixoMinimax")],r.encoder=Kfe.encoder,r.tutorial=(new rhe).tutorial,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Xfe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=zB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new Rte(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected-stroke"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move-stroke"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new Rte(e,t),i=Kfe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(r)?this.cancelMoveAttempt():this.chosenCoord=zB.of(r),ZB.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push(Ate.RIGHT),0!==t.x&&e.push(Ate.LEFT),4!==t.y&&e.push(Ate.DOWN),0!==t.y&&e.push(Ate.UP),e}},{key:"chooseDirection",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e.toString())).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=e,n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Kfe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.getState())));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e){return function(){function e(){by(this,e)}return Py(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case Ate.UP:r=1,i=0,a=-90;break;case Ate.DOWN:r=1,i=2,a=90;break;case Ate.LEFT:r=0,i=1,a=180;break;default:LB.expectToBe(n,Ate.RIGHT),r=2,i=1,a=0}return["scale("+e/300+")","translate(".concat(100*r," ").concat(100*i,")"),"rotate("+a+" 50 50)"].join(" ")}}]),e}().getArrowTransform(5*this.SPACE_SIZE,new Rte(0,0),e)}}]),n}(Bne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-quixo"]],features:[cP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"defs"),NP(2,"polygon",1),RP(),OP(3,ahe,2,1,"g",2),OP(4,she,2,1,"g",3),RP()),2&e&&(_P("viewBox","0 0 "+5*t.SPACE_SIZE+" "+5*t.SPACE_SIZE),Wb(3),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.chosenCoord.isPresent()))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),che=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=h9.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,s9.NONE);return e[3][3]=u9.ZERO,e[4][4]=u9.ZERO,e[3][4]=u9.ONE,e[4][3]=u9.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new Rte(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(qte);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),lhe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Yte);lhe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return(che.BOARD_HEIGHT-1)*che.BOARD_WIDTH+(che.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*che.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%che.BOARD_WIDTH;return new lhe(t,(e-t)/che.BOARD_WIDTH)}}]),n}(a9)),lhe.PASS=new lhe(-1,-1),lhe.PASS_NUMBER=lhe.encoder.encodeNumber(lhe.PASS);var fhe=function(){var e=Py(function e(){by(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(Ac||(Ac=ey(["Your move should switch at least one piece."])))},e}(),hhe=Py(function e(t,n){by(this,e),this.move=t,this.switched=n}),dhe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(lhe.PASS))return new che(a,r+1);var o,s=Cy(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new che(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(lhe.PASS))return n.playerCanOnlyPass(t)?HB.success([]):HB.failure(Hte.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return FB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),HB.failure(Hte.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return FB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?HB.failure(fhe.NO_ELEMENT_SWITCHED()):HB.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return ene.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?ene.ZERO_WON:i>0?ene.ONE_WON:ene.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Cy(Ite.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(che.BOARD_WIDTH,che.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=Cy(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(che.BOARD_WIDTH,che.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===s9.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(lhe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new che(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===s9.NONE&&(t=e.getCopiedBoard(),che.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new lhe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=Cy(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;$7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new hhe(u,c.length))}}return 0===r.length&&r.push(new hhe(lhe.PASS,0)),r}}]),n}(tne);return e.VERBOSE=!1,e}(),vhe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=dhe.getGameStatus(e);if(t.isEndGame)return $te.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<che.BOARD_HEIGHT;a++)for(var o=0;o<che.BOARD_WIDTH;o++){var s=(0===o||o===che.BOARD_WIDTH-1?4:1)*(0===a||a===che.BOARD_HEIGHT-1?4:1);n[a][o]===u9.ZERO&&(r+=s),n[a][o]===u9.ONE&&(i+=s)}return r*=u9.ZERO.getScoreModifier(),i*=u9.ONE.getScoreModifier(),new $te(i+r)}},{key:"getListMoves",value:function(e){var t=dhe.getListMoves(e.gameState);return h9.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(Gte);vhe.bestCoords=[new Rte(0,0),new Rte(0,che.BOARD_HEIGHT-1),new Rte(che.BOARD_WIDTH-1,0),new Rte(che.BOARD_WIDTH-1,che.BOARD_HEIGHT-1)];var phe=s9.NONE,ghe=s9.ZERO,yhe=s9.ONE,mhe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Mc||(Mc=ey(["Goal of the game"]))),$localize(xc||(xc=ey(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new che([[ghe,ghe,ghe,ghe,ghe,ghe,ghe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,ghe,ghe,ghe,ghe,ghe,ghe,ghe]],60)),ane.anyMove($localize(Rc||(Rc=ey(["Capture (1/2)"]))),$localize(Nc||(Nc=ey(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),che.getInitialState(),new lhe(2,4),$localize(Dc||(Dc=ey(["Congratulations!"])))),ane.fromMove($localize(Lc||(Lc=ey(["Capture (2/2)"]))),$localize(Fc||(Fc=ey(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new che([[phe,phe,phe,phe,phe,phe,phe,phe],[phe,phe,phe,phe,phe,phe,phe,phe],[phe,phe,phe,phe,phe,phe,phe,phe],[phe,phe,phe,phe,yhe,phe,phe,phe],[phe,phe,phe,ghe,phe,phe,phe,phe],[phe,phe,ghe,phe,phe,phe,phe,phe],[ghe,ghe,phe,phe,phe,phe,phe,phe],[phe,ghe,yhe,ghe,yhe,ghe,phe,phe]],1),[new lhe(0,7)],$localize(Uc||(Uc=ey(["Congratulations!"]))),$localize(Vc||(Vc=ey(["Lower and more to the left, please."])))),ane.informational($localize(Bc||(Bc=ey(["Passing a turn"]))),$localize(zc||(zc=ey(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new che([[yhe,ghe,ghe,ghe,ghe,ghe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[ghe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[yhe,yhe,yhe,yhe,yhe,yhe,phe,phe],[ghe,ghe,ghe,ghe,ghe,ghe,phe,phe]],60))]});function khe(e,t){if(1&e&&(zC(),NP(0,"circle",4)),2&e){var n=GP().index,r=GP().index,i=GP();AP("ngClass",i.getPieceClass(n,r)),_P("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function Che(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",2),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),RP(),OP(2,khe,1,4,"circle",3),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();Wb(1),qP("id","click_",r,"_",i,""),AP("ngClass",a.getRectClasses(r,i)),_P("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngIf",a.board[i][r]!==a.EMPTY)}}function whe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Che,3,8,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}var _he=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).EMPTY=s9.NONE,r.lastMove=new Rte(-2,-2),r.captureds=[],r.scores=zB.of([2,2]),r.rules=new dhe(che),r.availableMinimaxes=[new vhe(r.rules,"ReversiMinimax")],r.encoder=lhe.encoder,r.tutorial=(new mhe).tutorial,r.canPass=!1,r.updateBoard(),r}return Py(n,[{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new lhe(e,t),r.next=6,n.chooseMove(a,n.getState(),n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new Rte(-2,-2),this.scores=zB.of(e.countScore()),this.canPass=dhe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.getState().getCurrentPlayer(),n=this.getState().getCurrentOpponent(),r=Cy(Ite.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(che.BOARD_WIDTH,che.BOARD_HEIGHT)&&this.getState().getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new Rte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured-fill"]:n.equals(this.lastMove)?["moved-fill"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",($7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(lhe.PASS.coord.x,lhe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Bne);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-reversi"]],features:[cP],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,whe,2,1,"g",1),RP()),2&e&&(_P("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Wb(1),AP("ngForOf",t.board))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),bhe=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,null,[{key:"getInitialState",value:function(){var e=Lte.UNREACHABLE,t=Lte.ZERO,r=Lte.ONE,i=Lte.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(Ure);return e.HEIGHT=6,e.WIDTH=11,e}(),Ehe=function(){var e=Py(function e(){by(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Hc||(Hc=ey(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Gc||(Gc=ey(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize($c||($c=ey(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Zc||(Zc=ey(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(qc||(qc=ey(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Wc||(Wc=ey(["Those two spaces have no intermediary neighbor."])))},e}(),Phe=function(e){fy(n,e);var t=dy(n);function n(e,r){return by(this,n),t.call(this,e,r)}return Py(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return ZB.failure(Hte.MOVE_CANNOT_BE_STATIC());if(1===n){var r=Fre.getFakeNeighbors(e);if(t.equals(r))return ZB.failure(Ehe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return ZB.failure($localize(jc||(jc=ey(["You can move one or two spaces, not ","."])),n));if(Fre.isSpaceDark(e))return ZB.failure(Ehe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return ZB.failure(Ehe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return ZB.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(bhe.WIDTH,bhe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(bhe.WIDTH,bhe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():HB.success(new n(e,t))}}]),n}(Qne);Phe.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"maxValue",value:function(){return 396*bhe.WIDTH+66*bhe.HEIGHT+6*bhe.WIDTH+bhe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,Phe.from(new Rte(e/=6,r),new Rte(n,t)).get()}}]),n}(a9));var She=function(){var e=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,r){FB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=Lte.EMPTY,new bhe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return HB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==Lte.EMPTY)return HB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE());var n=Fre.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===Lte.EMPTY?HB.success(void 0):HB.failure(Ehe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):HB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,u9.ZERO),i=n.getBoardValuesFor(t,u9.ONE);return n.getGameStatusFromFreedoms(r,i)}},{key:"getLandingCoords",value:function(e,t){var n=function(t){return t.isInRange(bhe.WIDTH,bhe.HEIGHT)&&e[t.y][t.x]===Lte.EMPTY},r=new x9(Fre.getNeighbors(t).filter(n));if(!0===Fre.isSpaceDark(t))return r.toList();var i,a=new x9(r.toList()),o=Cy(r);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Cy(Fre.getNeighbors(u).filter(n));try{for(c.s();!(s=c.n()).done;){var l=s.value;a.add(l)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a.toList()}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<bhe.HEIGHT;r++)for(var i=0;i<bhe.WIDTH;i++)e[r][i].is(t)&&n.push(new Rte(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Cy(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=Ure.getEmptyNeighbors(e,o,Lte.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?ene.ONE_WON:0===t[0]?ene.ZERO_WON:ene.ONGOING}}]),n}(tne);return e.VERBOSE=!1,e}(),Ohe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Cy(She.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Cy(Ure.getEmptyNeighbors(r,s,Lte.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Phe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=Lte.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=Cy(Ure.getEmptyNeighbors(r,c,Lte.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=Phe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=Lte.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=Lte.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=Lte.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=She.getBoardValuesFor(t,u9.ZERO),r=She.getBoardValuesFor(t,u9.ONE),i=She.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return $te.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new $te(r[a%6]-n[a%6])}}]),n}(Gte),The=Lte.UNREACHABLE,Ihe=Lte.ZERO,Ahe=Lte.ONE,Mhe=Lte.EMPTY,xhe=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Yc||(Yc=ey(["Initial board"]))),$localize(Kc||(Kc=ey(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),bhe.getInitialState()),ane.informational($localize(Qc||(Qc=ey(["Goal of the game"]))),$localize(Xc||(Xc=ey(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new bhe([[The,The,Mhe,Mhe,Ahe,Mhe,Mhe,Ihe,Ahe,The,The],[The,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,The],[Ahe,Ihe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Ihe],[Ihe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Ahe],[The,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,Mhe,The],[The,The,Ahe,Ihe,Mhe,Mhe,Mhe,Ahe,Ihe,The,The]],3)),ane.fromPredicate($localize(Jc||(Jc=ey(["Simple step"]))),$localize(el||(el=ey(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),bhe.getInitialState(),Phe.from(new Rte(2,0),new Rte(2,1)).get(),function(e,t,n){return e.isSimpleStep()?ZB.SUCCESS:ZB.failure($localize(tl||(tl=ey(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(nl||(nl=ey(["Congratulations!"])))),ane.fromPredicate($localize(rl||(rl=ey(["Double step"]))),$localize(il||(il=ey(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),bhe.getInitialState(),Phe.from(new Rte(7,0),new Rte(5,0)).get(),function(e,t,n){return e.isSimpleStep()?ZB.failure($localize(al||(al=ey(["Failed! You have made a single step."])))):ZB.SUCCESS},$localize(ol||(ol=ey(["Congratulations!"]))))]});function Rhe(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"polygon",7),RP()),2&e){var n=GP().index,r=GP().index,i=GP();Wb(1),AP("ngClass",i.getPlayerClassFor(n,r)),_P("points",i.getPyramidCoordinate(n,r))}}function Nhe(e,t){if(1&e&&(zC(),NP(0,"polygon",10)),2&e){var n=GP(2).index,r=GP().index;_P("points",GP().getTriangleCoordinate(n,r))}}function Dhe(e,t){if(1&e&&(zC(),NP(0,"polygon",11)),2&e){var n=GP(2).index,r=GP().index;_P("points",GP().getTriangleCoordinate(n,r))}}function Lhe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Nhe,1,1,"polygon",8),OP(2,Dhe,1,1,"polygon",9),RP()),2&e){var n=GP().index,r=GP().index;Wb(1),AP("ngIf",(n+r)%2==1),Wb(1),AP("ngIf",(n+r)%2==0)}}function Fhe(e,t){if(1&e){var n=FP();zC(),xP(0,"g",5),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),OP(1,Rhe,2,2,"g",6),OP(2,Lhe,3,2,"g",6),RP()}if(2&e){var r=t.$implicit;qP("id","click_",t.index,"_",GP().index,""),Wb(1),AP("ngIf",r.isPlayer()),Wb(1),AP("ngIf",2===r.value)}}function Uhe(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Fhe,3,4,"g",4),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Vhe(e,t){if(1&e&&(zC(),NP(0,"polygon",14)),2&e){var n=t.$implicit,r=GP(2);qP("id","possible_landing_",n.x,"_",n.y,""),_P("points",r.getTriangleCoordinate(n.x,n.y))}}function Bhe(e,t){if(1&e&&(zC(),NP(0,"polygon",14)),2&e){var n=GP(2);qP("id","chosen_coord_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),_P("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function zhe(e,t){if(1&e&&(zC(),DP(0),OP(1,Vhe,1,3,"polygon",12),OP(2,Bhe,1,3,"polygon",13),LP()),2&e){var n=GP();Wb(1),AP("ngForOf",n.possibleLandings),Wb(1),AP("ngIf",n.chosenCoord.isPresent())}}function Hhe(e,t){if(1&e&&(zC(),DP(0),NP(1,"polygon",15),NP(2,"polygon",15),LP()),2&e){var n=GP(2);Wb(1),_P("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),Wb(1),_P("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Ghe(e,t){1&e&&(zC(),OP(0,Hhe,3,2,"ng-container",6)),2&e&&AP("ngIf",GP().lastMoved.isPresent())}var $he=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).lastCoord=zB.empty(),r.lastMoved=zB.empty(),r.chosenCoord=zB.empty(),r.possibleLandings=[],r.rules=new She(bhe),r.availableMinimaxes=[new Ohe(r.rules,"SaharaMinimax")],r.encoder=Phe.encoder,r.tutorial=(new xhe).tutorial,r.updateBoard(),r}return Py(n,[{key:"cancelMoveAttempt",value:function(){this.possibleLandings=[],this.chosenCoord=zB.empty()}},{key:"onClick",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.getState().getCurrentPlayer(),o=Lte.ofPlayer(a),r.abrupt("return",n.chosenCoord.equalsValue(new Rte(e,t))?(n.cancelMoveAttempt(),ZB.SUCCESS):n.chosenCoord.isAbsent()||n.board[t][e]===o?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){if(this.board[t][e]===Lte.EMPTY)return this.cancelMove(Ehe.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(u9.fromTurn(this.getTurn()))){var n=new Rte(e,t);return this.selectPiece(n),ZB.SUCCESS}return this.cancelMove(Ehe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"selectPiece",value:function(e){this.chosenCoord=zB.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Rte(e,t),!(a=Phe.from(n.chosenCoord.get(),i)).isFailure()){r.next=5;break}r.t0=n.cancelMove(a.getReason()),r.next=8;break;case 5:return r.next=7,n.chooseMove(a.get(),n.getState());case 7:r.t0=r.sent;case 8:return r.abrupt("return",r.t0);case 9:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.getState().board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(u9.of(this.board[t][e].value))}}]),n}(Rre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-sahara"]],features:[cP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(zC(),xP(0,"svg",0),OP(1,Uhe,2,1,"g",1),OP(2,zhe,3,2,"ng-container",2),OP(3,Ghe,1,1,"ng-template",null,3,uI),RP()),2&e){var n=TP(4);Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngIf",t.chosenCoord.isPresent())("ngIfElse",n)}},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zhe=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.direction=i,o.landingOrientation=a,o}return Py(n,[{key:"isRotation",value:function(){return this.direction.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.direction.equals(e.direction))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}],[{key:"of",value:function(e,t,r,i){var a=new n(e,t,r,i),o=a.coord.isNotInRange(5,5);if(a.isRotation()){if(o)return HB.failure("Cannot rotate piece outside the board: "+a.toString())}else if(a.coord.getNext(a.direction.get()).isNotInRange(5,5)){if(o)return HB.failure("SiamMove should end or start on the board: "+a.toString());if(a.direction.get()!==a.landingOrientation)return HB.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+a.toString())}return HB.success(a)}}]),n}(Yte);Zhe.encoder=a9.tuple([a9.numberEncoder(6),a9.numberEncoder(6),function(e){return new(function(t){fy(r,t);var n=dy(r);function r(){return by(this,r),n.apply(this,arguments)}return Py(r,[{key:"maxValue",value:function(){return e.maxValue()+1}},{key:"encodeNumber",value:function(t){return t.isPresent()?e.encodeNumber(t.get()):e.maxValue()+1}},{key:"decodeNumber",value:function(t){return t===this.maxValue()?zB.empty():zB.of(e.decodeNumber(t))}}]),r}(a9))}(new Mte),new Mte],function(e){return[e.x+1,e.y+1,e.direction,e.landingOrientation]},function(e){return Zhe.of(e[0]-1,e[1]-1,e[2],e[3]).get()});var qhe=function(){function e(t){by(this,e),this.value=t}return Py(e,[{key:"belongTo",value:function(e){return e===u9.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?u9.ZERO:5<=this.value&&this.value<=8?u9.ONE:s9.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return zB.empty();case 1:case 5:return zB.of(Ate.UP);case 2:case 6:return zB.of(Ate.RIGHT);case 3:case 7:return zB.of(Ate.DOWN);case 4:case 8:return zB.of(Ate.LEFT);default:return LB.expectToBe(this.value,9),zB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return LB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===u9.ZERO?t===Ate.UP?e.LIGHT_UP:t===Ate.RIGHT?e.LIGHT_RIGHT:t===Ate.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===Ate.UP?e.DARK_UP:t===Ate.RIGHT?e.DARK_RIGHT:t===Ate.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();qhe.EMPTY=new qhe(0),qhe.LIGHT_UP=new qhe(1),qhe.LIGHT_RIGHT=new qhe(2),qhe.LIGHT_DOWN=new qhe(3),qhe.LIGHT_LEFT=new qhe(4),qhe.DARK_UP=new qhe(5),qhe.DARK_RIGHT=new qhe(6),qhe.DARK_DOWN=new qhe(7),qhe.DARK_LEFT=new qhe(8),qhe.MOUNTAIN=new qhe(9);var Whe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"countCurrentPlayerPawn",value:function(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}},{key:"countPlayersPawn",value:function(){for(var e=[0,0],t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n]!==qhe.EMPTY&&e[this.getPieceAtXY(n,t).getOwner().value]++;return e}}],[{key:"getInitialState",value:function(){var e=h9.createTable(5,5,qhe.EMPTY);return e[2][1]=qhe.MOUNTAIN,e[2][2]=qhe.MOUNTAIN,e[2][3]=qhe.MOUNTAIN,new n(e,0)}}]),n}(qte),jhe=function(){var e=Py(function e(){by(this,e)});return e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(sl||(sl=ey(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(ul||(ul=ey(["You do not have enough strength to push."])))},e.MUST_MOVE_OR_ROTATE=function(){return $localize(cl||(cl=ey(["You must move or rotate your piece."])))},e.ILLEGAL_PUSH=function(){return $localize(ll||(ll=ey(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_SELECT_VALID_DESTINATION=function(){return $localize(fl||(fl=ey(["You must select a valid destination (highlighted on the board) for your piece"])))},e.MUST_SELECT_ORIENTATION=function(){return $localize(hl||(hl=ey(["You should select the orientation of your piece by clicking on one of the arrows."])))},e}(),Yhe=Py(function e(t,n){by(this,e),this.resultingBoard=t,this.moved=n}),Khe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,Whe)}return Py(n,[{key:"isLegal",value:function(e,t){if(FB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return HB.failure(Hte.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return FB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){FB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return HB.failure(i.legal.getReason());r=i.insertedPiece}else FB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var n=t.countCurrentPlayerPawn(),r=t.getCurrentPlayer(),i=n<5?ZB.SUCCESS:ZB.failure(jhe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,r),legal:i}}},{key:"getInsertedPiece",value:function(e,t){return qhe.of(-1===e.x?Ate.RIGHT:-1===e.y?Ate.DOWN:5===e.x?Ate.LEFT:Ate.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){FB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}}),$7(r!==qhe.MOUNTAIN&&r!==qhe.EMPTY,"forwarding must be done with player piece");var i=[],a=qhe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.direction.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==qhe.EMPTY&&!1===this.isStraight(r,e))return FB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),HB.failure(jhe.ILLEGAL_PUSH());var u=zB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=qhe.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==qhe.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,FB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===qhe.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==qhe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(FB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(FB(n.VERBOSE,"This move is an illegal push: "+f),HB.failure(jhe.NOT_ENOUGH_FORCE_TO_PUSH())):(FB(n.VERBOSE,"This move is a legal push: "+f),HB.success(new Yhe(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}},{key:"isLegalRotation",value:function(e,t){FB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return HB.failure(jhe.MUST_MOVE_OR_ROTATE());var o=t.getCopiedBoard();return o[r.y][r.x]=qhe.of(e.landingOrientation,a),HB.success(new Yhe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=h9.copyBiArray(n.resultingBoard);return new Whe(r,t.turn+1)}},{key:"getBoardValueInfo",value:function(e,t){var n=this.getMountainsRowsAndColumns(t),r=n.rows,i=n.columns,a=this.getWinner(t,e,n.nbMountain);if(a.isPlayer())return a===u9.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var o,s=this.getPushers(t,i,r),u=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,l=t.getCurrentPlayer(),f=Cy(s);try{for(f.s();!(o=f.n()).done;){var h=o.value;h.coord.isInRange(5,5)?t.getPieceAt(h.coord).belongTo(u9.ZERO)?u=Math.min(u,h.distance):c=Math.min(c,h.distance):l===u9.ZERO?u=Math.min(u,h.distance):c=Math.min(c,h.distance)}}catch(d){f.e(d)}finally{f.f()}return{shortestZero:u,shortestOne:c,boardValue:this.getScoreFromShortestDistances(u,c,l)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===qhe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,n){return 2===n?this.getPusher(e,t.get()):s9.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):this.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=this.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return FB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==qhe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){FB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Cy(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=Ate.DOWN,l=new Rte(u,4);o.push({direction:c,fallingCoord:l}),c=Ate.UP,l=new Rte(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=Cy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=Ate.LEFT,p=new Rte(0,d);o.push({direction:v,fallingCoord:p}),v=Ate.RIGHT,p=new Rte(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=this.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=this.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return FB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){FB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=zB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===qhe.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=zB.of(s),o!==qhe.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countCurrentPlayerPawn())||f>0?zB.empty():zB.of({distance:a,coord:s})}},{key:"getInsertions",value:function(e){for(var t=[],n=1;n<4;n++)t=(t=(t=(t=t.concat(this.getInsertionsAt(e,0,n))).concat(this.getInsertionsAt(e,4,n))).concat(this.getInsertionsAt(e,n,0))).concat(this.getInsertionsAt(e,n,4));return t=(t=(t=(t=t.concat(this.getInsertionsAt(e,0,0))).concat(this.getInsertionsAt(e,0,4))).concat(this.getInsertionsAt(e,4,0))).concat(this.getInsertionsAt(e,4,4))}},{key:"getInsertionsAt",value:function(e,t,n){var r,i=[],a=Cy(Ate.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=new Rte(t,n).getPrevious(o);if(s.isNotInRange(5,5)){var u,c=Cy(Ate.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=Zhe.of(s.x,s.y,zB.of(o),l);$7(f.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(f.get(),e).isSuccess()&&i.push(f.get())}}catch(h){c.e(h)}finally{c.f()}}}}catch(h){a.e(h)}finally{a.f()}return i}},{key:"getMovesFrom",value:function(e,t,n,r){var i,a=new Rte(n,r),o=this.getRotationMovesAt(a,t),s=Cy(Ate.ORTHOGONALS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=a.getNext(u);o=o.concat(this.getForwardMovesBetween(e,a,c))}}catch(l){s.e(l)}finally{s.f()}return o}},{key:"getMovesBetween",value:function(e,t,n,r){return n.equals(r)?this.getRotationMovesAt(n,t):Ate.factory.fromMove(n,r).isSuccess()&&1===n.getDistance(r)?this.getForwardMovesBetween(e,n,r):[]}},{key:"getRotationMovesAt",value:function(e,t){var n,r=[],i=t.getDirection(),a=Cy(Ate.ORTHOGONALS);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o!==i){var s=Zhe.of(e.x,e.y,zB.empty(),o).get();r.push(s)}}}catch(u){a.e(u)}finally{a.f()}return r}},{key:"getForwardMovesBetween",value:function(e,t,n){var r,i=[],a=Ate.factory.fromMove(t,n).get(),o=e.getPieceAt(t),s=Cy(n.isInRange(5,5)?Ate.ORTHOGONALS:[a]);try{for(s.s();!(r=s.n()).done;){var u=r.value,c=Zhe.of(t.x,t.y,zB.of(a),u).get();this.isLegalForwarding(c,e,o).isSuccess()&&i.push(c)}}catch(l){s.e(l)}finally{s.f()}return i}},{key:"getGameStatus",value:function(e){var t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.move,t.nbMountain);return n.isPlayer()?ene.getVictory(n):ene.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=zB.of(new n)),n.singleton.get()}}]),n}(tne);Khe.singleton=zB.empty(),Khe.VERBOSE=!1;var Qhe=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){return new $te(Khe.get().getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=0;r<5;r++)for(var i=0;i<5;i++){var a=e.gameState.getPieceAtXY(i,r);a.belongTo(n)&&(t=t.concat(Khe.get().getMovesFrom(e.gameState,a,i,r)))}if(e.gameState.countCurrentPlayerPawn()<5){var o,s=Cy(Khe.get().getInsertions(e.gameState));try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u.direction.get().getOpposite()!==u.landingOrientation){if(this.isOnBorder(u)&&u.direction.get()!==u.landingOrientation)continue;t.push(u)}}}catch(c){s.e(c)}finally{s.f()}}return FB(Khe.VERBOSE,{getListMovesResult:t}),t}},{key:"isOnBorder",value:function(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}]),n}(Gte),Xhe=qhe.EMPTY,Jhe=qhe.MOUNTAIN,ede=qhe.LIGHT_UP,tde=qhe.LIGHT_LEFT,nde=qhe.LIGHT_RIGHT,rde=qhe.LIGHT_DOWN,ide=qhe.DARK_UP,ade=qhe.DARK_LEFT,ode=qhe.DARK_RIGHT,sde=qhe.DARK_DOWN,ude=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(dl||(dl=ey(["Goal of the game"]))),$localize(vl||(vl=ey(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece</li>\n            <li>Move one of its piece and optionally reorient it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Whe.getInitialState()),ane.anyMove($localize(pl||(pl=ey(["Inserting a piece"]))),$localize(gl||(gl=ey(["Each player has 5 pieces in total.\n        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of your pieces from your reserve, next to board.</li>\n            <li>Click on one of the highlighted squares to select a landing for your piece.</li>\n            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>\n        </ol><br/>\n        You're playing Light, insert a piece on the board."]))),Whe.getInitialState(),Zhe.of(2,-1,zB.of(Ate.DOWN),Ate.DOWN).get(),$localize(yl||(yl=ey(["Congratulations!"])))),ane.fromMove($localize(ml||(ml=ey(["Moving a piece"]))),$localize(kl||(kl=ey(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        You can also move a piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on the square on which you want the piece to move.\n                You can also click a second time on your piece to change its orientation without moving it.</li>\n            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>\n        </ol><br/>\n        Try to move your piece that is already on the board one square upwards and to orient it to the left.']))),new Whe([[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Jhe,Jhe,Jhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,ede,Xhe,Xhe]],0),[Zhe.of(2,4,zB.of(Ate.UP),Ate.LEFT).get()],$localize(Cl||(Cl=ey(["Congratulations, you made a side-slip!"]))),$localize(wl||(wl=ey(["Failed!"])))),ane.fromMove($localize(_l||(_l=ey(["Moving a piece out of the board"]))),$localize(bl||(bl=ey(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Whe([[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Jhe,Jhe,Jhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,ede,Xhe,Xhe]],0),[Zhe.of(2,4,zB.of(Ate.DOWN),Ate.DOWN).get()],$localize(El||(El=ey(["Congratulations, even if in this context it was not a useful move."]))),$localize(Pl||(Pl=ey(["Failed, the piece is still on the board."])))),ane.fromMove($localize(Sl||(Sl=ey(["Pushing (1/2)"]))),$localize(Ol||(Ol=ey(['When the landing square of your move is occupied, we use the term "push".\n        In order to push player pieces, the following conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>Along the line that you are pushing, the number of pieces (yours or your opponent\'s) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>\n        </ol>\n        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.\n        On the second row, you can push because there are two pieces against one.<br/><br/>\n        Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.']))),new Whe([[Xhe,nde,ade,Xhe,Xhe],[nde,ode,tde,Xhe,Xhe],[Xhe,Xhe,ede,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe]],0),[Zhe.of(2,2,zB.of(Ate.UP),Ate.UP).get()],$localize(Tl||(Tl=ey(["Congratulations!"]))),$localize(Il||(Il=ey(["Failed!"])))),ane.fromMove($localize(Al||(Al=ey(["Pushing (2/2)"]))),$localize(Ml||(Ml=ey(["To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.\n        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.\n        On the following board, you can push the mountain on the first row.\n        On the second and third row, because of the resisting forces, you cannot push.<br/><br/>\n        On the fourth row, you can push as there is one more pusher than resistant pieces. Do it."]))),new Whe([[Xhe,Xhe,nde,Jhe,Xhe],[Xhe,Xhe,nde,Jhe,tde],[Xhe,nde,Jhe,Jhe,Xhe],[Xhe,nde,ode,ade,Jhe],[Xhe,Xhe,Xhe,Xhe,Xhe]],0),[Zhe.of(1,3,zB.of(Ate.RIGHT),Ate.RIGHT).get()],$localize(xl||(xl=ey(["Congratulations! Note that this move made you lose the game, you will see why in the next step."]))),$localize(Rl||(Rl=ey(["Failed!"])))),ane.fromMove($localize(Nl||(Nl=ey(["Victory"]))),$localize(Dl||(Dl=ey(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        Here, you can push a mountain off the board and either win, or lose. Choose correctly!"]))),new Whe([[Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe],[Jhe,ide,tde,Xhe,rde],[Xhe,Xhe,Xhe,Xhe,sde],[Xhe,Xhe,Xhe,Xhe,Jhe]],0),[Zhe.of(2,2,zB.of(Ate.LEFT),Ate.LEFT).get()],$localize(Ll||(Ll=ey(["Congratulations, you won!"]))),$localize(Fl||(Fl=ey(["Failed, you lost."]))))]});function cde(e,t){if(1&e){var n=FP();zC(),xP(0,"use",11),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().clickSquare(e,t)}),RP()}if(2&e){var r=GP(),i=r.index,a=r.$implicit,o=GP().index,s=GP();qP("id","piece_",i,"_",o,""),AP("ngClass",s.getPieceClasses(i,o,a)),_P("transform",s.getPieceTransform(i,o))}}function lde(e,t){if(1&e){var n=FP();zC(),xP(0,"use",12),BP("click",function(){hC(n);var e=GP().index,t=GP().index;return GP().clickSquare(e,t)}),RP()}if(2&e){var r=GP().index,i=GP().index,a=GP();_P("transform","translate("+(r+1)*a.SPACE_SIZE+" "+(i+1)*a.SPACE_SIZE+")")}}function fde(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",8),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().clickSquare(e,t)}),RP(),OP(2,cde,1,4,"use",9),OP(3,lde,1,1,"use",10),RP()}if(2&e){var r=t.$implicit,i=t.index,a=GP().index,o=GP();Wb(1),qP("id","square_",i,"_",a,""),AP("ngClass",o.getSquareClasses(i,a)),_P("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Wb(1),AP("ngIf",r.isPiece()),Wb(1),AP("ngIf",o.isMountain(r))}}function hde(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,fde,4,9,"g",4),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function dde(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",15),BP("click",function(){hC(n);var e=GP().$implicit;return GP().clickSquare(e.x,e.y)}),RP()}if(2&e){var r=GP().$implicit,i=GP();qP("id","square_",r.x,"_",r.y,""),AP("ngClass",i.getSquareClasses(r.x,r.y)),_P("x",i.SPACE_SIZE*(r.x+1))("y",i.SPACE_SIZE*(r.y+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function vde(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),OP(1,dde,1,7,"rect",13),xP(2,"rect",14),BP("click",function(){var e=hC(n).$implicit;return GP().clickSquare(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),AP("ngIf",!1===r.isInRange(5,5)),Wb(1),_P("x",i.SPACE_SIZE*(r.x+1))("y",i.SPACE_SIZE*(r.y+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function pde(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",16),BP("click",function(){hC(n);var e=GP();return e.clickSquare(e.selectedLanding.get().x,e.selectedLanding.get().y)}),RP()}if(2&e){var r=GP();_P("x",r.SPACE_SIZE*(r.selectedLanding.get().x+1))("y",r.SPACE_SIZE*(r.selectedLanding.get().y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function gde(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",16),BP("click",function(){hC(n);var e=GP();return e.clickSquare(e.selectedPiece.get().x,e.selectedPiece.get().y)}),RP()}if(2&e){var r=GP();_P("x",r.SPACE_SIZE*(r.selectedPiece.get().x+1))("y",r.SPACE_SIZE*(r.selectedPiece.get().y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function yde(e,t){if(1&e&&(zC(),NP(0,"use",19)),2&e){var n=t.$implicit,r=GP().$implicit,i=GP();qP("id","remainingPieces_",r.value,"_",n,""),AP("ngClass",i.getRemainingPieceClasses(r,n)),_P("transform",i.getRemainingPieceTransform(n,r))}}function mde(e,t){if(1&e){var n=FP();zC(),xP(0,"g",17),BP("click",function(){var e=hC(n).$implicit;return GP().selectPieceForInsertion(e)}),OP(1,yde,1,4,"use",18),RP()}if(2&e){var r=t.$implicit,i=GP();ZP("id","remainingPieces_",r.value,""),Wb(1),AP("ngForOf",i.range(i.playerPieces(r)))}}function kde(e,t){if(1&e){var n=FP();zC(),xP(0,"use",22),BP("click",function(){hC(n);var e=GP().$implicit;return GP().clickSquare(e.source.get().coord.x,e.source.get().coord.y)}),RP()}if(2&e){var r=GP().$implicit,i=GP();AP("ngClass",i.getPieceClasses(r.source.get().coord.x,r.source.get().coord.y,r.source.get().piece)),_P("transform",i.getPieceTransform(r.source.get().coord.x,r.source.get().coord.y))}}function Cde(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"use",20),BP("click",function(){var e=hC(n).$implicit;return GP().clickArrow(e)}),RP(),OP(2,kde,1,2,"use",21),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),WP("id","indicator_",r.target.x,"_",r.target.y,"_",r.direction.toString(),""),_P("transform",i.getIndicatorTransform(r)),Wb(1),AP("ngIf",r.source.isPresent())}}function wde(e,t){if(1&e){var n=FP();zC(),xP(0,"use",23),BP("click",function(){var e=hC(n).$implicit;return GP().selectOrientation(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();ZP("id","orientation_",r.landingOrientation,""),AP("ngClass",i.getCurrentPlayerClass()),_P("transform",i.getOrientationTransform(r.landingOrientation))}}var _de=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).lastMove=zB.empty(),r.movedPieces=[],r.selectedPiece=zB.empty(),r.selectedLanding=zB.empty(),r.orientations=[],r.clickableCoords=new x9,r.indicatorArrows=[],r.insertingPiece=!1,r.rules=Khe.get(),r.availableMinimaxes=[new Qhe(r.rules,"SiamMinimax")],r.encoder=Zhe.encoder,r.tutorial=(new ude).tutorial,r.updateBoard(),r}return Py(n,[{key:"updateBoard",value:function(){FB(n.VERBOSE,"updateBoard");var e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var t=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),t).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.insertingPiece=!1,this.selectedPiece=zB.empty(),this.selectedLanding=zB.empty(),this.orientations=[],this.clickableCoords=new x9,this.indicatorArrows=[]}},{key:"selectPieceForInsertion",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#remainingPieces_"+e.value)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(e===t.getCurrentPlayer()){n.next=5;break}return n.abrupt("return",t.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()));case 5:if(!t.insertingPiece){n.next=7;break}return n.abrupt("return",(t.cancelMoveAttempt(),ZB.SUCCESS));case 7:t.cancelMoveAttempt(),i=Cy(Khe.get().getInsertions(t.getState()));try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.coord.getNext(o.direction.get()),t.board[s.y][s.x]!==qhe.EMPTY&&(u={source:zB.empty(),target:s,direction:o.direction.get(),move:o},t.indicatorArrows.push(u)),t.clickableCoords.add(s)}catch(c){i.e(c)}finally{i.f()}return n.abrupt("return",(t.insertingPiece=!0,ZB.SUCCESS));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectOrientation",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#orientation_"+e.landingOrientation.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e,t.getState()));case 2:case"end":return n.stop()}},n)}))()}},{key:"clickSquare",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this;return DB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(FB(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+t+")"),!1!==r){a.next=4;break}if(!(o=i.canUserPlay("#square_"+e+"_"+t)).isFailure()){a.next=4;break}return a.abrupt("return",i.cancelMove(o.getReason()));case 4:if(s=new Rte(e,t),!i.insertingPiece){a.next=7;break}return a.abrupt("return",i.insertPiece(s));case 7:if(!i.selectedLanding.isPresent()){a.next=9;break}return a.abrupt("return",(i.cancelMoveAttempt(),ZB.SUCCESS));case 9:if(!i.selectedPiece.isPresent()){a.next=13;break}return i.selectedLanding=zB.of(s),u=Khe.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s),a.abrupt("return",0===u.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(u));case 13:return $7(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible"),c=i.board[t][e],a.abrupt("return",c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Hte.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,c));case 16:case"end":return a.stop()}},a)}))()}},{key:"insertPiece",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selectedLanding.isPresent()){n.next=2;break}return n.abrupt("return",(t.cancelMove(jhe.MUST_SELECT_ORIENTATION()),ZB.SUCCESS));case 2:return t.selectedLanding=zB.of(e),r=Khe.get().getInsertionsAt(t.getState(),e.x,e.y),n.abrupt("return",0===r.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(r));case 5:case"end":return n.stop()}},n)}))()}},{key:"changeMoveDestinationClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(jhe.MUST_SELECT_VALID_DESTINATION())));case 1:case"end":return n.stop()}},n)}))()}},{key:"performMoveOrShowOrientationArrows",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",($7(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(t.cancelMove(),t.chooseMove(e[0],t.getState())):(t.clickableCoords=new x9,t.indicatorArrows=[],t.orientations=e,ZB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectPiece",value:function(e,t){this.cancelMoveAttempt();var n=this.getState();this.selectedPiece=zB.of(e);var r,i=Cy(Khe.get().getMovesFrom(n,t,e.x,e.y));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.direction.isPresent()){var o=a.coord.getNext(a.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==qhe.EMPTY){var s={source:zB.of({coord:e,piece:t}),target:o,direction:a.direction.get(),move:a};this.indicatorArrows.push(s)}}else this.clickableCoords.add(a.coord)}}catch(u){i.e(u)}finally{i.f()}return ZB.SUCCESS}},{key:"clickArrow",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e.move,t.getState()));case 2:case"end":return n.stop()}},n)}))()}},{key:"isMountain",value:function(e){return e===qhe.MOUNTAIN}},{key:"getArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(n.toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}},{key:"getIndicatorTransform",value:function(e){var t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}},{key:"getRemainingPieceTransform",value:function(e,t){var n,r,i=this.playerPieces(t),a=2;return t===u9.ONE?(a+=(i-e+(5-i)/2)/3,n=-1,r=Ate.RIGHT):(a+=(e+1+(5-i)/2)/3,n=7,r=Ate.LEFT),this.getArrowTransform(a,n,r)}},{key:"getOrientationTransform",value:function(e){var t="translate(0, ".concat(this.SPACE_SIZE/1.6,")"),n="rotate(".concat(90*(e.toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate(".concat(2.27*this.SPACE_SIZE,", ").concat(2.27*this.SPACE_SIZE,")"),"scale(2.43)",n,t].join(" ")}},{key:"getPieceClasses",value:function(e,t,n){var r=new Rte(e,t),i=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(r)&&i.push("selected-stroke"),i}},{key:"getSquareClasses",value:function(e,t){var n=new Rte(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved-fill"]:[]}},{key:"getRemainingPieceClasses",value:function(e,t){var n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}},{key:"getCurrentPlayerClass",value:function(){return this.getPlayerClass(this.getCurrentPlayer())}},{key:"playerPieces",value:function(e){return 5-this.getState().countPlayersPawn()[e.value]}}]),n}(Bne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-siam"]],features:[cP],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),xP(1,"defs"),NP(2,"polygon",1),NP(3,"polygon",2),NP(4,"polygon",3),RP(),OP(5,hde,2,1,"g",4),OP(6,vde,3,5,"g",4),OP(7,pde,1,4,"rect",5),OP(8,gde,1,4,"rect",5),OP(9,mde,2,2,"g",6),OP(10,Cde,3,5,"g",4),OP(11,wde,1,3,"use",7),RP()),2&e&&(Wb(5),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.clickableCoords),Wb(1),AP("ngIf",t.selectedLanding.isPresent()),Wb(1),AP("ngIf",t.selectedPiece.isPresent()),Wb(1),AP("ngForOf",t.Player.PLAYERS),Wb(1),AP("ngForOf",t.indicatorArrows),Wb(1),AP("ngForOf",t.orientations))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),bde=function(){var e=Py(function e(){by(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(Ul||(Ul=ey(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Vl||(Vl=ey(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Bl||(Bl=ey(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(zl||(zl=ey(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Hl||(Hl=ey(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Gl||(Gl=ey(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize($l||($l=ey(["You must put this piece next to another piece."])))},e}(),Ede=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;by(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return Py(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Cy(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new N9,u=new Ste(-t,-r);if(0!==t||0!==r){var c,l=Cy(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=h9.createTable(this.width,this.height,s9.NONE.value),n=Cy(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?ZB.failure(Hte.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?ZB.SUCCESS:ZB.failure(bde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Cy(Fte.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():s9.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new N9;if(t.size()>0){i=new N9;var a,o=Cy(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(u9.ZERO).getOrElse(new hre),n=e.get(u9.ONE).getOrElse(new hre);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);G7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[u9.ZERO.value],[u9.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new N9,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==s9.NONE.value&&i.set(new Rte(o,a),u9.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new N9,a=0,o=Cy(Fte.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new x9,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Cy(Fte.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(Zte),Pde=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;if(by(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return vy(a)}return Py(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(zB.empty(),e,zB.empty())}},{key:"fromMovement",value:function(e,t){return new n(zB.of(e),t,zB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(zB.of(e),t,zB.of(r))}}]),n}(jte);Pde.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?Rte.encoder.encode(e.start.get()):null,landing:Rte.encoder.encode(e.landing),keep:e.keep.isPresent()?Rte.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=Rte.encoder.decode(t.landing);if(null==t.start)return Pde.fromDrop(n);var r=Rte.encoder.decode(t.start);if(null==t.keep)return Pde.fromMovement(r,n);var i=Rte.encoder.decode(t.keep);return Pde.fromCut(r,n,i)}}]),n}(i9));var Sde=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){FB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?HB.failure(bde.NO_MOVEMENT_BEFORE_TURN_40()):HB.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return ene.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?ene.ONE_WON:o<a?ene.ZERO_WON:ene.DRAW:a<6?ene.getDefeat(u9.ZERO):o<6?ene.getDefeat(u9.ONE):ene.ONGOING}return ene.ONGOING}},{key:"startSearchingVictorySources",value:function(){FB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(FB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Fte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(Fte.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=Fte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=Fte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new hre,r=Cy(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Cy(Fte.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===s9.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return HB.failure(bde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case s9.NONE:return HB.failure(Hte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return HB.failure(Hte.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=Ede.deplacePiece(t,e),i=Ede.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?HB.failure(bde.CANNOT_CHOOSE_TO_KEEP()):HB.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return HB.success(new hre)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new x9,i=Cy(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new x9([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return HB.failure(bde.MUST_CUT());if(n.get(e.get()).isAbsent())return HB.failure(bde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Cy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return HB.success(o)}}catch(s){a.e(s)}finally{a.f()}return HB.failure(bde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(tne),Ode=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:Qte.DEFAULT,victory:zB.empty(),preVictory:zB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===Qte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===Qte.VICTORY)return r;n={status:r.status,victory:zB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(Gte),Tde=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return Py(n)}($te),Ide=function(e){fy(n,e);var t=dy(n);function n(){var e;return by(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Py(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=Sde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){FB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=Pde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){FB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Cy(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Cy(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Pde.fromMovement(s,c);if(e.isCoordConnected(c,zB.of(s))){var f=Ede.deplacePiece(e,l),h=Ede.getGroups(f,l.start.get());if(Sde.isSplit(h)){var d,v=Cy(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=Pde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Cy(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new hre(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=Pde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===Qte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Pde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:Qte.DEFAULT,victory:zB.empty(),preVictory:zB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=zB.empty();if(a.status===Qte.DEFAULT&&a.preVictory.isPresent()&&(o=zB.of(a.preVictory.get())),a.status===Qte.VICTORY)return new Tde(i,zB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new Tde(u<c?u9.ONE.getVictoryValue():c<u?u9.ZERO.getVictoryValue():0,zB.empty()):u<6?new Tde(u9.ZERO.getDefeatValue(),zB.empty()):c<6?new Tde(u9.ONE.getDefeatValue(),zB.empty()):new Tde(u-c,o)}return new Tde(a.status===Qte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){FB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(FB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Fte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:Qte.PRE_VICTORY,victory:zB.empty(),preVictory:zB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(Fte.factory.all[o],1)}return{status:Qte.VICTORY,victory:zB.of(i),preVictory:zB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:Qte.PRE_VICTORY,victory:zB.empty(),preVictory:zB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:Qte.VICTORY,victory:zB.of(o),preVictory:zB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Qte.PRE_VICTORY,victory:zB.empty(),preVictory:zB.empty(),sum:0};a.length%2==0&&(i=Fte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:Qte.VICTORY,victory:zB.of(a),preVictory:zB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){FB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Fte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Qte.PRE_VICTORY,victory:zB.empty(),preVictory:zB.empty(),sum:0};a.push(o),a.length%2==0&&(i=Fte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:Qte.VICTORY,victory:zB.of(a),preVictory:zB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){FB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){FB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(Fte.factory.all[e],1),s=0,u=zB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=Fte.factory.all[l];c===s9.NONE?(s+=.16,u=zB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(FB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:Qte.PRE_VICTORY,victory:zB.empty(),preVictory:zB.empty(),sum:0};i=t}else if(5===e)return{status:Qte.VICTORY,victory:zB.of(n),preVictory:zB.empty(),sum:0};return{status:r.status,victory:zB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){FB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=Fte.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=zB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:Qte.VICTORY,victory:zB.of(o),preVictory:zB.empty(),sum:0};5.16===p&&f===Qte.DEFAULT&&(h.isPresent()?($7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=Qte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:zB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),zB.empty();case s9.NONE:return n.push(.16),zB.of(t);default:return n.push(1),zB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){FB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Fte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=zB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===s9.NONE?(u+=.16,c=zB.of(s)):u++,o.length%2==0&&(a=Fte.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){FB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Fte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=zB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===s9.NONE?(u+=.16,c=zB.of(s)):u++,o.push(s),o.length%2==0&&(a=Fte.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new Sde(Ede);n.singleton=zB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(Ode);Ide.singleton=zB.empty();var Ade=s9.NONE.value,Mde=u9.ZERO.value,xde=u9.ONE.value,Rde=function(){var e=Py(function e(){by(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(Zl||(Zl=ey(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(ql||(ql=ey(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),Nde=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Wl||(Wl=ey(["Six"]))),$localize(jl||(jl=ey(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),Ede.getInitialState()),ane.fromMove($localize(Yl||(Yl=ey(["Victory (line)"]))),$localize(Kl||(Kl=ey(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),Ede.fromRepresentation([[Mde,xde,xde,xde,xde,Mde],[Ade,Mde,xde,Ade,Mde,Ade],[xde,xde,Mde,Ade,Ade,Ade],[Ade,Ade,Mde,Ade,Ade,Ade],[Ade,Mde,Ade,Ade,Ade,Ade],[Mde,Ade,Ade,Ade,Ade,Ade]],0),[Pde.fromDrop(new Rte(3,2))],$localize(Ql||(Ql=ey(["Congratulations!"]))),$localize(Xl||(Xl=ey(["Failed!"])))),ane.fromMove($localize(Jl||(Jl=ey(["Victory (circle)"]))),$localize(ef||(ef=ey(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),Ede.fromRepresentation([[Ade,Ade,Ade,xde,Ade,Ade],[Ade,Ade,xde,xde,Mde,Mde],[Ade,xde,Ade,Mde,xde,Ade],[xde,Mde,Mde,Mde,Mde,xde]],0),[Pde.fromDrop(new Rte(5,2))],$localize(tf||(tf=ey(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(nf||(nf=ey(["Failed!"])))),ane.fromMove($localize(rf||(rf=ey(["Victory (triangle)"]))),$localize(af||(af=ey(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),Ede.fromRepresentation([[Ade,Ade,Ade,xde,Ade,Ade],[Ade,Mde,xde,Mde,Mde,Mde],[Ade,Mde,Ade,Mde,Mde,Ade],[xde,xde,xde,Ade,xde,Ade]],0),[Pde.fromDrop(new Rte(3,3))],$localize(of||(of=ey(["Congratulations!"]))),$localize(sf||(sf=ey(["Failed!"])))),ane.fromPredicate($localize(uf||(uf=ey(["Second phase"]))),$localize(cf||(cf=ey(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),Ede.fromRepresentation([[Ade,Ade,Ade,Ade,Ade,Ade,Ade,xde,Ade],[Ade,Ade,Ade,Ade,Ade,Ade,Mde,Ade,Ade],[Ade,Ade,Ade,Ade,Mde,Mde,Mde,Ade,Ade],[Ade,Ade,Ade,Ade,xde,xde,Ade,xde,Mde],[Ade,Mde,xde,xde,Mde,Mde,xde,Ade,Ade],[Mde,Mde,Mde,Mde,xde,xde,xde,Mde,Ade],[xde,xde,Mde,Ade,xde,xde,Mde,Ade,Ade],[Ade,Mde,Ade,Mde,Mde,Ade,Ade,Ade,Ade],[xde,xde,xde,xde,Ade,Ade,Ade,Ade,Ade],[Ade,Mde,Ade,xde,Ade,Ade,Ade,Ade,Ade]],40),Pde.fromMovement(new Rte(6,1),new Rte(5,1)),function(e,t,n){var r=n.countPieces();return 19===r[0]?18===r[1]?ZB.SUCCESS:ZB.failure(Rde.MOVEMENT_NOT_DISCONNECTING()):ZB.failure(Rde.MOVEMENT_SELF_DISCONNECTING())},$localize(lf||(lf=ey(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),ane.fromPredicate($localize(ff||(ff=ey(["Victory by disconnection"]))),$localize(hf||(hf=ey(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),Ede.fromRepresentation([[Ade,Ade,Ade,Ade,Ade,xde],[Ade,Ade,Ade,Ade,Mde,xde],[Ade,Ade,Ade,xde,Mde,Mde],[Ade,Ade,Mde,Ade,xde,Mde],[xde,xde,Ade,Ade,Ade,Mde],[Mde,xde,Ade,Ade,Ade,Ade],[Mde,Ade,Ade,Ade,Ade,Ade]],40),Pde.fromMovement(new Rte(2,3),new Rte(3,3)),function(e,t,n){return e.start.equalsValue(new Rte(2,3))?ZB.SUCCESS:ZB.failure(Rde.MOVEMENT_NOT_DISCONNECTING())},$localize(df||(df=ey(["Congratulations, you won!"])))),ane.fromPredicate($localize(vf||(vf=ey(["Special disconnection"]))),$localize(pf||(pf=ey(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),Ede.fromRepresentation([[Ade,Ade,Ade,Ade,Ade,xde],[Ade,Ade,Ade,Ade,Mde,xde],[Ade,Ade,Ade,xde,Mde,Mde],[Mde,Ade,Mde,Ade,Ade,xde],[xde,xde,Ade,Ade,Ade,Ade],[Mde,Mde,Ade,Ade,Ade,Ade],[Mde,Ade,Ade,Ade,Ade,Ade]],40),Pde.fromCut(new Rte(2,3),new Rte(2,5),new Rte(2,5)),function(e,t,n){return e.keep.isAbsent()?ZB.failure($localize(gf||(gf=ey(["This move has not cut the board in two equal halves."])))):n.getPieceAt(e.landing.getNext(n.offset))===s9.NONE?ZB.failure($localize(yf||(yf=ey(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):ZB.SUCCESS},$localize(mf||(mf=ey(["Congratulations, you won!"]))))]});function Dde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",10),BP("click",function(){var e=hC(n).$implicit;return GP().onPieceClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","piece_",r.x,"_",r.y,""),AP("ngClass",i.getPieceClass(r)),_P("points",i.getHexaCoordsAt(r))}}function Lde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",11),BP("click",function(){var e=hC(n).$implicit;return GP().onNeighborClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","neighbor_",r.x,"_",r.y,""),_P("points",i.getHexaCoordsAt(r))}}function Fde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",10),BP("click",function(){hC(n);var e=GP();return e.onPieceClick(e.chosenLanding.get())}),RP()}if(2&e){var r=GP();qP("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),AP("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),_P("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Ude(e,t){if(1&e&&(zC(),NP(0,"polygon",12)),2&e){var n=t.$implicit,r=GP();qP("id","disconnected_",n.x,"_",n.y,""),_P("points",r.getHexaCoordsAt(n))}}function Vde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",13),BP("click",function(){hC(n);var e=GP();return e.onNeighborClick(e.leftCoord.get())}),RP()}if(2&e){var r=GP();qP("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),_P("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Bde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",14),BP("click",function(){hC(n);var e=GP();return e.onPieceClick(e.lastDrop.get())}),RP()}if(2&e){var r=GP();qP("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),_P("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function zde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",15),BP("click",function(){hC(n);var e=GP();return e.onPieceClick(e.selectedPiece.get())}),RP()}if(2&e){var r=GP();qP("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),AP("ngClass",r.getSelectedPieceClass()),_P("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Hde(e,t){if(1&e&&(zC(),NP(0,"polygon",16)),2&e){var n=t.$implicit,r=GP();qP("id","victoryCoord_",n.x,"_",n.y,""),_P("points",r.getHexaCoordsAt(n))}}function Gde(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",19),BP("click",function(){var e=hC(n).$implicit;return GP(2).onPieceClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP(2);qP("id","cuttable_",r.x,"_",r.y,""),_P("points",i.getHexaCoordsAt(r))}}function $de(e,t){if(1&e&&(zC(),xP(0,"g",17),OP(1,Gde,1,3,"polygon",18),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}var Zde=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=zB.empty(),r.lastDrop=zB.empty(),r.selectedPiece=zB.empty(),r.chosenLanding=zB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new Sde(Ede),r.availableMinimaxes=[new Ide(r.rules,"SixMinimax")],r.encoder=Pde.encoder,r.tutorial=(new Nde).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new Ute(1.5*r.SPACE_SIZE,new Rte(2*r.SPACE_SIZE,0),zte.INSTANCE),r.updateBoard(),r}return Py(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=zB.empty(),this.chosenLanding=zB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=zB.empty(),this.lastDrop=zB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Cy(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Cy(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=zB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?zB.of(e.start.get().getNext(this.state.offset,1)):zB.empty();var t=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.getState().pieces.listKeys(),i=[],a=Cy(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=Sde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.getState().getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(bde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(Hte.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=t.selectedPiece.equalsValue(e)?zB.empty():zB.of(e),ZB.SUCCESS));case 7:return i=Pde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(bde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(Pde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(bde.CAN_NO_LONGER_DROP()));case 9:return i=Pde.fromMovement(t.selectedPiece.get(),e),a=Sde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=zB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,ZB.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===bde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=Pde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=Ede.deplacePiece(this.state,e),n=Ede.getGroups(t,e.start.get()),r=Sde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Cy(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}]),n}(Dte);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-six"]],features:[cP],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-fill mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-fill","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Dde,1,4,"polygon",1),OP(2,Lde,1,3,"polygon",2),OP(3,Fde,1,4,"polygon",3),OP(4,Ude,1,3,"polygon",4),OP(5,Vde,1,3,"polygon",5),OP(6,Bde,1,3,"polygon",6),OP(7,zde,1,4,"polygon",7),OP(8,Hde,1,3,"polygon",8),OP(9,$de,2,1,"g",9),RP()),2&e&&(_P("viewBox",t.viewBox),Wb(1),AP("ngForOf",t.pieces),Wb(1),AP("ngForOf",t.neighbors),Wb(1),AP("ngIf",t.chosenLanding.isPresent()),Wb(1),AP("ngForOf",t.disconnecteds),Wb(1),AP("ngIf",t.leftCoord.isPresent()),Wb(1),AP("ngIf",t.lastDrop.isPresent()),Wb(1),AP("ngIf",t.selectedPiece.isPresent()),Wb(1),AP("ngForOf",t.victoryCoords),Wb(1),AP("ngForOf",t.cuttableGroups))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),qde=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return HB.success(r)}catch(r){return HB.failure(r.message)}}}]),n}(Jne);qde.encoder=Qne.getEncoder(9,9,qde.of);var Wde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:u9.ZERO},jde=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=nre.UNOCCUPIED,t=nre.INVADERS,r=nre.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,nre.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(ire),Yde=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.call(this,jde,Wde,qde.of)}return Py(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Jte.ruler=this.singleton,n.singleton}}]),n}(ore),Kde=nre.UNOCCUPIED,Qde=nre.INVADERS,Xde=nre.DEFENDERS,Jde=nre.PLAYER_ONE_KING,eve=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(kf||(kf=ey(["Goal of the game"]))),$localize(Cf||(Cf=ey(["Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),jde.getInitialState()),ane.anyMove($localize(wf||(wf=ey(["Moving"]))),$localize(_f||(_f=ey(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),jde.getInitialState(),qde.of(new Rte(4,1),new Rte(1,1)),$localize(bf||(bf=ey(["Congratulations!"])))),ane.fromMove($localize(Ef||(Ef=ey(["Capturing a soldier (1/2)"]))),$localize(Pf||(Pf=ey(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new jde([[Kde,Kde,Kde,Qde,Qde,Qde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Qde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Qde,Xde,Kde,Kde,Kde,Qde],[Qde,Qde,Xde,Xde,Jde,Xde,Xde,Qde,Qde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Qde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Qde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Qde,Qde,Qde,Kde,Kde,Kde]],1),[qde.of(new Rte(2,4),new Rte(2,3)),qde.of(new Rte(4,2),new Rte(3,2))],$localize(Sf||(Sf=ey(["Congratulations, that will teach him a lesson!"]))),$localize(Of||(Of=ey(["Failed, you missed an opportunity to capture a piece of the opponent."])))),ane.fromMove($localize(Tf||(Tf=ey(["Capturing a soldier (2/2)"]))),$localize(If||(If=ey(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new jde([[Kde,Kde,Kde,Qde,Qde,Qde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Qde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Kde],[Kde,Kde,Xde,Kde,Jde,Kde,Xde,Kde,Qde],[Qde,Qde,Kde,Xde,Kde,Xde,Xde,Qde,Qde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Qde],[Kde,Kde,Kde,Kde,Xde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Qde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Qde,Qde,Qde,Kde,Kde,Kde]],12),[qde.of(new Rte(1,4),new Rte(2,4))],$localize(Af||(Af=ey(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(Mf||(Mf=ey(["Failed, you did not do the expected move."])))),ane.fromMove($localize(xf||(xf=ey(["Capturing the king (1/2)"]))),$localize(Rf||(Rf=ey(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new jde([[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Qde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Qde,Jde,Kde,Qde,Kde,Kde,Kde,Kde,Kde],[Kde,Qde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde]],72),[qde.of(new Rte(3,4),new Rte(2,4))],$localize(Nf||(Nf=ey(["Congratulations, you won!"]))),$localize(Df||(Df=ey(["Failed, you let the king run away."])))),ane.fromMove($localize(Lf||(Lf=ey(["Capturing the king (2/2)"]))),$localize(Ff||(Ff=ey(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new jde([[Kde,Kde,Qde,Jde,Qde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Qde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde],[Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde,Kde]],72),[qde.of(new Rte(3,3),new Rte(3,1))],$localize(Uf||(Uf=ey(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Vf||(Vf=ey(["Failed!"]))))]});function tve(e,t){1&e&&(zC(),NP(0,"polygon",8))}function nve(e,t){1&e&&(zC(),NP(0,"rect",9))}function rve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,tve,1,0,"polygon",6),OP(2,nve,1,0,"ng-template",null,7,uI),RP()),2&e){var n=TP(3),r=GP().index,i=GP().index,a=GP();Wb(1),AP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function ive(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13),NP(4,"line",13),NP(5,"line",13),RP()),2&e){var n=GP(2).index,r=GP().index,i=GP();Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ave(e,t){if(1&e&&(zC(),NP(0,"polyline",16)),2&e){var n=GP(3).index,r=GP().index;AP("ngClass",GP().viewInfo.pieceClasses[r][n])}}function ove(e,t){if(1&e&&(zC(),NP(0,"line",13),NP(1,"line",13),NP(2,"line",13),NP(3,"line",13)),2&e){var n=GP(3).index,r=GP().index,i=GP();AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),Wb(1),AP("ngClass",i.viewInfo.pieceClasses[r][n]),_P("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function sve(e,t){if(1&e&&(zC(),OP(0,ave,1,1,"polyline",14),OP(1,ove,4,20,"ng-template",null,15,uI)),2&e){var n=TP(2),r=GP(2).index,i=GP().index;AP("ngIf",GP().isKing(r,i))("ngIfElse",n)}}function uve(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",10),OP(2,ive,6,25,"g",11),OP(3,sve,3,2,"ng-template",null,12,uI),RP()),2&e){var n=TP(4),r=GP().index,i=GP().index,a=GP();Wb(1),qP("id","piece_",r,"_",i,""),AP("ngClass",a.viewInfo.pieceClasses[i][r]),_P("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),Wb(1),AP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function cve(e,t){if(1&e){var n=FP();zC(),xP(0,"g",3),BP("click",function(){var e=hC(n).index,t=GP().index;return GP().onClick(e,t)}),NP(1,"rect",4),OP(2,rve,4,2,"g",5),OP(3,uve,5,8,"g",5),RP()}if(2&e){var r=t.index,i=GP().index,a=GP();qP("id","click_",r,"_",i,""),_P("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),Wb(1),AP("ngClass",a.getRectClasses(r,i)),_P("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Wb(1),AP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),Wb(1),AP("ngIf",a.board[i][r]!==a.EMPTY)}}function lve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,cve,4,8,"g",2),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function fve(e,t){if(1&e){var n=FP();zC(),xP(0,"g"),xP(1,"rect",17),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e.x,e.y)}),RP(),RP()}if(2&e){var r=t.$implicit,i=GP();Wb(1),qP("id","click_",r.x,"_",r.y,""),_P("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var hve=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e,!1,qde.from)).rules=Yde.get(),r.availableMinimaxes=[new cre(r.rules,"DummyBot"),new dre(r.rules,"Piece > Influence"),new vre(r.rules,"Piece > Control"),new pre(r.rules,"Escape > Piece > Control")],r.encoder=qde.encoder,r.tutorial=(new eve).tutorial,r.updateBoard(),r}return Py(n)}(ure);return e.\u0275fac=function(t){return new(t||e)(IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-tablut"]],features:[cP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,lve,2,1,"g",1),OP(2,fve,2,6,"g",1),RP()),2&e&&(_P("viewBox",t.getViewBox()),Wb(1),AP("ngForOf",t.board),Wb(1),AP("ngForOf",t.getClickables()))},directives:[hM,lM,vM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dve=Py(function e(){by(this,e)});dve.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Bf||(Bf=ey(["You cannot put a new ring after the tenth turn."])))},dve.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(zf||(zf=ey(["You cannot put a marker in a ring before placing all of your rings."])))},dve.MISSING_CAPTURES=moe.MISSING_CAPTURES,dve.MOVE_DIRECTION_INVALID=function(){return $localize(Hf||(Hf=ey(["The direction of your move is invalid: a move is made along a straight line."])))},dve.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Gf||(Gf=ey(["You can only capture your own markers."])))},dve.SHOULD_SELECT_PLAYER_RING=function(){return $localize($f||($f=ey(["You must pick one of your own rings to move."])))},dve.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Zf||(Zf=ey(["Your ring must land on an empty space."])))},dve.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(qf||(qf=ey(["A ring can only jump over markers or empty spaces, not over another ring."])))},dve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Wf||(Wf=ey(["Your ring must land on the first empty space after a group of markers."])))},dve.AMBIGUOUS_CAPTURE_COORD=moe.AMBIGUOUS_CAPTURE_COORD,dve.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(jf||(jf=ey(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var vve=function(){function e(t,n){by(this,e),this.player=t,this.isRing=n}return Py(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return $7(!1===this.isRing,"cannot flip a ring (it should never happen)"),$7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return LB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===s9.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();vve.encoder=a9.tuple([u9.numberEncoder,a9.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return vve.of(e[0],e[1])}),vve.UNREACHABLE=new vve(s9.NONE,!1),vve.EMPTY=new vve(s9.NONE,!1),vve.MARKER_ZERO=new vve(u9.ZERO,!1),vve.MARKER_ONE=new vve(u9.ONE,!1),vve.MARKERS=[vve.MARKER_ZERO,vve.MARKER_ONE],vve.RING_ZERO=new vve(u9.ZERO,!0),vve.RING_ONE=new vve(u9.ONE,!0),vve.RINGS=[vve.RING_ZERO,vve.RING_ONE];var pve=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i){var a;return by(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],vve.EMPTY)).sideRings=r,a}return Py(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&h9.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==vve.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=h9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=vve.EMPTY,t=vve.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(Xie);return e.SIZE=11,e}(),gve=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;if(by(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=zB.ofNullable(r),vy(i)}return Py(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===cy(yy(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=Fte.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(voe);gve.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return Rte.encoder.encode(e)}),ringTaken:Rte.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return $7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new gve(t.captured.map(function(e){return Rte.encoder.decode(e)}),Rte.encoder.decode(t.ringTaken))}}]),n}(r9));var yve=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a){var o;return by(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return Py(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===h9.compareArray(this.initialCaptures,e.initialCaptures)||!1===h9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Cy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(jte);yve.coordOptionalEncoder=doe(Rte.encoder),yve.encoder=new(function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"encodeMove",value:function(e){var t={moveStart:Rte.encoder.encode(e.start),moveEnd:yve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=gve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=gve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return $7(null!=t.moveStart,"Invalid encoded YinshMove"),new yve(this.decodeArray(t,"initialCapture",gve.encoder.decode),Rte.encoder.decode(t.moveStart),yve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",gve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(i9));var mve=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?$te.fromWinner(t.winner):new $te(e.gameState.sideRings[0]*u9.ZERO.getScoreModifier()+e.gameState.sideRings[1]*u9.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Cy(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=iy(i.value,2),s=o[0];o[1]===vve.EMPTY&&n.push(new yve([],s,zB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new yve(e,r.start,zB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Coe.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){by(this,e)}return Py(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return $7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Cy(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new gve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Cy(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Cy(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===vve.RINGS[t]&&n.push(e)}),n}}]),n}(Gte),kve=function(e){fy(n,e);var t=dy(n);function n(){return by(this,n),t.apply(this,arguments)}return Py(n,[{key:"applyLegalMove",value:function(e,t,n){return new pve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new pve(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,vve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new pve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,vve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===vve.RINGS[n]?ZB.SUCCESS:ZB.failure(dve.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,vve.MARKERS[r]);i=i.setAt(t,vve.RINGS[r]);for(var a=Fte.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==vve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return HB.failure(dve.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():HB.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return HB.failure(dve.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==vve.EMPTY)return HB.failure(Hte.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,vve.of(n,!0)).board,a=new pve(i,r,e.turn);return HB.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==vve.RINGS[n]?ZB.failure(dve.SHOULD_SELECT_PLAYER_RING()):ZB.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==vve.EMPTY)return ZB.failure(dve.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=Fte.factory.fromMove(t,n);if(i.isFailure())return ZB.failure(dve.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===vve.EMPTY){if(o)return ZB.failure(dve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return ZB.failure(dve.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return ZB.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Cy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return ZB.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Cy(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==vve.MARKERS[r])return ZB.failure(dve.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==vve.RINGS[r]?ZB.failure(dve.CAPTURE_SHOULD_TAKE_RING()):ZB.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?ZB.SUCCESS:ZB.failure(dve.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?zB.of({start:s,end:r,dir:o}):zB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(gve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Cy(Fte.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===vve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?ene.ONGOING:e.gameState.sideRings[0]>=3?ene.ZERO_WON:e.gameState.sideRings[1]>=3?ene.ONE_WON:ene.ONGOING}}]),n}(tne),Cve=vve.EMPTY,wve=vve.UNREACHABLE,_ve=vve.MARKER_ZERO,bve=vve.RING_ZERO,Eve=vve.MARKER_ONE,Pve=vve.RING_ONE,Sve=function(){var e=Py(function e(){by(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Yf||(Yf=ey(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Kf||(Kf=ey(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),Ove=Py(function e(){by(this,e),this.tutorial=[ane.informational($localize(Qf||(Qf=ey(["Goal of the game"]))),$localize(Xf||(Xf=ey(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new pve([[wve,wve,wve,wve,wve,wve,Cve,Cve,Cve,Cve,wve],[wve,wve,wve,wve,Cve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,wve,_ve,Pve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,Cve,_ve,Cve,Pve,Cve,Eve,Cve,Cve,Cve],[wve,Cve,bve,Eve,Cve,Cve,Pve,_ve,Cve,Cve,Cve],[wve,Cve,Cve,_ve,Eve,Cve,Cve,Cve,Cve,Cve,wve],[Cve,Cve,Cve,_ve,Cve,Cve,Cve,Pve,Cve,Cve,wve],[Cve,Cve,Cve,Eve,_ve,bve,Cve,Cve,Cve,wve,wve],[Cve,Cve,Cve,Cve,Cve,Cve,Cve,Cve,wve,wve,wve],[Cve,Cve,Cve,Cve,Cve,Cve,Cve,wve,wve,wve,wve],[wve,Cve,Cve,Cve,Cve,wve,wve,wve,wve,wve,wve]],[3,1],20)),ane.anyMove($localize(Jf||(Jf=ey(["Initial board and placement phase"]))),$localize(eh||(eh=ey(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new pve(pve.getInitialState().board,[5,5],0),new yve([],new Rte(5,5),zB.empty(),[]),$localize(th||(th=ey(["Congratulations!"])))),ane.anyMove($localize(nh||(nh=ey(["Putting a marker"]))),$localize(rh||(rh=ey(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new pve([[wve,wve,wve,wve,wve,wve,Cve,Cve,Cve,Cve,wve],[wve,wve,wve,wve,Cve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,wve,Pve,Cve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,Pve,Cve,Cve,Pve,Cve,Cve,Cve,Cve,Cve],[wve,Cve,bve,Eve,Cve,Cve,Pve,Cve,Cve,Cve,Cve],[wve,Cve,Cve,Eve,Cve,Cve,Cve,Cve,Cve,Cve,wve],[Cve,Cve,Cve,Cve,bve,Cve,Cve,Pve,Cve,Cve,wve],[Cve,Cve,Cve,Cve,Cve,bve,Cve,Cve,Cve,wve,wve],[Cve,Cve,Cve,bve,Cve,Cve,Cve,wve,wve,wve,wve],[Cve,Cve,Cve,Cve,Cve,Cve,Cve,wve,wve,wve,wve],[wve,Cve,Cve,Cve,Cve,wve,wve,wve,wve,wve,wve]],[0,0],20),new yve([],new Rte(2,4),zB.of(new Rte(4,4)),[]),$localize(ih||(ih=ey(["Congratulations!"])))),ane.fromPredicate($localize(ah||(ah=ey(["Getting a ring by aligning 5 markers"]))),$localize(oh||(oh=ey(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new pve([[wve,wve,wve,wve,wve,wve,Cve,Cve,Cve,Cve,wve],[wve,wve,wve,wve,Cve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,wve,Pve,Cve,Cve,Cve,Cve,Cve,Cve,Cve],[wve,wve,Pve,Cve,Cve,Pve,Cve,Cve,Cve,Cve,Cve],[wve,Cve,_ve,_ve,bve,Eve,Eve,Cve,Cve,Cve,Cve],[wve,Cve,Cve,Pve,Cve,Cve,Cve,Cve,Cve,Cve,wve],[Cve,Cve,Cve,Cve,bve,Cve,Cve,Pve,Cve,Cve,wve],[Cve,Cve,Cve,Cve,Cve,bve,Cve,Cve,Cve,wve,wve],[Cve,Cve,Cve,bve,Cve,Cve,Cve,bve,wve,wve,wve],[Cve,Cve,Cve,Cve,Cve,Cve,Cve,wve,wve,wve,wve],[wve,Cve,Cve,Cve,Cve,wve,wve,wve,wve,wve,wve]],[0,0],20),new yve([],new Rte(4,4),zB.of(new Rte(7,4)),[gve.of(new Rte(2,4),new Rte(6,4),new Rte(7,4))]),function(e,t,n){return 1===n.sideRings[u9.ZERO.value]?ZB.SUCCESS:ZB.failure(Sve.MUST_ALIGN_FIVE())},$localize(sh||(sh=ey(["Congratulations!"])))),ane.fromPredicate($localize(uh||(uh=ey(["Compound captures"]))),$localize(ch||(ch=ey(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new pve([[wve,wve,wve,wve,wve,wve,Cve,Cve,Cve,Cve,wve],[wve,wve,wve,wve,bve,Cve,Cve,Pve,Pve,bve,Cve],[wve,wve,wve,bve,Cve,Cve,Eve,Pve,Cve,bve,Cve],[wve,wve,Cve,bve,Cve,Cve,Cve,Cve,Cve,Pve,Cve],[wve,Cve,Cve,Cve,Cve,_ve,Cve,Cve,Pve,Cve,Cve],[wve,Cve,Cve,Cve,_ve,_ve,Cve,Eve,Cve,Cve,wve],[Cve,Cve,Cve,_ve,Cve,_ve,Cve,Cve,Cve,Cve,wve],[Cve,Cve,_ve,Cve,Cve,_ve,Cve,Cve,Cve,wve,wve],[Cve,_ve,Cve,Cve,Cve,_ve,Cve,Cve,wve,wve,wve],[Cve,Cve,Cve,Cve,Cve,_ve,Cve,wve,wve,wve,wve],[wve,Cve,Cve,Cve,Cve,wve,wve,wve,wve,wve,wve]],[0,0],10),new yve([gve.of(new Rte(5,4),new Rte(1,8),new Rte(3,2)),gve.of(new Rte(5,9),new Rte(5,5),new Rte(3,3))],new Rte(4,1),zB.of(new Rte(4,2)),[]),function(e,t,n){return 2===n.sideRings[u9.ZERO.value]?ZB.SUCCESS:ZB.failure(Sve.MUST_CAPTURE_TWO())},$localize(lh||(lh=ey(["Congratulations!"]))))]});function Tve(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=GP(2).$implicit,r=GP(2);_P("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Ive(e,t){if(1&e&&(zC(),NP(0,"circle",13)),2&e){var n=GP(2),r=n.index,i=n.$implicit,a=GP().index,o=GP();qP("id","ring_",r,"_",a,""),AP("ngClass",i.ringClasses),_P("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Ave(e,t){if(1&e&&(zC(),NP(0,"circle",12)),2&e){var n=GP(2).$implicit,r=GP(2);_P("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Mve(e,t){if(1&e&&(zC(),NP(0,"circle",14)),2&e){var n=GP(2),r=n.index,i=n.$implicit,a=GP().index,o=GP();qP("id","marker_",r,"_",a,""),AP("ngClass",i.markerClasses),_P("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function xve(e,t){if(1&e){var n=FP();zC(),xP(0,"g",6),BP("click",function(){hC(n);var e=GP().$implicit;return GP(2).onClick(e.coord)}),NP(1,"polygon",7),xP(2,"g",8),OP(3,Tve,1,3,"circle",9),OP(4,Ive,1,6,"circle",10),OP(5,Ave,1,3,"circle",9),OP(6,Mve,1,6,"circle",11),RP(),RP()}if(2&e){var r=GP(),i=r.index,a=r.$implicit,o=GP().index;qP("id","click_",i,"_",o,""),Wb(1),qP("id","space_",i,"_",o,""),AP("ngClass",a.spaceClasses),_P("points",a.coordinates),Wb(1),qP("id","pieceGroup_",i,"_",o,""),AP("ngClass",a.removedClass),Wb(1),AP("ngIf",a.isRing),Wb(1),AP("ngIf",a.isRing),Wb(1),AP("ngIf",a.isRing),Wb(1),AP("ngIf",a.isMarker)}}function Rve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,xve,7,13,"g",5),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngIf",null!=n)}}function Nve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Rve,2,1,"g",1),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}function Dve(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",15),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","selected_",r.x,"_",r.y,""),_P("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Lve(e,t){if(1&e){var n=FP();zC(),xP(0,"polygon",17),BP("click",function(){var e=hC(n).$implicit;return GP(2).onClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP(2);qP("id","selectable_",r.x,"_",r.y,""),_P("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Fve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Lve,1,3,"polygon",16),RP()),2&e){var n=GP();Wb(1),AP("ngForOf",n.viewInfo.selectableCoords)}}function Uve(e,t){if(1&e){var n=FP();zC(),xP(0,"rect",18),BP("click",function(){var e=hC(n).$implicit;return GP().onClick(e)}),RP()}if(2&e){var r=t.$implicit,i=GP();qP("id","indicator_",r.x,"_",r.y,""),_P("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Vve(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",19),NP(2,"circle",12),NP(3,"circle",20),RP()),2&e){var n=t.index,r=GP().$implicit,i=GP();Wb(1),qP("id","player_",r.value,"_sideRing_",n+1,""),_P("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringOuterSize),Wb(1),_P("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringInnerSize),Wb(1),AP("ngClass",i.viewInfo.sideRingClass[r.value]),_P("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringMidSize)}}var Bve=function(){return[]};function zve(e,t){if(1&e&&(zC(),xP(0,"g"),OP(1,Vve,4,12,"g",1),RP()),2&e){var n=t.$implicit,r=GP();_P("transform","rotate("+180*r.role.value+" 532.5 780)"),Wb(1),AP("ngForOf",FT(2,Bve).constructor(r.viewInfo.sideRings[n.value]))}}var Hve=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=zB.empty(),r.moveEnd=zB.empty(),r.currentlyMoved=[],r.currentCapture=zB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=zB.of([0,0]),r.rules=new kve(pve),r.availableMinimaxes=[new mve(r.rules,"YinshMinimax")],r.encoder=yve.encoder,r.tutorial=(new Ove).tutorial,r.hexaLayout=new Ute(1.5*n.RING_OUTER_SIZE,new Rte(2*n.RING_OUTER_SIZE,0),zte.INSTANCE),r.constructedState=r.getState(),r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return Py(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt();var e=this.getState();this.scores=zB.of(e.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=Cy(u9.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Cy(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Cy(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Cy(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Cy(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved-fill"]:[]}},{key:"setRingInfo",value:function(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==vve.EMPTY&&(!t.isRing||this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=zB.empty(),this.moveStart=zB.empty(),this.moveEnd=zB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved-fill"];else{var r,i=Cy(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved-fill"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=Fte.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==vve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Cy(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(i,this.getState().getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),ZB.SUCCESS}},{key:"onClick",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(dve.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",ZB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Cy(e);try{for(n.s();!(t=n.n()).done;){var r,i=Cy(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(LB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(dve.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(dve.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=zB.of(e),this.constructedState=new pve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":($7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),ZB.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Cy(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.getState().getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,vve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,vve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=zB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),ZB.SUCCESS)):(LB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),ZB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),ZB.SUCCESS}},{key:"tryMove",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new yve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.getState(),e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=zB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=zB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",ZB.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.moveStart.equalsValue(e)){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),ZB.SUCCESS));case 2:if(r=vve.RINGS[t.getState().getCurrentPlayer().value],t.constructedState.getPieceAt(e)!==r){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),t.selectMoveStart(e)));case 5:return i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=zB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 7:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),ZB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Dte);function Gve(e,t){if(1&e&&(xP(0,"option",5),pS(1),RP()),2&e){var n=t.$implicit;AP("value",n.urlName),Wb(1),gS(n.name)}}Hve.RING_OUTER_SIZE=40,Hve.RING_MID_SIZE=34,Hve.RING_INNER_SIZE=28,Hve.MARKER_SIZE=Hve.RING_INNER_SIZE,Hve.INDICATOR_SIZE=10,Hve.\u0275fac=function(e){return new(e||Hve)(IP(H7))},Hve.\u0275cmp=wk({type:Hve,selectors:[["app-yinsh"]],features:[cP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(zC(),xP(0,"svg",0),OP(1,Nve,2,1,"g",1),OP(2,Dve,1,3,"polygon",2),OP(3,Fve,2,1,"g",3),OP(4,Uve,1,6,"rect",4),OP(5,zve,2,3,"g",1),RP()),2&e&&(Wb(1),AP("ngForOf",t.viewInfo.spaceInfo),Wb(1),AP("ngForOf",t.viewInfo.selectedCoords),Wb(1),AP("ngIf",t.isPlayerTurn()),Wb(1),AP("ngForOf",t.viewInfo.targets),Wb(1),AP("ngForOf",t.Player.PLAYERS))},directives:[hM,vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var $ve=function(){var e=Py(function e(){by(this,e)});return e.ABALONE=function(){return $localize(fh||(fh=ey(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(hh||(hh=ey(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(dh||(dh=ey(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(vh||(vh=ey(["The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.COERCEO=function(){return $localize(ph||(ph=ey(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(gh||(gh=ey(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(yh||(yh=ey(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(mh||(mh=ey(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(kh||(kh=ey(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(Ch||(Ch=ey(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(wh||(wh=ey(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(_h||(_h=ey(["The oldest strategy game still practiced widely. A territory control game."])))},e.HNEFATAFL=function(){return $localize(bh||(bh=ey(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.KAMISADO=function(){return $localize(Eh||(Eh=ey(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(Ph||(Ph=ey(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(Sh||(Sh=ey(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(Oh||(Oh=ey(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(Th||(Th=ey(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(Ih||(Ih=ey(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(Ah||(Ah=ey(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(Mh||(Mh=ey(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(xh||(xh=ey(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(Rh||(Rh=ey(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(Nh||(Nh=ey(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(Dh||(Dh=ey(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(Lh||(Lh=ey(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(Fh||(Fh=ey(["Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(Uh||(Uh=ey(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Zve=function(){var e=Py(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];by(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Qce,new Date("1970-01-01"),"",!1),new e($localize(Vh||(Vh=ey(["Four in a Row"]))),"P4",hle,new Date("2018-08-28"),$ve.P4()),new e($localize(Bh||(Bh=ey(["Awal\xe9"]))),"Awale",Kne,new Date("2018-11-29"),$ve.AWALE()),new e($localize(zh||(zh=ey(["Quarto"]))),"Quarto",jfe,new Date("2018-12-09"),$ve.QUARTO()),new e($localize(Hh||(Hh=ey(["Tablut"]))),"Tablut",hve,new Date("2018-12-27"),$ve.TABLUT()),new e($localize(Gh||(Gh=ey(["Reversi"]))),"Reversi",_he,new Date("2019-01-16"),$ve.REVERSI()),new e($localize($h||($h=ey(["Go"]))),"Go",cse,new Date("2019-12-21"),$ve.GO()),new e($localize(Zh||(Zh=ey(["Encapsule"]))),"Encapsule",Kae,new Date("2019-12-30"),$ve.ENCAPSULE()),new e($localize(qh||(qh=ey(["Siam"]))),"Siam",_de,new Date("2020-01-11"),$ve.SIAM()),new e($localize(Wh||(Wh=ey(["Sahara"]))),"Sahara",$he,new Date("2020-02-29"),$ve.SAHARA()),new e($localize(jh||(jh=ey(["Pylos"]))),"Pylos",rfe,new Date("2020-10-02"),$ve.PYLOS()),new e($localize(Yh||(Yh=ey(["Kamisado"]))),"Kamisado",fue,new Date("2020-10-03"),$ve.KAMISADO()),new e($localize(Kh||(Kh=ey(["Quixo"]))),"Quixo",uhe,new Date("2020-10-15"),$ve.QUIXO()),new e($localize(Qh||(Qh=ey(["Dvonn"]))),"Dvonn",Sae,new Date("2020-10-21"),$ve.DVONN()),new e($localize(Xh||(Xh=ey(["Epaminondas"]))),"Epaminondas",hoe,new Date("2021-01-16"),$ve.EPAMINONDAS()),new e($localize(Jh||(Jh=ey(["Gipf"]))),"Gipf",Doe,new Date("2021-02-22"),$ve.GIPF()),new e($localize(ed||(ed=ey(["Coerceo"]))),"Coerceo",sie,new Date("2021-03-21"),$ve.COERCEO()),new e($localize(td||(td=ey(["Six"]))),"Six",Zde,new Date("2021-04-08"),$ve.SIX()),new e($localize(nd||(nd=ey(["Lines of Action"]))),"LinesOfAction",Pue,new Date("2021-04-28"),$ve.LINES_OF_ACTION()),new e($localize(rd||(rd=ey(["Pentago"]))),"Pentago",xle,new Date("2021-05-23"),$ve.PENTAGO()),new e($localize(id||(id=ey(["Abalone"]))),"Abalone",Ene,new Date("2021-07-13"),$ve.ABALONE()),new e($localize(ad||(ad=ey(["Yinsh"]))),"Yinsh",Hve,new Date("2021-07-31"),$ve.YINSH()),new e($localize(od||(od=ey(["Apagos"]))),"Apagos",Vne,new Date("2021-11-04"),$ve.APAGOS()),new e($localize(sd||(sd=ey(["Diam"]))),"Diam",Kie,new Date("2021-11-30"),$ve.DIAM()),new e($localize(ud||(ud=ey(["Brandhub"]))),"Brandhub",xre,new Date("2021-12-07"),$ve.BRANDHUB()),new e($localize(cd||(cd=ey(["Conspirateurs"]))),"Conspirateurs",Tie,new Date("2021-12-30"),$ve.CONSPIRATEURS()),new e($localize(ld||(ld=ey(["Lodestone"]))),"Lodestone",ice,new Date("2022-06-24"),$ve.LODESTONE()),new e($localize(fd||(fd=ey(["Martian Chess"]))),"MartianChess",Bce,new Date("2022-07-01"),$ve.MARTIAN_CHESS()),new e($localize(hd||(hd=ey(["Hnefatafl"]))),"Hnefatafl",Ase,new Date("2022-09-21"),$ve.HNEFATAFL())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),qve=function(){var e=function(){function e(){by(this,e),this.games=Zve.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new qT}return Py(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=wk({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(dd||(dd=ey(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"select",1),BP("change",function(e){return t.onChange(e)}),xP(2,"option",2),bO(3,3),RP(),OP(4,Gve,2,2,"option",4),RP(),RP()),2&e&&(Wb(4),AP("ngForOf",t.games))},directives:[LR,BR,hM],encapsulation:2}),e}();function Wve(e,t){if(1&e){var n=FP();xP(0,"div",26),xP(1,"div",27),BP("click",function(){return hC(n),GP().closeInfo()}),RP(),xP(2,"div",28),xP(3,"header",29),xP(4,"p",30),pS(5),RP(),xP(6,"button",31),BP("click",function(){return hC(n),GP().closeInfo()}),RP(),RP(),xP(7,"section",32),xP(8,"div",6),xP(9,"div",33),xP(10,"p",34),NP(11,"img",35),RP(),RP(),xP(12,"div",7),xP(13,"div",13),pS(14),RP(),RP(),RP(),xP(15,"div",6),xP(16,"div",33),xP(17,"a",36),BP("click",function(){hC(n);var e=GP();return e.createGame(e.gameInfoDetails.get().urlName)}),NP(18,"fa-icon",37),pS(19,"\xa0"),xP(20,"span"),bO(21,38),RP(),RP(),RP(),xP(22,"div",33),xP(23,"a",36),BP("click",function(){hC(n);var e=GP();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),NP(24,"fa-icon",37),pS(25,"\xa0"),xP(26,"span"),bO(27,39),RP(),RP(),RP(),xP(28,"div",33),xP(29,"a",36),BP("click",function(){hC(n);var e=GP();return e.createTutorial(e.gameInfoDetails.get().urlName)}),NP(30,"fa-icon",37),pS(31,"\xa0"),xP(32,"span"),bO(33,40),RP(),RP(),RP(),RP(),RP(),RP(),RP()}if(2&e){var r=GP();Wb(5),gS(r.gameInfoDetails.get().name),Wb(6),qP("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",B_),Wb(3),yS(" ",r.gameInfoDetails.get().description," "),Wb(4),AP("icon",r.iconOnlineGame),Wb(6),AP("icon",r.iconLocalGame),Wb(6),AP("icon",r.iconTutorial)}}function jve(e,t){if(1&e){var n=FP();xP(0,"div",8),xP(1,"div",9),xP(2,"p",10),pS(3),RP(),RP(),xP(4,"div",42),xP(5,"figure",34),xP(6,"img",43),BP("click",function(){var e=hC(n).$implicit;return GP(2).openInfo(e)}),RP(),xP(7,"figcaption",44),BP("click",function(){var e=hC(n).$implicit;return GP(2).openInfo(e)}),xP(8,"div",45),pS(9,"?"),RP(),RP(),xP(10,"figcaption",46),xP(11,"a",47),BP("click",function(){var e=hC(n).$implicit;return GP(2).createGame(e.urlName)}),NP(12,"fa-icon",37),RP(),xP(13,"a",48),BP("click",function(){var e=hC(n).$implicit;return GP(2).createLocalGame(e.urlName)}),NP(14,"fa-icon",37),RP(),xP(15,"a",49),BP("click",function(){var e=hC(n).$implicit;return GP(2).createTutorial(e.urlName)}),NP(16,"fa-icon",37),RP(),RP(),RP(),RP(),xP(17,"div",50),pS(18),RP(),RP()}if(2&e){var r=t.$implicit,i=GP(2);Wb(3),gS(r.name),Wb(3),ZP("id","image_",r.urlName,""),qP("src","assets/images/",i.theme,"/",r.urlName,".png",B_),Wb(5),ZP("id","playOnline_",r.urlName,""),Wb(1),AP("icon",i.iconOnlineGame),Wb(1),ZP("id","playLocally_",r.urlName,""),Wb(1),AP("icon",i.iconLocalGame),Wb(1),ZP("id","startTutorial_",r.urlName,""),Wb(1),AP("icon",i.iconTutorial),Wb(2),yS(" ",r.description," ")}}function Yve(e,t){if(1&e&&(xP(0,"div",7),OP(1,jve,19,11,"div",41),RP()),2&e){var n=t.$implicit;Wb(1),AP("ngForOf",n)}}var Kve=function(){var e=function(){function e(t,n,r,i){by(this,e),this.router=t,this.messageDisplayer=n,this.observedPartService=r,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=T9,this.iconLocalGame=S9,this.iconTutorial=E9,this.gameInfoDetails=zB.empty(),this.theme=i.getTheme();for(var a=Zve.ALL_GAMES().filter(function(e){return!0===e.display}),o=0,s=0;s<a.length;s++)s<this.numberOfColumns&&this.games.push([]),this.games[o].push(a[s]),o=(o+1)%this.numberOfColumns}return Py(e,[{key:"createGame",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.observedPartService.canUserCreate(),n.abrupt("return",r.isSuccess()?t.router.navigate(null==e?["/play"]:["/play",e]):(t.messageDisplayer.criticalMessage(r.getReason()),!1));case 2:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=zB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=zB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(H7),IP(D9),IP(b9))},e.\u0275cmp=wk({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(vd||(vd=ey(["EveryBoard"]))),[1,"subtitle"],$localize(pd||(pd=ey(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(gd||(gd=ey(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],$localize(yd||(yd=ey(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(md||(md=ey(["See the game list"]))),$localize(kd||(kd=ey(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Cd||(Cd=ey(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(wd||(wd=ey(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(_d||(_d=ey(["Play online"]))),$localize(bd||(bd=ey(["Play offline"]))),$localize(Ed||(Ed=ey(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(Pd||(Pd=ey(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Sd||(Sd=ey(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Od||(Od=ey(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(xP(0,"section",0),xP(1,"div",1),xP(2,"p",2),bO(3,3),RP(),xP(4,"p",4),wO(5,5),NP(6,"br"),_O(),RP(),RP(),xP(7,"div",6),xP(8,"div",7),xP(9,"div",8),xP(10,"header",9),xP(11,"p",10),bO(12,11),RP(),RP(),xP(13,"div",12),xP(14,"div",13),xP(15,"button",14),BP("click",function(){return t.createGame()}),bO(16,15),RP(),xP(17,"button",16),bO(18,17),RP(),RP(),RP(),RP(),RP(),xP(19,"div",7),xP(20,"div",8),xP(21,"header",9),xP(22,"p",10),bO(23,18),RP(),RP(),xP(24,"div",12),xP(25,"div",19),xP(26,"button",20),bO(27,21),RP(),xP(28,"button",22),bO(29,23),RP(),RP(),RP(),RP(),RP(),RP(),OP(30,Wve,34,7,"div",24),xP(31,"div",6),OP(32,Yve,2,1,"div",25),RP(),RP()),2&e&&(Wb(30),AP("ngIf",t.gameInfoDetails.isPresent()),Wb(2),AP("ngForOf",t.games))},directives:[SF,vM,hM,ate],encapsulation:2}),e}(),Qve=function(){var e=function(){function e(t){by(this,e),this.element=t}return Py(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(BO))},e.\u0275dir=Ok({type:e,selectors:[["","autofocus",""]]}),e}(),Xve=function(){var e=function(){function e(t){var n=this;by(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return Py(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(BO))},e.\u0275dir=Ok({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Jve(e,t){if(1&e&&(xP(0,"div",29),xP(1,"div",30),bO(2,31),RP(),xP(3,"div",32),pS(4),RP(),RP()),2&e){var n=GP();Wb(4),gS(n.errorMessage)}}var epe=function(){return["/register"]},tpe=function(){return["/reset-password"]},npe=function(){var e=function(){function e(t,n){by(this,e),this.router=t,this.connectedUserService=n,this.faEye=O9,this.loginForm=new gR({email:new pR,password:new pR})}return Py(e,[{key:"ngOnInit",value:function(){var e,t=this;this.userSubscription=this.connectedUserService.subscribeToUser((e=DB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==K7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(Q7))},e.\u0275cmp=wk({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(Td||(Td=ey(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Id||(Id=ey(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(Ad||(Ad=ey(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(Md||(Md=ey(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(xd||(xd=ey(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Rd||(Rd=ey(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(Nd||(Nd=ey(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(Dd||(Dd=ey(["No account?"]))),[3,"routerLink"],$localize(Ld||(Ld=ey(["Register"]))),$localize(Fd||(Fd=ey(["Forgot your password?"]))),$localize(Ud||(Ud=ey(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Vd||(Vd=ey(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"p",1),bO(2,2),RP(),xP(3,"form",3),xP(4,"div",4),xP(5,"div",5),xP(6,"label",6),bO(7,7),RP(),RP(),xP(8,"div",8),xP(9,"div",9),xP(10,"div",10),NP(11,"input",11),RP(),RP(),RP(),RP(),xP(12,"div",4),xP(13,"div",5),xP(14,"label",12),bO(15,13),RP(),RP(),xP(16,"div",8),xP(17,"div",9),xP(18,"div",14),NP(19,"input",15),xP(20,"span",16),NP(21,"fa-icon",17),RP(),RP(),RP(),RP(),RP(),xP(22,"div",4),NP(23,"div",5),xP(24,"div",8),xP(25,"div",9),xP(26,"div",10),xP(27,"button",18),BP("click",function(){return t.loginWithEmail(t.loginForm.value)}),bO(28,19),RP(),RP(),RP(),RP(),RP(),xP(29,"div",4),NP(30,"div",5),xP(31,"div",8),xP(32,"div",9),xP(33,"div",10),xP(34,"button",20),BP("click",function(){return t.loginWithGoogle()}),bO(35,21),RP(),RP(),RP(),RP(),RP(),OP(36,Jve,5,1,"div",22),xP(37,"p",23),DP(38),bO(39,24),LP(),pS(40,"\xa0 "),xP(41,"a",25),bO(42,26),RP(),RP(),xP(43,"p",23),DP(44),bO(45,27),LP(),pS(46,"\xa0 "),xP(47,"a",25),bO(48,28),RP(),RP(),RP(),RP()),2&e&&(Wb(3),AP("formGroup",t.loginForm),Wb(18),AP("icon",t.faEye),Wb(6),AP("disabled",!t.canLogin()),Wb(9),AP("ngIf",t.errorMessage),Wb(5),AP("routerLink",FT(6,epe)),Wb(6),AP("routerLink",FT(7,tpe)))},directives:[ER,qx,AR,px,Zx,xR,Qve,HR,ate,Xve,vM,OF],encapsulation:2}),e}(),rpe=function(){var e=function(){function e(t){by(this,e),this.partDAO=t}return Py(e,[{key:"subscribeToActiveParts",value:function(e){var t=[],n=new v9(function(n){var r;t=(r=t).concat.apply(r,my(n)),e(t)},function(n){var r,i=t,a=Cy(n);try{var o=function(){var e=r.value;i.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)},function(n){var r,i=[],a=Cy(t);try{var o=function(){var e=r.value;n.some(function(t){return t.id===e.id})||i.push(e)};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)});return this.partDAO.observingWhere([["result","==",X7.UNACHIEVED.value]],n)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(d9))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),ipe=function(){var e=function(){function e(t){by(this,e),this.userDAO=t}return Py(e,[{key:"subscribeToActiveUsers",value:function(t){var n=this;FB(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");var r=[],i=new v9(function(i){var a;FB(e.VERBOSE,"our DAO gave us "+i.length+" new user(s)"),r=n.sort((a=r).concat.apply(a,my(i))),t(r)},function(i){var a=r;FB(e.VERBOSE,"our DAO updated "+i.length+" user(s)");var o,s=Cy(i);try{var u=function(){var e=o.value;a.forEach(function(t){t.id===e.id&&(t.data=e.data)}),a=n.sort(a)};for(s.s();!(o=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}t(r=a)},function(e){r=r.filter(function(t){return!e.some(function(e){return e.id===t.id})}),t(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],i)}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=LB.getNonNullable(e.data).lastUpdateTime,r=LB.getNonNullable(n).seconds,i=LB.getNonNullable(t.data).lastUpdateTime;return r-LB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ww(Z7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ape=function(){var e=function(){function e(t,n,r){by(this,e),this.router=t,this.observedPartService=n,this.messageDisplayer=r}return Py(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.observedPartService.canUserCreate()).isSuccess()){t.next=6;break}return t.next=4,e.router.navigate(["/play",e.selectedGame]);case 4:t.next=7;break;case 6:e.messageDisplayer.criticalMessage(n.getReason());case 7:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(D9),IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Bd||(Bd=ey(["Create an online game"])))]},template:function(e,t){1&e&&(xP(0,"app-pick-game",0),BP("pickGame",function(e){return t.pickGame(e)}),RP(),xP(1,"button",1),BP("click",function(){return t.navigateToOnlineGameCreation()}),bO(2,2),RP()),2&e&&(Wb(1),AP("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),ope=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"transform",value:function(e){return ZA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Tk({name:"firebaseDate",type:e,pure:!0}),e}(),spe=["chatDiv"];function upe(e,t){1&e&&(DP(0),bO(1,5),LP())}function cpe(e,t){1&e&&bO(0,6),2&e&&(EO(GP().unreadMessagesText),PO(0))}function lpe(e,t){if(1&e){var n=FP();xP(0,"button",11),BP("click",function(){return hC(n),GP(2).scrollToBottom()}),pS(1),RP()}if(2&e){var r=GP(2);Wb(1),yS("",r.unreadMessagesText," \u2193")}}function fpe(e,t){if(1&e&&(xP(0,"p"),pS(1),zT(2,"firebaseDate"),xP(3,"b",12),pS(4),RP(),xP(5,"span",13),pS(6),RP(),RP()),2&e){var n=t.$implicit;Wb(1),yS(" [",HT(2,3,n.postedTime),"] "),Wb(3),yS("",n.sender.name," : "),Wb(2),gS(n.content)}}function hpe(e,t){if(1&e){var n=FP();xP(0,"div"),OP(1,lpe,2,1,"button",7),xP(2,"div",8,9),BP("scroll",function(){return hC(n),GP().updateCurrentScrollPosition()}),OP(4,fpe,7,5,"p",10),RP(),RP()}if(2&e){var r=GP();Wb(1),AP("ngIf",r.showUnreadMessagesButton),Wb(3),AP("ngForOf",r.chat)}}var dpe=function(){return{standalone:!0}};function vpe(e,t){if(1&e){var n=FP();xP(0,"form",14),BP("onSubmit",function(){return hC(n),GP().sendMessage()}),xP(1,"div",15),xP(2,"div",16),xP(3,"input",17,18),BP("ngModelChange",function(e){return hC(n),GP().userMessage=e}),RP(),xP(5,"p",19),pS(6),RP(),RP(),xP(7,"div",20),xP(8,"button",21),BP("click",function(){return hC(n),GP().sendMessage()}),NP(9,"fa-icon",22),RP(),RP(),RP(),xP(10,"div",23),xP(11,"p"),xP(12,"strong"),bO(13,24),RP(),RP(),RP(),RP()}if(2&e){var r=TP(4),i=GP();Wb(3),AP("ngModel",i.userMessage)("ngModelOptions",FT(4,dpe)),Wb(3),yS("",r.value.length,"/128"),Wb(3),AP("icon",i.faReply)}}var ppe=function(){var e=function(){function e(t,n){by(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=I9,this.isNearBottom=!0,this.notYetScrolled=!0,FB(e.VERBOSE,"ChatComponent constructor")}return Py(e,[{key:"ngOnInit",value:function(){FB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),$7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new v9(t,t,function(){});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(zd||(zd=ey(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(Hd||(Hd=ey(["1 new message"]))):$localize(Gd||(Gd=ey([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(e.chatId,r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatSubscription.unsubscribe()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(V7),IP(Q7))},e.\u0275cmp=wk({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&aI(spe,5),2&e)&&(iI(n=oI())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize($d||($d=ey(["Hide chat"]))),$localize(Zd||(Zd=ey(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(qd||(qd=ey(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Wd||(Wd=ey(["Be polite"])))]},template:function(e,t){if(1&e&&(xP(0,"div"),xP(1,"button",0),BP("click",function(){return t.switchChatVisibility()}),OP(2,upe,2,0,"ng-container",1),OP(3,cpe,1,1,"ng-template",null,2,uI),RP(),OP(5,hpe,5,2,"div",3),OP(6,vpe,14,5,"form",4),RP()),2&e){var n=TP(4);Wb(2),AP("ngIf",t.visible)("ngIfElse",n),Wb(3),AP("ngIf",t.visible),Wb(1),AP("ngIf",t.visible)}},directives:[vM,hM,ER,qx,CR,px,$R,Zx,bR,ate],pipes:[ope],encapsulation:2}),e}();function gpe(e,t){if(1&e&&(DP(0),pS(1),LP()),2&e){var n=GP().$implicit;Wb(1),gS(n.data.playerOne.name)}}function ype(e,t){1&e&&(DP(0),bO(1,26),LP())}function mpe(e,t){if(1&e){var n=FP();xP(0,"tr",22),BP("click",function(){var e=hC(n).$implicit;return GP(2).joinGame(e)}),xP(1,"td",23),pS(2),RP(),xP(3,"td",23),pS(4),RP(),xP(5,"td",23),OP(6,gpe,2,1,"ng-container",24),OP(7,ype,2,0,"ng-template",null,25,uI),RP(),xP(9,"td",23),pS(10),RP(),RP()}if(2&e){var r=t.$implicit,i=t.index,a=TP(8);ZP("id","part_",i,""),Wb(2),gS(r.data.typeGame),Wb(2),gS(r.data.playerZero.name),Wb(2),AP("ngIf",r.data.playerOne)("ngIfElse",a),Wb(4),gS(r.data.turn)}}function kpe(e,t){if(1&e&&(xP(0,"div",13),xP(1,"div",14),xP(2,"table",15),xP(3,"thead"),xP(4,"tr"),xP(5,"th",16),bO(6,17),RP(),xP(7,"th",16),bO(8,18),RP(),xP(9,"th",16),bO(10,19),RP(),xP(11,"th",16),bO(12,20),RP(),RP(),RP(),xP(13,"tbody"),OP(14,mpe,11,6,"tr",21),RP(),RP(),RP(),RP()),2&e){var n=GP();Wb(14),AP("ngForOf",n.activeParts)}}function Cpe(e,t){1&e&&(xP(0,"div",27),NP(1,"app-online-game-selection",28),RP())}function wpe(e,t){if(1&e&&(xP(0,"li",39),pS(1),zT(2,"firebaseDate"),RP()),2&e){var n=GP().$implicit;$P("id",n.data.username),Wb(1),mS("",n.data.username,": ",HT(2,3,n.data.lastUpdateTime),"")}}function _pe(e,t){if(1&e&&(DP(0),OP(1,wpe,3,5,"li",38),LP()),2&e){var n=t.$implicit;Wb(1),AP("ngIf",n.data.lastUpdateTime)}}function bpe(e,t){if(1&e&&(xP(0,"div",29),xP(1,"div",30),xP(2,"div",31),NP(3,"app-chat",32),RP(),RP(),xP(4,"div",33),xP(5,"div",34),xP(6,"p"),bO(7,35),RP(),xP(8,"ul",36),OP(9,_pe,2,1,"ng-container",37),RP(),RP(),RP(),RP()),2&e){var n=GP();Wb(3),AP("turn",-1),Wb(6),AP("ngForOf",n.activeUsers)}}var Epe=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.router=t,this.messageDisplayer=n,this.activePartsService=r,this.activeUsersService=i,this.observedPartService=a,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}return Py(e,[{key:"ngOnInit",value:function(){var t=this;FB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(function(e){t.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(function(e){t.activeParts=e}),this.observedPartService.subscribeToObservedPart(function(e){t.createTabClasses=[],e.isPresent()&&(t.createTabClasses=["disabled-tab"])})}},{key:"ngOnDestroy",value:function(){FB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}},{key:"joinGame",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.id,i=e.data.typeGame,!(a=t.observedPartService.canUserJoin(r,null!=e.data.beginning)).isSuccess()){n.next=6;break}return n.next=4,t.router.navigate(["/play",i,r]);case 4:n.next=7;break;case 6:t.messageDisplayer.criticalMessage(a.getReason());case 7:case"end":return n.stop()}},n)}))()}},{key:"selectTab",value:function(e){if("create"===e){var t=this.observedPartService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(EF),IP(H7),IP(rpe),IP(ipe),IP(D9))},e.\u0275cmp=wk({type:e,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){return[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(jd||(jd=ey(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],$localize(Yd||(Yd=ey(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Kd||(Kd=ey(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Qd||(Qd=ey(["Game"]))),$localize(Xd||(Xd=ey(["First player"]))),$localize(Jd||(Jd=ey(["Second player"]))),$localize(ev||(ev=ey(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(tv||(tv=ey(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(nv||(nv=ey(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"ul"),xP(2,"li",1),xP(3,"a",2),BP("click",function(){return t.selectTab("games")}),bO(4,3),RP(),RP(),xP(5,"li",4),xP(6,"a",5),BP("click",function(){return t.selectTab("create")}),bO(7,6),RP(),RP(),xP(8,"li",7),xP(9,"a",8),BP("click",function(){return t.selectTab("chat")}),bO(10,9),RP(),RP(),RP(),RP(),OP(11,kpe,15,1,"div",10),OP(12,Cpe,2,0,"div",11),OP(13,bpe,10,2,"div",12)),2&e&&(Wb(6),AP("ngClass",t.createTabClasses),Wb(5),AP("ngIf","games"===t.currentTab),Wb(1),AP("ngIf","create"===t.currentTab),Wb(1),AP("ngIf","chat"===t.currentTab))},directives:[lM,vM,hM,ape,ppe],pipes:[ope],encapsulation:2}),e}(),Ppe=function(){var e=Py(function e(t){var n;by(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(rv||(rv=ey(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(IP(rL))},e.\u0275cmp=wk({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(iv||(iv=ey(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"div",1),bO(2,2),RP(),xP(3,"div",3),pS(4),RP(),RP()),2&e&&(Wb(4),gS(t.message))},encapsulation:2}),e}();function Spe(e,t){}var Ope=function(){var e=Py(function e(t){by(this,e),this.viewContainerRef=t,FB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(bT))},e.\u0275cmp=wk({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&OP(0,Spe,0,0,"ng-template")},encapsulation:2}),e}(),Tpe=function(){var e=function(){function e(){by(this,e)}return Py(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(av||(av=ey(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(ov||(ov=ey(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(sv||(sv=ey(["You cannot clone a game. This feature might be implemented later."])))},e}(),Ipe=function(){var e=function(){function e(t,n,r,i,a){by(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[zB.empty(),zB.empty()],this.role=s9.NONE,this.endGame=!1,this.Player=u9,FB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return Py(e,[{key:"getMatchingComponent",value:function(t){return FB(e.VERBOSE,"GameWrapper.getMatchingComponent"),zB.ofNullable(Zve.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return FB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&(t.gameComponent.rules.setInitialBoard(),t.gameComponent.updateBoard()),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(FB(e.VERBOSE,{m:"GameWrapper.createGameComponent",that:t}),r=LB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",Tpe.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return $7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.setRole(t.role),t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"setRole",value:function(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(FB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",ZB.failure(Tpe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",ZB.failure($localize(uv||(uv=ey(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),ZB.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:FB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=ZB.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.role===s9.NONE){var t=Tpe.NO_CLONING_FEATURE();return ZB.failure(t)}return this.isPlayerTurn()?ZB.SUCCESS:ZB.failure(Tpe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.role===s9.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.getTurn(),n=t%2,r=this.getPlayer();return FB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.role,areYouPlayer:this.players[n].isPresent()&&BB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(LO),IP(rL),IP(Q7),IP(EF),IP(H7))},e.\u0275cmp=wk({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&aI(Ope,5),2&e)&&(iI(n=oI())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Ape=function(){function e(t,n,r){by(this,e),this.added=t,this.modified=n,this.removed=r}return Py(e,[{key:"addNewKeys",value:function(e,t){var n,r=Cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=Cy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{$7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),$7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=Cy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}},{key:"isFullyCreated",value:function(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}},{key:"addedOrModified",value:function(e){var t=this.isPresent(e);return!0===t.present&&"removed"!==t.state}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=ny({},n),r;if(null==n)return r.removed=ny({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function Mpe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function xpe(e,t){return Mpe(t)-Mpe(e)}function Rpe(e){return tm(function(t,n){ym(e).subscribe(new nm(n,function(){return n.complete()},Ly)),!n.closed&&t.subscribe(n)})}var Npe=function(){var e=function(){function e(){by(this,e)}return Py(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(cv||(cv=ey([""," hours"])),r)):1===r&&i.push($localize(lv||(lv=ey(["1 hour"])))),n>1?i.push($localize(fv||(fv=ey([""," minutes"])),n)):1===n&&i.push($localize(hv||(hv=ey(["1 minute"])))),t>1?i.push($localize(dv||(dv=ey([""," seconds"])),t)):1===t&&i.push($localize(vv||(vv=ey(["1 second"])))),0===i.length)return $localize(pv||(pv=ey(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(gv||(gv=ey([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Tk({name:"humanDuration",type:e,pure:!0}),e}();function Dpe(e,t){if(1&e&&(DP(0),pS(1),LP()),2&e){var n=GP(3);Wb(1),gS(n.viewInfo.chosenOpponent)}}function Lpe(e,t){1&e&&bO(0,44)}function Fpe(e,t){if(1&e&&(xP(0,"div",45),xP(1,"div",8),xP(2,"label",46),DP(3),bO(4,47),LP(),xP(5,"output"),pS(6),zT(7,"humanDuration"),RP(),RP(),xP(8,"div",37),NP(9,"input",48),RP(),RP(),xP(10,"div",8),xP(11,"label",49),wO(12,50),NP(13,"output"),zT(14,"humanDuration"),_O(),RP(),xP(15,"div",37),NP(16,"input",51),RP(),RP(),RP()),2&e){var n=GP(3);Wb(6),gS(HT(7,2,n.viewInfo.maximalMoveDuration||0)),Wb(8),EO(HT(14,4,n.viewInfo.totalPartDuration||0)),PO(12)}}function Upe(e,t){1&e&&(xP(0,"div"),wO(1,52),NP(2,"br"),_O(),RP())}function Vpe(e,t){1&e&&(xP(0,"button",64),bO(1,65),RP())}function Bpe(e,t){if(1&e){var n=FP();xP(0,"tr",60),BP("click",function(){var e=hC(n).$implicit;return GP(4).selectOpponent(e)}),xP(1,"td",61),pS(2),RP(),xP(3,"td",62),OP(4,Vpe,2,0,"button",63),RP(),RP()}if(2&e){var r=t.$implicit,i=GP(4);ZP("id","presenceOf_",r,""),AP("ngClass",i.viewInfo.candidateClasses[r]),Wb(1),AP("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),Wb(1),gS(r),Wb(2),AP("ngIf",i.viewInfo.chosenOpponent!==r)}}function zpe(e,t){if(1&e&&(DP(0),bO(1,53),LP(),xP(2,"div",54),xP(3,"table",55),xP(4,"thead"),xP(5,"tr"),xP(6,"th",56),bO(7,57),RP(),xP(8,"th",56),bO(9,58),RP(),RP(),RP(),xP(10,"tbody"),OP(11,Bpe,5,5,"tr",59),RP(),RP(),RP()),2&e){var n=GP(3);Wb(11),AP("ngForOf",n.viewInfo.candidates)}}function Hpe(e,t){if(1&e){var n=FP();xP(0,"button",66),BP("click",function(){return hC(n),GP(3).changeConfig()}),bO(1,67),RP()}}function Gpe(e,t){if(1&e){var n=FP();xP(0,"div"),xP(1,"h1",4),bO(2,5),RP(),xP(3,"form",6),xP(4,"fieldset",7),xP(5,"div",8),xP(6,"label",9),bO(7,10),RP(),xP(8,"div",11),xP(9,"button",12),BP("click",function(){return hC(n),GP(2).selectFirstPlayer("RANDOM")}),bO(10,13),RP(),xP(11,"button",14),BP("click",function(){return hC(n),GP(2).selectFirstPlayer("CREATOR")}),bO(12,15),RP(),xP(13,"button",16),BP("click",function(){return hC(n),GP(2).selectFirstPlayer("CHOSEN_PLAYER")}),OP(14,Dpe,2,1,"ng-container",17),OP(15,Lpe,1,0,"ng-template",null,18,uI),RP(),RP(),RP(),xP(17,"div",8),xP(18,"label",9),bO(19,19),RP(),xP(20,"div",11),xP(21,"div",20),BP("click",function(){return hC(n),GP(2).selectPartType("STANDARD")}),xP(22,"div",21),xP(23,"span"),bO(24,22),RP(),RP(),xP(25,"div",23),xP(26,"div",24),xP(27,"div",25),xP(28,"p"),DP(29),bO(30,26),LP(),xP(31,"strong"),pS(32),zT(33,"humanDuration"),RP(),NP(34,"br"),DP(35),wO(36,27),NP(37,"strong"),zT(38,"humanDuration"),_O(),LP(),RP(),RP(),RP(),RP(),RP(),xP(39,"div",28),BP("click",function(){return hC(n),GP(2).selectPartType("BLITZ")}),xP(40,"div",21),xP(41,"span"),bO(42,29),RP(),RP(),xP(43,"div",23),xP(44,"div",24),xP(45,"div",25),xP(46,"p"),DP(47),bO(48,30),LP(),xP(49,"strong"),pS(50),zT(51,"humanDuration"),RP(),NP(52,"br"),DP(53),wO(54,31),NP(55,"strong"),zT(56,"humanDuration"),_O(),LP(),RP(),RP(),RP(),RP(),RP(),xP(57,"button",32),BP("click",function(){return hC(n),GP(2).selectPartType("CUSTOM")}),bO(58,33),RP(),RP(),RP(),OP(59,Fpe,17,6,"div",34),xP(60,"div",8),xP(61,"label",35),bO(62,36),RP(),xP(63,"div",37),OP(64,Upe,3,0,"div",17),OP(65,zpe,12,1,"ng-template",null,38,uI),RP(),RP(),RP(),xP(67,"div",8),xP(68,"div",11),xP(69,"button",39),BP("click",function(){return hC(n),GP(2).proposeConfig()}),bO(70,40),RP(),OP(71,Hpe,2,0,"button",41),xP(72,"button",42),BP("click",function(){return hC(n),GP(2).cancelGameCreation()}),bO(73,43),RP(),RP(),RP(),RP(),RP()}if(2&e){var r=TP(16),i=TP(66),a=GP(2);Wb(3),AP("formGroup",a.configFormGroup),Wb(1),AP("disabled",!a.viewInfo.canEditConfig),Wb(5),AP("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),Wb(2),AP("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),Wb(2),AP("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Wb(1),AP("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),Wb(7),AP("ngClass",a.viewInfo.partTypeClasses.STANDARD),Wb(11),gS(HT(33,19,a.partType.NORMAL_MOVE_DURATION)),Wb(6),EO(HT(38,21,a.partType.NORMAL_PART_DURATION)),PO(36),Wb(1),AP("ngClass",a.viewInfo.partTypeClasses.BLITZ),Wb(11),gS(HT(51,23,a.partType.BLITZ_MOVE_DURATION)),Wb(6),EO(HT(56,25,a.partType.BLITZ_PART_DURATION)),PO(54),Wb(1),AP("ngClass",a.viewInfo.partTypeClasses.CUSTOM),Wb(2),AP("ngIf",a.viewInfo.showCustomTime),Wb(5),AP("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),Wb(5),AP("disabled",!a.viewInfo.canProposeConfig),Wb(2),AP("ngIf",a.viewInfo.canReviewConfig)}}function $pe(e,t){if(1&e&&(xP(0,"div",74),xP(1,"p"),wO(2,75),NP(3,"br"),_O(),RP(),RP()),2&e){var n=GP(3);Wb(3),EO(n.viewInfo.creator),PO(2)}}function Zpe(e,t){if(1&e&&(xP(0,"span"),bO(1,81),RP()),2&e){var n=GP(4);Wb(1),EO(n.viewInfo.creator),PO(1)}}function qpe(e,t){1&e&&(xP(0,"span"),bO(1,82),RP())}function Wpe(e,t){1&e&&(xP(0,"span"),bO(1,83),RP())}function jpe(e,t){if(1&e){var n=FP();xP(0,"div",74),xP(1,"p"),bO(2,76),RP(),xP(3,"ul"),xP(4,"li"),OP(5,Zpe,2,1,"span",2),OP(6,qpe,2,0,"span",2),OP(7,Wpe,2,0,"span",2),RP(),xP(8,"li"),wO(9,77),NP(10,"strong"),zT(11,"humanDuration"),_O(),RP(),xP(12,"li"),wO(13,78),NP(14,"strong"),zT(15,"humanDuration"),_O(),RP(),RP(),xP(16,"button",79),BP("click",function(){return hC(n),GP(3).acceptConfig()}),bO(17,80),RP(),RP()}if(2&e){var r=GP(3);Wb(2),EO(r.viewInfo.creator)(r.viewInfo.partTypeName),PO(2),Wb(3),AP("ngIf","CREATOR"===r.viewInfo.firstPlayer),Wb(1),AP("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),Wb(1),AP("ngIf","RANDOM"===r.viewInfo.firstPlayer),Wb(4),EO(HT(11,7,r.viewInfo.maximalMoveDuration||0)),PO(9),Wb(4),EO(HT(15,9,r.viewInfo.totalPartDuration||0)),PO(13)}}function Ype(e,t){if(1&e&&(xP(0,"div"),xP(1,"div",68),xP(2,"div",69),xP(3,"p"),bO(4,70),RP(),RP(),xP(5,"div",71),OP(6,$pe,4,1,"div",72),OP(7,jpe,18,11,"ng-template",null,73,uI),RP(),RP(),RP()),2&e){var n=TP(8),r=GP(2);Wb(6),AP("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Kpe(e,t){if(1&e&&(DP(0),bO(1,86),LP()),2&e){var n=GP(3);Wb(1),EO(n.viewInfo.creator),PO(1)}}function Qpe(e,t){if(1&e&&bO(0,87),2&e){var n=GP(3);EO(n.viewInfo.creator)(n.viewInfo.chosenOpponent),PO(0)}}function Xpe(e,t){if(1&e&&(xP(0,"div",68),xP(1,"div",69),xP(2,"p"),bO(3,84),RP(),RP(),xP(4,"div",71),xP(5,"p"),OP(6,Kpe,2,1,"ng-container",17),OP(7,Qpe,1,2,"ng-template",null,85,uI),RP(),RP(),RP()),2&e){var n=TP(8),r=GP(2);Wb(6),AP("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Jpe(e,t){if(1&e&&(xP(0,"div",1),OP(1,Gpe,74,27,"div",2),OP(2,Ype,9,2,"div",2),OP(3,Xpe,9,2,"div",3),RP()),2&e){var n=GP();Wb(1),AP("ngIf",n.viewInfo.userIsCreator),Wb(1),AP("ngIf",n.viewInfo.userIsChosenOpponent),Wb(1),AP("ngIf",n.viewInfo.userIsObserver)}}var ege=function(){function e(t,n,r,i,a,o,s,u,c,l){by(this,e),this.router=t,this.actRoute=n,this.connectedUserService=r,this.observedPartService=i,this.gameService=a,this.configRoomService=o,this.chatService=s,this.userService=u,this.formBuilder=c,this.messageDisplayer=l,this.partType=t9,this.gameStartNotification=new qT,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new Xy,this.allUserInterval=zB.empty(),this.ownTokenInterval=zB.empty(),this.selfSubscription=new Ey,this.configRoomSubscription=new Ey,this.candidatesSubscription=new Ey,this.allDocDeleted=!1,FB(e.VERBOSE,"PartCreationComponent constructed")}return Py(e,[{key:"ngOnInit",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return FB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=14;break;case 9:return n.next=11,t.startSendingPresenceTokens();case 11:t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),FB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 14:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;$7(e.isPresent(),"PartCreationComponent should not be called without connected user"),$7(e.get()!==K7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),$7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[e9.RANDOM.value,wx.required],maximalMoveDuration:[t9.NORMAL_MOVE_DURATION,wx.required],partType:["STANDARD",wx.required],totalPartDuration:[t9.NORMAL_PART_DURATION,wx.required],chosenOpponent:["",wx.required]})}},{key:"updateUserDocWithObservedPart",value:function(t){FB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");var n=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:LB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:n};return this.observedPartService.updateObservedPart(r)}},{key:"getUserRoleInPart",value:function(e){var t,n=this.connectedUserService.user.get().id;return n===e.creator.id?"Creator":n===(null===(t=e.chosenOpponent)||void 0===t?void 0:t.id)?"ChosenOpponent":"Candidate"}},{key:"getOpponent",value:function(){var e,t;return this.connectedUserService.user.get().id===(null===(e=this.currentConfigRoom)||void 0===e?void 0:e.creator.id)?this.currentConfigRoom.chosenOpponent:LB.getNonNullable(null===(t=this.currentConfigRoom)||void 0===t?void 0:t.creator)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=DB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=DB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return LB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(Rpe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=LB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==n9.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Rpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Rpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Rpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Rpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=LB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===n9.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==n9.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(n),this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==n9.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),this.userIsCreator(n)?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(yv||(yv=ey(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(mv||(mv=ey(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(kv||(kv=ey(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(t9.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(t9.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(t9.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(t9.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.next=4,Promise.all([n.observedPartService.updateObservedPart({opponent:i}),n.configRoomService.setChosenOpponent(n.partId,i)]);case 4:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return LB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig(e.partId));case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(e.partId,s,t9.of(r),i,e9.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.observedPartService.removeObservedPart();case 3:return FB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return FB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return FB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.partId,t.candidates);case 12:FB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(FB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(FB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(i=t.get(),!n.chosenOpponentJustLeft(i)||!n.userIsCreator(i)){r.next=8;break}return a=LB.getNonNullable(n.currentConfigRoom),o=LB.getNonNullable(a.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(Cv||(Cv=ey([""," left the game, please pick another opponent."])),o)),r.next=8,n.observedPartService.updateObservedPart({opponent:null});case 8:if(s=!1,r.t0=n.userJustChosenAsOpponent(i),!r.t0){r.next=14;break}return r.next=13,n.updateUserDocWithObservedPart(i);case 13:s=!0;case 14:if(n.currentConfigRoom=i,r.t1=n.allUserInterval.isAbsent(),!r.t1){r.next=22;break}return $7(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),r.next=20,n.updateUserDocWithObservedPart(n.currentConfigRoom);case 20:return r.next=22,n.observeNeededPlayers();case 22:n.updateViewInfo(),n.isGameStarted(n.currentConfigRoom)&&(FB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 24:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"userJustChosenAsOpponent",value:function(e){var t,n,r;if(this.isGameStarted(e))return!1;var i=this.connectedUserService.user.get().id;return(null===(t=this.currentConfigRoom)||void 0===t||null===(n=t.chosenOpponent)||void 0===n?void 0:n.id)!==i&&(null===(r=e.chosenOpponent)||void 0===r?void 0:r.id)===i}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return FB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(wv||(wv=ey(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(e){return $7(null!=e,"configRoom should not be null (isGameStarted)"),LB.getNonNullable(e).partStatus===n9.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=LB.getNonNullable(this.currentConfigRoom);FB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,FB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=LB.getNonNullable(t.currentConfigRoom),FB(e.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:r}}),$7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=zB.of(window.setInterval(DB(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.lastToken,!t.userIsCreator(r)){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(n);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(n);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 2:case"end":return n.stop()}},n)}))()}},{key:"userIsCreator",value:function(e){return this.connectedUserService.user.get().id===e.creator.id}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=LB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),$7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=Cy(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(G7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):xpe(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=LB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId);case 5:return n.abrupt("return",t.configRoomService.removeCandidate(t.partId,e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:$7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=zB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){$7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=zB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}},{key:"acceptConfig",value:function(){return FB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,LB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(FB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),r=t.connectedUserService.user.get(),n.t0=!0!==t.gameStarted,!n.t0){n.next=23;break}if(null!==t.currentConfigRoom){n.next=8;break}FB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"),n.next=23;break;case 8:if(!0!==t.allDocDeleted){n.next=12;break}FB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"),n.next=23;break;case 12:if(r.id!==t.currentConfigRoom.creator.id){n.next=18;break}return FB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=16,t.cancelGameCreation();case 16:n.next=23;break;case 18:return FB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=21,t.observedPartService.removeObservedPart();case 21:return n.next=23,t.configRoomService.cancelJoining(t.partId);case 23:case"end":return n.stop()}},n)}))()}}]),e}();function tge(e,t){if(1&e){var n=FP();xP(0,"button",3),BP("click",function(){return hC(n),GP().addTime()}),bO(1,4),RP()}if(2&e){var r=GP();Wb(1),EO(r.timeToAdd),PO(1)}}ege.VERBOSE=!1,ege.TOKEN_INTERVAL=5e3,ege.TOKEN_TIMEOUT=2*ege.TOKEN_INTERVAL,ege.\u0275fac=function(e){return new(e||ege)(IP(EF),IP(rL),IP(Q7),IP(D9),IP(y9),IP(g9),IP(V7),IP(q7),IP(jR),IP(H7))},ege.\u0275cmp=wk({type:ege,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(_v||(_v=ey(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(bv||(bv=ey(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(Ev||(Ev=ey(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(Pv||(Pv=ey(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(Sv||(Sv=ey(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(Ov||(Ov=ey(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(Tv||(Tv=ey(["Maximal turn duration: "]))),$localize(Iv||(Iv=ey(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(Av||(Av=ey(["Blitz"]))),$localize(Mv||(Mv=ey(["Maximal turn duration: "]))),$localize(xv||(xv=ey(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(Rv||(Rv=ey(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(Nv||(Nv=ey(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(Dv||(Dv=ey(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(Lv||(Lv=ey(["Cancel game"]))),$localize(Fv||(Fv=ey(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(Uv||(Uv=ey(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(Vv||(Vv=ey(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(Bv||(Bv=ey(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(zv||(zv=ey(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Hv||(Hv=ey(["Name"]))),$localize(Gv||(Gv=ey(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize($v||($v=ey(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Zv||(Zv=ey(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(qv||(qv=ey(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Wv||(Wv=ey(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(jv||(jv=ey(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Yv||(Yv=ey(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Kv||(Kv=ey(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Qv||(Qv=ey(["Accept and start"]))),$localize(Xv||(Xv=ey(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Jv||(Jv=ey(["you play first"]))),$localize(ep||(ep=ey(["the first player is selected randomly"]))),$localize(tp||(tp=ey(["One moment..."]))),["proposalSent",""],$localize(np||(np=ey(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(rp||(rp=ey(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&OP(0,Jpe,4,3,"div",0),2&e&&AP("ngIf",t.viewInfo)},directives:[vM,ER,qx,AR,lM,px,OR,Zx,xR,hM],pipes:[Npe],encapsulation:2});var nge=function(){var e=function(){function e(){by(this,e),this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new qT,this.addTimeToOpponent=new qT,this.cssClasses=e.SAFE_TIME}return Py(e,[{key:"ngOnInit",value:function(){FB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){FB(e.VERBOSE,this.debugName+".set("+t+"ms)"),$7(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){FB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),$7(this.isSet,"Should not start a chrono that has not been set!"),$7(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;FB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),$7(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){FB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){FB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),$7(this.started,"Should not pause not started chrono ("+this.debugName+")"),$7(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){FB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),$7(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){FB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=wk({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(ip||(ip=ey(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"p",1),pS(2),zT(3,"number"),RP(),OP(4,tge,2,1,"button",2),RP()),2&e&&(AP("ngClass",t.getTimeClass()),Wb(2),mS("",t.displayedMinute,":",function(e,t,n,r){var i=e+20,a=lC(),o=tC(a,i);return $T(a,GT(a,i)?function(e,t,n,r,i,a,o){var s=t+n;return wP(e,s,i,a)?kP(e,s+2,o?r.call(o,i,a):r(i,a)):VT(e,s+2)}(a,wC(),t,o.transform,n,r,o):o.transform(n,r))}(3,4,t.displayedSec,"2.0-0"),""),Wb(2),AP("ngIf",t.canAddTime))},directives:[lM,vM],pipes:[yM],encapsulation:2}),e}(),rge=["partCreation"],ige=["chatComponent"],age=["chronoZeroGlobal"],oge=["chronoOneGlobal"],sge=["chronoZeroTurn"],uge=["chronoOneTurn"];function cge(e,t){if(1&e){var n=FP();xP(0,"app-part-creation",5,6),BP("gameStartNotification",function(e){return hC(n),GP().startGame(e)}),RP()}2&e&&AP("partId",GP().currentPartId)}function lge(e,t){1&e&&(DP(0),bO(1,40),LP())}function fge(e,t){if(1&e&&(DP(0),bO(1,41),LP()),2&e){var n=GP(4);Wb(1),EO(null==n.currentPlayer?null:n.currentPlayer.name),PO(1)}}function hge(e,t){if(1&e&&(xP(0,"p",37),OP(1,lge,2,0,"ng-container",38),OP(2,fge,2,1,"ng-template",null,39,uI),RP()),2&e){var n=TP(3),r=GP(3);Wb(1),AP("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function dge(e,t){if(1&e&&(xP(0,"div",33),xP(1,"p",34),bO(2,35),RP(),OP(3,hge,4,2,"p",36),RP()),2&e){var n=GP(2);Wb(2),EO(n.currentPart.getTurn()+1),PO(2),Wb(1),AP("ngIf",!1===n.endGame)}}function vge(e,t){if(1&e&&(xP(0,"p",42),pS(1),RP()),2&e){var n=GP(2);AP("ngClass",n.getPlayerNameClass(n.Player.ZERO)),Wb(1),gS(n.players[0].get().name)}}function pge(e,t){if(1&e&&(xP(0,"p",43),bO(1,44),RP()),2&e){var n=GP(2);Wb(1),EO(n.gameComponent.scores.get()[0]),PO(1)}}function gge(e,t){if(1&e&&(xP(0,"p",45),pS(1),RP()),2&e){var n=GP(2);AP("ngClass",n.getPlayerNameClass(n.Player.ONE)),Wb(1),gS(n.players[1].get().name)}}function yge(e,t){if(1&e&&(xP(0,"p",46),bO(1,47),RP()),2&e){var n=GP(2);Wb(1),EO(n.gameComponent.scores.get()[1]),PO(1)}}function mge(e,t){if(1&e){var n=FP();xP(0,"button",56),BP("click",function(){return hC(n),GP(3).resign()}),bO(1,57),RP()}}function kge(e,t){if(1&e){var n=FP();xP(0,"button",58),BP("click",function(){return hC(n),GP(3).proposeDraw()}),bO(1,59),RP()}}function Cge(e,t){if(1&e){var n=FP();xP(0,"button",60),BP("click",function(){return hC(n),GP(3).acceptDraw()}),bO(1,61),RP()}}function wge(e,t){if(1&e){var n=FP();xP(0,"button",62),BP("click",function(){return hC(n),GP(3).refuseDraw()}),bO(1,63),RP()}}function _ge(e,t){if(1&e){var n=FP();xP(0,"button",64),BP("click",function(){return hC(n),GP(3).gameComponent.pass()}),bO(1,65),RP()}}function bge(e,t){if(1&e){var n=FP();xP(0,"button",66),BP("click",function(){return hC(n),GP(3).acceptTakeBack()}),bO(1,67),RP()}}function Ege(e,t){if(1&e){var n=FP();xP(0,"button",68),BP("click",function(){return hC(n),GP(3).refuseTakeBack()}),bO(1,69),RP()}}function Pge(e,t){if(1&e){var n=FP();xP(0,"button",70),BP("click",function(){return hC(n),GP(3).askTakeBack()}),bO(1,71),RP()}}function Sge(e,t){if(1&e&&(DP(0),OP(1,mge,2,0,"button",48),OP(2,kge,2,0,"button",49),OP(3,Cge,2,0,"button",50),OP(4,wge,2,0,"button",51),OP(5,_ge,2,0,"button",52),OP(6,bge,2,0,"button",53),OP(7,Ege,2,0,"button",54),OP(8,Pge,2,0,"button",55),LP()),2&e){var n=GP(2);Wb(1),AP("ngIf",n.canResign()),Wb(1),AP("ngIf",n.canProposeDraw()),Wb(1),AP("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Wb(1),AP("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Wb(1),AP("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),Wb(1),AP("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Wb(1),AP("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Wb(1),AP("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function Oge(e,t){1&e&&(xP(0,"div"),xP(1,"p",73),bO(2,74),RP(),RP())}function Tge(e,t){1&e&&(xP(0,"p",78),bO(1,79),RP())}function Ige(e,t){1&e&&(xP(0,"p",80),bO(1,81),RP())}function Age(e,t){1&e&&(xP(0,"p",82),bO(1,83),RP())}function Mge(e,t){if(1&e&&(xP(0,"div"),OP(1,Tge,2,0,"p",75),OP(2,Ige,2,0,"p",76),OP(3,Age,2,0,"p",77),RP()),2&e){var n=GP(3);Wb(1),AP("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),Wb(1),AP("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),Wb(1),AP("ngIf",!1===n.isPlaying())}}function xge(e,t){1&e&&(xP(0,"p",87),bO(1,88),RP())}function Rge(e,t){1&e&&(xP(0,"p",89),bO(1,90),RP())}function Nge(e,t){if(1&e&&(xP(0,"p",91),bO(1,92),RP()),2&e){var n=GP(4);Wb(1),EO(n.currentPart.getWinner().get().name),PO(1)}}function Dge(e,t){if(1&e&&(xP(0,"div"),OP(1,xge,2,0,"p",84),OP(2,Rge,2,0,"p",85),OP(3,Nge,2,1,"p",86),RP()),2&e){var n=GP(3);Wb(1),AP("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),Wb(1),AP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),Wb(1),AP("ngIf",!1===n.isPlaying())}}function Lge(e,t){if(1&e&&(xP(0,"p",87),bO(1,93),RP()),2&e){var n=GP(4);Wb(1),EO(n.currentPart.getLoser().get().name),PO(1)}}function Fge(e,t){1&e&&(xP(0,"p",91),bO(1,94),RP())}function Uge(e,t){if(1&e&&(xP(0,"p",91),bO(1,95),RP()),2&e){var n=GP(4);Wb(1),EO(n.currentPart.getLoser().get().name),PO(1)}}function Vge(e,t){if(1&e&&(xP(0,"div"),OP(1,Lge,2,1,"p",84),OP(2,Fge,2,0,"p",86),OP(3,Uge,2,1,"p",86),RP()),2&e){var n=GP(3);Wb(1),AP("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),Wb(1),AP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),Wb(1),AP("ngIf",!1===n.isPlaying())}}function Bge(e,t){1&e&&(xP(0,"p",97),bO(1,98),RP())}function zge(e,t){if(1&e&&(xP(0,"p",97),bO(1,99),RP()),2&e){var n=GP(4);Wb(1),EO(n.currentPart.getLoser().get().name),PO(1)}}function Hge(e,t){if(1&e&&(xP(0,"div"),OP(1,Bge,2,0,"p",96),OP(2,zge,2,1,"p",96),RP()),2&e){var n=GP(3);Wb(1),AP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),Wb(1),AP("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Gge(e,t){if(1&e&&(xP(0,"div",72),NP(1,"hr"),OP(2,Oge,3,0,"div",26),OP(3,Mge,4,3,"div",26),OP(4,Dge,4,3,"div",26),OP(5,Vge,4,3,"div",26),OP(6,Hge,3,2,"div",26),RP()),2&e){var n=GP(2);Wb(2),AP("ngIf",n.currentPart.isHardDraw()),Wb(1),AP("ngIf",n.currentPart.isAgreedDraw()),Wb(1),AP("ngIf",n.currentPart.isWin()),Wb(1),AP("ngIf",n.currentPart.isTimeout()),Wb(1),AP("ngIf",n.currentPart.isResign())}}function $ge(e,t){1&e&&(xP(0,"button",100),bO(1,101),RP())}function Zge(e,t){if(1&e){var n=FP();xP(0,"button",102),BP("click",function(){return hC(n),GP(2).proposeRematch()}),bO(1,103),RP()}}function qge(e,t){if(1&e){var n=FP();xP(0,"button",104),BP("click",function(){return hC(n),GP(2).acceptRematch()}),bO(1,105),RP()}}function Wge(e,t){if(1&e){var n=FP();xP(0,"div",7),xP(1,"div",8),xP(2,"div",9),OP(3,dge,4,2,"div",10),xP(4,"div",11),OP(5,vge,2,2,"p",12),OP(6,pge,2,1,"p",13),xP(7,"app-count-down",14,15),BP("outOfTimeAction",function(){hC(n);var e=GP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return hC(n),GP().addGlobalTime()}),RP(),xP(9,"app-count-down",16,17),BP("outOfTimeAction",function(){hC(n);var e=GP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return hC(n),GP().addTurnTime()}),RP(),RP(),xP(11,"p",18),bO(12,19),RP(),xP(13,"div",11),OP(14,gge,2,2,"p",20),OP(15,yge,2,1,"p",21),xP(16,"app-count-down",22,23),BP("outOfTimeAction",function(){hC(n);var e=GP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return hC(n),GP().addGlobalTime()}),RP(),xP(18,"app-count-down",24,25),BP("outOfTimeAction",function(){hC(n);var e=GP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return hC(n),GP().addTurnTime()}),RP(),RP(),NP(20,"hr"),OP(21,Sge,9,8,"ng-container",26),OP(22,Gge,7,5,"div",27),OP(23,$ge,2,0,"button",28),OP(24,Zge,2,0,"button",29),OP(25,qge,2,0,"button",30),RP(),RP(),xP(26,"div",31),xP(27,"div",32),NP(28,"app-game-includer"),RP(),RP(),RP()}if(2&e){var r=GP();Wb(3),AP("ngIf",r.currentPart),Wb(2),AP("ngIf",r.players[0].isPresent()),Wb(1),AP("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Wb(1),AP("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Wb(2),AP("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Wb(5),AP("ngIf",r.players[1].isPresent()),Wb(1),AP("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Wb(1),AP("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Wb(2),AP("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Wb(3),AP("ngIf",r.isPlaying()),Wb(1),AP("ngIf",r.endGame),Wb(1),AP("ngIf",r.endGame),Wb(1),AP("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),Wb(1),AP("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),Wb(1),AP("ngClass",r.getBoardHighlight())}}var jge=function(){var e=Py(function e(){by(this,e)});return e.NO_MATCHING_PART=function(){return $localize(ap||(ap=ey(["The game you tried to join does not exist."])))},e}(),Yge=Py(function e(t){by(this,e),this.value=t});Yge.PRE_START_DOC=new Yge("PRE_START_DOC"),Yge.STARTING_DOC=new Yge("STARTING_DOC"),Yge.DUPLICATE=new Yge("DUPLICATE"),Yge.MOVE_WITHOUT_TIME=new Yge("MOVE_WITHOUT_TIME"),Yge.MOVE=new Yge("MOVE"),Yge.REQUEST=new Yge("REQUEST"),Yge.END_GAME=new Yge("END_GAME"),Yge.END_GAME_WITHOUT_TIME=new Yge("END_GAME_WITHOUT_TIME"),Yge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Yge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Kge=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s,u,c){var l;return by(this,n),(l=t.call(this,e,r,i,a,o)).observedPartService=s,l.userService=u,l.gameService=c,l.gameStarted=!1,l.opponent=null,l.rematchProposed=!1,l.opponentProposedRematch=!1,l.userLinkedToThisPart=!0,l.observedPart=zB.empty(),l.hasUserPlayed=[!1,!1],l.msToSubstract=[0,0],l.opponentSubscription=new Ey,l.partSubscription=new Ey,l.observedPartSubscription=new Ey,l.OFFLINE_FONT_COLOR={color:"lightgrey"},l.globalTimeMessage=$localize(op||(op=ey(["5 minutes"]))),l.turnTimeMessage=$localize(sp||(sp=ey(["30 seconds"]))),l.onCurrentUpdateOngoing=!1,FB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),l}return Py(n,[{key:"extractPartIdFromURL",value:function(){return LB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return LB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.role.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.role===e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!Zve.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSubscription.unsubscribe(),r=jge.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSubscription.unsubscribe(),i=Tpe.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return FB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var t=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof QN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var t=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onObservedPartUpdate(n);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),FB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 7:case"end":return t.stop()}},t)}))()}},{key:"onObservedPartUpdate",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(FB(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),!e.isPresent()){r.next=11;break}if("Observer"!==(i=e.get()).role&&i.id!==t.currentPartId){r.next=6;break}t.observedPart=e,r.next=9;break;case 6:return t.userLinkedToThisPart=!1,r.next=9,t.router.navigate(["/lobby"]);case 9:r.next=12;break;case 11:t.observedPart=zB.empty();case 12:case"end":return r.stop()}},r)}))()}},{key:"getObservedPart",value:function(){return this.observedPart}},{key:"startGame",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:FB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),$7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(DB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),2);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;FB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,(e=DB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=this;return DB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=new J7(r.currentPartId,e),FB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:r.currentPart,then:e,before_part_turn:a.data.turn,before_state_turn:r.gameComponent.rules.node.gameState.turn,nbPlayedMoves:a.data.listMoves.length}}),!r.onCurrentUpdateOngoing){i.next=3;break}return i.abrupt("return",($7((t-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.onCurrentPartUpdate(e,t);case 2:case"end":return n.stop()}},n)})),1e3)));case 3:r.onCurrentUpdateOngoing=!0,o=r.getUpdateTypes(a),s=e.turn,o.includes(Yge.REQUEST)?FB(n.VERBOSE,"UpdateType: Request("+LB.getNonNullable(a.data.request).code+") ("+s+")"):FB(n.VERBOSE,"UpdateType: "+o.map(function(e){return e.value})+"("+s+")"),u=r.currentPart,r.currentPart=a,c=Cy(o),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=17;break}return f=l.value,i.next=15,r.applyUpdate(f,a,u);case 15:i.next=11;break;case 17:i.next=22;break;case 19:i.prev=19,i.t0=i.catch(9),c.e(i.t0);case 22:return i.prev=22,c.f(),i.finish(22);case 25:r.onCurrentUpdateOngoing=!1;case 26:case"end":return i.stop()}},i,null,[[9,19,22,25]])}))()}},{key:"applyUpdate",value:function(e,t,n){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=e,i.next=i.t0===Yge.REQUEST?3:i.t0===Yge.ACCEPT_TAKE_BACK_WITHOUT_TIME?6:i.t0===Yge.DUPLICATE?7:i.t0===Yge.END_GAME_WITHOUT_TIME?8:i.t0===Yge.END_GAME?9:i.t0===Yge.MOVE_WITHOUT_TIME?10:i.t0===Yge.MOVE?11:i.t0===Yge.PRE_START_DOC?12:13;break;case 3:return i.next=5,r.onRequest(LB.getNonNullable(t.data.request),n);case 5:return i.abrupt("return",i.sent);case 6:case 8:return i.abrupt("return",void(r.currentPart=n));case 7:case 12:return i.abrupt("return");case 9:return i.abrupt("return",r.applyEndGame());case 10:return i.abrupt("return",void(r.currentPart.data=ny(ny({},r.currentPart.data),{},{turn:r.currentPart.data.turn-1,lastUpdate:n.data.lastUpdate,lastUpdateTime:n.data.lastUpdateTime,listMoves:r.currentPart.data.listMoves.slice(0,r.currentPart.data.listMoves.length-1)})));case 11:return i.abrupt("return",(r.msToSubstract=r.getLastUpdateTime(n,t),r.doNewMoves(t)));case 13:return i.abrupt("return",($7(e===Yge.STARTING_DOC,"Unexpected update type "+e),r.startCountDown(t)));case 14:case"end":return i.stop()}},i)}))()}},{key:"startCountDown",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.setChronos(),n.next=3,t.setPlayersDatas(e);case 3:t.startCountDownFor(0===e.data.listMoves.length?u9.ZERO:u9.fromTurn(e.data.turn-1));case 4:case"end":return n.stop()}},n)}))()}},{key:"getUpdateTypes",value:function(e){var t=null!=this.currentPart?this.currentPart.data:null,r=Ape.from(t,e.data),i=[];if(FB(n.VERBOSE,{currentPartDoc:t,update:e,diff:r}),0===r.countChanges()&&i.push(Yge.DUPLICATE),r.isFullyCreated()&&r.isPresent("beginning").present&&i.push(Yge.STARTING_DOC),e.data.request){var a=null!=r.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&a?Yge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Yge.REQUEST)}if(null==t?"added"===r.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,r)):this.turnHasIncreased(this.currentPart.data.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,r)),null==e.data.beginning&&i.push(Yge.PRE_START_DOC),r.isPresent("result").present&&e.data.result!==X7.UNACHIEVED.value){var o=null!=r.modified.turn,s=!1===r.addedOrModified("lastUpdateTime");i.push(o&&s?Yge.END_GAME_WITHOUT_TIME:Yge.END_GAME)}return i}},{key:"getMoveUpdateType",value:function(e,t){return 1===e.data.turn?null==e.data.lastUpdateTime?Yge.MOVE_WITHOUT_TIME:Yge.MOVE:null==t.modified.lastUpdateTime&&null==t.added.lastUpdateTime?Yge.MOVE_WITHOUT_TIME:Yge.MOVE}},{key:"turnHasIncreased",value:function(e,t,n){return $7(n.length===t,"ListMoves size and newTurn do not match, it is impossible!"),e<t}},{key:"getLastUpdateTime",value:function(e,t){if(null==e)return[0,0];var n=this.getMoreRecentTime(e),r=this.getMoreRecentTime(t);$7(null!=n,"oldTime should not be null"),$7(null!=r,"updateTime should not be null");var i=u9.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(LB.getNonNullable(n),LB.getNonNullable(r),i)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n){var r=xpe(e,t),i=[0,0];return i[n.value]=r,i}},{key:"setChronos",value:function(){FB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){FB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();for(var t=h9.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;this.gameComponent.getTurn()<t.length;){var i=this.gameComponent.getTurn(),a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,this.gameComponent.getState()),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';$7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){FB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer at turn "+this.currentPart.data.turn);var e=u9.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();var t=e.getOpponent();this.pauseCountDownsFor(t),this.didUserPlay(e)?(FB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.observedPartService.removeObservedPart();case 2:r=e.currentPart,i=u9.fromTurn(r.data.turn),e.endGame=!0,!1===[X7.VICTORY,X7.HARD_DRAW].some(function(e){return e.value===r.data.result})&&($7(!0===[X7.RESIGN,X7.TIMEOUT,X7.HARD_DRAW,X7.AGREED_DRAW_BY_ZERO,X7.AGREED_DRAW_BY_ONE].some(function(e){return e.value===r.data.result}),"Unknown type of end game ("+r.data.result+")"),a="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name,FB(n.VERBOSE,a)),e.stopCountdownsFor(i);case 5:case"end":return t.stop()}},t)}))()}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){FB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===ene.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):($7(r===ene.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return $7(this.isPlaying(),"Non playing should not call canAskTakeBack"),$7(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(this.currentPart.data.turn<=this.role.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&this.currentPart.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===s9.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}},{key:"getTakeBackRequester",value:function(){var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?c9.getPlayer(e):s9.NONE}},{key:"canProposeDraw",value:function(){return $7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&c9.getPlayer(this.currentPart.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===s9.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==s9.NONE&&e!==this.role}},{key:"getDrawRequester",value:function(){var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?c9.getPlayer(e):s9.NONE}},{key:"onRequest",value:function(e,t){var r=this;return DB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(FB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:18;break;case 3:return i.abrupt("break",21);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",21);case 6:return r.rematchProposed=!0,a=c9.getPlayer(e).getOpponent(),r.isPlayer(a)&&(FB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",21);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",c9.getTypeGame(e),c9.getPartId(e)]);case 14:return i.abrupt("break",21);case 15:return 3e4,o=u9.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",21);case 18:LB.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),3e5,s=u9.of(e.data.player),r.addGlobalTimeTo(s,3e5);case 21:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(FB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=u9.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return FB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),t.players=[zB.of(e.data.playerZero),zB.ofNullable(e.data.playerOne)],$7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),t.currentPlayer=t.players[e.data.turn%2].get(),r.next=3,t.setRealObserverRole();case 3:(i=r.sent).isPresent()&&(a=function(e){$7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=i.get()},t.opponentSubscription=t.userService.observeUser(i.get().id,a));case 5:case"end":return r.stop()}},r)}))()}},{key:"setRealObserverRole",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=zB.empty(),e.players[0].equalsValue(e.getPlayer())?(e.setRole(u9.ZERO),n=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(u9.ONE),n=e.players[0]):e.setRole(s9.NONE),t.next=4,e.observedPartService.updateObservedPart({role:e.role===s9.NONE?"Observer":"Player"});case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}},t)}))()}},{key:"onLegalUserMove",value:function(e,t){var r=this;return DB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(FB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return DB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),FB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===ene.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.role,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return FB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.role,a=e.getPlayer(),o=e.players[(e.role.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(FB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.role,t.stopCountdownsFor(e),!1!==t.isPlaying()){r.next=4;break}return r.abrupt("return");case 4:if(o=LB.getNonNullable(t.opponent),e!==t.role){r.next=10;break}return r.next=8,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 8:r.next=16;break;case 10:if($7(!1===t.endGame,"time might be better handled in the future"),r.t0=t.opponentIsOffline(),!r.t0){r.next=16;break}return r.next=15,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,o);case 15:t.endGame=!0;case 16:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new J7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.role);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return $7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptDraw",value:function(){return $7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"refuseDraw",value:function(){return $7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"askTakeBack",value:function(){return $7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptTakeBack",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.role,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return $7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"startCountDownFor",value:function(e){FB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===u9.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===u9.ZERO?(this.chronoZeroGlobal.changeDuration(LB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(LB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===u9.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){FB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===u9.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===u9.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return $7(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}},{key:"addGlobalTime",value:function(){var e=this.role,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=u9.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===u9.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===u9.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(FB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),t.t0=!1===e.isPlaying()&&e.userLinkedToThisPart,!t.t0){t.next=8;break}return t.next=8,e.observedPartService.removeObservedPart();case 8:!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),FB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished");case 10:case"end":return t.stop()}},t)}))()}}]),n}(Ipe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(LO),IP(rL),IP(Q7),IP(EF),IP(H7),IP(D9),IP(q7),IP(y9))},e.\u0275cmp=wk({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(aI(rge,5),aI(ige,5),aI(age,5),aI(oge,5),aI(sge,5),aI(uge,5)),2&e)&&(iI(n=oI())&&(t.partCreation=n.first),iI(n=oI())&&(t.chatComponent=n.first),iI(n=oI())&&(t.chronoZeroGlobal=n.first),iI(n=oI())&&(t.chronoOneGlobal=n.first),iI(n=oI())&&(t.chronoZeroTurn=n.first),iI(n=oI())&&(t.chronoOneTurn=n.first))},features:[cP],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(up||(up=ey(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(cp||(cp=ey(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(lp||(lp=ey(["It is your turn."]))),$localize(fp||(fp=ey(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(hp||(hp=ey(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(dp||(dp=ey(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(vp||(vp=ey(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(pp||(pp=ey(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(gp||(gp=ey(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(yp||(yp=ey(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(mp||(mp=ey(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(kp||(kp=ey(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Cp||(Cp=ey(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(wp||(wp=ey(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(_p||(_p=ey(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(bp||(bp=ey(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(Ep||(Ep=ey(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(Pp||(Pp=ey(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(Sp||(Sp=ey(["You won."]))),["id","youLostIndicator",1,"title"],$localize(Op||(Op=ey(["You lost."]))),[1,"title"],$localize(Tp||(Tp=ey(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(Ip||(Ip=ey(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(Ap||(Ap=ey(["You reached your time limit."]))),$localize(Mp||(Mp=ey(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(xp||(xp=ey(["You resigned."]))),$localize(Rp||(Rp=ey(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(Np||(Np=ey(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Dp||(Dp=ey(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(Lp||(Lp=ey(["Accept to play again"])))]},template:function(e,t){1&e&&(OP(0,cge,2,1,"app-part-creation",0),OP(1,Wge,29,27,"div",1),xP(2,"div",2),xP(3,"div",3),NP(4,"app-chat",4),RP(),RP()),2&e&&(AP("ngIf",!1===t.gameStarted),Wb(1),AP("ngIf",t.gameStarted),Wb(3),AP("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[vM,ppe,ege,nge,lM,Ope,SF],encapsulation:2}),e}();function Qge(e,t){if(1&e&&(xP(0,"option",25),pS(1),RP()),2&e){var n=t.$implicit;AP("value",n.name),Wb(1),gS(n.name)}}function Xge(e,t){if(1&e&&(xP(0,"option",25),bO(1,29),RP()),2&e){var n=t.$implicit;AP("value",n),Wb(1),EO(n),PO(1)}}var Jge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function eye(e,t){if(1&e){var n=FP();xP(0,"select",26),BP("ngModelChange",function(e){return hC(n),GP(2).aiDepths[0]=e})("change",function(){hC(n);var e=GP(2);return e.updatePlayer(e.Player.ZERO)}),xP(1,"option",27),bO(2,28),RP(),OP(3,Xge,2,2,"option",16),RP()}2&e&&(AP("ngModel",GP(2).aiDepths[0]),Wb(3),AP("ngForOf",FT(2,Jge)))}function tye(e,t){if(1&e&&(xP(0,"p",30),bO(1,31),RP()),2&e){var n=GP(2);Wb(1),EO(n.gameComponent.scores.get()[0]),PO(1)}}function nye(e,t){if(1&e&&(xP(0,"option",25),pS(1),RP()),2&e){var n=t.$implicit;AP("value",n.name),Wb(1),gS(n.name)}}function rye(e,t){if(1&e&&(xP(0,"option",25),bO(1,34),RP()),2&e){var n=t.$implicit;AP("value",n),Wb(1),EO(n),PO(1)}}function iye(e,t){if(1&e){var n=FP();xP(0,"select",32),BP("ngModelChange",function(e){return hC(n),GP(2).aiDepths[1]=e})("change",function(){hC(n);var e=GP(2);return e.updatePlayer(e.Player.ONE)}),xP(1,"option",27),bO(2,33),RP(),OP(3,rye,2,2,"option",16),RP()}2&e&&(AP("ngModel",GP(2).aiDepths[1]),Wb(3),AP("ngForOf",FT(2,Jge)))}function aye(e,t){if(1&e&&(xP(0,"p",35),bO(1,36),RP()),2&e){var n=GP(2);Wb(1),EO(n.gameComponent.scores.get()[1]),PO(1)}}function oye(e,t){if(1&e&&(xP(0,"h4"),bO(1,40),RP()),2&e){var n=GP(3);Wb(1),EO(n.winner.get()),PO(1)}}function sye(e,t){1&e&&(xP(0,"h4",41),bO(1,42),RP())}function uye(e,t){if(1&e&&(xP(0,"div",37),OP(1,oye,2,1,"h4",38),OP(2,sye,2,0,"h4",39),RP()),2&e){var n=GP(2);Wb(1),AP("ngIf",n.winner.isPresent()),Wb(1),AP("ngIf",n.winner.isAbsent())}}function cye(e,t){if(1&e){var n=FP();xP(0,"div",6),xP(1,"div",7),xP(2,"p",8),bO(3,9),RP(),RP(),xP(4,"div",10),xP(5,"div",11),xP(6,"div",12),xP(7,"select",13),BP("change",function(){hC(n);var e=GP();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return hC(n),GP().playerSelection[0]=e}),xP(8,"option",14),bO(9,15),RP(),OP(10,Qge,2,2,"option",16),RP(),RP(),xP(11,"div",12),OP(12,eye,4,3,"select",17),RP(),OP(13,tye,2,1,"p",18),RP(),xP(14,"div",19),xP(15,"div",12),xP(16,"select",20),BP("change",function(){hC(n);var e=GP();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return hC(n),GP().playerSelection[1]=e}),xP(17,"option",14),bO(18,21),RP(),OP(19,nye,2,2,"option",16),RP(),RP(),xP(20,"div",12),OP(21,iye,4,3,"select",22),RP(),OP(22,aye,2,1,"p",23),RP(),RP(),OP(23,uye,3,2,"div",24),RP()}if(2&e){var r=GP();Wb(3),EO(r.gameComponent.getTurn()+1),PO(3),Wb(4),AP("ngModel",r.playerSelection[0]),Wb(3),AP("ngForOf",r.gameComponent.availableMinimaxes),Wb(2),AP("ngIf",!1===r.players[0].equalsValue("human")),Wb(1),AP("ngIf",r.gameComponent.scores.isPresent()),Wb(3),AP("ngModel",r.playerSelection[1]),Wb(3),AP("ngForOf",r.gameComponent.availableMinimaxes),Wb(2),AP("ngIf",!1===r.players[1].equalsValue("human")),Wb(1),AP("ngIf",r.gameComponent.scores.isPresent()),Wb(1),AP("ngIf",r.endGame)}}function lye(e,t){if(1&e&&(DP(0),pS(1),NP(2,"br"),LP()),2&e){var n=t.$implicit,r=GP(3);Wb(1),yS(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function fye(e,t){if(1&e&&(DP(0),OP(1,lye,3,1,"ng-container",48),pS(2),NP(3,"br"),pS(4),NP(5,"br"),LP()),2&e){var n=GP(2);Wb(1),AP("ngForOf",n.gameComponent.availableMinimaxes),Wb(1),yS(" Created ",n.getCreatedNodes()," nodes."),Wb(2),yS(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function hye(e,t){if(1&e){var n=FP();xP(0,"button",49),BP("click",function(){return hC(n),GP(2).gameComponent.pass()}),bO(1,50),RP()}}function dye(e,t){if(1&e){var n=FP();xP(0,"button",51),BP("click",function(){return hC(n),GP(2).takeBack()}),bO(1,52),RP()}}function vye(e,t){if(1&e){var n=FP();xP(0,"div",43),OP(1,fye,6,3,"ng-container",38),OP(2,hye,2,0,"button",44),OP(3,dye,2,0,"button",45),xP(4,"button",46),BP("click",function(){return hC(n),GP().restartGame()}),bO(5,47),RP(),RP()}if(2&e){var r=GP();Wb(1),AP("ngIf",r.gameComponent.rules.node.move),Wb(1),AP("ngIf",!1===r.endGame&&r.gameComponent.canPass),Wb(1),AP("ngIf",r.canTakeBack())}}var pye=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=zB.empty(),u.botTimeOut=1e3,u.players=[zB.of(u.playerSelection[0]),zB.of(u.playerSelection[1])],u.role=u9.ZERO,FB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return Py(n,[{key:"getCreatedNodes",value:function(){return Xte.createdNodes}},{key:"getMinimaxTime",value:function(){return Xte.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=zB.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?u9.ONE:u9.ZERO),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:FB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=zB.of($localize(Fp||(Fp=ey(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return zB.empty();var t=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[t]?zB.empty():zB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return $7((r=t.gameComponent.rules).getGameStatus(r.node)===ene.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),ZB.SUCCESS):(t.messageDisplayer.criticalMessage($localize(Up||(Up=ey(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),G7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.getTurn()>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=zB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(Ipe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(LO),IP(rL),IP(Q7),IP(EF),IP(H7),IP(hT))},e.\u0275cmp=wk({type:e,selectors:[["app-local-game-wrapper"]],features:[cP],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Vp||(Vp=ey(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(Bp||(Bp=ey(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(zp||(zp=ey(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(Hp||(Hp=ey(["Pick the level"]))),$localize(Gp||(Gp=ey(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize($p||($p=ey(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Zp||(Zp=ey(["Pick the level"]))),$localize(qp||(qp=ey(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Wp||(Wp=ey(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(jp||(jp=ey(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Yp||(Yp=ey(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Kp||(Kp=ey(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Qp||(Qp=ey(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Xp||(Xp=ey(["Take back move"])))]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"div",1),OP(2,cye,24,10,"div",2),OP(3,vye,6,3,"div",3),RP(),xP(4,"div",4),xP(5,"div",5),NP(6,"app-game-includer"),RP(),RP(),RP()),2&e&&(Wb(2),AP("ngIf",t.gameComponent),Wb(1),AP("ngIf",t.gameComponent),Wb(1),AP("ngClass",t.getBoardHighlight()))},directives:[vM,lM,Ope,DR,Zx,bR,LR,BR,hM],encapsulation:2,changeDetection:0}),e}(),gye=function(){var e=Py(function e(){by(this,e)});return e.STEP_FINISHED=function(){return $localize(Jp||(Jp=ey(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(eg||(eg=ey(["This step is not expecting any move from your part."])))},e}();function yye(e,t){if(1&e&&(xP(0,"div",20),xP(1,"div",21),bO(2,22),RP(),xP(3,"div",23),pS(4),RP(),RP()),2&e){var n=GP();Wb(4),gS(n.currentReason.get())}}function mye(e,t){if(1&e){var n=FP();xP(0,"button",24),BP("click",function(){return hC(n),GP().retry()}),bO(1,25),RP()}}function kye(e,t){1&e&&(DP(0),bO(1,30),LP())}function Cye(e,t){1&e&&(DP(0),bO(1,31),LP())}function wye(e,t){if(1&e&&OP(0,Cye,2,0,"ng-container",27),2&e){GP();var n=TP(5),r=GP();AP("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function _ye(e,t){1&e&&(DP(0),bO(1,32),LP())}function bye(e,t){if(1&e){var n=FP();xP(0,"button",26),BP("click",function(){return hC(n),GP().next()}),OP(1,kye,2,0,"ng-container",27),OP(2,wye,1,2,"ng-template",null,28,uI),OP(4,_ye,2,0,"ng-template",null,29,uI),RP()}if(2&e){var r=TP(3),i=GP();Wb(1),AP("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function Eye(e,t){if(1&e){var n=FP();xP(0,"button",33),BP("click",function(){return hC(n),GP().start()}),bO(1,34),RP()}}function Pye(e,t){if(1&e){var n=FP();xP(0,"button",35),BP("click",function(){return hC(n),GP().playLocally()}),bO(1,36),RP()}}function Sye(e,t){if(1&e){var n=FP();xP(0,"button",37),BP("click",function(){return hC(n),GP().createGame()}),bO(1,38),RP()}}function Oye(e,t){if(1&e){var n=FP();xP(0,"button",39),BP("click",function(){return hC(n),GP().showSolution()}),bO(1,40),RP()}}function Tye(e,t){if(1&e&&(DP(0),xP(1,"option",42),pS(2),RP(),LP()),2&e){var n=GP(),r=n.index,i=n.$implicit;Wb(1),ZP("id","step_",r,""),AP("value",r),Wb(1),gS(i.title)}}function Iye(e,t){1&e&&(DP(0),pS(1,"v "),LP())}function Aye(e,t){1&e&&pS(0,"x ")}function Mye(e,t){if(1&e&&(xP(0,"option",43),OP(1,Iye,2,0,"ng-container",27),OP(2,Aye,1,0,"ng-template",null,44,uI),xP(4,"span",45),pS(5),RP(),RP()),2&e){var n=TP(3),r=GP(),i=r.index,a=r.$implicit,o=GP();AP("value",i),Wb(1),AP("ngIf",o.stepFinished[i])("ngIfElse",n),Wb(3),ZP("id","step_",i,""),Wb(1),gS(a.title)}}function xye(e,t){if(1&e&&(DP(0),OP(1,Tye,3,3,"ng-container",27),OP(2,Mye,6,5,"ng-template",null,41,uI),LP()),2&e){var n=t.index,r=TP(3),i=GP();Wb(1),AP("ngIf",n===i.stepIndex)("ngIfElse",r)}}var Rye=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r,i,a,o,s){var u;return by(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(tg||(tg=ey(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=zB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,FB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.role=u9.ZERO,u}return Py(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return FB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){FB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){FB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t,r=this.steps[this.stepIndex];if(this.currentMessage=r.instruction,this.currentReason=zB.empty(),r.previousState.isPresent()){var i=new Jte(r.previousState.get());t=zB.of(i)}else t=zB.empty();this.gameComponent.rules.node=new Jte(r.state,t,r.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:FB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],$7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),FB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),(s=LB.getNonNullable(i.predicate)(e,a,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=zB.of(s.getReason())):i.isAnyMove()?(FB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):($7(i.isMove(),"cannot reach here with a click step"),(u=i).acceptedMoves.some(function(t){return t.equals(e)})?(FB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(u.getSuccessMessage())):(FB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=zB.of(u.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){FB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(FB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=zB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return ZB.failure(gye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,LB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),ZB.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),ZB.SUCCESS):ZB.failure(gye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){FB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=zB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){FB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Cy(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:FB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),$7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof jte?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=LB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=LB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(Ipe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(IP(LO),IP(rL),IP(EF),IP(H7),IP(hT),IP(Q7))},e.\u0275cmp=wk({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[cP],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(ng||(ng=ey(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(rg||(rg=ey(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(ig||(ig=ey(["Ok"]))),$localize(ag||(ag=ey(["Continue"]))),$localize(og||(og=ey(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(sg||(sg=ey(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(ug||(ug=ey(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(cg||(cg=ey(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(lg||(lg=ey(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"div",1),xP(2,"div",2),NP(3,"progress",3),xP(4,"div",4),xP(5,"p",5),pS(6),RP(),NP(7,"p",6),RP(),OP(8,yye,5,1,"div",7),xP(9,"div",8),OP(10,mye,2,0,"button",9),OP(11,bye,6,2,"button",10),OP(12,Eye,2,0,"button",11),OP(13,Pye,2,0,"button",12),OP(14,Sye,2,0,"button",13),OP(15,Oye,2,0,"button",14),xP(16,"div",15),xP(17,"select",16),BP("change",function(e){return t.changeStep(e)}),OP(18,xye,4,2,"ng-container",17),RP(),RP(),RP(),RP(),RP(),xP(19,"div",18),xP(20,"div",19),NP(21,"app-game-includer"),RP(),RP(),RP()),2&e&&(Wb(3),_P("value",t.successfulSteps)("max",t.getNumberOfSteps()),Wb(3),kS("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Wb(1),AP("innerHTML",t.currentMessage,V_),Wb(1),AP("ngIf",t.currentReason.isPresent()),Wb(2),AP("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Wb(1),AP("ngIf",!1===t.tutorialOver),Wb(1),AP("ngIf",t.tutorialOver),Wb(1),AP("ngIf",t.tutorialOver),Wb(1),AP("ngIf",t.tutorialOver),Wb(1),AP("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Wb(3),AP("ngForOf",t.steps),Wb(1),AP("ngClass",t.getBoardHighlight()))},directives:[vM,hM,lM,Ope,LR,BR],encapsulation:2,changeDetection:0}),e}();function Nye(e,t){if(1&e&&(xP(0,"div",35),xP(1,"div",36),bO(2,37),RP(),xP(3,"div",38),pS(4),RP(),RP()),2&e){var n=GP();Wb(4),gS(n.errorMessage)}}var Dye=function(){return["/login"]},Lye=function(){var e=function(){function e(t,n){by(this,e),this.connectedUserService=t,this.router=n,this.faEye=O9,this.registrationForm=new gR({email:new pR,username:new pR,password:new pR})}return Py(e,[{key:"registerWithEmail",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(fg||(fg=ey(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.connectedUserService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.connectedUserService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(Q7),IP(EF))},e.\u0275cmp=wk({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(hg||(hg=ey(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(dg||(dg=ey(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(vg||(vg=ey(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(pg||(pg=ey(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(gg||(gg=ey(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(yg||(yg=ey(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(mg||(mg=ey(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(kg||(kg=ey(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(Cg||(Cg=ey(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(wg||(wg=ey(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(_g||(_g=ey(["Register with Google"]))),[1,"help","level-right"],$localize(bg||(bg=ey(["Have an account?"]))),[3,"routerLink"],$localize(Eg||(Eg=ey(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Pg||(Pg=ey(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"p",1),bO(2,2),RP(),xP(3,"form",3),xP(4,"div",4),xP(5,"div",5),xP(6,"label",6),bO(7,7),RP(),RP(),xP(8,"div",8),xP(9,"div",9),xP(10,"div",10),NP(11,"input",11),xP(12,"p",12),bO(13,13),RP(),RP(),RP(),RP(),RP(),xP(14,"div",4),xP(15,"div",5),xP(16,"label",14),bO(17,15),RP(),RP(),xP(18,"div",8),xP(19,"div",9),xP(20,"div",10),NP(21,"input",16),RP(),RP(),RP(),RP(),xP(22,"div",4),xP(23,"div",5),xP(24,"label",17),bO(25,18),RP(),RP(),xP(26,"div",8),xP(27,"div",9),xP(28,"div",19),NP(29,"input",20),xP(30,"span",21),NP(31,"fa-icon",22),RP(),xP(32,"p",23),bO(33,24),RP(),RP(),RP(),RP(),RP(),xP(34,"div",4),NP(35,"div",5),xP(36,"div",8),xP(37,"div",9),xP(38,"div",10),xP(39,"button",25),BP("click",function(){return t.registerWithEmail()}),bO(40,26),RP(),RP(),RP(),RP(),RP(),xP(41,"div",4),NP(42,"div",5),xP(43,"div",27),OP(44,Nye,5,1,"div",28),RP(),RP(),xP(45,"div",4),NP(46,"div",5),xP(47,"div",8),xP(48,"button",29),BP("click",function(){return t.registerWithGoogle()}),bO(49,30),RP(),RP(),RP(),xP(50,"p",31),DP(51),bO(52,32),LP(),pS(53,"\xa0 "),xP(54,"a",33),bO(55,34),RP(),RP(),RP(),RP()),2&e&&(Wb(3),AP("formGroup",t.registrationForm),Wb(28),AP("icon",t.faEye),Wb(1),AP("ngClass",t.getPasswordHelpClass()),Wb(7),AP("disabled",!t.canRegister()),Wb(5),AP("ngIf",t.errorMessage),Wb(10),AP("routerLink",FT(6,Dye)))},directives:[ER,qx,AR,px,Zx,xR,Qve,HR,ate,Xve,lM,vM,OF],encapsulation:2}),e}(),Fye=function(){var e=function(){function e(t){by(this,e),this.router=t}return Py(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF))},e.\u0275cmp=wk({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Sg||(Sg=ey(["Play offline"])))]},template:function(e,t){1&e&&(xP(0,"app-pick-game",0),BP("pickGame",function(e){return t.pickGame(e)}),RP(),xP(1,"button",1),BP("click",function(){return t.playLocally()}),bO(2,2),RP()),2&e&&(Wb(1),AP("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),Uye=function(){var e=function(){function e(t){by(this,e),this.router=t}return Py(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(EF))},e.\u0275cmp=wk({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Og||(Og=ey(["Learn the rules"])))]},template:function(e,t){1&e&&(xP(0,"app-pick-game",0),BP("pickGame",function(e){return t.pickGame(e)}),RP(),xP(1,"button",1),BP("click",function(){return t.launchTutorial()}),bO(2,2),RP()),2&e&&(Wb(1),AP("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),Vye=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=wk({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(Tg||(Tg=ey(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(xP(0,"p"),bO(1,0),RP())},encapsulation:2}),e}();function Bye(e,t){if(1&e&&(zC(),NP(0,"polygon",4)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessQueenComponent.HEPTAGON)}}function zye(e,t){if(1&e&&(zC(),NP(0,"polygon",4)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Hye(e,t){if(1&e&&(zC(),NP(0,"circle",5)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Gye(e,t){if(1&e&&(DP(0),zC(),NP(1,"circle",6),NP(2,"circle",6),NP(3,"circle",6),LP()),2&e){var n=GP();Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function $ye(e,t){if(1&e&&(zC(),xP(0,"g"),NP(1,"circle",7),NP(2,"circle",7),NP(3,"circle",7),RP()),2&e){var n=GP();Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),Wb(1),_P("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),Wb(1),_P("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Zye(e,t){if(1&e&&(zC(),xP(0,"g",8),NP(1,"circle",9),NP(2,"circle",9),NP(3,"circle",9),RP()),2&e){var n=GP();AP("ngClass",n.pieceClasses),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var qye=Py(function e(){by(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=Bce,this.horizontalDotsRadius=Bce.SPACE_SIZE/15});function Wye(e,t){if(1&e&&(zC(),NP(0,"polygon",4)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessDroneComponent.PENTAGON)}}function jye(e,t){if(1&e&&(zC(),NP(0,"polygon",4)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Yye(e,t){if(1&e&&(zC(),NP(0,"circle",5)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Kye(e,t){if(1&e&&(DP(0),zC(),NP(1,"circle",6),NP(2,"circle",6),LP()),2&e){var n=GP();Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Qye(e,t){if(1&e&&(zC(),xP(0,"g",7),NP(1,"circle",8),NP(2,"circle",8),RP()),2&e){var n=GP();AP("ngClass",n.pieceClasses),Wb(1),_P("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),Wb(1),_P("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Xye(e,t){if(1&e&&(zC(),xP(0,"g",7),NP(1,"circle",9),NP(2,"circle",9),RP()),2&e){var n=GP();AP("ngClass",n.pieceClasses),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}qye.HEPTAGON=Bce.getRegularPolygon(7),qye.EIGHT_POINTED_STAR=Bce.getNPointedStar(8,0),qye.\u0275fac=function(e){return new(e||qye)},qye.\u0275cmp=wk({type:qye,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(OP(0,Bye,1,3,"polygon",0),OP(1,zye,1,3,"polygon",0),OP(2,Hye,1,5,"circle",1),OP(3,Gye,4,9,"ng-container",2),OP(4,$ye,4,9,"g",2),OP(5,Zye,4,10,"g",3)),2&e&&(AP("ngIf","Polygon"===t.style.shape),Wb(1),AP("ngIf","Star"===t.style.shape),Wb(1),AP("ngIf","Circle"===t.style.shape),Wb(1),AP("ngIf","Concentric Circles"===t.style.points),Wb(1),AP("ngIf","Dots"===t.style.points),Wb(1),AP("ngIf","Horizontal Points"===t.style.points))},directives:[vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Jye=Py(function e(){by(this,e),this.MartianChessComponent=Bce,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=Bce.SPACE_SIZE/15});function eme(e,t){if(1&e&&(zC(),NP(0,"polygon",5)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessPawnComponent.TRIANGLE)}}function tme(e,t){if(1&e&&(zC(),NP(0,"polygon",5)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function nme(e,t){if(1&e&&(zC(),NP(0,"circle",6)),2&e){var n=GP();AP("id",n.mainShapeId)("ngClass",n.pieceClasses),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function rme(e,t){if(1&e&&(zC(),NP(0,"circle",7)),2&e){var n=GP();_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function ime(e,t){if(1&e&&(zC(),NP(0,"circle",8)),2&e){var n=GP();_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function ame(e,t){if(1&e&&(zC(),xP(0,"g",9),NP(1,"circle",10),RP()),2&e){var n=GP();AP("ngClass",n.pieceClasses),Wb(1),_P("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Jye.FOUR_POINTED_STAR_VERTICAL=Bce.getNPointedStar(4,0),Jye.PENTAGON=Bce.getRegularPolygon(5),Jye.\u0275fac=function(e){return new(e||Jye)},Jye.\u0275cmp=wk({type:Jye,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(OP(0,Wye,1,3,"polygon",0),OP(1,jye,1,3,"polygon",0),OP(2,Yye,1,5,"circle",1),OP(3,Kye,3,6,"ng-container",2),OP(4,Qye,3,7,"g",3),OP(5,Xye,3,7,"g",3)),2&e&&(AP("ngIf","Polygon"===t.style.shape),Wb(1),AP("ngIf","Star"===t.style.shape),Wb(1),AP("ngIf","Circle"===t.style.shape),Wb(1),AP("ngIf","Concentric Circles"===t.style.points),Wb(1),AP("ngIf","Dots"===t.style.points),Wb(1),AP("ngIf","Horizontal Points"===t.style.points))},directives:[vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var ome=function(){function e(){by(this,e),this.MartianChessComponent=Bce,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=Bce.SPACE_SIZE/15}return Py(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return Bce.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=Bce.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();ome.FOUR_POINTED_STAR_DIAGONAL=Bce.getNPointedStar(4,45),ome.TRIANGLE_Y_OFFSET=ome.yOffsetForVerticalCentering(),ome.TRIANGLE=ome.getTriangle(),ome.\u0275fac=function(e){return new(e||ome)},ome.\u0275cmp=wk({type:ome,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(OP(0,eme,1,3,"polygon",0),OP(1,tme,1,3,"polygon",0),OP(2,nme,1,5,"circle",1),OP(3,rme,1,3,"circle",2),OP(4,ime,1,3,"circle",3),OP(5,ame,2,4,"g",4)),2&e&&(AP("ngIf","Polygon"===t.style.shape),Wb(1),AP("ngIf","Star"===t.style.shape),Wb(1),AP("ngIf","Circle"===t.style.shape),Wb(1),AP("ngIf","Concentric Circles"===t.style.points),Wb(1),AP("ngIf","Dots"===t.style.points),Wb(1),AP("ngIf","Horizontal Points"===t.style.points))},directives:[vM,lM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var sme={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"},ume=function(){var e=function(){function e(t){by(this,e),this.connectedUserService=t}return Py(e,[{key:"canActivate",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t){var n;e.userSubscription=e.connectedUserService.subscribeToUser((n=DB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=t,n.next=3,e.evaluateUserPermission(r);case 3:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 5:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))});case 2:return n=t.sent,t.abrupt("return",(e.userSubscription.unsubscribe(),n));case 4:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(Q7))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),cme=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e)).router=r,i}return Py(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.evaluateUserPermission(t.router,e));case 1:case"end":return r.stop()}},r)}))()}}],[{key:"evaluateUserPermission",value:function(e,t){return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===t.isConnected()?e.parseUrl("/login"):!1!==t.verified||e.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(ume);return e.\u0275fac=function(t){return new(t||e)(Ww(Q7),Ww(EF))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),lme=function(){var e=function(){function e(t,n){by(this,e),this.observedPartService=t,this.router=n,this.observedPartSubscription=zB.empty()}return Py(e,[{key:"canActivate",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(n){var r=t.observedPartService.subscribeToObservedPart(function(r){if(r.isAbsent())return n(!0);var i=r.get();return n(e.params.id===i.id||t.router.parseUrl("/play/"+i.typeGame+"/"+i.id))});t.observedPartSubscription=zB.of(r)});case 2:return r=n.sent,n.abrupt("return",(t.observedPartSubscription.get().unsubscribe(),t.observedPartSubscription=zB.empty(),r));case 4:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ww(D9),Ww(EF))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),fme=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e)).router=r,i}return Py(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(ume);return e.\u0275fac=function(t){return new(t||e)(Ww(Q7),Ww(EF))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),hme=function(){var e=function(e){fy(n,e);var t=dy(n);function n(e,r){var i;return by(this,n),(i=t.call(this,e)).router=r,i}return Py(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(ume);return e.\u0275fac=function(t){return new(t||e)(Ww(Q7),Ww(EF))},e.\u0275prov=Zm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function dme(e,t){1&e&&(xP(0,"p",20),bO(1,21),RP())}function vme(e,t){if(1&e){var n=FP();xP(0,"div",7),xP(1,"p",8),bO(2,9),RP(),xP(3,"div",10),xP(4,"p",11),bO(5,12),RP(),xP(6,"button",13),BP("click",function(){return hC(n),GP().finalizeEmailVerification()}),bO(7,14),RP(),RP(),xP(8,"div",15),xP(9,"p",11),bO(10,16),RP(),xP(11,"button",17),BP("click",function(){return hC(n),GP().sendEmailVerification()}),bO(12,18),RP(),RP(),OP(13,dme,2,0,"p",19),RP()}if(2&e){var r=GP();Wb(2),EO(r.emailAddress),PO(2),Wb(11),AP("ngIf",r.success)}}function pme(e,t){if(1&e){var n=FP();xP(0,"div",24),xP(1,"div",8),bO(2,25),RP(),xP(3,"form",26),xP(4,"div",27),xP(5,"div",28),NP(6,"input",29),RP(),xP(7,"div",28),xP(8,"button",30),BP("click",function(){hC(n);var e=GP(2);return e.pickUsername(e.usernameForm.value)}),bO(9,31),RP(),RP(),RP(),RP(),RP()}if(2&e){var r=GP(2);Wb(3),AP("formGroup",r.usernameForm)}}var gme=function(){return["/lobby"]};function yme(e,t){1&e&&(xP(0,"div",32),wO(1,33),NP(2,"a",34),_O(),RP()),2&e&&(Wb(2),AP("routerLink",FT(1,gme)))}function mme(e,t){if(1&e&&(DP(0),OP(1,pme,10,1,"div",22),OP(2,yme,3,2,"div",23),LP()),2&e){var n=GP();Wb(1),AP("ngIf",!n.success),Wb(1),AP("ngIf",n.success)}}function kme(e,t){if(1&e&&(xP(0,"div",35),xP(1,"div",36),pS(2),RP(),RP()),2&e){var n=GP();Wb(2),gS(n.errorMessage)}}var Cme=function(){var e=function(){function e(t,n){by(this,e),this.connectedUserService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new gR({username:new pR})}return Py(e,[{key:"ngOnInit",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSubscription=e.connectedUserService.subscribeToUser(function(){var t=DB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(Ig||(Ig=ey(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.connectedUserService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(Q7),IP(EF))},e.\u0275cmp=wk({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(Ag||(Ag=ey(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(Mg||(Mg=ey(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(xg||(xg=ey(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(Rg||(Rg=ey(["Finalize email verification"]))),[1,"level-left"],$localize(Ng||(Ng=ey(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(Dg||(Dg=ey(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(Lg||(Lg=ey(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(Fg||(Fg=ey(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(Ug||(Ug=ey(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(Vg||(Vg=ey(["Pick username"]))),["id","success",1,"message-body"],$localize(Bg||(Bg=ey(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"div",1),xP(2,"div",2),bO(3,3),RP(),OP(4,vme,14,2,"div",4),OP(5,mme,3,2,"ng-container",5),RP(),OP(6,kme,3,1,"div",6),RP()),2&e&&(Wb(4),AP("ngIf","send-email"===t.verificationType),Wb(1),AP("ngIf","enter-username"===t.verificationType),Wb(1),AP("ngIf",t.errorMessage))},directives:[vM,ER,qx,AR,px,HR,Zx,xR,OF],encapsulation:2}),e}();function wme(e,t){1&e&&(xP(0,"p",12),bO(1,13),RP())}function _me(e,t){if(1&e&&(xP(0,"div",14),xP(1,"div",15),bO(2,16),RP(),xP(3,"div",17),pS(4),RP(),RP()),2&e){var n=GP();Wb(4),gS(n.errorMessage.get())}}var bme=function(){return{standalone:!0}},Eme=function(){var e=function(){function e(t){by(this,e),this.connectedUserService=t,this.success=!1,this.errorMessage=zB.empty(),this.email=""}return Py(e,[{key:"resetPassword",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=zB.empty(),e.success=!1,t.next=3,e.connectedUserService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=zB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(Q7))},e.\u0275cmp=wk({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(zg||(zg=ey(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(Hg||(Hg=ey(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(Gg||(Gg=ey(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize($g||($g=ey(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Zg||(Zg=ey(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(qg||(qg=ey(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"p",1),bO(2,2),RP(),xP(3,"div",3),xP(4,"div",4),xP(5,"input",5),BP("ngModelChange",function(e){return t.email=e}),RP(),xP(6,"p",6),bO(7,7),RP(),OP(8,wme,2,0,"p",8),RP(),RP(),xP(9,"button",9),BP("click",function(){return t.resetPassword()}),bO(10,10),RP(),OP(11,_me,5,1,"div",11),RP()),2&e&&(Wb(5),AP("ngModel",t.email)("ngModelOptions",FT(5,bme)),Wb(3),AP("ngIf",t.success),Wb(1),AP("disabled",""===t.email),Wb(2),AP("ngIf",t.errorMessage.isPresent()))},directives:[px,Qve,HR,Zx,bR,vM],encapsulation:2}),e}();function Pme(e,t){if(1&e&&(xP(0,"option",13),pS(1),RP()),2&e){var n=t.$implicit,r=GP();AP("value",n.value)("selected",n.value===r.currentTheme),Wb(1),yS(" ",n.name," ")}}function Sme(e,t){if(1&e&&(xP(0,"option",13),pS(1),RP()),2&e){var n=t.$implicit,r=GP();AP("value",n.value)("selected",n.value===r.currentLanguage),Wb(1),yS(" ",n.name," ")}}var Ome=function(){var e=function(){function e(t,n){by(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Wg||(Wg=ey(["Light"])))},{value:"dark",name:$localize(jg||(jg=ey(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return Py(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(_9),IP(b9))},e.\u0275cmp=wk({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Yg||(Yg=ey(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Kg||(Kg=ey(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Qg||(Qg=ey(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(xP(0,"div",0),xP(1,"p",1),bO(2,2),RP(),xP(3,"div",3),xP(4,"label",4),bO(5,5),RP(),xP(6,"div",6),xP(7,"div",7),xP(8,"select",8),BP("change",function(e){return t.changeTheme(e)}),OP(9,Pme,2,3,"option",9),RP(),RP(),RP(),RP(),xP(10,"div",3),xP(11,"label",10),bO(12,11),RP(),xP(13,"div",6),xP(14,"div",7),xP(15,"select",12),BP("change",function(e){return t.changeLanguage(e)}),OP(16,Sme,2,3,"option",9),RP(),RP(),RP(),RP(),RP()),2&e&&(Wb(9),AP("ngForOf",t.availableThemes),Wb(7),AP("ngForOf",t.availableLanguages))},directives:[hM,LR,BR],encapsulation:2}),e}(),Tme=function(){var e=function(){function e(t,n,r,i,a,o){by(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.observedPartService=i,this.messageDisplayer=a,this.gameService=o}return Py(e,[{key:"ngOnInit",value:function(){var e=this;return DB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return LB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return DB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if($7(t.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1!==t.gameExists(e)){n.next=4;break}return n.next=3,t.router.navigate(["/notFound",Tpe.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 3:case 15:return n.abrupt("return",!1);case 4:if(!(r=t.observedPartService.canUserCreate()).isSuccess()){n.next=12;break}return n.next=8,t.gameService.createPartConfigRoomAndChat(e);case 8:return i=n.sent,n.next=11,t.router.navigate(["/play",e,i]);case 11:return n.abrupt("return",!0);case 12:return t.messageDisplayer.infoMessage(r.getReason()),n.next=15,t.router.navigate(["/lobby"]);case 16:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return zB.ofNullable(Zve.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(IP(rL),IP(EF),IP(Q7),IP(D9),IP(H7),IP(y9))},e.\u0275cmp=wk({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Xg||(Xg=ey(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(xP(0,"p"),bO(1,0),RP())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[OS.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),bS[t]=e,n&&(bS[t][OS.ExtraData]=n)}(e,void 0,void 0)}(RB());var Ime=[{path:"login",component:npe},{path:"lobby",component:Epe,canActivate:[cme]},{path:"settings",component:Ome},{path:"register",component:Lye,canActivate:[hme]},{path:"reset-password",component:Eme,canActivate:[hme]},{path:"notFound/:message",component:Ppe},{path:"nextGameLoading",component:Vye,canActivate:[cme]},{path:"verify-account",component:Cme,canActivate:[fme]},{path:"play",component:ape,canActivate:[cme,lme]},{path:"play/:compo",component:Tme,canActivate:[cme,lme]},{path:"play/:compo/:id",component:Kge,canActivate:[cme,lme]},{path:"local",component:Fye},{path:"local/:compo",component:pye},{path:"tutorial",component:Uye},{path:"tutorial/:compo",component:Rye},{path:"",component:Kve},{path:"**",component:Ppe}],Ame=function(){function e(){by(this,e)}return Py(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:c4,providers:[{provide:a4,useFactory:u4(e),multi:!0,deps:[AI,sP,K3].concat(n)}]}}(function(){return l4(sme)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:w7,providers:[{provide:y7,useFactory:m7(e),multi:!0,deps:[AI,sP,K3,i4,[new t_,n7],[new t_,G4]].concat(n)}]}}(function(){var e=T7();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:s7,providers:[{provide:r7,useFactory:i7(e),multi:!0,deps:[AI,sP,K3,i4,[new t_,G4]].concat(n)}]}}(function(){return c7()})}}]),e}(),Mme=function(){var e=Py(function e(){by(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Pk({type:e,bootstrap:[Pte]}),e.\u0275inj=qm({providers:[Q7,y9,g9,q7,V7,b9,{provide:mI,useValue:w9.getLocale()}],imports:[[Ame.app(),Ame.firestore(),Ame.auth(),tx,MN,VF.forRoot(Ime,{useHash:!1}),WR,qR,MB,ote]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map(_k)},r.pipeDefs=function(){return n.map(bk)}}(Bce,[hM,lM,vM,ome,Jye,qye],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var xme=function(){function e(t){by(this,e),this.digits=t}return Py(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),Rme=function(){function e(t){by(this,e),this.powerOfTwos=[t]}return Py(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=xme.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),Nme=function(){function e(t){by(this,e),this.base=t,this.exponents=[new Rme(xme.one())]}return Py(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Rme(n)}return this.exponents[e]}}]),e}();function Dme(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=Lme(t,0),r=Lme(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Lme(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=Fme(r=Vme(r,Gme(e,n,Ume.Little)),i=Vme(i,Gme(e,n+4,Ume.Little)),t=Vme(t,Gme(e,n+8,Ume.Little)));r=o[0],i=o[1],t=o[2]}return r=Vme(r,Gme(e,n,Ume.Little)),i=Vme(i,Gme(e,n+4,Ume.Little)),t=Vme(t,a),Fme(r,i,t=Vme(t,Gme(e,n+8,Ume.Little)<<8))[2]}function Fme(e,t,n){return e=zme(e,t),e=zme(e,n),e^=n>>>13,t=zme(t,n),t=zme(t,e),t^=e<<8,n=zme(n,e),n=zme(n,t),n^=t>>>13,e=zme(e,t),e=zme(e,n),e^=n>>>12,t=zme(t,n),t=zme(t,e),t^=e<<16,n=zme(n,e),n=zme(n,t),n^=t>>>5,e=zme(e,t),e=zme(e,n),e^=n>>>3,t=zme(t,n),t=zme(t,e),t^=e<<10,n=zme(n,e),n=zme(n,t),[e,t,n^=t>>>15]}var Ume=((Ume=Ume||{})[Ume.Little=0]="Little",Ume[Ume.Big=1]="Big",Ume);function Vme(e,t){return Bme(e,t)[1]}function Bme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function zme(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Hme(e,t){return t>=e.length?0:e[t]}function Gme(e,t,n){var r=0;if(n===Ume.Big)for(var i=0;i<4;i++)r+=Hme(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Hme(e,t+a)<<8*a;return r}var $me=new Nme(256);function Zme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function qme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Wme=function(e){fy(n,e);var t=dy(n);function n(e){var r;return by(this,n),(r=t.call(this,"No translation found for ".concat(Yme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return Py(n)}(sy(Error));function jme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Yme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Kme(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Zme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=Jg(i.split("\u241f")),o=a[0],s=a.slice(1),u=iy(o.split("@@",2),2),c=u[0],l=u[1],f=iy(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=Zme(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?qme(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Dme(e);if(t){var r=Dme(t);n=function(e,t){var n=e[0],r=t[0],i=Bme(e[1],t[1]),a=i[0],o=i[1];return[Vme(Vme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=$me.toThePowerOf(0).multiplyBy(t);return $me.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Wme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Yme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Qme(){(function(){if(HI)throw new Error("Cannot enable prod mode after platform setup.");zI=!1})(),JM().bootstrapModule(Mme).catch(function(e){return console.error(e)})}var Xme=w9.getLocale();"en"!==Xme?fetch("/assets/"+Xme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Kme),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:jme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Qme()}).catch(function(e){console.log(e)}):Qme()}},function(e){e(e.s=7994)}])}();